!function(e){function t(t){for(var n,o,i=t[0],s=t[1],a=0,l=[];a<i.length;a++)o=i[a],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&l.push(r[o][0]),r[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(c&&c(t);l.length;)l.shift()()}var n={},r={0:0};function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(){return Promise.resolve()},o.m=e,o.c=n,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var i=window.webpackJsonp=window.webpackJsonp||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var a=0;a<i.length;a++)t(i[a]);var c=s;o(o.s=11)}([function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RequiredCDSOpersForInit=t.WrapperEvents=t.LOCALE_MAP=t.Visibility=t.ParameterTypes=t.Kind=t.TelemetryEventType=t.LogLevel=t.WrapperMessages=t.DesignerMessages=t.Constants=void 0;class n{}t.Constants=n,n.DESIGNER_CONTROL_SIGNATURE="msladesigner",n.WRAPPER_CONTROL_SIGNATURE="msladesigner",n.MACRO_ID="id",n.WORKFLOW_ENTITY="workflow",n.MACRO_CONFIG_ENTITY="msdyn_productivitymacrosolutionconfiguration",n.MONITOR_CONTROL_SIGNATURE="mslamonitor",n.MWRAPPER_CONTROL_SIGNATURE="mslamonitor",n.MACROS_SESSION_ENTITY="msdyn_macrosession",n.MACROS_DESIGNER_PATH="/WebResources/MacroDesigner/msdyn_ProductivityMacrosComponent_macroDesigner/iframedesigner.html",n.MACROS_MONITOR_PATH="/WebResources/MacroDesigner/msdyn_ProductivityMacrosComponent_macroMonitor/iframemonitor.html",n.SESSION_TEMPLATE_ENTITY="msdyn_sessiontemplate",n.EXPRESSION_DATA="msdyn_expressiondata",n.BUILTIN_CATEGORY="LOGIC_APPS_BUILTIN",n.BUILTIN_CATEGORY_DISPLAY="LADESIGNER_RECOMMENDATION_CATEGORY_LOGICAPP_BUILTIN",n.MACRO_ACTION_SAVE_AND_CLOSE="MACRO_ACTION_SAVE_AND_CLOSE",n.MACRO_ACTION_CANCEL="MACRO_ACTION_CANCEL";class r{}t.DesignerMessages=r,r.Initialize="initialize",r.GetDefinition="getDefinition",r.LoadDefinition="loadDefinition",r.RenderDesigner="renderDesigner",r.RPC_PONG="__PONG__",r.InitializeMonitor="initializeMonitor",r.RenderMonitor="renderMonitor";class o{}t.WrapperMessages=o,o.DesignerInitDone="initDone",o.RPC_PING="__PING__",o.LOG="log",o.MonitorInitDone="monitorInitDone",o.GetCrmData="crmdata",o.GetFlowsData="flowsData",o.GetEntities="entities",function(e){e.Info="Info",e.Warning="Warning",e.Error="Error",e.Trace="Trace",e.Debug="Debug"}(t.LogLevel||(t.LogLevel={})),function(e){e.Trace="Trace",e.Request="Request",e.Telemetry="Telemetry",e.ProfileStart="ProfileStart",e.ProfileEnd="ProfileEnd"}(t.TelemetryEventType||(t.TelemetryEventType={})),function(e){e.Action="ACTIONS",e.Trigger="TRIGGERS"}(t.Kind||(t.Kind={})),function(e){e.Any="any",e.Array="array",e.Boolean="boolean",e.File="file",e.Integer="integer",e.Null="null",e.Number="number",e.Object="object",e.String="string"}(t.ParameterTypes||(t.ParameterTypes={})),function(e){e.Required="required",e.Important="important",e.Advanced="advanced",e.Internal="internal",e.ReadOnly="read-only"}(t.Visibility||(t.Visibility={}));t.LOCALE_MAP={1078:"af",1052:"sq",1118:"am",5121:"ar",15361:"ar",3073:"ar",2049:"ar",11265:"ar",13313:"ar",12289:"ar",4097:"ar",6145:"ar",8193:"ar",16385:"ar",1025:"ar",10241:"ar",7169:"ar",14337:"ar",9217:"ar",1067:"hy",1101:"as",2092:"az",1068:"az",1069:"eu",1059:"be",2117:"bn",1093:"bn",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh",3076:"zh",5124:"zh",4100:"zh",1028:"zh",1050:"hr",1029:"cs",1030:"da",2067:"nl",1043:"nl",1126:"en",3081:"en",10249:"en",4105:"en",9225:"en",2057:"en",16393:"en",6153:"en",8201:"en",5129:"en",13321:"en",7177:"en",11273:"en",1033:"en",12297:"en",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"en",1035:"fi",2060:"fr",11276:"fr",3084:"fr",9228:"fr",12300:"fr",1036:"fr",5132:"fr",13324:"fr",6156:"fr",14348:"fr",10252:"fr",4108:"fr",7180:"fr",1122:"en",2108:"gd",1084:"gd",1110:"gl",1079:"ka",3079:"de",1031:"de",5127:"de",4103:"de",2055:"de",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"en",1057:"id",1040:"it",2064:"it",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"en",1042:"ko",1088:"en",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms",1086:"ms",1100:"ml",1082:"mt",1112:"en",1153:"mi",1102:"mr",2128:"mn",1104:"mn",1121:"ne",1044:"nb",2068:"nn",1096:"or",1045:"pl",1046:"pt",2070:"pt",1094:"pa",1047:"rm",2072:"ro",1048:"ro",1049:"ru",2073:"ru",1083:"en",1103:"sa",3098:"sr",2074:"sr",1072:"en",1074:"tn",1113:"sd",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es",16394:"es",13322:"es",9226:"es",5130:"es",7178:"es",12298:"es",17418:"es",4106:"es",18442:"es",2058:"es",19466:"es",6154:"es",15370:"es",10250:"es",20490:"es",1034:"es",14346:"es",8202:"es",1089:"sw",2077:"sv",1053:"sv",1114:"en",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz",1091:"uz",1075:"en",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"},function(e){e.WrapperConfigErrorEvent="MSWP.CONFIG_ERROR",e.WrapperConfigLoadEvent="MSWP.CONFIG_LOAD",e.DesignerIframeLoadEvent="MSWP.IFRAME_LOAD_DONE",e.DesignerControlInitEvent="MSWP.DESIGNER_CONTROL_INIT",e.DesignerControlInitErrorEvent="MSWP.DESIGNER_CONTROL_INIT_ERROR",e.DesignerControlExecutionEvent="MSWP.DESIGNER_CONTROL_EXECUTION_EVENT",e.DesignerControlExecutionErrorEvent="MSWP.DESIGNER_CONTROL_EXECUTION_ERROR",e.UserPermissionErrorEvent="MSWP.USER_PERMISSION_ERROR_EVENT"}(t.WrapperEvents||(t.WrapperEvents={})),function(e){e.DesignerConfig="0",e.Templates="1",e.WorkflowDefinition="2"}(t.RequiredCDSOpersForInit||(t.RequiredCDSOpersForInit={}))}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.icons=t.manifestOperationIds=t.manifestConnectorIds=t.getIconUrl=t.CdnGeoSettings=t.GeoNames=t.Constants=void 0;class n{}t.Constants=n,n.LogicAppDesignerRelativeUrl="/flowcontrol/DesignerBlob/iframeLogicappDesigner.html",n.BrandColor="#2266E3",n.GetRequestType="GET",n.publicFallbackURL="https://oc-cdn-ocprod.azureedge.net/",n.fairfaxFallbackURL="https://ocprodocprodnamgs.blob.core.usgovcloudapi.net/",n.gccDataCenter=["crm9"];class r{}t.GeoNames=r,r.TIP="TIP",r.GCC="GCC",r.USG="USG",r.CHN="CHN",r.DEFAULT="",t.CdnGeoSettings={[r.TIP]:n.publicFallbackURL,[r.GCC]:n.publicFallbackURL,[r.USG]:n.fairfaxFallbackURL,[r.CHN]:n.publicFallbackURL,[r.DEFAULT]:n.publicFallbackURL};let o=window.top.Xrm.Utility.getGlobalContext();function i(e){return new URL(e,o.getClientUrl()).toString()}t.getIconUrl=i,t.manifestConnectorIds={callscript:"custom/callscript"},t.manifestOperationIds={setCallScript:"setcallscript",start:"start",listFlows:"ListFlows"},t.icons={connector:{agentconnector:i("WebResources/AgentScriptDesigner/msdyn_agentConnector.svg")},operations:{setcallscript:i("WebResources/AgentScriptDesigner/msdyn_setDefaultAction.svg"),start:i("WebResources/AgentScriptDesigner/msdyn_manualTrigger.svg"),listFlows:i("WebResources/MacroDesigner/msdyn_ProductivityMacros_run_flow.svg")}}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AgentScriptUtils=void 0;t.AgentScriptUtils=class{static getResourceString(e){var t=e;return window.top.Xrm&&window.top.Xrm.Utility&&window.top.Xrm.Utility.getResourceString&&null==(t=window.top.Xrm.Utility.getResourceString("Localization/msdyn_AgentscriptComponent",e))&&(t=e),t}}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},o=/%[sdj%]/g;t.format=function(e){if(!E(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(e).replace(o,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<i;c=r[++n])m(c)||!v(c)?s+=" "+c:s+=" "+a(c);return s},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,s={};function a(e,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&t._extend(r,n),T(r.showHidden)&&(r.showHidden=!1),T(r.depth)&&(r.depth=2),T(r.colors)&&(r.colors=!1),T(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),p(r,e,r.depth)}function c(e,t){var n=a.styles[t];return n?"["+a.colors[n][0]+"m"+e+"["+a.colors[n][1]+"m":e}function l(e,t){return e}function p(e,n,r){if(e.customInspect&&n&&I(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return E(o)||(o=p(e,o,r)),o}var i=function(e,t){if(T(t))return e.stylize("undefined","undefined");if(E(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(_(t))return e.stylize(""+t,"number");if(f(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(i)return i;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),C(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return u(n);if(0===s.length){if(I(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(y(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(O(n))return e.stylize(Date.prototype.toString.call(n),"date");if(C(n))return u(n)}var l,v="",S=!1,h=["{","}"];(g(n)&&(S=!0,h=["[","]"]),I(n))&&(v=" [Function"+(n.name?": "+n.name:"")+"]");return y(n)&&(v=" "+RegExp.prototype.toString.call(n)),O(n)&&(v=" "+Date.prototype.toUTCString.call(n)),C(n)&&(v=" "+u(n)),0!==s.length||S&&0!=n.length?r<0?y(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=S?function(e,t,n,r,o){for(var i=[],s=0,a=t.length;s<a;++s)N(t,String(s))?i.push(d(e,t,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,n,r,o,!0))})),i}(e,n,r,a,s):s.map((function(t){return d(e,n,r,a,t,S)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(l,v,h)):h[0]+v+h[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),N(r,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=m(n)?p(e,c.value,null):p(e,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),T(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function g(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function _(e){return"number"==typeof e}function E(e){return"string"==typeof e}function T(e){return void 0===e}function y(e){return v(e)&&"[object RegExp]"===S(e)}function v(e){return"object"==typeof e&&null!==e}function O(e){return v(e)&&"[object Date]"===S(e)}function C(e){return v(e)&&("[object Error]"===S(e)||e instanceof Error)}function I(e){return"function"==typeof e}function S(e){return Object.prototype.toString.call(e)}function h(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(T(i)&&(i=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(i)){var r=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else s[n]=function(){};return s[n]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=g,t.isBoolean=f,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=_,t.isString=E,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=T,t.isRegExp=y,t.isObject=v,t.isDate=O,t.isError=C,t.isFunction=I,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(13);var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var e=new Date,t=[h(e.getHours()),h(e.getMinutes()),h(e.getSeconds())].join(":");return[e.getDate(),R[e.getMonth()],t].join(" ")}function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",A(),t.format.apply(t,arguments))},t.inherits=n(14),t._extend=function(e,t){if(!t||!v(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function b(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!=typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,o)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=P,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var o=n.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,s=function(){return o.apply(i,arguments)};t.apply(this,n).then((function(t){e.nextTick(s,null,t)}),(function(t){e.nextTick(b,t,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(12))},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testEnvBadge=void 0,t.testEnvBadge={name:"CUSTOM",description:"custom description"}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(3)],void 0===(o=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRecommendationRouter=t.SelectOperationResponse=t.SelectConnectorResponse=t.GoBackResponse=void 0,function(e){e.CUSTOM_CATEGORY_SELECTED="CUSTOM_CATEGORY_SELECTED",e.DEFAULT="DEFAULT"}(t.GoBackResponse||(t.GoBackResponse={})),function(e){e.CHANGE_TO_API_MANAGEMENT="CHANGE_TO_API_MANAGEMENT",e.CHANGE_TO_APP_SERVICE="CHANGE_TO_APP_SERVICE",e.CHANGE_TO_BATCH_LOGIC_APPS="CHANGE_TO_BATCH_LOGIC_APPS",e.CHANGE_TO_FUNCTIONS="CHANGE_TO_FUNCTIONS",e.CHANGE_TO_LOGIC_APPS="CHANGE_TO_LOGIC_APPS",e.SELECT_APP_SERVICE="SELECT_APP_SERVICE",e.SELECT_API_MANAGEMENT="SELECT_API_MANAGEMENT",e.SELECT_FUNCTION="SELECT_FUNCTION",e.SELECT_LOGIC_APP="SELECT_LOGIC_APP",e.SELECT_BATCH_LOGIC_APP="SELECT_BATCH_LOGIC_APP",e.DEFAULT="DEFAULT"}(t.SelectConnectorResponse||(t.SelectConnectorResponse={})),function(e){e.CHANGE_TO_API_MANAGEMENT="CHANGE_TO_API_MANAGEMENT",e.CHANGE_TO_APP_SERVICE="CHANGE_TO_APP_SERVICE",e.CHANGE_TO_BATCH_LOGIC_APPS="CHANGE_TO_BATCH_LOGIC_APPS",e.CHANGE_TO_FUNCTIONS="CHANGE_TO_FUNCTIONS",e.CHANGE_TO_LOGIC_APPS="CHANGE_TO_LOGIC_APPS",e.CREATE_AZURE_FUNCTION="CREATE_AZURE_FUNCTION",e.DEFAULT="DEFAULT",e.SELECT_API_MANAGEMENT_API="SELECT_API_MANAGEMENT_API",e.SELECT_AZURE_FUNCTION_SWAGGER_ACTION="SELECT_AZURE_FUNCTION_SWAGGER_ACTION",e.SELECT_LOGIC_APP="SELECT_LOGIC_APP",e.SELECT_SCOPE_OPERATION="SELECT_SCOPE_OPERATION"}(t.SelectOperationResponse||(t.SelectOperationResponse={})),t.isRecommendationRouter=function(e){return n.isObject(e)&&e.goBack instanceof Function&&e.selectConnector instanceof Function&&e.selectOperation instanceof Function}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(3),n(1)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;class o{static serialize(e,t,n){return e}static deserialize(e,t,n){return e}static genMsgForTelemetry(e,t){let n=e||"";return(t&&t.message||"").concat(":",n)}static getUrlParam(e,t){return o._urlParams.get(e)||t||""}static getResourceString(e,t){var r=e;return n.isNullOrUndefined(t)||(r=this.getResourceStringFromContentJson(e,t)),r===e&&window.top.Xrm&&window.top.Xrm.Utility&&window.top.Xrm.Utility.getResourceString&&null==(r=window.top.Xrm.Utility.getResourceString("Localization/ProductivityMacrosComponent_webresource_strings",e))&&(r=e),r}static getResourceStringFromContentJson(e,t){var r=e;try{t.forEach(t=>{if(!n.isNullOrUndefined(t)){var o=JSON.parse(t);if(o[e])return r=o[e]}})}catch(e){}return r}static GenGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}static logAdminTelemetry(e){window.top.Microsoft.ProductivityMacros.Internal.setMacrosAdminData(e)}static doTelemetry(e,t,n,r=!1){if(o.logAdminTelemetry(e),console.log(e.eventTimeStamp+" "+e.eventType+" "+e.level+" "+e.eventName+" "+e.message),t){let i=r?o.getResourceString(t)+". "+e.exception.innerException.message:o.getResourceString(t);window.top.Xrm.Navigation.openAlertDialog({text:i}).then((function(){n&&o.closeDesigner()}))}}static closeDesigner(e){window.top.Xrm.Page.ui.close()}static getGeoName(){let e="",t=window.top.Xrm.Utility.getGlobalContext().organizationSettings;return t&&(e=t.organizationGeo,e&&"NA"===e.toUpperCase()&&(e=t.isSovereignCloud?"GCC":e)),e}static getCdnBase(){return r.CdnGeoSettings[o.getGeoName()]||r.CdnGeoSettings[r.GeoNames.DEFAULT]}}t.Utils=o,o._urlParams=new URLSearchParams(window.location.search||window.location.hash.replace(/^#/,"?"))}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";function n(e){return(t,n)=>{const r=e(t),o=e(n);return r<o?-1:r>o?1:0}}function r(e){return(t,n)=>{const r=e(t),o=e(n);return r<o?-1:r>o?1:0}}Object.defineProperty(t,"__esModule",{value:!0}),t.comparePromotionIndex=t.compareFunctionForOperations=t.compareFunctionForConnectors=t.compareBooleans=t.CaseInsensitiveCollator=t.makeNumberComparer=t.makeBooleanComparer=void 0,t.makeBooleanComparer=n,t.makeNumberComparer=r,t.CaseInsensitiveCollator=new Intl.Collator([],{sensitivity:"base"}),t.compareBooleans=n(e=>e);const o=r(e=>e);function i(e,t){const n=void 0!==e?e:Number.MAX_VALUE,r=void 0!==t?t:Number.MAX_VALUE;return o(n,r)}t.compareFunctionForConnectors=function(e,n){return i(e.promotionIndex,n.promotionIndex)||t.CaseInsensitiveCollator.compare(e.title,n.title)},t.compareFunctionForOperations=function(e,n){return i(e.promotionIndex,n.promotionIndex)||t.compareBooleans(!!n.important,!!e.important)||t.CaseInsensitiveCollator.compare(e.subtitle,n.subtitle)||t.CaseInsensitiveCollator.compare(e.title,n.title)},t.comparePromotionIndex=i}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};r=[n,t,n(9),n(7),n(21),n(5),n(10),n(0)],void 0===(o=function(e,t,n,r,o,s,a,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.operationMatchesCategory=t.operationMatchesConnector=t.operationMatchesFilterText=t.mapToOperations=t.mapToOperation=t.connectorMatchesFilterText=t.connectorHasDisplayName=t.BuiltinProvider=void 0;const l=new Intl.Collator([],{sensitivity:"base"});class p extends a.BaseRecommendationProvider{constructor(e,t){super(t),this.recommendationOptions=e,this._includeConnectorBuiltins=!0,this._builtInTypeService=e.builtInTypeService}canAddOperation(e){return!0}getConnectorBrandColor(e){return e&&e.properties&&e.properties.metadata&&e.properties.metadata.brandColor}getConnectorIcon(e){return e&&e.properties&&e.properties.iconUri}getConnectorTitle(e){return e&&e.properties&&e.properties.iconUri}getConnectors(e,t){return i(this,void 0,void 0,(function*(){let t=this.recommendationOptions.builtInTypeService.getBuiltInConnectors();this._includeConnectorBuiltins&&(t=t.filter(_));const n=t.filter(g).filter(f(e));return{rawValue:n,value:function(e=[]){const t=function(e=[]){return t=>{const{id:n,properties:{displayName:r,metadata:o,iconUri:i}}=t,{brandColor:s}=o||{brandColor:void 0},a=e.indexOf(n);return{brandColor:s,icon:i,id:n,promotionIndex:-1===a?Number.MAX_VALUE:a,title:r}}}(e);return e=>e.map(t)}([])(n).sort(u)}}))}getConnectorsByContinuationToken(e){throw new Error("Method not implemented.")}getDefaultOperationKind(e){return e?c.Kind.Trigger:c.Kind.Action}getExtraOperations(e){return[]}getExtraOperationsByConnector(e,t){throw new Error("Method not implemented.")}getOperationKinds(){return[{itemKey:c.Kind.Action,linkText:this.designerOptions.operationKindDisplayText[c.Kind.Action]}]}getOperations(e,t){return i(this,void 0,void 0,(function*(){let n=this.getBuiltInOperations(t).filter(y(e));this._includeConnectorBuiltins&&(n=n.filter(E));return{rawValue:n,value:T([])(n).sort(d)}}))}getOperationsByConnector(e,t,n){return i(this,void 0,void 0,(function*(){let r=this.getBuiltInOperations(n).filter(v(e)).filter(y(t));this._includeConnectorBuiltins&&(r=r.filter(E));return{rawValue:r,value:T()(r).sort(d)}}))}getOperationsByContinuationToken(e){throw new Error("Method not implemented.")}getSearchBoxPlaceholder(e){return this.designerOptions.SearchHint.concat(" ",this.designerOptions.operationKindDisplayText[e])}getBuiltInOperations(e){return this._getOperations(e)}_getOperations(e){return e===c.Kind.Trigger?this.recommendationOptions.builtInTypeService.getBuiltInTriggers():this.recommendationOptions.builtInTypeService.getBuiltInActions()}goBack(){return s.GoBackResponse.DEFAULT}selectOperation(e,t){switch(e){case n.builtInOperationIds.FOREACH:case n.builtInOperationIds.IF:case n.builtInOperationIds.SCOPE:case n.builtInOperationIds.SWITCH:case n.builtInOperationIds.UNTIL:return s.SelectOperationResponse.SELECT_SCOPE_OPERATION;default:return s.SelectOperationResponse.DEFAULT}}selectConnector(e,t){switch(e){case n.builtInConnectorIds.APIMANAGEMENT:return s.SelectConnectorResponse.CHANGE_TO_API_MANAGEMENT;case n.builtInConnectorIds.APPSERVICES:return s.SelectConnectorResponse.CHANGE_TO_APP_SERVICE;case n.builtInConnectorIds.BATCH_GROUP:return t===c.Kind.Trigger?s.SelectConnectorResponse.SELECT_BATCH_LOGIC_APP:s.SelectConnectorResponse.CHANGE_TO_BATCH_LOGIC_APPS;case n.builtInConnectorIds.FUNCTION:return s.SelectConnectorResponse.CHANGE_TO_FUNCTIONS;case n.builtInConnectorIds.WORKFLOW:return s.SelectConnectorResponse.CHANGE_TO_LOGIC_APPS;default:return s.SelectConnectorResponse.DEFAULT}}}function u(e,t){return r.comparePromotionIndex(e.promotionIndex,t.promotionIndex)||l.compare(e.title,t.title)}function d(e,t){return r.comparePromotionIndex(e.promotionIndex,t.promotionIndex)||r.compareBooleans(!!t.important,!!e.important)||l.compare(e.subtitle,t.subtitle)||l.compare(e.title,t.title)}function g(e){return!!e&&!!e.properties&&!!e.properties.displayName}function f(e){return t=>!e||o.stringIncludes(t.properties.displayName,e,0)}function m(e=[],t){return t=>{const{id:n,properties:{annotation:r,api:o,description:i,summary:s}}=t,{status:a}=r||{status:void 0},{brandColor:c,displayName:l,iconUri:p,id:u}=o||{brandColor:void 0,displayName:void 0,iconUri:void 0,id:void 0},d=e.indexOf(u);return Object.assign(Object.assign({id:n,brandColor:c},u?{connector:u}:void 0),{connectorKind:"",description:i,icon:p,preview:"Preview"===a,promotionIndex:-1===d?Number.MAX_VALUE:d,subtitle:l,title:s})}}function _(e){return 0===l.compare(e.id,n.builtInConnectorIds.CONTROL_GROUP)}function E(e){const{id:t,properties:r}=e;return 0===l.compare(r.api.id,n.builtInConnectorIds.CONTROL_GROUP)&&0===l.compare(t,n.builtInOperationIds.IF)}function T(e=[]){const t=m(e);return e=>e.map(t)}function y(e){return t=>!e||o.stringIncludes(t.properties.summary,e,0)||o.stringIncludes(t.properties.description,e,0)||o.stringIncludes(t.properties.api&&t.properties.api.displayName,e,0)}function v(e){return t=>0===l.compare(t.properties.api&&t.properties.api.id,e)}t.BuiltinProvider=p,t.connectorHasDisplayName=g,t.connectorMatchesFilterText=f,t.mapToOperation=m,t.mapToOperations=T,t.operationMatchesFilterText=y,t.operationMatchesConnector=v,t.operationMatchesCategory=function(e){return t=>0===l.compare(t.properties.api&&t.properties.api.tier,e)}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.builtInSwaggerConnectorIds=t.builtInConnectorNames=t.builtInConnectorIds=t.manifestOperationIds=t.manifestConnectorIds=t.builtInOperationIds=void 0,t.builtInOperationIds={ADD_TO_TIME:"add_to_time",APIMANAGEMENT:"apimanagement",APPEND_TO_ARRAY_VARIABLE:"append_to_array_variable",APPEND_TO_STRING_VARIABLE:"append_to_string_variable",BATCH:"batch",BUTTON:"button",COMPOSE:"compose",CONVERT_TIME_ZONE:"convert_time_zone",CURRENT_TIME:"current_time",DECREMENT_VARIABLE:"decrementvariable",DELAY:"delay",DELAYUNTIL:"delay_until",EVENT_GRID:"event_grid",FLAT_FILE_DECODING:"flat_file_decoding",FLAT_FILE_ENCODING:"flat_file_encoding",FOREACH:"foreach",FUNCTION:"function",GEOFENCE_REQUEST:"geofence_request",GET_FUTURE_TIME:"get_future_time",GET_PAST_TIME:"get_past_time",HTTP_WITH_SWAGGER:"http_with_swagger",HTTP:"http",HTTPREQUESTTRIGGER:"request",HTTP_WEBHOOK:"httpwebhook",IF:"if",INCREMENT_VARIABLE:"increment_variable",INITIALIZE_VARIABLE:"initializevariable",INTEGRATION_ACCOUNT_ARTIFACT_LOOKUP:"integration_account_artifact_lookup",INTEGRATION_ACCOUNT_GET_SCHEMAS:"content_and_schema_operation_get_schemas",JOIN:"join",LIQUID_JSON_TO_JSON:"liquid_json_to_json",LIQUID_JSON_TO_TEXT:"liquid_json_to_text",LIQUID_XML_TO_JSON:"liquid_xml_to_json",LIQUID_XML_TO_TEXT:"liquid_xml_to_text",MANUALTRIGGER:"manual",PARSE_JSON:"parsejson",POWERAPPS_RESPONSE:"powerappsresponse",QUERY:"query",RECURRENCETRIGGER:"recurrence",RESPONSE:"response",SCOPE:"scope",SECURITY_CENTER_ALERT:"securitycenteralert",SELECT:"select",SEND_TO_BATCH:"sendtobatch",SET_VARIABLE:"setvariable",SUBTRACT_FROM_TIME:"subtract_from_time",SWITCH_CASE:"switchcase",SWITCH:"switch",TABLE_CSV:"table_csv",TABLE_HTML:"table_html",TERMINATE:"terminate",UNTIL:"until",WORKFLOW:"workflow",XML_VALIDATION:"xml_validation",XSLT_GET_CONTAINERS:"xslt_get_containers",XSLT_GET_FUNCTIONS:"xslt_get_functions_in_container",XSLT_GET_MAP:"xslt_get_map",XSLT_GET_MAPS:"xslt_get_maps",XSLT_TRANSFORM:"xslt_transform"},t.manifestConnectorIds={as2:"builtin/as2",rosettanet:"builtin/rosettanet",code:"builtin/code"},t.manifestOperationIds={as2Decode:"as2decode",as2Encode:"as2encode",rosettanetWaitForResponse:"rosettanetwaitforresponse",rosettanetDecode:"rosettanetdecode",rosettanetEncode:"rosettanetencode",codeJavaScript:"javascript",recurrence:"recurrence",scheduleSlidingWindow:"slidingwindow"},t.builtInConnectorIds={APIMANAGEMENT:"connectionProviders/apimanagement",APPSERVICES:"connectionProviders/appservice",FUNCTION:"connectionProviders/function",WORKFLOW:"connectionProviders/workflow",BATCH_GROUP:"connectionProviders/batch",BUTTON_GROUP:"connectionProviders/buttonGroup",CONTROL_GROUP:"connectionProviders/control",DATA_OPERATIONS_GROUP:"connectionProviders/dataOperation",DATETIME_GROUP:"connectionProviders/datetime",GEOFENCE_GROUP:"connectionProviders/geofenceGroup",HTTP_GROUP:"connectionProviders/http",INTEGRATION_ACCOUNT_GROUP:"connectionProviders/integrationAccount",POWERAPPS_GROUP:"connectionProviders/powerappsGroup",REQUEST_RESPONSE_GROUP:"connectionProviders/request",SCHEDULE_GROUP:"connectionProviders/schedule",VARIABLE_GROUP:"connectionProviders/variable"},t.builtInConnectorNames={BATCH_GROUP:"batch",CONTROL_GROUP:"control",DATA_OPERATIONS_GROUP:"dataOperation",DATETIME_GROUP:"datetime",HTTP_GROUP:"http",INTEGRATION_ACCOUNT_GROUP:"integrationAccount",REQUEST_RESPONSE_GROUP:"request",SCHEDULE_GROUP:"schedule",VARIABLE_GROUP:"variable",FLAT_FILE_GROUP:"flatFile",LIQUID_GROUP:"liquid",XML_GROUP:"xml"},t.builtInSwaggerConnectorIds={FLAT_FILE_GROUP:"connectionProviders/flatFile",LIQUID_GROUP:"connectionProviders/liquid",XML_GROUP:"connectionProviders/xml"}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r,o;r=[n,t,n(9),n(0),n(5)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRecommendationProvider=void 0;t.BaseRecommendationProvider=class{constructor(e){this.designerOptions=e}getConnectorBrandColor(e){return e&&e.properties&&e.properties.metadata&&e.properties.metadata.brandColor}getConnectorIcon(e){return e&&e.properties&&e.properties.iconUri}getConnectorTitle(e){return e&&e.properties&&e.properties.displayName}getDefaultOperationKind(e){return e?r.Kind.Trigger:r.Kind.Action}getExtraOperations(e){return[]}getOperationKinds(){return[{itemKey:r.Kind.Trigger,linkText:this.designerOptions.operationKindDisplayText[r.Kind.Trigger]},{itemKey:r.Kind.Action,linkText:this.designerOptions.operationKindDisplayText[r.Kind.Action]}]}getSearchBoxPlaceholder(e){return this.designerOptions.SearchHint.concat(" ",this.designerOptions.operationKindDisplayText[e])}getUserVoiceProps(){return{segments:[{text:this.designerOptions.UserVoiceMessage,disabled:!1,href:this.designerOptions.UserVoiceURL}],disabled:!1}}goBack(){return o.GoBackResponse.DEFAULT}selectConnector(e,t){return o.SelectConnectorResponse.DEFAULT}selectOperation(e,t){switch(e){case n.builtInOperationIds.FOREACH:case n.builtInOperationIds.IF:case n.builtInOperationIds.SCOPE:case n.builtInOperationIds.SWITCH:case n.builtInOperationIds.UNTIL:return o.SelectOperationResponse.SELECT_SCOPE_OPERATION;default:return o.SelectOperationResponse.DEFAULT}}shouldAllowTriggerSelectionAsAction(e,t,n){return!1}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};r=[n,t,n(0),n(6),n(2),n(1),n(15),n(3)],void 0===(o=function(e,t,r,o,s,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let p=document.getElementById("cancelButton");function u(e){return i(this,void 0,void 0,(function*(){window.top.Xrm.Page.ui.close()}))}p.innerHTML=s.AgentScriptUtils.getResourceString(r.Constants.MACRO_ACTION_CANCEL),p&&p.addEventListener("click",u);let d={};d[r.RequiredCDSOpersForInit.DesignerConfig]=function(){return i(this,void 0,void 0,(function*(){return new Promise((function(e,t){return i(this,void 0,void 0,(function*(){let n=window.top.Xrm.Utility.getGlobalContext().getOrgLcid(),i=r.LOCALE_MAP[n]||"en",c="",p="",u={DesignerInstanceId:o.Utils.GenGuid()},d=yield window.top.Xrm.WebApi.retrieveMultipleRecords(r.Constants.MACRO_CONFIG_ENTITY,"?$select=msdyn_designerfallbackurl,msdyn_designerurlrelativepath,msdyn_designerurlconfigentity,msdyn_designerurlconfigentityid,msdyn_designerurlconfigentityattrib,msdyn_designerurlconfigentityquery,msdyn_name,msdyn_uservoicelink,msdyn_searchhint,msdyn_uservoicetext,msdyn_macrosversion");if(d.entities.length>0){let e=d.entities[0];if(p=a.Constants.LogicAppDesignerRelativeUrl,u.UserVoiceText=e.msdyn_uservoicetext,u.UserVoiceLink=e.msdyn_uservoicelink,u.SearchHint=s.AgentScriptUtils.getResourceString("LADESIGNER_SEARCHTEXT"),u.DesignerSolutionVersion=e.msdyn_macrosversion,e.msdyn_designerurlconfigentity&&e.msdyn_designerurlconfigentityattrib){if(e.msdyn_designerurlconfigentityid)try{c=(yield window.top.Xrm.WebApi.retrieveRecord(e.msdyn_designerurlconfigentity,e.msdyn_designerurlconfigentityid,"?$select="+e.msdyn_designerurlconfigentityattrib))[e.msdyn_designerurlconfigentityattrib]}catch(e){m({level:r.LogLevel.Warning,eventName:r.WrapperEvents.WrapperConfigErrorEvent,message:o.Utils.genMsgForTelemetry("Config entity id configured but unable to read designer URL",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack})}if(e.msdyn_designerurlconfigentityquery&&!c)try{let t=yield window.top.Xrm.WebApi.retrieveMultipleRecords(e.msdyn_designerurlconfigentity,e.msdyn_designerurlconfigentityquery);t.entities.length>0&&(c=t.entities[0][e.msdyn_designerurlconfigentityattrib])}catch(e){m({level:r.LogLevel.Warning,eventName:r.WrapperEvents.WrapperConfigErrorEvent,message:o.Utils.genMsgForTelemetry("Config entity query configured but unable to read designer URL",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack})}}if(!c)if(l.isNullOrUndefined(e.msdyn_designerfallbackurl))try{let e=window.top.Xrm.Utility.getGlobalContext().getClientUrl().split(".")[1];c=-1!=a.Constants.gccDataCenter.indexOf(e)?a.Constants.fairfaxFallbackURL:a.Constants.publicFallbackURL}catch(e){m({level:r.LogLevel.Warning,eventName:r.WrapperEvents.WrapperConfigErrorEvent,message:o.Utils.genMsgForTelemetry("Error in setting fallback designer URL",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack})}else c=e.msdyn_designerfallbackurl}c&&p?(u.DesignerBaseURL=new URL(p+"?locale="+i+"&base="+encodeURIComponent(window.top.Xrm.Utility.getGlobalContext().getClientUrl()),c).toString(),m({level:r.LogLevel.Info,eventName:r.WrapperEvents.WrapperConfigLoadEvent,message:o.Utils.genMsgForTelemetry("Designer config loaded"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,eventData:{data:u}}),e(u)):(m({level:r.LogLevel.Error,eventName:r.WrapperEvents.WrapperConfigErrorEvent,message:o.Utils.genMsgForTelemetry("No valid designer URL configured"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace},"DESIGNER_CONFIG_ERROR_URL_NOT_FOUND",!0),t(new Error("Unable to find designer config")))}))}))}))}(),d[r.RequiredCDSOpersForInit.Templates]=c.Macros.getActionTemplates(),d[r.RequiredCDSOpersForInit.WorkflowDefinition]=c.Macros.getDefinition(),function(){i(this,void 0,void 0,(function*(){let e=document.getElementById("designerIframe"),t=(yield d[r.RequiredCDSOpersForInit.DesignerConfig]).DesignerBaseURL||"";t&&(e.onload=function(){m({level:r.LogLevel.Info,eventName:r.WrapperEvents.DesignerIframeLoadEvent,message:o.Utils.genMsgForTelemetry("Designer iframe loaded"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace})},e.src=t)}))}();let g={};g[r.Kind.Action]=s.AgentScriptUtils.getResourceString("DESIGNER_ACTION"),g[r.Kind.Trigger]=s.AgentScriptUtils.getResourceString("DESIGNER_TRIGGER");let f={definition:"",id:"",name:"",description:""};function m(e,t,n){console.log(e.eventTimeStamp+" "+e.eventType+" "+e.level+" "+e.eventName+" "+e.message),t&&window.top.Xrm.Navigation.openAlertDialog({text:s.AgentScriptUtils.getResourceString(t)}).then((function(){n&&u()}))}Promise.resolve().then((function(){var e=[n(22)];(function(e){return i(this,void 0,void 0,(function*(){let t=document.getElementById("designerIframe"),n=(yield d[r.RequiredCDSOpersForInit.DesignerConfig]).DesignerBaseURL||"*",a=new e.Rpc({signature:r.Constants.WRAPPER_CONTROL_SIGNATURE,targetOrigin:n,rpcMessageHandler:new e.WindowPostMessageRpcHandler({targetWindow:t.contentWindow,messageSerializer:function(e){return o.Utils.serialize(e,r.Constants.WRAPPER_CONTROL_SIGNATURE,r.Constants.DESIGNER_CONTROL_SIGNATURE)},messageDeserializer:function(e){return o.Utils.deserialize(e,r.Constants.DESIGNER_CONTROL_SIGNATURE,r.Constants.WRAPPER_CONTROL_SIGNATURE)}})});a.register(r.WrapperMessages.GetCrmData,(function(){return function(){return i(this,void 0,void 0,(function*(){let e={value:[]},t=o.Utils.getUrlParam(r.Constants.MACRO_ID),n=[];try{(yield window.top.Xrm.WebApi.retrieveMultipleRecords("msdyn_sessiontemplate","?$filter=msdyn_sessiontemplateid eq '"+t+"'&$expand=msdyn_msdyn_prod_agentscript_msdyn_sessiontemplat($select=msdyn_name,msdyn_productivityagentscriptid,msdyn_description)&$select=msdyn_name")).entities.forEach((function(e){e.msdyn_msdyn_prod_agentscript_msdyn_sessiontemplat.forEach((function(e){let t={value:e.msdyn_productivityagentscriptid,displayName:e.msdyn_name,description:e.msdyn_description,disabled:!1};n.push(t)}))})),e.value=n}catch(e){m({level:r.LogLevel.Error,eventName:r.WrapperEvents.DesignerControlExecutionEvent,message:o.Utils.genMsgForTelemetry("Unable to get Agent Script List",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack})}return JSON.stringify(e)}))}()})),a.register(r.WrapperMessages.DesignerInitDone,(function(){console.log("Designer Init Done"),function(e){i(this,void 0,void 0,(function*(){try{let t={ApiVersion:"1.0",BaseUrl:window.location.hostname,location:"NAM",resourceGroup:"resourcegroup",subscriptionId:"subscription",resourceId:"resourceId",Categories:[],SearchHint:"",UserVoiceMessage:"",environmentName:window.top.Xrm.Utility.getGlobalContext().getOrgUniqueName(),environmentDescription:window.top.Xrm.Utility.getGlobalContext().getOrgUniqueName(),Connectors:[],Actions:[],Triggers:[],OperationManifest:[],operationKindDisplayText:g};try{let e=yield d[r.RequiredCDSOpersForInit.DesignerConfig],n=yield d[r.RequiredCDSOpersForInit.Templates];t.ApiVersion=e.DesignerSolutionVersion||t.ApiVersion,t.SearchHint=s.AgentScriptUtils.getResourceString("LADESIGNER_SEARCHTEXT"),t.UserVoiceMessage=e.UserVoiceText||s.AgentScriptUtils.getResourceString("DESIGNER_USERVOICEMSG"),t.UserVoiceURL=e.UserVoiceLink,t.Actions=n.actions,t.Triggers=n.triggers,t.Connectors=n.connectors,t.Categories=n.categories,t.OperationManifest=n.operationManifestData,m({level:r.LogLevel.Info,eventName:r.WrapperEvents.WrapperConfigLoadEvent,message:o.Utils.genMsgForTelemetry("Designer action templates loaded"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace})}catch(e){m({level:r.LogLevel.Error,eventName:r.WrapperEvents.WrapperConfigErrorEvent,message:o.Utils.genMsgForTelemetry("Unable to load templates",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack},"DESIGNER_CONFIG_ERROR_TEMPLATES_NOT_FOUND")}try{yield e.call(r.DesignerMessages.Initialize,[JSON.stringify(t)]);m({level:r.LogLevel.Info,eventName:r.WrapperEvents.DesignerControlInitEvent,message:o.Utils.genMsgForTelemetry("Designer control init done"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace})}catch(e){return void m({level:r.LogLevel.Error,eventName:r.WrapperEvents.DesignerControlInitErrorEvent,message:o.Utils.genMsgForTelemetry("Unable to initialize designer control",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack},"DESIGNER_CONTROL_INIT_FAILURE",!0)}try{f=yield d[r.RequiredCDSOpersForInit.WorkflowDefinition],m({level:r.LogLevel.Info,eventName:r.WrapperEvents.DesignerControlInitEvent,message:o.Utils.genMsgForTelemetry("Workflow definition read from CDS done"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace})}catch(e){return void m({level:r.LogLevel.Error,eventName:r.WrapperEvents.DesignerControlInitErrorEvent,message:o.Utils.genMsgForTelemetry("Unable to read workflow definition from CDS",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack},"DESIGNER_CONFIG_ERROR_INVALID_MACRO_DEFINITION",!0)}try{yield e.call(r.DesignerMessages.LoadDefinition,[JSON.stringify({definition:f.definition,references:[],sku:{name:"Free"}}),JSON.stringify(t)]);console.log("Starting designer render"),m({level:r.LogLevel.Info,eventName:r.WrapperEvents.DesignerControlInitEvent,message:o.Utils.genMsgForTelemetry("Expression definition loaded into designer control"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace})}catch(e){return void m({level:r.LogLevel.Error,eventName:r.WrapperEvents.DesignerControlInitEvent,message:o.Utils.genMsgForTelemetry("Unable to load expression definition to designer",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack},"DESIGNER_CONTROL_LOAD_FAILURE",!0)}try{yield e.call(r.DesignerMessages.RenderDesigner);document.getElementById("designerContainerSpinner").style.display="none",document.getElementById("designerIframe").style.display="inline",m({level:r.LogLevel.Info,eventName:r.WrapperEvents.DesignerControlInitEvent,message:o.Utils.genMsgForTelemetry("Designer render complete"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace})}catch(e){return void m({level:r.LogLevel.Error,eventName:r.WrapperEvents.DesignerControlInitErrorEvent,message:o.Utils.genMsgForTelemetry("Unable to render designer",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack},"DESIGNER_CONTROL_RENDER_FAILURE",!0)}let n=document.getElementById("saveButton");n.innerHTML=s.AgentScriptUtils.getResourceString(r.Constants.MACRO_ACTION_SAVE_AND_CLOSE),n&&n.addEventListener("click",(function(t){return i(this,void 0,void 0,(function*(){try{let t=yield e.call(r.DesignerMessages.GetDefinition);m({level:r.LogLevel.Info,eventName:r.WrapperEvents.DesignerControlExecutionEvent,message:o.Utils.genMsgForTelemetry("Macro definition JSON generation done"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace});let n={definition:JSON.parse(t).definition};if(console.log("Got workflow definition for expression '"+name+"' ="+JSON.stringify(n)),f.id)try{yield window.top.Xrm.WebApi.updateRecord(r.Constants.SESSION_TEMPLATE_ENTITY,f.id,{msdyn_expressiondata:JSON.stringify(n)});m({level:r.LogLevel.Info,eventName:r.WrapperEvents.DesignerControlExecutionEvent,message:o.Utils.genMsgForTelemetry("Macro definition successfully updated"),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace}),u()}catch(e){return void m({level:r.LogLevel.Error,eventName:r.WrapperEvents.DesignerControlExecutionErrorEvent,message:o.Utils.genMsgForTelemetry("Unable to update expression definition",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack},"DESIGNER_CONTROL_CDS_WRITE_ERROR")}}catch(e){return void m({level:r.LogLevel.Error,eventName:r.WrapperEvents.DesignerControlExecutionErrorEvent,message:o.Utils.genMsgForTelemetry("Macro definition JSON generation error",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack},"DESIGNER_CONTROL_JSON_GENERATION_ERROR")}}))}))}catch(e){return console.log("designer load error "+e),void m({level:r.LogLevel.Error,eventName:r.WrapperEvents.DesignerControlInitErrorEvent,message:o.Utils.genMsgForTelemetry("Unknown error trying to load designer",e),eventTimeStamp:new Date,eventType:r.TelemetryEventType.Trace,exception:e.stack},"DESIGNER_CONTROL_INIT_FAILURE",!0)}}))}(a)}))}))}).apply(null,e)})).catch(n.oe)}.apply(t,r))||(e.exports=o)},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,l=[],p=!1,u=-1;function d(){p&&c&&(p=!1,c.length?l=c.concat(l):u=-1,l.length&&g())}function g(){if(!p){var e=a(d);p=!0;for(var t=l.length;t;){for(c=l,l=[];++u<t;)c&&c[u].run();u=-1,t=l.length}c=null,p=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||p||a(g)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){var r,o,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};r=[n,t,n(2),n(6),n(0),n(16),n(19)],void 0===(o=function(e,t,n,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Macros=void 0;class c{static getActionTemplates(){return i(this,void 0,void 0,(function*(){let e=s.CustomActions,t=s.CustomTriggers,r=[],o=s.customConnectors,i=s.operationManifestMetadata;return r=[{itemKey:a.LogicAppsCategories.LOGIC_APPS_BUILTIN,linkText:n.AgentScriptUtils.getResourceString("LADESIGNER_RECOMMENDATION_CATEGORY_LOGICAPP_BUILTIN")},{itemKey:a.LogicAppsCategories.CUSTOM,linkText:n.AgentScriptUtils.getResourceString("LADESIGNER_RECOMMENDATION_CATEGORY_CUSTOM")}],{actions:e,triggers:t,connectors:o,categories:r,operationManifestData:i}}))}static getDefinition(){return i(this,void 0,void 0,(function*(){let e=r.Utils.getUrlParam(o.Constants.MACRO_ID);if(c.definition.triggers[c.start_header]=c.start_data,c.definition.actions[c.condition_header]=c.condition_data,!e)return{definition:c.definition,name:"",description:"",id:""};try{let t=yield window.top.Xrm.WebApi.retrieveRecord(o.Constants.SESSION_TEMPLATE_ENTITY,e,"?$select=msdyn_name,msdyn_description,msdyn_expressiondata");return t.msdyn_expressiondata?{definition:JSON.parse(t.msdyn_expressiondata).definition,name:t.name,description:t.description,id:e}:{definition:c.definition,name:t.name,description:t.description,id:e}}catch(e){return{definition:c.definition,name:"",description:"",id:""}}}))}}t.Macros=c,c.start_header=n.AgentScriptUtils.getResourceString("LADESIGNER_START_SUMMARY"),c.condition_header=n.AgentScriptUtils.getResourceString("LADESIGNER_CONDITION_SUMMARY"),c.definition={$schema:"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json",actions:{},triggers:{}},c.start_data={type:"start",inputs:{schema:{type:"object",required:[],properties:{}}}},c.condition_data={actions:{},expression:{and:[{equals:["",""]}]},runAfter:{},type:"If"},c.testDefinition={$schema:"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json",actions:{TestBuiltInActionPropertiesSummary:{type:"TestBuiltInActionType",runAfter:{}},TestBuiltInActionPropertiesSummary_2:{type:"TestBuiltInActionType",runAfter:{TestBuiltInActionPropertiesSummary:["Succeeded"]}},TestBuiltInActionPropertiesSummary_3:{type:"TestBuiltInActionType",runAfter:{TestBuiltInActionPropertiesSummary_2:["Succeeded"]}}},parameters:{$authentication:{defaultValue:{},type:"SecureObject"}},triggers:{manual:{kind:"PowerApps",type:"manual",inputs:{}}},contentVersion:"1.0.0.0"}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(4),n(17),n(18),n(2),n(1),n(0)],void 0===(o=function(e,t,n,r,o,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogicAppsCategories=t.operationManifestMetadata=t.CustomTriggers=t.CustomActions=t.customConnectors=void 0,t.customConnectors=[{brandColor:s.Constants.BrandColor,icon:s.icons.connector.agentconnector,id:s.manifestConnectorIds.callscript,title:i.AgentScriptUtils.getResourceString("LADESIGNER_CALLSCRIPT_CONNECTOR_DISPLAYNAME")}],t.CustomActions=[{id:s.manifestOperationIds.setCallScript,type:"builtin",name:s.manifestOperationIds.setCallScript,kind:a.Kind.Action,properties:{api:{brandColor:s.Constants.BrandColor,displayName:i.AgentScriptUtils.getResourceString("LADESIGNER_CALLSCRIPT_CONNECTOR_DISPLAYNAME"),iconUri:s.icons.operations.setcallscript,id:s.manifestConnectorIds.callscript},summary:i.AgentScriptUtils.getResourceString("LADESIGNER_SETCALLSCRIPT_SUMMARY"),description:i.AgentScriptUtils.getResourceString("LADESIGNER_SETCALLSCRIPT_DESCRIPTION"),environmentBadge:n.testEnvBadge,operationType:"setcallscript",operationKind:a.Kind.Action,visibility:"important"}}],t.CustomTriggers=[{id:s.manifestOperationIds.start,type:"builtin",name:s.manifestOperationIds.start,kind:a.Kind.Trigger,properties:{api:{brandColor:s.Constants.BrandColor,displayName:i.AgentScriptUtils.getResourceString("LADESIGNER_CALLSCRIPT_CONNECTOR_DISPLAYNAME"),iconUri:s.icons.operations.start,id:s.manifestConnectorIds.callscript},summary:i.AgentScriptUtils.getResourceString("LADESIGNER_START_SUMMARY"),description:i.AgentScriptUtils.getResourceString("LADESIGNER_START_DESCRIPTION"),environmentBadge:n.testEnvBadge,operationType:"start",operationKind:a.Kind.Trigger,visibility:"important"}}],t.operationManifestMetadata=[{conditions:{operationType:"setcallscript"},connectorId:s.manifestConnectorIds.callscript,operationId:s.manifestOperationIds.setCallScript,manifest:r.default},{conditions:{operationType:"start"},connectorId:s.manifestConnectorIds.callscript,operationId:s.manifestOperationIds.start,manifest:o.default}],function(e){e.LOGIC_APPS_BUILTIN="LOGIC_APPS_BUILTIN",e.CUSTOM="CUSTOM"}(t.LogicAppsCategories||(t.LogicAppsCategories={}))}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(4),n(2),n(1)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={properties:{iconUri:o.icons.operations.setcallscript,brandColor:o.Constants.BrandColor,description:r.AgentScriptUtils.getResourceString("LADESIGNER_SETCALLSCRIPT_DESCRIPTION"),environmentBadge:n.testEnvBadge,inputs:{type:"object",properties:{callscriptId:{title:r.AgentScriptUtils.getResourceString("LADESIGNER_SETCALLSCRIPT_INPUT_ID_TITLE"),description:r.AgentScriptUtils.getResourceString("LADESIGNER_SETCALLSCRIPT_INPUT_ID_DESCRIPTION"),type:"string","x-ms-property-name-alias":"callscriptId","x-ms-dynamic-list":{operationId:"setcallscript",parameters:{},itemsPath:"value",itemValuePath:"Name",itemTitlePath:"DisplayName"}}},required:["callscriptId"]},isInputsOptional:!1,isOutputsOptional:!0}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(4),n(2),n(1)],void 0===(o=function(e,t,n,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={properties:{iconUri:o.icons.operations.start,brandColor:o.Constants.BrandColor,description:r.AgentScriptUtils.getResourceString("LADESIGNER_START_DESCRIPTION"),environmentBadge:n.testEnvBadge}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o;r=[n,t,n(20),n(8)],void 0===(o=function(e,t,n,r){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.SmartRecommendationImpl=t.LogicAppsCategories=void 0,function(e){e.LOGIC_APPS_BUILTIN="LOGIC_APPS_BUILTIN",e.CUSTOM="CUSTOM"}(o=t.LogicAppsCategories||(t.LogicAppsCategories={}));t.SmartRecommendationImpl=class{constructor(e,t){this.recommendationOptions=e,this.designerOptions=t,this._recommendationProviders={},this._recommendationProviders={[o.LOGIC_APPS_BUILTIN]:new r.BuiltinProvider({builtInTypeService:e.builtInTypeService},t),[o.CUSTOM]:new n.CustomRecommendationProvider(t)}}getConnectorBrandColor(e,t){return this._recommendationProviders[e].getConnectorBrandColor(t)}getConnectorIcon(e,t){return this._recommendationProviders[e].getConnectorIcon(t)}getConnectorTitle(e,t){return this._recommendationProviders[e].getConnectorTitle(t)}getConnectorsByCategory(e,t,n){return this._recommendationProviders[e].getConnectors(t,n)}getConnectorsByContinuationToken(e,t){return this._recommendationProviders[e].getConnectorsByContinuationToken(t)}getCategories(){return this.designerOptions.Categories}getDefaultCategoryKey(){return o.LOGIC_APPS_BUILTIN}getDefaultOperationKind(e,t){return this._recommendationProviders[e].getDefaultOperationKind(t)}getExtraOperations(e,t){return this._recommendationProviders[e].getExtraOperations(t)}getOperationKindsByCategory(e){return this._recommendationProviders[e].getOperationKinds()}getOperationsByCategory(e,t,n){return this._recommendationProviders[e].getOperations(t,n)}getOperationsByConnector(e,t,n,r){return this._recommendationProviders[e].getOperationsByConnector(t,n,r)}getOperationsByContinuationToken(e,t){return this._recommendationProviders[e].getOperationsByContinuationToken(t)}getProvider(e){return this._recommendationProviders[e]}getSearchBoxPlaceholder(e,t){return this._recommendationProviders[e].getSearchBoxPlaceholder(t)}getUserVoicePropsByCategory(e){return this._recommendationProviders[e].getUserVoiceProps()}goBack(e){return this._recommendationProviders[e].goBack()}selectConnector(e,t,n){return this._recommendationProviders[e].selectConnector(t,n)}selectOperation(e,t,n){return this._recommendationProviders[e].selectOperation(t,n)}}}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};r=[n,t,n(7),n(5),n(8),n(0),n(10)],void 0===(o=function(e,t,n,r,o,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomRecommendationProvider=void 0;class c extends a.BaseRecommendationProvider{constructor(e){super(e),this.designerOptions=e}canAddOperation(e){return!0}getConnectorBrandColor(e){return e&&e.brandColor}getConnectorIcon(e){return e&&e.icon}getConnectorTitle(e){return e&&e.title}getConnectors(e,t){const n=this.designerOptions.Connectors;return Promise.resolve({rawValue:n,value:n})}getConnectorsByContinuationToken(e){const t=this.designerOptions.Connectors;return Promise.resolve({rawValue:t,value:t})}getDefaultOperationKind(e){return e?s.Kind.Trigger:s.Kind.Action}getExtraOperations(e){return[]}getExtraOperationsByConnector(e,t){return Promise.resolve([])}getOperationKinds(){return[{itemKey:s.Kind.Action,linkText:this.designerOptions.operationKindDisplayText[s.Kind.Action]}]}getOperations(e,t){return i(this,void 0,void 0,(function*(){let e=this._getOperations(t);return{rawValue:e,value:o.mapToOperations([])(e).sort(n.compareFunctionForOperations)}}))}getOperationsByConnector(e,t,r){return i(this,void 0,void 0,(function*(){let e=this._getOperations(r);return{rawValue:e,value:o.mapToOperations([])(e).sort(n.compareFunctionForOperations)}}))}getOperationsByContinuationToken(e){throw new Error("Method not implemented.")}getSearchBoxPlaceholder(e){return this.designerOptions.SearchHint.concat(" ",this.designerOptions.operationKindDisplayText[e])}goBack(){return r.GoBackResponse.DEFAULT}selectConnector(e,t){return r.SelectConnectorResponse.DEFAULT}selectOperation(e,t){return r.SelectOperationResponse.DEFAULT}_getOperations(e){return e===s.Kind.Trigger?this.designerOptions.Triggers:this.designerOptions.Actions}}t.CustomRecommendationProvider=c}.apply(t,r))||(e.exports=o)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=t.stringIncludes=void 0,t.stringIncludes=function(e,t,n,r=!0){return void 0===n&&(n=0),r?String.prototype.indexOf.call(e.toLowerCase(),t.toLowerCase(),n)>=0:String.prototype.indexOf.call(e,t,n)>=0},t.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var r,o,i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(s,a)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};r=[n,t,n(1),n(2)],void 0===(o=function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="__PING__";function c(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}var l=function(){function e(e){var t=this;if(this._deferredResponses={},this._rpcMethods={},this._ready=!1,this._queuedRequestMessages=[],this._onRpcMessageRecieved=function(e){if(e&&e.signature===t._rpcOptions.signature){var n=e;n.method?t._onRpcRequestMessageReceived(n):t._onRpcResponseMessageReceived(e)}},this._onRpcRequestMessageReceived=function(e){var n=t._rpcMethods[e.method];if(n){var r={signature:e.signature,id:e.id,error:null};try{var o=n.apply(t,e.params);t._rpcOptions.Promise.resolve(o).then((function(e){r.result=e,t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)})).catch((function(e){r.error=t._serializeError(e),t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)}))}catch(e){r.error=t._serializeError(e),t._rpcOptions.rpcMessageHandler.postMessage(r,t._rpcOptions.targetOrigin)}}},this._onRpcResponseMessageReceived=function(e){var n=t._deferredResponses[e.id];n&&(e.error?n.reject(t._deserializeError(e.error)):n.resolve(e.result),delete t._deferredResponses[e.id])},!e)throw new Error("rpcOptions required");this._rpcOptions=i({Promise:{defer:c,resolve:function(e){return Promise.resolve(e)},reject:function(e){return Promise.reject(e)}}},e),this._rpcOptions.rpcMessageHandler.addListener(this._onRpcMessageRecieved),this.register(o,this._onPing)}return e.prototype.ack=function(){return s(this,void 0,void 0,(function(){var e,t;return a(this,(function(n){switch(n.label){case 0:this.unregister(o),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.call(o)];case 2:if("__PONG__"!==(e=n.sent()))throw new Error("Invalid PONG message "+e);return this._ready=!0,this._processQueue(),[3,4];case 3:throw t=n.sent(),this.register(o,this._onPing),console.error("PING failed to receive PONG message",t),t;case 4:return[2]}}))}))},e.prototype.call=function(e,t){var n=r.default(),i={signature:this._rpcOptions.signature,id:n,method:this._normalizeMethodName(e),params:t},s=this._rpcOptions.Promise.defer();return this._deferredResponses[n]=s,this._ready||e===o?this._call(i):this._queuedRequestMessages.push(i),s.promise},e.prototype.register=function(e,t){var n=this._normalizeMethodName(e);if(this._rpcMethods[n])throw new Error("Rpc method with name '"+e+"' already registered.");this._rpcMethods[n]=t},e.prototype.unregister=function(e){var t=this._normalizeMethodName(e);if(!this._rpcMethods[t])throw new Error("Rpc method with name "+e+" failed to unregister. Method not found");delete this._rpcMethods[t]},e.prototype.dispose=function(){this._rpcMethods={};for(var e=0,t=Object.keys(this._deferredResponses);e<t.length;e++){var n=t[e];this._deferredResponses[n].reject(new Error("rpc disposed"))}this._deferredResponses={},this._rpcOptions.rpcMessageHandler.removeListener(this._onRpcMessageRecieved)},e.prototype._call=function(e){try{this._rpcOptions.rpcMessageHandler.postMessage(e,this._rpcOptions.targetOrigin)}catch(t){this._deferredResponses[e.id].reject(t),delete this._deferredResponses[e.id]}},e.prototype._onPing=function(){return this.unregister(o),this._ready=!0,this._processQueue(),"__PONG__"},e.prototype._processQueue=function(){for(var e=0,t=this._queuedRequestMessages;e<t.length;e++){var n=t[e];this._call(n)}this._queuedRequestMessages=[]},e.prototype._normalizeMethodName=function(e){return e.toUpperCase()},e.prototype._serializeError=function(e){if(e instanceof Error){for(var t={name:e.name,message:e.message,_stack:e.stack},n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];t[o]=e[o]}return{value:t}}return{value:e}},e.prototype._deserializeError=function(e){return new n.RpcException("ReceiverFailed","Receiver failed",n.convertToException(e.value))},e}();t.Rpc=l;var p=function(){function e(e){if(this._listeners={},!e)throw new Error("options required");if(!e.targetWindow)throw new Error("targetWindow required");this._options=i({sourceWindow:window,messageSerializer:function(e){return e},messageDeserializer:function(e){return e}},e)}return e.prototype.postMessage=function(e,t){this._options.targetWindow.postMessage(this._options.messageSerializer(e),t)},e.prototype.addListener=function(e){var t=this;this._listeners[e]&&console.error("duplicate rpc listener added"),this._listeners[e]=function(n){var r=t._options.messageDeserializer(n.data);r&&(r.method?e({signature:r.signature,id:r.id,method:r.method,params:r.params}):e({signature:r.signature,id:r.id,result:r.result,error:r.error}))},this._options.sourceWindow.addEventListener("message",this._listeners[e])},e.prototype.removeListener=function(e){this._options.sourceWindow.removeEventListener("message",this._listeners[e]),delete this._listeners[e]},e}();t.WindowPostMessageRpcHandler=p}.apply(t,r))||(e.exports=o)},function(e,t,n){var r,o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,o){var i=r&&r instanceof Error?r:new Error(n);if(!e)throw new s("Type cannot be empty for exception");if(this._type=e,!t)throw new s("Code cannot be empty for exception");if(this._code=t,!n)throw new s("Message cannot be empty for exception");this._message=n,this._data=r,this._stackTrace=i.stack,this._innerException=o}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"code",{get:function(){return this._code},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stackTrace",{get:function(){return this._stackTrace},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"innerException",{get:function(){return this._innerException},enumerable:!0,configurable:!0}),e}();t.Exception=n;var r=function(e){function t(t){return e.call(this,"UnknownException","UnknownException","Unknown error.",t)||this}return i(t,e),t}(n);t.UnknownException=r;var o=function(e){function t(t,n,r){return e.call(this,"RpcException",t,n,void 0,r)||this}return i(t,e),t}(n);t.RpcException=o;var s=function(e){function t(t){return e.call(this,"ArgumentException","ArgumentException",t)||this}return i(t,e),t}(n);t.ArgumentException=s,t.convertToException=function(e){return e instanceof Error||e.name&&e.message&&!e.hasOwnProperty("_stackTrace")?new n("ErrorException","Error",e.message,e):e.type&&e.code&&e.message&&e.hasOwnProperty("_stackTrace")?e:new r(e)}}.apply(t,[n,t]))||(e.exports=r)},function(e,t,n){var r;void 0===(r=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"];t.default=function(){for(var e,t="",r=0;r<4;r++)e=4294967296*Math.random()|0,t+=n[15&e]+n[e>>4&15]+n[e>>8&15]+n[e>>12&15]+n[e>>16&15]+n[e>>20&15]+n[e>>24&15]+n[e>>28&15];var o=n[8+4*Math.random()|0];return t.substr(0,8)+"-"+t.substr(9,4)+"-4"+t.substr(13,3)+"-"+o+t.substr(16,3)+"-"+t.substr(19,12)}}.apply(t,[n,t]))||(e.exports=r)}])}.call(t,n,t,e))||(e.exports=r)}]);
//# sourceMappingURL=msdyn_agentScriptDesigner.bundle.js.map