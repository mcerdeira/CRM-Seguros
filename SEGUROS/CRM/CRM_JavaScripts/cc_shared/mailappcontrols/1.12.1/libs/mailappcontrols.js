var MscrmControls;!function(t){var e;!function(t){"use strict";var e=function(){function t(){}return t.prototype.init=function(t,e,n){this._context=t},t.prototype.updateView=function(t){if(this._context=t,!t.parameters.value||!t.parameters.value.raw)return t.factory.createElement("CONTAINER",{id:"AccountControlEmptyContainer",key:"AccountControlEmptyContainer"});this._accountRecord=this._context.parameters.value.raw;var e=t.factory.createElement("LABEL",{key:"AccountControlHeaderLabel",style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.regular,paddingBottom:this._context.theming.measures.measure100}},this._context.resources.getString("AccountControl_Header"));return t.factory.createElement("CONTAINER",{id:"AccountControlContainer",key:"AccountControlContainer",style:{display:"block",width:"100%",color:this._context.theming.colors.grays.gray05,backgroundColor:this._context.theming.colors.whitebackground,paddingTop:this._context.theming.measures.measure100,paddingLeft:this._context.theming.measures.measure100,paddingRight:this._context.theming.measures.measure050,paddingBottom:this._context.theming.measures.measure100,boxSizing:"border-box"}},[e,this._renderAccountForm()])},t.prototype._renderAccountForm=function(){return this._context.factory.createElement("CONTAINER",{id:"AccountForm",key:"AccountForm",style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},[this._renderAccountIcon(),this._renderAccountLink(),this._renderCommandBar()])},t.prototype._renderAccountLink=function(){var t=this._getAccountName();return this._context.factory.createElement("LABEL",{key:"AccountLink",id:"AccountLink",style:{cursor:"pointer",textDecoration:"none",display:"block",flex:"1 1 auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:this._context.theming.colors.basecolor.blue.blue3,fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.semibold},tabIndex:0,title:t,role:"link",onClick:this._onAccountNameClick.bind(this),onKeyDown:this._onAccountNameKeyDown.bind(this)},[t])},t.prototype._onAccountNameClick=function(){var t={entityName:this._getEntityName(),entityId:this._getAccountId()};this._context.navigation.openForm(t)},t.prototype._onAccountNameKeyDown=function(t){13===t.keyCode&&this._onAccountNameClick()},t.prototype._renderAccountIcon=function(){var t=this._getAccountImageUrl(),e=this._context.factory.createElement("ENTITYIMAGE",{key:"AccountIcon",hasPrimaryImageField:!0,style:{borderRadius:"50%",display:"block",height:"100%",color:this._context.theming.colors.basecolor.white},alt:this._getAccountName(),imageSrc:t,entityPrimaryField:this._getAccountName()});return this._context.factory.createElement("CONTAINER",{key:"AccountIconContainer",id:"AccountIconContainer",style:{display:"block",flex:"0 0 "+this._context.theming.measures.measure250,borderRadius:"50%",width:this._context.theming.measures.measure250,height:this._context.theming.measures.measure250,lineHeight:this._context.theming.measures.measure250,backgroundColor:this._context.theming.colors.grays.gray01,color:this._context.theming.colors.grays.gray07,fontSize:"16px",textAlign:"center",marginRight:this._context.theming.measures.measure100}},e)},t.prototype._getAccountImageUrl=function(){return null},t.prototype._getAccountName=function(){return this._accountRecord.Name},t.prototype._getAccountId=function(){return this._accountRecord.Id.toString()},t.prototype._getEntityName=function(){return this._accountRecord.LogicalName},t.prototype._renderCommandBar=function(){var t={Id:this._getAccountId(),LogicalName:this._getEntityName(),Name:this._getAccountName()};return this._context.factory.createElement("COMMANDBAR",{key:"AccountControlTrackCommandBar",iconPosition:1,mainMenuLength:1,width:50,commandbarDisplayMode:0,ribbonId:"QuickForm:"+this._getEntityName(),selectedRecords:[t],customCommandManagerStyle:{margin:"0px",border:"0px none"},commandBarStyle:{container:{margin:"0px",border:"0px none"},list:{margin:"0px"},listItem:{width:"50px"},listItemBody:{text:{display:"none"},icon:{lineHeight:"16px"},iconWrapperStyles:{margin:"0px",fontSize:"16px",height:this._context.theming.measures.measure200,lineHeight:this._context.theming.measures.measure200,padding:"0px",border:"0px none",background:"transparent",display:"flex",overflow:"hidden",width:"100%",justifyContent:"center",alignItems:"center"},button:{padding:"0px",backgroundColor:"transparent",lineHeight:this._context.theming.measures.measure200,height:this._context.theming.measures.measure200,borderWidth:0,cursor:"pointer",":hover":{backgroundColor:this._context.theming.colors.basecolor.white},alignItems:"center"},flyoutButtonChevronIconWrapper:{padding:"0px"}}}})},t.prototype.getOutputs=function(){return null},t.prototype.destroy=function(){},t}();t.AccountControl=e}(e=t.Account||(t.Account={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\AccountControl.js.map
var MscrmControls;!function(t){var e;!function(t){"use strict";var e=function(){function t(){}return t.prototype.init=function(t,e,o){this._context=t},t.prototype.updateView=function(t){this._context=t;var e=this._context.parameters.Records&&this._context.parameters.Records.raw&&Array.isArray(this._context.parameters.Records.raw);return e?this._context.factory.createElement("CONTAINER",{id:"FollowRestrictedRecipientsContainer",key:"FollowRestrictedRecipientsContainer",style:{display:"block"}},[this._renderErrorLabel(),this._renderListHeader(),this._renderRecordsList()]):null},t.prototype._renderRecordsList=function(){var t=this;return this._context.factory.createElement("CONTAINER",{id:"FollowRestrictedRecipientsListContainer",key:"FollowRestrictedRecipientsListContainer",style:{display:"block"}},this._context.parameters.Records.raw.reduce(function(e,o){return e.concat(t._renderRecord(o))},[]))},t.prototype._renderErrorLabel=function(){var t=this._context.resources.getString("RECIPIENTS_DONT_ALLOW_TO_FOLLOW");return this._context.factory.createElement("LABEL",{key:"ErrorText",id:"ErrorText",style:{display:"block",color:this._context.theming.colors.basecolor.red.red4,fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.regular,marginBottom:this._context.theming.measures.measure050},title:t},[t])},t.prototype._renderListHeader=function(){var t=this._context.resources.getString("RECIPIENTS_WHO_CANT_BE_FOLLOWED");return this._context.factory.createElement("LABEL",{key:"ListHeader",id:"ListHeader",style:{display:"block",color:this._context.theming.colors.basecolor.grey.grey7,fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.regular},title:t},[t])},t.prototype._renderRecord=function(t){var e=this;return this._context.factory.createElement("LABEL",{key:"Record_"+t.Id.guid,id:"Record_"+t.Id.guid,style:{cursor:"pointer",textDecoration:"none",display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:this._context.theming.colors.basecolor.blue.blue3,fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.semibold,marginBottom:this._context.theming.measures.measure100},tabIndex:0,title:t.Name,role:"link",onClick:this._onRecordClick.bind(this,this._context,t),onKeyDown:function(o){e._onRecordKeyDown.bind(o,e._context,t)}},[t.Name])},t.prototype._onRecordClick=function(t,e){var o={entityName:e.LogicalName,entityId:e.Id.guid.toString()};t.navigation.openForm(o)},t.prototype._onRecordKeyDown=function(t,e,o){13===t.keyCode&&this._onRecordClick(e,o)},t.prototype.getOutputs=function(){return null},t.prototype.destroy=function(){},t}();t.FollowRestrictedRecipientsControl=e}(e=t.MailApp||(t.MailApp={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\FollowRestrictedRecipientsControl.js.map
var Models;!function(e){!function(e){e[e.NotLinked=0]="NotLinked",e[e.WillBeLinked=1]="WillBeLinked",e[e.IsLinked=2]="IsLinked",e[e.WillBeUnlinked=3]="WillBeUnlinked",e[e.WillBeUnlinkedAndDeleted=4]="WillBeUnlinkedAndDeleted",e[e.LinkFailed=5]="LinkFailed",e[e.InProgress=6]="InProgress"}(e.TrackingState||(e.TrackingState={}));e.TrackingState}(Models||(Models={}));var Models;!function(e){!function(e){e[e.IsNotFollowed=0]="IsNotFollowed",e[e.IsFollowed=1]="IsFollowed"}(e.FollowState||(e.FollowState={}));e.FollowState}(Models||(Models={}));var Constants;!function(e){e.contextId="MAIL_CONTEXT",e.PropertyIds={Subject:"SUBJECT",PlainBody:"PLAIN_BODY",HtmlBody:"HTML_BODY",ReceivedOn:"RECEIVED_ON",TrackStatus:"TRACK_STATUS",TrackAllowedStatus:"TRACK_ALLOWED_STATUS",MailboxItem:"MAILBOX_ITEM",ItemType:"ITEM_TYPE",AttachmentIds:"ATTACHMENT_IDS",EwsUrl:"EWS_URL",EwsToken:"EWS_TOKEN",IsComposeMode:"IS_COMPOSE_MODE",MessageRecipients:"MESSAGE_RECIPIENTS",MeetingAttendees:"MEETING_ATTENDEES",IsDesktopOutlook:"IS_DESKTOP_OUTLOOK",IsSent:"IS_SENT",IsDelegatedMailbox:"IS_DELEGATED_MAILBOX",ResolvedRecipients:"RESOLVED_RECIPIENTS",SelectedRecipient:"SELECTED_RECIPIENT",IsOrganizerResolvedAsUser:"IS_ORGANIZER_RESOLVED_AS_USER",MailboxItemFromServer:"MAILBOX_ITEM_FROM_SERVER"},e.ActionIds={Track:"TRACK",Untrack:"UNTRACK",Follow:"FOLLOW",Unfollow:"UNFOLLOW",InsertBody:"INSERT_BODY",AddAttachments:"ADD_ATTACHMENTS",SetSubject:"SET_SUBJECT",GetEmailLinks:"GET_EMAIL_LINKS",SetTrackingInfo:"SET_TRACKING_INFO",RemoveTrackingInfo:"REMOVE_TRACKING_INFO",ResolveRecipientFromScratch:"RESOLVE_RECIPIENT_FROM_SCRATCH",SetSelectedRecipient:"SET_SELECTED_RECIPIENT",RetryTrack:"RETRY_TRACK"},e.DialogNames={Follow:"new_FollowEmail",Unfollow:"new_UnfollowEmail",EmailTemplate:"InsertEmailTemplate_MultiPage_MDD",SalesLiterature:"MailAppSalesLiterature",KnowledgeArticle:"MailAppKnowledgeArticle",AppointmentConflict:"MailAppAppointmentConflict"},e.MailboxItemTypes={Message:"message",Appointment:"appointment"},e.CalendarItemTypes={Single:"Single",Occurence:"Occurence",Exception:"Exception",RecurringMaster:"RecurringMaster"},e.CrmTypeNames={User:"systemuser",Contact:"contact",Lead:"lead",Email:"email",Appointment:"appointment",RecurringAppointmentMaster:"recurringappointmentmaster",ExchangeSyncIdMapping:"exchangesyncidmapping",Account:"account"},e.PropertyNames={Email:"emailaddress",StatusCode:"statecode",IsDisabled:"isdisabled",OwnerId:"ownerid",FollowEmail:"followemail",RecipientRole:"role"},e.CrmTypeCodes={User:8,Contact:2,Lead:4,Appointment:4201,RecurringAppointmentMaster:4251},e.MailboxItemTypeToCrmTypeMap=(t={},t[e.MailboxItemTypes.Message]=e.CrmTypeNames.Email,t[e.MailboxItemTypes.Appointment]=e.CrmTypeNames.Appointment,t),e.FeatureNames={SSSReliablePromote:"SSSReliablePromote",MailAppAttachmentsReliablePromote:"MailAppAttachmentsReliablePromote",MailAppAppointmentsReliablePromote:"MailAppAppointmentsReliablePromote",MailAppResolveRecipientsToAccounts:"MailAppResolveRecipientsToAccounts"},e.GlobalCommandManagerId="crm_header_global",e.RecipientCRMTypeNames=[e.CrmTypeNames.User,e.CrmTypeNames.Contact,e.CrmTypeNames.Lead,e.CrmTypeNames.Account];var t}(Constants||(Constants={}));var MscrmControls;!function(e){var t;!function(e){var t=function(){function e(){var e=this;this._followedEmailCrmId=null,this._onTrackStatusChange=function(t){e._trackStatus=t&&t.value,e._updateFollowedEmailCrmId()}}return e.prototype.init=function(e,t,o){var n=this,r=e&&e.externalContext&&e.externalContext.getAvailableExternalContexts();if(r&&r.getByName(Constants.contextId))this._context=e,this._notifyOutputChanged=t,this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.TrackStatus,{updateListener:this._onTrackStatusChange}).then(function(e){n._trackStatus=e,n._updateFollowedEmailCrmId()},function(e){return e});else{var i=e.resources.getString("RELEVANT_MESSAGE_IN_INCORRECT_ENVIRONMENT");e.navigation.openErrorDialog({message:i})}},e.prototype._getFollowedEmailCrmId=function(){var e=this._trackStatus&&this._trackStatus.crmTrackingState===Models.TrackingState.IsLinked&&this._trackStatus.crmIsFollowed===Models.FollowState.IsFollowed;return e?this._trackStatus.crmId:null},e.prototype._updateFollowedEmailCrmId=function(){var e=this._getFollowedEmailCrmId();e!==this._followedEmailCrmId&&(this._followedEmailCrmId=e,this._notifyOutputChanged())},e.prototype.updateView=function(e){return this._context=e,this._context.factory.createElement("CONTAINER",{id:"mailAppHeader",style:{display:"block",width:"100%"}},null)},e.prototype.getOutputs=function(){var e={followedEmailCrmId:this._followedEmailCrmId};return e},e.prototype.destroy=function(){this._context.externalContext.removeExternalContextPropertyListener(Constants.contextId,Constants.PropertyIds.TrackStatus,this._onTrackStatusChange)},e}();e.MailAppHiddenDataCustomControl=t}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));var Models;!function(e){var t=function(){function e(e){this._entityReference=e}return e.prototype.getRecordId=function(){return this.getNamedReference().Id?this.getNamedReference().Id.toString():null},e.prototype.getErrorMessage=function(){throw new Error("Not implemented")},e.prototype.isDirty=function(){throw new Error("Not implemented")},e.prototype.isRecordValid=function(){throw new Error("Not implemented")},e.prototype.getNotification=function(e){throw new Error("Not implemented")},e.prototype.getValue=function(e){throw new Error("Not implemented")},e.prototype.setValue=function(e,t){throw new Error("Not implemented")},e.prototype.getFormattedValue=function(e){throw new Error("Not implemented")},e.prototype.isEditable=function(e){throw new Error("Not implemented")},e.prototype.isSecured=function(e){throw new Error("Not implemented")},e.prototype.isReadable=function(e){throw new Error("Not implemented")},e.prototype.isValid=function(e){throw new Error("Not implemented")},e.prototype.getFieldRequiredLevel=function(e){throw new Error("Not implemented")},e.prototype.getAttributes=function(e){throw new Error("Not implemented")},e.prototype.getValidator=function(e){throw new Error("Not implemented")},e.prototype.getNamedReference=function(){return this._entityReference},e.prototype.getActivityPartyRecord=function(){throw new Error("Not implemented")},e.prototype.validateAllColumns=function(){throw new Error("Not implemented")},e.prototype.save=function(){throw new Error("Not implemented")},e}();e.BaseDataSetRecord=t}(Models||(Models={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\MailAppHiddenDataCustomControl.js.map
var MscrmControls;!function(e){var t;!function(e){"use strict";var t="GridListContainer",o="GridList";e.entityImgUrlAlias="entityimage_url",e.tapHoldThreshold=800;var n=function(){function n(t){var o=this;this._onClickCapture=function(e){o._clearTimer()},this._onPointerMove=function(e){o._clearTimer()},this._onPointerDown=function(t,n){o._timer=setTimeout(function(){return o._tapHold(t,n)},e.tapHoldThreshold)},this._clearTimer=function(){o._timer&&(clearTimeout(o._timer),o._timer=null)},this._tapHold=function(e,t){o._clearTimer(),e.preventDefault()},this._setContext(t),this._cardStates={}}return Object.defineProperty(n.prototype,"dataSet",{get:function(){return this._dataSet},enumerable:!0,configurable:!0}),n.prototype.render=function(e){return e.parameters.Grid.working||!e.parameters.Grid.sortedRecordIds.length?null:(this._setContext(e),this._createList(this))},n.prototype._createList=function(e){var o=this._context.parameters.Grid.hasError?this._getErrorPlaceholder():this._getListItemsContent(),n=[this._getTitle(),o];return this._context.factory.createElement("CONTAINER",{key:t,id:t,role:"presentation",style:{display:"flex",flexDirection:"column",backgroundColor:this._context.theming.colors.whitebackground,overflow:"hidden",position:"relative",width:"100%"}},n)},n.prototype._getErrorPlaceholder=function(){var t={fontSize:"2em",fontWeight:"normal",color:"red"};return this._context.factory.createElement("PLACEHOLDER",{text:this._context.parameters.Grid.errorMessage,icon:e.MicrosoftIconSymbol.DetailsPageClose,iconStyle:t})},n.prototype._getTitle=function(){var e=this._context.mode._customControlProperties.descriptor.Label;return e?this._context.factory.createElement("CONTAINER",{key:"ListHeader",id:"ListHeader",style:{display:"flex",flexDirection:"column",flex:"0 0 auto",borderBottom:"1px "+this._context.theming.solidborderstyle+" "+this._context.theming.colors.grays.gray03,paddingLeft:this._context.theming.measures.measure100,paddingRight:this._context.theming.measures.measure100,paddingTop:this._context.theming.measures.measure050,paddingBottom:this._context.theming.measures.measure050,fontFamily:this._context.theming.fontfamilies.semibold,fontSize:this._context.theming.fontsizes.font100,color:this._context.theming.colors.basecolor.grey.grey7,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},e):null},n.prototype._setContext=function(e){var t=e.parameters.Grid;this._recordsDataInit&&!t.working&&this._recordsDataInit(t),this._context=e,this._recordIds=t.sortedRecordIds},n.prototype._getListItemsContent=function(){return this._context.factory.createElement("CONTAINER",{key:o,id:o,role:"presentation",style:{flex:"1 1 auto",display:"block",overflowX:"hidden",overflowY:"auto"}},this._getListItems())},n.prototype._getListItems=function(){var t=this,o=[],n=this._context.parameters.Grid,i=this._recordIds.map(function(e){return n.records[e]});return i.forEach(function(n,i){var r=n.getRecordId(),a=t._cardStates[r]||(t._cardStates[r]=new e.MailAppListItemComponent(t._context,n,t)),s={backgroundColor:t._context.theming.colors.grays.gray03},l=i?"1px "+t._context.theming.solidborderstyle+" "+t._context.theming.colors.grays.gray03:void 0,c={display:"block",listStyleType:"none",cursor:"pointer",paddingLeft:t._context.theming.measures.measure100,paddingRight:t._context.theming.measures.measure100,borderTop:l,":hover":s},d=t._context.factory.createElement("LISTITEM",{id:"ListItem_"+r,key:"ListItem_"+r,tabIndex:-1,role:"menuitem",style:c,onClickCapture:t._onClickCapture,onPointerMove:t._onPointerMove,onPointerDown:function(e){return t._onPointerDown(e,r)}},a.render(n));o.push(d)}),o},n}();e.MailAppListComponent=n}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t="Whole.Duration",o=function(){function o(e,t){this._state={dataSetRecord:null},this._context=e,this._props=t}return Object.defineProperty(o.prototype,"state",{set:function(e){Object.assign(this._state,e)},enumerable:!0,configurable:!0}),o.prototype.render=function(){var e=this._state.dataSetRecord.getRecordId(),t=[this.renderEntityImage(),this._renderListItemContent()];return t.push(this.renderCommandBar()),this._context.factory.createElement("CONTAINER",{key:"ListItem_"+e,id:"ListItem_"+e,style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between","font-size":this._context.theming.fontsizes.font100,"line-height":this._context.theming.measures.measure150,"font-family":this._context.theming.fontfamilies.regular,"padding-top":this._context.theming.measures.measure100,"padding-bottom":this._context.theming.measures.measure100,height:this._context.theming.measures.measure450},onClick:this._onListItemClickHandler.bind(this)},t)},o.prototype.renderField=function(e,o){var n=this._state.dataSetRecord,i=this.getFieldType(e)===t,r=i?n.reformatValue(e):n.getFormattedValue(e);return r?this._renderLabel(r,o):null},o.prototype._onListItemClickHandler=function(e){var t={Id:new Common.Guid(this._state.dataSetRecord.getRecordId()),Name:null,LogicalName:this._props.entityName};this._context.parameters.Grid.openDatasetItem(t),e.preventDefault(),e.stopPropagation()},o.prototype.renderEntityImage=function(){var e=this._context.factory.createElement("ENTITYIMAGE",{key:"ListCardEntityImage",hasPrimaryImageField:!0,style:{borderRadius:"50%",display:"block",width:"100%",height:"100%"},entityPrimaryField:this._state.dataSetRecord.getFormattedValue(this._props.entityPrimaryField)});return this._context.factory.createElement("CONTAINER",{key:"ListCardImage",id:"ListCardImage",style:{display:"flex","justify-content":"center","align-items":"center",flex:"0 0 "+this._context.theming.measures.measure250,"border-radius":"50%",width:this._context.theming.measures.measure250,height:this._context.theming.measures.measure250,"line-height":this._context.theming.measures.measure250,"background-color":this._context.theming.colors.grays.gray01,color:this._context.theming.colors.basecolor.white,"font-size":"16px","text-align":"center","margin-right":this._context.theming.measures.measure100,overflow:"hidden"}},e)},o.prototype.renderCommandBar=function(){var t=this,o=this._context.parameters.ListItemCommands&&this._context.parameters.ListItemCommands.raw;if(o){var n=this._state.dataSetRecord.getRecordId(),i=this._context.parameters.ListItemCommands.raw.split("|").filter(function(e){return!!e});if(this._context.parameters.Grid.retrieveRecordCommand([n],i,void 0,!0,!0).then(function(e){void 0===e&&(e=[]);var o=e.filter(function(e){return e.shouldBeVisible}),n=o[0],i=n?n.commandId:"",r=t._command?t._command.commandId:"";i!==r&&(t._command=n,t._context.utils.requestRender())},function(e){console.log(e)}),this._command){var r="CardCommandButton_"+n,a=this._command.icon?e.MicrosoftIconSymbol[this._command.icon]:e.MicrosoftIconSymbol.LinkArticle,s=this._context.factory.createElement("MICROSOFTICON",{id:"CardCommandIcon",key:"CardCommandIcon",type:a}),l=this._context.factory.createElement("BUTTON",{id:r,key:r,title:this._command.label,accessibilityLabel:this._command.label,role:"button",tabIndex:0,onClick:function(e){t._command.canExecute&&(t._command.execute(),e.preventDefault(),e.stopPropagation())},style:{backgroundColor:"transparent",borderStyle:this._context.theming.noneborderstyle,"line-height":"32px",width:"32px",padding:"0px","font-size":"16px",cursor:"pointer",color:this._context.theming.colors.grays.gray07,display:"block","text-align":"center"}},[s]);return this._context.factory.createElement("CONTAINER",{key:"CardCommandContainer_"+n,id:"CardCommandContainer_"+n,style:{display:"block",flex:"0 0 auto",alignSelf:"flex-start"}},[l])}return null}return null},o.prototype._renderListItemContent=function(){var t=[],o=this._props.entityPrimaryField,n=this._renderListItemField(o,!0);n&&t.push(n);for(var i=3,r=0;r<this._context.parameters.Grid.columns.length&&t.length<i;r++){var a=this._context.parameters.Grid.columns[r];if(a.name!==o&&a.alias!==e.entityImgUrlAlias){var s=this._renderListItemField(a.name,!1);s&&t.push(s)}}return this._context.factory.createElement("CONTAINER",{key:"ListItemContent",id:"ListItemContent",style:{display:"block",width:"100%",overflow:"hidden","white-space":"nowrap","margin-right":this._context.theming.measures.measure025}},t)},o.prototype._renderListItemField=function(e,t){var o=this.renderField(e,t);return o?this._context.factory.createElement("CONTAINER",{key:"FieldValue_"+e,id:"FieldValue_"+e,style:{display:"block",overflow:"hidden","text-overflow":"ellipsis"}},o):null},o.prototype.getFieldType=function(e){var t=this._context.parameters.Grid.columns;if(t){var o=t.find(function(t){return t.name===e});return o&&o.dataType}},o.prototype._renderLabel=function(e,t){return void 0===t&&(t=!1),this._context.factory.createElement("LABEL",{key:"ListItemLabel",title:e,style:{display:"block","text-decoration":"none",overflow:"hidden","text-overflow":"ellipsis",cursor:"pointer",color:t?this._context.theming.colors.grays.gray07:this._context.theming.colors.grays.gray05}},e)},o}();e.MailAppListDefaultTemplate=o}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,o){this._context=e;var n=t.getNamedReference();this._props={entityName:n&&n.LogicalName,entityPrimaryField:this._getEntityPrimaryField(e)}}return t.prototype.render=function(e){return this._cardComponent||(this._cardComponent=this._createDefaultTemplate()),this._cardComponent.state={dataSetRecord:e},this._cardComponent.render()},t.prototype._createDefaultTemplate=function(){return new e.MailAppListDefaultTemplate(this._context,this._props)},t.prototype._getEntityPrimaryField=function(e){var t=e.parameters.Grid.columns.find(function(e){return e.isPrimary});return t?t.name:e.parameters.Grid.columns[0].name},t}();e.MailAppListItemComponent=t}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";!function(e){e[e.Expanded=0]="Expanded",e[e.UpArrowHead=1]="UpArrowHead",e[e.LeftArrowHead=2]="LeftArrowHead",e[e.Collapsed=3]="Collapsed",e[e.Edit=4]="Edit",e[e.Save=5]="Save",e[e.Delete=6]="Delete",e[e.Remove=7]="Remove",e[e.Add=8]="Add",e[e.Cancel=9]="Cancel",e[e.HandClick=10]="HandClick",e[e.Accept=11]="Accept",e[e.More=12]="More",e[e.Forward=13]="Forward",e[e.Favorite=14]="Favorite",e[e.Placeholder=15]="Placeholder",e[e.RatingFull=16]="RatingFull",e[e.RatingEmpty=17]="RatingEmpty",e[e.Options=18]="Options",e[e.Manage=19]="Manage",e[e.Settings=20]="Settings",e[e.Find=21]="Find",e[e.Help=22]="Help",e[e.ViewNotifications=23]="ViewNotifications",e[e.StageAdvance=24]="StageAdvance",e[e.CheckMark=25]="CheckMark",e[e.Locked=26]="Locked",e[e.Lock=27]="Lock",e[e.MoreOptions=28]="MoreOptions",e[e.ContactInfo=29]="ContactInfo",e[e.Pin=30]="Pin",e[e.Unpin=31]="Unpin",e[e.Refresh=32]="Refresh",e[e.Details=33]="Details",e[e.VisualFilter=34]="VisualFilter",e[e.GlobalFilter=35]="GlobalFilter",e[e.Diamond=36]="Diamond",e[e.ApplyFilter=37]="ApplyFilter",e[e.CancelFilter=38]="CancelFilter",e[e.StreamView=39]="StreamView",e[e.TileView=40]="TileView",e[e.Import=41]="Import",e[e.Tools=42]="Tools",e[e.Attach=43]="Attach",e[e.Filter=44]="Filter",e[e.Copy=45]="Copy",e[e.HighPriority=46]="HighPriority",e[e.ReduceTile=47]="ReduceTile",e[e.ExpandTile=48]="ExpandTile",e[e.GlobalFilterExpand=49]="GlobalFilterExpand",e[e.GlobalFilterCollapse=50]="GlobalFilterCollapse",e[e.Clear=51]="Clear",e[e.Post=52]="Post",e[e.OneNote=53]="OneNote",e[e.Home=54]="Home",e[e.SetAsHome=55]="SetAsHome",e[e.BackButton=56]="BackButton",e[e.BackButtonWithoutBorder=57]="BackButtonWithoutBorder",e[e.UpArrow=58]="UpArrow",e[e.DownArrow=59]="DownArrow",e[e.SetActiveButton=60]="SetActiveButton",e[e.SearchButton=61]="SearchButton",e[e.ForwardButton=62]="ForwardButton",e[e.Mail=63]="Mail",e[e.CheckedMail=64]="CheckedMail",e[e.FailedMail=65]="FailedMail",e[e.Phone=66]="Phone",e[e.Chat=67]="Chat",e[e.OpenPane=68]="OpenPane",e[e.ClosePane=69]="ClosePane",e[e.AddFriend=70]="AddFriend",e[e.Arrow=71]="Arrow",e[e.DropdownArrow=72]="DropdownArrow",e[e.FlsLocked=73]="FlsLocked",e[e.LinkArticle=74]="LinkArticle",e[e.UnlinkArticle=75]="UnlinkArticle",e[e.CopyLink=76]="CopyLink",e[e.EmailLink=77]="EmailLink",e[e.Share=78]="Share",e[e.Assign=79]="Assign",e[e.Connect=80]="Connect",e[e.Opportunity=81]="Opportunity",e[e.Appointment=82]="Appointment",e[e.Task=83]="Task",e[e.Case=84]="Case",e[e.PhoneCallIncoming=85]="PhoneCallIncoming",e[e.PhoneCallOutgoing=86]="PhoneCallOutgoing",e[e.EmailIncoming=87]="EmailIncoming",e[e.EmailOutgoing=88]="EmailOutgoing",e[e.SendEmail=89]="SendEmail",e[e.ApplyTemplate=90]="ApplyTemplate",e[e.InsertKbArticle=91]="InsertKbArticle",e[e.SendSelected=92]="SendSelected",e[e.SaveAndClose=93]="SaveAndClose",e[e.ReplyEmail=94]="ReplyEmail",e[e.ReplyAllEmail=95]="ReplyAllEmail",e[e.ForwardEmail=96]="ForwardEmail",e[e.Close=97]="Close",e[e.Activate=98]="Activate",e[e.DeActivate=99]="DeActivate",e[e.DeleteBulk=100]="DeleteBulk",e[e.SocialActivityIncoming=101]="SocialActivityIncoming",e[e.SocialActivityOutgoing=102]="SocialActivityOutgoing",e[e.CustomActivity=103]="CustomActivity",e[e.SystemPost=104]="SystemPost",e[e.Convert=105]="Convert",e[e.MarkAsWon=106]="MarkAsWon",e[e.MarkAsLost=107]="MarkAsLost",e[e.SetRegarding=108]="SetRegarding",e[e.SaveAsComplete=109]="SaveAsComplete",e[e.SwitchProcess=110]="SwitchProcess",e[e.Recalculate=111]="Recalculate",e[e.SendDirectEmail=112]="SendDirectEmail",e[e.OpenMailbox=113]="OpenMailbox",e[e.ReOpenOpportunity=114]="ReOpenOpportunity",e[e.ReactivateLead=115]="ReactivateLead",e[e.Disqualify=116]="Disqualify",e[e.Qualify=117]="Qualify",e[e.SelectView=118]="SelectView",e[e.SelectChart=119]="SelectChart",e[e.OpenInBrowser=120]="OpenInBrowser",e[e.NewAppointment=121]="NewAppointment",e[e.NewRecurringAppointment=122]="NewRecurringAppointment",e[e.NewPhoneCall=123]="NewPhoneCall",e[e.NewTask=124]="NewTask",e[e.NewEmail=125]="NewEmail",e[e.AddExisting=126]="AddExisting",e[e.SaveAndEdit=127]="SaveAndEdit",e[e.Default=128]="Default",e[e.ScrollRight=129]="ScrollRight",e[e.ScrollLeft=130]="ScrollLeft",e[e.SaveAndRunRoutingRule=131]="SaveAndRunRoutingRule",e[e.RunRoutingRule=132]="RunRoutingRule",e[e.ResolveCase=133]="ResolveCase",e[e.CancelCase=134]="CancelCase",e[e.ReactivateCase=135]="ReactivateCase",e[e.AddToQueue=136]="AddToQueue",e[e.CreateChildCase=137]="CreateChildCase",e[e.QueueItemRoute=138]="QueueItemRoute",e[e.QueueItemRelease=139]="QueueItemRelease",e[e.QueueItemRemove=140]="QueueItemRemove",e[e.QueueItemPick=141]="QueueItemPick",e[e.Drilldown=142]="Drilldown",e[e.PopOverButton=143]="PopOverButton",e[e.ExitButton=144]="ExitButton",e[e.ExportToExcel=145]="ExportToExcel",e[e.WordTemplates=146]="WordTemplates",e[e.DocumentTemplates=147]="DocumentTemplates",e[e.OpenInPowerBI=148]="OpenInPowerBI",e[e.OpenPowerBIReport=149]="OpenPowerBIReport",e[e.OpenDelve=150]="OpenDelve",e[e.ArticleLink=151]="ArticleLink",e[e.ArchiveArticle=152]="ArchiveArticle",e[e.ApproveArticle=153]="ApproveArticle",e[e.DiscardArticle=154]="DiscardArticle",e[e.Minor=155]="Minor",e[e.Major=156]="Major",e[e.PublishKnowledgeArticle=157]="PublishKnowledgeArticle",e[e.RelateArticle=158]="RelateArticle",e[e.RelateProduct=159]="RelateProduct",e[e.RestoreArticle=160]="RestoreArticle",e[e.RevertToDraftArticle=161]="RevertToDraftArticle",e[e.Translate=162]="Translate",e[e.UpdateArticle=163]="UpdateArticle",e[e.RemoveFilter=164]="RemoveFilter",e[e.Article=165]="Article",e[e.Graph=166]="Graph",e[e.CSR=167]="CSR",e[e.MembersIcon=168]="MembersIcon",e[e.QueueIcon=169]="QueueIcon",e[e.SiteMap=170]="SiteMap",e[e.NormalPriority=171]="NormalPriority",e[e.LowPriority=172]="LowPriority",e[e.ViewIcon=173]="ViewIcon",e[e.RecentCases=174]="RecentCases",e[e.KBRecords=175]="KBRecords",e[e.NumberOfViews=176]="NumberOfViews",e[e.ResizeHandle=177]="ResizeHandle",e[e.TaskBasedFlow=178]="TaskBasedFlow",e[e.InformationIcon=179]="InformationIcon",e[e.PencilIcon=180]="PencilIcon",e[e.ErrorIcon=181]="ErrorIcon",e[e.SuccessIcon=182]="SuccessIcon",e[e.OptionsetIcon=183]="OptionsetIcon",e[e.NotificationIcon=184]="NotificationIcon",e[e.PanelHeaderImportDataIcon=185]="PanelHeaderImportDataIcon",e[e.SidePanelUpload=186]="SidePanelUpload",e[e.New=187]="New",e[e.DetailsPageClose=188]="DetailsPageClose",e[e.SettingsListIcon=189]="SettingsListIcon",e[e.ListIcon=190]="ListIcon",e[e.ForwardDisable=191]="ForwardDisable",e[e.PdfIconFile=192]="PdfIconFile",e[e.PresentationFile=193]="PresentationFile",e[e.OneNoteFile=194]="OneNoteFile",e[e.AccessFile=195]="AccessFile",e[e.VisioFile=196]="VisioFile",e[e.ProjectFile=197]="ProjectFile",e[e.Plus=198]="Plus",e[e.ChevronUp=199]="ChevronUp",e[e.ChevronDown=200]="ChevronDown",e[e.HappySmiley=201]="HappySmiley",e[e.SadSmiley=202]="SadSmiley",e[e.CaseResolution=203]="CaseResolution",e[e.CampaignResolution=204]="CampaignResolution",e[e.ServiceActivity=205]="ServiceActivity",e[e.Notes=206]="Notes",e[e.Audio=207]="Audio",e[e.Camera=208]="Camera",e[e.Video=209]="Video",e[e.Image=210]="Image",e[e.Html=211]="Html",e[e.SharePointEditDocument=212]="SharePointEditDocument",e[e.SharePointDeleteDocument=213]="SharePointDeleteDocument",e[e.SharePointCheckoutDocument=214]="SharePointCheckoutDocument",e[e.SharePointCheckinDocument=215]="SharePointCheckinDocument",e[e.SharePointEditDocumentProperties=216]="SharePointEditDocumentProperties",e[e.SharePointDiscardCheckoutDocument=217]="SharePointDiscardCheckoutDocument",e[e.SharePointNewDocument=218]="SharePointNewDocument",e[e.SharePointNewWordDocument=219]="SharePointNewWordDocument",e[e.SharePointNewExcelDocument=220]="SharePointNewExcelDocument",e[e.SharePointNewPowerPointDocument=221]="SharePointNewPowerPointDocument",e[e.SharePointNewOneNoteDocument=222]="SharePointNewOneNoteDocument",e[e.SharePointUploadDocument=223]="SharePointUploadDocument",e[e.SharePointChangeLocation=224]="SharePointChangeLocation",e[e.SharePointAddDocumentLocation=225]="SharePointAddDocumentLocation",e[e.SharePointEditLocation=226]="SharePointEditLocation",e[e.SharePointOpenLocation=227]="SharePointOpenLocation",e[e.SharePointOpenDocument=228]="SharePointOpenDocument",e[e.SendByEmail=229]="SendByEmail",e[e.CreateQuote=230]="CreateQuote",e[e.Reply=231]="Reply",e[e.Warning=232]="Warning",e[e.Play=233]="Play",e[e.ExpandButton=234]="ExpandButton",e[e.AssociatedArticle=235]="AssociatedArticle",e[e.DisassociatedArticle=236]="DisassociatedArticle",e[e.FormDesign=237]="FormDesign",e[e.GlobalFilterClearAll=238]="GlobalFilterClearAll",e[e.GlobalFilterExpandedRow=239]="GlobalFilterExpandedRow",e[e.GlobalFilterCollapsedRow=240]="GlobalFilterCollapsedRow",e[e.RelationshipAssistant=241]="RelationshipAssistant",e[e.AutomaticSuggestions=242]="AutomaticSuggestions",e[e.SemanticZoom=243]="SemanticZoom",e[e.SemanticZoomMirrored=244]="SemanticZoomMirrored",e[e.BackwardButton=245]="BackwardButton",e[e.MultiSelect=246]="MultiSelect",e[e.MultiSelectMirrored=247]="MultiSelectMirrored",e[e.Spinning=248]="Spinning",e[e.RetireProduct=249]="RetireProduct",e[e.AddProduct=250]="AddProduct",e[e.OfflineStatus=251]="OfflineStatus",e[e.Abandon=252]="Abandon",e[e.Reactivate=253]="Reactivate",e[e.FinishStage=254]="FinishStage",e[e.SortButton=255]="SortButton",e[e.SelectButton=256]="SelectButton",e[e.SelectButtonRTL=257]="SelectButtonRTL",e[e.Flows=258]="Flows",e[e.OpenEntityRecord=259]="OpenEntityRecord",e[e.View=260]="View",e[e.CreateView=261]="CreateView",e[e.EditView=262]="EditView",e[e.GuestUser=263]="GuestUser",e[e.History=264]="History",e[e.ReassignRecords=265]="ReassignRecords",e[e.ManageRoles=266]="ManageRoles",e[e.JoinTeams=267]="JoinTeams",e[e.ChangeManager=268]="ChangeManager",e[e.AddMembers=269]="AddMembers",e[e.RemoveMembers=270]="RemoveMembers",e[e.Download=271]="Download",e[e.SetAsDefaultView=272]="SetAsDefaultView",e[e.Pinned=273]="Pinned",e[e.DistributionList=274]="DistributionList",e[e.MergeRecords=275]="MergeRecords",e[e.AssociateChildCase=276]="AssociateChildCase",e[e.SetAsDefault=277]="SetAsDefault",e[e.ConvertKnowledgeArticle=278]="ConvertKnowledgeArticle",e[e.Messenger=279]="Messenger",e[e.AssociateCategory=280]="AssociateCategory",e[e.OfficeWaffle=281]="OfficeWaffle",e[e.TripleColumn=282]="TripleColumn",e[e.Tiles=283]="Tiles",e[e.HideVisualFilter=284]="HideVisualFilter",e[e.InteractiveDashboard=285]="InteractiveDashboard",e[e.Dynamics365=286]="Dynamics365",e[e.SalesLiterature=287]="SalesLiterature",e[e.Checkbox=288]="Checkbox",e[e.CheckboxComposite=289]="CheckboxComposite"}(e.MicrosoftIconSymbol||(e.MicrosoftIconSymbol={}));e.MicrosoftIconSymbol}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));var Common;!function(e){var t=function(){function e(t){if(this.toString=function(){return this.guid},this._guid=e._formatGuidString(t),!this.guid)throw new Error(t+" is not a valid Guid value.");Object.freeze(this)}return Object.defineProperty(e.prototype,"guid",{get:function(){return this._guid},enumerable:!0,configurable:!0}),e._formatGuidString=function(t){if(!t)return null;t=t.toLowerCase();var o=e.braceAndHyphenGuidVerifierPattern.exec(t);if(o)return o[1].length!==o[8].length?null:o[2];var n=e.contiguousGuidVerifierPattern.exec(t);return n?n.filter(function(e,t){return t>0}).join("-"):null},e.newGuid=function(){for(var t="0123456789abcdef",o=36,n="",i=0;o>i;i++)if(14===i)n+="4";else if(8===i||13===i||18===i||23===i)n+="-";else if(19===i){var r=Math.floor(16*Math.random());n+=t.substr(3&r|8,1)}else n+=t.substr(Math.floor(16*Math.random()),1);return new e(n)},e.braceAndHyphenGuidVerifierPattern=/^({?)((\d|[a-f]){8}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){12})(}?)$/,e.contiguousGuidVerifierPattern=/^([a-f\d]{8})([a-f\d]{4})([a-f\d]{4})([a-f\d]{4})([a-f\d]{12})$/,e.EMPTY=new e("00000000-0000-0000-0000-000000000000"),e.toString=function(e){return e?e.guid:null},e.equals=function(t,o){return e.toString(t)===e.toString(o)},e.tryParse=function(t){return e.tryParseOrNull(t)||e.EMPTY},e.tryParseOrNull=function(t){var o=e._formatGuidString(t);return o?new e(o):null},e}();e.Guid=t}(Common||(Common={}));var Constants;!function(e){e.contextId="MAIL_CONTEXT",e.PropertyIds={Subject:"SUBJECT",PlainBody:"PLAIN_BODY",HtmlBody:"HTML_BODY",ReceivedOn:"RECEIVED_ON",TrackStatus:"TRACK_STATUS",TrackAllowedStatus:"TRACK_ALLOWED_STATUS",MailboxItem:"MAILBOX_ITEM",ItemType:"ITEM_TYPE",AttachmentIds:"ATTACHMENT_IDS",EwsUrl:"EWS_URL",EwsToken:"EWS_TOKEN",IsComposeMode:"IS_COMPOSE_MODE",MessageRecipients:"MESSAGE_RECIPIENTS",MeetingAttendees:"MEETING_ATTENDEES",IsDesktopOutlook:"IS_DESKTOP_OUTLOOK",IsSent:"IS_SENT",IsDelegatedMailbox:"IS_DELEGATED_MAILBOX",ResolvedRecipients:"RESOLVED_RECIPIENTS",SelectedRecipient:"SELECTED_RECIPIENT",IsOrganizerResolvedAsUser:"IS_ORGANIZER_RESOLVED_AS_USER",MailboxItemFromServer:"MAILBOX_ITEM_FROM_SERVER"},e.ActionIds={Track:"TRACK",Untrack:"UNTRACK",Follow:"FOLLOW",Unfollow:"UNFOLLOW",InsertBody:"INSERT_BODY",AddAttachments:"ADD_ATTACHMENTS",SetSubject:"SET_SUBJECT",GetEmailLinks:"GET_EMAIL_LINKS",SetTrackingInfo:"SET_TRACKING_INFO",RemoveTrackingInfo:"REMOVE_TRACKING_INFO",ResolveRecipientFromScratch:"RESOLVE_RECIPIENT_FROM_SCRATCH",SetSelectedRecipient:"SET_SELECTED_RECIPIENT",RetryTrack:"RETRY_TRACK"},e.DialogNames={Follow:"new_FollowEmail",Unfollow:"new_UnfollowEmail",EmailTemplate:"InsertEmailTemplate_MultiPage_MDD",SalesLiterature:"MailAppSalesLiterature",KnowledgeArticle:"MailAppKnowledgeArticle",AppointmentConflict:"MailAppAppointmentConflict"},e.MailboxItemTypes={Message:"message",Appointment:"appointment"},e.CalendarItemTypes={Single:"Single",Occurence:"Occurence",Exception:"Exception",RecurringMaster:"RecurringMaster"},e.CrmTypeNames={User:"systemuser",Contact:"contact",Lead:"lead",Email:"email",Appointment:"appointment",RecurringAppointmentMaster:"recurringappointmentmaster",ExchangeSyncIdMapping:"exchangesyncidmapping",Account:"account"},e.PropertyNames={Email:"emailaddress",StatusCode:"statecode",IsDisabled:"isdisabled",OwnerId:"ownerid",FollowEmail:"followemail",RecipientRole:"role"},e.CrmTypeCodes={User:8,Contact:2,Lead:4,Appointment:4201,RecurringAppointmentMaster:4251},e.MailboxItemTypeToCrmTypeMap=(t={},t[e.MailboxItemTypes.Message]=e.CrmTypeNames.Email,t[e.MailboxItemTypes.Appointment]=e.CrmTypeNames.Appointment,t),e.FeatureNames={SSSReliablePromote:"SSSReliablePromote",MailAppAttachmentsReliablePromote:"MailAppAttachmentsReliablePromote",MailAppAppointmentsReliablePromote:"MailAppAppointmentsReliablePromote",MailAppResolveRecipientsToAccounts:"MailAppResolveRecipientsToAccounts"},e.GlobalCommandManagerId="crm_header_global",e.RecipientCRMTypeNames=[e.CrmTypeNames.User,e.CrmTypeNames.Contact,e.CrmTypeNames.Lead,e.CrmTypeNames.Account];var t}(Constants||(Constants={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){var e=this;this._onTrackStatusChange=function(){return e._context.utils.requestRender()}}return t.prototype.init=function(t,o,n){var i=t&&t.externalContext&&t.externalContext.getAvailableExternalContexts();i&&i.getByName(Constants.contextId)&&(this._context=t,this._listComponent=new e.MailAppListComponent(this._context),this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.TrackStatus,{updateListener:this._onTrackStatusChange}))},t.prototype.updateView=function(e){return this._context=e,this._context.parameters.Grid.working?void 0:this._listComponent.render(this._context)},t.prototype.getOutputs=function(){return null},t.prototype.destroy=function(){this._context.externalContext.removeExternalContextPropertyListener(Constants.contextId,Constants.PropertyIds.TrackStatus,this._onTrackStatusChange)},t}();e.MailAppListControl=t}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\MailAppListControl.js.map
var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},Constants;!function(e){e.contextId="MAIL_CONTEXT",e.PropertyIds={Subject:"SUBJECT",PlainBody:"PLAIN_BODY",HtmlBody:"HTML_BODY",ReceivedOn:"RECEIVED_ON",TrackStatus:"TRACK_STATUS",TrackAllowedStatus:"TRACK_ALLOWED_STATUS",MailboxItem:"MAILBOX_ITEM",ItemType:"ITEM_TYPE",AttachmentIds:"ATTACHMENT_IDS",EwsUrl:"EWS_URL",EwsToken:"EWS_TOKEN",IsComposeMode:"IS_COMPOSE_MODE",MessageRecipients:"MESSAGE_RECIPIENTS",MeetingAttendees:"MEETING_ATTENDEES",IsDesktopOutlook:"IS_DESKTOP_OUTLOOK",IsSent:"IS_SENT",IsDelegatedMailbox:"IS_DELEGATED_MAILBOX",ResolvedRecipients:"RESOLVED_RECIPIENTS",SelectedRecipient:"SELECTED_RECIPIENT",IsOrganizerResolvedAsUser:"IS_ORGANIZER_RESOLVED_AS_USER",MailboxItemFromServer:"MAILBOX_ITEM_FROM_SERVER"},e.ActionIds={Track:"TRACK",Untrack:"UNTRACK",Follow:"FOLLOW",Unfollow:"UNFOLLOW",InsertBody:"INSERT_BODY",AddAttachments:"ADD_ATTACHMENTS",SetSubject:"SET_SUBJECT",GetEmailLinks:"GET_EMAIL_LINKS",SetTrackingInfo:"SET_TRACKING_INFO",RemoveTrackingInfo:"REMOVE_TRACKING_INFO",ResolveRecipientFromScratch:"RESOLVE_RECIPIENT_FROM_SCRATCH",SetSelectedRecipient:"SET_SELECTED_RECIPIENT",RetryTrack:"RETRY_TRACK"},e.DialogNames={Follow:"new_FollowEmail",Unfollow:"new_UnfollowEmail",EmailTemplate:"InsertEmailTemplate_MultiPage_MDD",SalesLiterature:"MailAppSalesLiterature",KnowledgeArticle:"MailAppKnowledgeArticle",AppointmentConflict:"MailAppAppointmentConflict"},e.MailboxItemTypes={Message:"message",Appointment:"appointment"},e.CalendarItemTypes={Single:"Single",Occurence:"Occurence",Exception:"Exception",RecurringMaster:"RecurringMaster"},e.CrmTypeNames={User:"systemuser",Contact:"contact",Lead:"lead",Email:"email",Appointment:"appointment",RecurringAppointmentMaster:"recurringappointmentmaster",ExchangeSyncIdMapping:"exchangesyncidmapping",Account:"account"},e.PropertyNames={Email:"emailaddress",StatusCode:"statecode",IsDisabled:"isdisabled",OwnerId:"ownerid",FollowEmail:"followemail",RecipientRole:"role"},e.CrmTypeCodes={User:8,Contact:2,Lead:4,Appointment:4201,RecurringAppointmentMaster:4251},e.MailboxItemTypeToCrmTypeMap=(t={},t[e.MailboxItemTypes.Message]=e.CrmTypeNames.Email,t[e.MailboxItemTypes.Appointment]=e.CrmTypeNames.Appointment,t),e.FeatureNames={SSSReliablePromote:"SSSReliablePromote",MailAppAttachmentsReliablePromote:"MailAppAttachmentsReliablePromote",MailAppAppointmentsReliablePromote:"MailAppAppointmentsReliablePromote",MailAppResolveRecipientsToAccounts:"MailAppResolveRecipientsToAccounts"},e.GlobalCommandManagerId="crm_header_global",e.RecipientCRMTypeNames=[e.CrmTypeNames.User,e.CrmTypeNames.Contact,e.CrmTypeNames.Lead,e.CrmTypeNames.Account];var t}(Constants||(Constants={}));var Models;!function(e){var t=function(){function e(e){this._entityReference=e}return e.prototype.getRecordId=function(){return this.getNamedReference().Id?this.getNamedReference().Id.toString():null},e.prototype.getErrorMessage=function(){throw new Error("Not implemented")},e.prototype.isDirty=function(){throw new Error("Not implemented")},e.prototype.isRecordValid=function(){throw new Error("Not implemented")},e.prototype.getNotification=function(e){throw new Error("Not implemented")},e.prototype.getValue=function(e){throw new Error("Not implemented")},e.prototype.setValue=function(e,t){throw new Error("Not implemented")},e.prototype.getFormattedValue=function(e){throw new Error("Not implemented")},e.prototype.isEditable=function(e){throw new Error("Not implemented")},e.prototype.isSecured=function(e){throw new Error("Not implemented")},e.prototype.isReadable=function(e){throw new Error("Not implemented")},e.prototype.isValid=function(e){throw new Error("Not implemented")},e.prototype.getFieldRequiredLevel=function(e){throw new Error("Not implemented")},e.prototype.getAttributes=function(e){throw new Error("Not implemented")},e.prototype.getValidator=function(e){throw new Error("Not implemented")},e.prototype.getNamedReference=function(){return this._entityReference},e.prototype.getActivityPartyRecord=function(){throw new Error("Not implemented")},e.prototype.validateAllColumns=function(){throw new Error("Not implemented")},e.prototype.save=function(){throw new Error("Not implemented")},e}();e.BaseDataSetRecord=t}(Models||(Models={}));var Models;!function(e){!function(e){e[e.Sender=1]="Sender",e[e.To=2]="To",e[e.Cc=3]="Cc",e[e.Bcc=4]="Bcc",e[e.Organizer=5]="Organizer",e[e.RequiredAttendee=6]="RequiredAttendee",e[e.OptionalAttendee=7]="OptionalAttendee"}(e.RecipientRole||(e.RecipientRole={}));e.RecipientRole}(Models||(Models={}));var Models;!function(e){var t=function(t){function i(e,i,n){t.call(this,{Id:e||"",LogicalName:i,Name:n.name}),this._dataValues=n}return __extends(i,t),i.ExternalContextRecipientToRecipientRecord=function(t){return new e.RecipientRecord(t.entityReference.Id&&t.entityReference.Id.guid,t.entityReference.LogicalName,t.dataValues)},i.prototype.getFormattedValue=function(e){return this._dataValues[e]},i.prototype.setValue=function(e,t){return this._isDirty=!0,this._dataValues[e]=t,null},i.prototype.isDirty=function(){return this._isDirty},i}(e.BaseDataSetRecord);e.RecipientRecord=t}(Models||(Models={}));var Enums;!function(e){!function(e){e[e.Allowed=1]="Allowed",e[e.ForbiddenOccurence=2]="ForbiddenOccurence",e[e.ForbiddenMeetingInviteRequest=3]="ForbiddenMeetingInviteRequest",e[e.ForbiddenMeetingInviteResponse=4]="ForbiddenMeetingInviteResponse",e[e.ForbiddenForOrganizerResolvedAsUser=5]="ForbiddenForOrganizerResolvedAsUser",e[e.ForbiddenForDelegateAccessMissingWritePermission=6]="ForbiddenForDelegateAccessMissingWritePermission"}(e.TrackAllowedStatus||(e.TrackAllowedStatus={}));e.TrackAllowedStatus}(Enums||(Enums={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t="name",i="emailaddress",n="entityImage",o="entityHealthScore",r="RecipientsTabsScrollContainer",s="RecipientTab_",a="distributionList",c="externalUser",l="other",p="membersicon",d="user",u=function(){function e(){var e=this;this._startTabIndex=0,this._onSelectedRecipientChange=function(t){t&&1===t.status&&e._selectedRecipientExternalPropertyValue!==t.value&&(e._selectedRecipientExternalPropertyValue=t.value,e._selectedRecord=null,e._context.utils.requestRender())},this._onResolveRecipients=function(t){1===t.status&&e._processRecipientsChange(t.value,!0)}}return Object.defineProperty(e.prototype,"RecipientsRecords",{get:function(){return this._recipientsRecords||[]},set:function(e){this._recipientsRecords=e},enumerable:!0,configurable:!0}),e.prototype.init=function(e,t,i){this._notifyOutputChanged=t,this._context=e,this._getRecipients()},e.prototype.updateView=function(e){return this._context=e,-1!==this._getCurrentRecipientsCount()&&this._itemType?0===this._getCurrentRecipientsCount()&&this._itemType?this._createNoRecipientControl():(this._updateSelection(),e.factory.createElement("CONTAINER",{id:"RecipientsTabContainer",key:"RecipientsTabContainer",style:{display:"block",width:"100%","font-family":this._context.theming.fontfamilies.regular,color:this._context.theming.colors.grays.gray05,"background-color":this._context.theming.colors.whitebackground}},[this._createHeaderLabel(),this._createRecipientsTabs(this.RecipientsRecords)])):null},e.prototype._createHeaderLabel=function(){var e="";return this._itemType&&(e=this._context.resources.getString("MailAppRecipientsTabControl_"+(this._itemType===Constants.MailboxItemTypes.Message?"Recipients":"Attendees")+"_Header")),this._context.factory.createElement("TEXT",{id:"RecipientsTabContainerHeader",key:"RecipientsTabContainerHeader",semanticTag:"h2",style:{display:"block","font-size":this._context.theming.measures.measure100,"line-height":this._context.theming.measures.measure100,padding:this._context.theming.measures.measure100,"font-weight":"normal"}},e)},e.prototype._createNoRecipientControl=function(){var e=this._context.resources.getString(this._itemType===Constants.MailboxItemTypes.Message?"MailAppRecipientsTabControl_No_Recipients":"MailAppRecipientsTabControl_No_Attendees");return this._context.factory.createElement("LABEL",{id:"No_Recipients_Label",key:"No_Recipients_Label",style:{display:"block",padding:this._context.theming.measures.measure100}},e)},e.prototype._createRecipientsTabs=function(e){var t=this,i=e.map(function(i,n){return t._createRecipientTab(i,n,e.length)});return this._context.factory.createElement("HORIZONTALSCROLL",{id:r,key:"RecipientsTabsScrollContainer",startChildIndex:this._startTabIndex,scrollViewStyle:{overflowX:"hidden"},arrowButtonStyle:{height:"52px",border:"0px "+this._context.theming.noneborderstyle,color:this._context.theming.colors.grays.gray05,"font-size":"16px","background-color":this._context.theming.colors.whitebackground,padding:"0px",cursor:"pointer",":disabled":{opacity:"0"}},arrowWidth:16,prevArrowIconType:2,nextArrowIconType:71},i)},e.prototype._onKeyUp=function(e,t,i){switch(e.keyCode){case 37:this._context.userSettings.isRTL?this._focusNextRecipient(t,i):this._focusPreviousRecipient(t,i);break;case 39:this._context.userSettings.isRTL?this._focusPreviousRecipient(t,i):this._focusNextRecipient(t,i);break;case 36:this._context.accessibility.focusElementById(this._getRecipientTabId(0));break;case 35:this._context.accessibility.focusElementById(this._getRecipientTabId(i-1));break;case 13:this._changeSelectTab(this.RecipientsRecords[t])}},e.prototype._focusPreviousRecipient=function(e,t){var i=e-1;-1===i&&(i=t-1),this._context.accessibility.focusElementById(this._getRecipientTabId(i))},e.prototype._focusNextRecipient=function(e,t){var i=e+1;i===t&&(i=0),this._context.accessibility.focusElementById(this._getRecipientTabId(i))},e.prototype._getUnquotedName=function(e){return e&&"'"===e.charAt(0)&&"'"===e.charAt(e.length-1)&&(e=e.substring(1,e.length-1)),e},e.prototype._createRecipientTab=function(e,r,a){var c=this,d=this._getUnquotedName(e.getFormattedValue(t)),u=e.getFormattedValue(i),h=this._getRecordEntityLogicalName(e),m=this._context.theming.measures.measure350,_=e.getFormattedValue(o),R={entityName:h&&h!==l?h:p},g={width:m,height:m,"font-size":this._isDistributionList(e)?this._context.theming.fontsizes.font150:this._context.theming.fontsizes.font115,"font-family":this._context.theming.fontfamilies.regular,display:"block","line-height":_?this._context.theming.measures.measure250:m,"border-radius":"50%","box-sizing":"border-box",color:this._context.theming.colors.base.white,border:(_?this._context.theming.measures.measure050:"0px")+" "+this._context.theming.solidborderstyle+" "+this._context.theming.colors.whitebackground},f=e.getFormattedValue(n),y=this._context.factory.createElement("ENTITYIMAGE",{id:"Img_"+r,hasPrimaryImageField:d!==u,entityReference:R,style:g,entityPrimaryField:d,imageSrc:f?"data:image;base64,"+f:null,entityHealthScore:_,alt:this._getEntityImageAltText(e)}),C={flex:"0 0 "+m,display:"block","text-align":"center",marginLeft:!this._context.client.isRTL&&r?this._context.theming.measures.measure100:"0px",marginRight:this._context.client.isRTL&&r?this._context.theming.measures.measure100:"0px",cursor:"pointer"},x=this._selectedRecord&&this._selectedRecord.getFormattedValue(i)===e.getFormattedValue(i),E=this._getRecipientTabId(r),T=s+u;return this._context.factory.createElement("CONTAINER",{id:E,key:T,style:C,tabIndex:0,title:d||u,onClick:this._changeSelectTab.bind(this,e),onKeyUp:function(e){c._onKeyUp(e,r,a)}},[y,this._renderRecipientName(d,u,r,x)])},e.prototype._updateSelection=function(){var e=this._selectedRecord&&this._selectedRecord.getFormattedValue(i);this._applySelection(e||this._selectedRecipientExternalPropertyValue)},e.prototype._isSelectedRecordChanged=function(e){var t=!this._isSelectedRecordEmailAddressSame(e&&e.getFormattedValue(i)),n=this._isCRMRecord(this._selectedRecord)!==this._isCRMRecord(e);return t||n},e.prototype._getRecordByEmailAddress=function(e){for(var t=0;t<this.RecipientsRecords.length;t++){var n=this.RecipientsRecords[t],o=n.getFormattedValue(i);if(o&&e&&o.toLowerCase()===e.toLowerCase())return n}return null},e.prototype._isSelectedRecordEmailAddressSame=function(e){return e&&this._selectedRecord&&this._selectedRecord.getFormattedValue(i)&&this._selectedRecord.getFormattedValue(i).toLowerCase()===e.toLowerCase()},e.prototype._getRecipients=function(){var e=this,t=this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.SelectedRecipient,{updateListener:this._onSelectedRecipientChange});Promise.all([this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.ItemType),this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.ResolvedRecipients,{updateListener:this._onResolveRecipients})]).then(function(i){var n=i[0],o=i[1];e._itemType=n,t.then(function(t){e._selectedRecipientExternalPropertyValue=t,e._processRecipientsChange(o)},function(){e._processRecipientsChange(o)}).then(function(){return e._isUnknownSender()?e._getIsTrackAllowed().then(function(t){return t?e._showCreateContactToAvoidDuplicatesWarning():void 0}):void 0})})["catch"](function(e){})},e.prototype._processRecipientsChange=function(e,t){if(void 0===t&&(t=!1),e&&e.recipients){var i=e.recipients,n=i.map(Models.RecipientRecord.ExternalContextRecipientToRecipientRecord),o=!this._recipientsRecords,r=e&&e.isNewMailboxItem;if(!r&&n.length||(this._selectedRecord=null),!o&&!r){var s=this._getEmailsAddressDetailsChangesFlags(n);(s.isRecipientsWereAdded||s.isRecipientsWereRemoved)&&this._showRecipientsChangedNotification(s)}var a=n.find(function(e){var t=e.getFormattedValue("role");return t===Models.RecipientRole.Sender||t===Models.RecipientRole.Organizer});(this._isSenderChanged(a)||r)&&(this._currentSender=a),this.RecipientsRecords=n,this._notifyOutputChanged(),this._context.utils.requestRender()}},e.prototype._showRecipientsChangedNotification=function(e){var t=this,i=this._itemType===Constants.MailboxItemTypes.Message?"Recipients_":"Attendees_",n="Were_Added";e.isRecipientsWereAdded&&e.isRecipientsWereRemoved?n="Were_Added_And_Removed":e.isRecipientsWereRemoved&&(n="Were_Removed");var o=this._context.resources.getString("MailAppRecipientsTabControl_"+i+n);this._lastRecepientChangedNotificationId&&this._context.utils.clearGlobalNotification(this._lastRecepientChangedNotificationId),this._context.utils.addGlobalNotification(1,1,o,"",null,null).then(function(e){t._lastRecepientChangedNotificationId=e})},e.prototype._getCurrentRecipientsCount=function(){return this._recipientsRecords?this._recipientsRecords.length:-1},e.prototype._getEmailsAddressDetailsChangesFlags=function(e){var t=this;if(this._recipientsRecords){var i=!1,n={};return(e||[]).forEach(function(e){n[t._getRecipientEmail(e)]=!0}),this.RecipientsRecords.forEach(function(e){var o=t._getRecipientEmail(e);n[o]?delete n[o]:i=!0}),{isRecipientsWereAdded:Object.keys(n).length>0,isRecipientsWereRemoved:i}}},e.prototype._getRecipientEmail=function(e){var t=e.getFormattedValue(Constants.PropertyNames.Email);return t&&t.toLowerCase()},e.prototype._isSenderChanged=function(e){return e&&this._currentSender?this._currentSender.getFormattedValue(Constants.PropertyNames.Email)!==e.getFormattedValue(Constants.PropertyNames.Email):Boolean(e||this._currentSender)},e.prototype._showCreateContactToAvoidDuplicatesWarning=function(){var e=this,t=this._context.resources.getString("MailAppRecipientsTabControl_Create_Contact_To_Avoid_Duplicates");this._lastAvoidDuplicatesNotificationId&&this._context.utils.clearGlobalNotification(this._lastAvoidDuplicatesNotificationId),this._context.utils.addGlobalNotification(1,3,t,"",null,null).then(function(t){e._lastAvoidDuplicatesNotificationId=t})},e.prototype._applySelection=function(e){if(this.RecipientsRecords&&this.RecipientsRecords.length){for(var t,n=0;n<this.RecipientsRecords.length;n++){var o=this.RecipientsRecords[n],r=o.getFormattedValue(i);if(r&&e&&r.toLowerCase()===e.toLowerCase()){t=o;break}t||!o.getNamedReference()||o.getNamedReference().LogicalName!==Constants.CrmTypeNames.Contact&&o.getNamedReference().LogicalName!==Constants.CrmTypeNames.Lead&&o.getNamedReference().LogicalName!==Constants.CrmTypeNames.Account&&o.getNamedReference().LogicalName!==c||(t=o)}t||(t=this.RecipientsRecords[0]),this._isSelectedRecordChanged(t)&&(this._setSelectedRecord(t),this._context.utils.requestRender())}},e.prototype._isDistributionList=function(e){return this._getRecordEntityLogicalName(e)===a},e.prototype._getEntityImageAltText=function(e){if(this._isCRMRecord(e)){var n=e.getFormattedValue(t),r=e.getFormattedValue(o);if(r){var s=this._context.resources.getString("MailAppRecipientsTabControl_RecipientFullName_WithScore");return this._format(s,n,r)}var s=this._context.resources.getString("MailAppRecipientsTabControl_RecipientFullName");return this._format(s,n)}var s=this._context.resources.getString("MailAppRecipientsTabControl_UnknownRecipientWithEmail");return this._format(s,e.getFormattedValue(i))},e.prototype._getRecipientTabId=function(e){return s+e},e.prototype._renderRecipientName=function(e,t,i,n){return this._context.factory.createElement("CONTAINER",{id:"Name_"+i,key:"Name_"+t,style:{display:"block",width:this._context.theming.measures.measure350,whiteSpace:"normal","text-overflow":"ellipsis",overflow:"hidden","font-size":this._context.theming.fontsizes.font075,height:this._context.theming.fontsizes.font175,"line-height":this._context.theming.fontsizes.font175,"margin-bottom":this._context.theming.measures.measure075,"border-bottom":"3px "+this._context.theming.solidborderstyle+" "+(n?this._context.theming.colors.basecolor.blue.blue3:this._context.theming.colors.whitebackground)}},[this._getRecipientFirstName(e,t)])},e.prototype._getRecipientFirstName=function(e,t){var i=-1!==(e||t).indexOf("@");if(e&&!i){var n=e.split(",");if(n.length>1)return n[n.length-1];var o=e.split(" ");return o.slice(0,-1).join(" ")||e}return t.substring(0,t.indexOf("@"))},e.prototype._changeSelectTab=function(e){this._setSelectedRecord(e),this._context.utils.requestRender(),e&&e.getFormattedValue(i)&&this._context.externalContext.invokeExternalContextAction(Constants.contextId,Constants.ActionIds.SetSelectedRecipient,{args:{selectedRecipient:e.getFormattedValue(i)}})},e.prototype._isUnknownSender=function(){return this._currentSender&&-1!==[d,c,l].indexOf(this._currentSender.getNamedReference().LogicalName)},e.prototype._getIsTrackAllowed=function(){return this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.TrackAllowedStatus).then(function(e){return e===Enums.TrackAllowedStatus.Allowed})},e.prototype._setSelectedRecord=function(e){this._selectedRecord=e,this._notifyOutputChanged()},e.prototype._isCRMRecord=function(e){var t=this._getRecordEntityLogicalName(e);return t&&-1!==Constants.RecipientCRMTypeNames.indexOf(t)},e.prototype._getRecordEntityLogicalName=function(e){return e&&e.getNamedReference()&&e.getNamedReference().LogicalName},e.prototype._format=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.replace(/{(\d+)}/g,function(e,i){return"undefined"!=typeof t[i]?t[i]:e})},e.prototype.getOutputs=function(){var e={selectedCrmRecord:this._isCRMRecord(this._selectedRecord)?this._selectedRecord:null,selectedUnresolvedRecord:this._isCRMRecord(this._selectedRecord)?null:this._selectedRecord};return e},e.prototype.destroy=function(){this._lastRecepientChangedNotificationId&&this._context.utils.clearGlobalNotification(this._lastRecepientChangedNotificationId),this._lastAvoidDuplicatesNotificationId&&this._context.utils.clearGlobalNotification(this._lastAvoidDuplicatesNotificationId),this._context.externalContext.removeExternalContextPropertyListener(Constants.contextId,Constants.PropertyIds.SelectedRecipient,this._onSelectedRecipientChange),this._context.externalContext.removeExternalContextPropertyListener(Constants.contextId,Constants.PropertyIds.ResolvedRecipients,this._onResolveRecipients)},e}();e.MailAppRecipientsTabControl=u}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\MailAppRecipientsTabControl.js.map
var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Constants;!function(t){t.contextId="MAIL_CONTEXT",t.PropertyIds={Subject:"SUBJECT",PlainBody:"PLAIN_BODY",HtmlBody:"HTML_BODY",ReceivedOn:"RECEIVED_ON",TrackStatus:"TRACK_STATUS",TrackAllowedStatus:"TRACK_ALLOWED_STATUS",MailboxItem:"MAILBOX_ITEM",ItemType:"ITEM_TYPE",AttachmentIds:"ATTACHMENT_IDS",EwsUrl:"EWS_URL",EwsToken:"EWS_TOKEN",IsComposeMode:"IS_COMPOSE_MODE",MessageRecipients:"MESSAGE_RECIPIENTS",MeetingAttendees:"MEETING_ATTENDEES",IsDesktopOutlook:"IS_DESKTOP_OUTLOOK",IsSent:"IS_SENT",IsDelegatedMailbox:"IS_DELEGATED_MAILBOX",ResolvedRecipients:"RESOLVED_RECIPIENTS",SelectedRecipient:"SELECTED_RECIPIENT",IsOrganizerResolvedAsUser:"IS_ORGANIZER_RESOLVED_AS_USER",MailboxItemFromServer:"MAILBOX_ITEM_FROM_SERVER"},t.ActionIds={Track:"TRACK",Untrack:"UNTRACK",Follow:"FOLLOW",Unfollow:"UNFOLLOW",InsertBody:"INSERT_BODY",AddAttachments:"ADD_ATTACHMENTS",SetSubject:"SET_SUBJECT",GetEmailLinks:"GET_EMAIL_LINKS",SetTrackingInfo:"SET_TRACKING_INFO",RemoveTrackingInfo:"REMOVE_TRACKING_INFO",ResolveRecipientFromScratch:"RESOLVE_RECIPIENT_FROM_SCRATCH",SetSelectedRecipient:"SET_SELECTED_RECIPIENT",RetryTrack:"RETRY_TRACK"},t.DialogNames={Follow:"new_FollowEmail",Unfollow:"new_UnfollowEmail",EmailTemplate:"InsertEmailTemplate_MultiPage_MDD",SalesLiterature:"MailAppSalesLiterature",KnowledgeArticle:"MailAppKnowledgeArticle",AppointmentConflict:"MailAppAppointmentConflict"},t.MailboxItemTypes={Message:"message",Appointment:"appointment"},t.CalendarItemTypes={Single:"Single",Occurence:"Occurence",Exception:"Exception",RecurringMaster:"RecurringMaster"},t.CrmTypeNames={User:"systemuser",Contact:"contact",Lead:"lead",Email:"email",Appointment:"appointment",RecurringAppointmentMaster:"recurringappointmentmaster",ExchangeSyncIdMapping:"exchangesyncidmapping",Account:"account"},t.PropertyNames={Email:"emailaddress",StatusCode:"statecode",IsDisabled:"isdisabled",OwnerId:"ownerid",FollowEmail:"followemail",RecipientRole:"role"},t.CrmTypeCodes={User:8,Contact:2,Lead:4,Appointment:4201,RecurringAppointmentMaster:4251},t.MailboxItemTypeToCrmTypeMap=(e={},e[t.MailboxItemTypes.Message]=t.CrmTypeNames.Email,e[t.MailboxItemTypes.Appointment]=t.CrmTypeNames.Appointment,e),t.FeatureNames={SSSReliablePromote:"SSSReliablePromote",MailAppAttachmentsReliablePromote:"MailAppAttachmentsReliablePromote",MailAppAppointmentsReliablePromote:"MailAppAppointmentsReliablePromote",MailAppResolveRecipientsToAccounts:"MailAppResolveRecipientsToAccounts"},t.GlobalCommandManagerId="crm_header_global",t.RecipientCRMTypeNames=[t.CrmTypeNames.User,t.CrmTypeNames.Contact,t.CrmTypeNames.Lead,t.CrmTypeNames.Account];var e}(Constants||(Constants={}));var Models;!function(t){var e=function(){function t(t){this._entityReference=t}return t.prototype.getRecordId=function(){return this.getNamedReference().Id?this.getNamedReference().Id.toString():null},t.prototype.getErrorMessage=function(){throw new Error("Not implemented")},t.prototype.isDirty=function(){throw new Error("Not implemented")},t.prototype.isRecordValid=function(){throw new Error("Not implemented")},t.prototype.getNotification=function(t){throw new Error("Not implemented")},t.prototype.getValue=function(t){throw new Error("Not implemented")},t.prototype.setValue=function(t,e){throw new Error("Not implemented")},t.prototype.getFormattedValue=function(t){throw new Error("Not implemented")},t.prototype.isEditable=function(t){throw new Error("Not implemented")},t.prototype.isSecured=function(t){throw new Error("Not implemented")},t.prototype.isReadable=function(t){throw new Error("Not implemented")},t.prototype.isValid=function(t){throw new Error("Not implemented")},t.prototype.getFieldRequiredLevel=function(t){throw new Error("Not implemented")},t.prototype.getAttributes=function(t){throw new Error("Not implemented")},t.prototype.getValidator=function(t){throw new Error("Not implemented")},t.prototype.getNamedReference=function(){return this._entityReference},t.prototype.getActivityPartyRecord=function(){throw new Error("Not implemented")},t.prototype.validateAllColumns=function(){throw new Error("Not implemented")},t.prototype.save=function(){throw new Error("Not implemented")},t}();t.BaseDataSetRecord=e}(Models||(Models={}));var Models;!function(t){!function(t){t[t.NotLinked=0]="NotLinked",t[t.WillBeLinked=1]="WillBeLinked",t[t.IsLinked=2]="IsLinked",t[t.WillBeUnlinked=3]="WillBeUnlinked",t[t.WillBeUnlinkedAndDeleted=4]="WillBeUnlinkedAndDeleted",t[t.LinkFailed=5]="LinkFailed",t[t.InProgress=6]="InProgress"}(t.TrackingState||(t.TrackingState={}));t.TrackingState}(Models||(Models={}));var Models;!function(t){var e=function(){function t(t,e,r){if(this.MetadataType=null,this.MetadataSubtype=null,this.EntityLogicalName=null,this.MetadataId=null,this.MetadataName=null,this.GetDefault=!0,this.DependencyDepth=2,this.ChangedAfter=null,this.Exclude=[],this.AppId=null,!t||!e)throw new Error("Can't construct metadata query");this.MetadataType=t,this.MetadataSubtype=e,this.EntityLogicalName=r}return t.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{MetadataType:{typeName:"Edm.String",structuralProperty:1},MetadataSubtype:{typeName:"Edm.String",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1},MetadataId:{typeName:"Edm.Guid",structuralProperty:1},MetadataName:{typeName:"Edm.String",structuralProperty:1},GetDefault:{typeName:"Edm.Boolean",structuralProperty:1},DependencyDepth:{typeName:"Microsoft.Dynamics.CRM.DependencyDepth",structuralProperty:3,enumProperties:[{name:"Unknown",value:0},{name:"OnDemandWithContext",value:1},{name:"OnDemandWithoutContext",value:2},{name:"OnDemandContextOnly",value:3},{name:"Offline",value:4},{name:"Mobile",value:5}]},ChangedAfter:{typeName:"Edm.String",structuralProperty:1},Exclude:{typeName:"Edm.Guid",structuralProperty:4},AppId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:null,operationType:null}},t}();t.MetadataQuery=e;var r=function(){function t(t,r,n){this.ClientMetadataQuery=new e(t,r,n)}return t.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{ClientMetadataQuery:{typeName:"Microsoft.Dynamics.CRM.MetadataQuery",structuralProperty:2}},operationName:"GetClientMetadata",operationType:1}},t}();t.GetClientMetadataRequest=r}(Models||(Models={}));var Models;!function(t){var e=function(){function t(t){this.columns=["LogicalName"],this.filter="$filter="+t}return t.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:void 0,operationType:2,operationName:"EntityDefinitions"}},t}();t.GetEntityDefinition=e}(Models||(Models={}));var Models;!function(t){var e=function(t){function e(e,r){t.call(this,"LogicalName eq '"+e+"'&$expand=Attributes($filter="+r+")")}return __extends(e,t),e}(t.GetEntityDefinition);t.GetEntityAttributeRequest=e}(Models||(Models={}));var Models;!function(t){var e=function(t){function e(e){t.call(this,"ObjectTypeCode eq "+e)}return __extends(e,t),e}(t.GetEntityDefinition);t.GetEntityNameRequest=e}(Models||(Models={}));var Retrievers;!function(t){var e=function(){function t(t,e){this._utils=e,this._executeFunction=t}return t.prototype._execute=function(t,e,r){this._executeFunction(t).then(function(t){t.json().then(function(t){if(t&&t.Metadata)try{var n=JSON.parse(t.Metadata);e(n)}catch(a){r(a)}else r(new Error("odataResponse.Metadata is empty"))},r)},r)},t.prototype.requestEntitiesMetadata=function(t,e,r){var n={};t.forEach(function(t){n[t]=[]}),this._execute(new Models.GetClientMetadataRequest("entity",JSON.stringify(n).replace(/\"/g,'\\"'),null),e,r)},t.prototype.requestDefaultFormMetadata=function(t,e,r,n){this._execute(new Models.GetClientMetadataRequest("form",e,t),r,n)},t.prototype.requestEntityNameFromTypeCode=function(t){return this._executeFunction(new Models.GetEntityNameRequest(t)).then(function(t){return t.json().then(function(t){if(t&&t.value&&t.value[0]&&t.value[0].LogicalName)return t.value[0].LogicalName;throw new Error("Unable to determine entity name from type code")})})},t.prototype.requestRegardingTargets=function(){var t="regardingobjectid",e="activitypointer",r=this._utils.isFeatureEnabled("MailAppAttributeTargets");return r?this._getEntityAttributeTargets(e,t):this._requestTargets(e,t)},t.prototype._getEntityAttributeTargets=function(t,e){return this._utils.getEntityMetadata(t,[e]).then(function(t){return t.Attributes.getByName(e).Targets})["catch"](function(){throw new Error("Unable to get activitypointer regarding object targets")})},t.prototype._requestTargets=function(t,e){var r="LogicalName eq '"+e+"'",n=new Models.GetEntityAttributeRequest(t,r);return this._executeFunction(n).then(function(t){return t.json()}).then(function(t){if(t&&t.value&&t.value[0]&&t.value[0].Attributes&&t.value[0].Attributes[0]&&t.value[0].Attributes[0].Targets)return t.value[0].Attributes[0].Targets;throw new Error("Unable to get activitypointer regarding object targets")})},t}();t.MetadataRequestor=e}(Retrievers||(Retrievers={}));var Retrievers;!function(t){var e=function(){function t(t){this._mapping={1:"account",2:"contact",3:"opportunity",4:"lead",8:"systemuser",112:"incident"},this._metadataRequestor=t,this._listeners=[],this._errorListeners=[]}return t.prototype.onChanged=function(t){this._listeners.push(t)},t.prototype.onFailed=function(t){this._errorListeners.push(t)},t.prototype.getMapping=function(){return this._mapping},t.prototype.getEntityName=function(t){var e=this;return this._mapping[t]?this._mapping[t]:(this._metadataRequestor.requestEntityNameFromTypeCode(t).then(function(r){e._mapping[t]=r,e._notify()},function(t){e._notifyError(t)}),null)},t.prototype._notify=function(){var t=this;this._listeners.forEach(function(e){e(t._mapping)})},t.prototype._notifyError=function(t){this._errorListeners.forEach(function(e){e(t)})},t}();t.ObjectTypeCodeToLogicalNameMappingRetriever=e}(Retrievers||(Retrievers={}));var Retrievers;!function(t){!function(t){t[t.Success=0]="Success",t[t.SaveAsyncError=1]="SaveAsyncError",t[t.SaveAsyncUnavailable=2]="SaveAsyncUnavailable",t[t.ExchangeCallError=3]="ExchangeCallError",t[t.EwsErrorResponseCode=4]="EwsErrorResponseCode",t[t.RestErrorDelegateAccess=5]="RestErrorDelegateAccess",t[t.ErrorDelegateAccessMissingWritePermission=6]="ErrorDelegateAccessMissingWritePermission",t[t.ErrorDelegateAccessSaveAsync=7]="ErrorDelegateAccessSaveAsync"}(t.RetrieveState||(t.RetrieveState={}));var e=(t.RetrieveState,function(){function e(e){var r=this;this._trackStatus=null,this._trackAllowedStatus=null,this._typeNamesWithRegarding=[],this.onChanged=function(t){r._listeners.push(t)},this.onFailed=function(t){r._errorListeners.push(t)},this._notify=function(){r._listeners.forEach(function(t){t(r._trackStatus,r._trackAllowedStatus)})},this._notifyError=function(t){var e=[{name:"Error",value:JSON.stringify(t)}];r._context.reporting.reportFailure("MailApp.Control.TrackBar.TrackStatusRetriever",new Error(t.message),null,e),r._errorListeners.forEach(function(e){e(t)})},this._onTrackStatusChange=function(t){var e=t&&t.value?t.value:null,n=r._setTrackStatus(e);n&&r._notify()},this._onTrackAllowedStatusChange=function(t){var e=t?t.value:null,n=r._setTrackAllowedStatus(e);n&&r._notify()},this._context=e,this._metadataRequestor=new t.MetadataRequestor(e.webAPI.execute.bind(e.webAPI),this._context.utils),this._listeners=[],this._errorListeners=[],this._mappingRetriever=new t.ObjectTypeCodeToLogicalNameMappingRetriever(this._metadataRequestor),this._mappingRetriever.onChanged(this._notify),this._mappingRetriever.onFailed(this._notifyError)}return e.prototype.init=function(){this._retrieveTrackStatus()},e.prototype.getTypeNamesWithRegarding=function(){return this._typeNamesWithRegarding||[]},e.prototype.getTrackStatus=function(){return this._trackStatus},e.prototype.isTrackAllowed=function(){return this._trackAllowedStatus===Enums.TrackAllowedStatus.Allowed},e.prototype.trackAllowedStatus=function(){return this._trackAllowedStatus},e.prototype.isTrackPending=function(){return this._trackStatus&&this._trackStatus.crmTrackingState===Models.TrackingState.WillBeLinked},e.prototype.isUntrackPending=function(){return this._trackStatus&&this._trackStatus.crmTrackingState===Models.TrackingState.WillBeUnlinked},e.prototype.getRegardingObject=function(){var t=this._trackStatus&&(this._trackStatus.crmTrackingState===Models.TrackingState.IsLinked||this._trackStatus.crmTrackingState===Models.TrackingState.WillBeLinked||this._trackStatus.crmTrackingState===Models.TrackingState.LinkFailed)&&this._trackStatus.crmRegardingObjectId;return t&&this._mappingRetriever.getEntityName(this._trackStatus.crmRegardingObjectType)?new Models.BaseDataSetRecord({Id:this._trackStatus.crmRegardingObjectId||"",LogicalName:this._mappingRetriever.getEntityName(this._trackStatus.crmRegardingObjectType),Name:this._trackStatus.crmRegardingObjectName}):null},e.prototype.destroy=function(){this._context.externalContext.removeExternalContextPropertyListener(Constants.contextId,Constants.PropertyIds.TrackStatus,this._onTrackStatusChange),this._context.externalContext.removeExternalContextPropertyListener(Constants.contextId,Constants.PropertyIds.TrackAllowedStatus,this._onTrackAllowedStatusChange),this._listeners=[]},e.prototype._retrieveTrackStatus=function(){var t=this;Promise.all([this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.TrackStatus,{updateListener:this._onTrackStatusChange}),this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.TrackAllowedStatus,{updateListener:this._onTrackAllowedStatusChange}),this._metadataRequestor.requestRegardingTargets()]).then(function(e){var r=e[0],n=e[1],a=e[2],o=t._setTrackStatus(r),i=t._setTrackAllowedStatus(n),s=t._setTypeNamesWithRegarding(a);(o||i||s)&&t._notify()},this._notifyError)},e.prototype._setTrackStatus=function(t){void 0===t&&(t=null);var e=t&&this._trackStatus?t.crmTrackingState===this._trackStatus.crmTrackingState&&t.crmRegardingObjectId===this._trackStatus.crmRegardingObjectId&&t.crmRegardingObjectType===this._trackStatus.crmRegardingObjectType:t===this._trackStatus;return this._trackStatus=t,!e},e.prototype._setTrackAllowedStatus=function(t){void 0===t&&(t=null);var e=this._trackAllowedStatus!==t;return this._trackAllowedStatus=t,e},e.prototype._setTypeNamesWithRegarding=function(t){return!this._compareArrays(this._typeNamesWithRegarding,t)&&(this._typeNamesWithRegarding=t,!0)},e.prototype._compareArrays=function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;var r=t.reduce(function(t,e){var r=t.indexOf(e);return-1!==r&&t.splice(r,1),t},e.concat());return 0===r.length},e}());t.TrackStatusRetriever=e}(Retrievers||(Retrievers={}));var Enums;!function(t){!function(t){t[t.Allowed=1]="Allowed",t[t.ForbiddenOccurence=2]="ForbiddenOccurence",t[t.ForbiddenMeetingInviteRequest=3]="ForbiddenMeetingInviteRequest",t[t.ForbiddenMeetingInviteResponse=4]="ForbiddenMeetingInviteResponse",t[t.ForbiddenForOrganizerResolvedAsUser=5]="ForbiddenForOrganizerResolvedAsUser",t[t.ForbiddenForDelegateAccessMissingWritePermission=6]="ForbiddenForDelegateAccessMissingWritePermission"}(t.TrackAllowedStatus||(t.TrackAllowedStatus={}));t.TrackAllowedStatus}(Enums||(Enums={}));var MscrmControls;!function(t){var e;!function(t){"use strict";var e="MailApp.TrackRegarding.Button",r=["MailApp.TrackEmailWithoutRegarding.Button","MailApp.TrackAppointmentWithoutRegarding.Button","MailApp.UntrackEmail.Button","MailApp.UntrackAppointment.Button","MailApp.ViewEmailActivity.Button","MailApp.ViewAppointmentActivity.Button","MailApp.OpenRecordOnWeb.Button"],n=function(){function t(){var t=this;this._trackBarCommands=[],this._onItemChanged=function(){t._context.utils.clearGlobalNotifications&&t._context.utils.clearGlobalNotifications()}}return t.prototype.init=function(t,e,r){var n=this,a=t&&t.externalContext&&t.externalContext.getAvailableExternalContexts();a&&a.getByName(Constants.contextId)&&(this._notifyOutputChanged=e,this._context=t,this._trackStatusRetriever=new Retrievers.TrackStatusRetriever(this._context),this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.ItemType).then(function(t){n._itemType=t,n._subscribeToTrackStatusChange()},function(t){n._openErrorDialog(t)}),this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.MailboxItem,{updateListener:this._onItemChanged}))},t.prototype._subscribeToTrackStatusChange=function(){var t,e=this;this._trackStatusRetriever.onChanged(function(r,n){var a=null!==r&&null!==n;if(a&&!e._trackStatusRetriever.isTrackAllowed()){e._lastTrackForbiddenNotificationId&&e._context.utils.clearGlobalNotification(e._lastTrackForbiddenNotificationId);var o=e._getTrackForbiddenMessage();e._context.utils.addGlobalNotification(1,3,o,"",null,null).then(function(t){e._lastTrackForbiddenNotificationId=t})}var i=e._trackStatusRetriever.getRegardingObject(),s=i&&i.getRecordId();t!==s&&(t=s,e._notifyOutputChanged()),e._context.utils.requestRender()}),this._trackStatusRetriever.onFailed(function(t){switch(t.code){case Retrievers.RetrieveState.RestErrorDelegateAccess:e._openErrorDialog({message:e._context.resources.getString("MailAppTrackBarControl_DelegateAccess_RestFailure")});break;case Retrievers.RetrieveState.ErrorDelegateAccessMissingWritePermission:e._openErrorDialog({message:e._context.resources.getString("MailAppTrackBarControl_DelegateAccess_MissingWritePermission")});break;case Retrievers.RetrieveState.ErrorDelegateAccessSaveAsync:e._openErrorDialog({message:e._context.resources.getString("MailAppTrackBarControl_DelegateAccess_SaveAsyncFailure")});break;case Retrievers.RetrieveState.EwsErrorResponseCode:case Retrievers.RetrieveState.SaveAsyncUnavailable:case Retrievers.RetrieveState.SaveAsyncError:var r=e._itemType===Constants.MailboxItemTypes.Appointment?"MailAppTrackBarControl_Track_Appointment_Failure_Short":"MailAppTrackBarControl_Track_Email_EWS_Failure_Short",n=e._context.resources.getString(r);e._context.utils.addGlobalNotification(1,2,n,"",null,null);break;case Retrievers.RetrieveState.ExchangeCallError:default:null===t.code||void 0===t.code?e._openErrorDialog(t):e._context.utils.addGlobalNotification(1,2,e._context.resources.getString("MailAppTrackBarControl_Retrieve_EWS_Failure_Short"),"",null,null)}}),this._trackStatusRetriever.init()},t.prototype._getTrackForbiddenMessage=function(){var t;switch(this._trackStatusRetriever.trackAllowedStatus()){case Enums.TrackAllowedStatus.ForbiddenOccurence:t=this._context.resources.getString("MailAppTrackBarControl_Track_Forbidden_Occurence");break;case Enums.TrackAllowedStatus.ForbiddenMeetingInviteRequest:t=this._context.resources.getString("MailAppTrackBarControl_Track_Forbidden_Meeting_Request");break;case Enums.TrackAllowedStatus.ForbiddenMeetingInviteResponse:t=this._context.resources.getString("MailAppTrackBarControl_Track_Forbidden_Meeting_Response");break;case Enums.TrackAllowedStatus.ForbiddenForOrganizerResolvedAsUser:t=this._context.resources.getString("MailAppTrackBarControl_Track_Forbidden_Organizer_As_User")}return t},t.prototype.updateView=function(t){this._context=t;var e=t&&t.externalContext&&t.externalContext.getAvailableExternalContexts();if(e&&e.getByName(Constants.contextId)){var r=this._trackStatusRetriever.getTrackStatus(),n=this._trackStatusRetriever.trackAllowedStatus(),a=this._trackStatusRetriever.getTypeNamesWithRegarding(),o=r&&void 0!==n&&a&&this._itemType?[this._renderTrackStatus(),this._renderSetRegardingForm()]:[];return this._context.factory.createElement("CONTAINER",{id:"MailAppTrackBarContainer",key:"MailAppTrackBarContainer",style:{display:"block",width:"100%"}},o)}},t.prototype._getStatusRenderDetails=function(){var t=this._trackStatusRetriever.getTrackStatus();switch(t.crmTrackingState){case Models.TrackingState.IsLinked:return t.crmRegardingObjectId?this._getRenderDetailsTrackedRegarding():this._getRenderDetailsTracked();case Models.TrackingState.WillBeLinked:return this._getRenderDetailsTrackPending();case Models.TrackingState.LinkFailed:return this._getRenderDetailsTrackFailed();case Models.TrackingState.InProgress:return this._getRenderDetailsTrackInProgress();default:return this._getRenderDetailsUntracked()}},t.prototype._getRenderDetailsUntracked=function(){var t=this._context.resources.getString("MailAppTrackBarControl_UntrackedStatus");return{text:t,tooltip:t,textColor:this._context.theming.colors.basecolor.black,backgroundColor:"#cde6f7",commandingHoverColor:"#9dc3e6"}},t.prototype._getRenderDetailsTracked=function(){var t=this._context.resources.getString("MailAppTrackBarControl_TrackedStatus");return{text:t,tooltip:t,textColor:this._context.theming.colors.basecolor.black,backgroundColor:"#e4f9d4",commandingHoverColor:"#c5e0b4"}},t.prototype._getRenderDetailsTrackedRegarding=function(){var t=this._context.resources.getString("MailAppTrackBarControl_TrackedRegardingStatus");return{text:t,tooltip:t,textColor:this._context.theming.colors.basecolor.black,backgroundColor:"#e4f9d4",commandingHoverColor:"#c5e0b4"}},t.prototype._getRenderDetailsTrackPending=function(){var t=this._context.resources.getString("MailAppTrackBarControl_TrackedPendingStatus_Tooltip"),e=this._format(t,this._getItemTypeLocalizedName());return{text:this._context.resources.getString("MailAppTrackBarControl_TrackedPendingStatus"),tooltip:e,textColor:this._context.theming.colors.basecolor.black,backgroundColor:"#cde6f7",commandingHoverColor:"#9dc3e6"}},t.prototype._getRenderDetailsTrackFailed=function(){var t=this._context.resources.getString("MailAppTrackBarControl_TrackFailedStatus_Tooltip"),e=this._format(t,this._getItemTypeLocalizedName());return{text:this._context.resources.getString("MailAppTrackBarControl_TrackFailedStatus"),tooltip:e,textColor:this._context.theming.colors.basecolor.red.red4,backgroundColor:"#efefef",commandingHoverColor:"#d8d8d8"}},t.prototype._getRenderDetailsTrackInProgress=function(){var t=this._context.resources.getString("MailAppTrackBarControl_InProgressStatus");return{text:t,tooltip:t,textColor:this._context.theming.colors.basecolor.black,backgroundColor:"#fff4a8",commandingHoverColor:"#a2993e"}},t.prototype._getItemTypeLocalizedName=function(){return this._context.resources.getString(this._itemType===Constants.MailboxItemTypes.Message?"MailAppTrackBarControl_ItemType_Message":"MailAppTrackBarControl_ItemType_Appointment")},t.prototype._renderTrackStatus=function(){this._statusRenderDetails=this._getStatusRenderDetails();var t=this._trackStatusRetriever.getTrackStatus().crmTrackingState===Models.TrackingState.InProgress;return this._context.factory.createElement("CONTAINER",{id:"StatusLabelContainer",key:"StatusLabelContainer",style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",backgroundColor:this._statusRenderDetails.backgroundColor}},[this._renderStatusLabel(),t?null:this._renderCommandBar()])},t.prototype._renderStatusLabel=function(){return this._context.factory.createElement("LABEL",{key:"StatusLabel",id:"StatusLabel",style:{display:"block",flex:"1 1 auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",height:"48px",lineHeight:"48px",paddingLeft:this._context.client.isRTL?0:this._context.theming.measures.measure100,paddingRight:this._context.client.isRTL?this._context.theming.measures.measure100:0,color:this._statusRenderDetails.textColor,fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.regular},title:this._statusRenderDetails.tooltip},[this._statusRenderDetails.text])},t.prototype._renderCommandBar=function(){return this._context.factory.createElement("COMMANDBAR",{key:"TrackBarControlCommandBar",iconPosition:1,mainMenuLength:1,ribbonId:null,selectedRecords:[],addedCommandList:this._getAddedTrackBarCommands(),customCommandManagerStyle:{margin:"0px",border:"0px none"},commandBarStyle:{container:{margin:"0px",border:"0px none"},list:{margin:"0px"},listItem:{marginLeft:this._context.client.isRTL?0:this._context.theming.measures.measure050,marginRight:this._context.client.isRTL?this._context.theming.measures.measure050:0},listItemBody:{text:{display:"block",overflow:"hidden"},iconWrapperStyles:{margin:"0px"}},overflowFlyoutMoreButton:{fontSize:"16px",height:"48px",lineHeight:"48px",padding:"0px",textAlign:"center",border:"0px none",background:"transparent",display:"block",overflow:"hidden",cursor:"pointer",":hover":{backgroundColor:this._statusRenderDetails.commandingHoverColor}}}})},t.prototype._getAddedTrackBarCommands=function(){var t=this;this._context.utils.retrieveRecordCommand({},Constants.GlobalCommandManagerId,[],r).then(function(e){void 0===e&&(e=[]);var r=e.filter(function(t){return t.canExecute}).map(function(t){return{Icon:t.icon,DisplayText:t.label,Tooltip:{title:t.tooltip},Id:t.commandId,execute:t.execute}});t._isTrackCommandsChanged(r)&&(t._trackBarCommands=r,t._context.utils.requestRender())});var e=this._trackBarCommands.slice();return!this._isUntracked()&&this._trackStatusRetriever.isTrackAllowed()&&e.unshift(this._getSetRegardingCommand()),this._trackStatusRetriever.getTrackStatus().crmTrackingState===Models.TrackingState.LinkFailed&&e.unshift(this._getRetryTrackCommand()),e},t.prototype._isTrackCommandsChanged=function(t){void 0===t&&(t=[]);var e=t.map(function(t){return t.Id}).sort(),r=this._trackBarCommands.map(function(t){return t.Id}).sort();return e.some(function(t,e){return t!==r[e]})},t.prototype._getSetRegardingCommand=function(){var t=this._trackStatusRetriever.getTrackStatus(),e=t.crmRegardingObjectId?"MailAppTrackBarControl_ChangeRegardingButtonLabel":"MailAppTrackBarControl_SetRegardingButtonLabel",r=this._context.resources.getString(e);return{Icon:"LinkArticle",DisplayText:r,Tooltip:{title:r},Id:"MailApp.Track",execute:this._showTrackRegardingForm.bind(this)}},t.prototype._getRetryTrackCommand=function(){var t=this,e=this._context.resources.getString("Retry_Track");return{Icon:"Refresh",DisplayText:e,Tooltip:{title:e},Id:"MailApp.RetryTrack",execute:function(){var e={trackingState:Models.TrackingState.WillBeLinked};t._context.externalContext.invokeExternalContextAction(Constants.contextId,Constants.ActionIds.RetryTrack,{args:e})}}},t.prototype._renderSetRegardingForm=function(){if(!this._isTrackRegardingFormVisible())return null;var t=this._context.resources.getString("MailAppTrackBarControl_SetRegardingLabel"),e=this._context.factory.createElement("LABEL",{key:"SetRegardingLabel",id:"SetRegardingLabel",style:{display:"block",whiteSpace:"nowrap",color:this._context.theming.colors.basecolor.grey.grey7,fontSize:this._context.theming.fontsizes.font100,overflow:"hidden",textOverflow:"elipsis",fontFamily:this._context.theming.fontfamilies.regular,marginBottom:this._context.theming.measures.measure025},title:t},[t]);return this._context.factory.createElement("CONTAINER",{id:"SetRegardingForm",key:"SetRegardingForm",style:{display:"flex",flexDirection:"column",marginTop:this._context.theming.measures.measure100,marginLeft:this._context.theming.measures.measure100,marginRight:this._isCloseSetRegardingFormButtonVisible()?"0px":this._context.theming.measures.measure100}},[e,this._renderSetRegardingLookup()])},t.prototype._renderSetRegardingLookup=function(){var t=this._trackStatusRetriever.getTypeNamesWithRegarding();if(0===t.length)return null;var e={descriptor:{Id:"MscrmControls.FieldControls.SimpleLookupControl",Label:this._context.resources.getString("MailAppTrackBarControl_SetRegardingLabel"),Name:"",ShowLabel:!0,Visible:!0,Disabled:!1},parameters:{value:{Type:"Lookup.Regarding",Usage:3,Static:!1,Callback:this._lookupValueChanged.bind(this),Value:[],Attributes:{LogicalName:"regardingobjectid",Targets:t,Format:"regarding",Type:"lookup"}},viewportSizeMode:{Usage:1,Static:!0,Type:"Whole.None",Value:1,Primary:!1},deviceSizeMode:{Usage:1,Static:!0,Type:"Whole.None",Value:1,Primary:!1}},key:"SetRegardingLookup"},r=this._context.factory.createComponent("MscrmControls.FieldControls.SimpleLookupControl","SetRegardingLookup",e);return this._context.factory.createElement("CONTAINER",{id:"SetRegardingForm",key:"SetRegardingForm",style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},[r,this._renderCloseSetRegardingFormButton()])},t.prototype._isCloseSetRegardingFormButtonVisible=function(){return!this._isUntracked()},t.prototype._renderCloseSetRegardingFormButton=function(){var t=this;if(!this._isCloseSetRegardingFormButtonVisible())return null;var e=this._context.factory.createElement("MICROSOFTICON",{id:"CloseSetRegardingFormButtonIcon",key:"CloseSetRegardingFormButtonIcon",type:9}),r=this._context.resources.getString("MailAppTrackBarControl_CloseSetRegardingFormLabel");return this._context.factory.createElement("BUTTON",{id:"CloseSetRegardingFormButton",key:"CloseSetRegardingFormButton",title:r,accessibilityLabel:r,role:"button",tabIndex:0,onClick:function(){t._hideTrackRegardingForm()},style:{flex:"0 0 auto",backgroundColor:"transparent",borderStyle:"none",color:this._context.theming.colors.grays.gray07,paddingTop:this._context.theming.measures.measure075,paddingBottom:this._context.theming.measures.measure100,paddingLeft:this._context.theming.measures.measure050,paddingRight:this._context.theming.measures.measure100,fontSize:"16px",cursor:"pointer"}},[e])},t.prototype._showTrackRegardingForm=function(){this._isTrackRegardingFormActive=!0,this._context.utils.requestRender()},t.prototype._hideTrackRegardingForm=function(){this._isTrackRegardingFormActive=!1,this._context.utils.requestRender()},t.prototype._isTrackRegardingFormVisible=function(){return(this._isUntracked()||this._isTrackRegardingFormActive)&&this._trackStatusRetriever.isTrackAllowed()},t.prototype._isUntracked=function(){var t=this._trackStatusRetriever.getTrackStatus();return t.crmTrackingState===Models.TrackingState.NotLinked||t.crmTrackingState===Models.TrackingState.WillBeUnlinked||t.crmTrackingState===Models.TrackingState.WillBeUnlinkedAndDeleted},t.prototype._lookupValueChanged=function(t){var e=Array.isArray(t)?t[0]:t;e&&(this._trackRegarding(e),this._hideTrackRegardingForm())},t.prototype._trackRegarding=function(t){var r={};r[t.id]=this._getDataSetRecord(t),this._context.utils.retrieveRecordCommand(r,Constants.GlobalCommandManagerId,[t.id],[e]).then(function(t){var e=t&&t[0];e&&e.canExecute&&e.execute()})},t.prototype._getDataSetRecord=function(t){var e={};return e.getNamedReference=function(){return t},e},t.prototype._openErrorDialog=function(t){var e=t&&t.message?t.message:this._context.resources.getString("MailAppTrackBarControl_Retrieve_EWS_Failure_Short");this._context.navigation.openErrorDialog({message:e,details:t&&t.stack?t.stack:"No stack available."})},t.prototype._format=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.replace(/{(\d+)}/g,function(t,r){return"undefined"!=typeof e[r]?e[r]:t})},t.prototype.getOutputs=function(){return{regardingObject:this._trackStatusRetriever.getRegardingObject()}},t.prototype.destroy=function(){this._lastTrackForbiddenNotificationId&&this._context.utils.clearGlobalNotification(this._lastTrackForbiddenNotificationId),this._trackStatusRetriever&&this._trackStatusRetriever.destroy(),this._context.externalContext.removeExternalContextPropertyListener(Constants.contextId,Constants.PropertyIds.MailboxItem,this._onItemChanged)},t}();t.MailAppTrackBarControl=n}(e=t.MailApp||(t.MailApp={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\MailAppTrackBarControl.js.map
var MscrmControls;!function(t){var e;!function(t){}(e=t.Containers||(t.Containers={}))}(MscrmControls||(MscrmControls={}));var Common;!function(t){var e=function(){function t(e){if(this.toString=function(){return this.guid},this._guid=t._formatGuidString(e),!this.guid)throw new Error(e+" is not a valid Guid value.");Object.freeze(this)}return Object.defineProperty(t.prototype,"guid",{get:function(){return this._guid},enumerable:!0,configurable:!0}),t._formatGuidString=function(e){if(!e)return null;e=e.toLowerCase();var r=t.braceAndHyphenGuidVerifierPattern.exec(e);if(r)return r[1].length!==r[8].length?null:r[2];var n=t.contiguousGuidVerifierPattern.exec(e);return n?n.filter(function(t,e){return e>0}).join("-"):null},t.newGuid=function(){for(var e="0123456789abcdef",r=36,n="",i=0;r>i;i++)if(14===i)n+="4";else if(8===i||13===i||18===i||23===i)n+="-";else if(19===i){var a=Math.floor(16*Math.random());n+=e.substr(3&a|8,1)}else n+=e.substr(Math.floor(16*Math.random()),1);return new t(n)},t.braceAndHyphenGuidVerifierPattern=/^({?)((\d|[a-f]){8}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){12})(}?)$/,t.contiguousGuidVerifierPattern=/^([a-f\d]{8})([a-f\d]{4})([a-f\d]{4})([a-f\d]{4})([a-f\d]{12})$/,t.EMPTY=new t("00000000-0000-0000-0000-000000000000"),t.toString=function(t){return t?t.guid:null},t.equals=function(e,r){return t.toString(e)===t.toString(r)},t.tryParse=function(e){return t.tryParseOrNull(e)||t.EMPTY},t.tryParseOrNull=function(e){var r=t._formatGuidString(e);return r?new t(r):null},t}();t.Guid=e}(Common||(Common={}));var MscrmControls;!function(t){var e;!function(t){"use strict";var e="quick",r="UNKNOW_FORM",n="DO_NOT_SHOW",i=function(){function t(){this._uniqueId=Common.Guid.newGuid()}return t.prototype.init=function(t,e,r){this._context=t},t.prototype._requestDefaultForm=function(t){var e=this,n=this._context.utils.getFormId;if(!n)return this._formId=r,void this._context.utils.requestRender();var i=n(this._currentEntityReference.LogicalName,"Quick");i.then(function(t){null!=t?e._formId=t:e._formId=r,e._context.utils.requestRender()},function(t){throw new Error("Corrupted _requestDefaultForm")})},t.prototype._isTypeChanged=function(t){return!this._currentEntityReference||null!==t&&this._currentEntityReference.LogicalName!==t.LogicalName},t.prototype._updateTypeLabel=function(){var t=this;this._typeRequestStamp=Date.now();var e=this._typeRequestStamp;this._entityMetadataRequest=this._context.utils.getEntityMetadata(this._context.parameters.data.raw.getNamedReference().LogicalName),this._entityMetadataRequest.then(function(r){e>=t._typeRequestStamp&&t._typeLabel!==r.DisplayName&&(t._typeLabel=r.DisplayName,t._formId&&t._context.utils.requestRender())})},t.prototype.updateView=function(t){var i=this;this._context=t;var a=this._context.parameters.data.raw&&this._context.parameters.data.raw.getNamedReference();if(a){var o=this._isTypeChanged(a);if(this._currentEntityReference=a,o&&(this._formId="",this._typeLabel="",this._entityMetadataRequest=null),this._typeLabel||this._entityMetadataRequest||this._updateTypeLabel(),!this._formId){if(this._context.parameters.predefinedForms&&this._context.parameters.predefinedForms.raw){var s=this._context.parameters.predefinedForms.raw.split(","),u={};s.forEach(function(t){t&&(u[t.split("#")[0]]=t.split("#")[1])}),u.hasOwnProperty(this._currentEntityReference.LogicalName)&&(this._formId=u[this._currentEntityReference.LogicalName])}this._formId||this._requestDefaultForm(e)}}else this._currentEntityReference=null;if(!this._formId||!this._currentEntityReference||this._formId===n)return this._context.factory.createElement("LABEL",{key:"label",style:{display:"none"}},"");if(this._formId===r){var c={eventName:"uci_trace",eventParameters:[{name:"Data",value:JSON.stringify(a)},{name:"ApplicationEventLevel",value:"3"},{name:"Message",value:"Form Id is unknown"},{name:"ComponentName",value:"MailApp.Control.QuickFormWrapper"}]};return this._context.reporting.reportEvent(c),this._context.factory.createElement("LABEL",{key:"label"},this._context.resources.getString("QuickFormWrapper_Have_No_Deafult_Form"))}var l={Usage:0,Type:"Form.QuickForm",Value:this._formId+":Quick|"+this._currentEntityReference.LogicalName+"|"+this._currentEntityReference.Id,Static:!1,Primary:!0},m=this._context.parameters.formType&&this._context.parameters.formType.raw?this._context.parameters.formType.raw:"QuickFormCardControl",f=this._typeLabel?this._typeLabel:"";if(this._context.parameters.label&&this._context.parameters.label.raw){f=this._context.parameters.label.raw;var h=f.match(/\$.+?\$/g);h&&h.length>0&&(h.forEach(function(t){f=f.replace(""+t,i._context.resources.getString(t.substring(1,t.length-1)))}),f=f.replace("{TypeName}",this._typeLabel))}var d={descriptor:{Id:"MscrmControls.Containers."+m,Label:"",Name:"",ShowLabel:!1,Visible:!0,Disabled:!1,Parameters:{QuickForms:{Usage:0,Type:"Form.QuickForm",Value:'&lt;QuickFormIds&gt;&lt;QuickFormId entityname="'+this._currentEntityReference.LogicalName+'"&gt;'+this._formId+"&lt;/QuickFormId&gt;&lt;/QuickFormIds&gt;",Static:!1,Primary:!0}}},controlstates:{hasFocus:this._context.mode.hasFocus,isControlDisabled:this._context.mode.isControlDisabled,label:f},parameters:{value:l,hideImage:{Usage:1,Type:"Whole.None",Value:this._context.parameters.hideImage&&this._context.parameters.hideImage.raw,Static:!0,Primary:!0}}};return this._context.factory.createComponent("MscrmControls.Containers."+m,m+"#"+this._currentEntityReference.LogicalName+"#"+this._currentEntityReference.Id+"#"+this._uniqueId,d)},t.prototype.getOutputs=function(){return null},t.prototype.destroy=function(){},t}();t.QuickFormWrapper=i}(e=t.Containers||(t.Containers={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\QuickFormWrapper.js.map
var MscrmControls;!function(t){var e;!function(t){"use strict";var e=function(){function t(){}return t.prototype.init=function(t,e,o){this._context=t,this._icons={InProgress:{iconId:248,iconColor:this._context.theming.colors.grays.gray07},Success:{iconId:182,iconColor:this._context.theming.colors.basecolor.green.green4},Failure:{iconId:181,iconColor:this._context.theming.colors.basecolor.red.red4}}},t.prototype.updateView=function(t){return this._context=t,this._context.factory.createElement("CONTAINER",{id:"StatusLabelContainer",key:"StatusLabelContainer",style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}},[this._renderText(),this._renderIcon()])},t.prototype._renderText=function(){var t=this._context.mode._customControlProperties.descriptor.Label;return this._context.factory.createElement("LABEL",{key:"StatusText",id:"StatusText",style:{textDecoration:"none",display:"block",flex:"1 1 auto",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:this._context.theming.colors.basecolor.grey.grey5,fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.regular},tabIndex:0,title:t},[t])},t.prototype._renderIcon=function(){var t=this._context.parameters.StatusIcon&&this._context.parameters.StatusIcon.raw;return t&&this._icons[t]?this._context.factory.createElement("MICROSOFTICON",{id:"StatusIcon",key:"StatusIcon",type:this._icons[t].iconId,style:{display:"block",color:this._icons[t].iconColor,paddingLeft:this._context.theming.measures.measure200,fontSize:"16px"}}):null},t.prototype.getOutputs=function(){return null},t.prototype.destroy=function(){},t}();t.StatusLabelControl=e}(e=t.StatusLabel||(t.StatusLabel={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\StatusLabelControl.js.map
var MscrmControls;!function(t){var n;!function(t){"use strict";var n=function(){function t(){}return t.prototype.init=function(t,n,o){this._context=t},t.prototype.updateView=function(t){return this._context=t,this._createUnboundLink()},t.prototype._createUnboundLink=function(){var t=this._context.mode._customControlProperties.descriptor.Label,n=this._context.parameters.LinkUrl.raw;return this._context.factory.createElement("HYPERLINK",{id:"unboundLink",key:"unboundLink",href:n,target:"_blank",accessibilityLabel:t,tabIndex:-1,style:{color:this._context.theming.colors.basecolor.blue.blue3,fontSize:this._context.theming.fontsizes.font100,textDecoration:"none"}},t)},t.prototype.getOutputs=function(){return null},t.prototype.destroy=function(){},t}();t.UnboundHyperlinkControl=n}(n=t.UnboundHyperlinkControl||(t.UnboundHyperlinkControl={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\UnboundHyperlinkControl.js.map
var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.init=function(e){this._context=e},e.prototype.getLabelStyle=function(){return{display:"block",overflow:"hidden",textOverflow:"ellipsis",fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.semibold}},e.prototype.getHeaderStyle=function(){return Object.assign(this.getLabelStyle(),{fontFamily:this._context.theming.fontfamilies.regular})},e.prototype.getLinkStyle=function(){return Object.assign(this.getLabelStyle(),{color:this._context.theming.colors.basecolor.blue.blue3,textDecoration:"none",whiteSpace:"nowrap"})},e.prototype.getLinkButtonStyle=function(){return{backgroundColor:"transparent",borderStyle:"none",color:this._context.theming.colors.grays.gray07,paddingTop:this._context.theming.measures.measure075,paddingBottom:this._context.theming.measures.measure100,paddingLeft:this._context.client.isRTL?this._context.theming.measures.measure100:this._context.theming.measures.measure050,paddingRight:this._context.client.isRTL?this._context.theming.measures.measure050:this._context.theming.measures.measure100,marginLeft:this._context.client.isRTL?0:this._context.theming.measures.measure200,marginRight:this._context.client.isRTL?this._context.theming.measures.measure200:0,fontSize:"16px",cursor:"pointer"}},e.prototype.getFlyoutStyle=function(){return{border:"1px "+this._context.theming.solidborderstyle+" "+this._context.theming.colors.controlborder}},e.prototype.getFlyoutItemStyle=function(){return{display:"block",lineHeight:this._context.theming.measures.measure250,paddingLeft:this._context.theming.measures.measure100,paddingRight:this._context.theming.measures.measure100,whiteSpace:"nowrap",color:this._context.theming.colors.grays.gray07,fontSize:this._context.theming.fontsizes.font100,fontFamily:this._context.theming.fontfamilies.regular,cursor:"pointer",backgroundColor:this._context.theming.colors.whitebackground,":hover":{backgroundColor:this._context.theming.colors.grays.gray03}}},e.prototype.getFlyoutItemHoverStyle=function(){return{backgroundColor:"#E6F2FA"}},e}();e.MailAppStyleManager=t}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));var Constants;!function(e){e.contextId="MAIL_CONTEXT",e.PropertyIds={Subject:"SUBJECT",PlainBody:"PLAIN_BODY",HtmlBody:"HTML_BODY",ReceivedOn:"RECEIVED_ON",TrackStatus:"TRACK_STATUS",TrackAllowedStatus:"TRACK_ALLOWED_STATUS",MailboxItem:"MAILBOX_ITEM",ItemType:"ITEM_TYPE",AttachmentIds:"ATTACHMENT_IDS",EwsUrl:"EWS_URL",EwsToken:"EWS_TOKEN",IsComposeMode:"IS_COMPOSE_MODE",MessageRecipients:"MESSAGE_RECIPIENTS",MeetingAttendees:"MEETING_ATTENDEES",IsDesktopOutlook:"IS_DESKTOP_OUTLOOK",IsSent:"IS_SENT",IsDelegatedMailbox:"IS_DELEGATED_MAILBOX",ResolvedRecipients:"RESOLVED_RECIPIENTS",SelectedRecipient:"SELECTED_RECIPIENT",IsOrganizerResolvedAsUser:"IS_ORGANIZER_RESOLVED_AS_USER",MailboxItemFromServer:"MAILBOX_ITEM_FROM_SERVER"},e.ActionIds={Track:"TRACK",Untrack:"UNTRACK",Follow:"FOLLOW",Unfollow:"UNFOLLOW",InsertBody:"INSERT_BODY",AddAttachments:"ADD_ATTACHMENTS",SetSubject:"SET_SUBJECT",GetEmailLinks:"GET_EMAIL_LINKS",SetTrackingInfo:"SET_TRACKING_INFO",RemoveTrackingInfo:"REMOVE_TRACKING_INFO",ResolveRecipientFromScratch:"RESOLVE_RECIPIENT_FROM_SCRATCH",SetSelectedRecipient:"SET_SELECTED_RECIPIENT",RetryTrack:"RETRY_TRACK"},e.DialogNames={Follow:"new_FollowEmail",Unfollow:"new_UnfollowEmail",EmailTemplate:"InsertEmailTemplate_MultiPage_MDD",SalesLiterature:"MailAppSalesLiterature",KnowledgeArticle:"MailAppKnowledgeArticle",AppointmentConflict:"MailAppAppointmentConflict"},e.MailboxItemTypes={Message:"message",Appointment:"appointment"},e.CalendarItemTypes={Single:"Single",Occurence:"Occurence",Exception:"Exception",RecurringMaster:"RecurringMaster"},e.CrmTypeNames={User:"systemuser",Contact:"contact",Lead:"lead",Email:"email",Appointment:"appointment",RecurringAppointmentMaster:"recurringappointmentmaster",ExchangeSyncIdMapping:"exchangesyncidmapping",Account:"account"},e.PropertyNames={Email:"emailaddress",StatusCode:"statecode",IsDisabled:"isdisabled",OwnerId:"ownerid",FollowEmail:"followemail",RecipientRole:"role"},e.CrmTypeCodes={User:8,Contact:2,Lead:4,Appointment:4201,RecurringAppointmentMaster:4251},e.MailboxItemTypeToCrmTypeMap=(t={},t[e.MailboxItemTypes.Message]=e.CrmTypeNames.Email,t[e.MailboxItemTypes.Appointment]=e.CrmTypeNames.Appointment,t),e.FeatureNames={SSSReliablePromote:"SSSReliablePromote",MailAppAttachmentsReliablePromote:"MailAppAttachmentsReliablePromote",MailAppAppointmentsReliablePromote:"MailAppAppointmentsReliablePromote",MailAppResolveRecipientsToAccounts:"MailAppResolveRecipientsToAccounts"},e.GlobalCommandManagerId="crm_header_global",e.RecipientCRMTypeNames=[e.CrmTypeNames.User,e.CrmTypeNames.Contact,e.CrmTypeNames.Lead,e.CrmTypeNames.Account];var t}(Constants||(Constants={}));var Models;!function(e){!function(e){e[e.Sender=1]="Sender",e[e.To=2]="To",e[e.Cc=3]="Cc",e[e.Bcc=4]="Bcc",e[e.Organizer=5]="Organizer",e[e.RequiredAttendee=6]="RequiredAttendee",e[e.OptionalAttendee=7]="OptionalAttendee"}(e.RecipientRole||(e.RecipientRole={}));e.RecipientRole}(Models||(Models={}));var Models;!function(e){!function(e){e[e.NotLinked=0]="NotLinked",e[e.WillBeLinked=1]="WillBeLinked",e[e.IsLinked=2]="IsLinked",e[e.WillBeUnlinked=3]="WillBeUnlinked",e[e.WillBeUnlinkedAndDeleted=4]="WillBeUnlinkedAndDeleted",e[e.LinkFailed=5]="LinkFailed",e[e.InProgress=6]="InProgress"}(e.TrackingState||(e.TrackingState={}));e.TrackingState}(Models||(Models={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t="name",n="emailaddress",i="role",o="distributionList",r="RecipientsCreateFormAdd_",a=function(){function a(){}return a.prototype.init=function(t,n,i){this._context=t;var o=this._context.accessibility.getUniqueId("button");this._addRecipientButtonId="RecipientsCreateForm_"+o,this._mailAppStyleManager=new e.MailAppStyleManager,this._mailAppStyleManager.init(this._context)},a.prototype.updateView=function(e){var t=this;if(this._context=e,!e.parameters.data||!e.parameters.data.raw)return e.factory.createElement("CONTAINER",{id:"RecipientsCreateFormEmptyContainer",key:"RecipientsCreateFormEmptyContainer"});var n=e.factory.createElement("LABEL",{id:"RecipientCreateFormHeaderLabel",key:"RecipientCreateFormHeaderLabel",style:this._mailAppStyleManager.getHeaderStyle()},this._getRecipienCreateFormHeaderText()),i=this._renderUnresolvedRecipientCard(),o=this._getEntityTypesFromParameters().some(function(e){return t._context.utils.hasEntityPrivilege(e,1,-1)}),r=o?this._renderControls():null,a=e.factory.createElement("CONTAINER",{id:"RecipientsCreateFormContainer",key:"RecipientsCreateFormContainer",style:{display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between"}},[i,r]);return e.factory.createElement("CONTAINER",{id:"RecipientsCreateFormContainer",key:"RecipientsCreateFormContainer",style:{display:"block",width:"100%",color:this._context.theming.colors.grays.gray05,"background-color":this._context.theming.colors.whitebackground,"padding-top":this._context.theming.measures.measure100,"padding-left":this._context.client.isRTL?0:this._context.theming.measures.measure100,"padding-right":this._context.client.isRTL?this._context.theming.measures.measure100:0,"box-sizing":"border-box"}},[n,a])},a.prototype.openAddRecipientFlyout=function(){this._isAddRecipientFlyoutOpened=!0,this._context.utils.requestRender()},a.prototype.closeAddRecipientFlyout=function(){this._isAddRecipientFlyoutOpened=!1,this._context.utils.requestRender()},a.prototype._renderUnresolvedRecipientCard=function(){var e=[],i=this._getFieldValue(t);i&&i!==this._getFieldValue(n)&&e.push(this._context.factory.createElement("LABEL",{id:"RecipientCreateFormName",key:"RecipientCreateFormName",style:this._mailAppStyleManager.getLabelStyle()},[i]));var o=this._getFieldValue(n);return o&&e.push(this._context.factory.createElement("HYPERLINK",{id:"RecipientCreateFormEmail",key:"RecipientCreateFormEmail",target:"_blank",href:"mailto:"+o,style:this._mailAppStyleManager.getLinkStyle(),title:o},[o])),this._context.factory.createElement("CONTAINER",{id:"RecipientsCreateFormCard",key:"RecipientsCreateFormCard",style:{display:"block","padding-bottom":this._context.theming.measures.measure100,"padding-top":this._context.theming.measures.measure075,overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},e)},a.prototype._renderControls=function(){var e=[];return e.push(this._renderAddRecipientButton()),this._isAddRecipientFlyoutOpened&&e.push(this._renderAddRecipientFlyout()),this._context.factory.createElement("CONTAINER",{id:"RecipientsCreateFormControls",key:"RecipientsCreateFormControls",style:{display:"block"}},e)},a.prototype._renderAddRecipientButton=function(){var e=this,t=this._context.factory.createElement("MICROSOFTICON",{id:"RecipientsCreateFormAddButtonIcon",key:"RecipientsCreateFormAddButtonIcon",type:8}),n=this._context.resources.getString("UnknownRecipientSummaryControl_Add_To_Dynamics_365");return this._context.factory.createElement("BUTTON",{id:this._addRecipientButtonId,key:this._addRecipientButtonId,title:n,accessibilityLabel:n,accessibilityHasPopup:!0,role:"button",tabIndex:0,onClick:function(){e.openAddRecipientFlyout()},style:this._mailAppStyleManager.getLinkButtonStyle()},[t])},a.prototype._onAddRecipientClick=function(e){var t={entityName:e,useQuickCreateForm:!0},n=this._getPrefillOptions(e);this.closeAddRecipientFlyout(),this._context.navigation.openForm(t,n).then(this._updateOutput.bind(this))},a.prototype._getPrefillOptions=function(e){var t,i=this._getRecipientFirstAndLastName(),o=this._getFieldValue(n);if(e===Constants.CrmTypeNames.Account){var r=o.match(/@([^.]+)/);r&&(t={name:r[1],emailaddress1:o})}else t={emailaddress1:o,firstname:i.firstName,lastname:i.lastName};return t},a.prototype._getRecipientFirstAndLastName=function(){var e=this._getFieldValue(t),i=this._getFieldValue(n),o=-1!==(e||i).indexOf("@");if(e&&!o){var r=e.split(",");if(r.length>1)return 2===r.length?{firstName:r[1],lastName:r[0]}:{lastName:e};var a=e.split(" ");return{firstName:a.length>1?a.slice(0,-1).join(" "):null,lastName:a[a.length-1]}}var s=i.substring(0,i.indexOf("@")).split(".");return 2===s.length?{firstName:this._capitalizeFirstLetter(s[0]),lastName:this._capitalizeFirstLetter(s[1])}:{}},a.prototype._capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},a.prototype._updateOutput=function(e){var t=this;e&&(this._getFieldValue(n)&&this._context.externalContext.invokeExternalContextAction(Constants.contextId,Constants.ActionIds.ResolveRecipientFromScratch,{args:{emailAddress:this._getFieldValue(n)}}),e.savedEntityReference&&parseInt(this._getFieldValue(i),10)===Models.RecipientRole.Sender&&this._context.externalContext.getExternalContextProperty(Constants.contextId,Constants.PropertyIds.TrackStatus).then(function(n){if(n&&n.crmTrackingState===Models.TrackingState.NotLinked){var i=e.savedEntityReference[0],o={id:i.id,name:i.name,Name:i.name,logicalName:i.entityType,LogicalName:i.entityType,entityName:i.entityType,entityType:i.entityType},r={getNamedReference:function(){return o}},a="MailApp.TrackRegarding.Button",s=(c={},c[o.id]=r,c);t._context.utils.retrieveRecordCommand(s,Constants.GlobalCommandManagerId,[o.id],[a]).then(function(e){var t=e&&e[0];t&&t.canExecute&&t.execute()},function(e){var n=[{name:"Data",value:JSON.stringify(o)},{name:"Error",value:JSON.stringify(e)}];t._context.reporting.reportFailure("MailApp.Control.UnknownRecipientSummary",new Error("Failed to retrieve record from CRM"),null,n)})}var c}))},a.prototype._renderAddRecipientFlyout=function(){var e=this,t=this._getEntityTypesFromParameters().filter(function(t){return e._isFCBRequiredAndEnabled(t)&&e._context.utils.hasEntityPrivilege(t,1,-1)}),n=t.map(function(n,i){n=n;var o=t.length-1,r=t[0===i?o:i-1],a=t[i===o?0:i+1];return e._renderAddRecipientFlyoutItem(n,e._getResourceKeyForEntityType(n),r,a)}),i=this._context.factory.createElement("LIST",{id:"RecipientsCreateFormAddRecipientDropdown",key:"RecipientsCreateFormAddRecipientDropdown",role:"menu",accessibilityLabel:"Commands"},n);return this._context.factory.createElement("FLYOUT",{id:"RecipientsCreateFormAddRecipientFlyout",key:"RecipientsCreateFormAddRecipientFlyout",flyoutDirection:7,flyoutStyle:this._mailAppStyleManager.getFlyoutStyle(),positionType:"relative",relativeToElementId:this._addRecipientButtonId,onOutsideClick:function(){e.closeAddRecipientFlyout()}},[i])},a.prototype._isFCBRequiredAndEnabled=function(e){return e!==Constants.CrmTypeNames.Account||this._context.utils.isFeatureEnabled(Constants.FeatureNames.MailAppResolveRecipientsToAccounts)},a.prototype._getResourceKeyForEntityType=function(e){e=e.toLowerCase();var t=e.charAt(0).toUpperCase()+e.slice(1);return this._context.resources.getString("UnknownRecipientSummaryControl_Add_As_"+t)},a.prototype._getEntityTypesFromParameters=function(){var e=this._context.parameters.entityTypesToAdd&&this._context.parameters.entityTypesToAdd.raw;return e?e.split(",").map(function(e){return e.trim().toLowerCase()}):[]},a.prototype._renderAddRecipientFlyoutItem=function(e,t,n,i){return this._context.factory.createElement("LISTITEM",{id:r+e,key:r+e,role:"menuitem",tabIndex:0,accessibilityLabel:t,style:this._mailAppStyleManager.getFlyoutItemStyle(),onClick:this._onAddRecipientClick.bind(this,e),onKeyDown:this._onListItemKeyDownHandler.bind(this,e,i,n)},[t])},a.prototype._onListItemKeyDownHandler=function(e,t,n,i){40===i.keyCode&&this._focusOnKeyDown(r+t,i),38===i.keyCode&&this._focusOnKeyDown(r+n,i),27===i.keyCode&&(this.closeAddRecipientFlyout(),this._context.accessibility.focusElementById(this._addRecipientButtonId)),13===i.keyCode&&this._onAddRecipientClick(e)},a.prototype._focusOnKeyDown=function(e,t){this._context.accessibility.focusElementById(e),t.preventDefault(),t.stopPropagation()},a.prototype._getFieldValue=function(e){return this._context.parameters.data.raw&&this._context.parameters.data.raw.getFormattedValue(e)},a.prototype._getRecordEntityLogicalName=function(){var e=this._context.parameters.data.raw&&this._context.parameters.data.raw.getNamedReference();return e&&e.LogicalName},a.prototype._getRecipienCreateFormHeaderText=function(){return this._getRecordEntityLogicalName()===o?this._context.resources.getString("UnknownRecipientSummaryControl_Distribution_List"):this._context.resources.getString("UnknownRecipientSummaryControl_Unknown_Recipient")},a.prototype.getOutputs=function(){return null},a.prototype.destroy=function(){},a}();e.UnknownRecipientSummaryControl=a}(t=e.MailApp||(e.MailApp={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=d:\a\1\s\target\bin\Release\ts\..\uglify\UnknownRecipientSummaryControl.js.map
//# sourceMappingUrl=mailappcontrols.js.map