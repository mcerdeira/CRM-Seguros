"use strict";var scenarioStartResult,SITraceBIEventName="SITraceBIEvent",SITraceCIEventName="SITraceCIEvent",SITraceEventName="SITraceEvent",Telemetry=function(){function i(){}var t=i.prototype;return t.reportInfo=function(t){i.reportLog(SITraceBIEventName,t)},t.reportUserAction=function(t){i.reportLog(SITraceCIEventName,t)},t.reportWarning=function(t){i.reportLog(SITraceEventName,t,2)},t.reportError=function(t){i.reportLog(SITraceEventName,t,1)},i.reportLog=function(e,r,n){try{var t,a=r&&r.context&&r.context.reporting?r.context.reporting:window.Xrm&&Xrm.Reporting?Xrm.Reporting:null,o=this.getXrmGlobalContext();o&&o.getCurrentAppName?o.getCurrentAppName().then(function(t){t=new SIEventImpl(r.source,o&&o.organizationSettings&&o.organizationSettings.attributes&&o.organizationSettings.attributes.organizationId,r.area,e,t,r.action,r.actionOn,r.methodName,r.message,r.data,i.getCustomControlId(r),n);a&&a.reportEvent&&a.reportEvent(t)}):r&&r.context&&(t=(t=r.context.client.orgSettings)&&t.organizationId&&t.organizationId.substring(1,t.organizationId.length-1),t=new SIEventImpl(r.source,t,r.area,e,"",r.action,r.actionOn,r.methodName,r.message,r.data,i.getCustomControlId(r),n),a&&a.reportEvent&&a.reportEvent(t))}catch(t){console.error(t)}},i.getXrmGlobalContext=function(){var t=null;try{t=window.Xrm&&Xrm.Utility&&Xrm.Utility.getGlobalContext()}catch(t){}return t},i.getCustomControlId=function(t){try{return t&&t.context&&t.context.client&&t.context.client._customControlProperties.manifest.CustomControlId}catch(t){return""}},t.getEventParams=function(t,e,r,n,a,o,i,c){return{area:e,context:t,methodName:r,source:n,action:i,actionOn:c,data:o,message:a}},i}(),SIEventImpl=function(){function t(t,e,r,n,a,o,i,c,s,u,l,m){this.eventParameters=[],this.eventName=n,t&&this.addEventParameter("Source",t),e&&this.addEventParameter("OrgId",e),r&&this.addEventParameter("Area",r),a&&this.addEventParameter("appName",a),o&&this.addEventParameter("Action",o),i&&this.addEventParameter("ActionOn",i),c&&this.addEventParameter("MethodName",c),s&&this.addEventParameter("Message",s),u&&this.addEventParameter("Data",this.SafeJsonStringify(u)),l&&this.addEventParameter("CustomControlId",l),m&&this.addEventParameter("Level",m)}var e=t.prototype;return e.addEventParameter=function(t,e){e={name:t,value:e};this.eventParameters.push(e)},e.SafeJsonStringify=function(t){try{return JSON.stringify(t)}catch(t){return console.error(t),""}},t}();!function(t){t[t.StartedTracking=0]="StartedTracking",t[t.IgnoredDuplicate=1]="IgnoredDuplicate"}(scenarioStartResult=scenarioStartResult||{});var PerfUtil=function(){function a(){}var t=a.prototype;return t.scenarioStart=function(t,e,r){var n=t+"_"+e;if(a.trackedStopWatches[n])return scenarioStartResult.IgnoredDuplicate;r=r.performance.createPerformanceStopwatch(e,{area:t},!0);return a.trackedStopWatches[n]={area:t,scenario:e,stopwatchCallback:r},scenarioStartResult.StartedTracking},t.scenarioEnd=function(t,e,r){void 0===r&&(r={});t=t+"_"+e,e=a.trackedStopWatches[t];e&&e.stopwatchCallback(r),a.trackedStopWatches[t]=null},a}();PerfUtil.trackedStopWatches={};var SIClientUtilityLogger=function(){};SIClientUtilityLogger.Telemetry=new Telemetry,SIClientUtilityLogger.PerfUtil=new PerfUtil,exports.SIClientUtilityLogger=SIClientUtilityLogger;