/*! For license information please see pipelinemanagementcomponent.js.LICENSE.txt */
var pipelinemanagementcomponent;window.__cachedPromise=window.Promise,pipelinemanagementcomponent=function(){var e={21045:function(e,t,n){"use strict";n.r(t);var i=n(28314),r=n.n(i)()(!0);r.push([e.id,"#dashletPanel::-webkit-scrollbar {\r\n    display: none;\r\n}\r\n","",{version:3,sources:["webpack://../inContextView/src/components/dashlets/styles.css"],names:[],mappings:"AAAA;IACI,aAAa;AACjB",sourcesContent:["#dashletPanel::-webkit-scrollbar {\r\n    display: none;\r\n}\r\n"],sourceRoot:""}]),t.default=r},76462:function(e,t,n){var i=n(82189),r=n(21045);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.id,r,""]]);i(r,{insert:"head",singleton:!1}),e.exports=r.locals||{}},71635:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});var i=n(49037),r=n(84718),o=n(15220),a=n(5024),s=function(){function e(){}return e.validateAndGetResponseBody=function(e){return(0,i.mG)(this,void 0,Promise,(function(){var t,n,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return(n=e)?[4,e.json()]:[3,2];case 1:n=i.sent(),i.label=2;case 2:if(t=n,null==e||e.status<200||e.status>299)throw(r=new Error).message=t&&t.error?t.error.message:"Unexpected error",r.name=t&&t.error?t.error.code:void 0,r;return[2,t]}}))}))},e.createFetchXmlWithPagingCookie=function(e,t,n,i){var o=(new DOMParser).parseFromString(e,"text/xml"),a=o.documentElement.attributes;if(!r.StringUtil.IsNullOrEmpty(i)){var s=o.createAttribute("paging-cookie");s.value=i||"",a.setNamedItem(s)}var l=o.createAttribute("page");l.value=n.toString(),a.setNamedItem(l);var c=o.createAttribute("count");c.value=t.toString(),a.setNamedItem(c);var d=o.createAttribute("returntotalrecordcount");return d.value="true",a.setNamedItem(d),(new XMLSerializer).serializeToString(o)},e.buildBatchRequestForFetchXmlQueries=function(e,t){o.Validations.validateStringArgument(e,"baseUri"),o.Validations.validateNullArgument(t,"fetchXmlQueries");for(var n="",i="batch_"+(new Date).getTime(),r=0,a=t;r<a.length;r++){var s=a[r],l=s[0],c=s[1];n+="--"+i+"\n",n+="Content-Type: application/http\nContent-Transfer-Encoding: binary\n",n+="\n",n+=this.buildGetRequestForFetchXmlQuery(l,e,c),n+="\n"}return{headers:{"Content-Type":"multipart/mixed;boundary="+i,Accept:"application/json",Prefer:"odata.continue-on-error"},body:n+="--"+i+"--\r\n\0",method:"POST"}},e.buildGetRequestForFetchXmlQuery=function(e,t,n){var i="?fetchXml="+encodeURIComponent(n);return"GET "+t+"/"+a.p.ODataBaseUri+"/"+e+i+" HTTP/1.1\n"+'Prefer: odata.include-annotations="*"\n'},e}()},71350:function(e,t,n){"use strict";n.r(t),n.d(t,{CDSDataClient:function(){return m}});var i=n(49037),r=n(15220),o=n(5024),a=n(63787),s=n(29758),l=n(71635),c=n(94847),d=n(38849),u=n(84718),p=n(72964),m=function(){function e(e,t,n,i){this.metadataClient=e,this.webAPI=t,this.page=n,this.telemetryLogger=i}return e.prototype.retrieveRecords=function(e,t,n,o,s,c){return(0,i.mG)(this,void 0,Promise,(function(){var d,u,p,m,h,g,f,y,v,C,S;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(r.Validations.validateNullArgument(e,"entityMetadata"),r.Validations.validateNullArgument(t,"attributesMetadata"),r.Validations.validateStringArgument(n,"fetchXml"),s<=0)throw new Error("Invalid pageNumber");s>1&&r.Validations.validateStringArgument(c,"pagingCookie"),i.label=1;case 1:return i.trys.push([1,4,,5]),u=performance.now(),p=e.entitySetName,m=l.P.createFetchXmlWithPagingCookie(n,o,s,c),h=l.P.buildBatchRequestForFetchXmlQueries(this.page.getClientUrl(),[[p,m]]),[4,this.executeBatchRequest(h)];case 2:return g=i.sent(),[4,l.P.validateAndGetResponseBody(g[0])];case 3:return f=i.sent(),d=a.CDSResponseParser.deserializeRetrieveMultipleResponse(e,t,f),y=performance.now(),(v=new Map).set("entityName",e.name),v.set("attributeCount",t.size),v.set("pageSize",o),v.set("retrieveRecordsTime",y-u),this.logInfo("retrieveRecords",e.name,v),[3,5];case 4:throw C=i.sent(),(S=new Map).set("entityName",e.name),S.set("fetchXml",n),S.set("pageNumber",s),this.logFailure("retrieveRecords",e.name,C&&C.message,S,C),C;case 5:return[2,d]}}))}))},e.prototype.retrieveRecord=function(e,t,n){return(0,i.mG)(this,void 0,Promise,(function(){var o,s,l,c,d,u,p,m;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(r.Validations.validateStringArgument(e,"entityName"),r.Validations.validateStringArgument(t,"entityRecordId"),r.Validations.validateNullArgument(n,"attributes"),0===n.length)throw new Error("Attribute list can't be empty.");i.label=1;case 1:return i.trys.push([1,4,,5]),s=performance.now(),[4,this.metadataClient.getEntityMetadata(e,n)];case 2:return l=i.sent(),[4,this.webAPI.retrieveRecord(e,t,this.createSelectQuery(l[1]))];case 3:return c=i.sent(),o=a.CDSResponseParser.deserializeRetrieveResponse(l[0],l[1],c),d=performance.now(),(u=new Map).set("entityName",e),u.set("entityRecordId",t),u.set("attributeCount",n.length),u.set("retrieveRecordTime",d-s),this.logInfo("retrieveRecord",e,u),[3,5];case 4:throw p=i.sent(),(m=new Map).set("entityName",e),m.set("entityRecordId",t),m.set("attributes",JSON.stringify(n)),this.logFailure("retrieveRecord",e,p&&p.message,m,p),p;case 5:return[2,o]}}))}))},e.prototype.retrieveAggregatedValue=function(e,t){return(0,i.mG)(this,void 0,Promise,(function(){var n,o,a,s,c,d,u,p,m;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:r.Validations.validateNullArgument(e,"entity"),r.Validations.validateStringArgument(t,"fetchXml"),i.label=1;case 1:return i.trys.push([1,4,,5]),o=performance.now(),a=e.entitySetName,s=l.P.buildBatchRequestForFetchXmlQueries(this.page.getClientUrl(),[[a,t]]),[4,this.executeBatchRequest(s)];case 2:return c=i.sent(),[4,l.P.validateAndGetResponseBody(c[0])];case 3:return n=i.sent(),d=performance.now(),(u=new Map).set("entityName",e.name),u.set("retrieveAggregateTime",d-o),this.logInfo("retrieveAggregatedValue",e.name,u),[3,5];case 4:throw p=i.sent(),(m=new Map).set("entityName",e.name),m.set("fetchXml",t),this.logFailure("retrieveAggregatedValue",e.name,p&&p.message,m,p),p;case 5:return[2,n.value]}}))}))},e.prototype.executeAggregateBatchRequest=function(e){return(0,i.mG)(this,void 0,Promise,(function(){var t,n,o,a,s,c,m,h,g,f,y,v,C;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(r.Validations.validateNullArgument(e,"requests"),t=new d.I,n=[],e.forEach((function(e){if(!e||!e.entitySetName||u.StringUtil.IsNullOrEmpty(e.aggregateFetchXml))throw new Error("Invalid aggregate request");n.push([e.entitySetName,e.aggregateFetchXml])})),!(e.length>0))return[3,11];o=n.map((function(e){return e[0]})).join(","),(a=new Map).set("batchSize",e.length),a.set("entityNames",o),i.label=1;case 1:return i.trys.push([1,10,,11]),s=performance.now(),c=l.P.buildBatchRequestForFetchXmlQueries(this.page.getClientUrl(),n),[4,this.executeBatchRequest(c)];case 2:m=i.sent(),t.responses=[],h=0,i.label=3;case 3:if(!(h<e.length))return[3,9];g=new p.AggregateResponse,i.label=4;case 4:return i.trys.push([4,6,,7]),[4,l.P.validateAndGetResponseBody(m[h])];case 5:return f=i.sent(),g.aggregateValues=f.value,[3,7];case 6:return y=i.sent(),g.error={errorCode:y&&y.name?y.name:void 0,message:y&&y.message?y.message:"Unexpected error"},[3,7];case 7:t.responses.push(g),i.label=8;case 8:return h++,[3,3];case 9:return v=performance.now(),a.set("executionTime",v-s),this.logInfo("executeAggregateBatchRequest",o,a),[3,11];case 10:throw C=i.sent(),this.logFailure("executeAggregateBatchRequest",o,C&&C.message,a,C),C;case 11:return[2,t]}}))}))},e.prototype.updateRecord=function(e,t,n){return(0,i.mG)(this,void 0,Promise,(function(){var o,a,s,l,c,d,u,p,m,h,g,f,y;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return r.Validations.validateStringArgument(e,"entityName"),r.Validations.validateStringArgument(t,"entityRecordId"),r.Validations.validateNullArgument(n,"entityPayload"),n.size>0?(o=performance.now(),a={},s=[],n.forEach((function(e,t){s.push(t)})),[4,this.metadataClient.getEntityMetadata(e,s)]):[3,8];case 1:l=i.sent(),c=Array.from(n.keys()),d=0,i.label=2;case 2:return d<c.length?(u=c[d],p=n.get(u),[4,this.transformToODataValue(p,l[1].get(u),l[0])]):[3,5];case 3:m=i.sent(),a=Object.assign(a,m),i.label=4;case 4:return d++,[3,2];case 5:return i.trys.push([5,7,,8]),[4,this.webAPI.updateRecord(e,t,a)];case 6:return i.sent(),h=performance.now(),(g=new Map).set("entityName",e),g.set("updateRecordTime",h-o),this.logInfo("updateRecord",e,g),[3,8];case 7:throw f=i.sent(),(y=new Map).set("entityName",e),this.logFailure("updateRecord",e,f&&f.message,y,f),f;case 8:return[2]}}))}))},e.prototype.executeRetrieveMultipleBatchRequest=function(e){return(0,i.mG)(this,void 0,Promise,(function(){var t,n,o,s,p,m,h,g,f,y,v,C,S,E,b;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(r.Validations.validateNullArgument(e,"requests"),t=new d.I,n=[],e.forEach((function(e){if(!e||!e.entityMetadata||!e.attributesMetadata||u.StringUtil.IsNullOrEmpty(e.fetchXml))throw new Error("Invalid retrieve multiple request");if(e.pageNumber<=0)throw new Error("Invalid pageNumber");e.pageNumber>1&&r.Validations.validateStringArgument(e.pagingCookie,"pagingCookie");var t=l.P.createFetchXmlWithPagingCookie(e.fetchXml,e.pageSize,e.pageNumber,e.pagingCookie);n.push([e.entityMetadata.entitySetName,t])})),!(e.length>0))return[3,11];o=n.map((function(e){return e[0]})).join(","),(s=new Map).set("batchSize",e.length),s.set("entityNames",o),i.label=1;case 1:return i.trys.push([1,10,,11]),p=performance.now(),m=l.P.buildBatchRequestForFetchXmlQueries(this.page.getClientUrl(),n),[4,this.executeBatchRequest(m)];case 2:h=i.sent(),t.responses=[],g=0,i.label=3;case 3:if(!(g<e.length))return[3,9];f=e[g],y=new c.Y,i.label=4;case 4:return i.trys.push([4,6,,7]),[4,l.P.validateAndGetResponseBody(h[g])];case 5:return v=i.sent(),C=a.CDSResponseParser.deserializeRetrieveMultipleResponse(f.entityMetadata,f.attributesMetadata,v),y.entityCollection=C,[3,7];case 6:return S=i.sent(),y.error={message:S&&S.message?S.message:"Unexpected error"},[3,7];case 7:t.responses.push(y),i.label=8;case 8:return g++,[3,3];case 9:return E=performance.now(),s.set("executionTime",E-p),this.logInfo("executeRetrieveMultipleBatchRequest",o,s),[3,11];case 10:throw b=i.sent(),this.logFailure("executeRetrieveMultipleBatchRequest",o,b&&b.message,s,b),b;case 11:return[2,t]}}))}))},e.prototype.executeBatchRequest=function(e){return(0,i.mG)(this,void 0,Promise,(function(){var t,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return[4,fetch(this.page.getClientUrl()+"/"+o.p.ODataBaseUri+"/$batch",e)];case 1:return t=i.sent(),[4,a.CDSResponseParser.deserializeRetrieveMultipleBatchResponse(t)];case 2:if(!((n=i.sent())&&n.length>0))throw new Error("Unexpected error");return[2,n]}}))}))},e.prototype.transformToODataValue=function(e,t,n){return(0,i.mG)(this,void 0,Promise,(function(){var r,o,a,l,c,d,u,p,m,h;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:switch(r=t.name,o={},t.dataType){case s.EDataType.Customer:case s.EDataType.Lookup:case s.EDataType.Owner:return[3,1];case s.EDataType.Date:return[3,9]}return[3,10];case 1:return a="_"+r+"_value",this.isNullOrUndefined(e)?(o[a]=null,[3,8]):[3,2];case 2:return l=e.entityLogicalName,[4,this.getEntityPluralName(l)];case 3:return c=i.sent(),d=e.id,u=null,t.dataType!==s.EDataType.Owner?[3,5]:[4,this.metadataClient.getManyToOneRelationshipByReferencedEntity(n.name,"owner",r)];case 4:u=i.sent(),i.label=5;case 5:return this.isNullOrUndefined(u)?[4,this.metadataClient.getManyToOneRelationshipByReferencedEntity(n.name,l,r)]:[3,7];case 6:u=i.sent(),i.label=7;case 7:if(t.dataType!==s.EDataType.Owner&&this.isNullOrUndefined(u))throw p=new Error("Unable to find many-to-one relationship, entity: "+n.name+", referenced entity: "+l+", field: "+r),(m=new Map).set("entityName",n.name),m.set("referenced entity",l),m.set("field",r),this.logFailure("transformToOdataValue",n.name,p.message,m,p),p;this.isNullOrUndefined(u)||(o[u.referencingEntityNavigationPropertyName+"@odata.bind"]="/"+c+"("+d+")"),i.label=8;case 8:return[3,11];case 9:return this.isNullOrUndefined(e)?o[r]=null:t.behavior===s.DateTimeFieldBehavior.DateOnly&&"function"==typeof e.toISOString?(h=e.toISOString().match(/(\d{4}-\d{2}-\d{2})T\d{2}\:\d{2}\:\d{2}\.\d{3}[+-Z]/i))[1]&&(o[r]=h[1]):o[r]=e,[3,11];case 10:return this.isNullOrUndefined(e)?o[r]=null:o[r]=e,[3,11];case 11:return[2,o]}}))}))},e.prototype.createSelectQuery=function(e){var t=void 0,n=[];return e&&e.size>0&&e.forEach((function(e){switch(e.dataType){case s.EDataType.Owner:case s.EDataType.Lookup:case s.EDataType.Customer:n.push("_"+e.name+"_value");break;default:n.push(e.name)}})),n.length>0&&(t="?$select="+n.join(",")),t},e.prototype.getEntityPluralName=function(e){return(0,i.mG)(this,void 0,Promise,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.metadataClient.getEntityMetadata(e)];case 1:return[2,t.sent()[0].entitySetName]}}))}))},e.prototype.isNullOrUndefined=function(e){return null==e},e.prototype.logFailure=function(e,t,n,i,r){this.telemetryLogger.reportFailure("CDSDataClient",e,t,"CDSDataClient."+e,n,i,r)},e.prototype.logInfo=function(e,t,n){this.telemetryLogger.reportInfo("CDSDataClient",e,t,"CDSDataClient."+e,n)},e}()},99709:function(e,t,n){"use strict";n.r(t),n.d(t,{CDSMetadataClient:function(){return s}});var i=n(49037),r=n(15220),o=n(29758),a=n(24590),s=function(){function e(e,t){this.controlUtils=e,this.telemetryLogger=t,this.entityMetadataMap=new Map,this.attributesMetadataMap=new Map}return e.prototype.getEntityMetadata=function(e,t){return(0,i.mG)(this,void 0,Promise,(function(){var n,o,s,l,c,d,u,p,m,h,g,f,y=this;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:if(r.Validations.validateStringArgument(e,"entityType"),n=!this.entityMetadataMap.has(e),o=[],s=this.attributesMetadataMap.get(e),t&&t.length>0&&(s?o=t.filter((function(e){return!s.has(e)})):(this.attributesMetadataMap.set(e,s=new Map),o=t)),!(n||o.length>0))return[3,4];l=performance.now(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.controlUtils.getEntityMetadata(e,t)];case 2:return c=i.sent(),this.entityMetadataMap.set(e,c),t&&c.Attributes&&t.forEach((function(e){var t,n=null===(t=c.Attributes.get(e))||void 0===t?void 0:t.attributeDescriptor;n&&s.set(e,n)})),d=performance.now(),(u=new Map).set("entityType",e),t&&u.set("attributeCount",t.length),u.set("metadataRetrievalTime",d-l),this.logInfo("getEntityMetadata",e,u),[3,4];case 3:throw p=i.sent(),this.logFailure(e,t,"getEntityMetadata",e,null==p?void 0:p.message,p),new Error(p?p.message:"Unexpected error");case 4:if(null!=(m=this.entityMetadataMap.get(e)))return h={metadataId:m.LogicalName,name:m.LogicalName,displayName:m.DisplayName||"",displayCollectionName:m.DisplayCollectionName||"",primaryNameField:m.PrimaryNameAttribute||"",primaryIdField:m.PrimaryIdAttribute||"",entitySetName:m.EntitySetName||"",isActivity:m.IsActivity||!1,oneToManyRelationships:this.getOneToManyRelationships(m.OneToManyRelationships,a.n.OneToMany),manyToOneRelationships:this.getOneToManyRelationships(m.ManyToOneRelationships,a.n.ManyToOne)},g=new Map,null==t||t.forEach((function(n){var i,r=s.get(n);if(!r){var o=new Error("Metadata could not be retrieved for the attribute "+n);throw y.logFailure(e,t,"getEntityMetadata",e,o.message,o),o}g.set(n,{metadataId:n,name:n,displayName:r.DisplayName||"",dataType:y.getAttributeDataType(r.Type),validForUpdate:null===(i=r.IsValidForUpdate)||void 0===i||i,businessRequired:1===r.RequiredLevel||2===r.RequiredLevel,maxLength:r.MaxLength,format:r.Format,minValue:r.MinValue,maxValue:r.MaxValue,precision:r.Precision,precisionSource:r.PrecisionSource,targets:r.Targets,optionSet:r.OptionSet&&y.getOptionSetMembers(r.OptionSet),behavior:r.Behavior,sourceType:r.SourceType})})),[2,[h,g]];throw f=new Error("Metadata could not be retrieved for the entity "+e),this.logFailure(e,t,"getEntityMetadata",e,f.message,f),f}}))}))},e.prototype.getManyToOneRelationshipByReferencedEntity=function(e,t,n){return(0,i.mG)(this,void 0,Promise,(function(){var o,a;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return r.Validations.validateStringArgument(e,"referencingEntity"),r.Validations.validateStringArgument(t,"referencedEntity"),r.Validations.validateStringArgument(n,"referencingAttribute"),[4,this._getManyToOneRelationshipByReferencedEntity(e,t,n)];case 1:return(o=i.sent())?[3,4]:[4,this.getEntityDescriptor(e)];case 2:return(a=i.sent())&&a.manyToOneRelationships&&a.isActivity?[4,this._getManyToOneRelationshipByReferencedEntity("activitypointer",t,n)]:[3,4];case 3:o=i.sent(),i.label=4;case 4:return[2,o]}}))}))},e.prototype._getManyToOneRelationshipByReferencedEntity=function(e,t,n){return(0,i.mG)(this,void 0,Promise,(function(){var r,o,a,s,l;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return r=null,[4,this.getEntityDescriptor(e)];case 1:if((o=i.sent())&&o.manyToOneRelationships)for(a=0,s=o.manyToOneRelationships;a<s.length;a++)(l=s[a])&&l.referencedEntity===t&&l.referencingFieldName===n&&(r=l);return[2,r]}}))}))},e.prototype.getEntityDescriptor=function(e){return(0,i.mG)(this,void 0,Promise,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.getEntityMetadata(e)];case 1:return[2,t.sent()[0]]}}))}))},e.prototype.getOptionSetMembers=function(e){var t=[];return e&&e.length>0&&e.forEach((function(e){t.push({value:e.Value,displayName:e.Label,color:e.Color})})),t},e.prototype.getOneToManyRelationships=function(e,t){var n=[];return e&&e.forEach((function(e){e&&n.push({displayName:e.SchemaName,referencingFieldName:e.ReferencingAttribute,referencingEntity:e.ReferencingEntity,referencingEntityNavigationPropertyName:e.ReferencingEntityNavigationPropertyName,referencedFieldName:e.ReferencedAttribute,referencedEntity:e.ReferencedEntity,referencedEntityNavigationPropertyName:e.ReferencedEntityNavigationPropertyName,isHierarchical:e.IsHierarchical,relationshipType:t})})),n},e.prototype.getAttributeDataType=function(e){var t=o.EDataType.Unknown;return"string"===e?t=o.EDataType.String:"memo"===e?t=o.EDataType.MultilineText:"datetime"===e?t=o.EDataType.Date:"picklist"===e?t=o.EDataType.OptionSet:"multiselectpicklisttype"===e?t=o.EDataType.MultiOptionSet:"boolean"===e?t=o.EDataType.TwoOptions:"lookup"===e?t=o.EDataType.Lookup:"customer"===e?t=o.EDataType.Customer:"owner"===e?t=o.EDataType.Owner:"money"===e?t=o.EDataType.Currency:"double"===e?t=o.EDataType.Float:"decimal"===e?t=o.EDataType.Decimal:"uniqueidentifier"===e?t=o.EDataType.UniqueIdentifier:"integer"===e?t=o.EDataType.WholeNumber:"state"===e?t=o.EDataType.State:"status"===e&&(t=o.EDataType.Status),t},e.prototype.logFailure=function(e,t,n,i,r,o){var a=new Map;a.set("entityType",e),t&&a.set("attributeCount",t.length),this.telemetryLogger.reportFailure("CDSMetadataClient",n,i,"CDSMetadataClient."+n,r,a,o)},e.prototype.logInfo=function(e,t,n){this.telemetryLogger.reportInfo("CDSMetadataClient",e,t,"CDSMetadataClient."+e,n)},e}()},63787:function(e,t,n){"use strict";n.r(t),n.d(t,{CDSResponseParser:function(){return d}});var i=n(49037),r=n(84718),o=n(15220),a=n(69181),s=n(5024),l=n(29758),c=n(72429),d=function(){function e(){}return e.deserializeRetrieveMultipleBatchResponse=function(e){return(0,i.mG)(this,void 0,Promise,(function(){var t=this;return(0,i.Jh)(this,(function(n){if(null==e||e.status<200||e.status>299)throw new Error("Unexpected error");return[2,e.text().then((function(n){var i,r=[];if(e.headers){var o=/boundary=(.*)/,a=t.getHttpHeader(e.headers,"Content-Type");i=a&&o.test(a)?a.match(o)[1]:""}else i=n.substr(n.indexOf("batchresponse"),n.indexOf("\r\n")-2);for(var s=0,l=t._splitByBoundary(i,n);s<l.length;s++){var c=l[s],d=t._formResponseLikeObjectFromText(c);r.push(d)}return 0===r.length&&(d=t._formResponseLikeObjectFromParts(e.status,e.statusText,e.headers,n),r.push(d)),r}))]}))}))},e.deserializeRetrieveMultipleResponse=function(t,n,i){o.Validations.validateNullArgument(t,"entityMetadata"),o.Validations.validateNullArgument(i,"responseObj"),o.Validations.validateNullArgument(n,"attributesMetadata");var a={entityRecords:[]};i&&i.value&&i.value.length>0&&i.value.forEach((function(i){a.entityRecords.push(e.deserializeRetrieveResponse(t,n,i))})),a.moreRecords=i[s.p.ODataMoreRecords];var l=i[s.p.ODataPagingCookie];if(!r.StringUtil.IsNullOrEmpty(l)){var c=e.extractPagingCookie(l);null!=c&&(a.pagingCookie=c)}return a.totalResultsCount=i[s.p.TotalRecordCount],a.totalRecordLimitExceeded=i[s.p.TotalRecordLimitExceeded],a},e.deserializeRetrieveResponse=function(t,n,i){o.Validations.validateNullArgument(t,"entityMetadata"),o.Validations.validateNullArgument(i,"responseObj"),o.Validations.validateNullArgument(n,"attributesMetadata");var r=new a.T;return r.values=new Map,r.formattedValues=new Map,n.size>0&&i&&n.forEach((function(n,o){var a=e.getAttributeValue(o,n,i);null!==a&&(r.values.set(o,a[0]),r.formattedValues.set(o,a[1]),o===t.primaryIdField&&(r.recordId=a[0]))})),r},e.extractPagingCookie=function(e){var t=null;try{if(!r.StringUtil.IsNullOrEmpty(e)){var n=(new DOMParser).parseFromString(e,"text/xml").documentElement.getAttribute("pagingcookie");null!==n&&(t=decodeURIComponent(decodeURIComponent(n)))}}catch(e){}return t},e.getAttributeValue=function(e,t,n,i,o){var a=null;if(!r.StringUtil.IsNullOrEmpty(e)&&t&&t.dataType)switch(t.dataType){case l.EDataType.Lookup:case l.EDataType.Owner:case l.EDataType.Customer:if(i)r.StringUtil.IsNullOrEmpty(i)||r.StringUtil.IsNullOrEmpty(i.id)||r.StringUtil.IsNullOrEmpty(i.etn)||r.StringUtil.IsNullOrEmpty(i.name)||(a=[{id:i.id.guid,entityLogicalName:i.etn,displayName:i.name},i.name]);else if(n){var d=c.DataSetUtils.isLinkedEntityAttribute(e)?e:"_"+e+"_value",u=n[d],p=n[""+d+s.p.ODataEntityLogicalName],m=n[""+d+s.p.ODataFormattedValue];r.StringUtil.IsNullOrEmpty(u)||r.StringUtil.IsNullOrEmpty(p)||r.StringUtil.IsNullOrEmpty(m)||(a=[{id:u,entityLogicalName:p,displayName:m},m])}break;default:var h=i||n&&n[e],g=o||n&&n[""+e+s.p.ODataFormattedValue];r.StringUtil.IsNullOrEmpty(h)||(a=t.dataType==l.EDataType.Date?[new Date(h),g]:n||t.dataType!=l.EDataType.OptionSet&&t.dataType!=l.EDataType.MultiOptionSet&&t.dataType!=l.EDataType.State&&t.dataType!=l.EDataType.Status?[h,g||h]:[parseInt(h),g])}return a},e.getHttpHeader=function(e,t){if(!e)return null;var n=e.get(t);return n||(n=e.get(t.toLowerCase())),n},e._splitByBoundary=function(e,t){if(!t)return[];var n="--"+e+"\r\n";0===t.indexOf(n)||(n="--"+e+"\n");var i=t.split(n);if(i.splice(0,1),i.length>0){var r=i[i.length-1],o=r.indexOf("--"+e);i[i.length-1]=r.substring(0,o)}return i},e._formResponseLikeObjectFromText=function(e){var t=-1!==e.indexOf("\r\n\r\n"),n=e.trim().split(t?"\r\n\r\n":"\n\n"),i=null,r=null,o=null,a=null;if(n.length>0){var s=null;n.length>1&&(s=n[1].split(t?"\r\n":"\n")),null!=s&&(r=/(HTTP\/\d\.\d) (\d+) (.*)/gi.exec(s[0])),i=r&&r.length>=3?Number(r[2]):0,n.length>2&&(a=n[2]),null!=r&&r.length>3&&(o=r[3])}return this._formResponseLikeObjectFromParts(i,o,{},a)},e._formResponseLikeObjectFromParts=function(e,t,n,i){return{status:e,ok:e&&200<=e&&299>=e,statusText:t,headers:n,clone:function(){return Object.assign({},this)},json:function(){return Promise.resolve(i?JSON.parse(i):null)},text:function(){return Promise.resolve(i)}}},e}()},10979:function(e,t,n){"use strict";n.r(t),n.d(t,{LookupResolver:function(){return s}});var i=n(49037),r=n(63787),o=n(71635),a=n(5024),s=function(){function e(e,t){this.cdsMetadataClient=e,this.telemetryLogger=t}return e.prototype.resolveRelatedEntities=function(e){return(0,i.mG)(this,void 0,Promise,(function(){var t,n,r,o,a;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:t=[],i.label=1;case 1:i.trys.push([1,6,,7]),n=0,i.label=2;case 2:return n<e.length?[4,this.cdsMetadataClient.getEntityMetadata(e[n])]:[3,5];case 3:r=i.sent(),t.push(r[0]),i.label=4;case 4:return n++,[3,2];case 5:return[3,7];case 6:throw o=i.sent(),(a=new Map).set("targetEntities",JSON.stringify(e)),this.logFailure("resolveRelatedEntities",JSON.stringify(e),o&&o.message,a,o),o;case 7:return[2,t]}}))}))},e.prototype.resolveLookupRecordsSimple=function(e,t,n){return(0,i.mG)(this,void 0,Promise,(function(){var r,s,l,c,d,u;return(0,i.Jh)(this,(function(p){switch(p.label){case 0:if(r=[],!(t&&t.length>0))return[3,4];s=function(s){var c,d,u,p,m,h,g,f;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return[4,l.cdsMetadataClient.getEntityMetadata(s)];case 1:if(c=i.sent(),!(d=c[0]))return[3,6];i.label=2;case 2:return i.trys.push([2,5,,6]),u=d.entitySetName+"?$select="+d.primaryNameField+","+d.primaryIdField+"&$orderby="+d.primaryNameField+" asc&$top=50",n&&n.searchString&&(u+="&$filter=contains("+d.primaryNameField+", '"+n.searchString+"')"),p=new Headers({Prefer:'odata.include-annotations="*"'}),[4,fetch(a.p.ODataBaseUri+"/"+u,{headers:p})];case 3:return m=i.sent(),[4,o.P.validateAndGetResponseBody(m)];case 4:return(h=i.sent())&&h.value&&h.value.length>0&&h.value.forEach((function(e){r.push({entityLogicalName:d.name,entityDisplayName:d.displayName,id:e[d.primaryIdField],displayName:e[d.primaryNameField]})})),[3,6];case 5:throw g=i.sent(),(f=new Map).set("entityName",e&&e.name),f.set("targetEntities",JSON.stringify(t)),l.logFailure("resolveLookupRecordsSimple",JSON.stringify(t),g&&g.message,f,g),g;case 6:return[2]}}))},l=this,c=0,d=t,p.label=1;case 1:return c<d.length?(u=d[c],[5,s(u)]):[3,4];case 2:p.sent(),p.label=3;case 3:return c++,[3,1];case 4:return[2,r]}}))}))},e.prototype.resolveLookupRecordsById=function(e,t,n){return(0,i.mG)(this,void 0,Promise,(function(){var s,l,c,d,u,p;return(0,i.Jh)(this,(function(m){switch(m.label){case 0:if(s=[],!(t&&t.length>0&&n&&n.length>0))return[3,4];l=function(l){var d,u,p,m,h,g,f,y,v,C;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return[4,c.cdsMetadataClient.getEntityMetadata(l)];case 1:if(d=i.sent(),!(u=d[0]))return[3,6];i.label=2;case 2:return i.trys.push([2,5,,6]),p="",n.forEach((function(e){p&&(p+=" or "),p+=u.primaryIdField+" eq "+e})),m=u.entitySetName+"?$select="+u.primaryNameField+","+u.primaryIdField+"&$filter=("+p+")",h=new Headers({Prefer:'odata.include-annotations="*"'}),[4,fetch(a.p.ODataBaseUri+"/"+m,{headers:h})];case 3:return g=i.sent(),[4,o.P.validateAndGetResponseBody(g)];case 4:return f=i.sent(),(y=r.CDSResponseParser.deserializeRetrieveMultipleResponse(u,d[1],f))&&y.entityRecords&&y.entityRecords.length>0&&y.entityRecords.forEach((function(e){s.push({entityLogicalName:u.name,entityDisplayName:u.displayName,id:e.values.get(u.primaryIdField),displayName:e.values.get(u.primaryIdField)})})),[3,6];case 5:throw v=i.sent(),(C=new Map).set("entityName",e&&e.name),C.set("targetEntities",JSON.stringify(t)),c.logFailure("resolveLookupRecordsById",JSON.stringify(t),v&&v.message,C,v),v;case 6:return[2]}}))},c=this,d=0,u=t,m.label=1;case 1:return d<u.length?(p=u[d],[5,l(p)]):[3,4];case 2:m.sent(),m.label=3;case 3:return d++,[3,1];case 4:return[2,s]}}))}))},e.prototype.logFailure=function(e,t,n,i,r){this.telemetryLogger.reportFailure("LookupResolver",e,t,"LookupResolver."+e,n,i,r)},e}()},57512:function(e,t,n){"use strict";n.d(t,{w:function(){return c}});var i=n(49037),r=n(63804),o=n(54504),a=n(85234),s=n(52828),l=n(67428),c=function(e){function t(t){var n=e.call(this,t)||this;return n.wrapperDivClass="textFieldWrapper",n.getStyles=function(){var e={fieldGroup:{minHeight:"auto",borderRadius:"2px",border:"2px solid #2266E3 !important",cursor:n.state.isEditMode||n.props.hasError?"text":"default",background:n.state.isEditMode||n.props.saveInProgress?"white !important":"transparent !important"},field:{height:"auto"}};return n.props.hasError?e.fieldGroup=Object.assign({},e.fieldGroup,{color:"rgb(51,51,51)",border:"none !important",":hover":{borderRadius:"2px",border:"2px solid #A80000 !important",background:"white !important"},":focus-within":{borderRadius:"2px",border:"2px solid #A80000 !important",background:"white !important"}}):!n.props.disabled&&n.state.isEditMode||(e.fieldGroup=Object.assign({},e.fieldGroup,{color:"rgb(51,51,51)",backgroundColor:"transparent",border:n.props.saveInProgress?"2px solid #2266E3 !important":"none"}),e.field=Object.assign({},e.field,{background:"white !important",color:"rgb(51,51,51)",cursor:"default"})),n.props.customTextStyles&&(e.field=[n.props.customTextStyles,e.field]),n.shouldMakeTextClickable()&&(e.field=Object.assign({},e.field,{selectors:{":hover":{textDecoration:"underline",cursor:"pointer"},":focus":{textDecoration:"underline",cursor:"pointer"}},color:"rgb(51,51,51)"})),e},n.onBlur=function(e){if(!n.wrapperDiv.current.contains(e.relatedTarget)&&(n.state.isEditMode||n.props.hasError)&&(n.setState({isEditMode:!1}),n.props.onChanged)){var t=n.wrapperDiv.current.querySelector("input");n.props.onChanged(""!==t.value?t.value:null)}},n.onDivKeyDown=function(e){n.state.isEditMode||n.props.hasError||e.target.className.indexOf(n.wrapperDivClass)>=0&&13==e.keyCode&&n.setState({isEditMode:!0})},n.onKeyDown=function(e){n.state.isEditMode||n.props.hasError?27==e.keyCode?(n.textInput.current.setState({uncontrolledValue:n.props.formattedValue}),n.setState({isEditMode:!1})):13==e.keyCode&&(n.setState({isEditMode:!1}),n.props.onChanged&&n.props.onChanged(""!==e.target.value?e.target.value:null)):13==e.keyCode&&n.onTextClick()},n.state={isEditMode:!1},n.textInput=r.createRef(),n.wrapperDiv=r.createRef(),n}return(0,i.ZT)(t,e),t.prototype.componentDidUpdate=function(){!this.state.isEditMode||this.props.saveInProgress||this.props.isSaveSuccessful||this.textInput.current.focus(),this.state.isEditMode||this.props.hasError||this.textInput.current.setState({uncontrolledValue:this.props.formattedValue})},t.prototype.render=function(){return r.createElement("div",{className:this.wrapperDivClass,tabIndex:this.props.disabled?-1:0,ref:this.wrapperDiv,onKeyDown:this.onDivKeyDown.bind(this),onBlur:this.onBlur.bind(this)},r.createElement(o.TextField,{borderless:!0,tabIndex:this.shouldMakeTextClickable()?0:-1,componentRef:this.textInput,defaultValue:this.props.formattedValue&&null!==this.props.formattedValue?this.props.formattedValue:"",onKeyDown:this.onKeyDown.bind(this),placeholder:this.state.isEditMode?"":"-",styles:this.getStyles(),readOnly:this.props.disabled||!this.state.isEditMode&&!this.props.hasError,title:this.state.isEditMode?void 0:this.props.formattedValue,ariaLabel:this.props.ariaLabel,spellCheck:!1,multiline:this.props.multiline,resizable:!1,autoAdjustHeight:!0,onRenderSuffix:this.onRenderSuffix.bind(this),onClick:this.onTextClick.bind(this)}))},t.prototype.shouldMakeTextClickable=function(){return(this.isPrimaryFieldLink()||this.isEmailLink()||this.isUrlLink())&&!this.state.isEditMode&&!this.props.hasError&&!this.props.saveInProgress&&this.props.formattedValue&&""!=this.props.formattedValue},t.prototype.isEmailLink=function(){return this.props.fieldContext&&"Email"==this.props.fieldContext.format},t.prototype.isPhoneLink=function(){return this.props.fieldContext&&"Phone"==this.props.fieldContext.format},t.prototype.isUrlLink=function(){return this.props.fieldContext&&"Url"==this.props.fieldContext.format},t.prototype.isPrimaryFieldLink=function(){return this.props.entityContext&&this.props.fieldContext&&this.props.entityContext.primaryNameField==this.props.fieldContext.name},t.prototype.onTextClick=function(){if(this.shouldMakeTextClickable()){if(this.isPrimaryFieldLink()&&this.props.openEntity&&this.props.entityContext)return this.props.openEntity(this.props.recordId,this.props.entityContext.name);if(this.isEmailLink()&&this.props.openEmail)return this.props.openEmail(this.props.value);if(this.isPhoneLink()&&this.props.openPhone)return this.props.openPhone(this.props.value);if(this.isUrlLink()&&this.props.openUrl)return this.props.openUrl(this.props.value)}},t.prototype.onRenderSuffix=function(){if(this.state.isEditMode)return r.createElement("div",null);var e={getToolTipContent:this.props.getToolTipContent,getToolTipProps:this.props.getToolTipProps,toolTipDetails:this.props.toolTipDetails,isEditMode:this.state.isEditMode,disabled:this.props.disabled,onSaveSuccessRender:this.props.onSaveSuccessRender,onSaveInProgressRender:this.props.onSaveInProgressRender,onErrorRender:this.props.onErrorRender,saveInProgress:this.props.saveInProgress,isSaveSuccessful:this.props.isSaveSuccessful,hasError:this.props.hasError,onEditButtonRender:this.getEditButton.bind(this),onCallButtonRender:this.getCallButton.bind(this),showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands,openEntity:this.openEntity.bind(this),resources:this.props.resources};return r.createElement(l.ZE,(0,i.pi)({},e))},t.prototype.openEntity=function(){this.props.openEntity&&this.props.entityContext&&this.props.openEntity(this.props.recordId,this.props.entityContext.name,!0)},t.prototype.getEditButton=function(){var e=this;return r.createElement(s.IconButton,{tabIndex:-1,className:this.props.showQuickActions?"firstColumnEditIcon editIcon":"editIcon",style:{cursor:this.props.disabled||this.props.toolTipDetails!=a.FieldDisabledReason.None?"default":"pointer"},iconProps:{iconName:"Edit"},ariaLabel:this.props.getToolTipContent&&this.props.getToolTipContent(),onClick:function(t){e.props.disabled||e.props.toolTipDetails!=a.FieldDisabledReason.None||(e.setState({isEditMode:!0}),t.stopPropagation())}})},t.prototype.getCallButton=function(){var e=this;return this.isPhoneLink()?r.createElement(s.IconButton,{tabIndex:-1,className:this.props.showQuickActions?"firstColumnEditIcon editIcon":"editIcon",style:{cursor:this.props.disabled||this.props.toolTipDetails!=a.FieldDisabledReason.None?"default":"pointer"},iconProps:{iconName:"Phone"},ariaLabel:this.props.getToolTipContent&&this.props.getToolTipContent(),onClick:function(t){e.props.openPhone&&e.props.openPhone(e.props.value)}}):r.createElement("div",null)},t}(r.PureComponent)},43891:function(e,t,n){"use strict";n.d(t,{z:function(){return p}});var i=n(49037),r=n(63804),o=n(85234),a=n(77437),s=n(29758),l=n(97349),c=n(82699),d=n(67428),u=n(48945),p=function(e){function t(t){var n=e.call(this,t)||this;return n.wrapperClass="dateFieldWrapper",n.datePickerId="datePickerComponent",n.minimumYear=1753,n.monthLocStrings=["DatePicker_Month_January","DatePicker_Month_February","DatePicker_Month_March","DatePicker_Month_April","DatePicker_Month_May","DatePicker_Month_June","DatePicker_Month_July","DatePicker_Month_August","DatePicker_Month_September","DatePicker_Month_October","DatePicker_Month_November","DatePicker_Month_December"],n.shortMonthLocStrings=["DatePicker_ShortMonth_Jan","DatePicker_ShortMonth_Feb","DatePicker_ShortMonth_Mar","DatePicker_ShortMonth_Apr","DatePicker_ShortMonth_May","DatePicker_ShortMonth_Jun","DatePicker_ShortMonth_Jul","DatePicker_ShortMonth_Aug","DatePicker_ShortMonth_Sep","DatePicker_ShortMonth_Oct","DatePicker_ShortMonth_Nov","DatePicker_ShortMonth_Dec"],n.dayLocStrings=["DatePicker_Day_Sunday","DatePicker_Day_Monday","DatePicker_Day_Tuesday","DatePicker_Day_Wednesday","DatePicker_Day_Thursday","DatePicker_Day_Friday","DatePicker_Day_Saturday"],n.shortDayLocStrings=["DatePicker_ShortDay_Sunday","DatePicker_ShortDay_Monday","DatePicker_ShortDay_Tuesday","DatePicker_ShortDay_Wednesday","DatePicker_ShortDay_Thursday","DatePicker_ShortDay_Friday","DatePicker_ShortDay_Saturday"],n.dayPickerStrings={months:n.monthLocStrings.map((function(e){return u.D.getLocalizedString(e)})),shortMonths:n.shortMonthLocStrings.map((function(e){return u.D.getLocalizedString(e)})),days:n.dayLocStrings.map((function(e){return u.D.getLocalizedString(e)})),shortDays:n.shortDayLocStrings.map((function(e){return u.D.getLocalizedString(e)})),goToToday:u.D.getLocalizedString("DatePicker_GoToToday"),prevMonthAriaLabel:u.D.getLocalizedString("DatePicker_GoToPreviousMonth"),nextMonthAriaLabel:u.D.getLocalizedString("DatePicker_GoToNextMonth"),prevYearAriaLabel:u.D.getLocalizedString("DatePicker_GoToPreviousYear"),nextYearAriaLabel:u.D.getLocalizedString("DatePicker_GoToNextYear"),isRequiredErrorMessage:u.D.getLocalizedString("DatePicker_IsRequiredErrorMessage"),invalidInputErrorMessage:u.D.getLocalizedString("DatePicker_InvalidInputErrorMessage")},n.onKeyDown=function(e){n.state.isEditMode||n.props.hasError?n.state.isEditMode&&27==e.keyCode&&n.setState({isEditMode:!1}):e.target.className.indexOf(n.wrapperClass)>=0&&13==e.keyCode&&n.setState({isEditMode:!0})},n._formatDate=function(e){var t=n.props.value?n.props.value:e;return(0,l.le)(t)?"":n.formatToDateOnly(n.transformUtcDateToLocal(t))},n.onSelectDate=function(e){(null==e||null!=e&&e.getFullYear()>=n.minimumYear)&&n.props.onChanged&&(e?n.props.onChanged(n.transformLocalDateToUtc(e,n.transformUtcDateToLocal(n.props.value))):n.props.onChanged(null))},n.formatToDateOnly=function(e){return!(0,l.le)(e)&&n.props.timezoneService?n.props.timezoneService.formatDateShort(e,!1):""},n.state={isEditMode:!1},n.dateInput=r.createRef(),n}return(0,i.ZT)(t,e),t.prototype.componentDidUpdate=function(){!this.state.isEditMode||this.props.saveInProgress||this.props.hasError||this.dateInput&&this.dateInput.current&&this.dateInput.current.focus()},t.prototype.render=function(){var e=this.transformUtcDateToLocal(this.props.value);return r.createElement(a.DatePicker,{id:this.datePickerId+this.props.recordId+(this.props.fieldContext?this.props.fieldContext.name:""),strings:this.dayPickerStrings,componentRef:this.dateInput,tabIndex:this.props.disabled?-1:0,className:this.wrapperClass,value:(0,l.le)(e)?void 0:e,placeholder:"-",isMonthPickerVisible:!1,allowTextInput:!0,onSelectDate:this.onSelectDate.bind(this),ariaLabel:this.props.ariaLabel,disabled:this.props.disabled||!this.state.isEditMode&&!this.props.hasError,formatDate:this._formatDate.bind(this),borderless:!0,calloutProps:{className:"datePickerCallout"},styles:this.getStyles.bind(this),textField:this.getTextfieldProps(),title:this.state.isEditMode||(0,l.le)(this.props.value)?void 0:this.formatToDateOnly(e),onKeyDown:this.onKeyDown.bind(this),onBlur:this.onBlur.bind(this)})},t.prototype.onBlur=function(e){(null==e||null==e.relatedTarget||null==e.relatedTarget.className||e.relatedTarget.className.indexOf(this.wrapperClass)>=0&&e.relatedTarget.className!=e.currentTarget.className||-1==e.relatedTarget.className.indexOf("ms-DatePicker")&&-1==e.relatedTarget.id.indexOf(this.datePickerId))&&this.state.isEditMode&&this.setState({isEditMode:!1})},t.prototype.getStyles=function(){return{textField:[{width:"100%",selectors:{"& .ms-TextField-fieldGroup":{height:this.state.isEditMode||this.props.saveInProgress?"38px !important":"42px !important"},"& .ms-TextField-fieldGroup:hover":{borderRadius:"2px",border:this.props.hasError?"2px solid #A80000 !important":"",background:this.props.hasError?"white !important":"transparent !important"},"& .ms-TextField-fieldGroup:focus":{height:"38px !important"},"& .ms-TextField-fieldGroup:focus-within":{borderRadius:"2px",height:"38px !important",border:this.props.hasError?"2px solid #A80000 !important":"",background:this.props.hasError?"white !important":"transparent !important"},"& .ms-TextField-fieldGroup:active":{height:this.state.isEditMode?"38px !important":"42px !important"}}}],icon:{display:this.props.disabled||!this.state.isEditMode?"none":"inline-flex"},root:this.getRootStyles()}},t.prototype.getRootStyles=function(){var e={height:"42px",borderRadius:"2px",border:"2px solid #2266E3 !important",background:this.state.isEditMode||this.props.saveInProgress?"white !important":"transparent !important",":focus":{border:"2px solid #2266E3 !important"}};return this.props.hasError?e=Object.assign({},e,{border:"none !important"}):!this.props.disabled&&this.state.isEditMode||(e=Object.assign({},e,{border:this.props.saveInProgress?"2px solid #2266E3 !important":"none"})),e},t.prototype.getTextfieldProps=function(){return{tabIndex:-1,styles:{field:[this.props.customTextStyles?this.props.customTextStyles:{},this.props.disabled||!this.state.isEditMode?{background:"white !important",color:"rgb(51,51,51)"}:{}]},onRenderSuffix:this.onRenderSuffix.bind(this)}},t.prototype.onRenderSuffix=function(){var e={getToolTipContent:this.props.getToolTipContent,getToolTipProps:this.props.getToolTipProps,toolTipDetails:this.props.toolTipDetails,isEditMode:this.state.isEditMode,disabled:this.props.disabled,onSaveSuccessRender:this.props.onSaveSuccessRender,onSaveInProgressRender:this.props.onSaveInProgressRender,onErrorRender:this.props.onErrorRender,saveInProgress:this.props.saveInProgress,isSaveSuccessful:this.props.isSaveSuccessful,hasError:this.props.hasError,onEditButtonRender:this.getEditButton.bind(this),showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands,openEntity:this.openEntity.bind(this),resources:this.props.resources};return r.createElement(d.ZE,(0,i.pi)({},e))},t.prototype.openEntity=function(){this.props.openEntity&&this.props.entityContext&&this.props.openEntity(this.props.recordId,this.props.entityContext.name,!0)},t.prototype.getEditButton=function(){var e=this,t=this;return r.createElement(c.IconButton,{tabIndex:-1,className:this.props.showQuickActions?"firstColumnEditIcon editIcon":"editIcon",style:{cursor:this.props.disabled||this.props.toolTipDetails!=o.FieldDisabledReason.None?"default":"pointer"},iconProps:{iconName:"Calendar"},ariaLabel:this.props.getToolTipContent&&this.props.getToolTipContent(),onClick:function(n){e.props.disabled||e.props.toolTipDetails!=o.FieldDisabledReason.None||(t.setState({isEditMode:!0}),n.stopPropagation())}})},t.prototype.transformLocalDateToUtc=function(e,t){var n=this.setTimeFromOldValue(e,t);return(0,l.le)(this.props.fieldContext)?n:this.props.fieldContext.behavior===s.DateTimeFieldBehavior.DateOnly||this.props.fieldContext.behavior===s.DateTimeFieldBehavior.TimeZoneIndependent?this.props.timezoneService.browserTimeZoneToUtc(n):this.props.timezoneService.userLocalToUtc(n)},t.prototype.transformUtcDateToLocal=function(e){return(0,l.le)(this.props.fieldContext)||(0,l.le)(e)?e:this.props.fieldContext.behavior===s.DateTimeFieldBehavior.DateOnly||this.props.fieldContext.behavior===s.DateTimeFieldBehavior.TimeZoneIndependent?this.props.timezoneService.utcToBrowserTimeZone(e):this.props.timezoneService.utcToUserLocal(e)},t.prototype.setTimeFromOldValue=function(e,t){return(0,l.le)(t)?e:new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes(),t.getSeconds())},t}(r.PureComponent)},88346:function(e,t,n){"use strict";n.d(t,{l7:function(){return o},fS:function(){return a}});var i=n(6397),r=n(52540).e(".ms-Callout-main"),o=(0,i.mergeStyles)(r,{"& .ms-ContextualMenu-icon":{color:"#333"}}),a=(0,i.mergeStyles)({minHeight:50,display:"flex",alignItems:"center",justifyContent:"center"})},40919:function(e,t,n){"use strict";n.d(t,{D:function(){return u}});var i=n(49037),r=n(63804),o=n(52828),a=n(96424),s=n(76823),l=n(50910),c=n(16312),d=n(88346),u=function(e){var t=e.createCommands,n=e.setDisplayQuickActions,u=e.displayQuickActions,p=null==t?void 0:t.getRecordCommands,m=null==t?void 0:t.customFilter,h=(0,c.u)(p),g=h[0],f=h[1],y=r.useRef(null),v=r.useState(!1),C=v[0],S=v[1],E=r.useState([{key:"loadingItem",text:""}]),b=E[0],w=E[1],D=r.useCallback((function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return e.preventDefault(),S(!C),n&&n(!u),[4,f()];case 1:return t.sent(),[2]}}))}))}),[f,n,u]),T=r.useCallback((function(){S(!1),n&&n(!1)}),[n]),x=r.useCallback((function(e,t){return r.createElement("div",{className:(null==g?void 0:g.loading)?d.fS:""},(null==g?void 0:g.loading)?r.createElement(l.Spinner,null):t?t(e):r.createElement("div",null))}),[g.loading,g.data,g.error]);return r.useEffect((function(){if((null==g?void 0:g.data)&&!(null==g?void 0:g.loading)){var e=(null==g?void 0:g.data)&&(t=g.data,n=m&&t?m(t):t,i=new s.e,n.map((function(e){return{key:e.commandId,iconProps:{iconName:i.getEntityFluentName(e.icon)},text:e.label,onClick:e.execute}})))||[];w(e)}var t,n,i}),[g.data,g.loading]),r.createElement("div",{ref:y},r.createElement(o.IconButton,{iconProps:{iconName:"MoreVertical"},className:(u?"showQuickActionsIcon":"")+" quickActionsIcon",title:"Commands Menu",ariaLabel:"Commands Menu",onClick:D}),r.createElement(a.r,{items:b,className:d.l7,hidden:!C,target:y,onItemClick:T,onDismiss:T,onRenderMenuList:x}))}},86260:function(e,t,n){"use strict";n.d(t,{u:function(){return r},P:function(){return o}});var i=n(6397),r=(0,i.mergeStyles)({display:"flex","& .quickActionsIcon":{height:42,width:32,color:"#605e5c",display:"none",borderRadius:0},"&:hover .quickActionsIcon":{display:"inline-flex"},"& .showQuickActionsIcon":{display:"inline-flex !important",backgroundColor:"#d4d2cf",color:"#323130"}}),o=(0,i.mergeStyles)({"& .ms-ComboBox-container":{backgroundColor:"transparent",width:"100%"},"& .ms-ComboBox":{backgroundColor:"transparent",border:"none !important",alignItems:"center",height:"100%",paddingRight:9,paddingLeft:12},"& .ms-ComboBox::after":{border:"none"},"& .ms-ComboBox-Input":{backgroundColor:"transparent",outline:"none !important"},"& .ms-ComboBox-CaretDown-button":{display:"none"}})},67428:function(e,t,n){"use strict";n.d(t,{$L:function(){return u},ZE:function(){return p}});var i=n(49037),r=n(63804),o=n(52828),a=n(46204),s=n(70804),l=n(85234),c=n(40919),d=n(86260),u=function(e){return r.createElement("div",{className:d.P+" workspaceFieldControlWrapper",tabIndex:e.disabled||e.hasError?-1:0,style:e.style,title:e.title,onBlur:e.onBlur,onKeyDown:e.onKeyDown},e.content,r.createElement(p,(0,i.pi)({},e)))},p=function(e){var t=r.useState(!1),n=t[0],o=t[1],a=(0,i.pi)({displayQuickActions:n,setDisplayQuickActions:o},e);return e.isSaveSuccessful&&e.onSaveSuccessRender&&f(e)&&e.onEditButtonRender?C(e):e.isSaveSuccessful&&e.onSaveSuccessRender&&!e.isEditMode?e.onSaveSuccessRender():!e.isSaveSuccessful&&e.saveInProgress&&e.onSaveInProgressRender?e.onSaveInProgressRender():e.hasError&&e.onErrorRender?e.onErrorRender():y(e)?v(a):f(e)&&e.onEditButtonRender?m(e):h(e)},m=function(e){return r.createElement(r.Fragment,null,h(e),g(e))},h=function(e){var t;return r.createElement(a.TooltipHost,{delay:s.TooltipDelay.zero,content:null===(t=e.resources)||void 0===t?void 0:t.getLocalizedString("WS_View_Record_Call"),tooltipProps:e.getToolTipProps&&e.getToolTipProps()},e.onCallButtonRender&&e.onCallButtonRender())},g=function(e){return r.createElement(a.TooltipHost,{delay:s.TooltipDelay.zero,content:e.getToolTipContent&&e.getToolTipContent(),tooltipProps:e.getToolTipProps&&e.getToolTipProps()},e.onEditButtonRender&&e.onEditButtonRender())},f=function(e){return e.disabled&&e.toolTipDetails!=l.FieldDisabledReason.None||!e.saveInProgress&&!e.hasError&&!e.isEditMode&&!e.disabled},y=function(e){return!e.saveInProgress&&!e.isSaveSuccessful&&!e.hasError&&!e.isEditMode&&e.showQuickActions},v=function(e){var t,n;return r.createElement("div",{className:d.u+" workspaceQuickActionsContainer"},r.createElement(o.IconButton,{iconProps:{iconName:"MiniExpand"},className:"quickActionsIcon",title:null===(t=e.resources)||void 0===t?void 0:t.getLocalizedString("WS_View_Record_Page"),ariaLabel:null===(n=e.resources)||void 0===n?void 0:n.getLocalizedString("WS_View_Record_Page"),onClick:function(){e.openEntity&&e.openEntity()}}),h(e),!e.disabled&&g(e),r.createElement(c.D,(0,i.pi)({},e)))},C=function(e){return r.createElement("div",{style:{display:"flex",flexDirection:"row"}},e.showQuickActions&&r.createElement(c.D,(0,i.pi)({},e)),e.onSaveSuccessRender&&e.onSaveSuccessRender(),h(e),g(e))}},91500:function(e,t,n){"use strict";n.d(t,{F:function(){return T}});var i=n(49037),r=n(20480),o=n(60555),a=n(63804),s=n(67428),l=n(3206),c=n(50910),d=n(24831),u=n(36518),p=n(97349),m=n(85234),h=n(29758),g=n(87953),f=n(64828),y=n(52828),v=(0,l.mergeStyles)({selectors:{"& .ms-BasePicker-input":{height:"30px",minWidth:"0px",width:"100%"},"& .ms-BasePicker-text":{minWidth:"0px",borderRadius:"2px",width:"100%"}}}),C=(0,l.mergeStyles)(v,{selectors:{"& .ms-BasePicker-input":{backgroundColor:"white"}}}),S=(0,l.mergeStyles)(v,{}),E=(0,l.mergeStyles)(C),b=(0,l.mergeStyles)({display:"flex"}),w=(0,l.mergeStyles)({alignSelf:"center",marginRight:"4px"}),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.getInput=function(){return this.input},t.prototype.getRootElement=function(){return this.root},t}(r.dT),T=function(e){function t(t){var n=e.call(this,t)||this;return n.personaData={recordId:"",formattedValues:new Map,values:new Map},n.onChange=function(e){n.props.onChanged&&Array.isArray(e)&&n.props.onChanged(e[0]||[])},n.onEmptyInputFocus=function(){return n.getFilteredLookups("")},n.getFilteredLookups=function(e){return(0,i.mG)(n,void 0,void 0,(function(){var t,n,r,o,a;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return t=this.state.cachedResults.get(e),Array.isArray(t)?[2,t]:(n=this.isPolymorphicLookup(),[4,this.getRelations(n)]);case 1:return r=i.sent(),o=this.gatherLookupTargets(),this.props.entityContext?[4,this.props.resolver.resolveLookupRecordsSimple(this.props.entityContext,o,{searchString:e,searchDefaultLookupView:!0},this.props.entityRecordContext)]:[3,3];case 2:return 0===(a=i.sent()).length&&(0,p.GX)(e.toLowerCase())&&a.push({id:e.toLowerCase(),displayName:e.toLowerCase(),entityLogicalName:"",unmatchedRecord:!0}),[2,this.processLookupRecords(a,n,r,e)];case 3:return console.error("There were no cached results nor entityContext"),[2,[]]}}))}))},n.onItemSelected=function(e){return n.setState({isEditMode:!1}),e&&n.pickerRef.current&&!n.pickerRef.current.items.find((function(t){return t.id===e.id}))?e:null},n.state={cachedResults:new Map,previouslySelectedItems:[],finishedInitialLoading:!1,fetchedData:!1,isEditMode:!1},n.pickerRef=a.createRef(),n}return(0,i.ZT)(t,e),t.prototype.componentDidMount=function(){this.performDOMManipulation()},t.prototype.componentDidUpdate=function(){this.performDOMManipulation(),!this.state.isEditMode||this.props.saveInProgress||this.props.hasError||this.pickerRef&&this.pickerRef.current&&this.pickerRef.current.focus()},t.prototype.render=function(){var e,t=this,n=this.props.value?Array.isArray(this.props.value)?this.props.value:[this.props.value]:void 0,i=!(!this.props.fieldContext||!this.props.fieldContext.businessRequired);if(this.props.additionalPersonaProps&&n&&1===n.length){var r=window.sessionStorage.getItem("PersonaDataMap")||"{}",o=JSON.parse(r);this.personaData=this.getEntityRecordFromJSON(o[n[0].id]),this.fetchPersonaData(this.props.additionalPersonaProps,n[0])}return a.createElement(s.$L,{style:this.getStyles(),onBlur:this.onDivBlur.bind(this),onKeyDown:this.onKeyDown.bind(this),isEditMode:this.state.isEditMode,disabled:this.props.disabled,onSaveSuccessRender:this.props.onSaveSuccessRender,onSaveInProgressRender:this.props.onSaveInProgressRender,onErrorRender:this.props.onErrorRender,saveInProgress:this.props.saveInProgress,isSaveSuccessful:this.props.isSaveSuccessful,hasError:this.props.hasError,getToolTipContent:this.props.getToolTipContent,getToolTipProps:this.props.getToolTipProps,toolTipDetails:this.props.toolTipDetails,onEditButtonRender:function(){return a.createElement(y.IconButton,{tabIndex:-1,className:t.props.showQuickActions?"firstColumnEditIcon editIcon":"editIcon",style:{cursor:t.props.disabled||t.props.toolTipDetails!=m.FieldDisabledReason.None?"default":"pointer"},iconProps:{iconName:"Edit"},ariaLabel:t.props.getToolTipContent&&t.props.getToolTipContent(),onClick:function(e){t.props.disabled||t.props.toolTipDetails!=m.FieldDisabledReason.None||(t.setState({isEditMode:!0}),e.stopPropagation())}})},showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands,openEntity:this.openEntity.bind(this),resources:this.props.resources,title:null===(e=this.props.fieldContext)||void 0===e?void 0:e.displayName,content:a.createElement(D,{className:this.props.hasError?S:this.props.disabled?E:this.state.isEditMode?v:C,componentRef:this.pickerRef,onEmptyInputFocus:this.onEmptyInputFocus.bind(this),onResolveSuggestions:this.getFilteredLookups.bind(this),onItemSelected:this.onItemSelected.bind(this),selectedItems:this.state.isEditMode?[]:n,onChange:this.onChange.bind(this),onEmptyResolveSuggestions:this.onEmptyInputFocus.bind(this),resolveDelay:500,onBlur:this.onPickerBlur.bind(this),pickerCalloutProps:{className:"lookupPickerCallout"},inputProps:{"aria-label":this.props.ariaLabel,"aria-required":i,placeholder:this.state.isEditMode?"":"-",style:{padding:"0 8px 0px"},defaultVisibleValue:n&&n.length>0?n[0].displayName:""},pickerSuggestionsProps:{className:"lookupPickerDropdown",loadingText:this.props.resources?this.props.resources.getLocalizedString("Picker_Loading_Results"):(0,f.K)("LOADING_RESULTS"),noResultsFoundText:this.props.resources?this.props.resources.getLocalizedString("Picker_No_Results_Found"):(0,f.K)("NO_RESULTS_FOUND")},itemLimit:this.props.singleSelect?1:void 0,disabled:this.props.disabled||!this.state.isEditMode&&!this.props.hasError,onRenderItem:this.onRenderItem.bind(this),onRenderSuggestionsItem:this.onRenderSuggestionsItem.bind(this)})})},t.prototype.openEntity=function(){this.props.openEntity&&this.props.entityContext&&this.props.openEntity(this.props.recordId,this.props.entityContext.name,!0)},t.prototype.onPickerBlur=function(e){if(this.state.isEditMode&&e.target&&e.target.className&&(e.target.className.indexOf("ms-Callout")>=0||e.target.className.indexOf("ms-BasePicker-input")>=0)){if(this.pickerRef&&this.pickerRef.current){var t=this.pickerRef.current.getInput();t&&t.current&&""!=t.current.value?t.current._updateValue(""):this.props.onChanged&&this.props.onChanged([])}this.setState({isEditMode:!1})}},t.prototype.onDivBlur=function(e){this.state.isEditMode&&e.target&&e.target.className&&e.target.className.indexOf("ms-TagItem")>=0&&e.relatedTarget&&e.relatedTarget.className&&-1==e.relatedTarget.className.indexOf("ms-TagItem-close")&&!this.props.hasError&&this.setState({isEditMode:!1})},t.prototype.onKeyDown=function(e){if(this.state.isEditMode)if(27==e.keyCode)this.setState({isEditMode:!1}),this.pickerRef&&this.pickerRef.current&&(t=this.pickerRef.current.getInput())&&t.current&&""!=t.current.value&&t.current._updateValue("");else if(13==e.keyCode){var t;this.pickerRef&&this.pickerRef.current&&(t=this.pickerRef.current.getInput())&&t.current&&""==t.current.value&&this.props.onChanged&&this.props.onChanged([]),this.setState({isEditMode:!1})}this.state.isEditMode||this.props.hasError||(e.target.className.indexOf("fieldControlWrapper")>=0||e.target.className.indexOf("ms-TagItem ")>=0)&&13==e.keyCode&&(this.setState({isEditMode:!0}),e.stopPropagation())},t.prototype.getStyles=function(){var e={display:"flex",border:"none",height:"42px",width:"auto !important",borderRadius:"2px",justifyContent:"stretch",background:this.state.isEditMode||this.props.saveInProgress||this.props.hasError?"white":"transparent"};return this.state.isEditMode||this.props.saveInProgress?Object.assign({},e,{border:"2px solid #2266E3",height:"38px"}):this.props.hasError?Object.assign({},e,{border:"2px solid #A80000",height:"38px"}):e},t.prototype.fetchPersonaData=function(e,t){var n=this,i=[];e.keyForSecondaryText&&i.push(e.keyForSecondaryText),e.icons&&e.icons.map((function(e){i.push(e.keyForFieldValue)})),e.cdsDataClient.retrieveRecord(t.entityLogicalName,t.id,i).then((function(e){if(JSON.stringify(n.getJSONFromEntityRecord(n.personaData))!==JSON.stringify(n.getJSONFromEntityRecord(e))){var i=window.sessionStorage.getItem("PersonaDataMap")||"{}",r=JSON.parse(i);r[t.id]=n.getJSONFromEntityRecord(e),window.sessionStorage.setItem("PersonaDataMap",JSON.stringify(r)),n.setState({fetchedData:!0})}}))},t.prototype.getJSONFromEntityRecord=function(e){var t=JSON.stringify(Array.from(e.values)),n=JSON.stringify(Array.from(e.formattedValues));return{recordId:e.recordId,formattedValues:n,values:t}},t.prototype.getEntityRecordFromJSON=function(e){return e?{recordId:e.recordId,formattedValues:new Map(JSON.parse(e.formattedValues)),values:new Map(JSON.parse(e.values))}:{recordId:"",formattedValues:new Map,values:new Map}},t.prototype.performDOMManipulation=function(){var e=this.pickerRef.current&&this.pickerRef.current.getRootElement().current&&this.pickerRef.current.getRootElement().current.getElementsByClassName("ms-TagItem");if(e&&e.length)for(var t=0;t<e.length;t++){var n=e[t],i=n.parentElement&&n.parentElement.parentElement;i&&(i.style.width="100%")}},t.prototype.onRenderItem=function(e){var t=this,n=(0,i.pi)((0,i.pi)({},e),{item:{key:"",name:""},onItemChange:function(){return null}}),r=e.item.displayName?e.item.displayName:"-";return a.createElement("div",{style:{width:"100%",display:"flex"},"aria-label":this.props.ariaLabel},a.createElement(o.zq,(0,i.pi)({},n,{className:"ms-TagItem",styles:this.getTagItemStyles(),title:r,removeButtonAriaLabel:this.props.resources?this.props.resources.getLocalizedString("REMOVE"):(0,f.K)("REMOVE")}),!e.item.displayName&&a.createElement(c.Spinner,{size:d.SpinnerSize.xSmall,styles:{root:{marginTop:7}}}),a.createElement("div",{className:b},a.createElement(g.Persona,{size:this.getPersonaSize(this.props.additionalPersonaProps),text:e.item.displayName?e.item.displayName:"-",imageUrl:"./Image/download.aspx?Entity="+e.item.entityLogicalName+"&Attribute=entityimage&Id="+e.item.id,showInitialsUntilImageLoads:!0,imageAlt:e.item.displayName?e.item.displayName:"-",secondaryText:this.getSecondaryText(),className:w,onClick:this.state.isEditMode?void 0:function(){return t.props.openEntity&&t.props.openEntity(e.item.id,e.item.entityLogicalName)},styles:{root:{cursor:this.props.openEntity?"pointer":"default",padding:0,overflow:"hidden",textOverflow:"ellipsis",height:"100%"},primaryText:this.state.isEditMode?{}:{selectors:{":hover":{textDecoration:"underline"}}}}}))),this.props.additionalPersonaProps&&this.props.additionalPersonaProps.icons&&a.createElement("div",{style:{marginLeft:"auto",display:"flex"}},this.props.additionalPersonaProps.icons.map((function(e){return t.addIconToTagItem(e)}))))},t.prototype.addIconToTagItem=function(e){var t=this;return a.createElement(y.IconButton,{styles:{root:{width:"100%",height:"100%"}},iconProps:e.iconProps,onClick:function(){return e.onClickHandler(t.personaData?t.personaData.values.get(e.keyForFieldValue):"")}})},t.prototype.getSecondaryText=function(){var e=this.props.additionalPersonaProps;return this.personaData&&e&&e.keyForSecondaryText?this.personaData.formattedValues.get(e.keyForSecondaryText):""},t.prototype.getPersonaSize=function(e){return e&&e.keyForSecondaryText&&this.personaData&&this.personaData.formattedValues.get(e.keyForSecondaryText),g.PersonaSize.size24},t.prototype.onRenderSuggestionsItem=function(e){return a.createElement("div",{id:"suggestionitem"+e.id,style:{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"60",padding:"7px 12px"}},a.createElement(u.Label,{style:{padding:0}},e.displayName," ",e.entityDisplayName?"("+e.entityDisplayName+")":void 0))},t.prototype.getTagItemStyles=function(){var e={root:{minWidth:"0px",overflow:"hidden",textOverflow:"ellipsis",height:"42px",lineHeight:"normal",alignItems:"center",width:"100%"},text:{marginLeft:"6px",marginRight:"2px",width:"100%"},close:{display:"none"}};return this.state.isEditMode&&!this.props.disabled||(e.root=Object.assign({},e.root,{background:"transparent",selectors:{":hover":{background:"transparent"}}})),this.state.isEditMode&&(e.root=Object.assign({},e.root,{background:"white",height:"38px",selectors:{":hover":{background:"white"}}})),this.props.saveInProgress&&(e.root=Object.assign({},e.root,{height:"38px"})),e},t.prototype.getRelations=function(e){return(0,i.mG)(this,void 0,void 0,(function(){var t,n,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return e&&this.props.fieldContext&&this.props.fieldContext.targets?[4,this.props.resolver.resolveRelatedEntities(this.props.fieldContext.targets)]:[3,2];case 1:return n=i.sent(),[3,3];case 2:n=[],i.label=3;case 3:return t=n,r=new Map,t.forEach((function(e){r.set(e.name.toLowerCase(),e)})),[2,r]}}))}))},t.prototype.isPolymorphicLookup=function(){return this.props.fieldContext&&this.props.fieldContext.targets&&this.props.fieldContext.targets.length>1},t.prototype.gatherLookupTargets=function(){var e;return this.props.fieldContext&&this.props.entityContext&&(0,h.isUniqueIdentifier)(this.props.fieldContext)?e=[this.props.entityContext.name.toLowerCase()]:this.props.fieldContext&&this.props.fieldContext.targets?e=this.props.fieldContext.targets:(console.error("Some permutation of fieldContext and entityContext were expected to be provided."),e=[]),e},t.prototype.processLookupRecords=function(e,t,n,i){return e=this.processPolymorphicLookupRecords(t,e,n),i&&this.setState({cachedResults:this.state.cachedResults.set(i,e)}),e},t.prototype.processPolymorphicLookupRecords=function(e,t,n){return e&&(t=t.map((function(e){var t=n.get(e.entityLogicalName);return(0,i.pi)((0,i.pi)({},e),{entityDisplayName:t?t.displayName:e.entityLogicalName})}))),t},t}(a.PureComponent)},13958:function(e,t,n){"use strict";n.d(t,{Q:function(){return c}});var i=n(49037),r=n(63804),o=n(85234),a=n(54504),s=n(82699),l=n(67428),c=function(e){function t(t){var n=e.call(this,t)||this;return n.wrapperDivClass="textFieldWrapper",n.getStyles=function(){var e={fieldGroup:{minHeight:"auto",height:"42px",borderRadius:"2px",border:"2px solid #2266E3 !important",cursor:n.state.isEditMode||n.props.hasError?"text":"default",background:n.state.isEditMode||n.props.saveInProgress?"white !important":"transparent !important"},field:{height:"auto"}};return n.props.hasError?e.fieldGroup=Object.assign({},e.fieldGroup,{color:"rgb(51,51,51)",border:"none !important",":hover":{borderRadius:"2px",border:"2px solid #A80000 !important",background:"white !important"},":focus-within":{borderRadius:"2px",border:"2px solid #A80000 !important",background:"white !important"}}):!n.props.disabled&&n.state.isEditMode||(e.fieldGroup=Object.assign({},e.fieldGroup,{color:"rgb(51,51,51)",backgroundColor:"transparent",border:n.props.saveInProgress?"2px solid #2266E3 !important":"none"}),e.field=Object.assign({},e.field,{background:"white !important",color:"rgb(51,51,51)",cursor:"default"})),n.props.customTextStyles&&(e.field=[n.props.customTextStyles,e.field]),e},n.onBlur=function(e){if(!n.wrapperDiv.current.contains(e.relatedTarget)&&(n.state.isEditMode||n.props.hasError)&&(n.setState({isEditMode:!1}),n.props.onChanged)){var t=n.wrapperDiv.current.querySelector("input");n.props.onChanged(""!==t.value?t.value:null),n.props.value&&t.value==n.props.value.toString()&&!n.props.hasError&&n.textInput.current.setState({uncontrolledValue:n.props.formattedValue})}},n.onDivKeyDown=function(e){n.state.isEditMode||n.props.hasError||e.target.className.indexOf(n.wrapperDivClass)>=0&&13==e.keyCode&&(n.setState({isEditMode:!0}),n.textInput.current.setState({uncontrolledValue:n.props.value||""}))},n.onKeyDown=function(e){(n.state.isEditMode||n.props.hasError)&&(27==e.keyCode?(n.textInput.current.setState({uncontrolledValue:n.props.formattedValue}),n.setState({isEditMode:!1})):13==e.keyCode&&(n.setState({isEditMode:!1}),n.props.onChanged&&(n.props.onChanged(""!==e.target.value?e.target.value:null),n.props.value&&e.target.value==n.props.value.toString()&&!n.props.hasError&&n.textInput.current.setState({uncontrolledValue:n.props.formattedValue}))))},n.state={isEditMode:!1,isDirty:!1,currentValue:void 0},n.textInput=r.createRef(),n.wrapperDiv=r.createRef(),n}return(0,i.ZT)(t,e),t.prototype.componentDidUpdate=function(){!this.state.isEditMode||this.props.saveInProgress||this.props.isSaveSuccessful||this.textInput.current.focus(),this.state.isEditMode||this.props.hasError||this.textInput.current.setState({uncontrolledValue:this.props.formattedValue})},t.prototype.render=function(){return r.createElement("div",{className:this.wrapperDivClass,tabIndex:this.props.disabled?-1:0,ref:this.wrapperDiv,onKeyDown:this.onDivKeyDown.bind(this),onBlur:this.onBlur.bind(this)},r.createElement(a.TextField,{borderless:!0,tabIndex:-1,componentRef:this.textInput,defaultValue:this.props.formattedValue&&null!==this.props.formattedValue?this.props.formattedValue:"",onKeyDown:this.onKeyDown.bind(this),placeholder:this.state.isEditMode?"":"-",ariaLabel:this.props.ariaLabel,readOnly:this.props.disabled||!this.state.isEditMode&&!this.props.hasError,styles:this.getStyles(),spellCheck:!1,title:this.state.isEditMode?void 0:this.props.formattedValue,onRenderSuffix:this.onRenderSuffix.bind(this)}))},t.prototype.onRenderSuffix=function(){if(this.state.isEditMode)return r.createElement("div",null);var e={getToolTipContent:this.props.getToolTipContent,getToolTipProps:this.props.getToolTipProps,toolTipDetails:this.props.toolTipDetails,isEditMode:this.state.isEditMode,disabled:this.props.disabled,onSaveSuccessRender:this.props.onSaveSuccessRender,onSaveInProgressRender:this.props.onSaveInProgressRender,onErrorRender:this.props.onErrorRender,saveInProgress:this.props.saveInProgress,isSaveSuccessful:this.props.isSaveSuccessful,hasError:this.props.hasError,onEditButtonRender:this.getEditButton.bind(this),showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands,openEntity:this.openEntity.bind(this),resources:this.props.resources};return r.createElement(l.ZE,(0,i.pi)({},e))},t.prototype.openEntity=function(){this.props.openEntity&&this.props.entityContext&&this.props.openEntity(this.props.recordId,this.props.entityContext.name,!0)},t.prototype.getEditButton=function(){var e=this,t=this;return r.createElement(s.IconButton,{tabIndex:-1,className:this.props.showQuickActions?"firstColumnEditIcon editIcon":"editIcon",style:{cursor:this.props.disabled||this.props.toolTipDetails!=o.FieldDisabledReason.None?"default":"pointer"},iconProps:{iconName:"Edit"},ariaLabel:this.props.getToolTipContent&&this.props.getToolTipContent(),onClick:function(n){e.props.disabled||e.props.toolTipDetails!=o.FieldDisabledReason.None||(t.setState({isEditMode:!0}),t.textInput.current.setState({uncontrolledValue:t.props.value||""}),n.stopPropagation())}})},t}(r.PureComponent)},68065:function(e,t,n){"use strict";n.d(t,{Y:function(){return u}});var i=n(49037),r=n(63804),o=n(77389),a=n(85234),s=n(52828),l=n(64828),c=n(76276),d=n(67428),u=function(e){function t(t){var n=e.call(this,t)||this;return n.onKeyDown=function(e){n.state.isEditMode||n.props.hasError||e.target.className.indexOf("fieldControlWrapper")>=0&&13==e.keyCode&&n.setState({isEditMode:!0})},n.resolveOptions=function(){var e=[];return n.props.fieldContext&&n.props.fieldContext.optionSet&&(!1===n.props.fieldContext.businessRequired&&e.push({key:-1,text:n.props.resources?n.props.resources.getLocalizedString("OPTIONSET_SELECT"):(0,l.K)("OPTIONSET_SELECT")}),n.props.fieldContext.optionSet.forEach((function(t){t&&e.push({key:t.value,text:t.displayName,disabled:t.disabled})}))),e},n.state={isEditMode:!1},n.comboBoxInput=r.createRef(),n}return(0,i.ZT)(t,e),t.prototype.componentDidUpdate=function(){!this.state.isEditMode||this.props.saveInProgress||this.props.hasError||this.comboBoxInput&&this.comboBoxInput.current&&this.comboBoxInput.current.focus(!0)},t.prototype.render=function(){var e=this;return r.createElement(d.$L,{style:this.getDivStyles(),isEditMode:this.state.isEditMode,disabled:this.props.disabled,onSaveSuccessRender:this.props.onSaveSuccessRender,onSaveInProgressRender:this.props.onSaveInProgressRender,onErrorRender:this.props.onErrorRender,saveInProgress:this.props.saveInProgress,isSaveSuccessful:this.props.isSaveSuccessful,hasError:this.props.hasError,getToolTipContent:this.props.getToolTipContent,getToolTipProps:this.props.getToolTipProps,toolTipDetails:this.props.toolTipDetails,onEditButtonRender:function(){return r.createElement(s.IconButton,{tabIndex:-1,className:e.props.showQuickActions?"firstColumnEditIcon editIcon":"editIcon",style:{cursor:e.props.disabled||e.props.toolTipDetails!=a.FieldDisabledReason.None?"default":"pointer"},iconProps:{iconName:"ChevronDown"},ariaLabel:e.props.getToolTipContent&&e.props.getToolTipContent(),onClick:function(t){e.props.disabled||e.props.toolTipDetails!=a.FieldDisabledReason.None||(e.setState({isEditMode:!0}),t.stopPropagation())}})},showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands,onKeyDown:this.onKeyDown.bind(this),openEntity:this.openEntity.bind(this),resources:this.props.resources,content:r.createElement(r.Fragment,null,r.createElement(o.ComboBox,{options:this.resolveOptions(),tabIndex:-1,componentRef:this.comboBoxInput,selectedKey:this.props.value,autoComplete:"on",onChange:this.onChange.bind(this),disabled:this.props.disabled||!this.state.isEditMode,useComboBoxAsMenuWidth:!0,calloutProps:{className:"optionSetCallout"},caretDownButtonStyles:this.getButtonStyles(),ariaLabel:this.props.ariaLabel,text:null===this.props.value||void 0===this.props.value?"-":void 0,onMenuDismissed:this.onMenuDismissed.bind(this),title:this.props.formattedValue}),this.state.isEditMode&&r.createElement("div",{style:this.getChevronStyles(),onClick:function(){e.comboBoxInput&&e.comboBoxInput.current&&e.comboBoxInput.current.focus(!0)}},r.createElement(c.Icon,{className:"chevronDownIcon",iconName:"ChevronDown"})))})},t.prototype.openEntity=function(){this.props.openEntity&&this.props.entityContext&&this.props.openEntity(this.props.recordId,this.props.entityContext.name,!0)},t.prototype.getDivStyles=function(){var e={display:"flex",border:"none",height:"42px",width:"auto !important",borderRadius:"2px",background:this.state.isEditMode||this.props.saveInProgress||this.props.hasError?"white":"transparent"};return this.state.isEditMode||this.props.saveInProgress?Object.assign({},e,{border:"2px solid #2266E3",height:"38px"}):this.props.hasError?Object.assign({},e,{border:"2px solid #A80000",height:"38px"}):e},t.prototype.getChevronStyles=function(){return{width:"32px",height:"100%",alignItems:"center",justifyContent:"center",display:"inline-flex",background:"white"}},t.prototype.getButtonStyles=function(){var e={icon:{display:"none"}};return e.root={backgroundColor:"white !important",background:"white !important",height:this.state.isEditMode?"38px":"42px"},e},t.prototype.onChange=function(e,t){if(t&&this.props.onChanged){var n=t.key;this.props.onChanged(-1!==n?n:null)}},t.prototype.onMenuDismissed=function(){this.setState({isEditMode:!1})},t}(r.PureComponent)},19709:function(e,t,n){"use strict";n.d(t,{R:function(){return s}});var i=n(49037),r=n(63804),o=n(54504),a=n(67428),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getStyles=function(){var e={};return t.props.disabled&&(e.fieldGroup=Object.assign({},e.fieldGroup,{background:"none"}),e.field=Object.assign({},e.field,{background:"white !important",color:"rgb(51,51,51)"})),t.props.customTextStyles&&(e.field=[t.props.customTextStyles,e.field]),e},t}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.TextField,{value:this.props.formattedValue,readOnly:!0,ariaLabel:this.props.ariaLabel,title:this.props.formattedValue,disabled:this.props.disabled,borderless:!0,styles:this.getStyles.bind(this),spellCheck:!1,onRenderSuffix:this.onRenderSuffix.bind(this)})},t.prototype.onRenderSuffix=function(){var e={showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands,openEntity:this.openEntity.bind(this),resources:this.props.resources};return r.createElement(a.ZE,(0,i.pi)({},e))},t.prototype.openEntity=function(){this.props.openEntity&&this.props.entityContext&&this.props.openEntity(this.props.recordId,this.props.entityContext.name,!0)},t.getLockIconProps=function(e,t){var n={iconName:"LockSolid",className:"lockIcon",styles:{root:Object.assign({},e||{})}};return t&&(n.styles.root.padding=0),n.styles.root.fontWeight=400,n.styles.root.color="#605E5C",n},t}(r.PureComponent)},91298:function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var i=function(){function e(){}return e.ActivityTypeCode="activitytypecode",e.ActivityPointer="activitypointer",e}()},5024:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var i=function(){function e(){}return e.ODataBaseUri="api/data/v9.1",e.ODataEtag="@odata.etag",e.ODataContext="@odata.context",e.ODataPagingCookie="@Microsoft.Dynamics.CRM.fetchxmlpagingcookie",e.ODataMoreRecords="@Microsoft.Dynamics.CRM.morerecords",e.TotalRecordCount="@Microsoft.Dynamics.CRM.totalrecordcount",e.TotalRecordLimitExceeded="@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded",e.ODataValue="value",e.ODataEntityIdHeader="OData-EntityId",e.ODataEntityLogicalName="@Microsoft.Dynamics.CRM.lookuplogicalname",e.ODataFormattedValue="@OData.Community.Display.V1.FormattedValue",e.AggregateQueryRecordLimitExceededError="0x8004e023",e.AggregateQueryRecordLimit=5e4,e}()},55562:function(e,t,n){"use strict";n.r(t),n.d(t,{AttributeValueComparator:function(){return o}});var i=n(29758),r=n(15220),o=function(){function e(){}return e.prototype.areEqual=function(e,t,n){r.Validations.validateNullArgument(e,"fieldMetadata");var o=!1;if(this.isNullOrUndefined(t)||this.isNullOrUndefined(n))o=this.isNullOrUndefined(t)&&this.isNullOrUndefined(n);else switch(e.dataType){case i.EDataType.Date:o=t.getTime()===n.getTime();break;case i.EDataType.Lookup:case i.EDataType.Owner:case i.EDataType.Customer:o=t.entityLogicalName===n.entityLogicalName&&t.id===n.id;break;default:o=t===n}return o},e.prototype.isNullOrUndefined=function(e){return null==e},e}()},24694:function(e,t,n){"use strict";n.r(t),n.d(t,{AttributeValueFormatter:function(){return o}});var i=n(29758),r=n(15220),o=function(){function e(e){this.formatting=e}return e.prototype.getFormattedValue=function(e,t,n,o){r.Validations.validateNullArgument(t,"fieldMetadata"),r.Validations.validateNullArgument(n,"entityMetadata");var a="",s=NaN;if(null!=e)switch(t.dataType){case i.EDataType.WholeNumber:s=Number(e),a=isNaN(s)||!isFinite(s)?e:""===e?"":this.formatting.formatInteger(s);break;case i.EDataType.Float:case i.EDataType.Decimal:s=Number(e),a=isNaN(s)||!isFinite(s)?e:""===e?"":this.formatting.formatDecimal(s,t.precision);break;case i.EDataType.Date:a=this.formatting.formatDateShort(e);break;case i.EDataType.OptionSet:case i.EDataType.TwoOptions:a=this.getOptionSetFormattedValue(e,t);break;case i.EDataType.Lookup:case i.EDataType.Customer:case i.EDataType.Owner:a=e.displayName;break;case i.EDataType.Currency:if(s=Number(e),isNaN(s)||!isFinite(s))a=e;else{var l=o?o.currencySymbol:void 0,c=this.getCurrencyPrecision(t,o);a=""===e?"":this.formatting.formatCurrency(s,c,l)}break;default:a=e}return a},e.prototype.processAttributeValue=function(e,t,n,o){r.Validations.validateNullArgument(t,"fieldMetadata"),r.Validations.validateNullArgument(n,"entityMetadata");var a=e;if(null!=e)switch(t.dataType){case i.EDataType.WholeNumber:a=""===e?null:Math.round(Number(e));break;case i.EDataType.Float:case i.EDataType.Decimal:a=""===e?null:Number(Number(e).toFixed(t.precision));break;case i.EDataType.Currency:var s=this.getCurrencyPrecision(t,o);a=""===e?null:Number(Number(e).toFixed(s))}return a},e.prototype.getOptionSetFormattedValue=function(e,t){var n="";if(t.optionSet)for(var i=0;i<t.optionSet.length;i++){var r=t.optionSet[i];if(r&&r.value===e){n=r.displayName;break}}return n},e.prototype.getCurrencyPrecision=function(e,t){return e.precisionSource===i.MoneyPrecisionSource.currency&&t?t.currencyPrecision:e.precision},e.MillisecondsInMinute=6e4,e}()},90065:function(e,t,n){"use strict";n.r(t),n.d(t,{AttributeValueValidator:function(){return a}});var i=n(29758),r=n(15220),o=n(84718),a=function(){function e(e){this.resources=e}return e.prototype.validateValue=function(e,t,n){var a;r.Validations.validateNullArgument(t,"fieldMetadata"),r.Validations.validateNullArgument(n,"entityMetadata");var s=!0,l=null;if(null==e)l=(s=!t.businessRequired)?null:this.resources.getLocalizedString("ATTRIBUTE_BUSINESS_REQUIRED");else if(s=(a=this.validateType(e,t))[0],l=a[1],s)switch(t.dataType){case i.EDataType.String:case i.EDataType.MultilineText:var c=e.length;t.maxLength&&c>t.maxLength&&(s=!1,l=o.StringUtil.format(this.resources.getLocalizedString("ATTRIBUTE_MAXIMUM_LENGTH_EXCEEDED"),t.maxLength));break;case i.EDataType.Float:case i.EDataType.Decimal:case i.EDataType.WholeNumber:case i.EDataType.Currency:(isNaN(e)||null!=t.minValue&&e<t.minValue||t.maxValue&&e>t.maxValue)&&(s=!1,l=o.StringUtil.format(this.resources.getLocalizedString("ATTRIBUTE_VALUE_OUT_OF_RANGE"),t.minValue,t.maxValue))}return[s,l]},e.prototype.validateType=function(e,t){var n=!0;switch(t.dataType){case i.EDataType.String:case i.EDataType.MultilineText:n="string"==typeof e;break;case i.EDataType.Date:n=e instanceof Date;break;case i.EDataType.Lookup:case i.EDataType.Customer:case i.EDataType.Owner:n="id"in e&&"displayName"in e&&"entityLogicalName"in e&&"string"==typeof e.id&&"string"==typeof e.displayName&&"string"==typeof e.entityLogicalName;break;case i.EDataType.WholeNumber:case i.EDataType.OptionSet:case i.EDataType.Currency:case i.EDataType.Float:case i.EDataType.Decimal:n="number"==typeof e;break;case i.EDataType.TwoOptions:n="boolean"==typeof e}return[n,n?null:this.resources.getLocalizedString("INVALID_DATA_TYPE")]},e}()},49339:function(e,t,n){"use strict";n.r(t),n.d(t,{DataSetRecordProvider:function(){return c},DataSetRecordContainer:function(){return d}});var i=n(49037),r=n(15220),o=n(72429),a=n(37944),s=n(91298),l=n(56393),c=function(){function e(e,t,n,i,r,o){this.attributeValueFormatter=e,this.attributeValueValidator=t,this.attributeValueComparator=n,this.cdsDataClient=i,this.transactionCurrencyProvider=r,this.telemetryLogger=o}return e.prototype.buildDataSetRecord=function(e,t,n,i){r.Validations.validateNullArgument(e,"entityMetadata"),r.Validations.validateNullArgument(t,"attributesMetadata"),r.Validations.validateNullArgument(n,"entityRecord"),r.Validations.validateNullArgument(i,"onDataSetRecordUpdated");var o=new d,a={recordId:n.recordId,isDirty:!1,isRecordValid:!0,isRecordActive:this.getIsRecordActive(e,n),isValid:this.getAllValid(n),notifications:new Map,values:new Map(n.values),formattedValues:new Map(n.formattedValues),isReadOnly:this.getIsReadOnly(t),dirtyAttributes:new Map,attributesLastSaved:new Map,setValue:function(){},save:function(){},refresh:function(){}};return o.dataSetRecord=a,a.setValue=this.buildSetValueHandler(e,t,o,i),a.save=this.buildSaveHandler(e,t,o,i),a.refresh=this.buildRefreshHandler(e,t,o,i),this.setTransactionCurrency(o),a},e.prototype.cloneDataSetRecord=function(e,t,n,o){r.Validations.validateNullArgument(n,"inputDataSetRecord"),r.Validations.validateNullArgument(o,"onDataSetRecordUpdated");var a=new d,s=(0,i.pi)({},n);return a.dataSetRecord=s,s.setValue=this.buildSetValueHandler(e,t,a,o),s.save=this.buildSaveHandler(e,t,a,o),s.refresh=this.buildRefreshHandler(e,t,a,o),this.setTransactionCurrency(a),s},e.prototype.buildSetValueHandler=function(e,t,n,o){var s=this;return function(l,c){r.Validations.validateStringArgument(l,"attributeName");var d=t.get(l);if(void 0===d)throw new Error("Invalid attribute name");var u=s.attributeValueFormatter.processAttributeValue(c,d,e,n.transactionCurrency),p=n.dataSetRecord.values.get(l),m=n.dataSetRecord.formattedValues.get(l);if(!s.attributeValueComparator.areEqual(d,p,u)){var h=s.attributeValueFormatter.getFormattedValue(c,d,e,n.transactionCurrency),g=(0,i.pi)({},n.dataSetRecord);n.dataSetRecord=g,g.isDirty=!0,g.dirtyAttributes.has(l)||g.dirtyAttributes.set(l,{prevValue:p,prevFormattedValue:m}),g.values=new Map(g.values),g.formattedValues=new Map(g.formattedValues),g.formattedValues.set(l,h);var f=s.attributeValueValidator.validateValue(u,d,e),y=f[0],v=f[1];g.isValid.set(l,y),y?(g.values.set(l,u),g.notifications.delete(l)):(g.values.set(l,c),g.notifications.set(l,v||"")),g.isRecordValid=!0,g.isValid.forEach((function(e){!1===e&&(g.isRecordValid=!1)}));var C=new Map;C.set("attributeName",l),C.set("isUpdateValid",g.isRecordValid.toString()),s.telemetryLogger.reportInfo("DataSetRecordProvider","setValueHandler",l,"DataSetRecordProvider.buildSetValueHandler",C),s.fireDataSetRecordUpdatedEvent(o,g,a._.RecordUpdated)}}},e.prototype.buildSaveHandler=function(e,t,n,r){var o=this;return function(){if(!0===n.dataSetRecord.isDirty&&!0===n.dataSetRecord.isRecordValid&&!0===n.dataSetRecord.isRecordActive&&(!1===n.dataSetRecord.isSaveInProgress||void 0===n.dataSetRecord.isSaveInProgress)){var s=(0,i.pi)({},n.dataSetRecord);n.dataSetRecord=s,s.isSaveInProgress=!0,o.saveRecord(e,t,n,r),o.fireDataSetRecordUpdatedEvent(r,s,a._.SavingRecord)}}},e.prototype.saveRecord=function(e,t,n,r){return(0,i.mG)(this,void 0,void 0,(function(){var c,d,u,p,m,h,g,f;return(0,i.Jh)(this,(function(y){switch(y.label){case 0:return y.trys.push([0,3,,4]),c=n.dataSetRecord,d=new Map,c.dirtyAttributes.forEach((function(e,t){var n=c.values.get(t);d.set(t,n)})),u=l.$.IsActivityPointer(e.name)?c.values.get(s.m.ActivityTypeCode):e.name,[4,this.cdsDataClient.updateRecord(u,c.recordId,d)];case 1:return y.sent(),[4,this.cdsDataClient.retrieveRecord(u,c.recordId,Array.from(t.keys()).filter((function(e){return!o.DataSetUtils.isLinkedEntityAttribute(e)})))];case 2:return p=y.sent(),m=n.dataSetRecord,h=(0,i.pi)({},m),n.dataSetRecord=h,h.values=new Map(p.values),h.formattedValues=new Map(p.formattedValues),h.errorMessage=void 0,h.isDirty=!1,h.dirtyAttributes=new Map,h.attributesLastSaved=this.getAttributesLastSaved(t,p.values,m.values,m.dirtyAttributes,m.formattedValues),h.isSaveInProgress=!1,h.isRecordActive=this.getIsRecordActive(e,h),h.isReadOnly=this.getIsReadOnly(t),Array.from(t.keys()).map((function(e){o.DataSetUtils.isLinkedEntityAttribute(e)&&(h.values.set(e,m.values.get(e)),void 0!==m.formattedValues.get(e)&&h.formattedValues.set(e,m.formattedValues.get(e)))})),this.fireDataSetRecordUpdatedEvent(r,h,a._.RecordSaved),[3,4];case 3:return g=y.sent(),f=(0,i.pi)({},n.dataSetRecord),n.dataSetRecord=f,f.errorMessage=g&&g.message?g.message:"Unexpected error",f.isSaveInProgress=!1,this.fireDataSetRecordUpdatedEvent(r,f,a._.RecordSaveFailed),[3,4];case 4:return[2]}}))}))},e.prototype.buildRefreshHandler=function(e,t,n,i){var r=this;return function(){r.refreshRecord(e,t,n,i)}},e.prototype.refreshRecord=function(e,t,n,r){var s;return(0,i.mG)(this,void 0,void 0,(function(){var l,c,d;return(0,i.Jh)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.cdsDataClient.retrieveRecord(e.name,(null===(s=null==n?void 0:n.dataSetRecord)||void 0===s?void 0:s.recordId)||"",Array.from(t.keys()).filter((function(e){return!o.DataSetUtils.isLinkedEntityAttribute(e)})))];case 1:return l=u.sent(),d=(0,i.pi)({},n.dataSetRecord),n.dataSetRecord=d,d.values=new Map(l.values),d.formattedValues=new Map(l.formattedValues),d.errorMessage=void 0,d.isDirty=!1,d.dirtyAttributes=new Map,d.isRecordActive=this.getIsRecordActive(e,d),d.isReadOnly=this.getIsReadOnly(t),this.fireDataSetRecordUpdatedEvent(r,d,a._.RecordRefreshed),[3,3];case 2:return c=u.sent(),d=(0,i.pi)({},n.dataSetRecord),n.dataSetRecord=d,d.errorMessage=c&&c.message?c.message:"Unexpected error",this.fireDataSetRecordUpdatedEvent(r,d,a._.RecordRefreshFailed),[3,3];case 3:return[2]}}))}))},e.prototype.getIsRecordActive=function(e,t){var n=o.DataSetUtils.getStateCodeAttributeNameFromEntity(e.name),i=t.values.get(n),r=o.DataSetUtils.getHardcodedInactiveStatus(e.name,i,e.isActivity);return void 0===r?0===i:!r},e.prototype.getAllValid=function(e){var t=new Map;return e.values.forEach((function(e,n){t.set(n,!0)})),t},e.prototype.getIsReadOnly=function(e){var t=new Map;return e.forEach((function(e,n){t.set(n,!e.validForUpdate)})),t},e.prototype.getAttributesLastSaved=function(e,t,n,i,r){var a=this,s=new Map(i);return e.forEach((function(e,i){if(!s.has(i)&&!o.DataSetUtils.isLinkedEntityAttribute(i)){var l=t.get(i),c=n.get(i),d=r.get(i);a.attributeValueComparator.areEqual(e,c,l)||s.set(i,{prevValue:c,prevFormattedValue:d})}})),s},e.prototype.setTransactionCurrency=function(e){return(0,i.mG)(this,void 0,void 0,(function(){var t,n,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return(t=e.dataSetRecord)&&(n=t.values.get("transactioncurrencyid"))&&n.id?(r=e,[4,this.transactionCurrencyProvider.getTransactionCurrency(n.id)]):[3,2];case 1:r.transactionCurrency=i.sent(),i.label=2;case 2:return[2]}}))}))},e.prototype.fireDataSetRecordUpdatedEvent=function(e,t,n){e({dataSetRecord:t,updateType:n})},e}(),d=function(){this.dataSetRecord={}}},72429:function(e,t,n){"use strict";n.r(t),n.d(t,{DataSetUtils:function(){return i}});var i=function(){function e(){}return e.getHardcodedInactiveStatus=function(e,t,n){switch(e){case"activitypointer":case"appointment":case"recurringappointmentmaster":return!(0===t||3===t);case"product":return 1===t;case"productassociation":return!(2===t);case"dynamicproperty":return 0===t||2===t;case"serviceappointment":return!(0===t||3===t);case"advancedsimilarityrule":return 0===t;default:if(n)return!(0===t||3===t)}},e.getStateCodeAttributeNameFromEntity=function(e){switch(e){case"opportunityproduct":return"opportunitystatecode";case"quotedetail":return"quotestatecode";case"salesorderdetail":return"salesorderstatecode";case"invoicedetail":return"invoicestatecode";default:return"statecode"}},e.isLinkedEntityAttribute=function(e){return null!=e&&-1!==e.indexOf(".")},e}()},26781:function(e,t,n){"use strict";n.d(t,{o:function(){return a}});var i=n(49037),r=n(63804),o=n(43891),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.z,(0,i.pi)({},this.props))},t}(r.PureComponent)},20307:function(e,t,n){"use strict";n.r(t),n.d(t,{FieldControlsFactory:function(){return C}});var i=n(29758),r=n(26781),o=n(60463),a=n(37830),s=n(71548),l=n(79506),c=n(36062),d=n(43311),u=n(39608),p=n(68212),m=n(26255),h=n(29801),g=n(82215),f=n(40365),y=n(19709),v=n(96202),C=function(){function e(){}return e.prototype.getValueControl=function(e){return e===i.EDataType.Date?r.o:e===i.EDataType.WholeNumber?u.b:e===i.EDataType.Decimal?c.t:e===i.EDataType.Float?d.b:e===i.EDataType.Currency?l.F:e===i.EDataType.Customer?o.O:e===i.EDataType.Lookup?a.t:e===i.EDataType.Owner?s.F:e===i.EDataType.OptionSet?p.W:e===i.EDataType.TwoOptions?g.o:e===i.EDataType.State?m.Z:e===i.EDataType.Status?h.q:e===i.EDataType.String?f.b:e===i.EDataType.MultilineText?v.U:y.R},e}()},16312:function(e,t,n){"use strict";n.d(t,{u:function(){return o}});var i=n(49037),r=n(63804);function o(e){var t=this,n=r.useState(!1),o=n[0],a=n[1],s=r.useState(null),l=s[0],c=s[1],d=r.useState(null),u=d[0],p=d[1];return[{loading:o,data:l,error:u},function(){return(0,i.mG)(t,void 0,void 0,(function(){var t,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,4,5,6]),a(!0),c(null),p(null),e?[4,e()]:[3,2];case 1:return t=i.sent(),[3,3];case 2:t=null,i.label=3;case 3:return c(t),[3,6];case 4:return n=i.sent(),p(n),[3,6];case 5:return a(!1),[7];case 6:return[2]}}))}))}]}},72964:function(e,t,n){"use strict";n.r(t),n.d(t,{AggregateResponse:function(){return r}});var i=n(49037),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t}(n(56352).Z)},38849:function(e,t,n){"use strict";n.d(t,{I:function(){return r}});var i=n(49037),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t}(n(56352).Z)},56352:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var i=function(){}},69181:function(e,t,n){"use strict";n.d(t,{T:function(){return i}});var i=function(){this.recordId="",this.values={},this.formattedValues={}}},94847:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}});var i=n(49037),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t}(n(56352).Z)},37944:function(e,t,n){"use strict";var i;n.d(t,{_:function(){return i}}),function(e){e[e.Undefined=0]="Undefined",e[e.RecordUpdated=1]="RecordUpdated",e[e.SavingRecord=2]="SavingRecord",e[e.RecordSaved=3]="RecordSaved",e[e.RecordSaveFailed=4]="RecordSaveFailed",e[e.RefreshingRecord=5]="RefreshingRecord",e[e.RecordRefreshed=6]="RecordRefreshed",e[e.RecordRefreshFailed=7]="RecordRefreshFailed"}(i||(i={}))},85234:function(e,t,n){"use strict";var i;n.r(t),n.d(t,{FieldDisabledReason:function(){return i}}),function(e){e[e.None=0]="None",e[e.ErrorInOtherField=1]="ErrorInOtherField",e[e.ClosedOpportunity=2]="ClosedOpportunity",e[e.LinkedField=3]="LinkedField"}(i||(i={}))},29758:function(e,t,n){"use strict";var i,r,o,a;function s(e){return e.dataType===i.Lookup}function l(e){return e.dataType===i.Owner}function c(e){return e.dataType===i.UniqueIdentifier}function d(e,t){return!!e.targets&&e.targets.indexOf(t.toLowerCase())>=0}function u(e){return e.lookupRelationship&&e.lookupRelationship.isHierarchical}n.r(t),n.d(t,{EDataType:function(){return i},DateTimeFieldBehavior:function(){return r},MoneyPrecisionSource:function(){return o},AttributeSourceType:function(){return a},isLookup:function(){return s},isOwner:function(){return l},isUniqueIdentifier:function(){return c},doesLookupTarget:function(){return d},doesLookupSupportHierarchy:function(){return u}}),function(e){e.Unknown="Unknown",e.String="String",e.MultilineText="Memo",e.WholeNumber="Integer",e.Date="DateTime",e.OptionSet="Picklist",e.MultiOptionSet="MultiSelectPicklistType",e.TwoOptions="Boolean",e.Lookup="Lookup",e.Customer="Customer",e.Owner="Owner",e.Currency="Money",e.Float="Double",e.Decimal="Decimal",e.UniqueIdentifier="UniqueIdentifier",e.State="State",e.Status="Status"}(i||(i={})),function(e){e[e.None=0]="None",e[e.UserLocal=1]="UserLocal",e[e.DateOnly=2]="DateOnly",e[e.TimeZoneIndependent=3]="TimeZoneIndependent"}(r||(r={})),function(e){e[e.attribute=0]="attribute",e[e.organization=1]="organization",e[e.currency=2]="currency"}(o||(o={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Persistent=0]="Persistent",e[e.Calculated=1]="Calculated",e[e.Rollup=2]="Rollup"}(a||(a={}))},24590:function(e,t,n){"use strict";var i;n.d(t,{n:function(){return i}}),function(e){e.OneToMany="OneToManyRelationship",e.ManyToOne="ManyToOneRelationship",e.ManyToMany="ManyToManyRelationship"}(i||(i={}))},60463:function(e,t,n){"use strict";n.d(t,{O:function(){return a}});var i=n(49037),r=n(63804),o=n(91500),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChanged=function(e){t.props.onChanged&&t.props.onChanged(Array.isArray(e)&&0===e.length?null:e)},t}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.F,{value:null!==this.props.value?this.props.value:[],formattedValue:this.props.formattedValue,resolver:this.props.resolver,onChanged:this.onChanged.bind(this),disabled:this.props.disabled,ariaLabel:this.props.ariaLabel,entityContext:this.props.entityContext,fieldContext:this.props.fieldContext,singleSelect:!0,resources:this.props.resources,hasError:this.props.hasError,timezoneService:this.props.timezoneService,entityRecordContext:this.props.entityRecordContext,customTextStyles:this.props.customTextStyles,openEntity:this.props.openEntity,additionalPersonaProps:this.props.additionalPersonaProps,recordId:this.props.recordId,isSaveSuccessful:this.props.isSaveSuccessful,saveInProgress:this.props.saveInProgress,onErrorRender:this.props.onErrorRender,onSaveInProgressRender:this.props.onSaveInProgressRender,onSaveSuccessRender:this.props.onSaveSuccessRender,getToolTipContent:this.props.getToolTipContent,getToolTipProps:this.props.getToolTipProps,toolTipDetails:this.props.toolTipDetails,showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands})},t}(r.Component)},37830:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var i=n(49037),r=n(63804),o=n(91500),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChanged=function(e){t.props.onChanged&&t.props.onChanged(Array.isArray(e)&&0===e.length?null:e)},t}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.F,{value:null!==this.props.value?this.props.value:[],formattedValue:this.props.formattedValue,resolver:this.props.resolver,onChanged:this.onChanged.bind(this),disabled:this.props.disabled,ariaLabel:this.props.ariaLabel,entityContext:this.props.entityContext,fieldContext:this.props.fieldContext,singleSelect:!0,resources:this.props.resources,hasError:this.props.hasError,timezoneService:this.props.timezoneService,entityRecordContext:this.props.entityRecordContext,customTextStyles:this.props.customTextStyles,openEntity:this.props.openEntity,additionalPersonaProps:this.props.additionalPersonaProps,recordId:this.props.recordId,isSaveSuccessful:this.props.isSaveSuccessful,saveInProgress:this.props.saveInProgress,onErrorRender:this.props.onErrorRender,onSaveInProgressRender:this.props.onSaveInProgressRender,onSaveSuccessRender:this.props.onSaveSuccessRender,getToolTipContent:this.props.getToolTipContent,getToolTipProps:this.props.getToolTipProps,toolTipDetails:this.props.toolTipDetails,showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands})},t}(r.Component)},71548:function(e,t,n){"use strict";n.d(t,{F:function(){return a}});var i=n(49037),r=n(63804),o=n(91500),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChanged=function(e){t.props.onChanged&&t.props.onChanged(Array.isArray(e)&&0===e.length?null:e)},t}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.F,{value:null!==this.props.value?this.props.value:[],formattedValue:this.props.formattedValue,resolver:this.props.resolver,onChanged:this.onChanged.bind(this),disabled:this.props.disabled,ariaLabel:this.props.ariaLabel,entityContext:this.props.entityContext,fieldContext:this.props.fieldContext,singleSelect:!0,resources:this.props.resources,hasError:this.props.hasError,timezoneService:this.props.timezoneService,entityRecordContext:this.props.entityRecordContext,customTextStyles:this.props.customTextStyles,openEntity:this.props.openEntity,additionalPersonaProps:this.props.additionalPersonaProps,recordId:this.props.recordId,isSaveSuccessful:this.props.isSaveSuccessful,saveInProgress:this.props.saveInProgress,onErrorRender:this.props.onErrorRender,onSaveInProgressRender:this.props.onSaveInProgressRender,onSaveSuccessRender:this.props.onSaveSuccessRender,getToolTipContent:this.props.getToolTipContent,getToolTipProps:this.props.getToolTipProps,toolTipDetails:this.props.toolTipDetails,showQuickActions:this.props.showQuickActions,createCommands:this.props.createCommands})},t}(r.Component)},79506:function(e,t,n){"use strict";n.d(t,{F:function(){return a}});var i=n(49037),r=n(13958),o=n(63804),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return o.createElement(r.Q,(0,i.pi)({},this.props))},t}(o.PureComponent)},36062:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var i=n(49037),r=n(63804),o=n(13958),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.Q,(0,i.pi)({},this.props))},t}(r.PureComponent)},43311:function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var i=n(49037),r=n(63804),o=n(13958),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.Q,(0,i.pi)({},this.props))},t}(r.PureComponent)},39608:function(e,t,n){"use strict";n.d(t,{b:function(){return s}});var i=n(49037),r=n(63804),o=n(13958),a=n(19709),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this.props.fieldContext&&"0"===this.props.fieldContext.format?o.Q:a.R;return r.createElement(e,(0,i.pi)({},this.props))},t}(r.PureComponent)},68212:function(e,t,n){"use strict";n.d(t,{W:function(){return a}});var i=n(49037),r=n(63804),o=n(68065),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.Y,(0,i.pi)({},this.props))},t}(r.Component)},26255:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(49037),r=n(63804),o=n(19709),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.R,(0,i.pi)({},this.props,{disabled:!0}))},t}(r.Component)},29801:function(e,t,n){"use strict";n.d(t,{q:function(){return a}});var i=n(49037),r=n(63804),o=n(19709),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.R,(0,i.pi)({},this.props,{disabled:!0}))},t}(r.Component)},82215:function(e,t,n){"use strict";n.d(t,{o:function(){return a}});var i=n(49037),r=n(63804),o=n(68065),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.Y,(0,i.pi)({},this.props,{onChanged:this.onChanged.bind(this),value:this.getNumberValue(this.props.value)}))},t.prototype.onChanged=function(e){this.props.onChanged&&this.props.onChanged(this.getBooleanValue(e))},t.prototype.getNumberValue=function(e){return null!=e?!0===e?1:0:e},t.prototype.getBooleanValue=function(e){return null!=e?1===e:null},t}(r.Component)},96202:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});var i=n(49037),r=n(63804),o=n(57512),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.w,(0,i.pi)({},this.props,{multiline:!0}))},t}(r.Component)},40365:function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var i=n(49037),r=n(63804),o=n(57512),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.w,(0,i.pi)({},this.props))},t}(r.Component)},5201:function(e,t,n){"use strict";n.r(t),n.d(t,{TelemetryLogger:function(){return i}});var i=function(){function e(e,t,n){this.telemetryLogger=e,this.sessionId=t,this.hostIdentifier=n}return e.prototype.reportFailure=function(e,t,n,i,r,o,a,s){var l=[{name:"SessionId",value:this.sessionId},{name:"Source",value:e},{name:"Action",value:t},{name:"ActionOn",value:n},{name:"MethodName",value:i},{name:"Message",value:r}];o&&o.size>0&&o.forEach((function(e,t){l.push({name:t,value:e})})),this.telemetryLogger.reportFailure(this.hostIdentifier,a,s,l)},e.prototype.reportInfo=function(e,t,n,i,r){var o=[{name:"SessionId",value:this.sessionId},{name:"Source",value:e},{name:"Action",value:t},{name:"ActionOn",value:n},{name:"MethodName",value:i}];r&&r.size>0&&r.forEach((function(e,t){o.push({name:t,value:e})})),this.telemetryLogger.reportSuccess(this.hostIdentifier,o)},e}()},56393:function(e,t,n){"use strict";n.d(t,{$:function(){return r}});var i=n(91298),r=function(){function e(){}return e.IsActivityPointer=function(e){return e===i.m.ActivityPointer},e}()},76823:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var i=function(){function e(){this.EntityIconSymbolMapping={account:"crmSymbolFont entity-symbol Account",activitypointer:"crmSymbolFont entity-symbol Activitypointer",appointment:"crmSymbolFont entity-symbol Appointment",article:"symbolFont Article-symbol",businessunit:"crmSymbolFont entity-symbol BusinessUnit",campaign:"crmSymbolFont entity-symbol Campaign",campaignactivity:"crmSymbolFont entity-symbol Campaign Activity",campaignresolution:"symbolFont CampaignResolution-symbol",case:"symbolFont Case-symbol",caseresolution:"symbolFont CaseResolution-symbol",chat:"symbolFont Chat-symbol",competitor:"crmSymbolFont entity-symbol Competitor",connection:"crmSymbolFont entity-symbol Connection",contact:"crmSymbolFont entity-symbol Contact",contract:"crmSymbolFont entity-symbol Contract",createquote:"symbolFont CreateQuote-symbol",customactivity:"symbolFont CustomActivity-symbol",customeraddress:"crmSymbolFont entity-symbol CustomerAddress",dashboard:"crmSymbolFont entity-symbol Dashboard",distributionList:"crmSymbolFont entity-symbol symbolFont DistributionList-symbol",documenttemplates:"symbolFont DocumentTemplates-symbol",email:"crmSymbolFont entity-symbol Email",externalUser:"symbolFont GuestUser-symbol",fax:"crmSymbolFont entity-symbol Fax",goal:"crmSymbolFont entity-symbol Goal",guestUser:"symbolFont GuestUser-symbol",incident:"crmSymbolFont entity-symbol Incident",invoice:"crmSymbolFont entity-symbol Invoice",knowledgearticle:"crmSymbolFont entity-symbol Knowledgearticle",lead:"crmSymbolFont entity-symbol Lead",letter:"crmSymbolFont entity-symbol Letter",mail:"symbolFont Mail-symbol",membersicon:"symbolFont MembersIcon-symbol",metric:"crmSymbolFont entity-symbol Metric",opportunity:"crmSymbolFont entity-symbol Opportunity",opportunityproduct:"Opportunityproduct",phone:"symbolFont Phone-symbol",phonecall:"crmSymbolFont entity-symbol Phonecall",position:"crmSymbolFont entity-symbol Position",product:"crmSymbolFont entity-symbol Product",queueicon:"symbolFont QueueIcon-symbol",queueitem:"crmSymbolFont entity-symbol Queueitem",queueitemroute:"symbolFont QueueItemRoute-symbol",quote:"crmSymbolFont entity-symbol Quote",report:"crmSymbolFont entity-symbol Report",resolvecase:"symbolFont ResolveCase-symbol",salesliterature:"crmSymbolFont entity-symbol SalesLiterature",salesorder:"crmSymbolFont entity-symbol Salesorder",serviceactivity:"symbolFont ServiceActivity-symbol",sharepointdocument:"crmSymbolFont entity-symbol Sharepointdocument",socialprofile:"crmSymbolFont entity-symbol Socialprofile",systemuser:"crmSymbolFont entity-symbol Systemuser",task:"crmSymbolFont entity-symbol Task",team:"crmSymbolFont entity-symbol Team",transactioncurrency:"crmSymbolFont entity-symbol TransactionCurrency",user:"symbolFont GuestUser-symbol",wordtemplates:"symbolFont WordTemplates-symbol",msdyusd_task:"crmSymbolFont entity-symbol msdyusd_task-symbol",msdyusd_configuration:"crmSymbolFont entity-symbol msdyusd_configuration-symbol",msdyusd_customizationfiles:"crmSymbolFont entity-symbol msdyusd_customizationfiles-symbol",msdyusd_entitysearch:"crmSymbolFont entity-symbol msdyusd_entitysearch-symbol",msdyusd_uiievent:"crmSymbolFont entity-symbol msdyusd_uiievent-symbol",msdyusd_form:"crmSymbolFont entity-symbol msdyusd_form-symbol",uii_option:"crmSymbolFont entity-symbol uii_option-symbol",uii_hostedapplication:"crmSymbolFont entity-symbol uii_hostedapplication-symbol",msdyusd_scriptlet:"crmSymbolFont entity-symbol msdyusd_scriptlet-symbol",msdyusd_toolbarstrip:"crmSymbolFont entity-symbol msdyusd_toolbarstrip-symbol",msdyusd_usersettings:"crmSymbolFont entity-symbol msdyusd_usersettings-symbol",msdyusd_agentscriptaction:"crmSymbolFont entity-symbol msdyusd_agentscriptaction-symbol",msdyusd_auditanddiagnosticssetting:"crmSymbolFont entity-symbol msdyusd_auditanddiagnosticssetting-symbol",msdyusd_sessioninformation:"crmSymbolFont entity-symbol msdyusd_sessioninformation-symbol",msdyusd_windowroute:"crmSymbolFont entity-symbol msdyusd_windowroute-symbol",customentity:"symbolFont CustomEntity-symbol",default:"symbolFont CustomEntity-symbol",unresolvedaddress:"symbolFont InformationIcon-symbol",recurringappointmentmaster:"symbolFont NewRecurringAppointment-symbol",service:"crmSymbolFont entity-symbol Service",serviceappointment:"crmSymbolFont entity-symbol ServiceAppointment",equipment:"crmSymbolFont entity-symbol Equipment",pricelevel:"crmSymbolFont entity-symbol PriceLevel",goalrollupquery:"crmSymbolFont entity-symbol GoalRollUpQuery",uomschedule:"crmSymbolFont entity-symbol UoMSchedule",discounttype:"crmSymbolFont entity-symbol DiscountType",territory:"crmSymbolFont entity-symbol Territory",socialactivity:"crmSymbolFont entity-symbol Socialactivity",calendar:"crmSymbolFont entity-symbol Calendar",category:"crmSymbolFont entity-symbol Category",entitlement:"crmSymbolFont entity-symbol Entitlement",queue:"crmSymbolFont entity-symbol Queue",routingrule:"crmSymbolFont entity-symbol RoutingRule",routingruleitem:"crmSymbolFont entity-symbol RoutingRuleItem",msdyn_knowledgearticletemplate:"crmSymbolFont entity-symbol msdyn_knowledgearticletemplate",msdyn_servicelevelagreement:"crmSymbolFont entity-symbol msdyn_servicelevelagreement",msdyn_servicelevelagreementkpi:"crmSymbolFont entity-symbol msdyn_servicelevelagreementkpi",msdyn_servicelevelagreementinstance:"crmSymbolFont entity-symbol msdyn_servicelevelagreementinstance"},this.EntityIconFluentUINameMapping={edit:"Edit",remove:"Delete",new:"add",refresh:"Refresh",markaswon:"Ribbon",markaslost:"Blocked",reopenopportunity:"PageArrowRight",assign:"UserWarning",share:"Share",emaillink:"MailLink",ratingempty:"FavoriteStar",ratingfull:"FavoriteStarFill",flows:"Flow",report:"CRMReport",documenttemplates:"ExcelLogo",wordtemplates:"WordDocument",qualify:"",deactivate:"PageBlock",default:""}}return e.prototype.getEntityFontIconClassName=function(e){return this.EntityIconSymbolMapping[e.toLowerCase()]?this.EntityIconSymbolMapping[e.toLowerCase()]:this.EntityIconSymbolMapping.default},e.prototype.getEntityFluentName=function(e){return this.EntityIconFluentUINameMapping[e.toLowerCase()]?this.EntityIconFluentUINameMapping[e.toLowerCase()]:this.EntityIconFluentUINameMapping.default},e}()},23436:function(e,t,n){"use strict";n.r(t),n.d(t,{Guid:function(){return i}});var i=function(){function e(){this.guid="00000000-0000-0000-0000-000000000000"}return e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.prototype.toString=function(){return this.guid},e}()},64828:function(e,t,n){"use strict";n.d(t,{K:function(){return r}});var i={INVALID_DATA_TYPE:"The attribute value is not of desired data type.",ATTRIBUTE_BUSINESS_REQUIRED:"This attribute is business required.",ATTRIBUTE_MAXIMUM_LENGTH_EXCEEDED:"The attribute value exceeded the maximum allowed length of {0} characters.",ATTRIBUTE_VALUE_OUT_OF_RANGE:"The attribute value must be between {0} and {1}",UNEXPECTED_ERROR:"Unexpected Error",LOADING_RESULTS:"loading results",NO_RESULTS_FOUND:"no results found",OPTIONSET_SELECT:"--Select--",TOTAL_RECORDS_COUNT:"{0}/{1}",ERROR_LOADING_CONTROL:"Error Loading Control",AGGREGATION_LIMIT_EXCEEDED_TOTAL_RECORDS_COUNT:"{0}+",CARD_DIV_ARIA_LABEL:"Draggable item. Press space bar to lift",REMOVE:"Remove"};function r(e){return i[e]?i[e]:e}},84718:function(e,t,n){"use strict";n.r(t),n.d(t,{StringUtil:function(){return i}});var i=function(){function e(){}return e.IsNullOrUndefined=function(e){return null==e},e.IsNullOrEmpty=function(e){return null==e||""===e},e.Empty=function(){return""},e.ReduceToCanonicalForm=function(e){return null==e||""===e?null:("{"===(e=e.trim())[0]&&"}"===e[e.length-1]&&(e=e.substring(1,e.length-1)),e.toLowerCase())},e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=e;if(null!==i||void 0!==i)for(var r=1;r<arguments.length;r++){var o=void 0===arguments[r]||null==arguments[r]?"":arguments[r].toString();i=i.replace(new RegExp("\\{"+(r-1)+"\\}","g"),o)}return i},e}()},97349:function(e,t,n){"use strict";function i(e){return!!e.match(/[0-9a-f]{8}\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\b[0-9a-f]{12}/g)}function r(e){return null==e}n.d(t,{GX:function(){return i},le:function(){return r}})},15220:function(e,t,n){"use strict";n.r(t),n.d(t,{Validations:function(){return r}});var i=n(84718),r=function(){function e(){}return e.validateStringArgument=function(e,t){if(i.StringUtil.IsNullOrEmpty(e))throw new Error(t+" can't be null or empty.")},e.validateNullArgument=function(e,t){if(null==e)throw new Error(t+" can't be null or undefined.")},e}()},52540:function(e,t,n){"use strict";n.d(t,{e:function(){return o}});var i=n(6397),r="data:image/svg+xml,%3Csvg",o=function(e){var t,n=e?"& "+e:"&";return(0,i.mergeStyles)(((t={})[n+"::-webkit-scrollbar"]={width:15,height:15},t[n+"::-webkit-scrollbar-track"]={background:"white"},t[n+"::-webkit-scrollbar-thumb"]={background:"#bebbb8",border:"5.5px solid white",borderRadius:"100px"},t[n+"::-webkit-scrollbar-thumb:hover"]={background:"#605e5c"},t[n+"::-webkit-scrollbar-button:single-button:increment:vertical"]={background:"url('"+r+' width="8" height="4" viewBox="0 0 8 4" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 4L0 0L8 0L4 4Z" fill="rgb(190,187,184)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white',height:15},t[n+"::-webkit-scrollbar-button:single-button:increment:vertical:hover"]={background:"url('"+r+' width="8" height="4" viewBox="0 0 8 4" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 4L0 0L8 0L4 4Z" fill="rgb(96,94,92)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white'},t[n+"::-webkit-scrollbar-button:single-button:increment:horizontal"]={background:"url('"+r+' width="4" height="8" viewBox="0 0 4 8" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 4L0 8L0 0L4 4Z" fill="rgb(190,187,184)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white',width:15},t[n+"::-webkit-scrollbar-button:single-button:increment:horizontal:hover"]={background:"url('"+r+' width="8" height="4" viewBox="0 0 8 4" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 0L8 4H0L4 0Z" fill="rgb(190,187,184)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white',width:15},t[n+"::-webkit-scrollbar-button:single-button:decrement:vertical:hover"]={background:"url('"+r+' width="8" height="4" viewBox="0 0 8 4" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 0L8 4H0L4 0Z" fill="rgb(96,94,92)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white'},t[n+"::-webkit-scrollbar-button:single-button:decrement:horizontal"]={background:"url('"+r+' width="4" height="8" viewBox="0 0 4 8" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M0 4L4 0L4 8L0 4Z" fill="rgb(96,94,92)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white'},t))}},7891:function(e,t,n){"use strict";n.d(t,{a:function(){return r},d:function(){return o}});var i=n(17754),r={root:{paddingLeft:0},labelHovered:{textDecoration:"underline",color:i.WB.dynShade10},label:{color:i.rQ.palette.themePrimary,marginLeft:0}},o={label:{marginLeft:4}}},72052:function(e,t,n){"use strict";n.d(t,{s:function(){return u}});var i=n(49037),r=n(87018),o=n(63804),a=n.n(o),s=n(48945),l=n(90425),c=n(7891),d="FeedbackButton",u=function(e){var t=e.surveySource,n=function(){try{s.D.OpenFeedbackSurvey(),s.D.reportUserAction("surveyClicked",d,"Open the feedback survey",{surveySource:t},"Open the feedback survey","Send feedback button")}catch(e){s.D.reportError("surveyClicked",d,"Failed to open feedback survey",{surveySource:t,error:e},"Clicked send feedback button","Send feedback button")}},o={iconProps:{iconName:"Chat"},className:l.oj,styles:c.d,text:s.D.getLocalizedString("Send_Feedback_Button"),onClick:n,ariaLabel:s.D.getLocalizedString("Send_Feedback_Button")};return"admin"==t?a().createElement(r.ActionButton,{styles:c.a,onClick:function(){return n()},text:s.D.getLocalizedString("Send_Feedback_Button"),ariaLabel:s.D.getLocalizedString("Send_Feedback_Button")}):a().createElement(r.CommandBarButton,(0,i.pi)({},o))}},31079:function(e,t,n){"use strict";n.d(t,{p:function(){return C}});var i=n(49037),r=n(63804),o=n.n(r),a=n(26402),s=n(48945),l=n(36711),c=n(71520),d=n(52922),u=n(73384),p=n(54988),m=n(34052),h=n(1285),g=n(69371),f=n(57297),y=n(6946),v=function(e){return Array.isArray(e)?"estimatedclosedate"===e[0].fieldName?"closedate":"revenue":e.fieldName},C=function(e){var t,n,r=e.chart,C=e.onChartConfigChanged,S=e.fields,E=e.isSI;return o().createElement(o().Fragment,null,o().createElement(m.G,{title:s.D.getLocalizedString("AS_Charts_General_Section")},o().createElement(l.Stack,{tokens:{childrenGap:21}},o().createElement(a.Dropdown,{label:s.D.getLocalizedString("AS_Charts_Chart_Type"),selectedKey:r.type,onChange:function(e,t){t&&(t.key,C((0,i.pi)((0,i.pi)({},r),{type:"bubble"})))},onRenderTitle:function(e){return o().createElement(l.Stack,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},style:{height:"100%"}},o().createElement(d.Icon,(0,i.pi)({style:{width:"24px",height:"24px",color:p.iX.gray110}},f.qr[r.type])),o().createElement("span",null,null==e?void 0:e[0].text))},options:(0,f.pI)(),disabled:!0}),o().createElement(c.TextField,{label:s.D.getLocalizedString("AS_Charts_Chart_Name"),value:null!==(t=r.chartName)&&void 0!==t?t:s.D.getLocalizedString("Deal_Tracker"),onChange:function(e,t){var n=t===s.D.getLocalizedString("Deal_Tracker")?void 0:t;C((0,i.pi)((0,i.pi)({},r),{chartName:n}))},onGetErrorMessage:function(e){return e?void 0:"This field can't be left empty"},required:!0}),o().createElement(h.V,{label:s.D.getLocalizedString("AS_Charts_Horizontal_Axis"),fields:S,selectedFieldName:v(r.xAxisFieldConfig),onSelectedFieldChanged:function(e){if(e){var t=Array.isArray(e)?e.map((function(e){return{entityName:e.entityName,fieldName:e.field.name}})):{entityName:e.entityName,fieldName:e.field.name};C((0,i.pi)((0,i.pi)({},r),{xAxisFieldConfig:t}))}},dataTypeFilter:[y.EDataType.Date],supportsSmartField:!0,supportedFields:["closedate"]}),o().createElement(h.V,{label:s.D.getLocalizedString("AS_Charts_Vertical_Axis"),fields:S,selectedFieldName:r.yAxisFieldConfig.fieldName,onSelectedFieldChanged:function(e){e&&C((0,i.pi)((0,i.pi)({},r),{yAxisFieldConfig:{entityName:e.entityName,fieldName:e.field.name}}))},dataTypeFilter:[y.EDataType.WholeNumber,y.EDataType.Decimal,y.EDataType.Float,y.EDataType.Currency],supportsSIScore:E,supportsSmartField:!1}),o().createElement(h.V,{label:s.D.getLocalizedString("AS_Charts_Segment_By"),fields:S,selectedFieldName:null===(n=r.segmentedByFieldConfig)||void 0===n?void 0:n.fieldName,onSelectedFieldChanged:function(e){return C((0,i.pi)((0,i.pi)({},r),{segmentedByFieldConfig:e?{entityName:e.entityName,fieldName:e.field.name}:void 0,colorPalette:"msdyn_grade"===(null==e?void 0:e.field.name)?"health":"categorical"}))},dataTypeFilter:[],additionalAvailableFieldNames:["stepname"],supportsSIGrade:E,supportsSmartField:!1}),o().createElement(h.V,{label:s.D.getLocalizedString("AS_Charts_Size"),fields:S,selectedFieldName:v(r.bubbleSizeFieldConfig),onSelectedFieldChanged:function(e){if(e){var t=Array.isArray(e)?e.map((function(e){return{entityName:e.entityName,fieldName:e.field.name}})):{entityName:e.entityName,fieldName:e.field.name};C((0,i.pi)((0,i.pi)({},r),{bubbleSizeFieldConfig:t}))}},dataTypeFilter:[y.EDataType.WholeNumber,y.EDataType.Decimal,y.EDataType.Float,y.EDataType.Currency],supportsSmartField:!0,supportedFields:["revenue"]}),o().createElement(a.Dropdown,{label:s.D.getLocalizedString("AS_Charts_Sort_Legend"),selectedKey:r.sortLegendType,onChange:function(e,t){if(t){var n=t.key;C((0,i.pi)((0,i.pi)({},r),{sortLegendType:n}))}},options:(0,f.wC)()}))),o().createElement(u.Separator,null),o().createElement(m.G,{title:s.D.getLocalizedString("AS_Charts_Tooltips_Section")},o().createElement(g.O,{fields:S,tooltips:r.tooltipFieldNames,onTooltipsChanged:function(e){C((0,i.pi)((0,i.pi)({},r),{tooltipFieldNames:e}))},requiredFieldNames:(0,i.pr)([Array.isArray(r.xAxisFieldConfig)?r.xAxisFieldConfig.map((function(e){return e.fieldName})):r.xAxisFieldConfig.fieldName,r.yAxisFieldConfig.fieldName,Array.isArray(r.bubbleSizeFieldConfig)?r.bubbleSizeFieldConfig.map((function(e){return e.fieldName})):r.bubbleSizeFieldConfig.fieldName],r.segmentedByFieldConfig?[r.segmentedByFieldConfig.fieldName]:[]).flat(),isSI:E})))}},34052:function(e,t,n){"use strict";n.d(t,{N:function(){return m},G:function(){return h}});var i=n(63804),r=n.n(i),o=n(91847),a=n(53205),s=n(52922),l=n(48945),c=n(9777),d=n(47558),u={width:"100%",paddingBottom:"8px"},p={paddingBottom:"26px"},m=function(e){var t=e.imageUrl;return r().createElement(o.Stack,null,r().createElement("img",{style:u,src:t}),r().createElement(o.Stack,{style:p,horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8}},r().createElement(s.Icon,{iconName:"Info"}),r().createElement(a.Text,null,l.D.getLocalizedString("AS_Charts_Static_Image"))),e.children)},h=function(e){var t=e.title;return r().createElement(c.z,{title:t,titleStyle:d.gn.dealManagerSettingsSubtitle,contentGap:13,iconTitleGap:8},e.children)}},47035:function(e,t,n){"use strict";n.d(t,{A:function(){return a},H:function(){return s}});var i=n(94589),r=n(54988),o=n(19608),a={main:{overflowY:"hidden"}},s=(0,o.mergeStyles)({fontSize:i.TS.size20,color:r.iX.gray160,fontWeight:600,padding:"18px 24px 0 24px"})},35874:function(e,t,n){"use strict";n.d(t,{H:function(){return f}});var i=n(63804),r=n.n(i),o=n(47035),a=n(64635),s=n(87018),l=n(91847),c=n(48945),d=n(34052),u=n(31079),p=n(31815),m=n(73384),h="ChartDesigner",g={bubble:"/webresources/msdyn_/Images/BubbleChartStaticImage.svg",funnel:"/webresources/msdyn_/Images/FunnelChartStaticImage.svg"},f=function(e){var t=e.chart,n=e.onChartConfigChanged,f=e.isOpen,y=e.onDismiss,v=e.onDismissed,C=e.fields,S=e.isSI,E=(0,i.useState)(t),b=E[0],w=E[1],D=(0,i.useCallback)((function(){c.D.reportUserAction("handlePanelDismiss",h,"Cancel chart designer",{},"Cancel chart designer",""),null==y||y()}),[y]),T=(0,i.useCallback)((function(){c.D.reportUserAction("handleSaveClicked",h,"Save chart config",{currentChart:b},"Save chart config",""),n(b),null==y||y()}),[b,n,y]),x=function(e){w(e)},k=r().useCallback((function(e,t){return r().createElement(l.Stack,null,r().createElement(l.Stack,{horizontal:!0},r().createElement(l.Stack.Item,{grow:!0},r().createElement("div",{className:o.H},c.D.getLocalizedString("AS_Edit_Chart"))),t(e)),r().createElement(m.Separator,null))}),[]),_=r().useCallback((function(){return r().createElement(l.Stack,{horizontal:!0,horizontalAlign:"end",verticalAlign:"center",tokens:{childrenGap:16}},r().createElement(s.PrimaryButton,{onClick:T},c.D.getLocalizedString("Save")),r().createElement(s.DefaultButton,{onClick:D},c.D.getLocalizedString("InContextView_Cancel")))}),[T,D]);return r().createElement(a.Panel,{isOpen:f,onDismiss:D,onDismissed:function(){w(t),null==v||v()},isLightDismiss:!0,closeButtonAriaLabel:c.D.getLocalizedString("ICV_Close"),onRenderNavigation:k,onRenderFooterContent:_,isFooterAtBottom:!0,hasCloseButton:!0,styles:o.A},r().createElement(d.N,{imageUrl:g[t.type]},"bubble"===b.type&&r().createElement(u.p,{chart:b,onChartConfigChanged:x,fields:C,isSI:S}),"funnel"===b.type&&r().createElement(p.X,{chart:b,onChartConfigChanged:x,fields:C})))}},33357:function(e,t,n){"use strict";n.d(t,{K:function(){return w}});var i=n(49037),r=n(63804),o=n.n(r),a=n(6779),s=n(87018),l=n(91847),c=n(53205),d=n(94237),u=n(36957),p=n(54988),m=n(94589),h=n(4432),g=n(17217),f=n(48945),y=n(35874),v=n(14809),C=function(e,t){return e.map((function(e){return e.id===t.id?t:e}))},S={stackInDetailList:{height:"100%"},chartDisplayName:{color:p.iX.gray160,fontSize:m.TS.size14},chartType:{color:p.iX.gray130,fontSize:m.TS.size14},chartIcon:{paddingRight:"12px",width:"32px",height:"32px",color:h.I.digitalBlue},editIcon:{color:p.iX.gray130},propertyTag:{border:"1px solid #EDEBE9",borderRadius:2,marginRight:6,padding:4,fontWeight:400},propertyTagTitle:{fontWeight:600}},E={root:{width:"70%"}},b={metadataId:"opportunity",name:"opportunity",displayName:"Opportunity",primaryNameField:"name",primaryIdField:"opportunityid"},w=function(e){var t=e.charts,n=e.onSettingsChanged,p=e.resolver,m=e.isSI,h=(0,r.useState)(!1),w=h[0],D=h[1],T=(0,r.useState)(),x=T[0],k=T[1],_=(0,r.useState)([]),N=_[0],L=_[1];(0,r.useEffect)((function(){(0,i.mG)(void 0,void 0,Promise,(function(){var e;return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return[4,p.resolveFields(b)];case 1:return e=t.sent(),L(e),[2]}}))}))}),[]);var I=(0,r.useMemo)((function(){var e={bubble:f.D.getLocalizedString("AS_Bubble_Type"),funnel:f.D.getLocalizedString("AS_Funnel_Type")},r={bubble:g.P.bubbleChart,funnel:g.P.funnelChart},a={dealTracker:f.D.getLocalizedString("Deal_Tracker"),salesFunnel:f.D.getLocalizedString("Sales_Funnel")};return[{key:"column1",name:f.D.getLocalizedString("AS_Charts_Name_Column_Title"),ariaLabel:f.D.getLocalizedString("AS_Charts_Name_Column_Title"),fieldName:"chartName",minWidth:10,maxWidth:312,isRowHeader:!0,onRender:function(t){var n;return o().createElement(l.Stack,{horizontal:!0,verticalAlign:"center"},o().createElement(u.Icon,(0,i.pi)({style:S.chartIcon},r[t.type])),o().createElement(l.Stack.Item,{styles:E},o().createElement(l.Stack,null,o().createElement(c.Text,{nowrap:!0,style:S.chartDisplayName},null!==(n=t.chartName)&&void 0!==n?n:a[t.id]),o().createElement(c.Text,{style:S.chartType},e[t.type]))),o().createElement(l.Stack.Item,{align:"end"},o().createElement(s.IconButton,{iconProps:{iconName:"Edit",onClick:function(){k(t),D(!0)},style:S.editIcon},title:"Edit",ariaLabel:"Edit chart"})))}},{key:"column2",name:f.D.getLocalizedString("AS_Charts_Properties_Column_Title"),ariaLabel:f.D.getLocalizedString("AS_Charts_Properties_Column_Title"),fieldName:"properties",minWidth:10,maxWidth:495,onRender:function(e){var t=function(e){var t,n;if(!e)return f.D.getLocalizedString("None");var i=(0,v.b)();if(Array.isArray(e))return"estimatedclosedate"===e[0].fieldName?i.closedate.displayName:i.revenue.displayName;var r=e.fieldName;return"msdyn_score"===r?"Opportunity Score":"msdyn_grade"===r?"Opportunity Grade":null!==(n=null===(t=N.find((function(e){return e.name===r})))||void 0===t?void 0:t.displayName)&&void 0!==n?n:r},n={min:f.D.getLocalizedString("Aggregate_Min"),max:f.D.getLocalizedString("Aggregate_Max"),count:f.D.getLocalizedString("Aggregate_Count"),average:f.D.getLocalizedString("Aggregate_Avg"),sum:f.D.getLocalizedString("Aggregate_Sum")},i="bubble"==e.type?[{title:f.D.getLocalizedString("AS_Charts_X_Axis"),data:t(e.xAxisFieldConfig)},{title:f.D.getLocalizedString("AS_Charts_Y_Axis"),data:t(e.yAxisFieldConfig)},{title:f.D.getLocalizedString("AS_Charts_Bubble_Size"),data:t(e.bubbleSizeFieldConfig)}]:[{title:f.D.getLocalizedString("AS_Charts_Segment_By"),data:t(e.segmentedByFieldConfig)},{title:f.D.getLocalizedString("AS_Charts_Values"),data:t(e.valuesFieldConfig)},{title:f.D.getLocalizedString("AS_Charts_Aggregation"),data:n[e.aggregationType]}];return o().createElement(l.Stack,{style:S.stackInDetailList,horizontal:!0,verticalAlign:"center",horizontalAlign:"start"},i.map((function(e,t){return o().createElement("div",{key:t,style:S.propertyTag},o().createElement("span",{style:S.propertyTagTitle},e.title+" "),e.data)})),"bubble"==e.type&&o().createElement("div",{style:S.propertyTag},o().createElement("span",{style:S.propertyTagTitle},"+2")))}},{key:"column3",name:f.D.getLocalizedString("AS_Charts_Status_Column_Title"),ariaLabel:f.D.getLocalizedString("AS_Charts_Status_Column_Title"),fieldName:"status",minWidth:10,maxWidth:140,onRender:function(e){return o().createElement(l.Stack,{style:S.stackInDetailList,verticalAlign:"center"},o().createElement(d.Toggle,{style:{marginBottom:0},onText:f.D.getLocalizedString("On"),offText:f.D.getLocalizedString("Off"),checked:e.status,onChange:function(r,o){n(C(t,(0,i.pi)((0,i.pi)({},e),{status:null!=o&&o})))}}))}}]}),[t,n,N]);return o().createElement(o().Fragment,null,o().createElement(a.DetailsList,{items:t,columns:I,onRenderRow:function(e){if(e){var n={};return e.itemIndex===t.length-1&&(n.root={borderBottom:"none"}),o().createElement(a.DetailsRow,(0,i.pi)({},e,{styles:n}))}return null},selectionMode:a.SelectionMode.none,layoutMode:a.DetailsListLayoutMode.justified,isHeaderVisible:!0}),x&&o().createElement(y.H,{isOpen:w,onDismiss:function(){D(!1)},onDismissed:function(){k(void 0)},chart:x,onChartConfigChanged:function(e){n(C(t,e))},fields:N,isSI:m}))}},69371:function(e,t,n){"use strict";n.d(t,{O:function(){return E}});var i=n(49037),r=n(63804),o=n.n(r),a=n(27196),s=n(91847),l=n(36957),c=n(87018),d=n(48909),u=n(42093),p=n(32790),m=n(54988),h=n(19608),g=n(82361),f=n(1285),y=n(48945),v=n(92202),C=(0,h.mergeStyles)({background:"white","&:hover":{background:m.iX.gray30}}),S=(0,h.mergeStyles)({color:m.iX.gray130,background:"none","&:hover":{background:m.iX.gray40}}),E=function(e){var t=e.fields,n=e.tooltips,r=e.onTooltipsChanged,a=e.requiredFieldNames,m=e.isSI,h=b(1000001),E=n.length>=8;return o().createElement("div",null,o().createElement(u.TooltipHost,{content:E?y.D.getLocalizedString("AS_Charts_Tooltip_Field_Limit_Tooltip",8):void 0,calloutProps:{directionalHint:u.DirectionalHint.bottomCenter,calloutMaxWidth:250,calloutMaxHeight:60}},o().createElement(f.V,{label:y.D.getLocalizedString("AS_Charts_Tooltip_Fields"),placeholder:y.D.getLocalizedString("AS_Charts_Tooltip_Fields_Placeholder"),fields:t,selectedFieldName:void 0,onSelectedFieldChanged:function(e){var t;e&&(n.some((function(t){return t.fieldConfig.fieldName===e.field.name}))||r((0,i.pr)(n,[{fieldConfig:{entityName:e.entityName,fieldName:e.field.name},visibility:null!==(t=g.j0[e.field.name])&&void 0!==t?t:"always"}])))},style:{paddingBottom:8},disabled:E,supportsSIScore:m,supportsSIGrade:m,supportsSmartField:!1})),o().createElement(v.Z5,{onDragEnd:function(e){e.destination&&r(function(e,t,n){var i=Array.from(e),r=i.splice(t,1)[0];return i.splice(n,0,r),i}(n,e.source.index,e.destination.index))}},o().createElement(v.bK,{droppableId:"droppable"},(function(e){return o().createElement("div",(0,i.pi)({},e.droppableProps,{ref:e.innerRef}),n.map((function(e,m){var g=a.includes(e.fieldConfig.fieldName);return o().createElement(v._l,{key:e.fieldConfig.fieldName,draggableId:e.fieldConfig.fieldName,index:m},h((function(a,h){return o().createElement("div",(0,i.pi)({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{className:C,style:(b=h.isDragging,w=a.draggableProps.style,(0,i.pi)({userSelect:"none",boxShadow:b?p.N.depth16:"none"},w)),key:e.fieldConfig.fieldName,"data-testid":"dnd-field-element"}),o().createElement(s.Stack,{horizontal:!0,verticalAlign:"center",horizontalAlign:"start"},o().createElement(l.Icon,{iconName:"GripperDotsVertical",style:{paddingRight:6}}),o().createElement(s.Stack.Item,{grow:!0},o().createElement(d.Text,null,"msdyn_score"===(f=e.fieldConfig.fieldName)?"Opportunity Score":"msdyn_grade"===f?"Opportunity Grade":null!==(E=null===(v=t.find((function(e){return e.name===f})))||void 0===v?void 0:v.displayName)&&void 0!==E?E:f)),o().createElement(s.Stack.Item,{align:"end"},o().createElement(u.TooltipHost,{content:g?y.D.getLocalizedString("AS_Charts_Tooltip_Delete_Tooltip"):void 0,calloutProps:{directionalHint:u.DirectionalHint.topAutoEdge,calloutMaxWidth:135,calloutMaxHeight:88}},o().createElement(c.IconButton,{className:S,iconProps:{iconName:"Trash"},disabled:g,onClick:function(){r(function(e,t){var n=Array.from(e);return n.splice(t,1),n}(n,m))}})))));var f,v,E,b,w})))})),e.placeholder)}))))},b=function(e){var t=o().useRef({}).current;return o().useEffect((function(){var n=document.createElement("div");return n.style.position="absolute",n.style.pointerEvents="none",n.style.top="0",n.style.width="100%",n.style.height="100%",n.style.zIndex=e.toString(),t.container=n,document.body.appendChild(n),function(){document.body.removeChild(n)}}),[t]),function(e){return function(n,i,r){var o=e(n,i,r),s=n.draggableProps.style;return t.container&&s&&function(e){return e.hasOwnProperty("position")}(s)&&"fixed"===s.position?(0,a.createPortal)(o,t.container):o}}}},57297:function(e,t,n){"use strict";n.d(t,{qr:function(){return o},pI:function(){return a},wC:function(){return s}});var i=n(17217),r=n(48945),o={bubble:i.P.bubbleChart,funnel:i.P.funnelChart},a=function(){return[{key:"bubble",text:r.D.getLocalizedString("AS_Bubble_Type")},{key:"funnel",text:r.D.getLocalizedString("AS_Funnel_Type")}]},s=function(){return[{key:"startToFinish",text:r.D.getLocalizedString("AS_Charts_Start_To_Finish")},{key:"finishToStart",text:r.D.getLocalizedString("AS_Charts_Finish_To_Start")}]}},9988:function(e,t,n){"use strict";n.d(t,{J6:function(){return a},Gm:function(){return s},Re:function(){return l},F2:function(){return c}});var i=n(74293),r=n(54988),o=n(94589),a=(0,i.mergeStyles)({color:r.iX.gray160,fontSize:o.TS.size14}),s=(0,i.mergeStyles)({textAlign:"left",color:r.iX.gray130,fontSize:o.TS.size12}),l=(0,i.mergeStyles)({overflow:"hidden",textOverflow:"ellipsis",paddingTop:"8px",paddingBottom:"8px"}),c={optionTextWrapper:{width:"100%"}}},1285:function(e,t,n){"use strict";n.d(t,{V:function(){return C}});var i=n(49037),r=n(63804),o=n.n(r),a=n(9988),s=n(28906),l=n(52922),c=n(48909),d=n(86765),u=n(91847),p=n(6946),m=n(14809),h="none",g="msdyn_score",f="msdyn_grade",y="closedate",v="revenue",C=function(e){var t,n,r=e.placeholder,C=e.fields,S=e.selectedFieldName,E=e.onSelectedFieldChanged,b=e.dataTypeFilter,w=e.additionalAvailableFieldNames,D=e.supportsNone,T=e.noneLabel,x=(0,i._T)(e,["placeholder","fields","selectedFieldName","onSelectedFieldChanged","dataTypeFilter","additionalAvailableFieldNames","supportsNone","noneLabel"]),k=(0,m.b)(),_=b?C.filter((function(e){return b.includes(e.dataType)||(null==w?void 0:w.includes(e.name))})).filter((function(t){return!e.supportsSIScore||e.supportsSIScore&&"msdyn_opportunityscore"!==t.name})).filter((function(t){return!e.supportsSIGrade||e.supportsSIGrade&&"msdyn_opportunitygrade"!==t.name})):C,N=(0,i.pr)(e.supportsSmartField&&(null===(t=e.supportedFields)||void 0===t?void 0:t.includes(y))?[{key:y,text:k.closedate.displayName,title:k.closedate.tooltipContent}]:[],e.supportsSmartField&&(null===(n=e.supportedFields)||void 0===n?void 0:n.includes(v))?[{key:v,text:k.revenue.displayName,title:k.revenue.tooltipContent}]:[],e.supportsSIScore?[{key:g,text:"Opportunity Score"}]:[],e.supportsSIGrade?[{key:f,text:"Opportunity Grade"}]:[],D?[{key:h,text:null!=T?T:"None"}]:[],_.map((function(e){return{key:e.name,text:e.displayName,data:{field:e}}}))),L=function(e,t){return o().createElement(u.Stack,{tokens:{childrenGap:16}},o().createElement(c.Text,null,e),o().createElement(c.Text,null,t))};return o().createElement(s.ComboBox,(0,i.pi)({},x,{placeholder:null!=T?T:r,selectedKey:S,onChange:function(e,t){var n;if(t){var r=t.key===g,o=t.key===f,a=t.key===y||t.key===v,s=t.key===h,l={metadataId:"",displayName:"",dataType:p.EDataType.WholeNumber},c=s?void 0:a?function(e){var t=k[e];if(t){var n=t.entityType;return t.sourceFields.map((function(e){return{entityName:n,field:{metadataId:"",displayName:"",dataType:p.EDataType.WholeNumber,name:e}}}))}}(t.key):{field:r||o?(0,i.pi)((0,i.pi)({},l),{name:t.key}):null===(n=t.data)||void 0===n?void 0:n.field,entityName:r||o?"msdyn_predictivescore":"opportunity"};E(c)}},options:N,autoComplete:"on",useComboBoxAsMenuWidth:!0,comboBoxOptionStyles:a.F2,onRenderOption:function(e){var t,n,i,r=(null==e?void 0:e.key)===g,s=(null==e?void 0:e.key)===f,p=(null==e?void 0:e.key)===y||(null==e?void 0:e.key)===v,m=(null==e?void 0:e.text)||"",h=r||s?"Integer":null===(i=null===(n=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.field)||void 0===n?void 0:n.dataType)||void 0===i?void 0:i.replace("_None","");return p&&e?function(e){var t,n,i,r=e.key,s=null===(n=null===(t=k[r])||void 0===t?void 0:t.dataType)||void 0===n?void 0:n.replace("_None",""),p=(null===(i=e.title)||void 0===i?void 0:i.split("{0}"))||["",""],m=p[0],h=p[1];return o().createElement("div",{className:a.Re},o().createElement(u.Stack,null,o().createElement(u.Stack,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:4}},o().createElement(c.Text,{className:a.J6},e.text),o().createElement(d.TooltipHost,{content:L(m,h)},o().createElement(l.Icon,{iconName:"Info"}))),o().createElement(c.Text,{className:a.Gm},s)))}(e):o().createElement("div",{className:a.Re},o().createElement(u.Stack,null,o().createElement(c.Text,{className:a.J6},m),o().createElement(c.Text,{className:a.Gm},h)))}}))}},31815:function(e,t,n){"use strict";n.d(t,{X:function(){return h}});var i=n(49037),r=n(63804),o=n.n(r),a=n(34052),s=n(48945),l=n(57297),c=n(36711),d=n(26402),u=n(71520),p=n(54988),m=n(52922),h=function(e){var t,n=e.chart,r=e.onChartConfigChanged;return e.fields,o().createElement(o().Fragment,null,o().createElement(a.G,{title:s.D.getLocalizedString("AS_Charts_General_Section")},o().createElement(c.Stack,{tokens:{childrenGap:21}},o().createElement(d.Dropdown,{label:s.D.getLocalizedString("AS_Charts_Chart_Type"),selectedKey:n.type,onChange:function(e,t){t&&(t.key,r((0,i.pi)((0,i.pi)({},n),{type:"funnel"})))},onRenderTitle:function(e){return o().createElement(c.Stack,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8},style:{height:"100%"}},o().createElement(m.Icon,(0,i.pi)({style:{width:"24px",height:"24px",color:p.iX.gray110}},l.qr[n.type])),o().createElement("span",null,null==e?void 0:e[0].text))},options:(0,l.pI)(),disabled:!0}),o().createElement(u.TextField,{label:s.D.getLocalizedString("AS_Charts_Chart_Name"),value:null!==(t=n.chartName)&&void 0!==t?t:s.D.getLocalizedString("Sales_Funnel"),onChange:function(e,t){var o=t===s.D.getLocalizedString("Sales_Funnel")?void 0:t;r((0,i.pi)((0,i.pi)({},n),{chartName:o}))},onGetErrorMessage:function(e){return e?void 0:"This field can't be left empty"},required:!0}))))}},76614:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var i=function(){function e(){}return e.dealManagerOptInSettingsKey="msdyn_DealManagerOptIn",e.dealManagerReadPrivilege="prvReadmsdyn_dealmanagersettings",e.dealManagerAccessPrivilege="prvReadmsdyn_dealmanageraccess",e}()},98515:function(e,t,n){"use strict";n.d(t,{R:function(){return F}});var i=n(49037),r=n(63804),o=n.n(r),a=n(52493),s=n(91847),l=n(94237),c=n(53205),d=n(25453),u=n(73384),p=n(87018),m=n(36957),h=n(17217),g=n(93170),f=n.n(g),y=n(27896),v=n(47558),C=n(82361),S=n(50092),E=n(33357),b=n(81117),w=n(47095),D=n(92312),T=n(48945),x=n(4476),k=n(92970),_=n(31627),N=n(19608),L=n(17754),I=n(48327),A=n(72052),R=n(76614);(0,N.loadTheme)(L.rQ);var F=function(e){var t,n=e.context,N=n.webAPI,L=(0,r.useState)(!0),F=L[0],P=L[1],M=(0,r.useState)(),O=M[0],V=M[1],z=(0,r.useState)(),B=z[0],U=z[1],H=(0,r.useState)(!1),G=H[0],W=H[1],j=(0,r.useState)(),X=j[0],K=j[1],q=(0,r.useState)(!1),Z=q[0],J=q[1],Q=o().useMemo((function(){var t;return null!==(t=e.dataverseAccess)&&void 0!==t?t:x._.getDataverseAccess()}),[e.dataverseAccess]);(0,r.useEffect)((function(){(0,i.mG)(void 0,void 0,Promise,(function(){var e,t;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,(0,S.wv)(N)];case 1:return e=n.sent(),V(null==e?void 0:e.settings),U(null==e?void 0:e.settings),K(null==e?void 0:e.id),[4,(0,S.Kd)(N)];case 2:return t=n.sent(),J(t),P(!1),[2]}}))}))}),[]),(0,r.useEffect)((function(){W(!(0,a.isEqual)(O,B))}),[O,B]);var Y=function(){return X?!!O||(console.error("DealManagerSettings could not update settings in dataverse. settings are undefined.\n"),!1):(console.error("DealManagerSettings could not update settings in dataverse. No record id available.\n"),!1)},$=function(){return F||!O||!G},ee=(0,y.k)(!0),te=ee[0],ne=ee[1].toggle,ie=function(e){var t,n,i=e?T.D.getLocalizedString("AS_Save_Success"):T.D.getLocalizedString("AS_Save_Failure"),r=e?1:2;null===(n=null===(t=window.Xrm)||void 0===t?void 0:t.UI)||void 0===n||n.addGlobalNotification(1,r,i,null,null,null)};return o().createElement("div",{style:v.gn.dealManagerSettingsContainer},!O&&F&&o().createElement(d.Spinner,null),!F&&(!O||!(O&&O.isDealManagerPreviewEnabled))&&o().createElement(b.x,{webAPI:N,settings:O,onInitialized:function(e){if(e){K(e);var t=Z?C.Sg:C.he;V(t),U(t)}else{var n=(0,i.pi)((0,i.pi)({},O),{isDealManagerPreviewEnabled:!0});V(n),U(n)}}}),O&&O.isDealManagerPreviewEnabled&&o().createElement(o().Fragment,null,o().createElement(s.Stack,{horizontal:!0,style:(0,i.pi)({},v.gn.dealmanagerSettingsHeader)},o().createElement(s.Stack.Item,{grow:!0},o().createElement(s.Stack,{style:v.qm,horizontal:!0,verticalAlign:"center",tokens:{childrenGap:8}},o().createElement(m.Icon,{styles:v.Mx,iconName:"Info"}),o().createElement(c.Text,{styles:v.Mx},T.D.getLocalizedString("AS_Preview_Header_Text")),o().createElement(A.s,{surveySource:"admin"}))),o().createElement(s.Stack.Item,{align:"end"},o().createElement(l.Toggle,{styles:v.FK,checked:O.isDealManagerPreviewEnabled,onText:T.D.getLocalizedString("AS_Preview_Enabled_Toggle_On"),offText:"Preview disabled",onChange:function(e,t){ne()},disabled:F}))),o().createElement(f(),{hidden:te,onDismiss:ne,dialogContentProps:{title:T.D.getLocalizedString("AS_Opt_Out_Dialog_Title"),closeButtonAriaLabel:T.D.getLocalizedString("AS_Cancel"),subText:T.D.getLocalizedString("AS_Opt_Out_Dialog_Subtext")},modalProps:{isBlocking:!0,styles:v.y8}},o().createElement(g.DialogFooter,null,o().createElement(s.Stack,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:8}},F&&o().createElement(d.Spinner,null),o().createElement(p.PrimaryButton,{onClick:function(){return(0,i.mG)(void 0,void 0,void 0,(function(){var e;return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return Y()?(P(!0),[4,(0,S.NA)(N,X,O)]):[3,3];case 1:return t.sent(),[4,T.D.SaveSetting(R.g.dealManagerOptInSettingsKey,!1)];case 2:t.sent(),P(!1),e=(0,i.pi)((0,i.pi)({},O),{isDealManagerPreviewEnabled:!1}),V(e),t.label=3;case 3:return ne(),[2]}}))}))},text:T.D.getLocalizedString("AS_Opt_Out")}),o().createElement(p.DefaultButton,{onClick:ne,text:T.D.getLocalizedString("InContextView_Cancel")})))),o().createElement(s.Stack,{horizontal:!0,style:v.gn.dealmanagerSettingsFooter},o().createElement(s.Stack.Item,{grow:!0},o().createElement(s.Stack,{horizontal:!0,tokens:{childrenGap:8},verticalAlign:"center"},F&&o().createElement(d.Spinner,null),o().createElement(p.PrimaryButton,{text:T.D.getLocalizedString("AS_Publish"),onClick:function(){return(0,i.mG)(void 0,void 0,void 0,(function(){var e;return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return Y()?(P(!0),[4,(0,S.MZ)(N,X,O)]):[3,2];case 1:return e=t.sent(),ie(e),e&&U(O),P(!1),[3,3];case 2:ie(!1),t.label=3;case 3:return[2]}}))}))},disabled:$(),styles:v.$Y}),o().createElement(p.DefaultButton,{text:T.D.getLocalizedString("AS_Cancel"),onClick:function(){V(B)},disabled:$()}),o().createElement(p.ActionButton,{iconProps:h.P.goToIcon,onClick:function(){var e,t=null===(e=n.page)||void 0===e?void 0:e.appId;t&&n.navigation&&n.navigation.openUrl("main.aspx?appid="+t+"&pagetype=control&controlName=MscrmControls.Sales.DealManager.DealManager")},disabled:F,className:v.fZ},T.D.getLocalizedString("AS_View_Deal_Manager_Text")))),o().createElement(s.Stack.Item,{align:"end"},o().createElement(p.DefaultButton,{text:T.D.getLocalizedString("AS_Reset_Default_Settings_Text"),onClick:function(){V(Z?C.Sg:C.he)},disabled:F||!O}))),o().createElement(s.Stack,{style:v.gn.dealManagerSettingsMainStack},o().createElement("div",{style:(0,i.pi)((0,i.pi)({},v.gn.dealManagerSettingsTextBlock),v.gn.dealManagerSettingsTitleSection)},o().createElement(c.Text,{block:!0,style:v.gn.dealManagerSettingsPageTitle},T.D.getLocalizedString("Deal_Manager_Title")),o().createElement(c.Text,{block:!0,style:(0,i.pi)((0,i.pi)({},v.gn.dealManagerSettingsDescription),v.gn.dealManagerSettingsTitleDescription)},T.D.getLocalizedString("AS_Page_Desc")+" ",o().createElement(w.r,{content:T.D.getLocalizedString("AS_Learn_More"),href:"https://go.microsoft.com/fwlink/?linkid=2166217",openInNewTab:!0})),o().createElement(I.G,{title:T.D.getLocalizedString("AS_Roles_Section_Title"),subtitle:T.D.getLocalizedString("AS_Roles_Section_Desc")},o().createElement(k.k,{webAPI:N,isAllRolesSelected:!!O.rolesSettings&&O.rolesSettings.isAllRoles,selectedRoles:null===(t=O.rolesSettings)||void 0===t?void 0:t.selectedRoles,onSecurityRoleChanges:function(e,t,n){V((0,i.pi)((0,i.pi)({},O),{rolesSettings:{isAllRoles:e,selectedRoles:n}}))}}))),o().createElement(u.Separator,null),o().createElement("div",{style:v.gn.dealManagerSettingsCustomizeSection},o().createElement(c.Text,{block:!0,style:v.gn.dealManagerSettingsTitle},T.D.getLocalizedString("AS_Customize_Section_Title")),o().createElement(c.Text,{block:!0,style:v.gn.dealManagerSettingsDescription},T.D.getLocalizedString("AS_Customize_Section_Desc")+" ",o().createElement(w.r,{content:T.D.getLocalizedString("AS_Learn_More"),href:"https://go.microsoft.com/fwlink/?linkid=2166218",openInNewTab:!0}))),o().createElement(I.G,{title:T.D.getLocalizedString("AS_WebResources_Title"),subtitle:T.D.getLocalizedString("AS_WebResources_Desc"),collapsible:!0,contentGap:16},o().createElement(_.K,{webResources:O.webResources,onWebResourcesChange:function(e){V((0,i.pi)((0,i.pi)({},O),{webResources:e}))},axiosInstance:Q.axiosInstance})),o().createElement(I.G,{title:T.D.getLocalizedString("AS_Charts_Section_Title"),subtitle:T.D.getLocalizedString("AS_Charts_Section_Desc"),collapsible:!0},o().createElement(E.K,{charts:O.charts,onSettingsChanged:function(e){V((0,i.pi)((0,i.pi)({},O),{charts:e}))},resolver:Q.cdsResolver,isSI:Z})),o().createElement(D.U,{flagName:"debugAdminSettings",toggleable:!0},o().createElement("span",{style:(0,i.pi)((0,i.pi)({},v.gn.dealManagerSettingsDescription),{whiteSpace:"pre-wrap"})},"Current Settings: \n"+JSON.stringify(O,null,2))))))}},47558:function(e,t,n){"use strict";n.d(t,{gn:function(){return a},fZ:function(){return s},$Y:function(){return l},FK:function(){return c},qm:function(){return d},y8:function(){return u},Mx:function(){return p}});var i=n(54988),r=n(94589),o=n(19608),a={dealManagerSettingsContainer:{width:"100%",maxWidth:"100%",height:"100vh",overflow:"auto",backgroundColor:i.iX.white,boxSizing:"border-box"},dealmanagerSettingsFooter:{position:"absolute",left:0,bottom:0,width:"100%",paddingLeft:"32px",paddingRight:"32px",paddingTop:"16px",paddingBottom:"16px",borderTopWidth:"1px",borderTopStyle:"solid",borderTopColor:i.iX.gray40,backgroundColor:i.iX.white,zIndex:1},dealmanagerSettingsHeader:{left:0,top:0,width:"100%",paddingLeft:"16px",paddingRight:"16px",paddingTop:"10px",paddingBottom:"10px",borderBottomWidth:"1px",borderBottomStyle:"solid",borderBottomColor:i.iX.gray40,backgroundColor:i.iX.gray10,zIndex:1},dealManagerSettingsTextBlock:{width:"800px"},dealManagerSettingsPageTitle:{fontWeight:600,fontSize:r.TS.size20,color:i.iX.gray160,paddingBottom:"8px"},dealManagerSettingsTitle:{fontWeight:600,fontSize:r.TS.size18,color:i.iX.gray160,paddingBottom:"8px"},dealManagerSettingsSubtitle:{fontWeight:600,fontSize:r.TS.size16,color:i.iX.gray160,lineHeight:"22px"},dealManagerSettingsDescription:{fontWeight:400,fontSize:r.TS.size14,color:i.iX.gray130,lineHeight:"20px",paddingTop:"4px"},dealManagerSettingsCustomizeSection:{paddingBottom:32},dealManagerSettingsTitleDescription:{paddingBottom:24},dealManagerSettingsTitleSection:{paddingBottom:8},dealManagerSettingsMainStack:{paddingTop:"32px",paddingLeft:"32px",paddingRight:"32px",paddingBottom:"20vh"},dealManagerSettingContainer:{paddingBottom:"32px"}},s=(0,o.mergeStyles)({paddingLeft:"16px"}),l={labelDisabled:{color:i.iX.gray90}},c={root:{marginBottom:0}},d={height:"100%"},u={main:{maxWidth:400}},p={root:{color:i.iX.gray160}}},92970:function(e,t,n){"use strict";n.d(t,{k:function(){return b}});var i,r=n(63804),o=n.n(r),a=n(81470),s=n(17758),l=n(79549),c=n(93119),d=n(2199),u=n(48945),p=n(17217);!function(e){e[e.AllSelected=0]="AllSelected",e[e.SpecificRoleSelected=1]="SpecificRoleSelected",e[e.SelectedRoleListChange=2]="SelectedRoleListChange"}(i||(i={}));var m={fontFamily:"Segoe UI",fontStyle:"normal",fontWeight:"normal",fontSize:"14px",lineHeight:"146.31%",paddingTop:"10px",color:"#323130"},h={paddingTop:"12px",paddingLeft:"28px",width:"300px"},g={flexGrow:0,width:"300px",height:"34px",border:"1px solid",borderColor:"#A19F9D",boxSizing:"border-box",borderRadius:"2px"},f={display:"flex",alignItems:"center",paddingTop:"15px"},y={borderRadius:"50%",background:"#8764B8",color:"#FFFFFF",padding:"5px",width:"20px",textAlign:"center",lineHeight:"20px"},v={fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"20px",color:"#323130",paddingLeft:"8px",paddingRight:"8px"},C={paddingRight:"10px"},S={root:{width:"260px",height:"40px",padding:"8px",alignItems:"baseline"}},E={borderRadius:"50%",background:"#8764B8",color:"#FFFFFF",padding:"5px",width:"25px",textAlign:"center",lineHeight:"20px"},b=function(e){var t="all",n="specific",i=(0,r.useState)(e.isAllRolesSelected),b=i[0],w=i[1],D=(0,r.useState)([]),T=D[0],x=D[1],k=(0,r.useState)([]),_=k[0],N=k[1],L=(0,r.useState)([]),I=L[0],A=L[1],R=(0,r.useState)([]),F=R[0],P=R[1],M=function(){return o().createElement(a.J,{"data-is-focusable":!0,iconName:p.P.securityGroup.iconName,style:E})},O=o().useCallback((function(e){return e?e.map((function(e){return{key:e.roleid,text:e.name,styles:S,onRenderPersonaCoin:M}})):[]}),[]);(0,r.useEffect)((function(){A(O(e.isAllRolesSelected?[]:e.selectedRoles)),e.webAPI.retrieveMultipleRecords("role","?$select=roleid,name&$filter=_parentroleid_value eq null and name ne 'System Administrator' and name ne 'Support User'").then((function(e){var t,n;(null!==(n=null===(t=null==e?void 0:e.entities)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>0&&(P(e.entities),x(e.entities),N(O(e.entities)))})).catch((function(e){}))}),[]),(0,r.useEffect)((function(){A(O(e.isAllRolesSelected?[]:e.selectedRoles)),w(e.isAllRolesSelected)}),[O,e.isAllRolesSelected,e.selectedRoles]);var V=function(e,t){var n=new Set(e);return null==t||t.forEach((function(e){return n.delete(e)})),Array.from(n)},z=function(e){return e.sort((function(e,t){return e.text>t.text?1:-1}))},B=[{key:t,text:u.D.getLocalizedString("SecurityRolePicker_AllSecurityRoles")},{key:n,text:u.D.getLocalizedString("SecurityRolePicker_SpecificSecurityRoles")}],U=b?t:n,H=o().createElement(c.F,{options:B,label:u.D.getLocalizedString("SecurityRolePicker_SecurityRolesLabel"),selectedKey:U,onChange:function(i,r){var o,a=[],s=!1;switch(null==r?void 0:r.key){case t:w(s=!0),A(a);break;case n:w(s=!1),N(_)}var l=F.filter((function(e){return a.findIndex((function(t){return e.roleid===t.key}))>-1}));e.onSecurityRoleChanges&&(null===(o=e.onSecurityRoleChanges)||void 0===o||o.call(e,s,T,l))},style:m}),G=o().createElement("div",{style:h},o().createElement(d.CV,{onResolveSuggestions:function(e,t){if(e){var n=_.filter((function(t){return t.text.toLowerCase().includes(e.toLowerCase())}));return n=V(n,t),z(n)}return[]},onEmptyInputFocus:function(e){var t=_;return t=V(t,e),z(t)},getTextFromItem:function(e){return e.text},className:"ms-PeoplePicker",pickerSuggestionsProps:{suggestionsAvailableAlertText:u.D.getLocalizedString("SecurityRolePicker_SuggestionAvailable"),noResultsFoundText:u.D.getLocalizedString("SecurityRolePicker_NoRolesFound"),loadingText:u.D.getLocalizedString("SecurityRolePicker_LoadingRole"),suggestionsContainerAriaLabel:""},key:"list",onChange:function(t){var n=F.filter((function(e){return t.findIndex((function(t){return e.roleid===t.key}))>-1}));A(null!=t?t:[]),e.onSecurityRoleChanges&&e.onSecurityRoleChanges(b,T,n)},selectedItems:I,pickerCalloutProps:{directionalHint:0},inputProps:{placeholder:u.D.getLocalizedString("SecurityRolePicker_AddSecurityRole"),style:g,"aria-label":u.D.getLocalizedString("SecurityRolePicker_AddSecurityRole")},onRenderItem:function(e){var t=u.D.getLocalizedString("SecurityRolePicker_RemoveRole")+" "+e.item.text;return o().createElement("div",{style:{width:"100%"}},o().createElement("div",{"data-selection-invoke":!0,style:f},o().createElement(s.h,{iconProps:{iconName:p.P.closeIcon.iconName,style:{fontSize:12}},title:t,ariaLabel:t,onClick:e.onRemoveItem,id:"removeButton"+e.item.key}),o().createElement(a.J,{"data-is-focusable":!0,iconName:p.P.securityGroup.iconName,style:y}),o().createElement(l.x,{style:v}," ",e.item.text," ")))},disabled:b}));return o().createElement("div",{style:C},H,G)}},5535:function(e,t,n){"use strict";n.d(t,{MA:function(){return c}});var i,r=n(49037);!function(e){e[e.Basic=0]="Basic",e[e.Local=1]="Local",e[e.Deep=2]="Deep",e[e.Global=3]="Global"}(i||(i={}));var o=function(e){this.guid=e},a=function(){function e(e,t){this.Depth=e,this.PrivilegeId=t}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{Depth:{typeName:"Microsoft.Dynamics.CRM.PrivilegeDepth",structuralProperty:3,enumProperties:[{name:"Basic",value:0},{name:"Local",value:1},{name:"Deep",value:2},{name:"Global",value:3}]},PrivilegeId:{typeName:"Edm.Guid",structuralProperty:1}},operationName:"",operationType:void 0}},e}(),s=function(){function e(e,t){this.entity=e,this.Privileges=t}return e.prototype.getMetadata=function(){return{boundParameter:"entity",parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.role",structuralProperty:5},Privileges:{typeName:"mscrm.RolePrivilege",structuralProperty:4}},operationName:"AddPrivilegesRole",operationType:0}},e}(),l=function(){function e(e,t){this.entity=e,this.Privilege=t}return e.prototype.getMetadata=function(){return{boundParameter:"entity",parameterTypes:{entity:{typeName:"Microsoft.Dynamics.CRM.role",structuralProperty:5},Privilege:{typeName:"Microsoft.Dynamics.CRM.privilege",structuralProperty:5}},operationName:"RemovePrivilegeRole",operationType:0}},e}(),c=function(e,t,n){return(0,r.mG)(void 0,void 0,void 0,(function(){var c,d,u,p,m,h,g,f,y,v,C,S;return(0,r.Jh)(this,(function(E){switch(E.label){case 0:if(!n||0===n.privileges.length)throw"Requires Security Permission to update user security role";if(t||(t={isAllRoles:!1,selectedRoles:[]}),c="?$select=name,&$filter=name eq '"+n.privileges[0]+"'",n.privileges.length>1)for(m=1;m<n.privileges.length;m++)c=c+" or name eq '"+n.privileges[m]+"'";return[4,e.retrieveMultipleRecords("privilege",c)];case 1:return d=E.sent(),[4,e.retrieveMultipleRecords("role","?$select=roleid,name&$filter=_parentroleid_value eq null and name ne 'System Administrator' and name ne 'Support User'")];case 2:if(u=E.sent(),p="?$select=privilegeid,roleid&$filter=privilegeid eq "+d.entities[0].privilegeid,d.entities&&d.entities.length>1)for(m=1;m<d.entities.length;m++)p=p+" or privilegeid eq "+d.entities[m].privilegeid;return[4,e.retrieveMultipleRecords("roleprivileges",p)];case 3:if(h=E.sent(),!d.entities||!u.entities)return[3,7];for(g=[],f=[],y=function(e){d.entities.forEach((function(n){return(0,r.mG)(void 0,void 0,void 0,(function(){var c,d,u,p,m;return(0,r.Jh)(this,(function(r){return c=new a(i.Local,new o(n.privilegeid)),d=new l({id:e.roleid,entityType:"role"},{id:n.privilegeid,entityType:"privilege"}),u=new s({id:e.roleid,entityType:"role"},[c]),p=t.selectedRoles.filter((function(t){return t.roleid==e.roleid})),m=h.entities.filter((function(t){return t.roleid==e.roleid})),t.isAllRoles||p.length>0?0==m.length&&g.push(u):h.entities.filter((function(t){return t.roleid==e.roleid})).length>0&&f.push(d),[2]}))}))}))},v=0,C=u.entities;v<C.length;v++)S=C[v],y(S);return g.length>0?[4,e.executeMultiple(g)]:[3,5];case 4:E.sent(),E.label=5;case 5:return f.length>0?[4,e.executeMultiple(f)]:[3,7];case 6:E.sent(),E.label=7;case 7:return[2]}}))}))}},48327:function(e,t,n){"use strict";n.d(t,{G:function(){return d}});var i=n(49037),r=n(63804),o=n.n(r),a=n(36711),s=n(48909),l=n(9777),c=n(47558),d=function(e){var t,n,r,d=e.collapsible,u=e.title,p=(0,i._T)(e,["collapsible","title"]);return o().createElement("div",{style:c.gn.dealManagerSettingContainer},d&&o().createElement(l.z,(0,i.pi)({title:u,titleStyle:c.gn.dealManagerSettingsSubtitle,subtitle:e.subtitle,subtitleStyle:c.gn.dealManagerSettingsDescription,iconTitleGap:16,contentGap:0,shouldPadLeft:!0},p),e.children),!d&&o().createElement(a.Stack,null,o().createElement("div",{style:{paddingBottom:null!==(t=e.contentGap)&&void 0!==t?t:0}},o().createElement(s.Text,{block:!0,style:null!==(n=e.titleStyle)&&void 0!==n?n:c.gn.dealManagerSettingsSubtitle},e.title),e.subtitle&&o().createElement(s.Text,{block:!0,style:null!==(r=e.subtitleStyle)&&void 0!==r?r:c.gn.dealManagerSettingsDescription},e.subtitle),e.children)))}},50092:function(e,t,n){"use strict";n.d(t,{MZ:function(){return l},wv:function(){return c},RH:function(){return d},NA:function(){return u},Kd:function(){return p}});var i=n(49037),r=n(82361),o=n(5535),a=n(76614),s="msdyn_dealmanagersettings",l=function(e,t,n){return(0,i.mG)(void 0,void 0,void 0,(function(){var r,l,c;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:(c={}).msdyn_data=JSON.stringify(n),r=c,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,(0,o.MA)(e,n.rolesSettings,{privileges:[a.g.dealManagerAccessPrivilege,a.g.dealManagerReadPrivilege]})];case 2:return i.sent(),[4,e.updateRecord(s,t,r)];case 3:return i.sent(),[2,!0];case 4:return l=i.sent(),console.error("DealManagerSettings could not update settings in dataverse\n",l),[2,!1];case 5:return[2]}}))}))},c=function(e){return(0,i.mG)(void 0,void 0,Promise,(function(){var t,n,r,o,a;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e.retrieveMultipleRecords(s,"?$select=msdyn_data,msdyn_dealmanagersettingsid")];case 1:return(t=i.sent())?0===t.entities.length?(console.error("[DealManagerSettings] No msdyn_dealmanagersettings entities available"),[2]):t.entities.length>1?(console.error("[DealManagerSettings] There are "+t.entities.length+" msdyn_dealmanagersettings entities. There should only be 1."),[2]):(n=t.entities[0],r=n.msdyn_data,(o=r?JSON.parse(r):void 0)?[2,{settings:o,id:n.msdyn_dealmanagersettingsid}]:(console.error("[DealManagerSettings] There was an issue parsing the settings object received from dataverse"),[2])):(console.error("[DealManagerSettings] Undefined response from server when fetching settings"),[2]);case 2:return a=i.sent(),console.error("DealManagerSettings could not fetch settings from dataverse\n",a),[2];case 3:return[2]}}))}))},d=function(e,t,n){return(0,i.mG)(void 0,void 0,void 0,(function(){var l,c,d,u,p,m,h,g,f,y,v,C;return(0,i.Jh)(this,(function(S){switch(S.label){case 0:return S.trys.push([0,11,,12]),[4,e.retrieveMultipleRecords(s,"?$select=msdyn_data,msdyn_dealmanagersettingsid")];case 1:return(l=S.sent())?(c=n?r.Sg:r.he,(v={}).msdyn_data=JSON.stringify(c),d=v,u={privileges:[a.g.dealManagerAccessPrivilege,a.g.dealManagerReadPrivilege]},0!==l.entities.length?[3,4]:[4,e.createRecord(s,d)]):(console.error("[DealManagerSettings] Undefined response from server when initializing default settings. Default settings NOT created."),[2]);case 2:return p=S.sent(),[4,(0,o.MA)(e,r.he.rolesSettings,u)];case 3:return S.sent(),[2,p.id];case 4:return m=l.entities[0].msdyn_dealmanagersettingsid,t?[3,7]:[4,e.updateRecord(s,m,d)];case 5:return f=S.sent(),[4,(0,o.MA)(e,r.he.rolesSettings,u)];case 6:return S.sent(),[2,f.id];case 7:return h=(0,i.pi)((0,i.pi)({},t),{isDealManagerPreviewEnabled:!0}),(C={}).msdyn_data=JSON.stringify(h),g=C,[4,e.updateRecord(s,m,g)];case 8:return f=S.sent(),[4,(0,o.MA)(e,h.rolesSettings,u)];case 9:return S.sent(),[2,f.id];case 10:return[3,12];case 11:return y=S.sent(),console.error("DealManagerSettings could not fetch settings from dataverse\n",y),[2];case 12:return[2]}}))}))},u=function(e,t,n){return(0,i.mG)(void 0,void 0,void 0,(function(){var r,l,c,d;return(0,i.Jh)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),[4,(0,o.MA)(e,{isAllRoles:!1,selectedRoles:[]},{privileges:[a.g.dealManagerAccessPrivilege,a.g.dealManagerReadPrivilege]})];case 1:return u.sent(),r=(0,i.pi)((0,i.pi)({},n),{isDealManagerPreviewEnabled:!1}),(d={}).msdyn_data=JSON.stringify(r),l=d,[4,e.updateRecord(s,t,l)];case 2:return u.sent(),[2,!0];case 3:return c=u.sent(),console.error("DealManagerSettings could not complete opt out process\n",c),[2,!1];case 4:return[2]}}))}))},p=function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){var t,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e.retrieveMultipleRecords("solution","?$select=uniquename&$filter=uniquename eq 'SalesInsightsAddOn'")];case 1:return[2,0!==(null==(t=i.sent())?void 0:t.entities.length)];case 2:return n=i.sent(),console.error("Issue checking if org has SI\n",n),[2,!1];case 3:return[2]}}))}))}},81117:function(e,t,n){"use strict";n.d(t,{x:function(){return f}});var i=n(49037),r=n(63804),o=n.n(r),a=n(53205),s=n(91847),l=n(87018),c=n(43118),d=n(47558),u=n(50092),p=n(47095),m=n(48945),h=n(76614),g={position:"relative",top:0,right:0,width:"50%",objectFit:"contain",objectPosition:"top"},f=function(e){var t=e.webAPI,n=e.onInitialized,f=e.settings,y=(0,r.useState)(!1),v=y[0],C=y[1];return o().createElement(s.Stack,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:"10vw"},style:d.gn.dealManagerSettingsMainStack},o().createElement("div",null,o().createElement(a.Text,{block:!0,style:d.gn.dealManagerSettingsPageTitle},m.D.getLocalizedString("AS_Onboarding_Title")),o().createElement(a.Text,{block:!0,style:(0,i.pi)((0,i.pi)({},d.gn.dealManagerSettingsDescription),{paddingBottom:"32px"})},m.D.getLocalizedString("AS_Onboarding_Desc")+" ",o().createElement(p.r,{content:m.D.getLocalizedString("AS_Learn_More"),href:"https://go.microsoft.com/fwlink/?linkid=2166462",openInNewTab:!0})),o().createElement(s.Stack,{horizontal:!0,tokens:{childrenGap:8}},o().createElement(l.PrimaryButton,{styles:d.$Y,text:m.D.getLocalizedString("AS_Get_Started"),iconProps:{iconName:"Rocket"},onClick:function(){return(0,i.mG)(void 0,void 0,void 0,(function(){var e,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return C(!0),[4,(0,u.Kd)(t)];case 1:return e=i.sent(),[4,(0,u.RH)(t,f,e)];case 2:return(r=i.sent())?[4,m.D.SaveSetting(h.g.dealManagerOptInSettingsKey,!0)]:(console.error("[DealManagerSettings] Could not initialize default settings"),[2]);case 3:return i.sent(),C(!1),n(f?void 0:r),[2]}}))}))},disabled:v}),v&&o().createElement(c.Spinner,null))),o().createElement("img",{style:g,src:"/webresources/msdyn_/Images/OnboardingIllustration.svg"}))}},31627:function(e,t,n){"use strict";n.d(t,{K:function(){return x}});var i=n(49037),r=n(63804),o=n.n(r),a=n(81508),s=n(99284),l=n(25813),c=n(3166),d=n(45997),u=n(69876),p=n(9433),m=n(59144),h=n(79549),g=n(17758),f=n(94005),y=n(24006),v=n(84843),C=n(84563),S=n(43216),E=n(41380),b=n(21396),w=n(76765),D=n(48945),T=n(28197),x=function(e){function t(t){var n=e.call(this,t)||this;n.PAGE_SIZE=50,n.localizedStrings={displayNameColumnHeader:D.D.getLocalizedString("AS_WebResourceDialog_Display_Name"),nameColumnHeader:D.D.getLocalizedString("AS_WebResourceDialog_Name"),addButton:D.D.getLocalizedString("Add"),cancelButton:D.D.getLocalizedString("Cancel"),addLibraryButton:D.D.getLocalizedString("AS_WebResources_Add_Library"),searchPlaceholder:D.D.getLocalizedString("Search"),detailListAriaLabel:D.D.getLocalizedString("AS_WebResources_List_Aria_Label"),loading:D.D.getLocalizedString("InContextView_Loading"),showMore:D.D.getLocalizedString("Show_More"),noResults:D.D.getLocalizedString("AS_WebResources_No_Results")},n._addWebResourceClick=function(){n.state.selectedWebResources&&(n.props.onWebResourcesChange([n.state.selectedWebResources[0]]),n.setState({hideDialog:!0}))},n.addJsLibraryHandler=function(){n.setState({hideDialog:!1})},n.closeDialog=function(){n.setState({hideDialog:!0})},n.loadNextPage=function(){n.setState({pageNumber:n.state.pageNumber+1},(function(){n.loadPage(n.state.pageNumber)}))};var i=[{key:"displaynamecol",name:n.localizedStrings.displayNameColumnHeader,fieldName:"displayName",minWidth:225,maxWidth:250,isResizable:!0,data:"string"},{key:"namecol",name:n.localizedStrings.nameColumnHeader,fieldName:"name",minWidth:250,maxWidth:300,isResizable:!0,data:"string"}];return n.state={webResourceDetails:[],columns:i,selectedWebResources:[],hideDialog:!0,pageNumber:0,pagingCookie:"",searchText:"",loading:!1,showLoadMoreBtn:!1},n._selectedWebResource=new a.Y({onSelectionChanged:function(){var e=n._selectedWebResource.getSelection();n.setState({selectedWebResources:e})}}),n}return(0,i.ZT)(t,e),t.prototype.componentDidMount=function(){this.loadInitialPage()},t.prototype.render=function(){var e,t=this.localizedStrings.addButton,n=this.localizedStrings.cancelButton,i=this.state.webResourceDetails.length<1||this.state.selectedWebResources.length<1;return o().createElement("div",null,this.renderWebResourceSelectorControl(),o().createElement(s.V,{hidden:this.state.hideDialog,onDismiss:this.closeDialog,maxWidth:1020,styles:{main:{selectors:(e={},e["@media (min-width: 480px)"]={width:820},e)}},dialogContentProps:{type:l.i.normal,title:this.localizedStrings.addLibraryButton}},this.renderSearchBox(),this.renderDetailList(),o().createElement(c.c,null,o().createElement(d.PrimaryButton,{title:t,disabled:i,onClick:this._addWebResourceClick,text:t}),o().createElement(u.DefaultButton,{title:n,onClick:this.closeDialog,text:n}))))},t.prototype.renderWebResourceSelectorControl=function(){var e=this,t=this.props.webResources&&this.props.webResources.length>0?this.props.webResources[0]:null;return t?o().createElement(p.K,{horizontal:!0},o().createElement(m.xu,{iconName:"JS",className:w.JQ.iconClass}),o().createElement(h.x,{className:w.JQ.selectedWebResourceName,title:t.displayName?t.displayName:t.name},t.displayName?t.displayName:t.name),o().createElement(g.h,{className:w.JQ.iconClass,onClick:function(){e.props.onWebResourcesChange([])},iconProps:w.J1,title:this.localizedStrings.cancelButton,ariaLabel:this.localizedStrings.cancelButton})):o().createElement(u.DefaultButton,{text:this.localizedStrings.addLibraryButton,iconProps:w.Ef,onClick:this.addJsLibraryHandler})},t.prototype.renderSearchBox=function(){var e=this,t={placeholder:this.localizedStrings.searchPlaceholder,styles:w.bS,onSearch:function(t){return e.onChangeSearchBoxHandler(t)},onClear:function(){return e.onChangeSearchBoxHandler("")}};return o().createElement(f.R,(0,i.pi)({},t,{role:"searchbox",ariaLabel:this.localizedStrings.searchPlaceholder,value:this.state.searchText}))},t.prototype.onChangeSearchBoxHandler=function(e){(!e&&!this.state.loading||e!==this.state.searchText||e===this.state.searchText&&!this.state.loading)&&this.loadInitialPage(e)},t.prototype.renderDetailList=function(){var e,t=this.state,n=t.columns,i=t.webResourceDetails;return o().createElement("div",{className:w.JQ.webResourcesDetailList,"data-is-scrollable":"true"},this.state.webResourceDetails&&this.state.webResourceDetails.length>0&&o().createElement(y.W,{items:i,columns:n,selectionMode:v.oW.single,layoutMode:C.Oh.justified,isHeaderVisible:!0,selection:this._selectedWebResource,checkboxVisibility:C.tY.hidden,ariaLabelForGrid:this.localizedStrings.detailListAriaLabel,onRenderDetailsHeader:function(e,t){return o().createElement(S.L,null,null==t?void 0:t(e))}}),o().createElement(p.K,{style:{height:(null===(e=this.state.webResourceDetails)||void 0===e?void 0:e.length)<1?"100%":void 0},verticalAlign:"center"},this.state.loading&&o().createElement("div",{className:w.JQ.webResourcesLoadMessageDetail},o().createElement(E.$,{label:this.localizedStrings.loading,ariaLive:"assertive",size:b.E.large})),!this.state.loading&&this.state.webResourceDetails&&this.state.webResourceDetails.length<1&&o().createElement("div",{className:w.JQ.webResourcesEmptyResultsMessage},o().createElement(h.x,null,this.localizedStrings.noResults)),!this.state.loading&&this.state.showLoadMoreBtn&&o().createElement(p.K,{horizontalAlign:"center"},o().createElement(u.DefaultButton,{className:w.JQ.webResourcesLoadMoreButton,title:this.localizedStrings.showMore,onClick:this.loadNextPage,disabled:!this.state.showLoadMoreBtn},this.localizedStrings.showMore))))},t.prototype.loadInitialPage=function(e){var t=this;this.setState({pagingCookie:"",pageNumber:1,webResourceDetails:[],searchText:e},(function(){t.loadPage(1)}))},t.prototype.loadPage=function(e){var t=this,n=this.state.searchText;this.setState({loading:!0}),(0,T.S)(this.props.axiosInstance,e,this.PAGE_SIZE,this.state.pagingCookie,n).then((function(r){if(t.state.pageNumber===e&&t.state.searchText===n&&r){var o=[];r.webResourceDetails&&r.webResourceDetails.forEach((function(e){o.push({id:e.id,name:e.name,displayName:e.displayName})})),t.setState({webResourceDetails:(0,i.pr)(t.state.webResourceDetails,o),pagingCookie:k(r.pagingCookie),loading:!1,showLoadMoreBtn:r.hasMoreRecords})}})).catch((function(i){D.D.reportError("Error occurred while fetching web resource data from server",i,"",{}),t.state.pageNumber===e&&t.state.searchText===n&&t.setState({loading:!1})}))},t}(o().Component);function k(e){try{if(e){var t=(new DOMParser).parseFromString(e,"text/xml").documentElement.getAttribute("pagingcookie");if(null!==t)return decodeURIComponent(decodeURIComponent(t))}}catch(t){D.D.reportError("Error occured while extracing paging cookie",t,"",{Cookievalue:e})}return""}},76765:function(e,t,n){"use strict";n.d(t,{JQ:function(){return o},Ef:function(){return a},J1:function(){return s},bS:function(){return l}});var i=n(17754),r=n(19608),o={webResourcesDetailList:(0,r.mergeStyles)({maxHeight:"448px",minHeight:"448px",height:448,overflowY:"auto",overflowX:"hidden"}),webResourcesLoadMessageDetail:(0,r.mergeStyles)({marginTop:"16px"}),webResourcesEmptyResultsMessage:(0,r.mergeStyles)({textAlign:"center"}),webResourcesLoadMoreButton:(0,r.mergeStyles)({marginTop:"16px"}),selectedWebResourceName:(0,r.mergeStyles)({margin:"8px 10px 8px 0px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:"14px",lineHeight:"20px",left:"36px"}),iconClass:(0,r.mergeStyles)({fontSize:"16px",height:"16px",width:"16px",margin:"10px",lineHeight:"16px"})},a={iconName:"Add",styles:{root:{color:i.rQ.palette.themePrimary}}},s={iconName:"Cancel",styles:{root:{color:i.rQ.palette.neutralSecondary}}},l={root:{width:"225px"}}},28197:function(e,t,n){"use strict";n.d(t,{S:function(){return r}});var i=n(48945),r=function(e,t,n,r,a){return new Promise((function(s,l){var c='<fetch version="1.0" output-format="xml-platform" mapping="logical" returntotalrecordcount="true" >';if(c+='<entity name="webresource" >',c+='<attribute name="name" />',c+='<attribute name="displayname" />',c+='<order attribute="name" descending="false" />',a){var d='<filter type="and"><filter type="or">';d+='<condition attribute="name" value="%'+a+'%" operator="like"/>',d+='<condition attribute="displayname" value="%'+a+'%" operator="like"/>',c+=d+="</filter></filter>"}c+='<filter type="and"><condition attribute="webresourcetype" operator="eq" value="3" /></filter>',c+="</entity>",c=o(c+="</fetch>",n,t,r);var u={method:"GET",url:"api/data/v9.0/webresourceset"+(c="?fetchXml="+encodeURIComponent(c)),headers:{Prefer:'odata.include-annotations="*"'}};e.request(u).then((function(e){var t=[],n={};e&&e.data&&e.data.value&&e.data.value.length>0&&(e.data.value.forEach((function(e){t.push({name:e.name,id:e.webresourceid,displayName:e.displayname})})),n={webResourceDetails:t,pagingCookie:e.data["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"],totalRecordsCount:e.data["@odata.count"],hasMoreRecords:e.data["@Microsoft.Dynamics.CRM.morerecords"]}),s(n)}),(function(e){i.D.reportError("An error occured while fetching web resource details set",e,"",{}),l(e)}))}))},o=function(e,t,n,i){var r=(new DOMParser).parseFromString(e,"text/xml"),o=r.documentElement.attributes;if(i){var a=r.createAttribute("paging-cookie");a.value=i||"",o.setNamedItem(a)}var s=r.createAttribute("page");s.value=n.toString(),o.setNamedItem(s);var l=r.createAttribute("count");l.value=t.toString(),o.setNamedItem(l);var c=r.createAttribute("returntotalrecordcount");return c.value="true",o.setNamedItem(c),(new XMLSerializer).serializeToString(r)}},82361:function(e,t,n){"use strict";n.d(t,{he:function(){return s},Jf:function(){return l},Sg:function(){return c},zl:function(){return d},j0:function(){return u}});var i=n(49037),r={id:"dealTracker",type:"bubble",chartName:void 0,xAxisFieldConfig:[{entityName:"opportunity",fieldName:"estimatedclosedate"},{entityName:"opportunity",fieldName:"actualclosedate"}],yAxisFieldConfig:{entityName:"opportunity",fieldName:"closeprobability"},bubbleSizeFieldConfig:[{entityName:"opportunity",fieldName:"estimatedvalue"},{entityName:"opportunity",fieldName:"actualvalue"}],status:!0,segmentedByFieldConfig:{entityName:"opportunity",fieldName:"stepname"},sortLegendType:"startToFinish",colorPalette:"categorical",tooltipFieldNames:[{fieldConfig:{entityName:"opportunity",fieldName:"customerid"},visibility:"always"},{fieldConfig:{entityName:"opportunity",fieldName:"statecode"},visibility:"always"},{fieldConfig:{entityName:"opportunity",fieldName:"stepname"},visibility:"always"},{fieldConfig:{entityName:"opportunity",fieldName:"estimatedvalue"},visibility:"openRecordOnly"},{fieldConfig:{entityName:"opportunity",fieldName:"actualvalue"},visibility:"closedRecordOnly"},{fieldConfig:{entityName:"opportunity",fieldName:"estimatedclosedate"},visibility:"openRecordOnly"},{fieldConfig:{entityName:"opportunity",fieldName:"actualclosedate"},visibility:"closedRecordOnly"}]},o=(0,i.pi)((0,i.pi)({},r),{yAxisFieldConfig:{entityName:"msdyn_predictivescore",fieldName:"msdyn_score"},segmentedByFieldConfig:{entityName:"msdyn_predictivescore",fieldName:"msdyn_grade"},colorPalette:"health",tooltipFieldNames:[{fieldConfig:{entityName:"opportunity",fieldName:"customerid"},visibility:"always"},{fieldConfig:{entityName:"opportunity",fieldName:"estimatedvalue"},visibility:"openRecordOnly"},{fieldConfig:{entityName:"opportunity",fieldName:"actualvalue"},visibility:"closedRecordOnly"},{fieldConfig:{entityName:"opportunity",fieldName:"estimatedclosedate"},visibility:"openRecordOnly"},{fieldConfig:{entityName:"opportunity",fieldName:"actualclosedate"},visibility:"closedRecordOnly"},{fieldConfig:{entityName:"msdyn_predictivescore",fieldName:"msdyn_score"},visibility:"always"},{fieldConfig:{entityName:"msdyn_predictivescore",fieldName:"msdyn_grade"},visibility:"always"}]}),a={id:"salesFunnel",type:"funnel",chartName:void 0,status:!0,segmentedByFieldConfig:{entityName:"opportunity",fieldName:"stepname"},sortLegendType:"startToFinish",colorPalette:"categorical",aggregationType:"sum",valuesFieldConfig:{entityName:"opportunity",fieldName:"estimatedvalue"},tooltipFieldNames:[{fieldConfig:{entityName:"opportunity",fieldName:"estimatedvalue"},visibility:"openRecordOnly"},{fieldConfig:{entityName:"opportunity",fieldName:"actualvalue"},visibility:"closedRecordOnly"}]},s={isDealManagerPreviewEnabled:!0,charts:[r,a],rolesSettings:{isAllRoles:!1,selectedRoles:[]},webResources:[]},l=(0,i.pi)((0,i.pi)({},s),{charts:[]}),c=(0,i.pi)((0,i.pi)({},s),{charts:[o,a]}),d=function(e,t,n){return(0,i.pi)((0,i.pi)({},e),{charts:e.charts.map((function(e){return"dealTracker"!==e.id||e.chartName?"salesFunnel"!==e.id||e.chartName?e:(0,i.pi)((0,i.pi)({},e),{chartName:n}):(0,i.pi)((0,i.pi)({},e),{chartName:t})}))})},u={customerid:"always",statecode:"always",stepname:"always",estimatedvalue:"openRecordOnly",actualvalue:"closedRecordOnly",estimatedclosedate:"openRecordOnly",actualclosedate:"closedRecordOnly"}},32955:function(e,t,n){"use strict";n.d(t,{Fs:function(){return l},YS:function(){return c},Mv:function(){return d},DH:function(){return u},oj:function(){return p},sZ:function(){return m},Jb:function(){return h},D1:function(){return g},bS:function(){return f},xb:function(){return y},Vl:function(){return v},Q8:function(){return C},gY:function(){return S},Yp:function(){return E},qE:function(){return b},iI:function(){return w},wV:function(){return D},pF:function(){return T},OL:function(){return x},Uk:function(){return k}});var i=n(19608),r=n(56569),o=n(17754),a=n(94589),s=n(54988),l=(0,i.mergeStyles)({borderBottom:"1px solid #ccc",flex:"0 0 auto"}),c=(0,i.mergeStyles)({display:"flex",flexDirection:"column",position:"relative",top:"0",bottom:"0",width:328,maxHeight:360}),d=(0,i.mergeStyles)({flex:"0 0 auto"}),u=(0,i.mergeStyles)(r.p(),{position:"relative",overflowY:"auto",overflowX:"hidden",height:"100%"}),p=(0,i.mergeStyles)({background:"transparent",paddingTop:8,paddingBottom:8,fontSize:16,lineHeight:16}),m={width:16,height:16,fontSize:16,lineHeight:16,fontWeight:a.lq.bold,color:o.rQ.palette.neutralPrimary+" !important"},h={fieldGroup:{height:36},suffix:{paddingRight:28}},g={fieldGroup:{height:36},suffix:{background:"transparent",padding:0,marginRight:20}},f={root:{borderWidth:"0px 0px 0px","&:hover":{borderBottom:"1px solid "+o.rQ.palette.neutralPrimary}}},y={root:{color:"rgb(96,94,92)"}},v={label:{textAlign:"center",color:o.rQ.palette.neutralPrimary}},C={root:{height:"60%",lineHeight:"60%",padding:5,marginBottom:-5}},S=(0,i.mergeStyles)({width:"100%",height:36,textAlign:"left",color:o.WB.dynPrimary,"&:hover":{color:o.WB.dynShade20}}),E=(0,i.mergeStyles)({color:o.WB.dynPrimary,"&:hover":{color:o.WB.dynShade20}}),b=(0,i.mergeStyles)({border:0,borderTop:"1px solid "+o.rQ.palette.neutralQuaternaryAlt,boxSizing:"border-box"}),w={childrenGap:6},D={padding:"12px 16px 12px 16px"},T={root:{color:s.iX.gray130},rootHovered:{color:s.iX.gray130},icon:{fontSizes:8}},x=(0,i.mergeStyles)({fontWeight:a.lq.bold}),k=(0,i.mergeStyles)({fontSize:i.FontSizes.size20,color:s.iX.gray160,fontWeight:a.lq.semibold})},23517:function(e,t,n){"use strict";n.d(t,{n:function(){return w}});var i=n(49037),r=n(63804),o=n.n(r),a=n(87018),s=n(51848),l=n(99506),c=n(85683),d=n(48945),u=n(30443),p=n(28741),m=n(65597),h=n(75821),g=n(39780),f=n(32955),y=n(79392),v=n(49258),C=n(42093),S=n(36711),E=n(71520),b=function(e,t){return o().createElement(o().Fragment,null,[t.renderItemName(e),o().createElement(l.Label,{styles:f.Q8}),t.renderItemIcon(e),e.item.updateButton,e.item.spinner,e.item.pinButton])},w=function(e){var t=e.viewList,n=e.onViewSelected,r=e.selectedView,l=e.viewHasChanges,w=e.setViewHasChanges,D=e.isSaveUpdateFeatureEnabled,T=(0,c.R)("pinnedViewIds",[]),x=T[0],k=T[1],_=(0,c.$)(x),N=_[0],L=_[1],I=_[2],A=o().useState(),R=A[0],F=A[1],P=o().useState({isLoading:!1,newViewName:void 0,showSaveButton:!0}),M=P[0],O=P[1],V=o().useState({isLoading:!1}),z=V[0],B=V[1],U=o().useCallback((function(e,t){d.D.reportUserAction("updateView","EntityViewSelector","Update entity View",{id:e},"Update",e),setTimeout((function(){var n,r;console.log("updaing view with id: "+e),w(!1),B((0,i.pi)((0,i.pi)({},z),{isLoading:!1})),null===(r=null===(n=window.Xrm)||void 0===n?void 0:n.UI)||void 0===r||r.addGlobalNotification(1,1,d.D.getLocalizedString("WS_ViewSelector_Update_Toast_Message",t),null,null,null)}),3e3),B((0,i.pi)((0,i.pi)({},z),{isLoading:!0})),console.log("updated view with id: "+e)}),[w,z]),H=o().useCallback((function(e){d.D.reportUserAction("saveNewView","EntityViewSelector","Save new entity View",{name:e},"Create",e||""),setTimeout((function(){console.log("saving new view, name:"+e),w(!1),O((0,i.pi)((0,i.pi)({},M),{isLoading:!1,showSaveButton:!0,newViewName:void 0}))}),3e3),O((0,i.pi)((0,i.pi)({},M),{isLoading:!0})),console.log("saved new view, name:"+e)}),[M,w]);o().useEffect((function(){var e;if(void 0===r){var i=u.C.get("entityView"),o=null!==(e=t.find((function(e){return e.id===i})))&&void 0!==e?e:null==t?void 0:t[0];o&&n(o)}}),[n,r,t]),o().useEffect((function(){N!==x&&k(N)}),[N,x,k]);var G=o().useMemo((function(){return R?t.filter((function(e){return-1!==e.name.toLocaleLowerCase().indexOf(R)})):t}),[t,R]),W=function(e){var t=e===p.gT.commandBarButtonLocation?"WS_ViewSelector_Unsaved_Changes_Tooltip":"WS_ViewSelector_Update_Button_Tooltip";return o().createElement(S.Stack,{tokens:f.iI,style:f.wV},o().createElement("p",null,d.D.getLocalizedString(t)))},j=o().useMemo((function(){var e=[],t=[],c=[],m=[],g=function(e,t){return o().createElement(C.TooltipHost,{content:W(p.gT.updateButtonLocation),id:"updateViewToolTip",calloutProps:{directionalHint:h.DirectionalHint.rightCenter,calloutMaxWidth:194,calloutMaxHeight:88}},o().createElement(a.ActionButton,{className:f.Yp,onClick:function(n){n.stopPropagation(),U(e,t)},ariaLabel:d.D.getLocalizedString("WS_Update")},d.D.getLocalizedString("WS_Update")))},S=function(e){return o().createElement(a.IconButton,{iconProps:{iconName:"Pin",styles:f.xb},title:d.D.getLocalizedString("WS_EntitySelector_Pin"),ariaLabel:d.D.getLocalizedString("WS_EntitySelector_Pin"),onClickCapture:function(t){t.stopPropagation(),L(e)}})},E=d.D.getLocalizedString("WS_ViewSelector_SystemView"),w=d.D.getLocalizedString("WS_ViewSelector_PersonalView");return G.forEach((function(t){var s,p=N.includes(t.id),h=!z.isLoading&&l&&"system"!=t.kind&&(null==r?void 0:r.id)===t.id,C=(0,i.pi)((0,i.pi)({},t),{key:t.id,onRenderContent:b,secondaryText:"system"===t.kind?E:w,pinButton:p?(s=t.id,o().createElement(a.IconButton,{iconProps:{iconName:"PinnedSolid",styles:f.xb},title:d.D.getLocalizedString("WS_EntitySelector_Remove_Pin"),ariaLabel:d.D.getLocalizedString("WS_EntitySelector_Remove_Pin"),onClickCapture:function(e){e.stopPropagation(),I(s)}})):S(t.id),updateButton:h?g(t.id,t.name):null,spinner:(null==r?void 0:r.id)===t.id&&z.isLoading?o().createElement(y.Spinner,{size:v.SpinnerSize.small}):null,onClick:function(){d.D.reportUserAction("switchEntityView","EntityViewSelector","Switch entity view",{id:t.id,name:t.name},"Update",t.name),u.C.set("entityView",t.id),n(t)},disabled:l&&"system"!=t.kind&&(null==r?void 0:r.id)===t.id&&z.isLoading});p?e.push(C):"system"===t.kind?m.push(C):c.push(C)})),e.length>0&&e.unshift({key:"pinnedViewsHeader",text:d.D.getLocalizedString("WS_EntitySelector_Pinned_Views"),itemType:s.ContextualMenuItemType.Header}),m.length>0&&m.unshift({key:"systemViewsHeader",text:d.D.getLocalizedString("WS_EntitySelector_System_Views"),itemType:s.ContextualMenuItemType.Header}),c.length>0&&c.unshift({key:"personalViewsHeader",text:d.D.getLocalizedString("WS_EntitySelector_Personal_Views"),itemType:s.ContextualMenuItemType.Header}),0===e.length&&0===c.length&&0===m.length&&t.push({key:"noViews",text:d.D.getLocalizedString("WS_EntitySelector_No_Views"),itemType:s.ContextualMenuItemType.Header,itemProps:{styles:f.Vl}}),e.concat(c,m,t)||[]}),[G,U,L,I,N,z.isLoading,l,null==r?void 0:r.id,n]),X=o().createElement(a.CommandBarButton,{iconProps:{iconName:"Add"},text:d.D.getLocalizedString("WS_ViewSelector_Save_Button_Text"),onClick:function(e){e.stopPropagation(),O((0,i.pi)((0,i.pi)({},M),{showSaveButton:!1}))},primary:!0,className:f.gY,ariaLabel:d.D.getLocalizedString("WS_Save")}),K=function(e){e.preventDefault(),O((0,i.pi)((0,i.pi)({},M),{newViewName:e.target.value,showSaveButton:!0}))},q=o().createElement(E.TextField,{styles:M.isLoading?f.Jb:f.D1,placeholder:d.D.getLocalizedString("WS_ViewSelector_SaveNewView_TextField_Placeholder"),value:M.newViewName,onChange:function(e){O((0,i.pi)((0,i.pi)({},M),{newViewName:e.target.value}))},onKeyDown:function(e){e.stopPropagation(),"Escape"==e.key?(e.preventDefault(),O((0,i.pi)((0,i.pi)({},M),{newViewName:void 0,showSaveButton:!1}))):"Enter"==e.key&&""!==M.newViewName&&void 0!==M.newViewName&&(e.preventDefault(),H(M.newViewName))},disabled:M.isLoading,onRenderSuffix:function(e){return M.isLoading?o().createElement(y.Spinner,{size:v.SpinnerSize.small}):o().createElement(a.IconButton,{iconProps:{iconName:"Cancel",styles:f.pF},onClick:K,ariaLabel:d.D.getLocalizedString("WS_Close")})}}),Z=M.showSaveButton?X:q,J=o().useCallback((function(e,t){return o().createElement("div",{className:f.YS},o().createElement("div",{className:f.Fs},o().createElement(m.SearchBox,{ariaLabel:d.D.getLocalizedString("WS_EntitySelector_Search"),placeholder:d.D.getLocalizedString("WS_EntitySelector_Search"),underlined:!0,styles:f.bS,onChange:function(e,t){return F(null==t?void 0:t.toLocaleLowerCase())}}),R&&o().createElement(g.O,{message:1===G.length?d.D.getLocalizedString("WS_EntitySelector_Search_Singular_Count",G.length):d.D.getLocalizedString("WS_EntitySelector_Search_Multiple_Count",G.length)}),D&&o().createElement(a.IconButton,{iconProps:{iconName:"edit",styles:f.xb},onClickCapture:function(e){e.stopPropagation(),w(!l)}})),o().createElement("div",{className:f.DH},t(e)),D&&o().createElement(o().Fragment,null,o().createElement("hr",{className:f.qE}),o().createElement("div",{className:f.Mv},Z)))}),[G.length,D,Z,R,w,l]),Q=o().useMemo((function(){return{onRenderMenuList:J,shouldFocusOnMount:!0,items:j||Object.assign([]),directionalHint:h.DirectionalHint.bottomAutoEdge,directionalHintFixed:!0,onDismiss:function(){F(void 0),O((0,i.pi)((0,i.pi)({},M),{showSaveButton:!0}))}}}),[j,J,M]),Y=l?(null==r?void 0:r.name)+"*":null==r?void 0:r.name;return j&&r?o().createElement(C.TooltipHost,{content:W(p.gT.commandBarButtonLocation),id:"entityViewTooltip",calloutProps:{directionalHint:h.DirectionalHint.bottomCenter,calloutMaxWidth:194,calloutMaxHeight:56,hidden:!l}},o().createElement(a.CommandBarButton,{text:Y,className:f.oj,menuProps:Q,styles:{menuIcon:f.sZ},onRenderText:function(e){return o().createElement("span",null,o().createElement("span",{className:f.Uk},r.name||""),l&&o().createElement("span",{className:f.OL},"*"))}})):null}},84793:function(e,t,n){"use strict";n.d(t,{l:function(){return i}});var i=(0,n(19608).mergeStyleSets)({root:{width:"100%",padding:"8px 0px"},name:{fontfamily:"Segoe UI",fontweight:"600",fontSize:"14px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",lineHeight:"16px",flexGrow:1,height:"18px"},icon:{fontSize:"16px",height:"16px",width:"16px",lineHeight:"16px",margin:"6px",marginLeft:0},disabledIcon:{fill:"rgb(161, 159, 157)"},commandsList:{height:"100%"},actionButton:{height:"48px",overflow:"hidden",whiteSpace:"nowrap",flexGrow:1,textOverflow:"ellipsis",selectors:{"@media screen and (-ms-high-contrast: white-on-black)":{selectors:{":focus":{outline:"3px solid #fff"}}}}},dataTypeStyle:{fontfamily:"Segoe UI",fontSize:"12px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",lineHeight:"16px",height:"18px",flexGrow:1},containerStyle:{display:"flex",width:"100%",height:"50px",padding:"0px"},nameContainerStyle:{width:"100%"}})},44636:function(e,t,n){"use strict";n.d(t,{Q:function(){return u}});var i=n(49037),r=n(63804),o=n.n(r),a=n(69698),s=n(19608),l=n(91847),c=n(87018),d=n(84793),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setFocusHard=!1,t.state={hasHover:!1,hasFocus:!1},t._handleOnKeyPress=function(e){var n=t.getListItem(e.target);"Enter"===e.key||13===e.which||13===e.keyCode||"Space"===e.key||32===e.which||32===e.keyCode?(t.setFocusHard=!0,e.target,t.select()):"ArrowLeft"===e.key||37===e.which||37===e.keyCode?(e.target,n&&window.requestAnimationFrame((function(){t.focusPreviousValidElement(n)}))):"ArrowRight"===e.key||39===e.which||39===e.keyCode?(e.target.parentElement,n&&window.requestAnimationFrame((function(){t.focusNextValidElement(n)}))):"ArrowDown"===e.key||40===e.which||40===e.keyCode?n&&window.requestAnimationFrame((function(){t.focusNextValidElement(n)})):"ArrowUp"!==e.key&&38!==e.which&&38!==e.keyCode||n&&window.requestAnimationFrame((function(){t.focusPreviousValidElement(n)}))},t.focusPreviousValidElement=function(e){for(;e.previousElementSibling;){if(e.previousElementSibling.classList.contains("ms-List-cell")){var t=e.previousElementSibling.getElementsByTagName("button")[0];return void(t?t.focus():e.previousElementSibling.focus())}e=e.previousElementSibling}},t.focusNextValidElement=function(e){for(;e.nextElementSibling;){if(e.nextElementSibling.classList.contains("ms-List-cell")){var t=e.nextElementSibling.getElementsByTagName("button")[0];return void(t?t.focus():e.nextElementSibling.focus())}e=e.nextElementSibling}},t.select=function(){t.props.onSelect&&t.props.onSelect()},t._handleMouseEnter=function(){t.setState({hasHover:!0})},t._handleMouseLeave=function(){t.setState({hasHover:!1})},t._handleFocus=function(){t.setState({hasFocus:!0})},t._handleBlur=function(){t.setState({hasFocus:t.setFocusHard})},t}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this,t=o().createElement(l.Stack,{horizontal:!1,className:d.l.nameContainerStyle},o().createElement("span",{className:d.l.name,title:this.props.label},this.props.label),o().createElement("span",{className:d.l.dataTypeStyle,title:this.props.fieldDataType},this.props.fieldDataType));this.setFocusHard=!1;var n=(0,a.z)();return o().createElement("div",{className:d.l.containerStyle,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onFocus:this._handleFocus,onBlur:this._handleBlur,onKeyDown:this._handleOnKeyPress},o().createElement(c.CommandBarButton,{disabled:this.props.isDisabled,"aria-describedby":n,ariaLabel:this.props.label,className:d.l.actionButton+(this.props.actionButtonStyles?" "+(0,s.mergeStyles)(this.props.actionButtonStyles):""),onClick:function(){e.select()}},t))},t.prototype.getListItem=function(e){for(var t=e;t&&"ms-List-cell"!==t.className;)t=t.parentElement;return t},t.defaultProps={id:"",label:"",iconSvgId:"",fieldDataType:"BigInteger"},t}(o().Component)},1748:function(e,t,n){"use strict";n.d(t,{m:function(){return l}});var i=n(49037),r=n(41380),o=n(21396),a=n(63804),s=n.n(a),l=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return this.props.errorMessage?s().createElement("span",{style:{display:"block",textAlign:"center",paddingTop:"10px",paddingBottom:"10px"}},this.props.errorMessage):s().createElement(r.$,{size:o.E.medium,style:{overflow:"hidden",margin:"auto",paddingRight:"52px"}})},t}(s().PureComponent)},22760:function(e,t,n){"use strict";n.d(t,{v:function(){return m}});var i=n(49037),r=n(63804),o=n.n(r),a=n(7084),s=n(19608),l=n(44636),c=n(60031),d=n(24338),u=n(80190),p=(0,s.mergeStyles)({marginLeft:"6px",width:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onFieldSelected=function(){t.props.onFieldDeselected&&t.props.isPartOfMultiSelect?t.props.onFieldDeselected(t.props.field):t.props.onFieldSelected&&t.props.onFieldSelected(t.props.field)},t}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.field,r=t.selectMode,s=t.isPartOfMultiSelect,c={id:n.logicalName,label:n.displayName,fieldDataType:n.dataType,onSelect:this._onFieldSelected,iconSvgId:this._getFieldIcon(n.dataType)},m=o().createElement(l.Q,(0,i.pi)({},c));return o().createElement("div",{role:"presentation",style:{display:"flex",flexGrow:1,marginLeft:(0,u.Os)(this.props.field)?"-22px":"0px",overflow:(0,u.Os)(this.props.field)?"hidden":"visible",height:"50px"}},r===d.W.multiSelect?o().createElement("div",{className:p},o().createElement(a.X,{checked:s,onChange:function(t,n){e._onFieldSelected()},styles:{root:{width:"100%"},label:{width:"100%",margin:"1px",outlineOffset:"0px!important"}},onRenderLabel:function(){return m}})):m)},t.prototype._getFieldIcon=function(e){if(this.props.dataTypeIcons){var t=this.props.dataTypeIcons(e);if(t)return t}return c.C.mapDataTypeToIcon(e)},t.prototype._makeFieldCommands=function(e){var t="function"==typeof this.props.contextMenuItems?this.props.contextMenuItems(e):this.props.contextMenuItems,n=0;return(t||[]).map((function(t){var i={key:n.toString(),name:t.label,iconProps:t.icon?{iconName:t.icon}:void 0,onClick:function(){t.onClick(e)}};return n++,i}))},t}(o().PureComponent)},99449:function(e,t,n){"use strict";n.d(t,{k:function(){return b}});var i=n(49037),r=n(63804),o=n.n(r),a=n(33491),s=n(36711),l=n(2097),c=n(32525),d=n(43357),u=n(94005),p=n(41380),m=n(21396),h=n(49678),g=n(1748),f=n(22760),y=n(4733),v=n(34559),C=n(64089),S=n(48945),E=(0,h.y)(),b=function(e){function t(n){var r=e.call(this,n)||this;return r._renderPivots=function(){var e,n={link:{paddingLeft:0,lineHeight:30,height:30,maxWidth:150},linkIsSelected:{paddingLeft:0,lineHeight:30,height:30,selectors:{":before":{borderRadius:1,left:0}},maxWidth:150},text:{maxWidth:150,textOverflow:"ellipsis",overflow:"hidden"}},a=[];if(r.props.entity){if(r.props.hidePrimaryEntityTab||(e=o().createElement(c.M,(0,i.pi)({},{itemKey:"entity",linkText:r.props.entity.displayName})),a.push(e)),!r.props.hideRelatedTab){var s=S.D.getLocalizedString(t.localizedStrings.related);e=o().createElement(c.M,(0,i.pi)({},{itemKey:"related",linkText:s,headerButtonProps:{disabled:r.props.disabledRelatedPivot}})),a.push(e)}return o().createElement("div",{className:r.classNames.pivots},o().createElement(d.o,{onLinkClick:r._onLinkClick,selectedKey:r.state.currentTab,styles:n},a))}var l=S.D.getLocalizedString(t.localizedStrings.loading);return o().createElement("div",{className:r.classNames.pivots},o().createElement(d.o,{onLinkClick:r._onLinkClick,styles:n},o().createElement(c.M,(0,i.pi)({},{itemKey:"entity",linkText:l}))))},r._onLinkClick=function(e){e&&r.setState({currentTab:e.props.itemKey})},r._renderSearchBox=function(){var e=S.D.getLocalizedString(t.localizedStrings.searchBoxPlaceholder),n=S.D.getLocalizedString(t.localizedStrings.searchBoxPlaceholder),a={value:r.state.searchValue,onChange:r._onSearchValueChanged,placeholder:e,ariaLabel:n};return o().createElement(s.Stack,{grow:!0},o().createElement(u.R,(0,i.pi)({},a)))},r._renderList=function(){return o().createElement("div",{className:r.classNames.list},o().createElement("div",{className:r.classNames.listContainer},r._renderListContents()))},r._renderFieldListCell=function(e){return r.props.fieldListProps.onRenderField?r.props.fieldListProps.onRenderField(e,r._renderField):r._renderField(e)},r._renderField=function(e){var t=r.props.fieldListProps.usedFields;return o().createElement(f.v,(0,i.pi)({},r.props.fieldListProps,{selectMode:r.props.selectMode,isPartOfMultiSelect:t&&e&&t.has(e.logicalName),field:e,allowDrag:r.props.allowDrag}))},r._renderEmptyStateListCell=function(e){return o().createElement(g.m,{errorMessage:e})},r._renderRelatedListCell=function(e,t){if((0,v.K3)(e))return r._renderFieldListCell(e.relatedField);if((0,v.$V)(e)){var n=e.relationship;return n.expanded=e.expanded,o().createElement(C.S,(0,i.pi)({},n))}return r._renderEmptyStateListCell(e.errorMessage)},r._onSearchValueChanged=function(e,t){r.setState({searchValue:t||""})},r._onItemExpand=function(e,t){var n=new Set(r.state.expandedRelationships);n.add(e.key),r.setState({expandedRelationships:n}),r.props.relationshipListProps.onRelatedEntityExpanded&&r.props.relationshipListProps.onRelatedEntityExpanded(e.key)},r._onItemSelected=function(e){var t=new Set(r.state.expandedRelationships);t.has(e.key)?t.delete(e.key):(t.add(e.key),r.props.relationshipListProps.onRelatedEntityExpanded&&r.props.relationshipListProps.onRelatedEntityExpanded(e.key)),r.setState({expandedRelationships:t})},r._onItemCollapsed=function(e,t){var n=new Set(r.state.expandedRelationships);n.delete(e.key),r.setState({expandedRelationships:n})},r.classNames=r.getClassNames(n),r.state={showOnlyUnusedFields:!0,searchFilter:{key:"all",text:"All"},currentTab:"entity",expandedRelationships:new Set},r}return(0,i.ZT)(t,e),t.prototype.render=function(){return o().createElement("div",{className:this.classNames.root},o().createElement("div",{className:this.classNames.header},this._renderSearchBox(),this._renderPivots()),this._renderList())},t.prototype._renderListContents=function(){var e=S.D.getLocalizedString(t.localizedStrings.emptyFieldsList);if(this.props.error)return this._renderEmptyStateListCell(this.props.error);if(!this.props.entity||!this.props.entity.fields&&"entity"===this.state.currentTab)return o().createElement(p.$,{size:m.E.medium,style:{paddingTop:"15px",overflow:"hidden"}});if("entity"===this.state.currentTab){var n=(0,y.i9)(this.props,this.state);return n.length>0?o().createElement(l.a,{items:n?n.slice():[],onRenderCell:this._renderFieldListCell,getItemCountForPage:function(){return n?n.length:0}}):this._renderEmptyStateListCell(e)}var i=(0,y.tB)(this.props,this.state,e);return o().createElement(a.mp,{width:NaN,height:NaN,items:(0,v.Lb)(i,this.state),ariaLabel:S.D.getLocalizedString(t.localizedStrings.relatedListAriaLabel),onRenderItem:this._renderRelatedListCell,onItemExpand:this._onItemExpand,onItemCollapse:this._onItemCollapsed,onItemSelected:this._onItemSelected,itemStyles:{root:{height:"inherit",selectors:{'&[aria-level="2"]:hover':{backgroundColor:"transparent !important"}}}},listStyles:{display:"block",width:262}})},t.prototype.getClassNames=function(e){var t=e.theme,n=e.className,i=e.styles;return E(i,{theme:t,className:n})},t.localizedStrings={searchBoxPlaceholder:S.D.getLocalizedString("WS_Grid_EditColumns_Search"),loading:S.D.getLocalizedString("WS_Grid_Show_More_Rows_Loading"),related:S.D.getLocalizedString("WS_Grid_AddColumn_Related"),emptyFieldsList:S.D.getLocalizedString("WS_Grid_AddColumn_EmptyFieldsList"),relatedListAriaLabel:"Related tables' columns list"},t}(o().PureComponent)},4733:function(e,t,n){"use strict";n.d(t,{i9:function(){return a},tB:function(){return s}});var i=n(49037),r=n(24338),o=n(80190);function a(e,t){if(!e.entity||!e.entity.fields)return[];var n=[];return e.entity.fields.forEach((function(i){l(i,e.fieldListProps.usedFields,e,t)&&n.push(i)})),n.sort((function(e,t){return e.displayName.startsWith("(")&&!t.displayName.startsWith("(")?1:!e.displayName.startsWith("(")&&t.displayName.startsWith("(")?-1:e.displayName.localeCompare(t.displayName)})),n}function s(e,t,n){var r=[];return e.relationships&&e.relationships.forEach((function(o){o.errorMessage||!o.relatedEntityFields?r.push(o):r.push(function(e,t,n,r){var o=t.relationshipListProps.usedRelatedFields.get(e.relationshipHash),a=new Map;return e.relatedEntityFields.forEach((function(e){l(e,o,t,n)&&a.set(e.logicalName,e)})),(0,i.pi)((0,i.pi)({},e),{relatedEntityFields:a,errorMessage:0===a.size?r:void 0})}(o,e,t,n))})),r.sort((function(e,t){return e.relatedResourceLabel.localeCompare(t.relatedResourceLabel)})),r}function l(e,t,n,i){if(void 0===e||!e.isValidForGrid&&"Image"!==e.dataType)return!1;var a=n.selectMode===r.W.quickSelect,s=n.selectMode===r.W.multiSelect;if((i.showOnlyUnusedFields||a)&&!s&&t&&t.has(e.logicalName))return!1;if(n.excludedFieldsNames&&-1!==n.excludedFieldsNames.indexOf(e.logicalName))return!1;var l=i.searchValue&&i.searchValue.toLowerCase()||void 0;return!(l&&e.logicalName.toLowerCase()!==l&&-1===e.displayName.toLowerCase().indexOf(l)||"custom"===i.searchFilter.key&&e.customizationType!==o.fS.Custom||"default"===i.searchFilter.key&&e.customizationType===o.fS.System)}},79462:function(e,t,n){"use strict";n.d(t,{W:function(){return i}});var i=function(e){return{root:[e.className,{width:"100%",display:"flex",flexDirection:"column",paddingLeft:"0px",paddingRight:"0px",overflowY:"auto"}],header:{paddingLeft:"16px",paddingRight:"16px"},pivots:{marginBottom:"16px"},searchContainer:{display:"flex",minHeight:"32px",marginBottom:"12px",background:e.theme.palette.white},searchResult:{position:"fixed",left:"-10000",top:"-10000",width:"1px",height:"1px",color:"transparent",backgroundColor:"transparent",overflow:"hidden"},searchBox:{minWidth:0,flexGrow:"1",background:e.theme.palette.white,width:"calc(100% - 100px)",position:"relative",borderRight:"0px",borderRadius:"0px",selectors:{"&:after":{content:'""',position:"absolute",right:"0px",top:"5px",bottom:"5px",borderRight:"1px solid "+e.theme.palette.neutralTertiary},"&:hover":{borderRight:"1px solid "+e.theme.palette.neutralPrimary},"&.is-active, &:focus":{borderRight:"1px solid "+e.theme.palette.themePrimary},"&:hover:after, &.is-active:after, &:focus:after":{display:"none"}}},subComponentStyles:{filter:{root:{width:"101px",left:"-1px",position:"relative",background:"transparent",selectors:{"&:after":{borderLeft:"1px solid transparent"},"&:hover .ms-Dropdown-title":{borderLeft:"1px solid "+e.theme.palette.neutralPrimary},"&:focus .ms-Dropdown-title":{borderLeft:"1px solid "+e.theme.palette.themePrimary}}}}},list:{display:"flex",minHeight:"5em",flexDirection:"column",flexGrow:1,overflowY:"auto",overflowX:"hidden",borderTop:"1px solid "+e.theme.palette.neutralTertiaryAlt},listContainer:{}}}},34559:function(e,t,n){"use strict";function i(e){return void 0!==e.relationship}function r(e){return void 0!==e.relatedField}function o(e,t){var n=[],i=0;return e.forEach((function(e){if(n.push({label:e.relatedResourceLabel,key:e.relationshipHash,isFolder:!0,level:0,setSize:0,expanded:t.expandedRelationships.has(e.relationshipHash),indexInParent:i,isFocusable:!1,iconSvgId:"",relationship:e}),i++,e.relatedEntityFields&&!e.errorMessage){var r=0;e.relatedEntityFields.forEach((function(t){n.push({label:t.displayName,key:e.relationshipHash+t.logicalName,isFolder:!1,level:1,setSize:0,indexInParent:r,isFocusable:!1,iconSvgId:"",relatedField:t}),r++}))}else n.push({label:"",key:e.relationshipHash+".EmptyState",isFolder:!1,level:1,setSize:0,indexInParent:0,isFocusable:!0,iconSvgId:"",errorMessage:e.errorMessage})})),n}n.d(t,{$V:function(){return i},K3:function(){return r},Lb:function(){return o}})},11248:function(e,t,n){"use strict";n.d(t,{I:function(){return a}});var i=n(58588),r=n(99449),o=n(79462),a=(0,i.z)(r.k,o.W)},60031:function(e,t,n){"use strict";var i;n.d(t,{C:function(){return i}}),function(e){e.mapDataTypeToIcon=function(e){switch(e){case"Text":return"TextField";case"Enumeration":case"MultiSelectEnumeration":case"BooleanEnumeration":return"BulletedList";case"Image":return"Photo2";case"File":return"TextDocument";case"Integer":return"NumberField";case"Double":return"CircleHalfFull";case"Number":return"Subscript";case"Money":return"Money";case"MultilineText":return"TextBox";case"DateTime":return"DateTime";case"Lookup":return"ClosePane";case"Customer":return"Contact";case"UniqueIdentifier":return"TextCallout";case"BigInteger":return"NumberField";case"Owner":return"Contact";default:return"Unknown"}}}(i||(i={}))},64089:function(e,t,n){"use strict";n.d(t,{S:function(){return l}});var i=n(49037),r=n(38312),o=n(19608),a=n(63804),s=n.n(a),l=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this.props,t=(0,o.getTheme)();return s().createElement(r.K,{"aria-expanded":e.expanded,styles:{root:[(0,o.getFocusStyle)(t,2),{display:"inline-flex",width:"100%",height:"32px",overflow:"hidden",marginLeft:"5px",marginRight:"5px",selectors:{"@media screen and (-ms-high-contrast: active)":{selectors:{":focus":{border:"2px solid"}}}}}],flexContainer:{overflow:"hidden"}}},s().createElement("span",{title:e.relatedResourceLabel,style:{flexGrow:1,lineHeight:"32px",fontWeight:600,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left"}},e.relatedResourceLabel))},t}(s().PureComponent)},24338:function(e,t,n){"use strict";var i;n.d(t,{W:function(){return i}}),function(e){e[e.default=0]="default",e[e.quickSelect=1]="quickSelect",e[e.multiSelect=2]="multiSelect"}(i||(i={}))},80190:function(e,t,n){"use strict";var i;function r(e){return void 0!==e.parentRelationshipHash}n.d(t,{fS:function(){return i},Os:function(){return r}}),function(e){e.Standard="standard",e.System="system",e.Custom="custom"}(i||(i={}))},95682:function(e,t,n){"use strict";n.d(t,{IQ:function(){return i.I}}),n(80190),n(24338);var i=n(11248)},83083:function(e,t,n){"use strict";n.d(t,{w:function(){return s}});var i=n(49037),r=n(63804),o=n(71520),a=n(76601),s=function(e){var t=r.useState(""),n=t[0],s=t[1];r.useEffect((function(){s(e.value)}),[e.value]);var l=r.useCallback((function(t){e.onChange(t.target.value)}),[e.onChange]),c=r.useCallback((function(e,t){s(t||"")}),[s]);return void 0!==e.operator?(0,a.k5)(e.onReadonlyClick,e.operator,n):r.createElement(o.TextField,(0,i.pi)({},e,{value:n,onBlur:l,onChange:c,placeholder:"None"}))}},63931:function(e,t,n){"use strict";n.d(t,{M:function(){return l}});var i=n(49037),r=n(38498),o=n(63804),a=n.n(o),s=n(76601),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this,t=void 0;if(/^\d\d\d\d-\d\d-\d\d$/.test(this.props.value)){var n=this.props.value.split("-").map((function(e){return Number(e)}));t=new Date(n[0],n[1]-1,n[2])}var i=this.props.formatter?this.props.formatter.formatDate:u;return void 0!==this.props.operator?(0,s.k5)(this.props.onReadonlyClick,this.props.operator,t?i(t):this.props.value):a().createElement(r.DatePicker,{placeholder:"MM/DD/YY",value:t,isMonthPickerVisible:!1,allowTextInput:!0,formatDate:i,parseDateFromString:this.props.formatter?this.props.formatter.parseDateFromString:void 0,onSelectDate:function(t){if(t){var n=c(t);e.props.value!==n&&e.props.onChange(n)}else e.props.onChange("")},ariaLabel:this.props.ariaLabel,disabled:this.props.disabled,textField:{errorMessage:this.props.errorMessage,styles:this.props.textFieldStyles}})},t}(a().PureComponent),c=function(e){return d(e.getFullYear(),4)+"-"+d(e.getMonth()+1,2)+"-"+d(e.getDate(),2)},d=function(e,t){var n=e.toString(),i="";return n.length<t&&(i="0".repeat(t-n.length)),""+i+n},u=function(e){var t;return null!==(t=null==e?void 0:e.toLocaleDateString(void 0,{day:"numeric",month:"numeric",year:"2-digit"}))&&void 0!==t?t:""}},87357:function(e,t,n){"use strict";n.d(t,{S:function(){return v}});var i=n(49037),r=n(64336),o=n(9561),a=n(79392),s=n(49258),l=n(63804),c=n(29086),d=n(69743),u=n(94589),p=n(48909),m=n(76601),h=(0,c.mergeStyles)({selectors:{"& .ms-BasePicker-input":{height:"30px"}}}),g=(0,c.mergeStyles)({fontSize:u.TS.size14}),f=(0,c.mergeStyles)({selectors:{"& .ms-BasePicker-text":{paddingRight:"24px",borderColor:"rgb(96, 94, 92)",borderRadius:"2px"}}}),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.defaultProps={onRenderItem:function(e){var t=(0,i.pi)((0,i.pi)({},e),{item:{key:"",name:""},onItemChange:function(){return null}});return l.createElement(o.TagItem,(0,i.pi)({},t),l.createElement(p.Text,{className:g},e.item.displayName))},onRenderSuggestionsItem:function(e){return l.createElement("div",{style:{textAlign:"left",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"60",padding:"7px 12px"}},l.createElement(p.Text,{block:!0,nowrap:!0,className:g},e.displayName))}},t}(r.BasePicker),v=function(e){function t(t){var n=e.call(this,t)||this;return n.onBlur=function(){var e,t,i,r;n.pickerRef.current&&n.onChange(n.pickerRef.current.items),null===(r=null===(i=null===(t=null===(e=n.pickerRef.current)||void 0===e?void 0:e.input)||void 0===t?void 0:t.current)||void 0===i?void 0:i._updateValue)||void 0===r||r.call(i,"")},n.onDropdownClick=function(){return n.pickerRef.current&&n.pickerRef.current.focusInput()},n.onEmptyInputFocus=function(e){return n.onFilterChanged("",e)},n.onFilterChanged=function(e,t){return(n.state.cachedResults?Promise.resolve(n.state.cachedResults):n.props.resolver.resolveOptionSetMembers(n.props.entityContext,n.props.fieldContext)).then((function(t){return n.setState({cachedResults:t}),t.filter((function(t){return t.displayName.toLowerCase().indexOf(e.toLowerCase())>=0||t.description&&t.description.toLowerCase().indexOf(e.toLowerCase())>=0}))}))},n.onItemSelected=function(e){return e&&n.pickerRef.current&&!n.pickerRef.current.items.find((function(t){return t.value===e.value}))?e:null},n.onChange=function(e){e?n.props.onChange(e.map((function(e){return e.value.toString()})).join(","),"("+e.map((function(e){return e.displayName})).join(", ")+")"):""!==n.props.value&&n.props.onChange("",void 0)},n.state={cachedResults:void 0},n.pickerRef=l.createRef(),n}return(0,i.ZT)(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.value&&this.props.resolver.resolveOptionSetMembers(this.props.entityContext,this.props.fieldContext).then((function(t){e.setState({cachedResults:t})}))},t.prototype.componentDidUpdate=function(e){this.props.fieldContext!==e.fieldContext&&(void 0===e.fieldContext||e.fieldContext&&this.props.fieldContext&&this.props.fieldContext.name!==e.fieldContext.name)&&(this.setState({cachedResults:void 0}),this.componentDidMount())},t.prototype.render=function(){var e,t,n,i=this,r=this.props.value,o=(r?r.split(","):[]).map((function(e){var t=Number.parseInt(e),n=(i.state.cachedResults||[]).find((function(e){return e.value===t}));return{value:t,description:n?n.description:"",displayName:n?n.displayName:""}})),c=!!r&&void 0===this.state.cachedResults;return void 0!==this.props.operator?(0,m.k5)(this.props.onReadonlyClick,this.props.operator,o.map((function(e){return e.displayName})).join(", ")):l.createElement("div",null,l.createElement(y,{className:(0,d.css)(this.props.className,h,!c&&!this.props.disabled&&f),disabled:c||this.props.disabled,componentRef:this.pickerRef,onEmptyInputFocus:this.onEmptyInputFocus,onResolveSuggestions:this.onFilterChanged,onItemSelected:this.onItemSelected,selectedItems:c?[]:o,onChange:this.onChange,pickerSuggestionsProps:{loadingText:this.props.labels.loadingResults,noResultsFoundText:this.props.labels.noResults,styles:{root:{width:null===(t=null===(e=this.pickerRef.current)||void 0===e?void 0:e.root.current)||void 0===t?void 0:t.clientWidth}}},inputProps:{"aria-label":this.props.ariaLabel?this.props.ariaLabel:null===(n=this.props.fieldContext)||void 0===n?void 0:n.displayName,placeholder:0===o.length?"None":void 0},onBlur:this.onBlur}),c&&l.createElement(a.Spinner,{className:"IconDropdown-Spinner",size:s.SpinnerSize.medium,style:{marginTop:"-26px"}}))},t}(l.PureComponent)},66537:function(e,t,n){"use strict";n.d(t,{F:function(){return b}});var i=n(49037),r=n(64336),o=n(9561),a=n(63804),s=n(6946),l=n(29086),c=n(79392),d=n(49258),u=n(17513),p=n(48909),m=n(91847),h=n(94589),g=n(54988),f=n(76601),y=(0,l.mergeStyles)({selectors:{"& .ms-BasePicker-input":{height:"30px"},"& .ms-BasePicker-text":{paddingRight:"24px",borderColor:"rgb(96, 94, 92)",borderRadius:"2px"}}}),v=(0,l.mergeStyles)({selectors:{"& .ms-BasePicker-input":{height:"30px"}}}),C=(0,l.mergeStyles)({fontSize:h.TS.size14}),S=(0,l.mergeStyles)({textAlign:"left",color:g.iX.gray130,fontSize:h.TS.size12}),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.defaultProps={onRenderItem:function(e){var t=(0,i.pi)((0,i.pi)({},e),{item:{key:"",name:""},onItemChange:function(){return null}});return a.createElement(o.TagItem,(0,i.pi)({},t),!e.item.displayName&&a.createElement(c.Spinner,{size:d.SpinnerSize.xSmall,styles:{root:{marginTop:7}}}),a.createElement(p.Text,{className:C},e.item.displayName))},onRenderSuggestionsItem:function(e){return a.createElement(m.Stack,{style:{overflow:"hidden",textOverflow:"ellipsis",padding:"7px 12px"}},a.createElement(p.Text,{block:!0,nowrap:!0,className:C},e.displayName),e.entityDisplayName&&a.createElement(p.Text,{block:!0,nowrap:!0,className:S},e.entityDisplayName))}},t}(r.BasePicker),b=function(e){function t(t){var n=e.call(this,t)||this;return n.onBlur=function(){var e,t,i,r;n.pickerRef.current&&(n.onChange(n.pickerRef.current.items),null===(r=null===(i=null===(t=null===(e=n.pickerRef.current)||void 0===e?void 0:e.input)||void 0===t?void 0:t.current)||void 0===i?void 0:i._updateValue)||void 0===r||r.call(i,""))},n.onChange=function(e){n.props.onChange(e||[],e?"("+e.map((function(e){return e.displayName})).join(", ")+")":void 0)},n.onDropdownClick=function(){return n.pickerRef.current&&n.pickerRef.current.focusInput()},n.getInitialSelectedLookups=function(){return(0,i.mG)(n,void 0,void 0,(function(){var e,t,n,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return this.state.finishedInitialLoading||!this.selectedItems().some((function(e){return!e.displayName}))?[2]:(e=this.isPolymorphicLookup(),[4,this.getRelations(e)]);case 1:return t=i.sent(),n=this.gatherLookupTargets(),this.props.entityContext?[4,this.props.resolver.resolveLookupRecordsById(this.props.entityContext,n,this.selectedItems().map((function(e){return e.id})))]:[3,3];case 2:r=i.sent(),r=this.processPolymorphicLookupRecords(e,r,t),this.setState({previouslySelectedItems:r,finishedInitialLoading:!0}),i.label=3;case 3:return[2]}}))}))},n.onEmptyInputFocus=function(e){return n.getFilteredLookups("",e)},n.getFilteredLookups=function(e,t){return(0,i.mG)(n,void 0,void 0,(function(){var t,n,r,o,a;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return t=this.state.cachedResults.get(e),Array.isArray(t)?[2,t]:(n=this.isPolymorphicLookup(),[4,this.getRelations(n)]);case 1:return r=i.sent(),o=this.gatherLookupTargets(),this.props.entityContext?[4,this.props.resolver.resolveLookupRecordsSimple(this.props.entityContext,o,{searchString:e,searchDefaultLookupView:!0})]:[3,3];case 2:return 0===(a=i.sent()).length&&(0,u.isGUID)(e.toLowerCase())&&a.push({id:e.toLowerCase(),displayName:e.toLowerCase(),entityLogicalName:"",unmatchedRecord:!0}),[2,this.processLookupRecords(a,n,r,e)];case 3:return console.error("There were no cached results nor entityContext"),[2,[]]}}))}))},n.onItemSelected=function(e){return e&&n.pickerRef.current&&!n.pickerRef.current.items.find((function(t){return t.id===e.id}))?e:null},n.state={cachedResults:new Map,previouslySelectedItems:[],finishedInitialLoading:!1},n.pickerRef=a.createRef(),n}return(0,i.ZT)(t,e),t.prototype.componentDidMount=function(){this.getInitialSelectedLookups()},t.prototype.componentDidUpdate=function(){this.componentDidMount()},t.prototype.render=function(){var e,t,n=this.selectedItems();return void 0!==this.props.operator?(0,f.k5)(this.props.onReadonlyClick,this.props.operator,n.map((function(e){return e.displayName})).join(", ")):a.createElement(E,{className:this.props.disabled?v:y,componentRef:this.pickerRef,onEmptyInputFocus:this.onEmptyInputFocus,onResolveSuggestions:this.getFilteredLookups,onItemSelected:this.onItemSelected,selectedItems:n,onChange:this.onChange,onBlur:this.onBlur,resolveDelay:500,inputProps:{"aria-label":this.props.ariaLabel,placeholder:0===n.length?"None":void 0},pickerSuggestionsProps:{loadingText:this.props.labels.loadingResults,noResultsFoundText:this.props.labels.noResults,styles:{root:{width:null===(t=null===(e=this.pickerRef.current)||void 0===e?void 0:e.root.current)||void 0===t?void 0:t.clientWidth}}},itemLimit:this.props.singleSelect?1:void 0,disabled:this.props.disabled})},t.prototype.selectedItems=function(){var e=this,t=this.props.value;return(t&&Array.isArray(t)?t:[]).map((function(t){if(!t.displayName){var n=e.state.previouslySelectedItems.find((function(e){return e.id.toLowerCase()===t.id.toLowerCase()}));if(n||(n=Array.from(e.state.cachedResults.values()).flat().find((function(e){return e.id.toLowerCase()===t.id.toLowerCase()}))),!n)return e.processUnmatchedRecordPatch(t),(0,i.pi)((0,i.pi)({},t),{unmatchedRecord:!0});if(n)return n;if(e.state.finishedInitialLoading)return(0,i.pi)((0,i.pi)({},t),{displayName:t.id,unmatchedRecord:!0})}return t}))},t.prototype.processUnmatchedRecordPatch=function(e){return(0,i.mG)(this,void 0,void 0,(function(){var t,n,r,o,a;return(0,i.Jh)(this,(function(s){switch(s.label){case 0:return this.props.entityContext?(t=this.isPolymorphicLookup(),[4,this.getRelations(t)]):[3,3];case 1:return n=s.sent(),r=this.gatherLookupTargets(),[4,this.props.resolver.resolveLookupRecordsById(this.props.entityContext,r,[e.id])];case 2:return o=s.sent(),a=this.processLookupRecords(o,t,n,""),this.setState({previouslySelectedItems:(0,i.pr)(this.state.previouslySelectedItems,a)}),[3,4];case 3:console.error("There was no entityContext"),s.label=4;case 4:return[2]}}))}))},t.prototype.getRelations=function(e){return(0,i.mG)(this,void 0,void 0,(function(){var t,n,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return e&&this.props.entityContext?[4,this.props.resolver.resolveRelatedEntities(this.props.entityContext)]:[3,2];case 1:return n=i.sent(),[3,3];case 2:n=[],i.label=3;case 3:return t=n,r=new Map,t.forEach((function(e){r.set(e[0].name.toLowerCase(),e[0])})),[2,r]}}))}))},t.prototype.isPolymorphicLookup=function(){return this.props.fieldContext&&this.props.fieldContext.targets&&this.props.fieldContext.targets.length>1},t.prototype.gatherLookupTargets=function(){var e;return this.props.fieldContext&&this.props.entityContext&&(0,s.isUniqueIdentifier)(this.props.fieldContext)?e=[this.props.entityContext.name.toLowerCase()]:this.props.fieldContext&&this.props.fieldContext.targets?e=(0,i.pr)(this.props.fieldContext.targets):(console.error("Some permutation of fieldContext and entityContext were expected to be provided."),e=[]),e},t.prototype.processLookupRecords=function(e,t,n,i){return e=this.processPolymorphicLookupRecords(t,e,n),i&&this.setState({cachedResults:this.state.cachedResults.set(i,e)}),e},t.prototype.processPolymorphicLookupRecords=function(e,t,n){return e&&(t=t.map((function(e){var t=n.get(e.entityLogicalName);return(0,i.pi)((0,i.pi)({},e),{entityDisplayName:t?t.displayName:e.entityLogicalName})}))),t},t}(a.PureComponent)},41199:function(e,t,n){"use strict";n.d(t,{a:function(){return h},s:function(){return f}});var i=n(49037),r=n(63804),o=n.n(r),a=n(11849),s=n(48945),l=n(19608),c=n(9433),d=n(79549),u=n(11762),p=n(94589),m=n(17754),h=function(e){return""===e[0]&&""===e[1]},g=(0,l.mergeStyles)(u.I.slideDownIn20,{color:m.S_,fontSize:p.TS.small,paddingTop:"5px"}),f=function(e){var t=o().useState(["",""]),n=t[0],l=t[1],u=e.range[0]===n[0]&&e.range[1]===n[1];return(0,a.v)((function(){u||(""===n[0]&&""===n[1]&&e.onChange(n),""!==n[0]&&""!==n[1]&&e.onChange(n))}),[n]),(0,r.useEffect)((function(){u||l(e.range)}),[e.range]),o().createElement(c.K,null,o().createElement(c.K,{horizontal:!0,verticalAlign:"baseline"},o().createElement(e.ValueComponent,(0,i.pi)({resolver:void 0,value:n[0],ariaLabel:n[0]?e.field&&e.field.displayName+" "+n[0]:e.field&&e.field.displayName,onChange:function(e){l((function(t){var n=(0,i.pr)(t);return n[0]=e,n}))}},{placeholder:s.D.getLocalizedString("Min"),errorMessage:function(t){return""===t[0]&&""!==t[1]?s.D.getLocalizedString("WS_RangeComponent_FieldRequired_Error"):function(t){if(void 0!==e.min&&""!==t){if(e.isDateRange){var n=new Date(e.min);return new Date(t)>=n}return Number.parseInt(t)>=e.min}return!0}(t[0])?"":""+s.D.getLocalizedString("WS_RangeComponent_MinValue_Error",e.min)}(n),textFieldStyles:{root:{maxWidth:"140px"}}})),o().createElement("div",{style:{paddingLeft:10,paddingRight:10}},""),o().createElement(e.ValueComponent,(0,i.pi)({resolver:void 0,value:n[1],ariaLabel:n[1]?e.field&&e.field.displayName+" "+n[1]:e.field&&e.field.displayName,onChange:function(e){l((function(t){var n=(0,i.pr)(t);return n[1]=e,n}))}},{placeholder:s.D.getLocalizedString("Max"),errorMessage:function(t){return""===t[1]&&""!==t[0]?s.D.getLocalizedString("WS_RangeComponent_FieldRequired_Error"):function(t){if(void 0!==e.max&&""!==t){if(e.isDateRange){var n=new Date(e.max);return new Date(t)<=n}return Number.parseInt(t)<=e.max}return!0}(t[1])?"":""+s.D.getLocalizedString("WS_RangeComponent_MaxValue_Error",e.max)}(n),textFieldStyles:{root:{maxWidth:"140px"}}}))),!function(t){return""===t[0]||""===t[1]||(e.isDateRange?new Date(t[0])<=new Date(t[1]):parseInt(t[0])<=parseInt(t[1]))}(n)&&o().createElement(d.x,{className:g},s.D.getLocalizedString("WS_RangeComponent_InvalidRange_Error")))}},51953:function(e,t,n){"use strict";n.d(t,{k:function(){return c}});var i=n(49037),r=n(63804),o=n(38847),a=n(47895),s=n(19727),l=n(76601),c=function(e){function t(t){var n=e.call(this,t)||this;return n.onGetErrorMessage=function(e){n.props.value===e&&""===e&&n.props.onChange("")},n.onBlurred=function(e){n.props.onChange(void 0!==e?String(e):"")},n.onBlurUseLastValid=function(){n.props.onChange(void 0!==n.state.lastValidValue?String(n.state.lastValidValue):""),n.setState({rerenderIndicator:!n.state.rerenderIndicator})},n.onFormUpdated=function(e,t){if(t){t=t.trim();var i=n.props.formatter?n.props.formatter.parseNumberFromString(t):void 0;if((i||0===i)&&i!==n.state.lastValidValue){var r="";n.props.formatter&&(r=n.props.formatter.formatNumber(i)),n.setState({lastValidValue:i,formattedValue:r})}}else n.setState({lastValidValue:"",formattedValue:""})},n.makeStateFromProps=function(e){var t="",n="";return e.value&&e.formatter&&((t=parseFloat(e.value))||0===t?n=e.formatter.formatNumber(t):t=""),{lastValidValue:t,formattedValue:n,rerenderIndicator:!1}},n.state=n.makeStateFromProps(t),n}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t;return void 0!==this.props.operator?(0,l.k5)(this.props.onReadonlyClick,this.props.operator,this.props.formatter?this.state.formattedValue:this.props.value):this.props.formatter?r.createElement(s.l0,{onUpdated:this.onFormUpdated,key:"realNumberForm_"+this.state.rerenderIndicator.toString()},r.createElement("div",null,r.createElement(a.c,{inputKey:"RealNumberInput",value:this.state.formattedValue,textFieldProps:{onBlur:this.onBlurUseLastValid,ariaLabel:this.props.ariaLabel?this.props.ariaLabel:null===(e=this.props.fieldContext)||void 0===e?void 0:e.displayName,disabled:this.props.disabled,onGetErrorMessage:this.onGetErrorMessage,validateOnFocusOut:!0,validateOnLoad:!1,placeholder:this.props.placeholder}}))):r.createElement(o.Ki,{value:""!==this.props.value?Number(this.props.value):void 0,onBlurred:this.onBlurred,textFieldProps:{ariaLabel:this.props.ariaLabel?this.props.ariaLabel:null===(t=this.props.fieldContext)||void 0===t?void 0:t.displayName,disabled:this.props.disabled,onGetErrorMessage:this.onGetErrorMessage,validateOnFocusOut:!0,validateOnLoad:!1,placeholder:this.props.placeholder,errorMessage:this.props.errorMessage,styles:this.props.textFieldStyles}})},t}(r.PureComponent)},16305:function(e,t,n){"use strict";n.d(t,{D:function(){return c}});var i=n(49037),r=n(63804),o=n(38847),a=n(47895),s=n(19727),l=n(76601),c=function(e){function t(t){var n=e.call(this,t)||this;return n.onGetErrorMessage=function(e){n.props.value===e&&""===e&&n.props.onChange("")},n.onBlurred=function(e){n.props.onChange(void 0!==e?String(e):"")},n.onBlurUseLastValid=function(){n.props.onChange(void 0!==n.state.lastValidValue?String(n.state.lastValidValue):""),n.setState({rerenderIndicator:!n.state.rerenderIndicator})},n.onFormUpdated=function(e,t){if(t){t=t.trim();var i=n.props.formatter?n.props.formatter.parseNumberFromString(t):void 0;if((i||0===i)&&i!==n.state.lastValidValue){Number.isInteger(i)||(i=Math.trunc(i));var r="";n.props.formatter&&(r=n.props.formatter.formatNumber(i)),n.setState({lastValidValue:i,formattedValue:r})}}else n.setState({lastValidValue:"",formattedValue:""})},n.makeStateFromProps=function(e){var t="",n="";return e.value&&e.formatter&&((t=parseFloat(e.value))||0===t?n=e.formatter.formatNumber(t):t=""),{lastValidValue:t,formattedValue:n,rerenderIndicator:!1}},n.state=n.makeStateFromProps(t),n}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t;return void 0!==this.props.operator?(0,l.k5)(this.props.onReadonlyClick,this.props.operator,this.props.formatter?this.state.formattedValue:this.props.value):this.props.formatter?r.createElement(s.l0,{onUpdated:this.onFormUpdated,key:"wholeNumberForm_"+this.state.rerenderIndicator.toString()},r.createElement("div",null,r.createElement(a.c,{inputKey:"wholeNumberInput",value:this.state.formattedValue,textFieldProps:{onBlur:this.onBlurUseLastValid,ariaLabel:this.props.ariaLabel?this.props.ariaLabel:null===(e=this.props.fieldContext)||void 0===e?void 0:e.displayName,suffix:this.props.valueSuffix,disabled:this.props.disabled,onGetErrorMessage:this.onGetErrorMessage,validateOnFocusOut:!0,validateOnLoad:!1,placeholder:this.props.placeholder}}))):r.createElement(o.Qn,(0,i.pi)({},this.props,{value:""!==this.props.value?Number(this.props.value):void 0,onBlurred:this.onBlurred,textFieldProps:{ariaLabel:this.props.ariaLabel?this.props.ariaLabel:null===(t=this.props.fieldContext)||void 0===t?void 0:t.displayName,suffix:this.props.valueSuffix,disabled:this.props.disabled,onGetErrorMessage:this.onGetErrorMessage,validateOnFocusOut:!0,validateOnLoad:!1,placeholder:this.props.placeholder,errorMessage:this.props.errorMessage,styles:this.props.textFieldStyles}}))},t}(r.PureComponent)},14959:function(e,t,n){"use strict";function i(e){return null==e?e:("string"!=typeof e&&(e=e.toString()),function(e,t){var n;return(e=(e=null!==(n=t(e=(e=e.replace(new RegExp("([\\uD800-\\uDBFF][\\uDC00-\\uDFFF])","g"),(function(e){return"CRMEntityReferenceOpen"+(1024*(e.charCodeAt(0)-55296)+(1023&e.charCodeAt(1))+65536).toString(16)+"CRMEntityReferenceClose"}))).replace(new RegExp("[\\uD800-\\uDFFF]","g"),"")))&&void 0!==n?n:"").replace(/CRMEntityReferenceOpen/g,"&#x")).replace(/CRMEntityReferenceClose/g,";")}(e,r))}function r(e){return function(e){var t,n="",i="",r=0;if(null===e)return null;if(""===e)return"";for(var o=0;o<e.length;o++)i+=(t=e.charCodeAt(o))>96&&t<123||t>64&&t<91||32===t||t>47&&t<58||46===t||44===t||45===t||95===t?String.fromCharCode(t):"&#"+t+";",500==++r&&(n+=i,i="",r=0);return i.length&&(n+=i),n}(e)}n.d(t,{I:function(){return i}})},69041:function(e,t,n){"use strict";n.d(t,{_Y:function(){return o},DV:function(){return a},F1:function(){return s},HJ:function(){return l},FT:function(){return c},HG:function(){return d},c6:function(){return u},Nd:function(){return m},nw:function(){return h},aX:function(){return g},d2:function(){return f},PU:function(){return y},DM:function(){return v},Vc:function(){return C},L3:function(){return w},s6:function(){return x},r9:function(){return k},ep:function(){return _},Xd:function(){return N},Mu:function(){return L},CL:function(){return I},$S:function(){return A},pr:function(){return R}});var i=n(49037),r=n(638),o=0,a=8,s=6,l=4,c=5,d=27,u=26,p=function(e,t,n){for(var r,o=1===e.filterOperator||n,a=e.conditions.map((function(e){return(0,i.pi)((0,i.pi)({},e),{level:t,isInOr:o})})),s=0,l=null!==(r=e.filters)&&void 0!==r?r:[];s<l.length;s++){var c=l[s];a.push.apply(a,p(c,t+1,o))}return a},m=function(e){var t=new Map,n=[];return n.push.apply(n,p(e,0,!1)),n.forEach((function(e){var n=t.get(e.attributeName);n?n.push(e):t.set(e.attributeName,[e])})),t},h=function(e){var t,n,i;return(null!==(n=null===(t=null==e?void 0:e.filters)||void 0===t?void 0:t.reduce((function(e,t){return e+h(t)}),0))&&void 0!==n?n:0)+(null!==(i=null==e?void 0:e.conditions.length)&&void 0!==i?i:0)},g=function(e,t){if(!e)return{filterOperator:0,filters:[],conditions:[t]};var n=e.conditions.findIndex((function(e){return e.attributeName===t.attributeName}));if(-1!=n)return(r=(0,i.pr)(e.conditions))[n]=t,(0,i.pi)((0,i.pi)({},e),{conditions:r});var r=(0,i.pr)(e.conditions,[t]);return(0,i.pi)((0,i.pi)({},e),{conditions:r})},f=function(e,t){if(!e)return e;var n=e.conditions.findIndex((function(e){return e.attributeName===t}));if(-1!=n){var r=(0,i.pr)(e.conditions);r.splice(n,1);var o=(0,i.pi)((0,i.pi)({},e),{conditions:r});return S(o)?void 0:o}return e},y=function(e){return(e[0].conditionOperator===l&&e[1].conditionOperator===c||e[0].conditionOperator===c&&e[1].conditionOperator===l||e[0].conditionOperator===u&&e[1].conditionOperator===d||e[0].conditionOperator===d&&e[1].conditionOperator===u)&&e[0].level===e[1].level},v=function(e,t){var n,r,o={filterOperator:0,filters:[],conditions:t};if(!e)return{filterOperator:0,filters:[o],conditions:[]};var a=e.filters;return a&&a.length>0&&(a.forEach((function(n,a){var s,l=n.conditions.filter((function(e){return e.attributeName===t[0].attributeName}));if(2===l.length&&y(l)){var c=(0,i.pr)(null!==(s=e.filters)&&void 0!==s?s:[]);c[a]=o,r=(0,i.pi)((0,i.pi)({},e),{filters:c})}})),r)?r:(0,i.pi)((0,i.pi)({},e),{filters:(0,i.pr)(null!==(n=e.filters)&&void 0!==n?n:[],[o])})},C=function(e,t){var n=e;if(e){var r=e.filters;return r&&r.length>0&&r.forEach((function(r,o){var a,s=r.conditions.filter((function(e){return e.attributeName===t}));if(2===s.length&&y(s)){var l=(0,i.pr)(null!==(a=e.filters)&&void 0!==a?a:[]);l.splice(o,1),n=(0,i.pi)((0,i.pi)({},e),{filters:l})}})),S(n)?void 0:n}},S=function(e){var t;return!e.conditions.length&&!(null===(t=e.filters)||void 0===t?void 0:t.length)},E=function(e){return e instanceof Array?e:e?[e]:[]},b=function(e,t){return E(e).concat(E(t))},w=function(e,t){var n=(0,i.pi)({},e),r=t&&!S(t)?[{filters:[t],filterOperator:0,conditions:[]}]:void 0,o=b(null==e?void 0:e.filters,r);return n.filters=0===o.length?null:1===o.length?o[0]:{conditions:[],filterOperator:0,filters:o},n},D={attributeNamePrefix:"@_",attrNodeName:!1,ignoreAttributes:!1,allowBooleanAttributes:!0,parseNodeValue:!1,parseAttributeValue:!1,arrayMode:void 0,trimValues:!1,cdataTagName:"__cdata",cdataPositionChar:"\\c",parseTrueNumberOnly:!0,format:!1},T=new r.j2xParser(D),x=function(e){try{return r.parse(e,D,!0)}catch(e){console.error("failed to parse xml: "+e.toString())}return{}},k=function(e,t){Object.getOwnPropertyNames(t).filter((function(e){return!e.startsWith("@_")})).forEach((function(n){e[n]=b(null==e?void 0:e[n],t[n])}))},_=function(e){return T.parse(e)},N=function(e){e instanceof Array?e.forEach((function(e){return N(e)})):e&&(delete e.attribute,delete e.order,N(e["link-entity"]))},L=function(e,t){var n=e.lastIndexOf("</entity>");if(n<0)throw new Error("Invalid fetchXml string: "+e);return e.slice(0,n)+t+e.slice(n)},I=function(e){var t;return(0,i.pi)((0,i.pi)({},e),{linkType:"outer",nestedLinkEntities:null===(t=null==e?void 0:e.nestedLinkEntities)||void 0===t?void 0:t.map((function(e){return I(e)}))})},A=function(e,t){for(var n=0,i=e;n<i.length;n++){var r=i[n];if(r.alias===t||r.nestedLinkEntities&&void 0!==A(r.nestedLinkEntities,t))return r}};function R(e,t){for(var n=0,i=e;n<i.length;n++){var r=i[n];if(t.name===r.name&&t.from===r.from&&t.to===r.to)return r;if("nestedLinkEntities"in r&&r.nestedLinkEntities){var o=R(r.nestedLinkEntities,t);if(o)return o}}}},76601:function(e,t,n){"use strict";n.d(t,{k5:function(){return v},LU:function(){return C},Mc:function(){return S}});var i=n(49037),r=n(6946),o=n(61376),a=n(29758),s=n(63804),l=n.n(s),c=n(63931),d=n(66537),u=n(87357),p=n(83083),m=n(16305),h=n(51953),g=n(71520),f=n(54988),y=(0,n(19608).mergeStyles)({selectors:{"& .ms-TextField-prefix":{background:"transparent",paddingRight:0}}}),v=function(e,t,n,i){return l().createElement(g.TextField,{className:y,onRenderPrefix:void 0!==t?function(){return l().createElement("i",{onClick:e,style:{color:f.iX.gray120,fontWeight:400}},function(e){switch(e){case 0:return o.AllLabelsMap.equals.local;case 1:return o.AllLabelsMap.doesNotEqual.local;case 2:return o.AllLabelsMap.greaterThan.local;case 3:return o.AllLabelsMap.lessThan.local;case 4:return o.AllLabelsMap.greaterThanOrEqualTo.local;case 5:return o.AllLabelsMap.lessThanOrEqualTo.local;case 6:return o.AllLabelsMap.contains.local;case 7:return o.AllLabelsMap.doesNotContain.local;case 8:return o.AllLabelsMap.equals.local;case 9:return o.AllLabelsMap.doesNotEqual.local;case 10:return"Between";case 11:return"Not between";case 12:return o.AllLabelsMap.doesNotContainData.local;case 13:return o.AllLabelsMap.containsData.local;case 14:return o.AllLabelsMap.yesterday.local;case 15:return o.AllLabelsMap.today.local;case 16:return o.AllLabelsMap.tomorrow.local;case 17:return o.AllLabelsMap.lastSevenDays.local;case 18:return o.AllLabelsMap.nextSevenDays.local;case 19:return o.AllLabelsMap.lastWeek.local;case 20:return o.AllLabelsMap.thisWeek.local;case 21:return o.AllLabelsMap.nextWeek.local;case 22:return o.AllLabelsMap.lastMonth.local;case 23:return o.AllLabelsMap.thisMonth.local;case 24:return o.AllLabelsMap.nextMonth.local;case 25:return o.AllLabelsMap.on.local;case 26:return o.AllLabelsMap.onOrBefore.local;case 27:return o.AllLabelsMap.onOrAfter.local;case 28:return o.AllLabelsMap.lastYear.local;case 29:return o.AllLabelsMap.thisYear.local;case 30:return o.AllLabelsMap.nextYear.local;case 31:return o.AllLabelsMap.lastXHours.local;case 32:return o.AllLabelsMap.nextXHours.local;case 33:return o.AllLabelsMap.lastXDays.local;case 34:return o.AllLabelsMap.nextXDays.local;case 35:return o.AllLabelsMap.lastXWeeks.local;case 36:return o.AllLabelsMap.nextXWeeks.local;case 37:return o.AllLabelsMap.lastXMonths.local;case 38:return o.AllLabelsMap.nextXMonths.local;case 39:return o.AllLabelsMap.lastXYears.local;case 40:return o.AllLabelsMap.nextXYears.local;case 41:return o.AllLabelsMap.isCurrentUser.local;case 42:return o.AllLabelsMap.notCurrentUser.local;case 43:return o.AllLabelsMap.isCurrentBusinessUnit.local;case 44:return o.AllLabelsMap.notCurrentBusinessUnit.local;case 49:return o.AllLabelsMap.containValues.local;case 51:return o.AllLabelsMap.equalsCurrentUserLanguage.local;case 53:return o.AllLabelsMap.olderThanXMonths.local;case 54:return o.AllLabelsMap.beginsWith.local;case 55:return o.AllLabelsMap.doesNotBeginWith.local;case 56:return o.AllLabelsMap.endsWith.local;case 57:return o.AllLabelsMap.doesNotEndWith.local;case 58:return o.AllLabelsMap.thisFiscalYear.local;case 59:return o.AllLabelsMap.thisFiscalPeriod.local;case 60:return o.AllLabelsMap.nextFiscalYear.local;case 61:return o.AllLabelsMap.nextFiscalPeriod.local;case 62:return o.AllLabelsMap.lastFiscalYear.local;case 63:return o.AllLabelsMap.lastFiscalPeriod.local;case 64:return o.AllLabelsMap.lastXFiscalYears.local;case 65:return o.AllLabelsMap.lastXFiscalPeriods.local;case 66:return o.AllLabelsMap.nextXFiscalYears.local;case 67:return o.AllLabelsMap.nextXFiscalPeriods.local;case 68:return o.AllLabelsMap.inFiscalYear.local;case 69:return o.AllLabelsMap.inFiscalPeriod.local;case 70:return o.AllLabelsMap.inFiscalPeriodAndYear.local;case 71:return o.AllLabelsMap.inOrBeforeFiscalPeriodAndYear.local;case 72:return o.AllLabelsMap.inOrAfterFiscalPeriodAndYear.local;case 73:return o.AllLabelsMap.isCurrentUserTeams.local;case 74:return o.AllLabelsMap.isCurrentUserOrTeams.local;case 75:return o.AllLabelsMap.above.local;case 76:return o.AllLabelsMap.under.local;case 77:return o.AllLabelsMap.notUnder.local;case 78:return o.AllLabelsMap.aboveOrEqual.local;case 79:return o.AllLabelsMap.underOrEqual.local;case 80:return o.AllLabelsMap.isCurrentUserOrReportingHierarchy.local;case 81:return o.AllLabelsMap.isCurrentUserAndTeamsOrReportingHierarchyAndTeams.local;case 82:return o.AllLabelsMap.olderThanXYears.local;case 83:return o.AllLabelsMap.olderThanXWeeks.local;case 84:return o.AllLabelsMap.olderThanXDays.local;case 85:return o.AllLabelsMap.olderThanXHours.local;case 86:return o.AllLabelsMap.olderThanXMinutes.local;case 87:return o.AllLabelsMap.containValues.local;case 88:return o.AllLabelsMap.doesNotContainValues.local;default:return"Unknown Operator"}}(t)+(n?":":""))}:void 0,readOnly:!0,placeholder:n,onClick:function(){return e()},ariaLabel:n?(null==i?void 0:i.displayName)+" "+n:null==i?void 0:i.displayName})},C=function(e){return[E(e),b(e),F(e),N(e),D(e),T(e),x(e),L(e),I(e),A(e),O(e),V(e),z(e),(0,r.languageType)(e),M(e),R(e),k(e),_(e),P(e)]},S=function(e){return(0,o.defaultDataTypes)(e)};function E(e){return void 0===e&&(e=r.defaultStringTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.stringType)(e)),{defaultValueComponent:function(e){return l().createElement(p.w,(0,i.pi)({},e))}})}function b(e){return void 0===e&&(e=r.defaultStringTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.multilineStringType)(e)),{defaultValueComponent:function(e){return l().createElement(p.w,(0,i.pi)({},e))}})}function w(e){return void 0===e&&(e=r.defaultEnumTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.enumType)(e)),{defaultValueComponent:function(t){return l().createElement(u.S,(0,i.pi)({},t,{labels:e}))}})}function D(e){return void 0===e&&(e=r.defaultEnumTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.optionSet)(e)),{defaultValueComponent:function(t){return l().createElement(u.S,(0,i.pi)({},t,{labels:e}))}})}function T(e){return void 0===e&&(e=r.defaultEnumTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.multiOptionSet)(e)),{defaultValueComponent:function(t){return l().createElement(u.S,(0,i.pi)({},t,{labels:e}))}})}function x(e){return void 0===e&&(e=r.defaultEnumTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.twoOptions)(e)),{defaultValueComponent:function(t){return l().createElement(u.S,(0,i.pi)({},t,{labels:e}))}})}function k(e){return void 0===e&&(e=r.defaultEnumTypeLabels),(0,i.pi)((0,i.pi)({},w(e)),{name:a.EDataType.State})}function _(e){return void 0===e&&(e=r.defaultEnumTypeLabels),(0,i.pi)((0,i.pi)({},w(e)),{name:a.EDataType.Status})}function N(e,t){void 0===e&&(e=r.defaultDateTypeLabels);var n=(0,r.dateType)(e);return(0,i.pi)((0,i.pi)({},n),{defaultValueComponent:function(e){return l().createElement(c.M,(0,i.pi)({},e,{formatter:t}))}})}function L(e){return void 0===e&&(e=r.defaultLookupTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.lookupType)(e)),{defaultValueComponent:function(t){return l().createElement(d.F,(0,i.pi)({},t,{labels:e}))}})}function I(e){return void 0===e&&(e=r.defaultLookupTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.customerType)(e)),{defaultValueComponent:function(t){return l().createElement(d.F,(0,i.pi)({},t,{labels:e}))}})}function A(e){return void 0===e&&(e=r.defaultLookupTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.ownerType)(e)),{defaultValueComponent:function(t){return l().createElement(d.F,(0,i.pi)({},t,{labels:e}))}})}function R(e){return void 0===e&&(e=r.defaultLookupTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.uidType)(e)),{defaultValueComponent:function(t){return l().createElement(d.F,(0,i.pi)({},t,{labels:e}))}})}function F(e){return void 0===e&&(e=r.defaultWholeNumberTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.wholeNumberType)(e)),{defaultValueComponent:function(e){return l().createElement(m.D,(0,i.pi)({},e))}})}function P(e){return void 0===e&&(e=r.defaultWholeNumberTypeLabels),(0,i.pi)((0,i.pi)({},F(e)),{name:"Integer"})}function M(e){return void 0===e&&(e=r.defaultWholeNumberTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.durationType)(e)),{defaultValueComponent:function(t){return l().createElement(m.D,(0,i.pi)({},t,{valueSuffix:e.durationUnit}))}})}function O(e){return void 0===e&&(e=r.defaultCurrencyTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.currencyType)(e)),{defaultValueComponent:function(e){return l().createElement(h.k,(0,i.pi)({},e))}})}function V(e){return void 0===e&&(e=r.defaultFloatTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.floatType)(e)),{defaultValueComponent:function(e){return l().createElement(h.k,(0,i.pi)({},e))}})}function z(e){return void 0===e&&(e=r.defaultDecimalTypeLabels),(0,i.pi)((0,i.pi)({},(0,r.decimalType)(e)),{defaultValueComponent:function(e){return l().createElement(h.k,(0,i.pi)({},e))}})}},30323:function(e,t,n){"use strict";n.d(t,{Nz:function(){return l},VN:function(){return c},sB:function(){return d},YP:function(){return u},p5:function(){return p},sN:function(){return m},TO:function(){return h},Ro:function(){return g},eO:function(){return f},Zx:function(){return y},OO:function(){return v},Bv:function(){return C},hS:function(){return S},NA:function(){return E},I5:function(){return b},bS:function(){return w},sp:function(){return D},MZ:function(){return T}});var i=n(94589),r=n(54988),o=n(4432),a=n(19608),s=n(56569),l=(0,a.mergeStyles)({fontSize:i.TS.size20,color:r.iX.gray160,fontWeight:600}),c=(0,a.mergeStyles)({fontSize:i.TS.size12,fontWeight:400,color:o.I.digitalBlue,textDecoration:"none"}),d=(0,a.mergeStyles)({paddingTop:"8px",paddingLeft:"4px"}),u=(0,a.mergeStyles)({fontSize:i.TS.size12,fontWeight:400,color:r.iX.gray160}),p=(0,a.mergeStyles)({float:"right"}),m=(0,a.mergeStyles)({fontWeight:600}),h=(0,a.mergeStyles)({padding:"16px",paddingLeft:"30px"}),g=(0,a.mergeStyles)({width:16,height:16,color:"currentColor",fontSize:i.TS.size16}),f={root:{paddingLeft:20,paddingRight:20,borderBottom:"solid 1px",borderBottomColor:r.iX.gray20}},y={root:{paddingTop:8,paddingBottom:8,paddingLeft:16,paddingRight:16}},v={root:{color:r.iX.gray130},rootHovered:{color:r.iX.gray130},icon:{fontSizes:"14px"}},C={root:{padding:"10px 16px"}},S={root:{},overlay:{},hiddenPanel:{},main:{},commands:{},content:{padding:"0px"},contentInner:{},header:{},headerText:{},scrollableContent:s.X(),navigation:{},footer:{},footerInner:{},subComponentStyles:{closeButton:{}}},E={root:{paddingTop:8,paddingBottom:8}},b={root:{padding:8}},w={root:{width:"100%",padding:0,marginTop:8,marginBottom:8}},D={root:{paddingTop:"10px",paddingBottom:"10px"}},T={root:{padding:"0px 16px 12px 16px"}}},96990:function(e,t,n){"use strict";n.d(t,{hR:function(){return L}});var i=n(63804),r=n.n(i),o=n(67162),a=n(36711),s=n(87018),l=n(42093),c=n(17873),d=n(54106),u=n(30323),p=n(4476),m=n(76601),h=n(44120),g=n(48945),f=n(34251),y=n(52618),v=n(85683),C=n(92312),S=n(36957),E=n(79549),b=n(41380),w=n(65597),D=n(39780),T=n(6253),x=n(28741),k=o.PanelType.smallFixedFar,_=o.PanelType.medium,N="FilterPanel",L=function(e){var t=e.onDismiss,n=e.filterExpression,L=e.setFilterExpression,I=e.columnsStatus,A=(0,i.useState)(k),R=A[0],F=A[1],P=(0,v.R)("filterExpression"),M=P[0],O=P[1],V=(0,i.useState)(),z=V[0],B=V[1];(0,i.useEffect)((function(){B(n)}),[n]);var U=(0,f.o)(z),H=(0,c.M)("headerTooltip"),G=(0,c.M)("resetTooltip"),W=(0,i.useState)(),j=W[0],X=W[1],K=(0,i.useMemo)((function(){return j?Object.values(I).filter((function(e){return-1!==(null==e?void 0:e.displayName.toLocaleLowerCase().indexOf(j))})):Object.values(I)}),[I,j]),q=(0,i.useCallback)((function(){g.D.reportUserAction("handleClearFilterClicked",N,"Reset filters",{},"Reset filters",""),B(void 0)}),[]),Z=(0,i.useCallback)((function(){g.D.reportUserAction("handlePanelDismiss",N,"Cancel filter panel",{},"Cancel filter panel",""),B(n),null==t||t()}),[n,t]),J=(0,i.useCallback)((function(){g.D.reportUserAction("handleApplyClicked",N,"Apply filters",{filterExpression:z},"Apply filters",""),z!==M&&O(z),L(z),null==t||t()}),[z,M,t,L,O]),Q=(0,i.useCallback)((function(){g.D.reportUserAction("handleMoreFiltersClicked",N,"Navigate to More Filters",{},"Navigate to More Filters",""),F(_)}),[F]),Y=(0,i.useCallback)((function(){g.D.reportUserAction("handleMoreFiltersBackClicked",N,"Navigate back to Quick Filters",{},"Navigate back to Quick Filters",""),F(k)}),[F]),$=(0,i.useCallback)((function(){return r().createElement(a.Stack,{horizontal:!0,horizontalAlign:"end",verticalAlign:"center",tokens:{childrenGap:16}},r().createElement(a.Stack,{horizontal:!0,horizontalAlign:"start",grow:!0},r().createElement(l.TooltipHost,{content:r().createElement("p",{className:u.YP},g.D.getLocalizedString("WS_FilterPanel_Reset_ToolTip_Content")),id:G,calloutProps:{directionalHint:l.DirectionalHint.topCenter,calloutMaxWidth:200}},r().createElement(s.CommandBarButton,{text:g.D.getLocalizedString("WS_Reset"),iconProps:{iconName:"ResetFilter",className:u.Ro},onClick:q,styles:u.sp}))),r().createElement(s.PrimaryButton,{onClick:J},g.D.getLocalizedString("WS_Apply")),r().createElement(s.DefaultButton,{onClick:Z},g.D.getLocalizedString("WS_Cancel")))}),[G,J,Z,q]),ee=(0,i.useCallback)((function(e,t){var n=r().createElement(s.IconButton,{iconProps:{iconName:"Cancel",styles:u.OO},onClick:Z,className:u.p5,ariaLabel:g.D.getLocalizedString("WS_Close")});return R===_?r().createElement(a.Stack,{horizontal:!0,horizontalAlign:"start",verticalAlign:"center",tokens:{childrenGap:8},styles:u.Zx},r().createElement(s.IconButton,{title:g.D.getLocalizedString("WS_Back"),ariaLabel:g.D.getLocalizedString("WS_Back"),styles:u.OO,iconProps:{iconName:"Back"},onClick:Y}),r().createElement(E.x,{className:u.Nz},g.D.getLocalizedString("WS_FilterPanel_MoreFilters")),r().createElement(a.Stack.Item,{grow:!0},n)):r().createElement(a.Stack,{horizontal:!0,horizontalAlign:"start",verticalAlign:"center",tokens:{childrenGap:4},styles:u.Zx},r().createElement(E.x,{className:u.Nz},g.D.getLocalizedString("WS_FilterSidePanel_Header")),r().createElement(l.TooltipHost,{content:r().createElement(a.Stack,{tokens:{childrenGap:6},styles:u.MZ},r().createElement("p",{className:u.YP},g.D.getLocalizedString("WS_FilterPanel_Header_ToolTip_Content")),r().createElement("a",{onClick:function(){g.D.reportUserAction("getTooltipContent",N,"Open tooltip link",{},"Open tooltip link","")},href:"https://aka.ms/workspacefiltersfaq",target:"_blank",rel:"noopener noreferrer",className:u.VN},g.D.getLocalizedString("WS_LearnMore"))),id:H,calloutProps:{directionalHint:l.DirectionalHint.rightCenter,calloutMaxWidth:200}},r().createElement(S.FontIcon,{iconName:"Info",className:u.sB})),r().createElement(a.Stack.Item,{grow:!0},r().createElement(a.Stack.Item,{grow:!0},n)))}),[Y,Z,H,R]),te=(0,i.useCallback)((function(e,t){return R===k?r().createElement(a.Stack,{horizontalAlign:"start",styles:u.eO},r().createElement(w.SearchBox,{ariaLabel:g.D.getLocalizedString("WS_FilterBar_Filters_Search_Placeholder"),placeholder:g.D.getLocalizedString("WS_FilterBar_Filters_Search_Placeholder"),onChange:function(e,t){return X(null==t?void 0:t.toLocaleLowerCase())},styles:u.bS}),j&&r().createElement(D.O,{message:1===K.length?g.D.getLocalizedString("WS_FilterBar_Filters_Search_Singular_Count",K.length):g.D.getLocalizedString("WS_FilterBar_Filters_Search_Multiple_Count",K.length)}),r().createElement(a.Stack,{horizontal:!0,horizontalAlign:"start",verticalAlign:"center",styles:u.NA},r().createElement(s.CommandBarButton,{onRenderText:function(e){return r().createElement("span",null,g.D.getLocalizedString("WS_FilterPanel_MoreFilters"),r().createElement("span",{className:u.sN},0===U?"":" ("+U+")"))},iconProps:{iconName:"PageListFilter"},onClick:Q,styles:u.I5}))):null}),[R,j,K.length,Q,U]),ne=(0,i.useState)(void 0),ie=ne[0],re=ne[1],oe=(0,i.useState)([]),ae=oe[0],se=oe[1],le=(0,i.useState)([]),ce=le[0],de=le[1],ue=(0,i.useMemo)((function(){var t;return null!==(t=e.dataverseAccess)&&void 0!==t?t:p._.getDataverseAccess()}),[e.dataverseAccess]);(0,i.useEffect)((function(){ue.cdsResolver.getLocalizedLabels().then((function(e){re(e),se((0,m.LU)(e)),de((0,m.Mc)(e))}),(function(e){g.D.reportError("getLocalizedLabels",N,"Failed to retrieve the localized labels for the CDS expression builder control",{error:e})}))}),[]);var pe=e.entityMetadata.get(e.entityType),me=0===ae.length;return r().createElement(o.Panel,{isOpen:e.isOpen,styles:u.hS,onDismiss:Z,isLightDismiss:!0,type:R,onRenderHeader:te,onRenderFooterContent:$,isFooterAtBottom:!0,onRenderNavigation:ee,isHiddenOnDismiss:!0},R===_&&r().createElement("div",{className:u.TO},ie&&r().createElement(d.Oy,{filterExpression:z,labels:ie,dataTypes:ce,entityName:e.entityType,dataverseAccess:ue,onExpressionChanged:function(e){B(null!=e?e:void 0)}})),R===k&&r().createElement(r().Fragment,null,me&&r().createElement(b.$,null),!me&&r().createElement(a.Stack,{tokens:{childrenGap:16},styles:u.Bv},(null==K?void 0:K.length)?K.filter((function(e){return!e.isHidden})).sort((function(e,t){return e.index-t.index})).map((function(t){if(t.entityType===e.entityType&&!t.fieldName.includes(".")){var n=e.attributesMetadata.get(t.fieldName);if(n)return function(e){var t=ae.find((function(t){return e.dataType===t.name}));return t?r().createElement(h.O,{key:e.name,expression:z,onExpressionChange:function(e){B(e)},onReadonlyClick:function(){F(_)},dataType:t,entity:pe,field:e,dataverseAccess:ue}):(console.error("[FilterPanel] Encountered field with unsupported dataType:  "+e.dataType),void g.D.reportError("FilterPanel",N,y.dS.FAILED,{error:"Encountered field with unsupported dataType",field:e,dataType:e.dataType}))}(n);console.error("[FilterPanel] Could not map column to field:  "+t.displayName),g.D.reportError("FilterPanel",N,y.dS.FAILED,{error:"Could not map column to field",column:t})}})):r().createElement(T.u,{getScenario:function(){return x.yW.SearchReturnedEmpty},showButton:!1}))),r().createElement(C.U,{flagName:"debugFilterPanel",toggleable:!0},r().createElement("span",{style:{whiteSpace:"pre-wrap"}},JSON.stringify(z,null,2))))}},54106:function(e,t,n){"use strict";n.d(t,{QR:function(){return d},ZQ:function(){return u},jd:function(){return p},Oy:function(){return h}});var i=n(63804),r=n.n(i),o=n(8855),a=n(64858),s=n(14959);function l(e){switch(e){case 0:return"and";case 1:return"or"}throw"invalid filter operator: "+e.toString()}function c(e){switch(e){case 0:return"eq";case 1:return"ne";case 2:return"gt";case 3:return"lt";case 4:return"ge";case 5:return"le";case 6:return"like";case 7:return"not-like";case 8:return"in";case 9:return"not-in";case 10:return"between";case 11:return"not-between";case 12:return"null";case 13:return"not-null";case 14:return"yesterday";case 15:return"today";case 16:return"tomorrow";case 17:return"last-seven-days";case 18:return"next-seven-days";case 19:return"last-week";case 20:return"this-week";case 21:return"next-week";case 22:return"last-month";case 23:return"this-month";case 24:return"next-month";case 25:return"on";case 26:return"on-or-before";case 27:return"on-or-after";case 28:return"last-year";case 29:return"this-year";case 30:return"next-year";case 31:return"last-x-hours";case 32:return"next-x-hours";case 33:return"last-x-days";case 34:return"next-x-days";case 35:return"last-x-weeks";case 36:return"next-x-weeks";case 37:return"last-x-months";case 38:return"next-x-months";case 39:return"last-x-years";case 40:return"next-x-years";case 41:return"eq-userid";case 42:return"ne-userid";case 43:return"eq-businessid";case 44:return"ne-businessid";case 49:return"contain-values";case 51:return"eq-userlanguage";case 53:return"olderthan-x-months";case 54:return"begins-with";case 55:return"not-begin-with";case 56:return"ends-with";case 57:return"not-end-with";case 58:return"this-fiscal-year";case 59:return"this-fiscal-period";case 60:return"next-fiscal-year";case 61:return"next-fiscal-period";case 62:return"last-fiscal-year";case 63:return"last-fiscal-period";case 64:return"last-x-fiscal-years";case 65:return"last-x-fiscal-periods";case 66:return"next-x-fiscal-years";case 67:return"next-x-fiscal-periods";case 68:return"in-fiscal-year";case 69:return"in-fiscal-period";case 70:return"in-fiscal-period-and-year";case 71:return"in-or-before-fiscal-period-and-year";case 72:return"in-or-after-fiscal-period-and-year";case 73:return"eq-userteams";case 74:return"eq-useroruserteams";case 75:return"above";case 76:return"under";case 77:return"not-under";case 78:return"eq-or-above";case 79:return"eq-or-under";case 80:return"eq-useroruserhierarchy";case 81:return"eq-useroruserhierarchyandteams";case 82:return"olderthan-x-years";case 83:return"olderthan-x-weeks";case 84:return"olderthan-x-days";case 85:return"olderthan-x-hours";case 86:return"olderthan-x-minutes";case 87:return"contain-values";case 88:return"not-contain-values"}throw"invalid condition operator: "+e.toString()}var d=function(e){return(0,a.convertFetchXmlToFetchExpression)(e)},u=function(e){return(0,a.convertFetchXmlToFilterExpression)(e)},p=function(e,t){var n,i,r,o,a;t||(t=function(e){return e});var s="";if(!(null===(n=e.filters)||void 0===n?void 0:n.length)&&!(null===(i=e.conditions)||void 0===i?void 0:i.length))return s;if(null===(r=e.conditions)||void 0===r?void 0:r.length){s+='<filter type="'+l(e.filterOperator)+'"',s+=">";for(var d=0;d<e.conditions.length;d++){var u=e.conditions[d];if(s+="<condition ",u.entityAliasName&&(s+='entityname="'+u.entityAliasName+'" '),null==u.value)s+='attribute="'+u.attributeName+'" operator="'+c(u.conditionOperator)+'"/>';else if("string"==typeof u.value||"number"==typeof u.value)s+='attribute="'+u.attributeName+'" operator="'+c(u.conditionOperator)+'" value="'+t(u.value)+'" />';else{var m=u.value;s+='attribute="'+u.attributeName+'" operator="'+c(u.conditionOperator)+'">';for(var h=0;h<m.length;h++)s+="<value>"+t(m[h])+"</value>";s+="</condition>"}}null===(o=e.filters)||void 0===o||o.forEach((function(e){s+=p(e,t)})),s+="</filter>"}else(null===(a=e.filters)||void 0===a?void 0:a.length)&&(s+='<filter type="'+l(e.filterOperator)+'">',e.filters.forEach((function(e){s+=p(e,t)})),s+="</filter>");return s},m=function(e){return'<fetch version="1.0" output-format="xml-platform" mapping="logical"><entity name="opportunity">'+e+"</entity></fetch>"},h=function(e){var t=e.filterExpression,n=(0,i.useMemo)((function(){return void 0===t?{fetchXml:m("")}:{fetchXml:m(p(t,s.I))}}),[t]);return r().createElement(o.CDSExpressionBuilderWithResolver,{cdsResolver:e.dataverseAccess.cdsResolver,entityName:e.entityName,onFetchXmlChanged:function(t){e.onExpressionChanged(u(t))},onFetchXmlValidationFailed:function(e){},dataTypes:e.dataTypes,query:n,labels:e.labels,isReadOnly:!1})}},44120:function(e,t,n){"use strict";n.d(t,{O:function(){return h}});var i=n(49037),r=n(63804),o=n.n(r),a=n(99506),s=n(29758),l=n(41199),c=n(69041),d=n(76601),u=n(48945),p=function(){var e=new Map([[s.EDataType.Unknown,[]],[s.EDataType.String,[c.F1]],[s.EDataType.MultilineText,[c.F1]],[s.EDataType.OptionSet,[c._Y,c.DV]],[s.EDataType.MultiOptionSet,[c._Y,c.DV]],[s.EDataType.TwoOptions,[c._Y,c.DV]],[s.EDataType.Lookup,[c._Y,c.DV]],[s.EDataType.Customer,[c._Y,c.DV]],[s.EDataType.Owner,[c._Y,c.DV]],[s.EDataType.UniqueIdentifier,[c._Y,c.DV]],[s.EDataType.State,[c._Y,c.DV]],[s.EDataType.Status,[c._Y,c.DV]]]);return{getValueComponent:function(e){var t=e.operators.find((function(e){return"eq"===e.name})),n=null==t?void 0:t.valueComponent;return null!=n?n:e.defaultValueComponent},getConditions:function(e,t){var n;return e&&null!==(n=(0,c.Nd)(e).get(t.name))&&void 0!==n?n:[]},getDisplayType:function(t,n){if(t.some((function(e){return e.isInOr})))return"complex";switch(t.length){case 0:return"placeholder";case 1:var i=t[0].conditionOperator,r=e.get(n);return 0!==t[0].level?"complex":(null==r?void 0:r.includes(i))?"value":"opValue";case 2:return(0,c.PU)(t)?1!==t[0].level?"complex":"range":"complex";default:return"complex"}},getValue:function(e){return e instanceof Array?[e[0].value,e[1].value]:function(e){var t,n,i=function(e){return e.replace("{","").replace("}","")},r=function(e){return 0===e.indexOf("{")&&e.indexOf("}")===e.length-1};if(e)return e instanceof Array?r(e[0])?e.map((function(e){return{id:i(e)}})):""+e.join(","):r(e)?[{id:i(e)}]:0===(n=(t=e).indexOf("%"))||n===t.length-1?e.replaceAll("%",""):e}(e.value)},isEnumType:function(e){return e===s.EDataType.MultiOptionSet||e===s.EDataType.OptionSet||e===s.EDataType.TwoOptions||e===s.EDataType.State||e===s.EDataType.Status},isObjectType:function(e){return e===s.EDataType.Lookup||e===s.EDataType.Customer||e===s.EDataType.Owner||e===s.EDataType.UniqueIdentifier},isNumberType:function(e){return e===s.EDataType.WholeNumber||e===s.EDataType.Float||e===s.EDataType.Decimal||e===s.EDataType.Currency},isDateType:function(e){return e===s.EDataType.Date}}},m="QuickFilters",h=function(e){var t,n=p().getValueComponent(e.dataType),r=p().getConditions(e.expression,e.field),h=p().getDisplayType(r,e.field.dataType);if("complex"===h)return o().createElement("div",null,o().createElement(a.Label,null,e.field.displayName),(0,d.k5)(e.onReadonlyClick,void 0,u.D.getLocalizedString("WS_Multiple_Filter_Selected"),e.field));if((p().isNumberType(e.dataType.name)||p().isDateType(e.dataType.name))&&"opValue"!==h){var g=2!==r.length?["",""]:p().getValue(r);return o().createElement("div",null,o().createElement(a.Label,null,e.field.displayName),o().createElement(l.s,{ValueComponent:n,range:g,min:e.field.minValue,max:e.field.maxValue,isDateRange:p().isDateType(e.dataType.name),onChange:function(t){if(u.D.reportUserAction("handleValueComponentRangeChange",m,"Quick Filer value changed",{rangeComponent:!0,valueComponentName:n.name,range:t},(0,l.a)(t)?"Quick filters cleared":"Quick filters changed",""),(0,l.a)(t)){var i=(0,c.Vc)(e.expression,e.field.name);e.onExpressionChange(i)}else{var r=function(e,t,n){var i=p().isDateType(t)?[c.HG,c.c6]:[c.HJ,c.FT];return[{attributeName:n,conditionOperator:i[0],value:e[0]},{attributeName:n,conditionOperator:i[1],value:e[1]}]}(t,e.dataType.name,e.field.name);i=(0,c.DM)(e.expression,r),e.onExpressionChange(i)}},field:e.field}))}var f=0===r.length?"":p().getValue(r[0]),y=null===(t=r[0])||void 0===t?void 0:t.conditionOperator,v={operator:"opValue"===h?y:void 0,onReadonlyClick:e.onReadonlyClick};return o().createElement("div",null,o().createElement(a.Label,null,e.field.displayName),o().createElement(n,(0,i.pi)({value:f,resolver:e.dataverseAccess.cdsResolver,onChange:function(t,n){if(u.D.reportUserAction("handleValueComponentChange",m,"Quick Filer value changed",{rangeComponent:!1,dataType:e.dataType.name,newValue:t},0===t.length?"Quick filters cleared":"Quick filters changed",""),0===t.length){var i=(0,c.d2)(e.expression,e.field.name);e.onExpressionChange(i)}else{var r=function(e,t,n){var i=e,r=c._Y;if(p().isEnumType(t)){var o=i.split(",");1!==o.length&&(i=o,r=c.DV)}if(p().isObjectType(t)){var a=i.map((function(e){return"{"+e.id+"}"}));i=a[0],1!==a.length&&(i=a,r=c.DV)}return t!==s.EDataType.String&&t!==s.EDataType.MultilineText||(i="%"+i+"%",r=c.F1),{attributeName:n,conditionOperator:r,value:i}}(t,e.dataType.name,e.field.name);i=(0,c.aX)(e.expression,r),e.onExpressionChange(i)}},entityContext:e.entity,fieldContext:e.field,ariaLabel:f?e.field&&e.field.displayName+" "+f:e.field&&e.field.displayName},v)))}},55535:function(e,t,n){"use strict";n.d(t,{m:function(){return p}});var i=n(49037),r=n(63804),o=n.n(r),a=n(1080),s=n(59731),l=n(17875),c=n(74872),d=n(4476),u=n(48945),p=function(e){var t,n=e.context,r=e.primaryEntity,p=n.theming;o().useEffect((function(){l.l.initializeTheme(p)}),[p]),o().useEffect((function(){u.D.reportInfo("inContextView","External","New panel instance is opened",{})}),[]);var m=null!==(t=e.recordContainerContext)&&void 0!==t?t:d._.getContainerContext(n),h=(0,i.pi)((0,i.pi)({},e),{entity:r,viewMode:s.wO.Default,recordContainerContext:m,services:{dataService:new c.D(n,m)}});return o().createElement(a.W,(0,i.pi)({},h))}},44981:function(e,t,n){"use strict";n.d(t,{o:function(){return o},i:function(){return a}});var i=n(54988),r=n(19608),o=(0,r.mergeStyles)({background:"transparent",paddingTop:8,paddingBottom:8}),a=(0,r.mergeStyles)({background:i.iX.gray20})},62798:function(e,t,n){"use strict";n.d(t,{V:function(){return u}});var i=n(49037),r=n(63804),o=n(31209),a=n(93267),s=n(40918),l=n(48945),c=n(44981),d="LayoutTypeSelector",u=function(e){var t=e.layoutType,n=e.setLayoutType,u=e.onEditStatsClick,p=e.entityType,m=function(e){switch(e){case"list":return l.D.getLocalizedString("WS_FilterBar_List");case"board":return l.D.getLocalizedString("WS_FilterBar_Board");case"combo":return l.D.getLocalizedString("WS_FilterBar_Combo");default:return""}},h=function(t){return t===e.layoutType?c.i:void 0},g=function(){var e={directionalHint:o.b.bottomAutoEdge,items:[{key:"list",className:h("list"),text:m("list"),iconProps:{iconName:"List"},onClick:function(){l.D.reportUserAction("onSelectLayoutType",d,"Select list layout type",{layoutType:"list"},"Select list layout type",""),n("list")}}]},t=l.D.getFeatureSupport(p);return t.isChartSupported&&e.items.push({key:"combo",className:h("combo"),text:m("combo"),iconProps:{iconName:"ViewAll2"},onClick:function(){l.D.reportUserAction("onSelectLayoutType",d,"Select combo layout type",{layoutType:"combo"},"Select combo layout type",""),null==n||n("combo")}}),t.isStatsSupported&&e.items.push({key:"divider",itemType:a.n.Divider},{key:"stats",text:l.D.getLocalizedString("WS_FilterBar_EditMetrics"),onClick:function(){l.D.reportUserAction("onSelectEditStats",d,"stats",{},"click",""),l.D.reportUserAction("StatsSidePanel",d,"stats",{},"stats side panel open",""),u()}}),e},f=g(),y=f.items.find((function(e){return e.key===t}));if(!y){var v=f.items[0];console.warn("[LayoutTypeSelector] Invalid layout type from props: "+t+". Falling back to first item in layout type items: "+v+"."),y=v}var C={iconProps:y.iconProps,text:y.text,menuProps:g(),className:c.o};return r.createElement(s.Q,(0,i.pi)({},C))}},63088:function(e,t,n){"use strict";n.d(t,{k:function(){return g}});var i=n(63804),r=n.n(i),o=n(19608),a=n(1367),s=n(9433),l=n(79549),c=n(31209),d=n(59144),u=n(27196),p=n(17873),m=n(48945),h=(0,o.mergeStyles)({paddingLeft:8,marginTop:5}),g=function(e){var t=m.D.getLocalizedString("WS_Chart_Bubble_XAxis_Title_Tooltip").split("{0}"),n=t[0],i=t[1],o=(0,p.M)("closeDateInfoTooltipId");return(0,u.createPortal)(r().createElement(a.G,{content:r().createElement(s.K,{tokens:{childrenGap:16}},r().createElement(l.x,null,n),r().createElement(l.x,null,i)),id:o,calloutProps:{directionalHint:c.b.rightCenter,calloutMaxWidth:200,gapSpace:14}},r().createElement(d.xu,{className:h,iconName:"Info"})),e.container)}},72308:function(e,t,n){"use strict";n.d(t,{j:function(){return p}});var i=n(63804),r=n.n(i),o=n(19608),a=n(79549),s=n(48945),l=n(17754),c=n(28741),d={fontSize:o.FontSizes.size12,fontWeight:o.FontWeights.regular,color:l.rQ.palette.neutralSecondary,lineHeight:24},u=(0,o.mergeStyles)(o.AnimationStyles.fadeIn100,{position:"absolute",bottom:0,right:0},d),p=function(e){var t=s.D.getLocalizedString("WS_Chart_Bubble_Number_of_Records",c.gT.recordLimit,e.entityDisplayCollectionName);return r().createElement(a.x,{className:u},t)}},30100:function(e,t,n){"use strict";n.d(t,{O:function(){return c}});var i=n(11231),r=n(86705),o=n(69041),a=n(48945),s=n(28741).gT.recordLimit;function l(e,t){return Array.isArray(e)?null==e?void 0:e[t]:0===t?e:void 0}var c=function(){var e=this;this.tooltipFields=[],this.getChartOptions=function(t,n,r,s,c,d){var u,p,m,h=[],g=null!==(p=null===(u=null==d?void 0:d.linking)||void 0===u?void 0:u.getLinkedEntities())&&void 0!==p?p:[],f=null!==(m=null==d?void 0:d.columns)&&void 0!==m?m:[];function y(e){if(e){var t;if(e.entityName!==s){if(void 0===e.linkEntity){var n=e.entityName+"id";e.linkEntity={name:e.entityName,from:n,to:n}}var i=(0,o.pr)(g,e.linkEntity);t=i&&i.alias+"."+e.fieldName}else t=e.fieldName;return t&&f.some((function(e){return e.name===t}))||h.push(e),null!=t?t:e.fieldName+"__missing_pending_add"}}e.chartEntityAttributesMap={xAxis:y(l(t.xAxisFieldConfig,0)),xAxisSecondary:y(l(t.xAxisFieldConfig,1)),yAxis:y(t.yAxisFieldConfig),size:y(l(t.bubbleSizeFieldConfig,0)),sizeSecondary:y(l(t.bubbleSizeFieldConfig,1)),statusField:y({entityName:s,fieldName:"statecode"}),category:y(t.segmentedByFieldConfig||{entityName:s,fieldName:"stepname"}),toolTipTitle:y({entityName:s,fieldName:"name"})},e.tooltipFields=[];for(var v=0,C=t.tooltipFieldNames;v<C.length;v++){var S=C[v];e.tooltipFields.push({columnName:y(S.fieldConfig),visibility:S.visibility})}var E=e.isFieldNameSIScore(e.chartEntityAttributesMap.yAxis),b=e.getFieldDisplayName(r,e.chartEntityAttributesMap.xAxis),w=E?a.D.getLocalizedString("WS_Chart_Predictive_Opty_Score"):e.getFieldDisplayName(r,e.chartEntityAttributesMap.yAxis),D=i.v.colorPalettesByResource[t.colorPalette],T=e.getSeriesData(Object.assign([],n),D);return T?[{chart:{type:"bubble",plotBorderWidth:1,plotBorderColor:i.v.lineColor,reflow:!0,height:"350",style:{fontFamily:"Segoe UI"}},legend:{align:"left",padding:2,itemStyle:{fontWeight:400,fontSize:"12px",color:i.v.labelColorDark,cursor:"default"},reversed:"finishToStart"===t.sortLegendType},title:{text:""},xAxis:e.getXAxisConfig(b,T.hasOpenOpty,T.hasClosedOpty),yAxis:e.getYAxisConfig(w),credits:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"",borderWidth:"0px",backgroundColor:"transparent",borderColor:"transparent",borderRadius:"0px",footerFormat:"",pointFormat:e.getTooltip(r),followPointer:!1},plotOptions:{series:{events:{click:function(e){c(e.point.recordId),a.D.reportUserAction("click","BubbleChart","Bubble marker clicked",{},"BubbleClick","")},legendItemClick:function(){return!1}},states:{inactive:{opacity:1}}},bubble:{cursor:"pointer",minSize:32,maxSize:92}},series:T},h]:[void 0,h]},this.getYAxisConfig=function(e){return{gridLineColor:i.v.lineColor,title:{text:e,style:{fontWeight:"400",color:i.v.labelColorDark},margin:15},startOnTick:!1,endOnTick:!1,accessibility:{rangeDescription:"Range: 0 to 100."},minPadding:.1,maxPadding:.1,labels:{style:{color:i.v.labelColorLightDark}}}},this.getXAxisConfig=function(t,n,r){return{gridLineWidth:1,gridLineColor:i.v.lineColor,lineColor:i.v.lineColor,currentDateIndicator:{zIndex:s,width:3,dashStyle:"solid",color:i.v.labelColorDark,label:{format:a.D.getLocalizedString("WS_Chart_Bubble_Today","%m/%d"),style:{fontSize:"12px",fontFamily:"Segoe UI",fontWeight:"600",backgroundColor:"#FFF",marginTop:"-3px"},textAlign:"center",marginTop:"-3px",useHTML:!0}},type:"datetime",labels:{format:"{value:%m/%d/%y}",y:27,style:{color:i.v.labelColorLightDark}},accessibility:{rangeDescription:"Time"},startOnTick:!0,endOnTick:!0,tickColor:i.v.lineColor,tickLength:0,title:{text:e.getXAxisTitle(t,n,r),style:{fontWeight:"400",color:i.v.labelColorDark,display:"flex",justifyContent:"center",alignItems:"center"},useHTML:n&&r,margin:16,offset:49}}},this.getXAxisTitle=function(t,n,i){var r=t||"";if(e.chartEntityAttributesMap.xAxisSecondary){var o=n&&i?"Close_Date":n?"WS_Chart_Est_Close_Date":"WS_Chart_Actual_Close_Date";r=a.D.getLocalizedString(o)}return r},this.getSeriesData=function(t,n){if(0===t.length)return null;var i={},r=0,o=!1,a=!1;if(t.sort((function(t,n){return e.getXAxisDate(n)-e.getXAxisDate(t)})).forEach((function(t){if(!t.isSaveInProgress){var n=e.getDataRow(t);n&&n.category&&null!=n.x&&null!=n.y&&null!=n.z&&r<s&&(0===n.statecode?o=!0:1!==n.statecode&&2!==n.statecode||(a=!0),i[n.category]||(i[n.category]=[]),i[n.category].push(n),r++)}})),Object.keys(i).length>0){var l=Object.keys(i).sort((function(e,t){return e<t?-1:1})).map((function(t){var r=i[t]&&i[t].length&&i[t][0],o=e.getStyledMarker(t,n);return{name:r&&r.categoryFormatted,data:i[t],marker:o,color:o.states.normal.lineColor}}));return l.hasClosedOpty=a,l.hasOpenOpty=o,l}return null},this.getDataRow=function(t){var n,r,o,s=e.getStateCode(t),l=e.getXAxisDate(t,s),c=t.values.get(e.chartEntityAttributesMap.yAxis)||0,d=e.getBubbleSize(t,s)||0,u=e.chartEntityAttributesMap.category.includes("msdyn_grade"),p=i.v.getCategoryResourceName(t.values.get(e.chartEntityAttributesMap.category),s,u),m=null===(o=null===(r=null===(n=e.getStyledMarker(p,i.v.colorPalettesByResource.health))||void 0===n?void 0:n.states)||void 0===r?void 0:r.normal)||void 0===o?void 0:o.lineColor,h=u&&p!=i.v.optyGradeResources.closed&&p!=i.v.optyGradeResources.unknown?t.formattedValues.get(e.chartEntityAttributesMap.category):a.D.getLocalizedString(p),g={x:l,y:c,z:d,recordId:t.recordId,category:p,categoryFormatted:h,toolTipTitle:t.formattedValues.get(e.chartEntityAttributesMap.toolTipTitle)||"-",displayValueForOpenOptyAttributes:0===s?"flex":"none",displayValueForClosedOptyAttributes:0===s?"none":"flex",displayIconForSIOrg:0===s?"flex":"none",gradeColor:m,statecode:s};return e.tooltipFields.forEach((function(e){g["toolTip"+e.columnName.replace(".","")]=t.formattedValues.get(e.columnName)||"-"})),g},this.getXAxisDate=function(t,n){n=null!=n?n:e.getStateCode(t);var i=e.chartEntityAttributesMap.xAxisSecondary&&0!==n?"xAxisSecondary":"xAxis",r=t.values.get(e.chartEntityAttributesMap[i]);return isNaN(+r)?Date.parse(r):+r},this.getBubbleSize=function(t,n){var i=e.chartEntityAttributesMap.sizeSecondary&&0!==n?"sizeSecondary":"size";return t.values.get(e.chartEntityAttributesMap[i])},this.getStateCode=function(t){return(0,r.q)(t.values.get(e.chartEntityAttributesMap.statusField))},this.getStyledMarker=function(e,t){var n=t[e]||t[i.v.optyGradeResources.closed];return{states:{hover:{fillColor:n.hoverFill,lineColor:n.hoverLine,lineWidth:"3px",animation:!1},normal:{fillColor:n.restFill,lineColor:n.restLine,lineWidth:"1px",animation:!1}}}},this.getTooltip=function(t){return"<div class='salesControls-chart-tooltip'><div class='salesControls-chart-tooltip-header'>{point.toolTipTitle}</div>"+e.tooltipFields.map((function(n){var i=void 0;"openRecordOnly"===n.visibility&&(i="displayValueForOpenOptyAttributes"),"closedRecordOnly"===n.visibility&&(i="displayValueForClosedOptyAttributes");var r=e.isFieldNameSIScore(n.columnName);return e.getTooltipRow(t,n.columnName,i,r?"gradeColor":void 0,r?"displayIconForSIOrg":void 0)})).join("")},this.getTooltipRow=function(t,n,i,r,o){var a=e.getFieldDisplayName(t,n),s="toolTip"+(null==n?void 0:n.replace(".",""));return a&&s?"<div class='salesControls-chart-tooltip-field' "+(i?"style='display:{point."+i+"}'":"")+"><div class='salesControls-chart-tooltip-fieldheading'>"+a+"</div><div class='salesControls-chart-tooltip-fieldvalue "+(r&&o?"":"salesControls-nowrap")+"'>"+(r&&o?"<span  class='fabricMDLIcons2_Dot' style='display:{point."+o+"};color:{point.gradeColor}'></span>":"")+"{point."+s+"}</div></div>":""},this.getFieldDisplayName=function(e,t){var n=e[t];return null==n?void 0:n.replace(".","")},this.isFieldNameSIScore=function(e){return e.includes("msdyn_score")&&!e.includes("msdyn_scoretrend")}}},45159:function(e,t,n){"use strict";n.d(t,{i:function(){return D},k:function(){return T}});var i=n(49037),r=n(63804),o=n.n(r),a=n(72708),s=n.n(a),l=n(59412),c=n.n(l),d=n(91259),u=n.n(d),p=n(78464),m=n.n(p),h=n(5373),g=n(10176),f=n(91847),y=n(30100),v=n(96056),C=n(6253),S=n(97369),E=n(28741),b=n(63088),w=n(72308),D=function(e){var t=e.columns.map((function(e){return e.name}));return Object.values(e.records).map((function(e){return{recordId:e.getRecordId(),values:t.reduce((function(t,n){return t.set(n,e.getValue(n))}),new Map),formattedValues:t.reduce((function(t,n){return t.set(n,e.getFormattedValue(n))}),new Map)}}))};m()(s()),u()(s());var T=function(e){var t,n,a,l,d=e.dataset,u=e.columnInfo,p=e.entityType,m=e.entityDisplayCollectionName,D=e.chartSettings,T=e.onClick,x=e.resizeChartComponent,k=e.webApi,_=e.setFilterPanelIsOpen,N=e.combinedAggregateFetchXml,L=e.modifyFilterExpression,I=e.gridParam,A=e.addColumnsToDataset,R=(0,r.useState)(),F=R[0],P=R[1],M=(0,r.useState)(!0),O=M[0],V=M[1],z=(0,r.useState)(null===(t=null==D?void 0:D.find((function(e){return e.status})))||void 0===t?void 0:t.id),B=z[0],U=z[1];(0,r.useEffect)((function(){var e;U(null===(e=null==D?void 0:D.find((function(e){return e.status})))||void 0===e?void 0:e.id)}),[D]);var H=(0,r.useRef)(null),G=(0,r.useCallback)((function(){var e,t=null!==(e=H.current)&&void 0!==e?e:{},n=t.chart,i=t.container;i&&n&&(i.current.style.width="100%",i.current.style.overflow="auto",n.reflow())}),[H]);(0,r.useEffect)((function(){return G()})),(0,r.useEffect)((function(){return null==x?void 0:x(G)}),[G,x]);var W=o().useMemo((function(){return u?Object.fromEntries(u.map((function(e){return[e.name,e.displayName]}))):{}}),[u]);(0,r.useEffect)((function(){var e=null==D?void 0:D.find((function(e){return e.id===B}));e&&(V(!0),d&&p&&k&&(0,i.mG)(void 0,void 0,void 0,(function(){var t,n,r,o;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return t=void 0,"bubble"!==e.type?[3,1]:(n=(new y.O).getChartOptions(e,d,W,p,(function(e){return T(e,p)}),I),r=n[0],o=n[1],t=r,o.length>0&&(null==A||A(o)),[3,3]);case 1:return[4,(new v.G).getChartOptions(k,N,L)];case 2:t=i.sent(),i.label=3;case 3:return P(t),V(!1),[2]}}))})))}),[W,D,d,p,T,B,k,N,L,I,A]);var j=(0,r.useState)(),X=j[0],K=j[1],q=(0,r.useCallback)((function(e){return K(e)}),[]),Z=(null===(n=null==F?void 0:F.series)||void 0===n?void 0:n.hasOpenOpty)&&(null===(a=null==F?void 0:F.series)||void 0===a?void 0:a.hasClosedOpty),J=(0,r.useMemo)((function(){var e,t,n;return Z?null===(n=null===(t=null===(e=null==X?void 0:X.xAxis)||void 0===e?void 0:e[0])||void 0===t?void 0:t.axisTitle)||void 0===n?void 0:n.element:void 0}),[null==X?void 0:X.xAxis,Z]),Q=(null==d?void 0:d.length)||0,Y="bubble"===(null===(l=null==D?void 0:D.find((function(e){return e.id===B})))||void 0===l?void 0:l.type)&&Q>=E.gT.recordLimit;return o().createElement("div",{className:"chartContainer"},o().createElement(f.Stack,{className:"chartStack"},o().createElement(h.Pivot,{className:"chartPivot",headersOnly:!0,selectedKey:B,onLinkClick:function(e,t){var n;U(null===(n=null==e?void 0:e.props)||void 0===n?void 0:n.itemKey)}},null==D?void 0:D.filter((function(e){return e.status})).map((function(e){return o().createElement(h.PivotItem,{headerText:e.chartName,itemKey:e.id})}))),o().createElement("div",{className:"chart"},o().createElement(g.Shimmer,{styles:S.W.getChartShimmerStyles(),customElementsGroup:S.W.getGridOrChartShimmer(),isDataLoaded:!O},F?o().createElement(o().Fragment,null,o().createElement(c(),{highcharts:s(),options:F,ref:H,immutable:!0,callback:q}),J&&o().createElement(b.k,{container:J}),Y&&o().createElement(w.j,{entityDisplayCollectionName:m||""})):o().createElement(C.u,{getScenario:function(){return E.yW.NoData},showButton:!0,setFilterPanelIsOpen:_})))))}},11231:function(e,t,n){"use strict";var i,r;n.d(t,{v:function(){return l}});var o={hoverFill:"rgba(136, 136, 136, 0.7)",hoverLine:"#888888",restFill:"rgba(217, 217, 217, 0.3)",restLine:"#888888"},a=[{hoverFill:"rgba(14, 123, 14, 0.6)",hoverLine:"#0E7B0E",restFill:"rgba(36, 161, 72, 0.25)",restLine:"#0E7B0E"},{hoverFill:"rgb(197, 137, 7, 0.6)",hoverLine:"#C58907",restFill:"rgba(255, 185, 0, 0.25)",restLine:"#C58907"},{hoverFill:"rgba(211, 86, 29, 0.6)",hoverLine:"#D3561D",restFill:"rgba(255, 130, 41, 0.25)",restLine:"#D3561D"},{hoverFill:"rgba(168, 0, 0, 0.6)",hoverLine:"#A80000",restFill:"rgba(218, 30, 40, 0.25)",restLine:"#A80000"}],s=[{hoverFill:"rgba(0, 43, 117, 0.6)",hoverLine:"#002B75",restFill:"rgba(0, 43, 117, 0.25)",restLine:"#001842"},{hoverFill:"rgba(193, 26, 40, 0.6)",hoverLine:"#C11A28",restFill:"rgba(232, 87, 99, 0.25)",restLine:"#C11A28"},{hoverFill:"rgba(121, 8, 87, 0.6)",hoverLine:"#790857",restFill:"rgba(121, 8, 87, 0.25)",restLine:"#480534"},{hoverFill:"rgba(17, 90, 182, 0.6)",hoverLine:"#115AB6",restFill:"rgba(65, 141, 237, 0.35)",restLine:"#115AB6"},{hoverFill:"rgba(92, 24, 134, 0.6)",hoverLine:"#5C1886",restFill:"rgba(92, 24, 134, 0.25)",restLine:"#3E105B"},{hoverFill:"rgba(48, 74, 196, 0.6)",hoverLine:"#304AC4",restFill:"rgba(125, 142, 223, 0.35)",restLine:"#304AC4"},{hoverFill:"rgba(35, 49, 159, 0.6)",hoverLine:"#23319F",restFill:"rgba(35, 49, 159, 0.25)",restLine:"#11174B"},{hoverFill:"rgba(182, 47, 132, 0.6)",hoverLine:"#B62F84",restFill:"rgba(218, 113, 179, 0.35)",restLine:"#B62F84"},{hoverFill:"rgba(105, 2, 28, 0.6)",hoverLine:"#69021C",restFill:"rgba(105, 2, 28, 0.25)",restLine:"#050001"}],l=function(){function e(){}return e.getCategoryResourceName=function(t,n,i){if(i)switch(!0){case 0!==n:return e.optyGradeResources.closed;case 0===t:return e.optyGradeResources.a;case 1===t:return e.optyGradeResources.b;case 2===t:return e.optyGradeResources.c;case 3===t:return e.optyGradeResources.d;default:return e.optyGradeResources.unknown}else{if(0!==n)return e.optyGradeResources.closed;switch(t){case"1-Qualify":return e.stageNameResources.qualify;case"2-Develop":return e.stageNameResources.develop;case"3-Propose":return e.stageNameResources.propose;case"4-Close":return e.stageNameResources.close;case"5-Identify":return e.stageNameResources.identify;case"6-Research":return e.stageNameResources.research;case"7-Resolve":return e.stageNameResources.resolve;case"8-Approval":return e.stageNameResources.approval;default:return e.stageNameResources.unknown}}},e.labelColorDark="#323130",e.labelColorLightDark="#605E5C",e.lineColor="#E1DFDD",e.funnelChartFillColors=["#002B75","#E85763","#790857","#418DED","#5C1886"],e.optyGradeResources={a:"WS_Chart_GradeA_80_100",b:"WS_Chart_GradeB_50_80",c:"WS_Chart_GradeC_30_50",d:"WS_Chart_GradeD_0_30",unknown:"WS_Chart_Unknown",closed:"WS_Chart_3Close"},e.stageNameResources={qualify:"WS_Chart_0Qualify",develop:"WS_Chart_1Develop",propose:"WS_Chart_2Propose",close:"WS_Chart_3Close",identify:"WS_Chart_4Identify",research:"WS_Chart_5Research",resolve:"WS_Chart_6Resolve",approval:"WS_Chart_7Approval",unknown:"WS_Chart_Unknown"},e.healthPaletteByResource=((i={})[e.optyGradeResources.a]=a[0],i[e.optyGradeResources.b]=a[1],i[e.optyGradeResources.c]=a[2],i[e.optyGradeResources.d]=a[3],i[e.optyGradeResources.closed]=o,i),e.categoricalPaletteByResource=((r={})[e.stageNameResources.qualify]=s[0],r[e.stageNameResources.develop]=s[1],r[e.stageNameResources.propose]=s[2],r[e.stageNameResources.close]=s[3],r[e.stageNameResources.identify]=s[4],r[e.stageNameResources.research]=s[5],r[e.stageNameResources.resolve]=s[6],r[e.stageNameResources.approval]=s[7],r[e.stageNameResources.unknown]=s[8],r),e.colorPalettesByResource={health:e.healthPaletteByResource,categorical:e.categoricalPaletteByResource},e}()},6432:function(e,t,n){"use strict";n.d(t,{C:function(){return i}});var i=function(e,t){var n=[],i=t.find((function(e){return"bubble"===e.type}));return!0===(null==i?void 0:i.status)&&(n=[{entityName:e,fieldName:"statecode"}]),r(n,t),n},r=function(e,t){for(var n in t){var i=t[n];if(i instanceof Object)if("entityName"in i&&"fieldName"in i){var o=i.entityName;"opportunity"!==o&&(i.linkEntity={name:o,from:o+"id",to:o+"id"}),e.push(i)}else r(e,i)}}},96056:function(e,t,n){"use strict";n.d(t,{G:function(){return s}});var i=n(49037),r=n(69041),o=n(11231),a=n(48945),s=function(){function e(){this.entityAttributes={estimatedvalue_sum_key:"estimatedvalue_sum",estimatedvalue_sum_formattedValueKey:"estimatedvalue_sum@OData.Community.Display.V1.FormattedValue",opportunity_count_key:"opportunity_count",stepname_key:"stepname"},this.attributesQuery="<attribute name='estimatedvalue' alias='"+this.entityAttributes.estimatedvalue_sum_key+"' aggregate='sum' /><attribute name='name' alias='"+this.entityAttributes.opportunity_count_key+"' aggregate='count' /><attribute name='stepname' alias='"+this.entityAttributes.stepname_key+"' groupby='true' /><order alias='stepname' descending='false' />"}return e.prototype.getChartOptions=function(e,t,n){return(0,i.mG)(this,void 0,Promise,(function(){var s=this;return(0,i.Jh)(this,(function(i){return[2,this.getChartData(e,t).then((function(e){if(void 0!==e)return{chart:{type:"polygon",reflow:!0,height:"350",style:{fontFamily:"Segoe UI"}},title:{text:""},yAxis:{title:{text:a.D.getLocalizedString("WS_FunnelChart_YAxis_Title"),margin:15,style:{fontWeight:"400",color:o.v.labelColorDark}},labels:{enabled:!1},gridLineWidth:0,minorGridLineWidth:0},xAxis:{title:{text:a.D.getLocalizedString("WS_FunnelChart_XAxis_Title"),margin:20,style:{fontWeight:"400",color:o.v.labelColorDark}},labels:{enabled:!1},minorTickLength:0,tickLength:0,lineColor:"transparent"},legend:{enabled:!0,align:"left",padding:2,itemStyle:{fontWeight:400,fontSize:"12px",color:o.v.labelColorDark,cursor:"default"}},credits:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"",borderWidth:"0px",backgroundColor:"transparent",borderColor:"transparent",borderRadius:"0px",footerFormat:"",pointFormat:s.getTooltip(),followPointer:!1},plotOptions:{polygon:{cursor:"pointer"},series:{events:{click:function(e){!function(e,t){var n={attributeName:"stepname",conditionOperator:r._Y,value:e};t((function(e){var t;return(null===(t=null==e?void 0:e.conditions)||void 0===t?void 0:t.some((function(e){return e.attributeName===n.attributeName})))?(0,r.d2)(e,n.attributeName):(0,r.aX)(e,n)}))}(e.point.series.name,n)},legendItemClick:function(){return!1}}}},series:e}}))]}))}))},e.prototype.getTooltip=function(e,t,n){return void 0===e&&(e=a.D.getLocalizedString("WS_FunnelChart_YAxis_Title")),void 0===t&&(t=a.D.getLocalizedString("WS_FunnelChart_OpportunityCount")),void 0===n&&(n=a.D.getLocalizedString("WS_FunnelChart_OpportunityPercentage")),"<div class='salesControls-chart-tooltip'><div class='salesControls-chart-tooltip-header'>{series.name}</div><div class='salesControls-chart-tooltip-field'><div class='salesControls-chart-tooltip-fieldheading'>"+e+"</div><div class='salesControls-chart-tooltip-fieldvalue'>{series.options.custom.yAxisAttribute}</div></div><div class='salesControls-chart-tooltip-field'><div class='salesControls-chart-tooltip-fieldheading'>"+t+"</div><div class='salesControls-chart-tooltip-fieldvalue'>{series.options.custom.opportunityCountAttribute}</div></div><div class='salesControls-chart-tooltip-field'><div class='salesControls-chart-tooltip-fieldheading'>"+n+"</div><div class='salesControls-chart-tooltip-fieldvalue'>{series.options.custom.opportunityPercentageAttribute}%</div></div></div>"},e.prototype.generateFetchXml=function(e){var t="<fetch version='1.0' output-format='xml-platform' distinct='true' mapping='logical' aggregate='true'><entity name=\"opportunity\">"+this.attributesQuery+e+"</entity></fetch>";return encodeURIComponent(t)},e.prototype.getChartData=function(e,t){return(0,i.mG)(this,void 0,Promise,(function(){var n,r=this;return(0,i.Jh)(this,(function(i){return n="?fetchXml= "+this.generateFetchXml(null!=t?t:""),[2,this.fetchFunnelChartData(e,n).then((function(e){if(void 0!==e&&(null==e?void 0:e.length)>0){var t=2.53,n=e.reduce((function(e,t){return e+t[r.entityAttributes.opportunity_count_key]}),0);return e.map((function(e){return{stepName:e[r.entityAttributes.stepname_key],estimatedValue:e[r.entityAttributes.estimatedvalue_sum_key],estimatedValue_formattedValue:e[r.entityAttributes.estimatedvalue_sum_formattedValueKey],opportunityCount:e[r.entityAttributes.opportunity_count_key]}})).map((function(e,i){var r;return{name:e.stepName,data:[[i*t+.04,-e.estimatedValue],[i*t+.04,e.estimatedValue],[(i+1)*t,e.estimatedValue],[(i+1)*t,-e.estimatedValue]],custom:{yAxisAttribute:e.estimatedValue_formattedValue,opportunityCountAttribute:e.opportunityCount,opportunityPercentageAttribute:(100*e.opportunityCount/n).toFixed(2)},color:null!==(r=o.v.funnelChartFillColors[i])&&void 0!==r?r:""}}))}}))]}))}))},e.prototype.fetchFunnelChartData=function(e,t){var n;return(0,i.mG)(this,void 0,Promise,(function(){var r,o;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:0,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,null==e?void 0:e.retrieveMultipleRecords("opportunity",t)];case 2:return r=i.sent(),[2,null!==(n=null==r?void 0:r.entities)&&void 0!==n?n:void 0];case 3:return o=i.sent(),console.error(o.toString()),null==o||o.name,[2,void 0];case 4:return[2]}}))}))},e}()},31974:function(e,t,n){"use strict";n.d(t,{m:function(){return f}});var i=n(49037),r=n(63804),o=n(27196),a=n(92202),s=n(32790),l=n(54988),c=n(19608),d=n(91847),u=n(86765),p=n(87018),m=n(78407),h=n(48945),g=(0,c.mergeStyles)({color:l.iX.gray130,background:"none","&:hover":{background:l.iX.gray40}}),f=function(e){var t=e.items,n=e.displayCheckbox,o=e.totalColumnsCount,l=e.hiddenColumnsCount,c=e.dragDropItemStyle,f=e.editButtonProps,v=e.onReorderList,C=e.onCheckboxChange,S=e.onDeleteItem,E=y(1000001);return r.createElement("div",null,r.createElement(a.Z5,{onDragEnd:function(e){e.destination&&v(t,e.source.index,e.destination.index)}},r.createElement(a.bK,{droppableId:"droppable"},(function(e){return r.createElement("div",(0,i.pi)({},e.droppableProps,{ref:e.innerRef}),t.map((function(e,t){return r.createElement(a._l,{key:e.key,draggableId:e.key,index:t},E((function(t,a){return r.createElement("div",(0,i.pi)({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:c,style:(y=a.isDragging,v=t.draggableProps.style,(0,i.pi)((0,i.pi)({userSelect:"none",boxShadow:y?s.N.depth16:"none"},v),{paddingTop:"6px",paddingBottom:"6px"})),key:e.key,"data-testid":"dnd-field-element"}),r.createElement(d.Stack,{horizontal:!0,verticalAlign:"center",horizontalAlign:"start",styles:{root:{height:32}}},n&&r.createElement(d.Stack.Item,{grow:!0},r.createElement(m.Checkbox,{tabIndex:0,label:e.text,checked:!e.checked,disabled:l===o-1&&!e.checked,onChange:null==C?void 0:C.bind(void 0,e.key)})),r.createElement(d.Stack.Item,{align:"end"},e.canEdit&&r.createElement(u.TooltipHost,{content:null==f?void 0:f.toolTipLabel},r.createElement(p.IconButton,{title:null==f?void 0:f.title,ariaLabel:null==f?void 0:f.ariaLabel,"data-testid":"drag_drop_edit_button",styles:null==f?void 0:f.styles,iconProps:{iconName:"Edit"},onClick:function(t){null==f||f.onActionIconClick(e),t.stopPropagation()}}))),r.createElement(d.Stack.Item,{align:"end"},e.canDelete&&r.createElement(u.TooltipHost,{content:h.D.getLocalizedString("WS_Grid_Delete_Column")},r.createElement(p.IconButton,{className:g,iconProps:{iconName:"Trash"},disabled:!e.canDelete,onClick:function(){S&&S(e)}})))));var y,v})))})),e.placeholder)}))))},y=function(e){var t=r.useRef({}).current;return r.useEffect((function(){var n=document.createElement("div");return n.style.position="absolute",n.style.pointerEvents="none",n.style.top="0",n.style.width="100%",n.style.height="100%",n.style.zIndex=e.toString(),t.container=n,document.body.appendChild(n),function(){document.body.removeChild(n)}}),[t,e]),function(e){return function(n,i,r){var a=e(n,i,r),s=n.draggableProps.style;return t.container&&s&&function(e){return e.hasOwnProperty("position")}(s)&&"fixed"===s.position?(0,o.createPortal)(a,t.container):a}}}},5415:function(e,t,n){"use strict";n.d(t,{n:function(){return i}});var i=(0,n(19608).mergeStyles)({margin:"22px 0"})},81277:function(e,t,n){"use strict";n.d(t,{R:function(){return d}});var i=n(49037),r=n(63804),o=n.n(r),a=n(70803),s=n(48945),l=n(56450),c=n(5415),d=function(e){(0,r.useEffect)((function(){s.D.reportUserAction("ActivitiesControl",d.name,"",{},"loaded","")}),[]);var t=(0,r.useMemo)((function(){var t=(0,i.pr)(e.activities.activityList);t.sort((function(e,t){return t.date.getTime()-e.date.getTime()}));for(var n=[],r=[],o=0,s=t;o<s.length;o++){var l=s[o];l.activitytypecode===a.mh.Appointment&&l.isUpcoming?r.push(l):n.push(l)}return{activities:n,upcomingAppointments:r}}),[e.activities.activityList]),n=t.activities,u=t.upcomingAppointments;return o().createElement("div",{className:c.n},o().createElement(l.R,{activities:n,upcomingAppointments:u,onActivityClick:function(t){t&&s.D.openEntityInMFD(t.activitytypecode,t.activityid,(function(){e.onActivityAdded&&e.onActivityAdded(null)}))}}))}},51483:function(e,t,n){"use strict";n.d(t,{p:function(){return o},F:function(){return a}});var i=n(54988),r=n(19608),o=(0,r.mergeStyles)({margin:"22px 16px",border:0,borderTop:"1px solid "+i.iX.gray30}),a=(0,r.mergeStyles)({fontWeight:r.FontWeights.semibold,padding:"0 20px"})},56450:function(e,t,n){"use strict";n.d(t,{R:function(){return u}});var i=n(63804),r=n(9433),o=n(42041),a=n(36258),s=n(88166),l=n(51483),c=n(53095),d=n(48945),u=function(e){var t=e.activities,n=e.upcomingAppointments,u=e.onActivityClick,p=t.length>0,m=n.length>0,h=i.useMemo((function(){return p?function(e){for(var t,n=[],i=0,r=e;i<r.length;i++){var o=r[i];t&&o.formattedDate===t.formattedDate||(t={activities:[],formattedDate:o.formattedDate,relativeWeekday:o.relativeWeekday},n.push(t)),t.activities.push(o)}return n}(t):[]}),[t,p]);return p||m?i.createElement("div",null,m&&i.createElement(c.k,{activities:n,onActivityClick:u}),m&&p&&i.createElement("hr",{className:l.p}),p&&i.createElement(r.K,{tokens:{childrenGap:28}},h.map((function(e){var t=e.activities,n=e.formattedDate,r=e.relativeWeekday;return i.createElement(a.S,{key:n,headerText:n,relativeWeekday:r},i.createElement(o.b,null,t.map((function(e,n){return i.createElement(s.c,{key:e.activityid,onClick:u,activity:e,connector:(0,s.M)(n,t.length)})}))))})))):i.createElement("div",{className:l.F},d.D.getLocalizedString("Activities_EmptyList"))}},570:function(e,t,n){"use strict";n.d(t,{kQ:function(){return a},bx:function(){return s},NF:function(){return l},r5:function(){return c},Fs:function(){return d},sK:function(){return p},DK:function(){return m},Jz:function(){return h},LI:function(){return g},AB:function(){return f}});var i,r=n(19608),o=n(54988),a=(0,r.mergeStyles)({overflow:"hidden",padding:"6px 0"}),s=(0,r.mergeStyles)({background:o.iX.gray30,zIndex:1,width:2,height:"100%"}),l=(0,r.mergeStyles)({height:12,flexShrink:0}),c=(0,r.mergeStyles)({height:"100%"}),d=(0,r.mergeStyles)({fontSize:r.FontSizes.size14,fontWeight:r.FontWeights.semibold,lineHeight:r.FontSizes.size20}),u=(0,r.mergeStyles)({fontSize:r.FontSizes.size12,lineHeight:r.FontSizes.size20}),p=(0,r.mergeStyles)(u,{color:o.iX.gray160}),m=(0,r.mergeStyles)(u,{color:o.iX.gray130}),h=(0,r.mergeStyles)(((i={width:"100%",height:"unset",border:0,textAlign:"left",padding:"0 20px",borderRadius:0,backgroundColor:"transparent"})["&:hover ."+s]={backgroundColor:o.iX.gray40},i["&:active ."+s]={backgroundColor:o.iX.gray50},i)),g=(0,r.mergeStyles)({color:o.iX.gray130}),f=(0,r.mergeStyles)({color:o.iX.gray130,fontSize:r.FontSizes.size12,lineHeight:r.FontSizes.size20})},88166:function(e,t,n){"use strict";n.d(t,{M:function(){return u},c:function(){return h}});var i=n(63804),r=n(69876),o=n(9433),a=n(79549),s=n(81470),l=n(40277),c=n(4432),d=n(570),u=function(e,t){if(!(t<=1))return 0===e?"bottom":e===t-1?"top":"both"},p={DateTime2:c.I.chartsCautionDark,MailForward:c.I.chartsBlueLight,MailForwardMirrored:c.I.chartsBlueLight,OutgoingCall:c.I.chartsTealLight,IncomingCall:c.I.chartsTealLight},m=function(e){return e.isUpcoming?c.I.chartsNeutralDark:p[e.iconName]},h=function(e){var t=e.onClick,n=e.activity,c=e.connector;return i.createElement(r.DefaultButton,{styles:{flexContainer:{display:"block"}},onClick:function(){return t(n)},className:d.Jz},i.createElement(o.K,{horizontal:!0,tokens:{childrenGap:8}},i.createElement(o.K.Item,{disableShrink:!0},i.createElement(o.K,{style:{height:"100%"}},i.createElement(o.K.Item,{align:"center",className:d.NF},i.createElement("div",{className:"both"===c||"top"===c?d.bx:""})),i.createElement(o.K.Item,{align:"center"},i.createElement(l.A,{iconName:n.iconName,color:m(n)})),i.createElement(o.K.Item,{align:"center",className:d.r5},i.createElement("div",{className:"both"===c||"bottom"===c?d.bx:""})))),i.createElement(o.K.Item,{grow:!0,className:d.kQ},i.createElement(o.K,null,i.createElement(o.K.Item,{shrink:!0},i.createElement(o.K,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:8}},i.createElement(a.x,{className:d.Fs,title:n.header,nowrap:!0},n.header),i.createElement(o.K.Item,{disableShrink:!0},i.createElement(a.x,{className:d.AB},n.isUpcoming?n.formattedDate:n.timestamp)))),n.subHeader1&&i.createElement(a.x,{className:d.sK,title:n.subHeader1,nowrap:!0},n.subHeader1),n.subHeader2&&i.createElement(o.K,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:6}},"appointment"===n.activitytypecode&&i.createElement(s.J,{iconName:"POI",className:d.LI}),i.createElement(a.x,{className:d.DK,title:n.subHeader2,nowrap:!0},n.subHeader2))))))}},15425:function(e,t,n){"use strict";n.d(t,{Jz:function(){return a},Fs:function(){return s},Nz:function(){return l},vL:function(){return c}});var i=n(54988),r=n(19608),o=n(4432),a=(0,r.mergeStyles)({".showOutline &:focus":{outline:"solid 1px "+i.iX.gray130+" !important"}}),s=(0,r.mergeStyles)({padding:"0 20px",height:32}),l=(0,r.mergeStyles)({color:i.iX.gray160,fontSize:r.FontSizes.size14,lineHeight:r.FontSizes.size24,fontWeight:r.FontWeights.semibold}),c=(0,r.mergeStyles)(l,{color:i.iX.white,padding:"0 10px",marginLeft:-10,background:o.I.digitalBlue,borderRadius:100})},36258:function(e,t,n){"use strict";n.d(t,{S:function(){return c}});var i=n(63804),r=n(9433),o=n(79549),a=n(19608),s=n(15425),l=n(48945),c=function(e){return i.createElement(r.K,{"aria-label":e.headerText,className:s.Jz,tabIndex:0,tokens:{childrenGap:2}},i.createElement(r.K,{className:s.Fs,horizontal:!0,tokens:{childrenGap:8},verticalAlign:"center"},"today"===e.relativeWeekday&&i.createElement(o.x,{className:s.vL},l.D.getLocalizedString("Activities_Today")),"yesterday"===e.relativeWeekday&&i.createElement(o.x,{className:s.Nz},l.D.getLocalizedString("Activities_Yesterday")),e.relativeWeekday&&i.createElement("span",null,""),i.createElement(o.x,{className:(0,a.mergeStyles)(s.Nz,e.headerTextClassName)},e.headerText)),e.children)}},50153:function(e,t,n){"use strict";n.d(t,{Jz:function(){return r},Oq:function(){return o},qv:function(){return a}});var i=n(19608),r=(0,i.mergeStyles)({width:28,height:28,position:"relative",display:"flex",alignItems:"center",justifyContent:"center"}),o=(0,i.mergeStyles)({position:"absolute",width:"100%",height:"100%",top:0,left:0,borderRadius:"100%",backgroundColor:"currentColor",opacity:.1}),a=(0,i.mergeStyles)({width:16,height:16,color:"currentColor",fontSize:i.FontSizes.size16})},40277:function(e,t,n){"use strict";n.d(t,{A:function(){return s}});var i=n(63804),r=n(19608),o=n(81470),a=n(50153),s=function(e){var t=i.useMemo((function(){return(0,r.mergeStyles)(a.Jz,{color:e.color})}),[e.color]);return i.createElement("div",{className:t},i.createElement("div",{className:a.Oq}),i.createElement(o.J,{iconName:e.iconName,className:a.qv}))}},74376:function(e,t,n){"use strict";n.d(t,{q:function(){return r},J:function(){return o}});var i=n(19608),r=(0,i.mergeStyles)({display:"flex"}),o=(0,i.mergeStyles)({padding:0,listStyle:"none",margin:0})},42041:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var i=n(63804),r=n(74376),o=function(e){var t=e.children;return i.createElement("ul",{className:r.J},i.Children.map(t,(function(e){return i.createElement("li",{className:r.q},e)})))}},41845:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var i=n(54988),r=n(94589),o=(0,n(19608).mergeStyles)({color:i.iX.gray130,fontWeight:r.lq.regular})},53095:function(e,t,n){"use strict";n.d(t,{k:function(){return c}});var i=n(63804),r=n(48945),o=n(36258),a=n(42041),s=n(88166),l=n(41845),c=function(e){return i.createElement(o.S,{headerText:r.D.getLocalizedString("Activities_Upcoming_Appointments"),headerTextClassName:l.N},i.createElement(a.b,null,e.activities.map((function(t){return i.createElement(s.c,{activity:t,key:t.activityid,onClick:e.onActivityClick})}))))}},58714:function(e,t,n){"use strict";n.d(t,{k:function(){return a}});var i=n(49037),r=n(63804),o=n(93170),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.createElement(o.Dialog,{hidden:!1,onDismiss:this.onDismiss.bind(this),dialogContentProps:this.props.dialogContentProps},this.props.dialogFooter)},t.prototype.onDismiss=function(){this.props.onDismiss()},t}(r.Component)},6253:function(e,t,n){"use strict";n.d(t,{u:function(){return c}});var i=n(49037),r=n(63804),o=n(13845),a=n(28741),s=n(48945),l=n(68480),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this;return s.D.reportInfo("render","EmptyState","No rows view rendered",{}),r.createElement("div",{className:this.props.getScenario()==a.yW.RowCountExceedsLimit?"dm-empty-state row-limit-exceeded":"dm-empty-state"},r.createElement("div",{className:"dm-empty-state-img"},r.createElement("img",{style:{height:"100px",width:"100px"},src:this.getImage()})),r.createElement(o.Label,{className:"dm-empty-state-title"},this.getTitle()),r.createElement(o.Label,{className:"dm-empty-state-desc"},this.getDescription()),this.props.showSpinner&&this.props.showButton&&this.getSpinner(),!this.props.showSpinner&&this.props.showButton?r.createElement(l.DefaultButton,{text:this.getButtonTitle(),iconProps:{iconName:this.props.getScenario()==a.yW.NoData||this.props.getScenario()==a.yW.RowCountExceedsLimit?"Filter":"Sync"},className:"dm-empty-state dm-button",onClick:function(){e.onSuggestedActionPerformed()}}):"")},t.prototype.getSpinner=function(){return r.createElement("div",{className:"dm-empty-state-spinner"})},t.prototype.onSuggestedActionPerformed=function(){this.props.getScenario()!=a.yW.NoData&&this.props.getScenario()!=a.yW.RowCountExceedsLimit||this.props.setFilterPanelIsOpen&&this.props.setFilterPanelIsOpen(!0),s.D.reportUserAction("render","EmptyState","user click on suggested button",{NoRowsScenario:this.props.getScenario()},this.props.getScenario()==a.yW.NoData||this.props.getScenario()==a.yW.RowCountExceedsLimit?"Open Filter":"Refresh","")},t.prototype.getImage=function(){switch(this.props.getScenario()){case a.yW.Error:return"/webresources/msdyn_/Images/ErrorLoadingRowsImage.svg";case a.yW.NoData:case a.yW.RowCountExceedsLimit:return"/webresources/msdyn_/Images/NoRowsImage.svg";case a.yW.SearchReturnedEmptyTryChangingFilters:case a.yW.SearchReturnedEmpty:return"/webresources/msdyn_/Images/EmptySearchImage.svg"}},t.prototype.getTitle=function(){switch(this.props.getScenario()){case a.yW.RowCountExceedsLimit:return s.D.getLocalizedString("WS_NoRows_LimitReachedTitle");case a.yW.Error:return s.D.getLocalizedString("WS_NoRows_ErrorTitle");case a.yW.NoData:return s.D.getLocalizedString("WS_NoRows_Title");case a.yW.SearchReturnedEmptyTryChangingFilters:case a.yW.SearchReturnedEmpty:return s.D.getLocalizedString("WS_NoRows_SearchEmptyTitle")}},t.prototype.getButtonTitle=function(){switch(this.props.getScenario()){case a.yW.Error:return s.D.getLocalizedString("WS_NoRows_RefreshButtonTitle");case a.yW.NoData:case a.yW.RowCountExceedsLimit:return s.D.getLocalizedString("WS_NoRows_ViewFitlersButtonTitle")}},t.prototype.getDescription=function(){switch(this.props.getScenario()){case a.yW.RowCountExceedsLimit:return s.D.getLocalizedString("WS_NoRows_LimitReachedMessage");case a.yW.Error:return s.D.getLocalizedString("WS_NoRows_ErrorMessage");case a.yW.NoData:return s.D.getLocalizedString("WS_NoRows_Message");case a.yW.SearchReturnedEmptyTryChangingFilters:return s.D.getLocalizedString("WS_NoRows_SearchEmptyMessage_TryChangingFilters");case a.yW.SearchReturnedEmpty:return s.D.getLocalizedString("WS_NoRows_SearchEmptyMessage")}},t}(r.Component)},97563:function(e,t,n){"use strict";n.d(t,{J:function(){return T}});var i=n(49037),r=n(63804),o=n.n(r),a=n(29758),s=n(59731),l=n(17875),c=n(25453),d=n(99506),u=n(87018),p=n(36957),m=n(42093),h=n(85234),g=n(20307),f=n(78195),y=n(84718),v=n(55318),C=n(48945),S=n(28741),E=n(12684),b=n(97369),w=n(35531),D=n(952),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isFieldLockChecked=!1,t.savedIndicatorTimeout=8e3,t.errorMessage="",t.defaultPrevented=!1,t.tooltipDetails=h.FieldDisabledReason.None,t}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t,n,i,r,a,s,l,c,d,u,p,m,h,g;if(!this.props.shouldRenderPlainTextInitially||(null===(e=this.state)||void 0===e?void 0:e.skipPlainTextRender)||this.shouldSkipPlainTextRender()){if(this.isFieldLockChecked||(this.checkIfFieldIsLocked(),this.isFieldLockChecked=!0),this.props.fieldData){var f=(null===(a=this.props.dataSetRecord)||void 0===a?void 0:a.notifications.has(this.props.fieldData.name))||!1,y=(null===(s=this.props.dataSetRecord)||void 0===s?void 0:s.notifications)&&(null===(l=this.props.dataSetRecord)||void 0===l?void 0:l.notifications.size)>0||!1,v=f?null===(c=this.props.dataSetRecord)||void 0===c?void 0:c.notifications.get(this.props.fieldData.name):"";(null===(d=this.props.dataSetRecord)||void 0===d?void 0:d.errorMessage)&&(null===(u=this.props.dataSetRecord)||void 0===u?void 0:u.dirtyAttributes.has(this.props.fieldData.name))&&Array.from(null===(p=this.props.dataSetRecord)||void 0===p?void 0:p.dirtyAttributes.keys())[0]==this.props.fieldData.name&&(f=!0,v=null===(m=this.props.dataSetRecord)||void 0===m?void 0:m.errorMessage),this.tooltipDetails=this.getTooltipDetails(f,y,this.props.fieldData.name);var C=this.isFieldDisabled(),S=C?"fieldDisabled fieldControlDiv":"fieldEnabled fieldControlDiv",E="icv-cell-field-label } "+D.c(this.props.fieldData.metadataId);return o().createElement("div",{className:S},this.props.showLabel&&(this.props.fieldData.displayName||(null===(h=this.props.customProps)||void 0===h?void 0:h.displayName))&&o().createElement("div",{className:"icv-cell-field "+D.bq},o().createElement("label",{className:E},(null===(g=this.props.customProps)||void 0===g?void 0:g.displayName)?this.props.customProps.displayName:this.props.fieldData.displayName),this.props.fieldData.businessRequired&&this.getRequiredLabel()),o().createElement(w.Shimmer,{customElementsGroup:b.W.getFieldShimmer(),isDataLoaded:this.props.dataSetRecord&&null!=this.props.dataSetRecord.values},this.props.dataSetRecord&&this.renderControl(v,f,y,C)))}return o().createElement("div",null)}this.setState({skipPlainTextRender:!0});var T="columnPlainText";return o().createElement("div",{className:(null===(t=this.props.customProps)||void 0===t?void 0:t.showQuickActions)?(null===(n=this.props.customProps)||void 0===n?void 0:n.shouldAddAdditionalClass)?"fieldControlDivAdditional firstColumnPlainText "+T:"firstColumnPlainText "+T:""+T},(null===(i=this.props.dataSetRecord)||void 0===i?void 0:i.formattedValues.get(null===(r=this.props.fieldData)||void 0===r?void 0:r.name))||"-")},t.prototype.shouldSkipPlainTextRender=function(){var e,t,n;return(null===(e=this.props.fieldData)||void 0===e?void 0:e.dataType)==a.EDataType.Customer||(null===(t=this.props.fieldData)||void 0===t?void 0:t.dataType)==a.EDataType.Lookup||(null===(n=this.props.fieldData)||void 0===n?void 0:n.dataType)==a.EDataType.Owner},t.prototype.getTooltipDetails=function(e,t,n){var i,r;return e||(null===(i=this.props.entityData)||void 0===i?void 0:i.name)!=s.py.Opportunity||0==(null===(r=this.props.dataSetRecord)||void 0===r?void 0:r.values.get(S.gT.stateCode))?n.indexOf(".")>=0?h.FieldDisabledReason.LinkedField:!e&&t?h.FieldDisabledReason.ErrorInOtherField:h.FieldDisabledReason.None:h.FieldDisabledReason.ClosedOpportunity},t.prototype.renderControl=function(e,n,i,r){var a,s,l,c,d,u,p,m,h,g,f,y,v,S,E,b,w=this,D=this,T=t.fieldControlFactory.getValueControl(null===(a=this.props.fieldData)||void 0===a?void 0:a.dataType),x=this.props.fieldData&&(null===(s=this.props.dataSetRecord)||void 0===s?void 0:s.formattedValues.get(this.props.fieldData.name)),k="workspace"+(null===(l=this.props.fieldData)||void 0===l?void 0:l.dataType);return this.props.fieldData&&o().createElement("div",{className:(null===(c=this.props.customProps)||void 0===c?void 0:c.showQuickActions)?(null===(d=this.props.customProps)||void 0===d?void 0:d.shouldAddAdditionalClass)?"fieldControlDivAdditional firstColumnFieldValueDiv fieldValueDiv":"firstColumnFieldValueDiv fieldValueDiv":"fieldValueDiv"},o().createElement("div",{className:"inputFieldDiv "+k},o().createElement(T,{value:null===(u=this.props.dataSetRecord)||void 0===u?void 0:u.values.get(this.props.fieldData.name),formattedValue:x,fieldContext:this.props.fieldData,entityContext:this.props.entityData,resolver:this.props.recordContainerContext.resolver,timezoneService:this.props.recordContainerContext.timezoneService,resources:this.props.recordContainerContext.resources,getToolTipContent:this.getToolTipContent.bind(this),getToolTipProps:this.getToolTipProps.bind(this),toolTipDetails:this.tooltipDetails,ariaLabel:x?this.props.fieldData&&this.props.fieldData.displayName+" "+x:this.props.fieldData&&this.props.fieldData.displayName,onChanged:function(e){var t;D.props.fieldData&&(D.checkAndTriggerSave(e),1==(null===(t=D.state)||void 0===t?void 0:t.hideSuccessIndicator)&&D.setState({hideSuccessIndicator:!1}))},recordId:null===(p=this.props.dataSetRecord)||void 0===p?void 0:p.recordId,hasError:n,disabled:r,customTextStyles:null===(m=this.props.customProps)||void 0===m?void 0:m.textStyles,additionalPersonaProps:(null===(h=this.props.customProps)||void 0===h?void 0:h.showAdditionalPersonaDetails)?this.getPersonaProps(this.props.fieldData):void 0,openEntity:function(e,t,n){var i,r,o;C.D.reportUserAction("renderControl","fieldControl","Click entity/lookup field",{field:null===(i=w.props.fieldData)||void 0===i?void 0:i.name},"Open entity",null===(r=w.props.fieldData)||void 0===r?void 0:r.name),(null===(o=w.props.callbackHandlers)||void 0===o?void 0:o.openEntity)&&w.props.callbackHandlers.openEntity(e,t,n)},openEmail:function(e){var t,n;C.D.reportUserAction("renderControl","fieldControl","Click email field",{field:null===(t=w.props.fieldData)||void 0===t?void 0:t.name},"Open email",null===(n=w.props.fieldData)||void 0===n?void 0:n.name),w.props.recordContainerContext.navigation.openUrl("mailto:"+e)},openPhone:function(e){var t,n,i,r,o,a;if(C.D.reportUserAction("renderControl","fieldControl","Click phone field",{field:null===(t=w.props.fieldData)||void 0===t?void 0:t.name},"Open phone",null===(n=w.props.fieldData)||void 0===n?void 0:n.name),1==(null===(r=null===(i=w.props.callbackHandlers)||void 0===i?void 0:i.isChannelIntegrationFrameworkSupported)||void 0===r?void 0:r.call(i))){var s={type:"InitiateCall",data:{contactNumber:e,entityRecordId:null===(o=w.props.dataSetRecord)||void 0===o?void 0:o.recordId,entityLogicalName:null===(a=w.props.dataSetRecordEntityMetaData)||void 0===a?void 0:a.name}},l=new CustomEvent("ClickToAct",{detail:s});window.dispatchEvent(l)}else w.props.recordContainerContext.navigation.openUrl("tel:"+e)},openUrl:function(e){var t,n;C.D.reportUserAction("renderControl","fieldControl","Click url field",{field:null===(t=w.props.fieldData)||void 0===t?void 0:t.name},"Open url",null===(n=w.props.fieldData)||void 0===n?void 0:n.name),w.props.recordContainerContext.navigation.openUrl(e)},showQuickActions:null===(g=this.props.customProps)||void 0===g?void 0:g.showQuickActions,createCommands:null===(f=this.props.customProps)||void 0===f?void 0:f.createCommands,saveInProgress:(null===(y=this.props.dataSetRecord)||void 0===y?void 0:y.isSaveInProgress)&&(null===(v=this.props.dataSetRecord)||void 0===v?void 0:v.dirtyAttributes.has(this.props.fieldData.name)),isSaveSuccessful:!(null===(S=this.props.dataSetRecord)||void 0===S?void 0:S.isSaveInProgress)&&!n&&!i&&!(this.state&&this.state.hideSuccessIndicator)&&(null===(E=this.props.dataSetRecord)||void 0===E?void 0:E.attributesLastSaved)&&(null===(b=this.props.dataSetRecord)||void 0===b?void 0:b.attributesLastSaved.has(this.props.fieldData.name)),onErrorRender:function(){return w.renderFieldErrorElement(e)},onSaveInProgressRender:function(){return w.renderSaveInProgressElement()},onSaveSuccessRender:function(){return w.renderFieldSavedElement()}})))},t.prototype.getToolTipProps=function(){var e,t=this;switch(this.tooltipDetails){case h.FieldDisabledReason.ClosedOpportunity:var n=null===(e=this.props.dataSetRecord)||void 0===e?void 0:e.formattedValues.get(S.gT.stateCode),i=C.D.getLocalizedString("WS_FieldControl_Opportunity_Marked_Closed",n);return{onRenderContent:function(){return o().createElement("div",{style:{display:"flex",flexDirection:"column",padding:"10px",maxWidth:"150px"}},o().createElement("span",{style:{fontSize:"12px"}},i," "),o().createElement(u.ActionButton,{className:"fieldToolTipButton",text:C.D.getLocalizedString("WS_FieldControl_Reopen_Opportunity"),onClick:t.reopenOpportunity.bind(t)}))}};case h.FieldDisabledReason.ErrorInOtherField:var r=C.D.getLocalizedString("WS_FieldControl_Error_In_Other_Field");return{onRenderContent:function(){var e;return o().createElement("div",{style:{display:"flex",padding:"10px",maxWidth:"200px"}},o().createElement(p.Icon,{iconName:"ErrorBadge",styles:{root:{color:"#A4262C",fontSize:"18px"}}}),o().createElement("div",{style:{display:"flex",paddingLeft:"10px",flexDirection:"column"}},o().createElement("span",{style:{fontWeight:520,fontSize:"14px"}},C.D.getLocalizedString("WS_FieldControl_Fix_Errors")),o().createElement("span",{style:{fontSize:"12px",paddingTop:"10px"}},r," "),o().createElement(u.ActionButton,{className:"fieldToolTipButton",text:C.D.getLocalizedString("WS_FieldControl_Show_Error_Field"),onClick:C.D.showErrorField.bind(t,""+(null===(e=t.props.dataSetRecord)||void 0===e?void 0:e.recordId)+S.gT.fieldErrorClassName)})))}};default:return}},t.prototype.getToolTipContent=function(){var e;switch(this.tooltipDetails){case h.FieldDisabledReason.None:return C.D.getLocalizedString("WS_Edit_Button");case h.FieldDisabledReason.LinkedField:return C.D.getLocalizedString("WS_FieldControl_Linked_Field_Error");case h.FieldDisabledReason.ClosedOpportunity:var t=null===(e=this.props.dataSetRecord)||void 0===e?void 0:e.formattedValues.get(S.gT.stateCode);return C.D.getLocalizedString("WS_FieldControl_Opportunity_Marked_Closed",t);case h.FieldDisabledReason.ErrorInOtherField:return C.D.getLocalizedString("WS_FieldControl_Error_In_Other_Field");default:return}},t.prototype.renderSaveInProgressElement=function(){return o().createElement("div",{className:"inputFieldSaveInProgressDiv"},o().createElement(m.TooltipHost,{content:C.D.getLocalizedString("WS_FieldControl_Applying_Changes")},o().createElement(c.Spinner,{className:"saveInProgressSpinner",styles:l.l.getSpinnerStyles(),size:c.SpinnerSize.medium})))},t.prototype.renderFieldErrorElement=function(e){var t,n,i,r,a=this;C.D.reportInfo("renderFieldErrorElement","fieldControl","Error during saving field",{field:null===(t=this.props.fieldData)||void 0===t?void 0:t.name,error:e},"Error saving field",null===(n=this.props.fieldData)||void 0===n?void 0:n.name);var s={onRenderContent:function(){return o().createElement("div",{style:{display:"flex",padding:"10px",maxWidth:"200px"}},o().createElement(p.Icon,{iconName:"ErrorBadge",styles:{root:{color:"#A4262C",fontSize:"18px"}}}),o().createElement("div",{style:{display:"flex",paddingLeft:"10px",flexDirection:"column"}},o().createElement("span",{style:{fontWeight:520,fontSize:"14px"}},C.D.getLocalizedString("WS_FieldControl_Invalid_Value")),o().createElement("span",{style:{fontSize:"12px",paddingTop:"10px"}},e," "),o().createElement(u.ActionButton,{className:"fieldToolTipButton",text:C.D.getLocalizedString("WS_FieldControl_Undo_Changes"),onClick:a.undoHandler.bind(a)})))}};return o().createElement("div",{className:"inputFieldErrorDiv"},o().createElement(m.TooltipHost,{tooltipProps:s,delay:0},o().createElement(u.IconButton,{tabIndex:0,iconProps:{iconName:"ErrorBadge"},className:S.gT.fieldErrorClassName+" "+(null===(i=this.props.dataSetRecord)||void 0===i?void 0:i.recordId)+S.gT.fieldErrorClassName+" "+(null===(r=this.props.fieldData)||void 0===r?void 0:r.name)+S.gT.fieldErrorClassName,styles:l.l.getErrorButtonStyle(),ariaLabel:e})))},t.prototype.reopenOpportunity=function(){var e,t,n=this;C.D.reportUserAction("reopenOpportunity","fieldControl","Click reopen of opportunity from tooltip",{},"Reopen opportunity",""),E.O.showLoadingOverlay();var i=new Map;i.set(S.gT.stateCode,0),i.set(S.gT.statusCode,-1),this.props.dataSetRecord&&this.props.recordContainerContext.dataProvider.updateRecord(null===(e=this.props.entityData)||void 0===e?void 0:e.name,null===(t=this.props.dataSetRecord)||void 0===t?void 0:t.recordId,i).then((function(){var e;null===(e=n.props.dataSetRecord)||void 0===e||e.refresh()})).catch((function(e){C.D.reportError("reopenOpportunity","fieldControl","Error occured while reopening opportunity",{error:e.toString()})}))},t.prototype.undoHandler=function(){var e,t,n,i,r,o,a,s,l,c,d,u,p,m,h,g;C.D.reportUserAction("undoHandler","fieldControl","Undo editing of a field",{field:null===(e=this.props.fieldData)||void 0===e?void 0:e.name},"Undo edit",null===(t=this.props.fieldData)||void 0===t?void 0:t.name);var f=Object.assign({},this.props.dataSetRecord);if((null===(n=this.props.fieldData)||void 0===n?void 0:n.name)&&(null===(i=this.props.dataSetRecord)||void 0===i?void 0:i.dirtyAttributes.has(null===(r=this.props.fieldData)||void 0===r?void 0:r.name))){var y=null===(a=f.dirtyAttributes.get(null===(o=this.props.fieldData)||void 0===o?void 0:o.name))||void 0===a?void 0:a.prevValue,v=null===(l=f.dirtyAttributes.get(null===(s=this.props.fieldData)||void 0===s?void 0:s.name))||void 0===l?void 0:l.prevFormattedValue;f.attributesLastSaved.clear(),f.dirtyAttributes.delete(null===(c=this.props.fieldData)||void 0===c?void 0:c.name),f.isDirty=f.dirtyAttributes.size>0,f.notifications.delete(null===(d=this.props.fieldData)||void 0===d?void 0:d.name),f.isValid.set(null===(u=this.props.fieldData)||void 0===u?void 0:u.name,!0),f.values.set(null===(p=this.props.fieldData)||void 0===p?void 0:p.name,y),f.formattedValues.set(null===(m=this.props.fieldData)||void 0===m?void 0:m.name,v),null===(g=null===(h=this.props.callbackHandlers)||void 0===h?void 0:h.updateRecord)||void 0===g||g.call(h,f)}},t.prototype.renderFieldSavedElement=function(){var e=this;return setTimeout((function(){e.setState({hideSuccessIndicator:!0})}),this.savedIndicatorTimeout),o().createElement("div",{className:"inputFieldSavedDiv"},o().createElement(u.IconButton,{tabIndex:0,iconProps:{iconName:"Completed"},className:"fieldSavedIconStyle",styles:l.l.getSavedButtonStyle()}))},t.prototype.isFieldDisabled=function(){var e,t,n;return(null===(e=this.props.fieldData)||void 0===e?void 0:e.dataType)==a.EDataType.State||(null===(t=this.props.fieldData)||void 0===t?void 0:t.dataType)==a.EDataType.Status||this.state&&this.state.isLocked||(null===(n=this.props.dataSetRecord)||void 0===n?void 0:n.isSaveInProgress)||this.props.fieldData&&this.isDisabled(this.props.fieldData)},t.prototype.isDisabled=function(e){var t,n,i;if(this.tooltipDetails!=h.FieldDisabledReason.None)return!1;var r=null===(t=this.props.dataSetRecord)||void 0===t?void 0:t.isRecordActive,o=null===(n=this.props.dataSetRecord)||void 0===n?void 0:n.isReadOnly.get(e.name),s=e.sourceType===a.AttributeSourceType.Persistent||null===e.sourceType||void 0===e.sourceType,l=null===(i=this.props.customProps)||void 0===i?void 0:i.isDisabled;return!(r&&!o&&s&&!l)},t.prototype.checkIfFieldIsLocked=function(){var e=this;this.props.fieldData&&!this.isDisabled(this.props.fieldData)&&this.props.isEditable&&this.props.isEditable.then((function(t){0==t&&e.setState({isLocked:!0})}))},t.prototype.getPersonaProps=function(e){var t,n;return e&&e.name.indexOf("contact")>-1?{cdsDataClient:null===(t=this.props.recordContainerContext)||void 0===t?void 0:t.dataProvider,keyForSecondaryText:"jobtitle"}:(null==e?void 0:e.dataType)===a.EDataType.Owner?{cdsDataClient:null===(n=this.props.recordContainerContext)||void 0===n?void 0:n.dataProvider,keyForSecondaryText:"title"}:void 0},t.prototype.checkAndTriggerSave=function(e){var t,n,i,r,o,a,s,l,c,d,u,p,m,h,g;if(this.props.fieldData){var f=null===(t=this.props.dataSetRecord)||void 0===t?void 0:t.values.get(this.props.fieldData.name);if(f==e)return;this.errorMessage="";var S=v.Z.getSaveHandler(),E=v.Z.getChangeHandler();if(S||E){var b=JSON.parse(JSON.stringify(this.props.dataSetRecord));b.values=new Map,b.values.set(this.props.fieldData.name,e),b.isDirty=!0,b.dirtyAttributes=new Map,b.dirtyAttributes.set(this.props.fieldData.name,{prevValue:f,prevFormattedValue:null===(n=this.props.dataSetRecord)||void 0===n?void 0:n.formattedValues.get(this.props.fieldData.name)});var w=this.getExecutionContext(b);try{w&&E&&(E(w),C.D.reportUserAction("checkAndTriggerSave","fieldControl","executed onchangehandler",{},"autosave",this.props.fieldData.name)),y.StringUtil.IsNullOrEmpty(this.errorMessage)&&w&&S&&(S(w),C.D.reportUserAction("checkAndTriggerSave","fieldControl","executed onsavehandler",{},"autosave",this.props.fieldData.name))}catch(e){this.errorMessage=C.D.getLocalizedString("WS_FieldControl_Scripting_Unhandled_Error"),C.D.reportError("checkAndTriggerSave","fieldControl","Unhandled exception while executing onChangeHandler or onSaveHandler",{error:e},"autosave")}if(y.StringUtil.IsNullOrEmpty(this.errorMessage))null===(i=this.props.dataSetRecord)||void 0===i||i.setValue(this.props.fieldData.name,e),null===(r=this.props.dataSetRecord)||void 0===r||r.save();else{null===(o=this.props.dataSetRecord)||void 0===o||o.values.set(this.props.fieldData.name,e),this.props.dataSetRecord&&(this.props.dataSetRecord.isDirty=!0,(null===(a=this.props.dataSetRecord)||void 0===a?void 0:a.dirtyAttributes.has(this.props.fieldData.name))||null===(s=this.props.dataSetRecord)||void 0===s||s.dirtyAttributes.set(this.props.fieldData.name,{prevValue:f,prevFormattedValue:null===(l=this.props.dataSetRecord)||void 0===l?void 0:l.formattedValues.get(this.props.fieldData.name)})),null===(c=this.props.dataSetRecord)||void 0===c||c.notifications.set(this.props.fieldData.name,this.errorMessage),null===(d=this.props.dataSetRecord)||void 0===d||d.isValid.set(this.props.fieldData.name,!1),null===(u=this.props.dataSetRecord)||void 0===u||u.formattedValues.set(this.props.fieldData.name,e);var D=Object.assign({},this.props.dataSetRecord);null===(m=null===(p=this.props.callbackHandlers)||void 0===p?void 0:p.updateRecord)||void 0===m||m.call(p,D)}}else C.D.reportUserAction("checkAndTriggerSave","fieldControl","User edited the field",{field:this.props.fieldData.name},"User edit",this.props.fieldData.name),null===(h=this.props.dataSetRecord)||void 0===h||h.setValue(this.props.fieldData.name,e),null===(g=this.props.dataSetRecord)||void 0===g||g.save()}},t.prototype.getExecutionContext=function(e){if(this.props.attributesMetadata&&this.props.columns&&this.props.entityData&&this.props.webAPI&&v.Z.hasClientEventHandlers()){var t=new f.ExecutionContextInputMetadata(this.props.entityData,this.props.attributesMetadata,this.props.columns,this.props.webAPI);return f.ExecutionContextHelper.getExecutionContext(t,this.getRecordClientApi(),e,void 0,this.getEventArgs())}},t.prototype.getRecordClientApi=function(){var e=this;return{setNotification:function(t,n){t&&null!=n&&(e.errorMessage=n,C.D.reportUserAction("setNotification","fieldControl","RecordClientApi.setNotification called",{},"scriptAction",t))},getNotification:function(t){var n;return null===(n=e.props.dataSetRecord)||void 0===n?void 0:n.notifications.get(t)},getDisabled:function(t){var n;return(null===(n=e.props.dataSetRecord)||void 0===n?void 0:n.isReadOnly.get(t))||!0},setDisabled:function(e){C.D.reportUserAction("setDisabled","fieldControl","Ignored RecordClientApi.setDisabled attempted during save or update.",{},"scriptAction",e)}}},t.prototype.getEventArgs=function(){var e=this,t=this;return{isDefaultPrevented:function(){return e.defaultPrevented},preventDefault:function(){var e;t.errorMessage=C.D.getLocalizedString("WS_FieldControl_Prevent_Default"),t.defaultPrevented=!0,C.D.reportUserAction("preventDefault","fieldControl","PreventDefaultEventArguments.preventDefault called.",{},"preventDefault",(null===(e=t.props.fieldData)||void 0===e?void 0:e.name)||"")}}},t.prototype.getRequiredLabel=function(){return o().createElement(d.Label,{styles:{root:{color:"red",padding:"0 0 0 4px"}}},"*")},t.fieldControlFactory=new g.FieldControlsFactory,t}(o().Component)},4848:function(e,t,n){"use strict";n.d(t,{P:function(){return l}});var i=n(49037),r=n(63804),o=n.n(r),a=n(25453),s=n(48945),l=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return s.D.reportInfo("render","LoadingControl",this.props.loadingMessage,{}),o().createElement(a.Spinner,{label:this.props.loadingMessage,styles:this.props.removeStyles?void 0:{root:{justifyContent:"unset",marginTop:"30%",height:"100%"}},style:this.props.style,size:this.props.spinnerSize,labelPosition:"bottom"})},t}(o().Component)},73418:function(e,t,n){"use strict";n.d(t,{I:function(){return r}});var i=n(19608),r=function(e){return(0,i.mergeStyles)({border:"1px solid grey",".ck,.ck__editor":{display:"flex",flexDirection:"column-reverse",".ck-toolbar":{backgroundColor:"transparent",border:"none",display:e.richTextIsEnabled?"initial":"none",".ck-toolbar__items":{fontSize:"8px"}},".ck-editor__editable":{height:"200px",border:"none",flexDirection:"column","&:focus":{boxShadow:"none",border:"none",outline:"none"},ul:{paddingLeft:"22px"},ol:{paddingLeft:"22px"}}}})}},85936:function(e,t,n){"use strict";n.d(t,{L:function(){return p}});var i=n(49037),r=n(63804),o=n.n(r),a=n(64254),s=n(48945),l=n(13966),c=n(38122),d=n.n(c),u=n(73418),p=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return this.props.readOnly?this.props.numberOfLinesToDisplay&&this.props.numberOfLinesToDisplay>0?this.getPTReadOnlyView():this.getRTEReadOnlyView():this.displayCKEditorView()},t.prototype.getPTReadOnlyView=function(){var e,t=document.createElement("div");return t.innerHTML=this.props.data||"",o().createElement("span",{className:"rte-plaintext-label",style:{"-webkit-line-clamp":null===(e=this.props.numberOfLinesToDisplay)||void 0===e?void 0:e.toString()}},t.innerText||t.textContent||"")},t.prototype.getRTEReadOnlyView=function(){return o().createElement("div",{style:this.props.style,dangerouslySetInnerHTML:{__html:this.props.data||""}})},t.prototype.displayCKEditorView=function(){var e=this,t=e.props.languageId,n=""+this.props.richTextEnabled,i=this.props.data?""+this.props.data:"";return o().createElement("div",{className:"document-editor"},o().createElement("div",{className:u.I({richTextIsEnabled:this.props.richTextEnabled})},o().createElement(a.CKEditor,{onReady:function(e){e.data.set(i)},editor:d(),id:n,config:{toolbar:["bold","italic","underline","|","numberedList","bulletedList","|","link"],placeholder:s.D.getLocalizedString("Notes_Add_a_Note"),language:l.E[t||1033],title:s.D.getLocalizedString("Richtext_Voice_Label",s.D.getLocalizedString("Notes_Description"))},onChange:function(t,n){var i,r;null===(r=(i=e.props.eventHandlers).onChange)||void 0===r||r.call(i,t,n)},onBlur:function(t,n){var i,r;""==n.getData()&&(n.config.bodyClass="cke-placeholder"),null===(r=(i=e.props.eventHandlers).onBlur)||void 0===r||r.call(i,t)},onFocus:function(t,n){e.props.data||(n.config.bodyClass="",n.setData(""))}})))},t}(o().Component)},97369:function(e,t,n){"use strict";n.d(t,{W:function(){return a}});var i=n(63804),r=n.n(i),o=n(35531),a=function(){function e(){}return e.getPersonaShimmer=function(){return r().createElement("div",{className:"icv-header-personaContainer"},r().createElement(o.ShimmerElementsGroup,{shimmerElements:[{type:o.ShimmerElementType.circle,height:48},{type:o.ShimmerElementType.gap,width:14,height:48}]}),r().createElement(o.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:"100%",height:24},{type:o.ShimmerElementType.line,width:"100%",height:20}]}))},e.getFieldShimmer=function(){return r().createElement("div",null,r().createElement(o.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:"100%",height:42}]}))},e.getTitleShimmer=function(){return r().createElement("div",null,r().createElement(o.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:150,height:24}]}))},e.getCommandBarShimmer=function(){return r().createElement("div",null,r().createElement(o.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:"100%",height:12}]}))},e.getGridOrChartShimmer=function(){return r().createElement("div",null,r().createElement(o.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:"100%"}]}))},e.getButtonIconShimmer=function(){return r().createElement("div",null,r().createElement(o.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:40,height:44}]}))},e.getCOLAViewShimmer=function(){return r().createElement(r().Fragment,null,e.getKeyDetailsShimmer(),e.getCommonSectionShimmer(),e.getCommonSectionShimmer())},e.getKeyDetailsShimmer=function(){return r().createElement(r().Fragment,null,r().createElement(o.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:o.ShimmerElementType.gap,width:"100%",height:30}]}),r().createElement(o.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:"100%",height:24}]}),r().createElement(o.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:o.ShimmerElementType.gap,width:"100%",height:20}]}),r().createElement(o.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:"100%",height:240}]}))},e.getCommonSectionShimmer=function(){return r().createElement(r().Fragment,null,r().createElement(o.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:o.ShimmerElementType.gap,width:"100%",height:20}]}),r().createElement(o.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:"100%",height:24}]}),r().createElement(o.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:o.ShimmerElementType.gap,width:"100%",height:20}]}),r().createElement(o.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:o.ShimmerElementType.line,width:"100%",height:80}]}))},e.wrapperComponentInShimmerContainer=function(e,t,n){return r().createElement(o.Shimmer,{customElementsGroup:t,isDataLoaded:n},e)},e.getChartShimmerStyles=function(){return{shimmerWrapper:[{width:"auto !important",minHeight:"350px !important",margin:"0px 0px 0px 16px !important"}]}},e.getGridOptionsShimmerStyles=function(){return{root:[{borderBottom:"1px solid #f3f2f1"}],shimmerWrapper:[{width:"auto !important",margin:"15px 20px",borderBottom:"1px solid #f3f2f1"}]}},e.getFilterBarShimmerStyles=function(){return{shimmerWrapper:[{width:"auto !important",margin:"10px 0px 10px 70%"}]}},e.getGridShimmerStyles=function(){return{dataWrapper:[{height:"100%"}],root:[{height:"100%"}],shimmerWrapper:[{margin:"20px 20px",width:"auto !important",height:"calc(100% - 40px)"}]}},e}()},74662:function(e,t,n){"use strict";n.d(t,{h:function(){return C}});var i=n(49037),r=n(63804),o=n.n(r),a=n(99506),s=n(61218),l=n(59731),c=n(36957),d=n(19608),u=n(48945),p=n(52618),m=n(4848),h=n(35758),g=n(35691),f=n(23436),y="tasksControl",v=function(e,t){switch(t.type){case"createdLists":return{inProgressTasks:t.inProgressList,completedTasks:t.completedTasks};case"newTask":return e.inProgressTasks.length>0&&!0===e.inProgressTasks[0].isTemporaryObject?(0,i.pi)((0,i.pi)({},e),{inProgressTasks:(0,i.pr)([t.itemToAdd],e.inProgressTasks.slice(1))}):(0,i.pi)((0,i.pi)({},e),{inProgressTasks:(0,i.pr)([t.itemToAdd],e.inProgressTasks)});case"addNewInProgressTask":return(0,i.pi)((0,i.pi)({},e),{inProgressTasks:(0,i.pr)([t.itemToAdd],e.inProgressTasks)});case"deleteTask":return e.inProgressTasks.find((function(e){return e.key===t.itemToDelete.key}))?(0,i.pi)((0,i.pi)({},e),{inProgressTasks:e.inProgressTasks.filter((function(e){return e.key!==t.itemToDelete.key}))}):(0,i.pi)((0,i.pi)({},e),{completedTasks:e.completedTasks.filter((function(e){return e.key!==t.itemToDelete.key}))});case"moveToInProgress":var n=e.completedTasks.indexOf(t.itemToMove);return{completedTasks:(0,i.pr)(e.completedTasks.slice(0,n),e.completedTasks.slice(n+1)),inProgressTasks:(0,i.pr)([t.itemToMove],e.inProgressTasks)};case"moveToCompleted":return n=e.inProgressTasks.indexOf(t.itemToMove),{inProgressTasks:(0,i.pr)(e.inProgressTasks.slice(0,n),e.inProgressTasks.slice(n+1)),completedTasks:(0,i.pr)([t.itemToMove],e.completedTasks)}}},C=function(e){var t=(0,r.useState)(""),n=t[0],S=t[1],E=(0,r.useState)(!1),b=E[0],w=E[1],D=(0,r.useState)(e.tasks),T=D[0],x=D[1],k=o().useReducer(v,{inProgressTasks:[],completedTasks:[]}),_=k[0],N=k[1],L=function(){e.relatedEntity&&e.services.dataService.fetchTasks(e.relatedEntity.entityId,e.relatedEntity.entityType).then((function(e){u.D.reportInfo("constructor",y,p.dS.SUCCESS,{entityId:e.recordId,entityType:e.recordType,tasksCount:e.taskList.length}),x(e)})).catch((function(t){var n,i;u.D.reportError("constructor",y,p.dS.FAILED,{entityId:e.relatedEntity.entityId,entityType:e.relatedEntity.entityType,error:t}),null===(i=null===(n=e.viewEventHandlers)||void 0===n?void 0:n.openErrorView)||void 0===i||i.call(n,u.D.getLocalizedString("Tasks_Error_Message"))}))};(0,r.useEffect)((function(){var t,n;u.D.reportUserAction("TasksControl",C.name,"",{},"loaded",""),null===(n=null===(t=e.viewEventHandlers)||void 0===t?void 0:t.setViewTitle)||void 0===n||n.call(t,u.D.getLocalizedString("Tasks_TasksListTitle")),T||L()}),[e.relatedEntity]),(0,r.useEffect)((function(){var t;if(T){S((null===(t=e.tasks)||void 0===t?void 0:t.recordType)||""),w(!0);var n=h.b.filterTasksByState(T.taskList);N({type:"createdLists",inProgressList:n.inProgTaskList,completedTasks:n.completedTaskList})}}),[T]);var I=(0,d.mergeStyles)({fontSize:"16px",lineHeight:"100%",margin:"6px 0px"}),A=o().useCallback((function(e,t){N({type:t?"moveToCompleted":"moveToInProgress",itemToMove:e})}),[]),R=o().useCallback((function(e){N({type:"deleteTask",itemToDelete:e})}),[]),F=o().useCallback((function(e){u.D.reportUserAction("onTaskAdded",y,"task add Completed",{},p.EJ.CLICK,"Add task"),N({type:"newTask",itemToAdd:e})}),[]),P=o().useCallback((function(){L()}),[]);return o().createElement(o().Fragment,null,b?o().createElement(o().Fragment,null,o().createElement("div",{style:{borderBottom:"1px",borderBottomStyle:"solid",borderColor:"#EAEAEA"}},o().createElement(s.Link,{onClick:function(){e.isInlineAddTaskEnabled?N({type:"addNewInProgressTask",itemToAdd:{key:f.Guid.newGuid(),owner:"",subject:"",statecode:l.lP.Open,description:"",dueDate:void 0,friendlyDueDate:void 0,duration:void 0,prioritycode:l.Cx.Normal,isTemporaryObject:!0}}):h.b.OpenQuickCreateTask(e.context,e.services.dataService,(null==T?void 0:T.recordId)||"",n,(null==T?void 0:T.recordType.toString().toLowerCase())||"").then((function(e){e&&N({type:"moveToInProgress",itemToMove:e})}))},style:{margin:"8px"}}," ",o().createElement(c.FontIcon,{iconName:"Add",className:I,style:{marginLeft:"9px",marginRight:"8px"}})," ",u.D.getLocalizedString("Tasks_Add_A_Task"))),h.b.showEmptyListText(null==T?void 0:T.taskList,_.inProgressTasks,_.completedTasks)?o().createElement(a.Label,{style:{marginTop:"20px",marginLeft:"9px",fontFamily:"Segoe UI",fontSize:"12px",textAlign:"center",lineHeight:"16px"}},u.D.getLocalizedString("Tasks_EmptyList")):o().createElement("div",{style:{overflow:"auto"}},o().createElement("div",{style:{marginTop:"20px",marginLeft:"20px"}},_.inProgressTasks.map((function(t){return o().createElement("div",{key:t.key},o().createElement(g.A,(0,i.pi)({},e,{dataService:e.services.dataService,task:t,onTaskStateChanged:A,onTaskDeleted:R,onTaskCreated:F,onTaskUpdated:P,relatedEntity:e.relatedEntity})))})),_.completedTasks.length>0&&o().createElement(a.Label,{style:{margin:"16px 0px"}},u.D.getLocalizedString("Tasks_Header_CompletedTaskList")),_.completedTasks.map((function(t){return o().createElement("div",{key:t.key},o().createElement(g.A,(0,i.pi)({},e,{dataService:e.services.dataService,task:t,onTaskStateChanged:A,onTaskDeleted:R,onTaskCreated:F,onTaskUpdated:P,relatedEntity:e.relatedEntity})))}))))):o().createElement(m.P,{spinnerSize:1,loadingMessage:""}))}},30170:function(e,t,n){"use strict";n.d(t,{L:function(){return p}});var i=n(49037),r=n(48945),o=n(63804),a=n.n(o),s=n(91563),l=n(9433),c=n(1367),d=n(31209),u=n(36957),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return this.getComponent()},t.prototype.getTooltipContent=function(e){return a().createElement(l.K,null,a().createElement("p",null,"IncompatibleFilter"===e?r.D.getLocalizedString("WS_Metric_Tooltip_Incompatible_Filter"):r.D.getLocalizedString("WS_Metric_Tooltip_Error")))},t.prototype.getComponent=function(){var e,t;return a().createElement("div",{style:s.Cg.DashletContainer,tabIndex:0},a().createElement("div",{style:s.Cg.TitleStyle},r.D.getLocalizedString(this.props.title)),a().createElement("div",{style:s.Cg.ContentStyle},a().createElement("div",{style:s.Cg.FormattedValueStyle},null===(e=this.props.formattedValueData)||void 0===e?void 0:e.formattedValue),(null===(t=this.props.formattedValueData)||void 0===t?void 0:t.formattedValueType)&&a().createElement(c.G,{tabIndex:0,content:this.getTooltipContent(this.props.formattedValueData.formattedValueType),calloutProps:{directionalHint:d.b.topCenter,calloutMaxWidth:200}},a().createElement(u.FontIcon,{iconName:"Info",className:s.U9}))))},t}(a().Component)},27696:function(e,t,n){"use strict";n.d(t,{u:function(){return C}});var i=n(49037),r=n(63804),o=n.n(r),a=n(26402),s=n(36711),l=n(71520),c=n(73384),d=n(21525),u=n(54106),p=n(1285),m=n(48945),h=n(796),g=n(6946),f=n(3416),y=n(52493),v=n.n(y),C=function(e){var t,n=e.selectedDashlet,y=e.entity,C=e.onDashletConfigChanged,S=(0,r.useState)(),E=S[0],b=S[1],w=(0,h.C)("DashletDesigner",y),D=w.fields,T=w.filteringContext,x=w.localizedLabels,k=w.dataTypesForFilters;(0,r.useEffect)((function(){var e;if(null==n?void 0:n.query){var t=null!==(e=(0,u.ZQ)(n.query))&&void 0!==e?e:void 0;b(t)}}),[null==n?void 0:n.query]);var _=[{key:"avg",text:m.D.getLocalizedString("WS_Metric_Aggregate_Avg")},{key:"sum",text:m.D.getLocalizedString("WS_Metric_Aggregate_Sum")},{key:"min",text:m.D.getLocalizedString("WS_Metric_Aggregate_Min")},{key:"max",text:m.D.getLocalizedString("WS_Metric_Aggregate_Max")},{key:"count",text:m.D.getLocalizedString("WS_Metric_Aggregate_Count")}];return o().createElement(s.Stack,{styles:d.p.dashletDesignerStack,tokens:{childrenGap:21}},o().createElement(l.TextField,{"data-testid":"label_TextField",label:m.D.getLocalizedString("WS_MetricDesigner_Label"),defaultValue:"",value:n?v().find(f.ol,{title:n.title})?m.D.getLocalizedString(n.title):n.title:"",placeholder:m.D.getLocalizedString("WS_MetricDesigner_Label_PlaceHolder"),onChange:function(e,t){var r;null!=t&&t!==(null==n?void 0:n.title)&&C((0,i.pi)((0,i.pi)({},n),{title:t,queryAlias:(r=t,r.split(" ").join("_"))}))},onGetErrorMessage:function(e){return e?void 0:m.D.getLocalizedString("WS_MetricDesigner_Label_ErrorMessage")}}),o().createElement(l.TextField,{"data-testid":"description_TextField",label:m.D.getLocalizedString("WS_MetricDesigner_Description"),placeholder:m.D.getLocalizedString("WS_MetricDesigner_Description_PlaceHolder"),multiline:!0,resizable:!1,onChange:function(e,t){null!=t&&t!==(null==n?void 0:n.description)&&C((0,i.pi)((0,i.pi)({},n),{description:t}))},value:null==n?void 0:n.description}),o().createElement(l.TextField,{"data-testid":"entity_TextField",label:m.D.getLocalizedString("WS_MetricDesigner_Entity"),value:null!==(t=y.name)&&void 0!==t?t:m.D.getLocalizedString("WS_MetricDesigner_Entity_PlaceHolder"),disabled:!0}),o().createElement(p.V,{"data-testid":"field_Selector",label:m.D.getLocalizedString("WS_MetricDesigner_Field"),fields:D,selectedFieldName:n.fieldName,onSelectedFieldChanged:function(e){if(e){var t=e.field.name;t!==n.fieldName&&C((0,i.pi)((0,i.pi)({},n),{fieldName:t}))}},supportsSmartField:!1,dataTypeFilter:[g.EDataType.WholeNumber,g.EDataType.Decimal,g.EDataType.Float,g.EDataType.Currency]}),o().createElement(a.Dropdown,{"data-testid":"aggregate_dropdown",label:m.D.getLocalizedString("WS_MetricDesigner_Aggregate"),selectedKey:null==n?void 0:n.aggregate,onChange:function(e,t){if(t&&t.key!==(null==n?void 0:n.aggregate)){var r=t.key;C((0,i.pi)((0,i.pi)({},n),{aggregate:r}))}},options:_}),o().createElement(c.Separator,null),x&&o().createElement(u.Oy,{filterExpression:E,labels:x,dataTypes:k,entityName:y.name,dataverseAccess:T,onExpressionChanged:function(e){if(b(null!=e?e:void 0),void 0!==e){var t=e?(0,u.jd)(e):"";t!==n.filter&&C((0,i.pi)((0,i.pi)({},n),{filter:t}))}}}))}},73615:function(e,t,n){"use strict";n.d(t,{H:function(){return c}});var i=n(63804),r=n.n(i),o=n(29086),a=n(31974),s=n(54988),l=(0,o.mergeStyles)({background:"white","&:hover":{background:s.iX.gray30}}),c=function(e){var t=e.listItems,n=e.editButtonProps,i=e.onDeleteDashlet,o=e.onReOrderDashlet,s=e.onCheckboxChange,c=Object.keys(t).length;return r().createElement(a.m,{items:t,displayCheckbox:!0,dragDropItemStyle:l,hiddenColumnsCount:0,totalColumnsCount:c,onCheckboxChange:s,onReorderList:o,onDeleteItem:i,editButtonProps:n})}},3416:function(e,t,n){"use strict";n.d(t,{ol:function(){return f},vL:function(){return S}});var i,r,o=n(49037),a=n(63804),s=n.n(a),l=n(91563),c=n(35531),d=n(30170),u=n(87018),p=n(48945),m=n(4476),h=n(69041),g=(n(76462),n(19608)),f=[{key:"1",shouldDisplay:!1,title:"WS_Metric_Total_deals",description:"Total deals",fieldName:"name",aggregate:"count",queryAlias:"Total_deals",query:"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='opportunity'><attribute name='name' alias='Total_deals' aggregate='count' /></entity></fetch>",filter:""},{key:"2",shouldDisplay:!0,title:"WS_Metric_Pipeline_value",description:"Pipeline value",fieldName:"estimatedvalue",aggregate:"sum",queryAlias:"Pipeline_value",query:"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='opportunity'><attribute name='estimatedvalue' alias='Pipeline_value' aggregate='sum' /><filter type='and'><filter type='or'><condition attribute='statecode' operator='eq' value='0'/><condition attribute='statecode' operator='eq' value='1'/></filter></filter></entity></fetch>",filter:"<filter type='and'><filter type='or'><condition attribute='statecode' operator='eq' value='0'/><condition attribute='statecode' operator='eq' value='1'/></filter></filter></entity></fetch>"},{key:"3",shouldDisplay:!0,title:"WS_Metric_Number_of_deals_in_pipeline",description:"Number of deals in pipeline",fieldName:"statuscode",aggregate:"count",queryAlias:"Number_of_deals_in_pipeline",query:"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='opportunity'><attribute name='statuscode' alias='Number_of_deals_in_pipeline' aggregate='count' /><filter type='and'><condition attribute='statuscode' operator='eq' value='1'/></filter></entity></fetch>",filter:"<filter type='and'><condition attribute='statuscode' operator='eq' value='1'/></filter></entity></fetch>"},{key:"4",shouldDisplay:!0,title:"WS_Metric_Won_amount",description:"Won amount",fieldName:"actualvalue",aggregate:"sum",queryAlias:"Won_amount",query:"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='opportunity'><attribute name='actualvalue' alias='Won_amount' aggregate='sum' /><filter type='and'><condition attribute='statecode' operator='eq' value='1'/></filter></entity></fetch>",filter:"<filter type='and'><condition attribute='statecode' operator='eq' value='1'/></filter></entity></fetch>"},{key:"5",shouldDisplay:!0,title:"WS_Metric_Number_of_won_deals",description:"Number of won deals",fieldName:"statecode",aggregate:"count",queryAlias:"Number_of_won_deals",query:"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='opportunity'><attribute name='statecode' alias='Number_of_won_deals' aggregate='count' /><filter type='and'><condition attribute='statecode' operator='eq' value='1'/></filter></entity></fetch>",filter:"<filter type='and'><condition attribute='statecode' operator='eq' value='1'/></filter></entity></fetch>"},{key:"6",shouldDisplay:!0,title:"WS_Metric_Lost_amount",description:"Lost amount",fieldName:"estimatedvalue",aggregate:"sum",queryAlias:"Lost_amount",query:"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='opportunity'><attribute name='estimatedvalue' alias='Lost_amount' aggregate='sum' /><filter type='and'><condition attribute='statecode' operator='eq' value='2'/></filter></entity></fetch>",filter:"<filter type='and'><condition attribute='statecode' operator='eq' value='2'/></filter></entity></fetch>"},{key:"7",shouldDisplay:!0,title:"WS_Metric_Number_of_lost_deals",description:"Number of lost deals",fieldName:"statecode",aggregate:"count",queryAlias:"Number_of_lost_deals",query:"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='opportunity'><attribute name='statecode' alias='Number_of_lost_deals' aggregate='count' /><filter type='and'><condition attribute='statecode' operator='eq' value='2'/></filter></entity></fetch>",filter:"<filter type='and'><condition attribute='statecode' operator='eq' value='2'/></filter></entity></fetch>"}],y=[],v=(i={type:c.ShimmerElementType.line,height:19},r={type:c.ShimmerElementType.gap,width:"10%"},s().createElement(c.ShimmerElementsGroup,{backgroundColor:l.Cg.PanelStyle.backgroundColor,shimmerElements:Array.from({length:11},(function(e,t){return 1&t?r:i}))})),C=function(e,t){return e.aggregateValues?e.aggregateValues[0][t]?{formattedValue:e.aggregateValues[0][t]}:{formattedValue:"N/A",formattedValueType:"IncompatibleFilter"}:{formattedValue:"N/A",formattedValueType:"Error"}},S=function(e){var t,n=e.context,i=e.dashletList,r=e.dashletHasChanges,a=e.entityMetadata,f=e.combinedAggregateFetchXml,S=e.dataset,E=e.setDashletHasChanges,b=s().useState([]),w=b[0],D=b[1],T=s().useMemo((function(){return m._.getContainerContext(n).dataProvider}),[n]),x=s().useRef(null),k=s().useState(!1),_=k[0],N=k[1],L=s().useState(!1),I=L[0],A=L[1],R=s().useState(!1),F=R[0],P=R[1];return s().useLayoutEffect((function(){var e,t=function(){if(x.current){var e=x.current,t=e.scrollWidth,n=e.clientWidth,i=e.scrollLeft;i+n>=t!==F&&P(!F),i<=0!==I&&A(!I)}};return window.addEventListener("resize",t),null===(e=x.current)||void 0===e||e.addEventListener("scroll",t),t(),function(){var e;window.removeEventListener("resize",t),null===(e=x.current)||void 0===e||e.removeEventListener("scroll",t)}})),s().useEffect((function(){var e;if(a&&!(null==S?void 0:S.some((function(e){return e.isSaveInProgress||!e.isRecordValid})))){D([]);var t=null!==(e=null==i?void 0:i.filter((function(e){return e.shouldDisplay})))&&void 0!==e?e:[];N(0===t.length),p.D.reportUserAction("renderStats","StatsPanel","Stats are rendered",{numberOfStats:t.length},"render stats",""),D(t),(0,o.mG)(void 0,void 0,void 0,(function(){var e,t,n,r,s,l,c;return(0,o.Jh)(this,(function(o){switch(o.label){case 0:e=null==i?void 0:i.filter((function(e){return e.shouldDisplay})),t=e.map((function(e,t){var n=f?(0,h.Mu)(e.query,f):e.query,i=encodeURIComponent(n);return y[t+1]=i,{entitySetName:a.entitySetName,aggregateFetchXml:i}})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,T.executeAggregateBatchRequest(t)];case 2:return n=o.sent(),r=null!==(c=null===(l=n.responses)||void 0===l?void 0:l.map((function(t,n){var i=e[n],r=i.queryAlias+"@OData.Community.Display.V1.FormattedValue";return{formattedValueData:C(t,r),title:i.title,changePercentage:0}})))&&void 0!==c?c:[],D(r),E&&E(!1),N(!0),[3,4];case 3:return s=o.sent(),p.D.reportError("LoadDashlets","Dashlet","Error occured in LoadDashlets",{error:s.toString()}),[3,4];case 4:return[2]}}))}))}}),[i,r,T,a,f,S,E]),s().createElement("div",{style:0!==(null===(t=e.dashletList)||void 0===t?void 0:t.filter((function(e){return e.shouldDisplay})).length)?l.Cg.PanelStyle:l.Cg.EmptyPanelStyle},s().createElement(c.Shimmer,{isDataLoaded:_,customElementsGroup:v},s().createElement("div",{style:l.Cg.PanelStackStyle,id:"metricPanel",tabIndex:0},s().createElement("div",{className:(0,g.mergeStyles)(l.pF,I&&l.oO)},s().createElement(u.IconButton,{title:p.D.getLocalizedString("WS_Metric_Previous"),ariaLabel:p.D.getLocalizedString("WS_Metric_Previous"),iconProps:{iconName:"ChevronLeft"},onClick:function(){if(x.current){var e=x.current.scrollLeft;x.current.scroll(e-200,0)}},styles:l.Cg.ScrollButtonStyle})),s().createElement("div",{className:l.wd,ref:x},_&&(null==w?void 0:w.map((function(e,t){return s().createElement(d.L,(0,o.pi)({},e,{key:t}))})))),s().createElement("div",{className:(0,g.mergeStyles)(l.C6,F&&l.oO)},s().createElement(u.IconButton,{title:p.D.getLocalizedString("WS_Metric_Next"),ariaLabel:p.D.getLocalizedString("WS_Metric_Next"),iconProps:{iconName:"ChevronRight"},onClick:function(){if(x.current){var e=x.current.scrollLeft;x.current.scroll(e+200,0)}},styles:l.Cg.ScrollButtonStyle})))))}},1672:function(e,t,n){"use strict";n.d(t,{F5:function(){return b},lw:function(){return k}});var i=n(49037),r=n(63804),o=n.n(r),a=n(67162),s=n(36711),l=n(87018),c=n(13845),d=n(73615),u=n(21525),p=n(27696),m=n(48945),h=n(30443),g=n(47482),f=n(73154),y=n(93170),v=n.n(y),C=n(23436),S=n(3416),E=a.PanelType.medium,b=a.PanelType.smallFixedFar,w="StatsSidePanel",D={metadataId:"opportunity",name:"opportunity",displayName:"Opportunity",primaryNameField:"name",primaryIdField:"opportunityid"},T={key:C.Guid.newGuid(),title:"",aggregate:"",description:"",fieldName:"",query:"",queryAlias:"",shouldDisplay:!1,filter:""},x=S.ol.map((function(e){return{key:e.key,title:e.title,shouldDisplay:e.shouldDisplay,filter:e.filter,fieldName:e.fieldName,aggregate:e.aggregate,description:e.description,query:e.query,queryAlias:e.queryAlias}})),k=function(e){var t,n=e.dashletList,S=e.defaultPanelType,k=e.setDashletList,_=e.setDashletHasChanges,N=e.onDismiss,L=(0,r.useState)(S),I=L[0],A=L[1],R=(0,r.useState)(T),F=R[0],P=R[1],M=(0,r.useState)(void 0),O=M[0],V=M[1],z=(0,r.useState)(!0),B=z[0],U=z[1],H=(0,r.useState)(!1),G=H[0],W=H[1],j=(0,r.useState)(!1),X=j[0],K=j[1],q=n.map((function(e){return{key:e.key,text:m.D.getLocalizedString(e.title),canCheck:!0,checked:!e.shouldDisplay,canDelete:!0,canEdit:!0}})),Z={toolTipLabel:m.D.getLocalizedString("WS_MetricList_Edit"),title:m.D.getLocalizedString("WS_MetricList_Edit"),ariaLabel:m.D.getLocalizedString("WS_MetricList_Edit"),styles:u.p.editIcon,onActionIconClick:function(e){ee(e)}},J=function(e,t){var n="";switch(e){case"createStat":n="Create New Stat";break;case"editStat":n="Edit Stat";break;case"deleteStat":n="Delete Stat";break;default:n="Invalid Action"}m.D.reportUserAction("handleDashletAction",w,n,{action:e},n,""),"deleteStat"===e?(V(e),P(t),W(!0)):(V(e),P(t),A(E))},Q=function(){if(m.D.reportUserAction("handleApplyClicked",w,"Apply Dashlet Changes",{},"Apply Dashlet Changes",""),F){var e=g.ZH.getUnEncodedAggregateFetchXml(D.name,F.aggregate,F.fieldName,F.queryAlias,F.filter);"count"===F.aggregate&&(e=g.ZH.getUnEncodedAggregateFetchXml(D.name,F.aggregate,D.primaryIdField,F.queryAlias,F.filter));var t=(0,i.pi)((0,i.pi)({},F),{query:e});P(t);var r=n.findIndex((function(e){return e.key===(null==F?void 0:F.key)}));-1!==r?n[r]=(0,i.pi)((0,i.pi)({},n[r]),t):n.push(t),k(n),_(!0)}A(b),U(!0)},Y=function(){m.D.reportUserAction("handleBackClicked",w,"Navigate back to DashletList",{},"Navigate back to DashletList",""),B||K(!0),A(b)},$=function(){m.D.reportUserAction("handlePanelDismiss",w,"Cancel dashletList panel",{},"Cancel dashletList panel",""),I===E?(B||K(!0),A(b)):null==N||N()},ee=function(e){m.D.reportUserAction("handleEditButtonClick",w,"User select a dashlet to edit",{item:e},"User select a dashlet to edit",""),J("editStat",n.find((function(t){return t.key===e.key}))),A(E)};return o().createElement(o().Fragment,null,o().createElement(a.Panel,{isOpen:e.isOpen,styles:u.p.panelStyle,onDismiss:$,closeButtonAriaLabel:m.D.getLocalizedString("WS_Close"),onRenderHeader:function(){return I===E?o().createElement(s.Stack,{horizontal:!0,horizontalAlign:"start",verticalAlign:"center",tokens:{childrenGap:8},grow:!0,styles:u.p.dashletDesignerHeaderStack},o().createElement(l.IconButton,{"data-testid":"back_button",styles:u.p.backIcon,iconProps:{iconName:"Back"},onClick:Y,title:m.D.getLocalizedString("WS_Back"),ariaLabel:m.D.getLocalizedString("WS_Back")}),o().createElement(c.Label,{style:u.p.headerText},"createStat"===O?m.D.getLocalizedString("WS_MetricSidePanel_Header_Create"):m.D.getLocalizedString("WS_MetricSidePanel_Header_Edit"))):o().createElement(s.Stack,{horizontalAlign:"start",grow:!0,styles:u.p.dashletListHeaderStack},o().createElement(s.Stack,{horizontal:!0,horizontalAlign:"start",verticalAlign:"center",tokens:{childrenGap:4},grow:!0},o().createElement(c.Label,{style:u.p.headerText},m.D.getLocalizedString("WS_MetricSidePanel_Header_EditMetrics"))))},onRenderFooterContent:function(){return I!==b?o().createElement(s.Stack,{horizontal:!0,horizontalAlign:"end",verticalAlign:"center",tokens:{childrenGap:16}},o().createElement(l.PrimaryButton,{"data-testid":"apply_button",onClick:Q,disabled:B},m.D.getLocalizedString("WS_Apply")),o().createElement(l.DefaultButton,{"data-testid":"cancel_button",onClick:$},m.D.getLocalizedString("WS_Cancel"))):o().createElement(o().Fragment,null)},isFooterAtBottom:!0,hasCloseButton:!0,isHiddenOnDismiss:!1,isLightDismiss:!0,type:I},I===b?o().createElement(s.Stack,{styles:{root:{padding:"20px"}},tokens:{childrenGap:20}},o().createElement(s.Stack,{horizontal:!0,tokens:{childrenGap:8}},o().createElement(s.Stack.Item,{align:"start"},o().createElement(l.ActionButton,{"data-testid":"create_button",styles:u.p.addIcon,text:m.D.getLocalizedString("WS_MetricList_Create"),iconProps:{iconName:"Add"},onClick:function(){return J("createStat",(0,i.pi)((0,i.pi)({},T),{key:C.Guid.newGuid()}))}})),o().createElement(s.Stack.Item,{align:"end"},o().createElement(l.ActionButton,{styles:u.p.editIcon,"data-testid":"reset_button",text:m.D.getLocalizedString("WS_Reset"),iconProps:{iconName:"ResetColumns",className:f.R},onClick:function(){m.D.reportUserAction("handleResetDashlet","handleResetDashlet","User click on reset button in edit dashlet pane",{},"User click on reset button in edit dashlet pane",""),h.C.set("msdyn_dashlet_selection",x),k(x.map((function(e){return{key:e.key,title:e.title,shouldDisplay:e.shouldDisplay,filter:e.filter,fieldName:e.fieldName,aggregate:e.aggregate,description:e.description,query:e.query,queryAlias:e.queryAlias}})))}}))),o().createElement(d.H,{listItems:q,onCheckboxChange:function(e,t,r){m.D.reportUserAction("handleCheckboxChange",w,"User change dashlet checkbox state",{checked:r},"User change dashlet checkbox state","");var o=n.findIndex((function(t){return t.key===e}));n[o].shouldDisplay=r,h.C.set("msdyn_dashlet_selection",n),k((0,i.pr)(n))},onDeleteDashlet:function(e){m.D.reportUserAction("handleDeleteColumn","handleDeleteColumn","User delete a field from the edit column pane",{},"User delete a field from the edit column pane","");var t=n.find((function(t){return t.key===e.key}));P(t),W(!0)},onReOrderDashlet:function(e,t,i){m.D.reportUserAction("handleReOrderDashletList","handleReOrderDashletList","User drag and drop a dashlet",{},"User drag and drop a dashlet","");var r=[];n.forEach((function(e){return r.push({aggregate:e.aggregate,description:e.description,fieldName:e.fieldName,filter:e.filter,key:e.key,query:e.query,queryAlias:e.queryAlias,shouldDisplay:e.shouldDisplay,title:e.title})}));var o=r.splice(t,1)[0];r.splice(i,0,o),h.C.set("msdyn_dashlet_selection",r),k(r)},editButtonProps:Z})):o().createElement(p.u,{selectedDashlet:F,onDashletConfigChanged:function(e){""!==e.title&&""!==e.fieldName&&""!==e.aggregate?U(!1):U(!0),P((0,i.pi)({},e))},entity:D}),G&&(t={type:y.DialogType.close,title:m.D.getLocalizedString("WS_MetricSidePanel_Delete_Dialog_Title",m.D.getLocalizedString(F.title)),closeButtonAriaLabel:m.D.getLocalizedString("WS_Cancel"),subText:m.D.getLocalizedString("WS_MetricSidePanel_Delete_Dialog_Confirmation_Message")},m.D.reportInfo("onRenderDeleteDialog",w,"",{title:t.title}),o().createElement(v(),{hidden:!1,onDismiss:function(e){W(!1)},dialogContentProps:t},o().createElement(y.DialogFooter,null,o().createElement(l.PrimaryButton,{onClick:function(){!function(){m.D.reportUserAction("handleDeleteClicked",w,"Delete Dashlet",{},"Delete Dashlet","");var e=n.findIndex((function(e){return e.key===F.key}));n.splice(e,1),h.C.set("msdyn_dashlet_selection",n),k((0,i.pr)(n))}(),W(!1)},text:m.D.getLocalizedString("WS_MetricSidePanel_Delete_OK")}),o().createElement(l.DefaultButton,{onClick:function(e){W(!1)},text:m.D.getLocalizedString("WS_Cancel")})))),X&&function(){var e={type:y.DialogType.close,title:m.D.getLocalizedString("WS_MetricSidePanel_Apply_Dialog_Title",m.D.getLocalizedString(F.title)),closeButtonAriaLabel:m.D.getLocalizedString("WS_Cancel"),subText:m.D.getLocalizedString("WS_MetricSidePanel_Apply_Dialog_Confirmation_Message")};return m.D.reportInfo("onRenderApplyDialog",w,"",{title:e.title}),o().createElement(v(),{hidden:!1,onDismiss:function(e){K(!1),U(!0)},dialogContentProps:e},o().createElement(y.DialogFooter,null,o().createElement(l.PrimaryButton,{onClick:function(){Q(),K(!1)},text:m.D.getLocalizedString("WS_MetricSidePanel_Apply_Dialog_Apply")}),o().createElement(l.DefaultButton,{onClick:function(e){K(!1),U(!0)},text:m.D.getLocalizedString("WS_MetricSidePanel_Apply_Dialog_Discard")})))}()))}},21525:function(e,t,n){"use strict";n.d(t,{p:function(){return a}});var i=n(94589),r=n(54988),o=n(29086),a={headerText:{fontSize:i.TS.size20,color:r.iX.gray160,fontWeight:600},panelStyle:{root:{},content:{paddingLeft:"0px",paddingRight:"0px"}},rowStyle:{root:{borderBottom:"none"},checkCell:{background:r.iX.white},check:{background:r.iX.white},checkCover:{background:r.iX.white},cell:{background:r.iX.white,paddingTop:"4px",paddingBottom:"4px",paddingRight:"16px"}},headerStack:{root:{paddingLeft:"16px"}},addIcon:{root:{color:r.iX.gray130,padding:"12, 12, 24",width:"180px"},rootHovered:{color:r.iX.gray130},icon:{fontSizes:"14px"}},editIcon:{root:{color:r.iX.gray130,padding:"12, 12, 24"},rootHovered:{color:r.iX.gray130},icon:{fontSizes:"14px"}},deleteIcon:{root:{color:r.iX.gray130,padding:"12, 12, 24"},rootHovered:{color:r.iX.gray130},icon:{fontSizes:"14px"}},clearIcon:{root:{color:r.iX.gray130,padding:"12, 12, 24"},rootHovered:{color:r.iX.gray130},icon:{fontSizes:"14px"}},tooltipRowStack:{root:{padding:"8px"}},tooltipText:{fontSize:i.TS.size12,fontWeight:400,color:r.iX.gray160},itemLabelStyle:{root:{fontSize:i.TS.size14,fontWeight:"400",width:"100%"}},gripperIcon:{root:{color:r.iX.gray130},rootHovered:{backgroundColor:"none",color:r.iX.gray130},rootPressed:{backgroundColor:"none",color:r.iX.gray130}},checkboxCellClass:(0,o.mergeStyles)({display:"flex",alignItems:"center"}),checkboxContainerClass:(0,o.mergeStyles)({paddingLeft:"16px",display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"left",alignItems:"center",pointerEvents:"none",height:"100%"}),itemContainerClass:(0,o.mergeStyles)({paddingRight:"0px",display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"flex-start",alignItems:"stretch"}),dashletDesignerStack:{root:{padding:"10px"}},dashletDesignerHeaderStack:{root:{paddingLeft:"14px",paddingBottom:"15px"}},dashletListHeaderStack:{root:{paddingLeft:"14px",borderBottom:"solid 1px",borderBottomColor:r.iX.gray20}},backIcon:{root:{color:r.iX.gray130},rootHovered:{color:r.iX.gray130},icon:{fontSizes:"14px"}},resetButton:{root:{paddingTop:"10px",paddingBottom:"10px"}}}},91563:function(e,t,n){"use strict";n.d(t,{pF:function(){return s},C6:function(){return l},oO:function(){return c},U9:function(){return d},wd:function(){return u},Cg:function(){return p}});var i=n(54988),r=n(94589),o=n(19608),a=(0,o.mergeStyles)({position:"absolute",top:0,display:"flex",zIndex:100,width:"100px",height:"20px"}),s=(0,o.mergeStyles)(a,{left:0,background:"linear-gradient(270deg, rgba(248,248,248,0) 0%, rgba(248,248,248,1) 100%)"}),l=(0,o.mergeStyles)(a,{right:0,background:"linear-gradient(90deg, rgba(248,248,248,0) 0%, rgba(248,248,248,1) 100%)",flexDirection:"row-reverse"}),c=(0,o.mergeStyles)({display:"none"}),d=(0,o.mergeStyles)({paddingTop:"4px",paddingLeft:"4px"}),u=(0,o.mergeStyles)({width:"100%",display:"inline-flex",gap:"32px",overflowX:"hidden",scrollBehavior:"smooth",scrollbarWidth:"none",paddingRight:"32px"}),p={PanelStyle:{backgroundColor:"#F8F8F8",padding:"12px 0px 12px 0px",transform:"scale(1)"},EmptyPanelStyle:{height:"0px",padding:"0px"},PanelStackStyle:{display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"flex-start",alignItems:"center",height:"100%",msOverflowStyle:"none",position:"relative"},ScrollButtonsContainerStyle:{position:"absolute",height:"100%",width:"100%",top:"0px",right:"0px",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"baseline",flexWrap:"nowrap"},ScrollButtonStyle:{root:{fontSize:"16px",width:"16px",height:"20px",color:i.iX.gray130,background:"none"},rootHovered:{color:i.iX.gray100,background:"none"},rootPressed:{color:i.iX.gray100,background:"none"}},DashletContainer:{display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"baseline",width:"auto",height:"auto",flexShrink:0,gap:"12px"},TitleStyle:{color:i.iX.gray130,fontSize:r.TS.size14},ContentStyle:{display:"flex",flexWrap:"wrap"},FormattedValueStyle:{color:i.iX.black,fontWeight:600,fontSize:r.TS.size14,paddingRight:"6px"},ChangePercentageStylePositive:{color:"#0F7A0B",fontSize:r.TS.size12,padding:"8px 0px 0px 0px"},ChangePercentageStyleNegative:{color:"#C32727",fontSize:r.TS.size12,padding:"8px 0px 0px 6px"}}},57246:function(e,t,n){"use strict";n.d(t,{G:function(){return d}});var i=n(49037),r=n(63804),o=n.n(r),a=n(95682),s=n(80190),l=n(4476),c=n(74872),d=function(e){var t,n,d,u=e.entityMetadata,p=e.entityType,m=e.displayedItems,h=e.fieldSelectionMap,g=e.relationshipsMap,f=e.isSmartFieldMode,y=e.updateFieldSelectionMap,v=e.updateRelationshipMap,C=(0,r.useState)(new Set(e.displayedItems)),S=C[0],E=C[1],b=(0,r.useState)(new Map),w=b[0],D=b[1],T=(0,r.useState)(!0),x=T[0],k=T[1],_=(0,r.useMemo)((function(){return l._.getDataverseAccess()}),[l._.getDataverseAccess]),N=new c.D(e.context,l._.getContainerContext(e.context));(0,r.useEffect)((function(){(0,i.mG)(void 0,void 0,Promise,(function(){var e,t,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return h||f?[3,3]:(e=null==u?void 0:u.get(p))?(t={metadataId:e.metadataId,name:e.name,displayName:e.displayName,primaryNameField:e.primaryNameField,primaryIdField:e.primaryIdField},[4,_.cdsResolver.resolveFields(t)]):[3,3];case 1:return d=i.sent(),n=new Map,d.forEach((function(e){m.some((function(t){return t===e.name}))||n.set(e.name,{logicalName:e.name,dataType:e.dataType,displayName:e.displayName,customizationType:"",isValidForForm:!0,isValidForGrid:!0,schemaName:""})})),y(n),[4,L()];case 2:i.sent(),i.label=3;case 3:return k(!1),[2]}}))}))}),[]);var L=function(){return(0,i.mG)(void 0,void 0,void 0,(function(){var e,t,n;return(0,i.Jh)(this,(function(i){return e=new Map,null==(t=null===(n=null==u?void 0:u.get(p))||void 0===n?void 0:n.manyToOneRelationships)||t.map((function(t){var n=null==d?void 0:d.find((function(e){return e.name===t.referencingFieldName}));if(n){var i=n.name+"."+t.referencedEntity;if(!e.has(i)){var r={relatedResourceLabel:n.displayName,relationshipHash:i,relatedEntityFields:void 0,referencedFieldName:t.referencedFieldName,referencingFieldName:t.referencingFieldName};e.set(r.relationshipHash,r)}}A(e)})),[2]}))}))},I=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){var n,r,o,a,s;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return[4,N.fetchEntityMetadata(e,[])];case 1:return n=i.sent(),r=new Map,n?(o=n[0],a={metadataId:o.metadataId,name:o.name,displayName:o.displayName,primaryNameField:o.primaryNameField,primaryIdField:o.primaryIdField},[4,_.cdsResolver.resolveFields(a)]):[3,3];case 2:(s=i.sent())&&s.map((function(e){var n={logicalName:e.name,dataType:e.dataType,displayName:e.displayName,customizationType:"",isValidForForm:!0,isValidForGrid:!0,schemaName:"",parentRelationshipHash:t,entityLabel:o.displayName};r.set(e.name,n)})),i.label=3;case 3:return[2,r]}}))}))},A=function(e){v(new Map(e))};return o().createElement("div",null,o().createElement(a.IQ,{hidePrimaryEntityTab:f,hideRelatedTab:f,disabledRelatedPivot:x,relationships:g,fieldListProps:{usedFields:S,onFieldSelected:function(t){!function(t){var n,i,r,o="",a="",l="";if((0,s.Os)(t)){w.has(t.parentRelationshipHash)?null===(n=w.get(t.parentRelationshipHash))||void 0===n||n.add(t.logicalName):w.set(t.parentRelationshipHash,(new Set).add(t.logicalName)),r=t.parentRelationshipHash.split(".")[1];var c=null==g?void 0:g.get(t.parentRelationshipHash);c&&(a=c.referencingFieldName,o=c.referencedFieldName,l=c.relatedResourceLabel,null===(i=c.relatedEntityFields)||void 0===i||i.delete(t.logicalName),A(g)),D(new Map(w))}else S.add(t.logicalName),E(new Set(S)),r=p;e.onSelectField(t,r,o,a,l)}(t)}},entity:{canCreateAttributes:!1,displayName:(null===(t=null==u?void 0:u.get(p))||void 0===t?void 0:t.displayName)||"opportunity",isCustomizable:!1,isManaged:!1,logicalName:(null===(n=null==u?void 0:u.get(p))||void 0===n?void 0:n.name)||"opportunity",objectTypeCode:1,fields:h},relationshipListProps:{usedRelatedFields:w,onRelatedEntityExpanded:function(e){!function(e){(0,i.mG)(void 0,void 0,void 0,(function(){var t,n,r,o;return(0,i.Jh)(this,(function(a){switch(a.label){case 0:return!(t=null==g?void 0:g.get(e))||t.relatedEntityFields?[3,2]:(n=e.split(".")[1],[4,I(n,e)]);case 1:r=a.sent(),t&&(o=(0,i.pi)((0,i.pi)({},t),{relatedEntityFields:r}),g.set(e,o),A(g)),a.label=2;case 2:return[2]}}))}))}(e)}}}))}},6055:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var i=n(63804),r=n(54988),o=n(19608),a=n(31974),s=(0,o.mergeStyles)({background:"white","&:hover":{background:r.iX.gray30}}),l=function(e){var t=e.items,n=e.columnsStatus,r=e.onReOrderColumn,o=e.onDeleteColumn,l=e.onColumnCheckboxChange,c=Object.keys(n).length,d=Object.values(n).filter((function(e){return e.isHidden})).length;return i.createElement(a.m,{items:t,displayCheckbox:!0,dragDropItemStyle:s,hiddenColumnsCount:d,totalColumnsCount:c,onCheckboxChange:l,onReorderList:r,onDeleteItem:o})}},73154:function(e,t,n){"use strict";n.d(t,{s:function(){return r},R:function(){return o}});var i=n(29086),r={root:{height:30,border:"none"},label:{fontWeight:i.FontWeights.regular}},o=(0,i.mergeStyles)({width:16,height:16,color:"currentColor",fontSize:i.FontSizes.size16})},76810:function(e,t,n){"use strict";n.d(t,{H:function(){return S}});var i=n(49037),r=n(63804),o=n(87018),a=n(65597),s=n(91847),l=n(73384),c=n(86765),d=n(6055),u=n(48122),p=n(73186),m=n(73154),h=n(59731),g=n(28741),f=n(48945),y=n(4432),v=n(6253),C="EditColumnsPane",S=function(e){var t=e.items,n=e.columnsStatus,S=e.firstColumn,E=e.canHideColumn,b=e.updateFirstColumn,w=e.updateColumnStatus,D=e.onPanelModeChange,T=e.onDeleteColumn,x=e.onResetColumns,k=e.onReOrderColumn,_=r.useState(),N=_[0],L=_[1],I=f.D.getLocalizedString(g.gT.dropdownSearchText),A=f.D.getLocalizedString(g.gT.dropdownSearchText),R=r.useMemo((function(){return N?t.filter((function(e){return-1!==e.text.toLocaleLowerCase().indexOf(N)})):t}),[t,N]),F={items:[{key:"basic",text:f.D.getLocalizedString(g.gT.dropdownAddBasicColumnText),onClick:function(){f.D.reportUserAction("onSelectAddColumn",C,"Select add basic column",{action:"basic"},"Select add basic column",""),D("basic")}},{key:"smart",text:f.D.getLocalizedString(g.gT.dropdownAddSmartColumnText),onClick:function(){f.D.reportUserAction("onSelectAddColumn",C,"Select add smart column",{action:"smart"},"Select add smart column",""),D("smart")}}]},P={styles:{root:{padding:8}},iconProps:{iconName:"Add"},text:f.D.getLocalizedString(g.gT.editColumnPaneAddColumnTitle),menuProps:F};return r.createElement(s.Stack,{tokens:{childrenGap:10}},r.createElement(s.Stack.Item,{grow:!0},r.createElement(a.SearchBox,{ariaLabel:I,placeholder:A,iconProps:{style:{color:y.I.digitalBlue}},onChange:function(e,t){return L(null==t?void 0:t.toLocaleLowerCase())}})),r.createElement(s.Stack,{tokens:{childrenGap:5}},r.createElement(s.Stack,{horizontal:!0,horizontalAlign:"space-between"},r.createElement(o.CommandBarButton,(0,i.pi)({},P)),r.createElement(c.TooltipHost,{content:f.D.getLocalizedString("WS_Grid_EditColumns_Reset_Tooltip_label")},r.createElement(o.CommandBarButton,{iconProps:{iconName:"ResetColumns",className:m.R},styles:m.s,onClick:x},f.D.getLocalizedString("WS_Reset")))),r.createElement(l.Separator,null)),R&&0!=R.length?r.createElement(s.Stack,null,r.createElement(d.Z,{items:R,columnsStatus:n,onDeleteColumn:T,onColumnCheckboxChange:function(e,t,i){u.r.onColumnHideOrShow("gridOptionsCommandBar",E(e),e,!i,S,n,b,w,function(e){var t,n=null===(t=p.f.grid)||void 0===t?void 0:t.sorting.find((function(t){return t.name==e}));return n?n.sortDirection:h.Sr.none}(e))},onReOrderColumn:k})):r.createElement(v.u,{getScenario:function(){return g.yW.SearchReturnedEmpty},showButton:!1}))}},81014:function(e,t,n){"use strict";n.d(t,{K:function(){return d}});var i=n(63804),r=n.n(i),o=n(36711),a=n(57246),s=n(76810),l=n(14809),c=new Map,d=function(e){var t=e.designerMode,n=e.items,d=e.firstColumn,u=e.columnsStatus,p=e.fieldSelectionMap,m=e.relationshipsMap,h=e.canHideColumn,g=e.updateColumnStatus,f=e.updateColumnsStatus,y=e.updateFirstColumn,v=e.onPanelModeChange,C=e.onSelectField,S=e.onDeleteColumn,E=e.onReOrderColumnStatus,b=e.onResetColumns,w=e.updateRelationshipMap,D=e.updateFieldSelectionMap,T="smart"===t;return(0,i.useMemo)((function(){new Map,Object.values((0,l.b)()).map((function(e){c.set(e.fieldName,{logicalName:e.fieldName,dataType:e.dataType,displayName:e.displayName,customizationType:"",isValidForForm:!0,isValidForGrid:!0,schemaName:""})}))}),[]),r().createElement(o.Stack,{styles:{root:{padding:"20px"}},tokens:{childrenGap:20}},"edit"===t?r().createElement(s.H,{items:n,columnsStatus:u,firstColumn:d,canHideColumn:h,updateFirstColumn:y,updateColumnStatus:g,onDeleteColumn:S,onResetColumns:b,onReOrderColumn:E,onPanelModeChange:v}):r().createElement(a.G,{isSmartFieldMode:T,displayedItems:n.map((function(e){return e.key})),context:e.context,entityType:e.entityType,entityMetadata:e.entityMetadata,updateColumnsStatus:f,columnsStatus:u,onSelectField:C,fieldSelectionMap:T?c:p,relationshipsMap:m,updateFieldSelectionMap:D,updateRelationshipMap:w}))}},13814:function(e,t,n){"use strict";n.d(t,{M:function(){return s}});var i=n(54988),r=n(94589),o=n(29086),a=n(4432),s={addIcon:{root:{color:i.iX.gray130,padding:"12, 12, 24"},rootHovered:{color:i.iX.gray130},icon:{fontSizes:"14px"}},backIcon:{root:{color:i.iX.gray130},rootHovered:{color:i.iX.gray130},icon:{fontSizes:"14px"}},checkboxCellClass:(0,o.mergeStyles)({display:"flex",alignItems:"center"}),checkboxContainerClass:(0,o.mergeStyles)({paddingLeft:"16px",display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"left",alignItems:"center",pointerEvents:"none",height:"100%"}),clearIcon:{root:{color:i.iX.gray130,padding:"12, 12, 24"},rootHovered:{color:i.iX.gray130},icon:{fontSizes:"14px"}},deleteIcon:{root:{color:i.iX.gray130,padding:"12, 12, 24"},rootHovered:{color:i.iX.gray130},icon:{fontSizes:"14px"}},editIcon:{root:{color:i.iX.gray130,padding:"12, 12, 24"},rootHovered:{color:i.iX.gray130},icon:{fontSizes:"14px"}},gripperIcon:{root:{color:i.iX.gray130},rootHovered:{backgroundColor:"none",color:i.iX.gray130},rootPressed:{backgroundColor:"none",color:i.iX.gray130}},headerStack:{root:{paddingLeft:"16px",paddingBottom:"15px"}},headerText:{fontSize:r.TS.size20,color:i.iX.gray160,fontWeight:600},itemLabelStyle:{root:{fontSize:r.TS.size14,fontWeight:"400",width:"100%"}},itemContainerClass:(0,o.mergeStyles)({paddingRight:"0px",display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"flex-start",alignItems:"stretch"}),panelStyle:{root:{},content:{paddingLeft:"0px",paddingRight:"0px"}},resetButton:{root:{paddingTop:"10px",paddingBottom:"10px"}},rowStyle:{root:{borderBottom:"none"},checkCell:{background:i.iX.white},check:{background:i.iX.white},checkCover:{background:i.iX.white},cell:{background:i.iX.white,paddingTop:"4px",paddingBottom:"4px",paddingRight:"16px"}},tooltipRowStack:{root:{padding:"8px"}},tooltipHeaderStack:{root:{padding:"0px 16px 12px 16px"}},tooltipText:{fontSize:r.TS.size12,fontWeight:400,color:i.iX.gray160},tooltipLink:{fontSize:r.TS.size12,fontWeight:400,color:a.I.digitalBlue,textDecoration:"none"}}},86552:function(e,t,n){"use strict";n.d(t,{a:function(){return S}});var i=n(49037),r=n(63804),o=n.n(r),a=n(67162),s=n(36711),l=n(87018),c=n(13845),d=n(13814),u=n(81014),p=n(48122),m=n(80190),h=n(28741),g=n(48945),f=n(47482),y=n(30443),v=n(14809),C="EntityGridSidePanel",S=function(e){var t=e.columnsStatus,n=e.firstColumn,S=e.isEditColumnPanelOpen,E=e.insertColumnIndex,b=e.insertColumnDirection,w=e.fieldSelectionMap,D=e.relationshipsMap,T=e.selectedView,x=e.onDismiss,k=e.canHideColumn,_=e.updateColumnStatus,N=e.updateColumnsStatus,L=e.updateFirstColumn,I=e.updateRelationshipMap,A=e.updateFieldSelectionMap,R=e.updateColumnsStatusAndDataset,F=(0,r.useState)("edit"),P=F[0],M=F[1],O=Object.values(e.columnsStatus).filter((function(e){return-1!==e.index})).sort((function(e,t){return e.index-t.index})).map((function(e){return{key:e.fieldName,text:e.displayName,canCheck:!0,checked:e.isHidden,canDelete:e.isExtraColumn}})),V=function(){g.D.reportUserAction("handleBackClicked",C,"Navigate back to Edit Column",{},"Navigate back to Edit Column",""),M("edit")};return o().createElement(o().Fragment,null,o().createElement(a.Panel,{isOpen:S,styles:d.M.panelStyle,onDismiss:function(){g.D.reportUserAction("handlePanelDismiss",C,"Cancel Grid Column side panel",{},"Cancel Grid Column side panel",""),"edit"===P?null==x||x():M("edit")},closeButtonAriaLabel:g.D.getLocalizedString("WS_Close"),onRenderHeader:function(){return"edit"===P?o().createElement(s.Stack,{horizontalAlign:"start",grow:!0,styles:d.M.headerStack},o().createElement(s.Stack,{horizontal:!0,horizontalAlign:"start",verticalAlign:"center",tokens:{childrenGap:4},grow:!0},o().createElement(c.Label,{style:d.M.headerText},g.D.getLocalizedString(h.gT.dropdownEditColumnsText)))):o().createElement(s.Stack,{horizontal:!0,horizontalAlign:"start",verticalAlign:"center",tokens:{childrenGap:8},grow:!0,styles:d.M.headerStack},o().createElement(l.IconButton,{"data-testid":"back_button",styles:d.M.backIcon,iconProps:{iconName:"Back"},onClick:V,title:g.D.getLocalizedString("WS_Back"),ariaLabel:g.D.getLocalizedString("WS_Back")}),o().createElement(c.Label,{style:d.M.headerText},"basic"===P?g.D.getLocalizedString(h.gT.editColumnPaneAddColumnTitle):g.D.getLocalizedString(h.gT.editColumnPaneAddSmartColumnTitle)))},hasCloseButton:!0,isHiddenOnDismiss:!1,isLightDismiss:!0,type:a.PanelType.smallFixedFar},o().createElement(u.K,{designerMode:P,canHideColumn:k,items:O,firstColumn:n,updateFirstColumn:L,updateColumnStatus:_,updateColumnsStatus:N,columnsStatus:t,context:e.context,entityType:e.entityType,entityMetadata:e.entityMetadata,attributesMetadata:e.attributesMetadata,fieldSelectionMap:w,relationshipsMap:D,updateFieldSelectionMap:A,updateRelationshipMap:I,onDeleteColumn:function(e){g.D.reportUserAction("handleDeleteColumn","handleDeleteColumn","User delete a field from the edit column pane",{},"User delete a field from the edit column pane","");var n=t,r=e.key,o=(n[r],(0,i._T)(n,["symbol"==typeof r?r:r+""]));N(o),M("edit")},onSelectField:function(e,n,r,o,a){g.D.reportUserAction("handleSelectedField","handleSelectedField","User select a field from the add column pane",{},"User select a field from the add column pane",""),M("edit");var s,l=-1,c=!1;void 0!==E&&b?(l="left"===b?E:E+1,c=!0):l=Object.values(t).length,(0,m.Os)(e)&&(s={name:n,from:r,to:o});var d={displayName:(0,m.Os)(e)?p.r.getColumnDisplayName(e.displayName,e.entityLabel,a):e.displayName,fieldName:e.logicalName,baseFieldName:e.logicalName,index:l,isGroupingAllowed:!0,rowGroup:!1,rowGroupIndex:void 0,isHidden:!1,isSortingAllowed:!0,entityType:n,linkedEntity:s,isExtraColumn:!0,isSmartColumn:e.logicalName in(0,v.b)()},u={};u=(0,i.pi)({},t),c&&Object.values(u).map((function(e){e.index>=l&&(u[e.fieldName].index=e.index+1)})),u[e.logicalName]=d,R(u),M("edit")},onReOrderColumnStatus:function(e,n,i){g.D.reportUserAction("handleReOrderColumns","handleReOrderColumns","User drag and drop a column",{},"User drag and drop a column","");var r=e,o=e.splice(n,1)[0];r.splice(i,0,o);var a={};r.forEach((function(e,n){var i=t[e.key];-1!==i.index&&(i.index=n,a[e.key]=i)})),N(a)},onResetColumns:function(){g.D.reportUserAction("handleResetColumns","handleResetColumns","User click on reset button in edit column pane",{},"User click on reset button in edit column pane","");var e=y.C.get(f.ZH.getResetColumnInfoCacheKey(null==T?void 0:T.id));e&&N(e)},onPanelModeChange:M})))}},23498:function(e,t,n){"use strict";n.d(t,{nC:function(){return o},fL:function(){return a},sB:function(){return s},Pw:function(){return l},d2:function(){return c}});var i=n(19608),r=n(17754),o=(0,i.mergeStyles)({display:"flex",alignItems:"center"}),a=(0,i.mergeStyles)({color:r.rQ.palette.neutralSecondary}),s=(0,i.mergeStyles)({fontSize:16}),l=(0,i.mergeStyles)({display:"flex",alignItems:"center",marginLeft:10}),c=r.S_},59762:function(e,t,n){"use strict";n.d(t,{I:function(){return m}});var i=n(63804),r=n(19608),o=n(79549),a=n(1367),s=n(31209),l=n(59144),c=n(48945),d=n(17754),u=n(17873),p=n(23498),m=function(e){var t=e.isSearchActive,n=e.recordsVisible,m=e.totalRecords,h=e.isFiltered,g=e.searchedRecordCount||0,f=e.selectedRecordsCount||0,y=e.totalRowGroupsCount||0,v=e.displayCollectionName.toLocaleLowerCase(),C=e.entityDisplayName.toLocaleLowerCase(),S=(0,u.M)("headerTooltip"),E=i.useCallback((function(e){return e?C:v}),[v,C]),b=i.useCallback((function(){var e="";return f>0?e=c.D.getLocalizedString("WS_Grid_Selected_Records",f,E(1===f)):(e=t?c.D.getLocalizedString("WS_Grid_Showing_Records_With_Total",g,n,E(1===n)):c.D.getLocalizedString("WS_Grid_Showing_Records",n,E(1===n)),0!==y&&(e=e+" "+(1===y?c.D.getLocalizedString("WS_Grid_Groups_Singular"):c.D.getLocalizedString("WS_Grid_Groups_Plural",y)))),e}),[E,t,n,g,f,y]),w=(0,r.mergeStyles)(p.fL,{fontWeight:f?r.FontWeights.semibold:void 0}),D=(0,r.mergeStyles)(p.sB,{color:t?p.d2:d.rQ.palette.neutralSecondary}),T=c.D.getLocalizedString(h?"WS_Grid_Detail_Tooltip_Filtered":"WS_Grid_Detail_Tooltip",n,E(1===n),m),x=c.D.getLocalizedString(h?"WS_Grid_Detail_Tooltip_During_Search_Filtered":"WS_Grid_Detail_Tooltip_During_Search",n,E(1===n),m),k=t?x:T,_=n<m,N=i.useState(!1),L=N[0],I=N[1],A=i.useRef(null);return i.useEffect((function(){var e,n;t?_&&!L&&(null===(e=A.current)||void 0===e||e.show(),I(!0),setTimeout((function(){var e;null===(e=A.current)||void 0===e||e.dismiss()}),8e3)):null===(n=A.current)||void 0===n||n.dismiss()}),[L,t,_]),i.createElement("div",{className:p.nC},i.createElement(o.x,{className:w},b()),i.createElement(a.G,{componentRef:A,hostClassName:p.Pw,content:k,id:S,calloutProps:{directionalHint:s.b.topCenter,calloutMaxWidth:200}},_&&i.createElement(l.xu,{iconName:"Info",className:D})))}},72069:function(e,t,n){"use strict";n.d(t,{d:function(){return c}});var i=n(49037),r=n(63804),o=n(12684),a=n(48945),s=n(47482),l=n(28741),c=function(e){var t,n=e.attributesMetadata,c=e.columnsStatus,d=e.currentView,u=e.dataset,p=e.entityMetadata,m=e.entityType,h=e.recordContainerContext,g=e.combinedAggregateFetchXml,f=r.useState(),y=f[0],v=f[1],C=(null!==(t=p.get(m))&&void 0!==t?t:{}).entitySetName;return r.useEffect((function(){if(v(void 0),d&&m&&C){var e=[],t={entitySetName:C,aggregateFetchXml:""};n.forEach((function(n){if(s.ZH.isNumericField(n.dataType)&&d.columns.some((function(e){return e.name===n.name})))if(n.name.includes(".")){var r=p.get(n.name);l.gT.aggregateMethodList.forEach((function(o){var a=(0,i.pi)({},t);a.aggregateFetchXml=s.ZH.getAggregateFetchXmlWithLinkedEntity(m,r.name,r.primaryIdField,o,n.name.split(".")[1],n.name+"_"+o,null!=g?g:""),e.push(a)}))}else l.gT.aggregateMethodList.forEach((function(r){var o=(0,i.pi)({},t);o.aggregateFetchXml=s.ZH.getAggregateFetchXml(m,r,n.name,n.name+"_"+r,null!=g?g:""),e.push(o)}))})),e.length>0&&h&&h.dataProvider.executeAggregateBatchRequest(e).then((function(e){var t,n={data:new Map};null===(t=e.responses)||void 0===t||t.forEach((function(e){var t,i,r,o,a,s=null===(r=Object.keys(null!==(i=null===(t=null==e?void 0:e.aggregateValues)||void 0===t?void 0:t[0])&&void 0!==i?i:{}))||void 0===r?void 0:r[0],l=null===(o=null==s?void 0:s.split("@"))||void 0===o?void 0:o[0].substring(0,s.lastIndexOf("_"));l&&n.data.set(l,Object.assign(n.data.get(l)||{},null===(a=null==e?void 0:e.aggregateValues)||void 0===a?void 0:a[0]))})),v(n)})).catch((function(e){a.D.reportError("getAggregateData","aggregateComponent","Error occured in getAggregateData",{error:e.toString()})}))}}),[d,C,m,g]),r.useEffect((function(){var e,t,n=!1;y&&c&&u&&u.length>0&&(n=Array.from(y.data.keys()).some((function(e){var t;return!(null===(t=c[e])||void 0===t?void 0:t.isHidden)}))),n?(o.O.aggregateRowData=function(e){var t={key:l.gT.aggregateRowKey};return e.data.forEach((function(e,n){t[n]={sum:e[n+"_"+l.gT.aggMethodSum+l.gT.formattedValueSuffix],avg:e[n+"_"+l.gT.aggMethodAvg+l.gT.formattedValueSuffix],min:e[n+"_"+l.gT.aggMethodMin+l.gT.formattedValueSuffix],max:e[n+"_"+l.gT.aggMethodMax+l.gT.formattedValueSuffix]}})),t}(y),null===(e=o.O.setPinnedBottomRowData)||void 0===e||e.call(o.O,[o.O.aggregateRowData])):o.O.isBottomRowPinned()&&(null===(t=o.O.setPinnedBottomRowData)||void 0===t||t.call(o.O,[]))}),[y,c,u]),null}},68573:function(e,t,n){"use strict";n.d(t,{v:function(){return p}});var i=n(49037),r=n(28741),o=n(63804),a=n(92660),s=n(34684),l=n(67440),c=n(30443),d=n(48945),u=n(12684),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t,n,i,s;if(this.props.data.key==r.gT.aggregateRowKey)return this.renderAggregateCell();var l=this.props.createFieldControl(this.props.recordContainerContext,this.props.column.colDef.field,this.props.data.key);return(null===(t=null===(e=this.props.column.colDef)||void 0===e?void 0:e.refData)||void 0===t?void 0:t.imageProviderFunctionName)&&(null===(i=null===(n=this.props.column.colDef)||void 0===n?void 0:n.refData)||void 0===i?void 0:i.imageProviderWebresource)?o.createElement(a.X,{defaultElement:l,element:{colId:null===(s=this.props.column.colDef)||void 0===s?void 0:s.field,rowId:this.props.data.key},locale:this.props.localeId,showQuickActions:this.shouldShowQuickActions(),openEntity:this.props.openEntity,getCellImageInfo:this.props.getCellImageInfo}):l},t.prototype.shouldShowQuickActions=function(){var e,t;return(null===(t=null===(e=this.props.column)||void 0===e?void 0:e.colDef)||void 0===t?void 0:t.field)==u.O.getFirstColumn()},t.prototype.renderAggregateCell=function(){var e,t,n,i=this,r=null===(e=this.props.data)||void 0===e?void 0:e[null===(t=this.props.column.colDef)||void 0===t?void 0:t.field];if(r){var a=c.C.get(c.C.aggregateCachePrefix+(null===(n=this.props.column.colDef)||void 0===n?void 0:n.field))||this.getDefaultAggregateMethod(),s={items:this.getContextualMenuItems(r,a),shouldFocusOnMount:!0,className:"aggregateCallout",useTargetAsMinWidth:!0};return o.createElement(l.DefaultButton,{className:this.shouldShowQuickActions()?"firstColumnAggregateButton aggregateButton":"aggregateButton",onRenderText:function(){var e,t;return o.createElement("div",{className:"aggregateButtonDiv"},o.createElement("span",{className:"aggregateButtonText"},r[(null===(e=i.state)||void 0===e?void 0:e.aggregateMethod)||a]),o.createElement("span",{className:"aggregateButtonSecondaryText"},i.getLocalizedString((null===(t=i.state)||void 0===t?void 0:t.aggregateMethod)||a)))},menuProps:s})}return o.createElement("div",null)},t.prototype.getContextualMenuItems=function(e,t){var n=this,i=[];return i.push({key:"headerText",itemType:s.ContextualMenuItemType.Header,text:d.D.getLocalizedString("WS_Grid_Aggregate_Callout_Header")}),i.push({key:"divider_header",itemType:s.ContextualMenuItemType.Divider}),Object.keys(e).map((function(r){var o;i.push({key:r,text:n.getLocalizedString(r),secondaryText:e[r],ariaLabel:r,canCheck:!0,checked:t==r||(null===(o=n.state)||void 0===o?void 0:o.aggregateMethod)==r,role:"menuitemradio",onClick:function(){var e,t,i,o,a,s;d.D.reportUserAction("getContextualMenuItems","customCellRenderer","Aggregate method changed to "+r+" for column: "+(null===(t=null===(e=n.props.column)||void 0===e?void 0:e.colDef)||void 0===t?void 0:t.field)+".",{column:null===(o=null===(i=n.props.column)||void 0===i?void 0:i.colDef)||void 0===o?void 0:o.field,aggregateMethod:r},"Aggregate method changed",""),c.C.set(c.C.aggregateCachePrefix+(null===(s=null===(a=n.props.column)||void 0===a?void 0:a.colDef)||void 0===s?void 0:s.field),r),n.setState({aggregateMethod:r})}})})),i},t.prototype.getLocalizedString=function(e){switch(e){case"sum":return d.D.getLocalizedString("WS_Grid_Aggregate_Sum");case"avg":return d.D.getLocalizedString("WS_Grid_Aggregate_Avg");case"min":return d.D.getLocalizedString("WS_Grid_Aggregate_Min");case"max":return d.D.getLocalizedString("WS_Grid_Aggregate_Max");default:return""}},t.prototype.getDefaultAggregateMethod=function(){var e,t,n;return"Currency"===(null===(n=null===(t=null===(e=this.props.column)||void 0===e?void 0:e.colDef)||void 0===t?void 0:t.refData)||void 0===n?void 0:n.dataType)?"sum":"avg"},t}(o.Component)},37195:function(e,t,n){"use strict";n.d(t,{j:function(){return c}});var i=n(49037),r=n(63804),o=n(51848),a=n(59731),s=n(28741),l=n(48945),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.getMenuStrings=function(){var e={hideColumnText:l.D.getLocalizedString(s.gT.contextMenuHidecolumn),firstColumnText:l.D.getLocalizedString(s.gT.contextMenuSetAsFirstColumn),revertToDefaultSortText:l.D.getLocalizedString(s.gT.contextMenuRevertToDefaultSort),groupByThisColumnText:l.D.getLocalizedString(s.gT.contextMenuGroupByThisColumn),insertBasicColumnText:l.D.getLocalizedString(s.gT.insertBasicColumnText),insertLeftBasicColumnText:l.D.getLocalizedString(s.gT.insertLeftBasicColumnText),insertRightBasicColumnText:l.D.getLocalizedString(s.gT.insertRightBasicColumnText),filterByThisColumnText:l.D.getLocalizedString(s.gT.contextMenuFilterByColumn)};switch(this.props.dataType){case"Duration":case"Currency":case"Decimal":case"FloatingPoint":case"Integer":case"AutoNumber":case"Whole.None":e.sortAscMenuText=l.D.getLocalizedString(s.gT.contextMenuSortAscNumber),e.sortDescMenuText=l.D.getLocalizedString(s.gT.contextMenuSortDescNumber);break;case"DateOnly":case"DateAndTime":case"DateAndTime.DateOnly":e.sortAscMenuText=l.D.getLocalizedString(s.gT.contextMenuSortAscDate),e.sortDescMenuText=l.D.getLocalizedString(s.gT.contextMenuSortDescDate);break;default:e.sortAscMenuText=l.D.getLocalizedString(s.gT.contextMenuSortAscString),e.sortDescMenuText=l.D.getLocalizedString(s.gT.contextMenuSortDescString)}return e},t.prototype.render=function(){var e=this.props,t=e.target,n=e.sortDirection,i=(e.setEntityGridPanelIsOpen,e.onSortAscending),a=e.onSortDescending,c=e.onDismiss,d=e.onHide,u=e.onSetAsFirstColumn,p=e.onRevertToDefaultSort,m=e.onGroupByThisColumn,h=e.setFilterPanelIsOpen;l.D.reportUserAction("render","customHeaderRenderer","Column header contextual menu opened",{},"Column header contextual menu opened",this.props.columnName);var g=this.getContextualMenuItems(n);return r.createElement(o.ContextualMenu,{items:g,target:t,calloutProps:{className:"columnHeaderContextualMenu"},directionalHint:o.DirectionalHint.bottomLeftEdge,directionalHintForRTL:o.DirectionalHint.bottomRightEdge,directionalHintFixed:!1,onItemClick:function(e,t){if(t)switch(t.key){case s.gT.sortAscending:null==i||i();break;case s.gT.sortDescending:null==a||a();break;case s.gT.hideColumn:null==d||d();break;case s.gT.setAsFirstColumn:null==u||u();break;case s.gT.revertToDefaultSort:null==p||p();break;case s.gT.groupByThisColumn:null==m||m();break;case s.gT.filterByThisColumn:null==h||h(!0)}},shouldFocusOnMount:!0,shouldFocusOnContainer:!1,onDismiss:c})},t.prototype.getContextualMenuItems=function(e){var t=this,n=[],i=this.getMenuStrings();return this.props.isSortingAllowed&&(n.push({key:s.gT.sortAscending,name:i.sortAscMenuText,ariaLabel:i.sortAscMenuText,canCheck:!0,isChecked:e==a.Sr.asc,role:"menuitemradio","data-automation-id":"sortAtoZId"}),n.push({key:"divider_"+s.gT.sortAscending,itemType:o.ContextualMenuItemType.Divider}),n.push({key:s.gT.sortDescending,name:i.sortDescMenuText,ariaLabel:i.sortDescMenuText,canCheck:!0,isChecked:e==a.Sr.desc,role:"menuitemradio","data-automation-id":"sortZtoAId"}),n.push({key:"divider_"+s.gT.sortDescending,itemType:o.ContextualMenuItemType.Divider})),this.props.showRevertToDefaultSort&&(n.push({key:s.gT.revertToDefaultSort,name:i.revertToDefaultSortText,ariaLabel:i.revertToDefaultSortText,canCheck:!1,isChecked:!1,role:"menuitemradio","data-automation-id":"revertSort"}),n.push({key:"divider_"+s.gT.revertToDefaultSort,itemType:o.ContextualMenuItemType.Divider})),this.props.isGroupingAllowed&&(n.push({key:s.gT.groupByThisColumn,name:i.groupByThisColumnText,canCheck:!0,checked:this.props.isGroupByThisColumnChecked,ariaLabel:i.groupByThisColumnText}),n.push({key:s.gT.insertBasicColumnKey,name:i.insertBasicColumnText,canCheck:!1,ariaLabel:i.insertBasicColumnText,subMenuProps:{items:[{key:s.gT.insertLeftBasicColumnKey,text:i.insertLeftBasicColumnText,title:i.insertLeftBasicColumnText,onClick:function(e){return t.props.setEntityGridPanelIsOpen({isEditColumnPanelOpen:!0,insertColumnDirection:"left",insertColumnIndex:t.props.columnOrder})}},{key:s.gT.insertRightBasicColumnKey,text:i.insertRightBasicColumnText,title:i.insertRightBasicColumnText,onClick:function(e){return t.props.setEntityGridPanelIsOpen({isEditColumnPanelOpen:!0,insertColumnDirection:"right",insertColumnIndex:t.props.columnOrder})}}]}}),n.push({key:"divider_"+s.gT.groupByThisColumn,itemType:o.ContextualMenuItemType.Divider})),this.props.showHideColumn&&(n.push({key:s.gT.hideColumn,name:i.hideColumnText,ariaLabel:i.hideColumnText}),n.push({key:"divider_"+s.gT.hideColumn,itemType:o.ContextualMenuItemType.Divider})),this.props.isFirstColumn||(n.push({key:s.gT.setAsFirstColumn,name:i.firstColumnText,ariaLabel:i.firstColumnText}),n.push({key:"divider_"+s.gT.setAsFirstColumn,itemType:o.ContextualMenuItemType.Divider})),n.push({key:s.gT.filterByThisColumn,name:i.filterByThisColumnText,ariaLabel:i.filterByThisColumnText}),n},t}(r.Component)},23787:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var i=n(49037),r=n(63804),o=n(37195),a=n(73186),s=n(48122),l=n(59731),c=n(91847),d=n(52922),u=n(48945),p=n(12684),m=n(47482),h=function(e){function t(t){var n=e.call(this,t)||this;return n.dropdownTargetElement=r.createRef(),n.state={showContextMenu:!1,showCollapseAllIcon:!1},n}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t,n,i,u,h,g,f,y,v,C=this,S=this.props.column.colDef.field,E=(null===(t=null===(e=this.props.filterExpression)||void 0===e?void 0:e.conditions)||void 0===t?void 0:t.some((function(e){return e.attributeName===C.props.column.colId})))||(null===(i=null===(n=this.props.filterExpression)||void 0===n?void 0:n.filters)||void 0===i?void 0:i.some((function(e){var t;return null===(t=null==e?void 0:e.conditions)||void 0===t?void 0:t.some((function(e){return e.attributeName===C.props.column.colId}))}))),b=null;this.sortDirection=-1;var w=null===(h=(u=this.props).getColumnsStatus)||void 0===h?void 0:h.call(u)[S],D=null==w?void 0:w.index,T=null==w?void 0:w.isSortingAllowed,x=null==w?void 0:w.isGroupingAllowed,k=(null===(g=p.O.getAllDisplayedColumns())||void 0===g?void 0:g.length)>1,_=this.props.showRevertToDefaultSort(),N=this.props.getFirstColumn()==S,L=null==w?void 0:w.rowGroup,I=T||x||k||_||!N;if(T){var A=null===(y=null===(f=a.f.grid)||void 0===f?void 0:f.sorting.find((function(e){return e.name==S})))||void 0===y?void 0:y.sortDirection;this.sortDirection=null!=A?A:-1,0==this.sortDirection&&(b=r.createElement(d.Icon,{iconName:"SortUp"})),1==this.sortDirection&&(b=r.createElement(d.Icon,{iconName:"SortDown"}))}var R=r.createElement(r.Fragment,null,r.createElement(c.Stack.Item,{className:"customHeaderTextContainer"},r.createElement("div",{className:"customHeaderTextDiv",title:this.props.column.colDef.headerName},this.props.column.colDef.headerName)),E&&r.createElement(c.Stack.Item,{disableShrink:!0,className:"customHeaderIconsContainer customHeaderIconsContainerFilter"},r.createElement(d.Icon,{iconName:"Filter"})),I&&r.createElement(c.Stack.Item,{disableShrink:!0,className:"customHeaderIconsContainer"},r.createElement(d.Icon,{iconName:"ChevronDown"})),-1!=this.sortDirection&&r.createElement(c.Stack.Item,{disableShrink:!0,className:"customHeaderIconsContainer customHeaderIconsContainerSort"},b),I&&1==(null===(v=this.state)||void 0===v?void 0:v.showContextMenu)&&this.dropdownTargetElement.current&&r.createElement(o.j,{columnOrder:D,columnName:S,isSortingAllowed:T,isGroupingAllowed:!0,isGroupByThisColumnChecked:L,showHideColumn:k,showRevertToDefaultSort:_,isFirstColumn:N,sortDirection:this.sortDirection,onSortAscending:this.onColumnSort.bind(this,l.Sr.asc),onSortDescending:this.onColumnSort.bind(this,l.Sr.desc),target:this.dropdownTargetElement.current,onDismiss:function(){return C.setState({showContextMenu:!1})},onHide:function(){return s.r.onColumnHideOrShow("customHeaderRenderer",C.props.canHideColumn(S),S,!0,C.props.getFirstColumn(),C.props.getColumnsStatus(),C.props.updateFirstColumn,C.props.updateColumnStatus,C.sortDirection)},onSetAsFirstColumn:this.onSetAsFirstColumn.bind(this),onRevertToDefaultSort:this.onRevertToDefaultSort.bind(this),onGroupByThisColumn:function(){s.r.onColumnGroup("customHeaderRenderer",S,C.props.getColumnsStatus(),C.props.updateColumnStatus,C.props.updateColumnsStatus)},setEntityGridPanelIsOpen:this.props.setEntityGridPanelIsOpen,dataType:this.props.dataType,setFilterPanelIsOpen:this.props.setFilterPanelIsOpen})),F=m.ZH.getCustomHeaderClassName(S);return r.createElement("div",{className:"gridColumnHeaderItemClass"},S==this.props.getFirstColumn()&&this.props.totalRowGroupsCount>0&&this.renderExpandCollapseIcon(),r.createElement("div",{className:I?"customHeaderWithPointer "+F:"customHeaderWithoutPointer "+F,style:{width:"100%",height:"100%"},ref:this.dropdownTargetElement,onClick:function(){C.showContextMenu(F)},onKeyDown:function(e){13==e.keyCode&&C.showContextMenu(F)},tabIndex:0},r.createElement(c.Stack,{horizontal:!0,horizontalAlign:"start",verticalAlign:"center",verticalFill:!0,wrap:!1,className:"customHeaderRoot"},R)))},t.prototype.showContextMenu=function(e){this.setState({showContextMenu:!0}),p.O.elementToFocus=e},t.prototype.renderExpandCollapseIcon=function(){var e=this;return this.state.showCollapseAllIcon||this.props.rowGroupsCollapsedCount!=this.props.totalRowGroupsCount?r.createElement("div",{className:"gridColumnHeaderGroupIconDiv",onClick:function(t){p.O.collapseAll(),e.setState({showCollapseAllIcon:!1}),e.props.updateRowGroupsCollapsedCount(e.props.totalRowGroupsCount)}},r.createElement(d.Icon,{iconName:"ChevronDownMed",style:{fontWeight:600}})):r.createElement("div",{className:"gridColumnHeaderGroupIconDiv",onClick:function(t){p.O.expandAll(),e.setState({showCollapseAllIcon:!0}),e.props.updateRowGroupsCollapsedCount(0)}},r.createElement(d.Icon,{iconName:"ChevronRightMed",style:{fontWeight:600}}))},t.prototype.onRevertToDefaultSort=function(){u.D.reportUserAction("onRevertToDefaultSort","customHeaderRenderer","Revert to default sort",{columnHeaderClicked:this.props.column.colDef.field},"Revert to default sort",this.props.column.colDef.field),p.O.showLoadingOverlay(),a.f.sortColumn(this.props.defaultSortInfo)},t.prototype.onSetAsFirstColumn=function(){var e=this.props.column.colDef.field;u.D.reportUserAction("onSetAsFirstColumn","customHeaderRenderer","Set as first column",{columnMadeFirst:e},"Set as first column",e);var t=Object.assign({},this.props.getColumnsStatus()),n=t[e].index;Object.keys(t).map((function(e){t[e].index<n&&t[e].index++})),t[e].index=0,p.O.moveColumn(e,1),s.r.updateFirstColumn(this.props.getFirstColumn(),e,this.props.updateFirstColumn),this.props.updateColumnsStatus(t)},t.prototype.onColumnSort=function(e){var t,n,i=this.props.column.colDef.field;if(e!=this.sortDirection&&(null===(n=(t=this.props).getColumnsStatus)||void 0===n?void 0:n.call(t)[i].isSortingAllowed)){u.D.reportUserAction("onColumnSort","customHeaderRenderer","Sort column in order: "+e,{columnSorted:i},"Sort column",i),p.O.showLoadingOverlay();var r={name:i,sortDirection:e.valueOf()};a.f.sortColumn([r])}},t}(r.Component)},73186:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var i=n(49037),r=n(30443),o=function(){function e(){}return e.initialize=function(t){t.columns.sort((function(e,t){return e.order-t.order})),e.grid=t},e.loadMoreRows=function(){e.grid.paging.hasNextPage&&e.grid.paging.loadNextPage(),e.loadMoreRowsClicked=!0},e.sortColumn=function(t){var n;(n=e.grid.sorting).splice.apply(n,(0,i.pr)([0,e.grid.sorting.length],t)),r.C.set("sortInfo",t),e.grid.refresh()},e.onRowSelectionChanged=function(t){e.grid.setSelectedRecordIds(t)},e.reload=function(){e.grid&&e.grid.refresh()},e.loadMoreRowsClicked=!1,e}()},12684:function(e,t,n){"use strict";n.d(t,{O:function(){return S}});var i=n(49037),r=n(63804),o=n.n(r),a=n(28048),s=n(43179),l=n(72886),c=n(44170),d=n(95296),u=n(6253),p=n(28741),m=n(73186),h=n(55318),g=n(78195),f=n(48945),y=n(10176),v=n(97369),C=n(29758);c.LicenseManager.setLicenseKey("CompanyName=Microsoft Corporation,LicensedApplication=Business Applications Group,LicenseType=SingleApplication,LicensedConcurrentDeveloperCount=-1,LicensedProductionInstancesCount=-1,AssetReference=AG-015323,ExpiryDate=26_June_2022_[v2]_MTY1NjE5ODAwMDAwMA==79f580f1282d65cd03f5ef15c3ff99af");var S=function(e){function t(n){var i=e.call(this,n)||this;return i.state={isScriptLoaded:!1},f.D.componentStart(t.componentName),i}return(0,i.ZT)(t,e),t.prototype.componentWillUnmount=function(){t.gridApi=void 0,t.columnApi=void 0,t.currentGroupedColumnSortDir=-1,t.currentGroupedColumnDatatype=void 0,t.searchTextEntered="",t.aggregateRowData={},t.elementToFocus="",t.expandedRowGroups=[],t.searchActive=!1},t.prototype.render=function(){var e=!!this.props.dataset,t=this.props.displayCollectionName;return o().createElement(y.Shimmer,{styles:v.W.getGridShimmerStyles(),customElementsGroup:v.W.getGridOrChartShimmer(),isDataLoaded:e&&!!t},e&&!!t&&this.getAgGrid())},t.prototype.getAgGrid=function(){var e,n,i,r=this.props.getColumns(this.props.totalRowGroupsCount,this.props.rowGroupsCollapsedCount,this.props.updateRowGroupsCollapsedCount,this.props.updateTotalRowGroupsCount);t.rows=this.getRows(r),m.f.grid.paging.hasNextPage&&this.addRowForLoadMoreButton();var c=Object.values(this.props.columnsStatus).find((function(e){return e.rowGroup}));return t.currentGroupedColumnSortDir=null===(n=null===(e=m.f.grid)||void 0===e?void 0:e.sorting.find((function(e){return e.name==(null==c?void 0:c.fieldName)})))||void 0===n?void 0:n.sortDirection,t.currentGroupedColumnDatatype=c&&(null===(i=this.props.attributesMetadata.get(c.fieldName))||void 0===i?void 0:i.dataType),o().createElement("div",{id:"workspaceEntityGrid",className:t.rows.length>0?"gridContainer":"gridContainer emptyGrid"},o().createElement("div",{className:"ag-theme-alpine",style:{height:"100%",width:"100%"}},o().createElement(a.AgGridReact,{modules:[s.ClientSideRowModelModule,l.RowGroupingModule],rowData:t.rows,columnDefs:r,applyColumnDefOrder:!0,isFullWidthCell:function(e){return e.data&&e.data.key==p.gT.loadMoreRowKey},onSelectionChanged:this.onRowSelectionChanged.bind(this),onDragStopped:this.onDragStopped.bind(this),onRowClicked:this.onRowClicked.bind(this),animateRows:!1,debounceVerticalScrollbar:!1,suppressColumnVirtualisation:!0,enableRtl:f.D.isRTL(),suppressDragLeaveHidesColumns:!0,groupUseEntireRow:!0,rowBuffer:10,headerHeight:42,getRowHeight:function(e){return e.data&&e.data.key==p.gT.loadMoreRowKey?60:0==e.node.rowIndex?42:43},ensureDomOrder:!0,immutableData:!0,getRowNodeId:function(e){return e.key},isRowSelectable:function(e){return e.data&&e.data.key!=p.gT.loadMoreRowKey&&e.data.key!=p.gT.aggregateRowKey},onRowGroupOpened:this.onRowGroupOpened.bind(this),onColumnResized:this.onColumnResized.bind(this),onGridReady:this.onGridReady.bind(this),onRowDataUpdated:this.onRowDataUpdated.bind(this),onRowDoubleClicked:this.onRowDoubleClicked.bind(this),overlayLoadingTemplate:'<div class="grid-loader-spinner grid-loader-spinner-large"></div>',fullWidthCellRendererFramework:d.X,fullWidthCellRendererParams:{column:p.gT.loadMoreRowKey},noRowsOverlayComponentFramework:u.u,noRowsOverlayComponentParams:{getScenario:this.getScenario.bind(this)},groupRowRendererParams:{checkbox:!0,suppressDoubleClickExpand:!0},defaultGroupSortComparator:this.defaultGroupSortComparator.bind(this),rowSelection:"multiple",groupSelectsChildren:!0,suppressRowClickSelection:!0,suppressAggFuncInHeader:!0,defaultColDef:{sortable:!1,filter:!1,resizable:!0}})))},t.prototype.getScenario=function(){return m.f.grid.error?p.yW.Error:t.isSearchTextEntered()?p.yW.SearchReturnedEmptyTryChangingFilters:p.yW.NoData},t.prototype.onRowClicked=function(e){var n,i;t.searchActive&&!(null==e?void 0:e.node.expanded)&&t.filterExpandedRows(e.rowIndex),1==(null===(n=e.node)||void 0===n?void 0:n.group)&&(null===(i=e.node)||void 0===i||i.setExpanded(!e.node.expanded))},t.prototype.defaultGroupSortComparator=function(e,n){return e.key&&e.key!=f.D.getLocalizedString("WS_Grid_Grouping_Ungrouped")?n.key&&n.key!=f.D.getLocalizedString("WS_Grid_Grouping_Ungrouped")?1==t.currentGroupedColumnSortDir?t.currentGroupedColumnDatatype==C.EDataType.Date?new Date(n.key).getTime()-new Date(e.key).getTime():n.key.localeCompare(e.key):t.currentGroupedColumnDatatype==C.EDataType.Date?new Date(e.key).getTime()-new Date(n.key).getTime():e.key.localeCompare(n.key):-1:1},t.prototype.onColumnResized=function(e){var n,i;if(1==(null==e?void 0:e.finished)&&"uiColumnDragged"==(null==e?void 0:e.source)){var r=null===(n=null==e?void 0:e.columns[0])||void 0===n?void 0:n.colId;f.D.reportUserAction("onColumnResized","entityGrid","Column width resized. Column: "+r,{},"Column width resized","");var o=this.props.columnsStatus[r],a=this.props.firstColumn===r?t.firstColWidthParams:t.otherColWidthParams;o.width=Math.max(null===(i=e.columnApi)||void 0===i?void 0:i.getColumn(r).actualWidth,a.minWidth),this.props.updateColumnStatus(o)}},t.prototype.onRowGroupOpened=function(e){"rowGroupOpened"==(null==e?void 0:e.type)&&1==(null==e?void 0:e.expanded)?this.props.updateRowGroupsCollapsedCount(this.props.rowGroupsCollapsedCount-1):"rowGroupOpened"==(null==e?void 0:e.type)&&0==(null==e?void 0:e.expanded)&&(this.props.updateRowGroupsCollapsedCount(this.props.rowGroupsCollapsedCount+1),t.searchActive&&t.filterExpandedRows(e.rowIndex))},t.prototype.onGridReady=function(e){var n;t.gridApi=e.api,t.columnApi=e.columnApi,null===(n=document.querySelector(".ag-root"))||void 0===n||n.setAttribute("aria-label",this.props.displayCollectionName),this.updateTotalRowGroupsCount(),f.D.componentEnd(t.componentName),f.D.loadEnd()},t.prototype.onRowDataUpdated=function(e){this.updateTotalRowGroupsCount(),""!=t.elementToFocus&&setTimeout((function(){var e;null===(e=document.querySelector("."+t.elementToFocus))||void 0===e||e.focus(),t.elementToFocus=""}),100)},t.prototype.updateTotalRowGroupsCount=function(){var e=t.getCurrentRowGroupsCount();null!=e&&this.props.totalRowGroupsCount!=e&&this.props.updateTotalRowGroupsCount(e)},t.prototype.onRowDoubleClicked=function(e){var t,n=null===(t=e.data)||void 0===t?void 0:t.key;n&&n!==p.gT.loadMoreRowKey&&n!==p.gT.aggregateRowKey&&(f.D.reportUserAction("onRowDoubleClicked","entityGrid","Double clicked on row",{},"Open entity",""),f.D.scenarioStart(p.BG.openInContextView),this.props.openEntity(n,this.props.entityType))},t.prototype.addRowForLoadMoreButton=function(){var e={};e.key=p.gT.loadMoreRowKey,e[p.gT.loadMoreRowKey]=p.gm.Button,t.rows.push(e)},t.prototype.onRowSelectionChanged=function(e){var t=e.api.getSelectedRows().map((function(e){return e.key}));t&&(f.D.reportUserAction("onRowSelectionChanged","entityGrid","Row selection changed. Selected "+t.length+" rows",{numberOfRowsSelected:t.length},"Row selection",""),this.props.onRowSelectionChanged(t),this.props.updateSelectedRecordsCount(t.length))},t.prototype.onDragStopped=function(e){var n,i=this;if("ag-react-container"==(null===(n=null==e?void 0:e.target)||void 0===n?void 0:n.className)){f.D.reportUserAction("onDragStopped","entityGrid","Column dragged",{},"Column dragged","");var r=t.getAllGridColumns(),o={};null==r||r.map((function(e,t){o[e.getColId()]=i.props.columnsStatus[e.getColId()],o[e.getColId()].index=t}));var a=t.getFirstColumn();a!=this.props.firstColumn&&(f.D.reportUserAction("onDragStopped","entityGrid","Column dragged to first column. Column: "+a,{updatedFirstColumn:a},"Column dragged to first position",""),e.api.refreshCells({columns:[a,this.props.firstColumn],force:!0}),this.props.updateFirstColumn(a)),this.props.updateColumnsStatus(o)}},t.prototype.getRows=function(e){var t=this,n=[],i=h.Z.getRowLoadHandler();return h.Z.getWebresourceLoaderState()!=g.ScriptLoadingStatus.Idle&&h.Z.getWebresourceLoaderState()!=g.ScriptLoadingStatus.Loading||this.checkWebresourceStateAndRefreshGrid(),this.props.dataset.forEach((function(r){var o={};o.key=r.recordId,i&&i(t.props.getExecutionContext(r)),e.forEach((function(e){if(e.field){var t=e.field;o[t]=r.formattedValues.get(e.field)}})),n.push(o)})),n},t.prototype.checkWebresourceStateAndRefreshGrid=function(){var e=this;setTimeout((function(){var t=h.Z.getWebresourceLoaderState();t==g.ScriptLoadingStatus.Loaded?(f.D.reportInfo("checkWebresourceStateAndRefreshGrid","entityGrid","Script is Loaded.",{}),e.setState({isScriptLoaded:!0})):t!=g.ScriptLoadingStatus.Loading&&t!=g.ScriptLoadingStatus.Idle||(f.D.reportInfo("checkWebresourceStateAndRefreshGrid","entityGrid","Script is still in Loading or Idle state. Re-checking state in 500ms",{}),e.checkWebresourceStateAndRefreshGrid())}),500)},t.moveColumn=function(e,t){var n,i;null===(i=null===(n=this.columnApi)||void 0===n?void 0:n.moveColumn)||void 0===i||i.call(n,e,t)},t.refreshCells=function(e){var t,n;null===(n=null===(t=this.gridApi)||void 0===t?void 0:t.refreshCells)||void 0===n||n.call(t,e)},t.getAllDisplayedColumns=function(){var e;return null===(e=this.columnApi)||void 0===e?void 0:e.getAllDisplayedColumns().slice(1)},t.getAllGridColumns=function(){var e;return null===(e=this.columnApi)||void 0===e?void 0:e.getAllGridColumns().slice(1)},t.getFirstColumn=function(){var e,t;return null===(t=null===(e=this.columnApi)||void 0===e?void 0:e.getAllDisplayedColumns())||void 0===t?void 0:t[1].getColId()},t.setColumnVisible=function(e,t){var n;null===(n=this.columnApi)||void 0===n||n.setColumnVisible(e,t)},t.setColumnsVisible=function(e,t){var n;null===(n=this.columnApi)||void 0===n||n.setColumnsVisible(e,t)},t.getRowNode=function(e){var t;return null===(t=this.gridApi)||void 0===t?void 0:t.getRowNode(e)},t.showLoadingOverlay=function(){var e,t;null===(t=null===(e=this.gridApi)||void 0===e?void 0:e.showLoadingOverlay)||void 0===t||t.call(e)},t.setPinnedBottomRowData=function(e){var t;null===(t=this.gridApi)||void 0===t||t.setPinnedBottomRowData(e)},t.isBottomRowPinned=function(){return this.gridApi&&this.gridApi.getPinnedBottomRowCount()>0},t.expandAll=function(){var e;return null===(e=this.gridApi)||void 0===e?void 0:e.expandAll()},t.collapseAll=function(){var e;return null===(e=this.gridApi)||void 0===e?void 0:e.collapseAll()},t.getCurrentRowGroupsCount=function(){var e,t,n=0,i=null===(t=null===(e=this.gridApi)||void 0===e?void 0:e.getModel)||void 0===t?void 0:t.call(e);return i?(null==i||i.forEachNode((function(e){(null==e?void 0:e.group)&&n++})),n):null},t.isSearchTextEntered=function(){return""!=t.searchTextEntered},t.shouldDisplayShowAllButton=function(){var e;return(null===(e=this.gridApi)||void 0===e?void 0:e.getDisplayedRowCount())!=t.rows.length&&t.isSearchTextEntered()},t.search=function(e){var n;t.searchTextEntered=e,null===(n=this.gridApi)||void 0===n||n.setQuickFilter(e),this.handleSearchScenarios(e)},t.handleSearchScenarios=function(e){var n,i,r,o,a,s=this;t.searchActive||this.getExpandedRowGroups();var l={key:p.gT.loadMoreRowKey},c=null===(n=this.gridApi)||void 0===n?void 0:n.getRowNode(p.gT.loadMoreRowKey),d=null===(i=this.gridApi)||void 0===i?void 0:i.getDisplayedRowCount();this.showAggregateRowIfNotPresent(d),""!=e&&(d>1&&c||d>0&&!c)?this.handleTextSearched(d,l,c):c&&1==d?null===(r=this.gridApi)||void 0===r||r.applyTransactionAsync({remove:[l]},(function(){var e,t;null===(e=s.gridApi)||void 0===e||e.showNoRowsOverlay(),null===(t=s.gridApi)||void 0===t||t.setPinnedBottomRowData([])})):""==e&&d>0&&this.handleTextCleared(d,l,c),(c=null===(o=this.gridApi)||void 0===o?void 0:o.getRowNode(p.gT.loadMoreRowKey))&&(null===(a=this.gridApi)||void 0===a||a.redrawRows({rowNodes:[c]}))},t.showAggregateRowIfNotPresent=function(e){var n,i;t.aggregateRowData!={}&&e>0&&0==(null===(n=this.gridApi)||void 0===n?void 0:n.getPinnedBottomRowCount())&&(null===(i=this.gridApi)||void 0===i||i.setPinnedBottomRowData([t.aggregateRowData]))},t.handleTextSearched=function(e,n,i){var r,o,a;null===(r=this.gridApi)||void 0===r||r.hideOverlay(),i||0==e||e==t.rows.length?e>t.rows.length&&(null===(a=this.gridApi)||void 0===a||a.applyTransaction({remove:[n]})):null===(o=this.gridApi)||void 0===o||o.applyTransaction({add:[n]})},t.handleTextCleared=function(e,n,i){var r,o,a,s,l;null===(r=this.gridApi)||void 0===r||r.hideOverlay(),this.showAggregateRowIfNotPresent(e),m.f.grid.paging.hasNextPage&&!i&&(null===(o=this.gridApi)||void 0===o||o.applyTransaction({add:[n]})),!m.f.grid.paging.hasNextPage&&i&&(null===(a=this.gridApi)||void 0===a||a.applyTransaction({remove:[n]}));var c=null===(l=null===(s=this.gridApi)||void 0===s?void 0:s.getModel)||void 0===l?void 0:l.call(s);t.collapseAll(),t.searchActive=!1,t.expandedRowGroups.forEach((function(e){var t,n;(null==c?void 0:c.isRowPresent(e))?null===(t=c.getRow(e.rowIndex))||void 0===t||t.setExpanded(!0):null===(n=null==c?void 0:c.getRow(e.rowIndex))||void 0===n||n.setExpanded(!1)}))},t.getVisibleRowCount=function(){var e,t,n=null===(e=this.gridApi)||void 0===e?void 0:e.getRowNode(p.gT.loadMoreRowKey),i=null===(t=this.gridApi)||void 0===t?void 0:t.getDisplayedRowCount();return n&&i>0?i-1:i},t.getExpandedRowGroups=function(){var e,n;if(t.searchActive)return null;var i=null===(n=null===(e=this.gridApi)||void 0===e?void 0:e.getModel)||void 0===n?void 0:n.call(e);if(!i)return null;t.expandedRowGroups=[],null==i||i.forEachNode((function(e){(null==e?void 0:e.group)&&e.expanded&&t.expandedRowGroups.push(e)})),t.expandAll(),t.searchActive=!0},t.filterExpandedRows=function(e){t.expandedRowGroups=t.expandedRowGroups.filter((function(t){return t.rowIndex!=e}))},t.componentName="grid",t.rows=[],t.firstColWidthParams={minWidth:264,defaultWidth:288},t.otherColWidthParams={minWidth:88,defaultWidth:180},t.searchTextEntered="",t.aggregateRowData={},t.elementToFocus="",t.expandedRowGroups=[],t.searchActive=!1,t}(o().Component)},48122:function(e,t,n){"use strict";n.d(t,{r:function(){return l}});var i=n(48945),r=n(59731),o=n(73186),a=n(12684),s=n(47482),l=function(){function e(){}return e.onColumnHideOrShow=function(t,n,o,l,c,d,u,p,m){var h,g,f,y,v;if(i.D.reportUserAction("EntityGridHelper.onColumnHideOrShow",t,l?"Column "+o+" hidden.":"Column "+o+" shown.",{columnHidden:l?o:"",columnShown:l?"":o},"Column hidden/shown",o),n){var C=l&&c===o,S=null!==(g=null===(h=a.O.getAllDisplayedColumns)||void 0===h?void 0:h.call(a.O))&&void 0!==g?g:[];if(C)a.O.elementToFocus=s.ZH.getCustomHeaderClassName(null===(f=null==S?void 0:S[1])||void 0===f?void 0:f.getColId());else{var E=S.findIndex((function(e){return e.getColId()==o}));E>0&&(a.O.elementToFocus=s.ZH.getCustomHeaderClassName(null===(y=null==S?void 0:S[E-1])||void 0===y?void 0:y.getColId()))}if(1===S.length&&l)i.D.reportInfo("EntityGridHelper.onColumnHideOrShow",t,"Cannot hide column as there is only one column visible",{column:o});else{a.O.setColumnVisible(o,!l);var b=null!==(v=a.O.getFirstColumn())&&void 0!==v?v:"",w=!l&&b===o,D=d&&d[o];D.isHidden=l,(C||w)&&(i.D.reportInfo("EntityGridHelper.onColumnHideOrShow",t,"First column hidden",{column:o}),e.updateFirstColumn(c,b,u)),l&&null!=m&&m!=r.Sr.none&&(i.D.reportInfo("EntityGridHelper.onColumnHideOrShow",t,"Sorted column hidden",{column:o}),e.sortOnColumnHideOrShow(b,d)),l&&(null==D?void 0:D.rowGroup)&&(D.rowGroup=!1,D.rowGroupIndex=void 0),p(D)}}else i.D.reportInfo("EntityGridHelper.onColumnHideOrShow",t,"Cannot hide column as column has an error",{column:o})},e.updateFirstColumn=function(e,t,n){a.O.refreshCells({columns:[t,e],force:!0}),n(t)},e.sortOnColumnHideOrShow=function(e,t){if(t[e].isSortingAllowed){var n={name:t[e].fieldName,sortDirection:r.Sr.asc};a.O.showLoadingOverlay(),o.f.sortColumn([n])}},e.onColumnGroup=function(e,t,n,r,o,a){void 0===a&&(a=!1),i.D.reportUserAction("onColumnGroup",e,"Group by this field",{columnGroupedBy:t},"Group by this field",t);var s=Object.assign({},n);if(1!=a)if(s[t].rowGroup){var l=s&&s[t];l.rowGroup=!1,l.rowGroupIndex=void 0,r(l)}else{var c;(c=Object.values(s).find((function(e){return 1==e.rowGroup})))&&(s[c.fieldName].rowGroup=!1,s[c.fieldName].rowGroupIndex=void 0),s[t].rowGroup=!0,s[t].rowGroupIndex=0,o(s)}else(c=Object.values(s).find((function(e){return 1==e.rowGroup})))&&(c.rowGroup=!1,c.rowGroupIndex=void 0,r(c))},e.getColumnDisplayName=function(e,t,n){return t+"."+e+" ("+n+")"},e}()},91140:function(e,t,n){"use strict";n.d(t,{S:function(){return f}});var i=n(49037),r=n(63804),o=n(51848),a=n(87018),s=n(48122),l=n(48945),c=n(12684),d=n(4432),u=n(97369),p=n(10176),m=n(28741),h=n(43532),g=n(59762),f=function(e){function t(t){var n=e.call(this,t)||this;return n.setState({showContextMenu:!1}),n}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this.props,t=e.isDataLoaded,n=e.displayCollectionName,o=e.entityDisplayName;return r.createElement(p.Shimmer,{styles:u.W.getGridOptionsShimmerStyles(),customElementsGroup:u.W.getCommandBarShimmer(),isDataLoaded:t&&!!n&&!!o},t&&n&&o&&r.createElement("div",{className:"recordsCount"},r.createElement(g.I,(0,i.pi)({},this.props,{displayCollectionName:n,entityDisplayName:o,isSearchActive:c.O.searchActive})),r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{display:"flex"}},this.getGroupByColumnMenu()),r.createElement("div",{style:{display:"flex"}},this.getEditColumnButton()),r.createElement("div",{style:{display:"flex"}},this.getSearchBar()))))},t.prototype.getGroupByColumnMenu=function(){var e=this,t="",n=Object.assign([]);n.push({key:"none",text:l.D.getLocalizedString("WS_Grid_GroupColumns_None"),canCheck:!0,checked:0==this.props.totalRowGroupsCount}),n.push({key:"divider_groupByColumnNone",itemType:o.ContextualMenuItemType.Divider}),Object.values(this.props.columnsStatus).sort((function(e,t){return e.index-t.index})).map((function(e){0==e.isHidden&&(n.push({key:e.fieldName,text:e.displayName,canCheck:!0,checked:e.rowGroup}),e.rowGroup&&(t=e.displayName))}));var i={items:n,className:"groupByColumnsMenu",target:"groupByColumnsButton",calloutProps:{className:"editGroupColumnsButtonCallout"},directionalHint:o.DirectionalHint.bottomRightEdge,directionalHintFixed:!1,shouldFocusOnMount:!0,onItemClick:function(t,n){0==(null==n?void 0:n.checked)&&s.r.onColumnGroup("gridOptionsCommandBar",(null==n?void 0:n.key)||"",e.props.columnsStatus,e.props.updateColumnStatus,e.props.updateColumnsStatus,"none"==(null==n?void 0:n.key))}};return r.createElement("div",null,r.createElement(a.DefaultButton,{id:"groupByColumnsButton",className:"editGroupColumnsButton groupColumnsButton",onRenderText:function(){return""==t?r.createElement("div",null,r.createElement("span",{className:"groupByColumnsButtonPrimaryText"},l.D.getLocalizedString("WS_Grid_GroupColumns_Group_By"))):r.createElement("div",null,r.createElement("span",{className:"groupByColumnsButtonPrimaryText"},l.D.getLocalizedString("WS_Grid_GroupColumns_Grouped_By")),r.createElement("span",{className:"groupByColumnsButtonSecondaryText"},t))},menuProps:i,iconProps:{iconName:"GroupList",style:{color:d.I.digitalBlue}},menuIconProps:{style:{display:"none"}}}))},t.prototype.getEditColumnButton=function(){var e=this;return l.D.reportUserAction("getEditColumnButton","GridoptionCommandBar","User click on Edit Column button",{},"User click on Edit Column button",""),r.createElement("div",null,r.createElement(a.DefaultButton,{className:"editGroupColumnsButton",onClick:function(){e.props.setEntityGridPanelIsOpen({isEditColumnPanelOpen:!0,insertColumnDirection:"",insertColumnIndex:-1})},onRenderText:function(){return r.createElement("div",null,r.createElement("span",{className:"groupByColumnsButtonPrimaryText"},l.D.getLocalizedString(m.gT.dropdownEditColumnsText)))},iconProps:{iconName:"TripleColumnEdit",style:{color:d.I.digitalBlue}}}))},t.prototype.getSearchBar=function(){return r.createElement("div",{className:"gridSearchboxDiv"},r.createElement(h.SearchBox,{className:m.gT.gridSearchboxClassName,underlined:!0,styles:{root:{borderWidth:"0px 0px 0px","&:hover":{borderBottom:"1px solid #323130"}}},disableAnimation:!0,ariaLabel:l.D.getLocalizedString(m.gT.gridSearchText),placeholder:l.D.getLocalizedString(m.gT.gridSearchText),iconProps:{style:{color:d.I.digitalBlue}},onChange:this.onSearchBoxChange.bind(this)}))},t.prototype.onSearchBoxChange=function(e,t){c.O.search(t||""),this.props.updateSearchedRecordCount(c.O.getVisibleRowCount())},t}(r.Component)},95296:function(e,t,n){"use strict";n.d(t,{X:function(){return u}});var i=n(49037),r=n(28741),o=n(63804),a=n(73186),s=n(67440),l=n(48945),c=n(4432),d=n(12684),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return this.props.data[this.props.column]==r.gm.Spinner?this.getSpinner():this.getLoadMoreButton()},t.prototype.getSpinner=function(){return o.createElement("div",{style:{display:"flex",alignItems:"center",height:"100%",color:c.I.digitalBlue}},o.createElement("div",{className:"grid-loader-spinner"}),o.createElement("div",{style:{marginLeft:"12px"}},l.D.getLocalizedString("WS_Grid_Show_More_Rows_Loading")))},t.prototype.getLoadMoreButton=function(){return o.createElement(s.ActionButton,{className:"showMoreButton",onClick:this.loadMoreButtonHandler.bind(this),text:d.O.shouldDisplayShowAllButton()?l.D.getLocalizedString("WS_Grid_Show_All"):l.D.getLocalizedString("WS_Grid_Show_More_Rows")})},t.prototype.loadMoreButtonHandler=function(){var e,t;if(l.D.reportUserAction("loadMoreButtonHandler","showMoreRowsRenderer","Show more rows button clicked.",{},"Show more rows button clicked.",""),d.O.shouldDisplayShowAllButton())null===(t=null===(e=document.querySelector("."+r.gT.gridSearchboxClassName+" button"))||void 0===e?void 0:e.click)||void 0===t||t.call(e);else{a.f.loadMoreRows();var n=this.props.node;n.data[this.props.column]=r.gm.Spinner,n&&this.props.api.redrawRows({rowNodes:[n]})}},t}(o.Component)},92660:function(e,t,n){"use strict";n.d(t,{X:function(){return s}});var i=n(49037),r=n(48945),o=n(67440),a=n(63804),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.D.reportInfo("render","webResourceFieldControl","Render method",{field:this.props.element.colId}),this.props.showQuickActions?a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},this.getControl(),this.getQuickActionsControl()):this.getControl()},t.prototype.getControl=function(){var e=this;return this.state&&this.state.webResourceResponse?a.createElement("div",{className:this.props.showQuickActions?"webResourceFieldDiv webResourceFieldDivFirstColumn":"webResourceFieldDiv"},a.createElement("img",{style:{marginRight:"10px"},src:this.state.webResourceResponse.Url,alt:this.state.webResourceResponse.Tooltip}),a.createElement("label",null,this.state.webResourceResponse.Tooltip)):(this.props.getCellImageInfo&&this.props.getCellImageInfo(this.props.element.colId,this.props.element.rowId,this.props.locale).then((function(t){e.setState({webResourceResponse:t})})).catch((function(e){console.log(e)})),this.props.defaultElement)},t.prototype.getQuickActionsControl=function(){var e=this;return a.createElement("div",null,a.createElement(o.IconButton,{iconProps:{iconName:"MiniExpand"},className:"quickActionsIcon",title:r.D.getLocalizedString("WS_View_Record_Page"),ariaLabel:r.D.getLocalizedString("WS_View_Record_Page"),onClick:function(){var t,n;null===(n=(t=e.props).openEntity)||void 0===n||n.call(t,e.props.element.rowId)}}))},t}(a.Component)},90425:function(e,t,n){"use strict";n.d(t,{oj:function(){return o},Tp:function(){return a},oP:function(){return s},D2:function(){return l},MW:function(){return c}});var i=n(19608),r=n(54988),o=(0,i.mergeStyles)({background:"transparent",paddingTop:8,paddingBottom:8}),a=(0,i.mergeStyles)({fontWeight:i.FontWeights.semibold}),s={root:{minWidth:425,marginTop:"1rem",marginBottom:"1rem"}},l=16,c={divider:{minHeight:24,backgroundColor:r.iX.gray50}}},10642:function(e,t,n){"use strict";n.d(t,{f:function(){return C}});var i=n(49037),r=n(63804),o=n.n(r),a=n(87018),s=n(36711),l=n(27896),c=n(34251),d=n(48945),u=n(1672),p=n(23517),m=n(62798),h=n(90425),g=n(86977),f=n(72052),y=n(79754),v="FilterBar",C=function(e){var t=e.dashletList,n=(e.entityCollectionName,e.entityType),r=e.onViewSelected,C=e.selectedView,S=e.setDashletList,E=e.setDashletHasChanges,b=e.setFilterPanelIsOpen,w=e.layoutType,D=e.setLayoutType,T=e.viewFilterList,x=e.viewHasChanges,k=e.setViewHasChanges,_=(0,l.k)(!1),N=_[0],L=_[1],I=L.setTrue,A=L.setFalse,R=(0,c.o)(e.filterExpression),F={iconProps:{iconName:0===R?"Filter":"FilterSolid"},className:h.oj,onRenderText:function(){return o().createElement("span",null,d.D.getLocalizedString("WS_FilterBar_Filters_Button"),o().createElement("span",{className:h.Tp},0===R?"":" ("+R+")"))},onClick:function(){d.D.reportUserAction("filterOnButtonClick",v,"Open the filter panel",{numberOfFiltersActiveWhenClicked:R},"Open the filter panel",""),null==b||b(!0)}},P=!!n&&Object.values(d.D.getFeatureSupport(n)).some((function(e){return e}));return o().createElement(o().Fragment,null,o().createElement(s.Stack,{horizontal:!0,tokens:{childrenGap:h.D2},horizontalAlign:"end",verticalAlign:"center",styles:h.oP},r&&T&&o().createElement(p.n,{onViewSelected:r,viewList:T,selectedView:C,viewHasChanges:x,setViewHasChanges:k,isSaveUpdateFeatureEnabled:void 0!==window.Xrm&&Boolean(Xrm.Internal.isFeatureEnabled("SaveUpdateView"))}),o().createElement(s.Stack.Item,{grow:!0},o().createElement(y.M,{telemetrySourse:v})),P&&w&&D&&n&&o().createElement(m.V,{layoutType:w,setLayoutType:D,onEditStatsClick:I,entityType:n}),b&&o().createElement(a.CommandBarButton,(0,i.pi)({},F)),o().createElement(g.p,{styles:h.MW}),o().createElement(f.s,{surveySource:"workspace"})),t&&S&&o().createElement(u.lw,{isOpen:N,onDismiss:A,dashletList:t,setDashletList:S,setDashletHasChanges:E,defaultPanelType:u.F5}))}},45401:function(e,t,n){"use strict";n.d(t,{p:function(){return g}});var i,r=n(49037),o=n(63804),a=n.n(o),s=n(10642),l=n(54106),c=n(97369),d=n(35531),u=n(47482);!function(e){e.SAVEDVIEW="savedview",e.USERVIEW="userview"}(i||(i={}));var p=function(e,t,n){return'/api/data/v9.0/GetClientMetadata(ClientMetadataQuery=@ClientMetadataQuery)?@ClientMetadataQuery={"MetadataType":"'+n+'","MetadataSubtype":"MAIN_APPLICATION_VIEW",\n    "EntityLogicalName":"'+e+'","GetDefault":false,"DependencyDepth":"OnDemandWithContext","ChangedAfter":"2363621","AppId":"'+t+'"}&api-version=9.1'},m=function(e,t){for(var n="?$filter="+e+" eq "+t[0].ViewId,i=1;i<t.length;i++)n+=" or "+e+" eq "+t[i].ViewId;return n},h=function(e){var t=JSON.parse(e);return t.ViewSelectors&&t.ViewSelectors.length>0?t.ViewSelectors[0].SelectorItems:[]},g=function(e){var t=e.pcfContextWebApi,n=e.entityType,o=(0,r._T)(e,["pcfContextWebApi","entityType"]),g=a().useState(null),f=g[0],y=g[1],v=t.retrieveMultipleRecords;return a().useEffect((function(){(0,r.mG)(void 0,void 0,void 0,(function(){var e,t,o,a,s,c,d,g,f,C,S,E,b,w,D,T;return(0,r.Jh)(this,(function(x){switch(x.label){case 0:return e=function(e,t){return e.isdefault!==t.isdefault?e.isdefault?-1:1:e.name.localeCompare(t.name)},t=n||"opportunity",[4,Xrm.Utility.getGlobalContext().getCurrentAppProperties()];case 1:return o=x.sent(),[4,fetch(p(t,o.appId,i.USERVIEW))];case 2:return a=x.sent(),[4,fetch(p(t,o.appId,i.SAVEDVIEW))];case 3:return s=x.sent(),c=[],a?[4,a.json()]:[3,5];case 4:(g=x.sent()).Metadata&&(c=h(g.Metadata)),x.label=5;case 5:return d=[],s?[4,s.json()]:[3,7];case 6:(g=x.sent()).Metadata&&(d=h(g.Metadata)),x.label=7;case 7:return f=[],C=[],c.length>0?(S=m("userqueryid",c),[4,v("userquery",S)]):[3,9];case 8:E=x.sent(),f=E.entities.sort(e),x.label=9;case 9:return d.length>0?(b=m("savedqueryid",d),[4,v("savedquery",b)]):[3,11];case 10:w=x.sent(),C=w.entities.sort(e),x.label=11;case 11:return D=f.concat(C),T=D.map((function(e){var t,n,i=e.fetchxml,o=i&&(new DOMParser).parseFromString(i,"text/xml"),a=i?(0,l.QR)(i):null,s="savedqueryid"in e,c=e[s?"savedqueryid":"userqueryid"],d=[],p=JSON.parse(e.layoutjson),m=null===(n=null===(t=null==p?void 0:p.Rows)||void 0===t?void 0:t[0])||void 0===n?void 0:n.Cells,h=[];return m&&(d=m.map((function(e){var t,n,i,o,a;return(0,r.pi)((0,r.pi)({},(0,u.xM)(null!==(t=e.Name)&&void 0!==t?t:"")),{hidden:null!==(n=e.IsHidden)&&void 0!==n?n:void 0,width:null!==(i=e.Width)&&void 0!==i?i:void 0,imageProviderWebresource:null!==(o=e.ImageProviderWebresource)&&void 0!==o?o:void 0,imageProviderFunctionName:null!==(a=e.ImageProviderFunctionName)&&void 0!==a?a:void 0})}))),o&&o.querySelectorAll("order").forEach((function(e){var t=e.getAttribute("attribute");if(t){var n="true"===e.getAttribute("descending")?"desc":"asc",i=d.find((function(e){return e.name===t}));if(h.push({name:t,sort:n}),i)i.sort=n;else{var r=function(e){var t,n;if("link-entity"===(null===(t=e.parentElement)||void 0===t?void 0:t.localName))return null!==(n=e.parentElement.getAttribute("alias"))&&void 0!==n?n:void 0}(e);d.push({name:t,fullyQualifiedName:r?r+"."+t:t,hidden:!0,sort:n,linkEntityAlias:r})}}else console.error("fetchxml order node has no attribute - view id: "+c)})),{id:c,name:e.name,kind:s?"system":"personal",columnSortingOrder:h,fetchXml:i,fetchExpression:a,columns:d}})),y(T),[2]}}))}))}),[n,v]),a().createElement(d.Shimmer,{styles:c.W.getFilterBarShimmerStyles(),customElementsGroup:c.W.getCommandBarShimmer(),isDataLoaded:!!f},f&&a().createElement(s.f,(0,r.pi)({viewFilterList:f,entityType:n},o)))}},64522:function(e,t,n){"use strict";n.d(t,{Sz:function(){return a},Zi:function(){return s},_T:function(){return l},Lh:function(){return c},hK:function(){return d},Zc:function(){return u},tt:function(){return p},LA:function(){return m}});var i,r=n(19608),o=n(54988),a=(0,r.mergeStyles)({paddingLeft:24,paddingRight:24}),s=(0,r.mergeStyles)({fontSize:r.FontSizes.size20,color:o.iX.gray160,fontWeight:r.FontWeights.semibold,lineHeight:28,paddingTop:20}),l=(0,r.mergeStyles)({fontSize:r.FontSizes.size12,lineHeight:16}),c={root:{paddingBottom:12}},d={root:{paddingTop:20}},u=(0,r.mergeStyles)({cursor:"pointer"}),p=(0,r.mergeStyles)(((i={width:75,height:24,fontSize:r.FontSizes.size12,color:o.iX.gray130,padding:"4px 8px 4px 6px",borderRadius:2,border:"1px solid "+o.iX.gray40,boxSizing:"border-box",pointerEvents:"none",background:"transparent"})["& .ms-Button-flexContainer"]={flexDirection:"row-reverse"},i)),m={root:{fontSize:14,width:12,height:14,color:o.iX.gray130}}},79754:function(e,t,n){"use strict";n.d(t,{M:function(){return m}});var i=n(63804),r=n.n(i),o=n(87018),a=n(42093),s=n(75821),l=n(53205),c=n(99506),d=n(47095),u=n(48945),p=n(64522),m=function(e){return r().createElement(a.TooltipHost,{content:(t=e.telemetrySourse,r().createElement("p",{className:p.Sz},r().createElement(c.Label,null),r().createElement(l.Text,{className:p.Zi},u.D.getLocalizedString("WS_FilterBar_Preview_Tooltip_Title")),r().createElement(c.Label,{styles:p.Lh}),r().createElement("p",{className:p._T},r().createElement(l.Text,null,u.D.getLocalizedString("WS_FilterBar_Preview_Tooltip_Content_Part_1")),r().createElement(c.Label,{styles:p.Lh}),r().createElement(l.Text,null,u.D.getLocalizedString("WS_FilterBar_Preview_Tooltip_Content_Part_2")),r().createElement(c.Label,{styles:p.Lh})),r().createElement(d.r,{onClick:function(){u.D.reportUserAction("previewToolTipContent",t,"Open tooltip link",{},"Open preview tooltip link","")},href:"https://go.microsoft.com/fwlink/?linkid=2166473",openInNewTab:!0,content:u.D.getLocalizedString("WS_FilterBar_Preview_Tooltip_Link")}),r().createElement(c.Label,{styles:p.hK}))),id:"previewTooltip",className:p.Zc,calloutProps:{directionalHint:s.DirectionalHint.bottomCenter,calloutMaxWidth:343,calloutMaxHeight:360,hideOverflow:!0}},r().createElement(o.CommandBarButton,{className:p.tt,text:u.D.getLocalizedString("WS_FilterBar_Preview_Button"),iconProps:{iconName:"Info",styles:p.LA}}));var t}},68703:function(e,t,n){"use strict";n.d(t,{nn:function(){return c},eV:function(){return d},k0:function(){return u},go:function(){return p}});var i,r,o=n(19608),a=n(17754).rQ.palette,s=a.neutralPrimary,l=a.neutralSecondary,c=(0,o.mergeStyles)({display:"flex",borderBottom:"solid 1px #eaeaea",padding:"6px 8px"}),d=(0,o.mergeStyles)({display:"flex",flexGrow:1}),u=(0,o.mergeStyles)(((i={FontFamily:"Segoe UI",fontSize:14,lineHeight:20,fontWeight:600,color:s,paddingLeft:8,alignSelf:"center"})["& .ms-Shimmer-dataWrapper"]={fontWeight:600},i)),p=(0,o.mergeStyles)(((r={color:l})["& :hover"]={color:l},r));(0,o.mergeStyles)({display:"flex"})},1080:function(e,t,n){"use strict";n.d(t,{w:function(){return S},W:function(){return w}});var i=n(49037),r=n(63804),o=n(59731),a=n(6401),s=n(84718),l=n(42093),c=n(17217),d=n(90347),u=n(48945),p=n(23089),m=n(84519),h=n(94577),g=n(52618),f=n(26747),y=n(68703),v=n(97369),C=n(35531),S={gapSpace:0},E="Navigation",b=!1,w=function(e){function t(t){var n,i,r=e.call(this,t)||this;return r.state={primaryView:{entity:r.props.primaryEntity,viewMode:o.wO.Default},secondaryViews:[],commands:[],viewTitle:""},null===(i=null===(n=r.props.inContextViewEventHandlers)||void 0===n?void 0:n.openSecondaryEntityHandler)||void 0===i||i.call(n,r.openEntityHandler.bind(r)),setTimeout(function(){b=!0}.bind(r),3e3),r}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t=this.state,n=t.primaryView,o=t.secondaryViews,l=o&&o[o.length-1],c=(0,i.pi)((0,i.pi)({},this.props),{entity:l?l.entity:n.entity,viewMode:l?l.viewMode:n.viewMode,relatedEntity:l&&l.relatedEntity,childViewProps:l&&l.childViewProps,viewEventHandlers:{onOpenView:this.openViewHandler.bind(this),openErrorView:this.openErrorView.bind(this),navigateBack:this.popView.bind(this),setViewTitle:this.setNavigationTitle.bind(this),registerCommands:this.registerCommand.bind(this),setErrorMessage:this.setErrorNotification.bind(this),clearErrorMessage:this.onDismissMessageBar.bind(this)}});u.D.reportInfo("render",E,"",{entityType:c.entity.entityType,entityId:c.entity.entityId,viewMode:c.viewMode,depth:this.state.secondaryViews.length+1});var d=a.P.getView(c),p="chat-view"===(null===(e=null==d?void 0:d.props)||void 0===e?void 0:e.className),m={display:p?"":"none"};return this.requestFocus(),r.createElement("aside",{className:"icv-view-container"},this.getNavigationTopBar(),r.createElement("div",{className:"icv-view-content"},!s.StringUtil.IsNullOrEmpty(this.state.errorViewMessage)&&this.getErrorView(c),!s.StringUtil.IsNullOrEmpty(this.state.errorNotification)&&this.errorMessageBar(),s.StringUtil.IsNullOrEmpty(this.state.errorViewMessage)&&d,r.createElement("div",{style:m,id:"embedded-chat-container"},(b||p)&&r.createElement(f.i,(0,i.pi)({},c)))))},t.prototype.getErrorView=function(e){return r.createElement(p.o,(0,i.pi)({},(0,i.pi)((0,i.pi)({},e),{message:this.state.errorViewMessage})))},t.prototype.getNavigationTopBar=function(){var e=this,t=this.state.secondaryViews;return r.createElement("div",{className:"icv-navigation-topbar "+y.nn},r.createElement("div",{className:"icv-navigation-topbar-title-container "+y.eV},t.length>0&&r.createElement(l.TooltipHost,{content:u.D.getLocalizedString("InContextView_Back"),calloutProps:S},r.createElement(h.IconButton,{id:"icv-navigation-topbar-back-icon",iconProps:c.P.backIcon,className:"icv-navigation-topbar-commands-icon "+y.go,ariaLabel:u.D.getLocalizedString("InContextView_Back"),onClick:function(){u.D.reportUserAction("getNavigationTopBar",E,"Back button clicked",{depth:e.state.secondaryViews.length+1},g.EJ.CLICK,"Navigation back button"),e.popView()}})),r.createElement("label",{className:"icv-navigation-topbar-title "+y.k0},r.createElement(C.Shimmer,{customElementsGroup:v.W.getTitleShimmer(),isDataLoaded:""!=this.state.viewTitle},this.state.viewTitle))),r.createElement("div",{className:"icv-navigation-topbar-commands-container"},this.state.commands.map((function(e){return a.P.getNavigationCommand(e,a.D.Header)})),r.createElement(l.TooltipHost,{content:u.D.getLocalizedString("InContextView_CloseAll"),calloutProps:S},r.createElement(h.IconButton,{id:"icv-navigation-topbar-closeall-icon",iconProps:c.P.closeIcon,ariaLabel:u.D.getLocalizedString("InContextView_CloseAll"),className:"icv-navigation-topbar-commands-icon "+y.go,onClick:function(){var t=e.state.secondaryViews.length>0?e.state.secondaryViews[e.state.secondaryViews.length-1]:e.state.primaryView;u.D.reportUserAction("getNavigationTopBar",E,"Close panel clicked",{currentViewId:t.entity.entityId,currentViewType:t.entity.entityType,currentViewMode:t.viewMode,depth:e.state.secondaryViews.length+1},g.EJ.CLICK,"Navigation close panel"),e.resetSecondaryViews(),e.props.inContextViewEventHandlers&&e.props.inContextViewEventHandlers.onClose&&e.props.inContextViewEventHandlers.onClose()}}))))},t.prototype.setNavigationTitle=function(e){this.setState({viewTitle:e})},t.prototype.registerCommand=function(e){this.setState({commands:e})},t.prototype.requestFocus=function(){var e=this,t=this.state,n=t.primaryView,r=t.secondaryViews,o=r&&r[r.length-1]||n;o&&o.requestFocusId&&(setTimeout((function(){var e=document.getElementById(o.requestFocusId);e&&e.focus()}),500),0==r.length?this.setState((function(t){return(0,i.pi)((0,i.pi)({},t),{primaryView:(0,i.pi)((0,i.pi)({},e.state.primaryView),{requestFocusId:void 0})})})):this.setState((function(e){var t=e.secondaryViews.slice(0,e.secondaryViews.length-1);return t.push((0,i.pi)((0,i.pi)({},e.secondaryViews[e.secondaryViews.length-1]),{requestFocusId:void 0})),{secondaryViews:t,viewTitle:"",commands:[]}})))},t.prototype.openEntityHandler=function(e){this.openViewHandler(e,o.wO.Default)},t.prototype.openErrorView=function(e){this.setState({errorViewMessage:e})},t.prototype.openViewHandler=function(e,t,n,i,r){var o={entity:e,viewMode:t,relatedEntity:n,childViewProps:i};this.props.inContextViewEventHandlers&&this.props.inContextViewEventHandlers.onOpenView&&this.props.inContextViewEventHandlers.onOpenView(o),this.pushView(o,r)},t.prototype.pushView=function(e,t){var n=this,r=this.state,o=r.primaryView,a=r.secondaryViews;this.matchEntities(0===a.length?o.entity:a[a.length-1].entity,e.entity)&&e.viewMode===(0===a.length?o.viewMode:a[a.length-1].viewMode)?u.D.reportWarning("pushView",E,"Duplicate view called",{type:e.entity.entityType,id:e.entity.entityId,mode:e.viewMode}):(0==a.length&&this.setState((function(e){return(0,i.pi)((0,i.pi)({},e),{primaryView:(0,i.pi)((0,i.pi)({},n.state.primaryView),{requestFocusId:t})})})),this.setState((function(n){if(n.secondaryViews.length>0){var r=n.secondaryViews.slice(0,n.secondaryViews.length-1);return r.push((0,i.pi)((0,i.pi)({},n.secondaryViews[n.secondaryViews.length-1]),{requestFocusId:t})),r.push(e),{secondaryViews:r,viewTitle:"",commands:[]}}var o=n.secondaryViews.slice();return o.push(e),{secondaryViews:o,viewTitle:"",commands:[]}})))},t.prototype.matchEntities=function(e,t){return!s.StringUtil.IsNullOrUndefined(e.entityId)&&e.entityId===t.entityId&&e.entityType===t.entityType},t.prototype.popView=function(){var e=this;this.setState((function(t){return{secondaryViews:t.secondaryViews.slice(0,e.state.secondaryViews.length-1),viewTitle:"",commands:[],errorViewMessage:""}}))},t.prototype.resetSecondaryViews=function(){this.setState((function(){return{secondaryViews:[]}}))},t.prototype.errorMessageBar=function(){return r.createElement(d.MessageBar,{messageBarType:m.MessageBarType.error,isMultiline:!0,onDismiss:this.onDismissMessageBar.bind(this),dismissButtonAriaLabel:u.D.getLocalizedString("ICV_Close")},this.state.errorNotification)},t.prototype.setErrorNotification=function(e){this.setState({errorNotification:e})},t.prototype.onDismissMessageBar=function(){this.setState({errorNotification:void 0})},t}(r.Component)},55318:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(78195),r=function(){function e(){}return e.loadScripts=function(t,n){i.ScriptSandbox.initialize(t,e.WebResources_Iframe_ID,n)},e.hasClientEventHandlers=function(){return i.ScriptSandbox.hasClientEventHandlers(e.WebResources_Iframe_ID)},e.getSaveHandler=function(){return i.ScriptSandbox.getSaveHandler(e.WebResources_Iframe_ID)},e.getChangeHandler=function(){return i.ScriptSandbox.getChangeHandler(e.WebResources_Iframe_ID)},e.getRowLoadHandler=function(){return i.ScriptSandbox.getRowLoadHandler(e.WebResources_Iframe_ID)},e.getWebresourceLoaderState=function(){return i.ScriptSandbox.getWebresourceLoaderState(e.WebResources_Iframe_ID)},e.WebResources_Iframe_ID="Workspace_Webresource_Frame",e}()},85683:function(e,t,n){"use strict";n.d(t,{$:function(){return a},R:function(){return s}});var i=n(63804),r=n.n(i),o=n(30443),a=function(e){var t=r().useState(null!=e?e:[]),n=t[0],i=t[1],o=r().useRef(new Set(n));return[n,r().useCallback((function(e){return o.current.add(e)&&i(Array.from(o.current))}),[]),r().useCallback((function(e){return o.current.delete(e)&&i(Array.from(o.current))}),[])]};function s(e,t){var n=r().useState(o.C.get(e,t)),i=n[0],a=n[1];return[i,r().useCallback((function(t){void 0===t?o.C.removeStorage(e):(o.C.set(e,t),a(t))}),[e])]}},11849:function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var i=n(63804),r=function(e,t){var n=(0,i.useRef)(!1);(0,i.useEffect)((function(){n.current?e():n.current=!0}),t)}},796:function(e,t,n){"use strict";n.d(t,{C:function(){return l}});var i=n(49037),r=n(63804),o=n(76601),a=n(48945),s=n(4476),l=function(e,t){var n=(0,r.useState)(void 0),l=n[0],c=n[1],d=(0,r.useState)([]),u=d[0],p=d[1],m=(0,r.useMemo)((function(){return s._.getDataverseAccess()}),[s._.getDataverseAccess]),h=(0,r.useState)([]),g=h[0],f=h[1];return(0,r.useEffect)((function(){m.cdsResolver.getLocalizedLabels().then((function(e){c(e),p((0,o.Mc)(e))})).catch((function(t){a.D.reportError("getLocalizedLabels",e,"Failed to retrieve the localized labels for the CDS expression builder control",{error:t})}))}),[]),(0,r.useEffect)((function(){(0,i.mG)(void 0,void 0,Promise,(function(){var e;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,m.cdsResolver.resolveFields(t)];case 1:return e=n.sent(),f(e),[2]}}))}))}),[t,m]),{localizedLabels:l,dataTypesForFilters:u,filteringContext:m,fields:g}}},10348:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}});var i=n(63804),r=function(e,t){var n=(0,i.useRef)();(0,i.useEffect)((function(){n.current=e}),[e]),(0,i.useEffect)((function(){if(null!==t){var e=setInterval((function(){null!=n.current&&n.current()}),t);return function(){return clearInterval(e)}}}),[t])}},34251:function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var i=n(69041),r=n(63804),o=function(e){var t=(0,r.useState)(0),n=t[0],o=t[1];return(0,r.useEffect)((function(){var t=(0,i.nw)(e);o(t)}),[e]),n}},42694:function(e,t,n){"use strict";n.d(t,{Vz:function(){return o.EDataType}});var i=n(29086),r=n(28681),o=(n(55535),n(29758));n(72429),n(72964),n(12780),n(54106),(0,i.registerIcons)(r.D)},9777:function(e,t,n){"use strict";n.d(t,{z:function(){return g}});var i=n(49037),r=n(63804),o=n.n(r),a=n(87018),s=n(17217),l=n(36711),c=n(48909),d=n(54988),u=n(94589),p=d.iX.gray130,m={fontWeight:600,fontSize:u.TS.size16,color:d.iX.gray160},h={fontWeight:400,fontSize:u.TS.size14,color:d.iX.gray130},g=function(e){var t,n,d,u,g=e.title,f=e.titleStyle,y=e.subtitle,v=e.subtitleStyle,C=e.shouldPadLeft,S=(0,r.useState)(!1),E=S[0],b=S[1],w=null!==(t=null==f?void 0:f.fontSize)&&void 0!==t?t:m.fontSize,D=null!==(n=e.hoverColor)&&void 0!==n?n:p,T=null!==(d=e.iconTitleGap)&&void 0!==d?d:16,x=null!==(u=e.contentGap)&&void 0!==u?u:13,k=C?parseInt(String(w))+T+1:0;return o().createElement(l.Stack,null,o().createElement("div",{style:{paddingBottom:E?0:x}},o().createElement(a.ActionButton,{iconProps:{iconName:E?s.P.chevronRight.iconName:s.P.chevronDown.iconName},ariaLabel:g,styles:{root:{height:"auto",width:"100%",padding:0},icon:{fontSize:w,color:D,margin:0,paddingRight:T},label:(0,i.pi)({margin:0},f),iconHovered:{color:D},labelHovered:{color:D}},onClick:function(){return b((function(e){return!e}))}},g),y&&o().createElement(c.Text,{block:!0,style:(0,i.pi)((0,i.pi)({},null!=v?v:h),{paddingLeft:k})},y)),o().createElement("div",{style:{paddingLeft:k}}," ",!E&&e.children))}},98500:function(e,t,n){"use strict";n.d(t,{e:function(){return a}});var i=n(49037),r=n(48945),o=n(30443),a=function(){function e(){}return e.TriggerEventAndHandleSurvey=function(t,n,i,r){void 0===r&&(r={});var o={TeamName:t,EventName:n,SurveyName:i,CallType:"triggerandvalidateeligibility"},a=new Array;a.push({name:"SurveyName",value:i}),a.push({name:"TeamName",value:t}),a.push({name:"TriggeringEvent",value:n}),e.HandlePromise(e.HandleCESAction(o),r,a)},e.GetSystemUserInformation=function(e){return(0,i.mG)(this,void 0,Promise,(function(){var t,n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:t=window.location.origin,n=t+"/api/data/v9.0/systemusers?$filter=systemuserid eq "+e+"&$select=azureactivedirectoryobjectid",i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(n)];case 2:return[4,i.sent().json()];case 3:return[2,{result:i.sent().value[0].azureactivedirectoryobjectid}];case 4:return[2,{err:i.sent()}];case 5:return[2]}}))}))},e.HandleCESAction=function(e){var t=this.formsProId;return new Promise((function(n,i){var r=window.location.origin+"/api/data/v9.0/CustomerExperienceSurveysService",o=JSON.stringify(e),a=new XMLHttpRequest;a.onreadystatechange=function(){var e,r,o;if(4==this.readyState)if(200==this.status){var a=JSON.parse(this.responseText);if("True"==a.IsSuccess){var s=a.CESResult,l=JSON.parse(s);null!==(o=null===(r=null===(e=null===window||void 0===window?void 0:window.location)||void 0===e?void 0:e.href)||void 0===r?void 0:r.includes("forceSurveys"))&&void 0!==o&&o&&(l.Eligibility=!0,l.FormsProId=t),l.Eligibility&&null!=l.FormsProId&&n(l)}else n(null)}else i(this.status+": "+this.responseText)},a.open("POST",r,!0),a.setRequestHeader("Content-Type","application/json"),a.send(o)}))},e.HandlePromise=function(t,n,i){var r=this;t.then((function(t){if(t)try{var o=t.FormsProId,a=new window.top.SurveyEmbed(o,r.customerVoiceURL,r.customerVoiceAuthURl,"true");n.renderDimensions?a.renderPopup(e.GenerateFormContext(n,t.AADID),n.renderDimensions.width,n.renderDimensions.height):a.rederPopup(e.GenerateFormContext(n,t.AADID)),i.push({name:"Survey Rendered",value:!0}),i.push({name:"AADID",value:t.AADID}),i.push({name:"FormsProID",value:o}),Xrm.Reporting.reportSuccess(r.componentName,i)}catch(e){Xrm.Reporting.reportFailure(r.componentName,{name:"Failed to Render Survey",message:e.message},void 0,i)}})).catch((function(e){Xrm.Reporting.reportFailure(r.componentName,{name:"CESService Rejected",message:e},void 0,i)}))},e.HandleSendFeedbackClicked=function(t){var n,i;try{var r=this.formsProId;new window.top.SurveyEmbed(r,this.customerVoiceURL,this.customerVoiceAuthURl,"true").renderPopup(e.GenerateFormContext(t),null===(n=null==t?void 0:t.renderDimensions)||void 0===n?void 0:n.width,null===(i=null==t?void 0:t.renderDimensions)||void 0===i?void 0:i.height)}catch(e){Xrm.Reporting.reportFailure(this.componentName,{name:"Failed to Render Survey",message:e.message},void 0)}},e.GenerateFormContext=function(t,n){return(0,i.mG)(this,void 0,Promise,(function(){var a,s,l,c,d,u,p,m,h,g;return(0,i.Jh)(this,(function(f){switch(f.label){case 0:return a=t.context?t.context:Xrm.Utility.getGlobalContext(),s="",a&&a.client&&a.client.userAgent?(l=a.client.userAgent).isWin?s="Windows":l.isAndroidModern||l.isAndroid?s="Android":l.isIos&&(s="iOS"):(l=window.navigator.userAgent).indexOf("Win")>-1?s="Windows":l.indexOf("Android")>-1?s="Android":(l.indexOf("IPhone")>-1||l.indexOf("IPad")>-1)&&(s="iOS"),c="",d="",n?(c=n,[3,4]):[3,1];case 1:return""===(d=o.C.get("azureActiveDirectoryObjectId",""))?[3,2]:(c=d,[3,4]);case 2:return[4,e.GetSystemUserInformation(a.userSettings.userId)];case 3:(u=f.sent()).result?(c=u.result,o.C.set("azureActiveDirectoryObjectId",u.result)):r.D.reportError("getSystemUserInformation","CustomerExperienceSurveyUtils","Error occured in getting system user information (aadid) from CDS",{error:u.toString()}),f.label=4;case 4:return p="en-US",a&&(p=e.GetLocale(a.getUserLcid())),m="",a&&a.organizationSettings&&a.organizationSettings.organizationId&&(m=a.organizationSettings.organizationId),h="",a&&a.organizationSettings&&a.organizationSettings.organizationTenant&&(h=a.organizationSettings.organizationTenant),g={locale:p,UserId:c,OrganizationId:m,Culture:p,UrlReferrer:window.location.href,DeviceType:s,UserTenantId:h,ProductContext:t.productContext||""},t.formContextParameters?[2,(0,i.pi)((0,i.pi)({},g),t.formContextParameters)]:[2,g]}}))}))},e.GetLocale=function(e){var t="en-US";switch(e){case 1025:t="ar";break;case 1028:t="zh-Hant";break;case 1030:t="da";break;case 1031:t="de";break;case 1034:t="es-ES";break;case 1035:t="fi";break;case 1036:t="fr-FR";break;case 1037:t="he";break;case 1040:t="it";break;case 1041:t="ja";break;case 1043:t="nl";break;case 1044:t="nb-no";break;case 1045:t="pl";break;case 1046:t="pt-br";break;case 1053:t="sv";break;case 1054:t="th";break;case 1055:t="tr";break;case 2052:t="zh-Hans";break;case 2068:t="nn-no";break;case 2070:t="pt-pt"}return t},e.componentName="CustomerExperienceSurveyUtil",e.customerVoiceURL="https://customervoice.microsoft.com/",e.customerVoiceAuthURl="https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/",e.formsProId="v4j5cvGGr0GRqy180BHbRzLjZgexbElMtfDqlP_Vi3pUNjdRSFo0MjdZNVRJUFkzU1cyVzQwNEVUWS4u",e}()},92312:function(e,t,n){"use strict";n.d(t,{U:function(){return s}});var i=n(63804),r=n.n(i),o=n(67440),a=n(91847),s=function(e){var t,n,s,l=(0,i.useState)(!e.toggleable),c=l[0],d=l[1],u=null!==(s=null===(n=null===(t=null===window||void 0===window?void 0:window.location)||void 0===t?void 0:t.search)||void 0===n?void 0:n.includes(e.flagName))&&void 0!==s&&s;return r().createElement(r().Fragment,null,u&&r().createElement(a.Stack,null,e.toggleable&&r().createElement(o.CommandBarButton,{text:c?"Hide Debug":"Show Debug",onClick:function(){d((function(e){return!e}))},style:{textAlign:"left",paddingTop:"10px",paddingBottom:"10px"},iconProps:{iconName:"Bug"}}),c&&e.children))}},47095:function(e,t,n){"use strict";n.d(t,{r:function(){return s}});var i=n(63804),r=n.n(i),o=n(29086),a=n(4432),s=function(e){var t=e.content,n=e.href,i=e.openInNewTab,s=e.onClick,l={fontSize:o.FontSizes.size14,fontWeight:400,color:a.I.digitalBlue,textDecoration:"none"};return r().createElement("a",{href:n,onClick:s||function(){},target:i?"_blank":void 0,rel:i?"noopener noreferrer":void 0,style:l},t)}},2077:function(e,t,n){"use strict";n.d(t,{g:function(){return s}});var i=n(49037),r=n(70803),o=n(35758),a=n(48945),s=function(){function e(){}return e.getDirectionCodeText=function(e){return e===r.n9.Outgoing?a.D.getLocalizedString("Activities_DirectionCode_Outgoing"):a.D.getLocalizedString("Activities_DirectionCode_Incoming")},e.createActivityParticpantsList=function(e){return e.activitypointer_activity_parties.map((function(e){return{participationTypeMask:e.participationtypemask,name:e["_partyid_value@OData.Community.Display.V1.FormattedValue"]}}))},e.createBaseActivity=function(t,n,i){void 0===n&&(n=t.createdon),void 0===i&&(i=t["createdon@OData.Community.Display.V1.FormattedValue"]);var r=i,a=r.indexOf(" "),s=r.substring(0,a);a>0&&(r=r.substr(a+1));var l=new Date(n),c=o.b.isToday(l),d=o.b.isYesterday(l),u=!c&&l.getTime()>Date.now(),p=null;return c?p="today":d&&(p="yesterday"),{activitytypecode:t.activitytypecode,activityId:t.activityid,activityFriendlyName:t["activitytypecode@OData.Community.Display.V1.FormattedValue"],subject:t.subject,participants:e.createActivityParticpantsList(t),date:l,timestamp:r,formattedDate:s,relativeWeekday:p,isUpcoming:u}},e.createAppointmentActivity=function(t){var n=e.createBaseActivity(t,t.activity_pointer_appointment[0].scheduledstart,t.activity_pointer_appointment[0]["scheduledstart@OData.Community.Display.V1.FormattedValue"]),i=t.activity_pointer_appointment[0].location||"",r="";return n.participants.length>0&&(r=2===n.participants.length?n.participants[0].name+a.D.getLocalizedString("Activities_Appointment_Other"):n.participants.length>2?n.participants[0].name+a.D.getLocalizedString("Activities_Appointment_Others",n.participants.length-1):n.participants[0].name),{activitytypecode:n.activitytypecode.toString().toLowerCase(),activityid:n.activityId,header:n.subject,subHeader1:r,subHeader2:i,iconName:"DateTime2",date:n.date,timestamp:n.timestamp,formattedDate:n.formattedDate,relativeWeekday:n.relativeWeekday,isUpcoming:n.isUpcoming}},e.createPhoneCallActivity=function(t){var n=(0,i.pi)((0,i.pi)({},e.createBaseActivity(t)),{activityFriendlyName:a.D.getLocalizedString("Activities_PhoneCall_FriendlyName")}),o=t.activity_pointer_phonecall[0],s=o.directioncode,l=a.D.getLocalizedString("Activities_PhoneCall_Duration",o["actualdurationminutes@OData.Community.Display.V1.FormattedValue"]),c=s===r.n9.Outgoing?n.participants[1].name:n.participants[0].name,d=n.activityFriendlyName+" "+e.getDirectionCodeText(s)+" "+c,u=s===r.n9.Outgoing?"OutgoingCall":"IncomingCall";return{activitytypecode:n.activitytypecode.toString().toLowerCase(),activityid:n.activityId,header:d,subHeader2:l,iconName:u,date:n.date,timestamp:n.timestamp,formattedDate:n.formattedDate,relativeWeekday:n.relativeWeekday,isUpcoming:n.isUpcoming}},e.createEmailActivity=function(t){var n,i=e.createBaseActivity(t),o=t.activity_pointer_email[0],s=o.directioncode,l=(null===(n=(new DOMParser).parseFromString(o.description,"text/html").body.textContent)||void 0===n?void 0:n.replace(/(\r\n|\n|\r)/gm,""))||"",c=i.subject||a.D.getLocalizedString("Activities_Email_NoSubject"),d="",u=i.activityFriendlyName+" "+e.getDirectionCodeText(s)+" ";if(i.participants.length>0)if(s===r.n9.Outgoing){var p=i.participants.find((function(e){return e.participationTypeMask===r.EM.ToRecipient})),m=i.participants.find((function(e){return e.participationTypeMask===r.EM.CCRecipient})),h=i.participants.find((function(e){return e.participationTypeMask===r.EM.BccRecipient}));p?d=u+p.name:m?d=u+m.name:h&&(d=u+h.name)}else{var g=i.participants.find((function(e){return e.participationTypeMask===r.EM.Sender}));g&&(d=u+g.name)}var f=s===r.n9.Outgoing?"MailForward":"MailForwardMirrored";return{activitytypecode:i.activitytypecode.toString().toLowerCase(),activityid:i.activityId,header:c,subHeader1:d,subHeader2:l,iconName:f,date:i.date,timestamp:i.timestamp,formattedDate:i.formattedDate,relativeWeekday:i.relativeWeekday,isUpcoming:i.isUpcoming}},e.createActivityByType=function(t){switch(t.activitytypecode){case r.mh.Email:return e.createEmailActivity(t);case r.mh.PhoneCall:return e.createPhoneCallActivity(t);case r.mh.Appointment:return e.createAppointmentActivity(t);default:throw new Error("Unexpected Activity type")}},e.OpenQuickCreateActivity=function(e,t,n,r,o,a,s){return Promise.resolve(e.navigation.openForm({entityName:n.toString(),useQuickCreateForm:!0,createFromEntity:{entityType:a.toLowerCase(),id:r,name:o}},s).then((function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return e.savedEntityReference?[4,t.fetchActivities(r,e.savedEntityReference[0].id)]:[3,2];case 1:return[2,n.sent().activityList[0]];case 2:return[2,void 0]}}))}))})))},e}()},30443:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var i=n(53999),r=n.n(i),o=function(){function e(){}return e.initialize=function(){r().prefix=e.cachePrefix+"~"+e.appPrefix+"~"},e.get=function(t,n){return e.initialize(),r().get(t,n)},e.set=function(t,n){e.initialize(),r().set(t,n)},e.removeStorage=function(e){return r().rm(e)},e.setPrefix=function(t){e.appPrefix=t},e.aggregateCachePrefix="aggregate",e.cachePrefix="D365ICV_VERSION_1_",e.appPrefix="",e}()},31747:function(e,t,n){"use strict";n.d(t,{$:function(){return s}});var i=n(53999),r=n.n(i),o=n(59731),a=n(48945),s=function(){function e(){}return e.get=function(e){var t=this,n=this.createKey(e.cachingKeyUniquePrefix,e.key),i=this.createDefaultValue(e.defaultValue),r=this.getCachedData(n,e.storageType,i),o=new Date(r.timestamp),s=r.data?JSON.parse(r.data):null;return s?(a.D.reportInfo("get-CachingService",n,"Cache Hit",{storage:e.storageType}),this.isDataExpired(o,e.expiryTimeInMinutes)?e.cacheRefreshInSync?this.executeFetchAPI(e):(setTimeout((function(){t.executeFetchAPI(e)}),500),Promise.resolve(s)):Promise.resolve(s)):(a.D.reportInfo("get-CachingService",n,"Cache Miss",{storage:e.storageType}),this.executeFetchAPI(e))},e.getCachedData=function(e,t,n){switch(t){case o.Z1.LOCAL_STORAGE:return r().get(e,n);case o.Z1.SESSION_STORAGE:var i=null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.getItem(e);return i?JSON.parse(i):n}},e.createKey=function(e,t){return this.cachePrefix+"_"+e+"_"+t},e.createDefaultValue=function(e){return{timestamp:(new Date).toString(),data:JSON.stringify(e||null)}},e.setCachedData=function(e,t){var n=this.createKey(e.cachingKeyUniquePrefix,e.key),i={timestamp:(new Date).toString(),data:JSON.stringify(t)};switch(e.storageType){case o.Z1.LOCAL_STORAGE:r().set(n,i);break;case o.Z1.SESSION_STORAGE:null===sessionStorage||void 0===sessionStorage||sessionStorage.setItem(n,JSON.stringify(i))}},e.isDataExpired=function(e,t){return t>0&&t<((new Date).getTime()-e.getTime())/6e4},e.executeFetchAPI=function(e){var t=this;return Promise.resolve(e.fetchAPI().then((function(n){return t.setCachedData(e,n),n})))},e.cachePrefix="D365_DEALMANAGER_V1",e}()},48945:function(e,t,n){"use strict";n.d(t,{D:function(){return l}});var i=n(49037),r=n(87643),o=n(28741),a=n(98500),s=n(59731),l=function(){function e(){}return e.initializeContext=function(t){e.context=t},e.scenarioStart=function(t){r.SIClientUtilityLogger.PerfUtil.scenarioStart(o.Gn.area,t,e.context)},e.scenarioEnd=function(e){r.SIClientUtilityLogger.PerfUtil.scenarioEnd(o.Gn.area,e)},e.componentStart=function(e){r.SIClientUtilityLogger.PerfUtil.componentStart(o.Gn.area,e)},e.componentEnd=function(e){r.SIClientUtilityLogger.PerfUtil.componentEnd(o.Gn.area,e)},e.loadStart=function(){r.SIClientUtilityLogger.PerfUtil.loadStart(o.Gn.area)},e.loadEnd=function(){r.SIClientUtilityLogger.PerfUtil.loadEnd(o.Gn.area,this.context)},e.updatePageTitle=function(e){window&&window.document&&(window.document.title=e)},e.getFormattedDateString=function(e,t){var n=new Date,i=new Date(e);return n.getUTCFullYear===i.getUTCFullYear&&n.getUTCMonth===i.getUTCMonth&&0==n.getUTCDate()-i.getUTCDate()?this.getTimeStringInUserTimeZone(i,t):t.formatting.formatDateShort(i,!1)},e.getTimeStringInUserTimeZone=function(e,t){var n=t.formatting.formatTime(e,1),i=t.formatting.formatDateShort(e);return n.replace(i,"").trim()},e.getDateTime=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);var i=new Date;return i.setDate(i.getDate()+e),i.setMonth(i.getMonth()+t),i.setFullYear(i.getFullYear()+n),i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate()},e.showErrorField=function(e){var t,n,i=document.getElementsByClassName(e);i&&i.length>0&&(null===(n=(t=i[0]).focus)||void 0===n||n.call(t))},e.setTabIndexOnEditColumnsDropDown=function(){var e,t=document.getElementsByClassName("editColumnsDropdownItemsDiv");null===(e=null==t?void 0:t[0])||void 0===e||e.setAttribute("tabindex","0")},e.openEntityInMFD=function(e,t,n){var i;window.Xrm&&(null===(i=window.Xrm.Navigation)||void 0===i||i.navigateTo({pageType:"entityrecord",entityName:e,entityId:t},{target:2,position:1,width:{value:80,unit:"%"}}).then((function(){n&&n()})))},e.reportUserAction=function(t,n,i,o,a,s){r.SIClientUtilityLogger.Telemetry.reportUserAction(e.getEventParams(t,n,i,o,a,s))},e.reportInfo=function(t,n,i,o,a,s){r.SIClientUtilityLogger.Telemetry.reportInfo(e.getEventParams(t,n,i,o,a,s))},e.reportWarning=function(t,n,i,o,a,s){r.SIClientUtilityLogger.Telemetry.reportWarning(e.getEventParams(t,n,i,o,a,s))},e.reportError=function(t,n,i,o,a,s){r.SIClientUtilityLogger.Telemetry.reportError(e.getEventParams(t,n,i,o,a,s))},e.getEventParams=function(t,n,i,a,s,l){return r.SIClientUtilityLogger.Telemetry.getEventParams(e.context,o.Gn.area,t,n,i,a,s,l)},e.getLocalizedString=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return e.context?e.context.resources.getString(t).format(n):t},e.TriggerSurvey=function(e,t){a.e.TriggerEventAndHandleSurvey("salesinsight",e,t,{productContext:"Sales Hub",renderDimensions:{width:"47vw",height:"60vh"}})},e.OpenFeedbackSurvey=function(){var e={productContext:"Sales Hub",renderDimensions:{width:function(e){switch(!0){case e<700:return"85vw";case e<1888:return"45vw";default:return"850px"}}(document.documentElement.clientWidth),height:document.documentElement.clientHeight>850?"680px":"80vh"}};a.e.HandleSendFeedbackClicked(e)},e.getPluralNameOfEntity=function(e){switch(e){case s.py.Opportunity:return"opportunities";case s.py.Contact:return"contacts";case s.py.Account:return"accounts";case s.py.Lead:return"leads";default:return""}},e.doesRecordCountExceedLimit=function(e){return e>o.gT.recordLimit||-1==e},e.InitializeChannelIntegrationFameworkState=function(){e.isCIFSupportedInitialized||e.context.webAPI.retrieveMultipleRecords(e.channelIntegrationProviderEntityLogicalName,e.ciProviderEntityRecordQuery).then((function(t){var n;(null===(n=null==t?void 0:t.entities)||void 0===n?void 0:n.length)>0&&(e.isCIFSupported=!0)}),(function(t){e.isCIFSupported=!1}))},e.isChannelIntegrationFrameworkSupported=function(){return e.isCIFSupported},e.isRTL=function(){return e.context.userSettings.isRTL},e.getXrmGlobalContext=function(){var e=null;try{e=window.Xrm&&Xrm.Utility&&Xrm.Utility.getGlobalContext()}catch(e){}return e},e.SaveSetting=function(e,t){return(0,i.mG)(this,void 0,void 0,(function(){var n,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return(n=this.getXrmGlobalContext())&&n.saveSettingValue&&n.getCurrentAppSetting?null===n.getCurrentAppSetting(e)||void 0===n.getCurrentAppSetting(e)?[3,2]:(r={overrideScope:1},[4,n.saveSettingValue(e,t,r)]):[3,2];case 1:i.sent(),i.label=2;case 2:return[2]}}))}))},e.getFeatureSupport=function(e){return{isChartSupported:e===s.py.Opportunity,isStatsSupported:e===s.py.Opportunity}},e.channelIntegrationProviderEntityLogicalName="msdyn_ciprovider",e.ciProviderEntityRecordQuery="?$filter=statuscode eq 1&$select=msdyn_landingurl,msdyn_roleselector,msdyn_clicktoact,msdyn_appselector",e.isCIFSupported=!1,e.isCIFSupportedInitialized=!1,e}();String.prototype.format=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this,i=0;i<e[0].length;i++){var r=void 0===arguments[0][i]||null==arguments[0][i]?"":arguments[0][i].toString();n=n.replace(new RegExp("\\{"+i+"\\}","g"),r)}return n}},4476:function(e,t,n){"use strict";n.d(t,{_:function(){return v}});var i=n(88603),r=n(2179),o=n(6302),a=n(23436),s=n(5201),l=n(15220),c=n(71350),d=n(99709),u=n(24694),p=n(90065),m=n(55562),h=n(49339),g=n(10979),f=n(61376),y=n(66960),v=function(){function e(){}return e.getContainerContext=function(e){var t={formatting:e.formatting,webAPI:e.webAPI,controlUtilities:e.utils,navigation:e.navigation,resources:e.resources,telemetryLogger:e.reporting,page:e.page,client:e.client,hostIdentifier:"PipelineManager"};l.Validations.validateNullArgument(t,"hostContext");var n=a.Guid.newGuid(),f=new s.TelemetryLogger(t.telemetryLogger,n,t.hostIdentifier),y=new d.CDSMetadataClient(t.controlUtilities,f),v=new c.CDSDataClient(y,t.webAPI,t.page,f),C=new i.R(t.resources),S=new u.AttributeValueFormatter(t.formatting),E=new p.AttributeValueValidator(C),b=new m.AttributeValueComparator,w=new r.s(v),D=new h.DataSetRecordProvider(S,E,b,v,w,f);return{metadataProvider:y,resolver:t.lookupResolver?t.lookupResolver:new g.LookupResolver(y,f),timezoneService:new o.B(t.formatting,t.client),datasetRecordProvider:D,dataProvider:v,resources:C,navigation:t.navigation}},e.getDataverseAccess=function(){var e=n(8540).create({baseURL:document.location.origin}),t=(0,y.createCDSClientWithHttpClient)(e);return{axiosInstance:e,cdsResolver:new f.CDSResolver(t)}},e}()},4432:function(e,t,n){"use strict";n.d(t,{I:function(){return i},B:function(){return r}});var i=function(){function e(){}return e.digitalBlue="#2266E3",e.grey="#F3F2F1",e.editDeletIconhover="#E1DFDD",e.red="red",e.white="#FFFFFF",e.chartsNeutralDark="#888888",e.chartsBlueLight="#418DED",e.chartsTealLight="#0299A3",e.chartsCautionDark="#D3561D",e}(),r=function(){function e(){}return e.size2px="2px",e.size4px="4px",e.size22px="22px",e.size10px="10px",e}()},13966:function(e,t,n){"use strict";n.d(t,{E:function(){return i}});var i={1025:"ar",1026:"bg",1027:"ca",1028:"zh",1029:"cs",1030:"da",1031:"de",1032:"el",1033:"en",1035:"fi",1036:"fr",1037:"he",1038:"hu",1040:"it",1041:"ja",1042:"ko",1043:"nl",1044:"nb",1045:"pl",1046:"pt-br",1048:"ro",1049:"ru",1050:"hr",1051:"sk",1053:"sv",1054:"th",1055:"tr",1057:"id",1058:"uk",1060:"sl",1061:"et",1062:"lv",1063:"lt",1066:"vi",1069:"eu",1081:"hi",1086:"ms",1087:"kk",1110:"gl",2052:"zh-cn",2070:"pt",2074:"sr-latn",3076:"zh",3082:"es",3098:"sr"}},17875:function(e,t,n){"use strict";n.d(t,{l:function(){return r}});var i=n(29758),r=function(){function e(){}return e.initializeTheme=function(e){this.theme=e},e.getTheme=function(){return this.theme},e.getErrorButtonStyle=function(){return{root:{color:"#A4262C",background:"transparent"},rootHovered:{color:"#A4262C",background:"transparent"},rootPressed:{color:"#A4262C",background:"transparent"},rootFocused:{color:"#A4262C",background:"transparent"}}},e.getSavedButtonStyle=function(){return{root:{color:"#107C10",background:"transparent"},rootHovered:{color:"#107C10",background:"transparent"},rootPressed:{color:"#107C10",background:"transparent"},rootFocused:{color:"#107C10",background:"transparent"}}},e.getSpinnerStyles=function(){return{root:{marginLeft:10}}},e.getFieldTextStyle=function(e){switch(e){case i.EDataType.Lookup:case i.EDataType.Customer:case i.EDataType.Owner:return{fontSize:"14px",fontWeight:"normal",color:"#2266E3"};default:return{fontSize:"14px",fontWeight:"normal"}}},e}()},73200:function(e,t,n){"use strict";n.d(t,{Wq:function(){return i},bc:function(){return o}});var i=function(e,t){return new Promise((function(n,i){var r=new FileReader;r.onerror=i,r.onabort=i,t&&(r.onprogress=t),r.onload=function(){var e=r.result;n(e.split(";base64,")[1])},r.readAsDataURL(e)}))},r=["B","KB","MB","GB"],o=function(e,t){var n=r.findIndex((function(e){return e==t}));return(e/Math.pow(1024,n)).toLocaleString(void 0)+" "+t}},14594:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var i,r=n(59731),o=function(){function e(){}return e.getSystemFormIdByEntityType=function(e){return this.configuredSystemForms[e]||this.oobSystemForms[e]},e.parseFormXml=function(e,t){if(DOMParser){var n=(new DOMParser).parseFromString(t,"text/xml");return{entityType:e,dataFields:this.getDatafields(n).dataFields,dataFieldsIsReadOnly:this.getDatafields(n).dataFieldsIsReadOnly,header:this.getHeader(n),tabs:this.getTabs(n)}}return null},e.getTabs=function(e){for(var t=[],n=e.getElementsByTagName("tab"),i=0;i<n.length&&i<2;i++){for(var r=n[i],o=this.getLabel(r),a=[],s=r.getElementsByTagName("column"),l=0;l<s.length;l++){var c=s[l];a.push({sections:this.getSections(c)})}t.push({key:r.getAttribute("name")||o,name:o,columns:a,showLabel:"true"==r.getAttribute("showlabel")})}return t},e.getLabel=function(e){var t="";return e&&e.childNodes.forEach((function(e){if("labels"==e.nodeName){var n=e.children[0];if(n){var i=n.getAttribute("description");i&&(t=i)}}})),t},e.getDatafields=function(e){for(var t=["statecode"],n=[!1],i=e.getElementsByTagName("control"),r=0;r<i.length;r++){var o=i[r].getAttribute("datafieldname"),a=i[r].getAttribute("disabled");o&&(t.push(o),"true"===a?n.push(!0):n.push(!1))}return{dataFields:t,dataFieldsIsReadOnly:n}},e.getHeader=function(e){return this.getCells(e.getElementsByTagName("header")[0])},e.getSections=function(e){for(var t=[],n=e.getElementsByTagName("section"),i=0;i<n.length;i++){var r=n[i],o=this.getLabel(r);t.push({key:r.getAttribute("name")||o,labelDescription:o,showLabel:"true"==r.getAttribute("showlabel"),showTopBar:"true"==r.getAttribute("showbar"),rows:this.getRows(r)})}return t},e.getRows=function(e){var t=[];if(e)for(var n=e.getElementsByTagName("row"),i=0;i<n.length;i++)t.push({cells:this.getCells(n[i])});return t},e.getCells=function(e){for(var t=[],n=e.getElementsByTagName("cell"),i=0;i<n.length;i++){var r=n[i],o=r.getElementsByTagName("control")[0];if(o){var a=o.getAttribute("datafieldname"),s=r.getElementsByTagName("label")[0]&&r.getElementsByTagName("label")[0].getAttribute("description");a&&s&&t.push({key:r.getAttribute("name")||s,datafieldName:a,labelDescription:s,disabled:o&&"true"==o.getAttribute("disabled"),showLabel:"true"==r.getAttribute("showlabel")})}}return t},e.oobSystemForms=((i={})[r.py.Opportunity]="BA7F7AD7-E0E7-43AA-BE19-5069DD9C60EB",i[r.py.Account]="FACE3AA6-99C4-4B7E-AF07-55F121CDCA86",i[r.py.Contact]="4C9C89B9-F909-4B34-8F63-B87D7FF2F0C4",i[r.py.Lead]="E7D96C74-2D77-47B7-9A55-C5D26EB7074C",i),e.configuredSystemForms={},e}()},47482:function(e,t,n){"use strict";n.d(t,{ZH:function(){return s},A7:function(){return l},xM:function(){return c}});var i=n(63787),r=n(59731),o=n(42694),a=n(28741),s=function(){function e(){}return e.getRequiredAttributes=function(e){switch(e){case r.py.Opportunity:return["opportunityid","statecode"];case r.py.Account:return["accountid","statecode"];case r.py.Contact:return["contactid","statecode"];case r.py.Lead:return["leadid","statecode"];default:return[]}},e.createDatasetForFieldFactory=function(e,t,n,r,o,a){var s=o.datasetRecordProvider,l=[];return e.records&&Object.values(e.records).forEach((function(e){var o=new Map,c=new Map;t.forEach((function(t){var n=r.get(t),a=i.CDSResponseParser.getAttributeValue(t,n,null,e.getValue(t),e.getFormattedValue(t));null!=a?(o.set(t,a[0]),c.set(t,a[1])):(o.set(t,null),c.set(t,null))}));var d={values:o,formattedValues:c,recordId:e.getRecordId()},u=s.buildDataSetRecord(n,r,d,a);l.push(u)})),l},e.getColumnsFromAttributeMetadata=function(e){var t=[];return e&&e.forEach((function(e){t.push(e.name)})),t},e.getColumnInfoCacheKey=function(e){return e+"columnsInfo_v2"},e.getResetColumnInfoCacheKey=function(e){return e+"reset_columnsInfo_v2"},e.getAggregateFetchXml=function(e,t,n,i,r){return encodeURIComponent("<fetch distinct='false' mapping='logical' aggregate='true'><entity name='"+e+"'><attribute name='"+n+"' alias='"+i+"' aggregate='"+t+"' />"+r+"</entity></fetch>")},e.getUnEncodedAggregateFetchXml=function(e,t,n,i,r){return"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='"+e+"'><attribute name='"+n+"' alias='"+i+"' aggregate='"+t+"' />"+r+"</entity></fetch>"},e.getAggregateFetchXmlWithLinkedEntity=function(e,t,n,i,r,o,a){return encodeURIComponent("<fetch distinct='false' mapping='logical' aggregate='true'><entity name='"+e+"'><link-entity name='"+t+"' from=\""+n+'" to="'+n+"\"><attribute name='"+r+"' alias='"+o+"' aggregate='"+i+"' /></link-entity>"+a+"</entity></fetch>")},e.isNumericField=function(e){return e===o.Vz.WholeNumber||e===o.Vz.Decimal||e===o.Vz.Float||e===o.Vz.Currency},e.getCustomHeaderClassName=function(e){var t=null==e?void 0:e.replace(".","-");return a.gT.customHeaderClassNamePrefix+t},e}(),l=function(e,t,n){return e.map((function(e){return e[n]===t[n]?t:e}))},c=function(e){var t=e.indexOf(".");return t<0?{fullyQualifiedName:e,name:e}:{fullyQualifiedName:e,linkEntityAlias:e.slice(0,t),name:e.slice(t+1)}}},52618:function(e,t,n){"use strict";n.d(t,{gT:function(){return i},EJ:function(){return r},dS:function(){return o}});var i=function(){function e(){}return e.ACTIVITY="activity",e.SUMMARY="summary",e.SUMMARY_KEY_DETAILS="summary_keydetails",e.SUMMARY_CONTACTS="summary_contacts",e.SUMMARY_NOTES="summary_notes",e.SUMMARY_TASKS="summary_tasks",e.SUMMARY_COLLABORATION="summary_collaboration",e.SUMMARY_RECENTOPPORTUNITIES="summary_recentopportunities",e}(),r=function(){function e(){}return e.CLICK="Click",e}(),o=function(){function e(){}return e.SUCCESS="Success",e.FAILED="Failed",e}()},88603:function(e,t,n){"use strict";n.d(t,{R:function(){return r}});var i=n(64733),r=function(){function e(e){this.resourceContext=e}return e.prototype.getLocalizedString=function(e){var t=this.resourceContext.getString(e);return t!==e&&null!=t||(t=(0,i.K)(e)),t},e}()},86705:function(e,t,n){"use strict";n.d(t,{q:function(){return r}});var i=n(48945),r=function(e){switch(e){case"Open":case"0":case 0:return 0;case"Won":case"1":case 1:return 1;case"Lost":case"2":case 2:return 2}return i.D.reportError("getStateCodeNumeric","pcfUtils","Invalid statecode: "+e,""),-1}},64733:function(e,t,n){"use strict";n.d(t,{K:function(){return r}});var i={INVALID_DATA_TYPE:"The attribute value is not of desired data type.",ATTRIBUTE_BUSINESS_REQUIRED:"This attribute is business required.",ATTRIBUTE_MAXIMUM_LENGTH_EXCEEDED:"The attribute value exceeded the maximum allowed length of {0} characters.",ATTRIBUTE_VALUE_OUT_OF_RANGE:"The attribute value must be between {0} and {1}",UNEXPECTED_ERROR:"Unexpected Error",LOADING_RESULTS:"loading results",NO_RESULTS_FOUND:"no results found",OPTIONSET_SELECT:"--Select--",TOTAL_RECORDS_COUNT:"{0}/{1}",ERROR_LOADING_CONTROL:"Error Loading Control",AGGREGATION_LIMIT_EXCEEDED_TOTAL_RECORDS_COUNT:"{0}+",CARD_DIV_ARIA_LABEL:"Draggable item. Press space bar to lift",REMOVE:"Remove"};function r(e){return i[e]?i[e]:e}},17754:function(e,t,n){"use strict";n.d(t,{WB:function(){return r},rQ:function(){return o},S_:function(){return a}});var i=n(19608),r={dynShade30:"#053385",dynShade20:"#0742AB",dynShade10:"#0B53CE",dynPrimary:"#2266E3",dynTint10:"#1F6CF9",dynTint20:"#9CBEFF",dynTint30:"#CCDEFF",dynTint40:"#E7EFFF"},o=(0,i.createTheme)({palette:{themePrimary:r.dynPrimary,themeLighterAlt:"#f5f8fe",themeLighter:"#d8e4fb",themeLight:"#b8cef7",themeTertiary:"#759fee",themeSecondary:"#3a76e6",themeDarkAlt:"#1f5bcc",themeDark:"#1a4dac",themeDarker:"#13397f",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"}}),a="#a4262c"},6302:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var i=function(){function e(e,t){this.formatting=e,this.client=t}return e.prototype.utcToBrowserTimeZone=function(e){return e?new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()):e},e.prototype.browserTimeZoneToUtc=function(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())):e},e.prototype.utcToUserLocal=function(e){return e?new Date(e.getTime()+6e4*(this.getUserTimeZoneUtcOffset(e)+e.getTimezoneOffset())):e},e.prototype.userLocalToUtc=function(e){return e?new Date(e.getTime()-6e4*(this.getUserTimeZoneUtcOffset(e)+e.getTimezoneOffset())):e},e.prototype.formatTime=function(e,t){return this.formatting.formatTime(e,t)},e.prototype.formatDateShort=function(e,t){return this.formatting.formatDateShort(e)},e.prototype.getUserTimeZoneUtcOffset=function(e){return this.client.getUserTimeZoneUtcOffset(e)},e}()},78231:function(e,t,n){"use strict";n.d(t,{I:function(){return i}});var i=function(){function e(){}return e.EntityName="transactioncurrency",e.CurrencyNameAttribute="currencyname",e.CurrencySymbolAttribute="currencysymbol",e.CurrencyPrecisionAttribute="currencyprecision",e.IsoCurrencyCodeAttribute="isocurrencycode",e.ExchangeRateAttribute="exchangerate",e}()},2179:function(e,t,n){"use strict";n.d(t,{s:function(){return a}});var i=n(49037),r=n(78231),o=n(15220),a=function(){function e(e){this.dataClient=e,this.attributesToBeRetrieved=[r.I.CurrencyNameAttribute,r.I.CurrencySymbolAttribute,r.I.CurrencyPrecisionAttribute,r.I.IsoCurrencyCodeAttribute,r.I.ExchangeRateAttribute],this.transactionCurrenciesMap=new Map}return e.prototype.getTransactionCurrency=function(e){return(0,i.mG)(this,void 0,Promise,(function(){return(0,i.Jh)(this,(function(t){switch(t.label){case 0:return o.Validations.validateStringArgument(e,"id"),this.transactionCurrenciesMap.has(e)||this.transactionCurrenciesMap.set(e,this.retrieveTransactionCurrencyFromServer(e)),[4,this.transactionCurrenciesMap.get(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.retrieveTransactionCurrencyFromServer=function(e){return(0,i.mG)(this,void 0,Promise,(function(){var t;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.dataClient.retrieveRecord(r.I.EntityName,e,this.attributesToBeRetrieved)];case 1:return t=n.sent(),[2,this.buildTransactionCurrencyObject(e,t)]}}))}))},e.prototype.buildTransactionCurrencyObject=function(e,t){return{transactionCurrencyId:e,currencyName:t.values.get(r.I.CurrencyNameAttribute),currencySymbol:t.values.get(r.I.CurrencySymbolAttribute),currencyPrecision:t.values.get(r.I.CurrencyPrecisionAttribute),currencyCode:t.values.get(r.I.IsoCurrencyCodeAttribute),exchangeRate:t.values.get(r.I.ExchangeRateAttribute)}},e}()},28741:function(e,t,n){"use strict";n.d(t,{Gn:function(){return o},BG:function(){return a},gT:function(){return s},gm:function(){return i},yW:function(){return r}});var i,r,o=function(){function e(){}return e.area="Workspace",e}(),a=function(){function e(){}return e.openInContextView="Open InContext View",e.openView="Open View",e.changeLayout="Change Layout",e.changeSystemView="Change System View",e.applyFilter="Apply Filter",e}(),s=function(){function e(){}return e.loadMoreRowKey="loadMoreRowKey",e.aggregateRowKey="aggregateRowKey",e.checkboxColumnField="checkboxColumn",e.sortAscending="sortAscending",e.sortDescending="sortDescending",e.revertToDefaultSort="revertToDefaultSort",e.filterByThisColumn="filterByThisColumn",e.groupByThisColumn="groupByThisColumn",e.insertBasicColumnKey="insertBasicColumn",e.insertLeftBasicColumnKey="insertLeftBasicColumn",e.insertRightBasicColumnKey="insertRightBasicColumn",e.insertBasicColumnText="WS_Grid_Header_Insert_Basic_Column",e.insertLeftBasicColumnText="WS_Grid_Header_Insert_Left_Column",e.insertRightBasicColumnText="WS_Grid_Header_Insert_Right_Column",e.hideColumn="hideColumn",e.setAsFirstColumn="setAsFirstColumn",e.contextMenuFilterByColumn="WS_Grid_Header_Filter_By_Column",e.contextMenuHidecolumn="WS_Grid_Header_Hide_Column",e.contextMenuSetAsFirstColumn="WS_Grid_Header_Set_First_Column",e.contextMenuRevertToDefaultSort="WS_Grid_Header_Reset_To_Default_Sorting",e.contextMenuGroupByThisColumn="WS_Grid_Header_Group_By_This_Column",e.contextMenuSortAscNumber="WS_Grid_Header_Sort_Smaller_To_Larger",e.contextMenuSortDescNumber="WS_Grid_Header_Sort_To_Larger_To_Smaller",e.contextMenuSortAscDate="WS_Grid_Header_Oldest_To_Newest",e.contextMenuSortDescDate="WS_Grid_Header_Newest_to_Oldest",e.contextMenuSortAscString="WS_Grid_Header_A_To_Z",e.contextMenuSortDescString="WS_Grid_Header_Z_To_A",e.dropdownSelectAllKey="showall",e.dropdownSelectAllValue="WS_Grid_EditColumns_Show_All",e.dropdownSearchText="WS_Grid_EditColumns_Search",e.dropdownEditColumnsText="WS_Grid_EditColumns",e.editColumnPaneAddColumnTitle="WS_Grid_Pane_Header_AddColumn",e.editColumnPaneAddSmartColumnTitle="WS_Grid_Pane_Header_AddSmartColumn",e.dropdownAddBasicColumnText="WS_Grid_AddColumn_Basic",e.dropdownAddSmartColumnText="WS_Grid_AddColumn_Smart",e.dropdownAddRelatedColumnText="WS_Grid_AddColumn_Related",e.dropdownMoveUpText="WS_Grid_EditColumns_Move_Up",e.dropdownMoveDownText="WS_Grid_EditColumns_Move_Down",e.gridSearchText="WS_Grid_Searchbox",e.gridSearchboxClassName="gridSearchbox",e.stateCode="statecode",e.statusCode="statuscode",e.fieldErrorClassName="fieldErrorIconStyle",e.openNotesButtonKey="icv_openNotesButton",e.openTasksButtonKey="icv_openTasksButton",e.openCollabButtonKey="icv_openCollabButton",e.addNoteButtonKey="icv_addNoteButton",e.addNoteCommand="icv_addNoteCommand",e.aggMethodSum="sum",e.aggMethodAvg="avg",e.aggMethodMin="min",e.aggMethodMax="max",e.aggregateMethodList=[e.aggMethodSum,e.aggMethodAvg,e.aggMethodMin,e.aggMethodMax],e.formattedValueSuffix="@OData.Community.Display.V1.FormattedValue",e.customHeaderClassNamePrefix="customHeader-",e.recordLimit=250,e.commandBarButtonLocation="commandBarButton",e.updateButtonLocation="updateEntityViewButton",e}();!function(e){e.Spinner="spinner",e.Button="button"}(i||(i={})),function(e){e.NoData="noData",e.Error="error",e.RowCountExceedsLimit="rowCountExceedsLimit",e.SearchReturnedEmpty="searchReturnedEmpty",e.SearchReturnedEmptyTryChangingFilters="searchReturnedEmptyTryChangingFilters"}(r||(r={}))},14809:function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var i=n(6946),r=n(48945),o=n(59731),a=function(){return{closedate:{fieldName:"closedate",displayName:r.D.getLocalizedString("Close_Date"),dataType:i.EDataType.Date,entityType:o.py.Opportunity,sourceFields:["estimatedclosedate","actualclosedate","statecode"],type:"conditional",computeField:function(e){return 0==e?"estimatedclosedate":"actualclosedate"},tooltipContent:r.D.getLocalizedString("Close_Date_Tooltip")},revenue:{fieldName:"revenue",displayName:r.D.getLocalizedString("Revenue"),dataType:i.EDataType.WholeNumber,entityType:o.py.Opportunity,sourceFields:["estimatedvalue","actualvalue","statecode"],type:"conditional",computeField:function(e){return 0==e?"estimatedvalue":"actualvalue"},tooltipContent:r.D.getLocalizedString("Revenue_Tooltip")}}}},70803:function(e,t,n){"use strict";var i,r,o;n.d(t,{mh:function(){return i},EM:function(){return r},n9:function(){return o}}),function(e){e.Email="email",e.PhoneCall="phonecall",e.Appointment="appointment"}(i||(i={})),function(e){e[e.Sender=1]="Sender",e[e.ToRecipient=2]="ToRecipient",e[e.CCRecipient=3]="CCRecipient",e[e.BccRecipient=4]="BccRecipient",e[e.RequiredAttendee=5]="RequiredAttendee",e[e.OptionalAttendee=6]="OptionalAttendee",e[e.Organizer=7]="Organizer",e[e.Regarding=8]="Regarding",e[e.Owner=9]="Owner",e[e.Resource=10]="Resource",e[e.Customer=11]="Customer"}(r||(r={})),function(e){e[e.Incoming=0]="Incoming",e[e.Outgoing=1]="Outgoing"}(o||(o={}))},59731:function(e,t,n){"use strict";var i,r,o,a,s,l,c,d,u;n.d(t,{py:function(){return i},$M:function(){return r},Cx:function(){return a},lP:function(){return s},wO:function(){return l},Sr:function(){return c},as:function(){return d},Z1:function(){return u}}),function(e){e.Opportunity="opportunity",e.Lead="lead",e.Contact="contact",e.Account="account",e.Task="task",e.Note="note",e.Chat="chat"}(i||(i={})),function(e){e[e.FieldErrorPreventingHideColumn=0]="FieldErrorPreventingHideColumn"}(r||(r={})),function(e){e[e.Mandatory=1]="Mandatory",e[e.Currency=2]="Currency",e[e.Date=3]="Date",e[e.None=4]="None",e[e.Email=5]="Email",e[e.Number=6]="Number"}(o||(o={})),function(e){e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High"}(a||(a={})),function(e){e[e.Open=0]="Open",e[e.Completed=1]="Completed",e[e.Canceled=2]="Canceled"}(s||(s={})),function(e){e[e.Default=0]="Default",e[e.List=1]="List",e[e.Edit=2]="Edit",e[e.Create=3]="Create",e[e.Chat=4]="Chat"}(l||(l={})),function(e){e[e.none=-1]="none",e[e.asc=0]="asc",e[e.desc=1]="desc"}(c||(c={})),function(e){e.Fetch_System_Form="Fetch_System_Form",e.Fetch_Entity_Metadata="Fetch_Entity_Metadata",e.Fetch_Process_Unique_Name="Fetch_Process_Unique_Name",e.Key_Local_0_sync="Key_Local_0_sync",e.Key_Session_0_sync="Key_Session_0_sync",e.Key_Local_1_sync="Key_Local_1_sync",e.Key_Session_1_sync="Key_Session_1_sync",e.Key_Local_1_async="Key_Local_1_async",e.Key_Session_1_async="Key_Session_1_async",e.Key_cache_miss="Key_cache_miss"}(d||(d={})),function(e){e[e.LOCAL_STORAGE=0]="LOCAL_STORAGE",e[e.SESSION_STORAGE=1]="SESSION_STORAGE"}(u||(u={}))},17217:function(e,t,n){"use strict";n.d(t,{P:function(){return i}});var i={backIcon:{iconName:"Back"},closeIcon:{iconName:"CalculatorMultiply"},goToIcon:{iconName:"OpenInNewWindow"},officeChat:{iconName:"OfficeChat"},taskList:{iconName:"tasklist-svg"},notes:{iconName:"QuickNote"},unselectedOption:{iconName:"LocationCircle"},selectedOption:{iconName:"CompletedSolid"},add:{iconName:"Add"},notesEdit:{iconName:"Edit"},quickNote:{iconName:"QuickNote"},contact:{iconName:"Contact"},download:{iconName:"Download"},powerPointDocument:{iconName:"PowerPointDocument"},wordDocument:{iconName:"WordDocument"},deleteNotes:{iconName:"Delete"},attachmentIcon:{iconName:"Attach"},chevronRight:{iconName:"ChevronRight"},chevronDown:{iconName:"ChevronDown"},error:{iconName:"Error"},refresh:{iconName:"SyncOccurence"},forward:{iconName:"Forward"},flag:{iconName:"Flag"},location:{iconName:"Location"},bubbleChart:{iconName:"bubbleChart-svg"},funnelChart:{iconName:"funnelChart-svg"},editTask:{iconName:"Edit"},deleteTask:{iconName:"Delete"},securityGroup:{iconName:"SecurityGroup"},editColumnReset:{iconName:"editColumnReset"}}},28681:function(e,t,n){"use strict";n.d(t,{D:function(){return o}});var i=n(63804),r=n.n(i),o={icons:{ResetFilter:r().createElement("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{fill:"currentColor",d:"M0 0.0398941H16V1.75083L12.2344 5.50863L11.5313 4.80553L15 1.32896V1.03989H1V1.32896L7 7.32895V13.0399H7.99219C7.99741 13.0503 8 13.1024 8 13.1961C8 13.2899 8 13.3967 8 13.5165V14.0399H6V7.75084L0 1.75083V0.0398941ZM16 11.5399C16 12.0243 15.9089 12.48 15.7266 12.9071C15.5443 13.3289 15.2943 13.6987 14.9766 14.0165C14.6588 14.3342 14.2865 14.5841 13.8594 14.7665C13.4375 14.9488 12.9844 15.0399 12.5 15.0399C12.0156 15.0399 11.5599 14.9488 11.1328 14.7665C10.7109 14.5841 10.3412 14.3342 10.0234 14.0165C9.70573 13.6987 9.45574 13.3289 9.27344 12.9071C9.09114 12.48 9 12.0243 9 11.5399H10C10 11.8836 10.0651 12.2092 10.1953 12.5165C10.3255 12.8185 10.5026 13.0841 10.7266 13.3133C10.9557 13.5373 11.2213 13.7144 11.5234 13.8446C11.8307 13.9748 12.1563 14.0399 12.5 14.0399C12.8437 14.0399 13.1667 13.9748 13.4687 13.8446C13.7708 13.7144 14.0339 13.5373 14.2578 13.3133C14.487 13.0841 14.6667 12.8185 14.7969 12.5165C14.9323 12.2092 15 11.8836 15 11.5399C15 11.1961 14.9323 10.8732 14.7969 10.5712C14.6667 10.269 14.487 10.006 14.2578 9.78207C14.0339 9.55292 13.7708 9.37324 13.4687 9.24303C13.1667 9.10761 12.8437 9.03989 12.5 9.03989H10.7109L11.8516 10.1883L11.1484 10.8914L8.79686 8.53989L11.1484 6.18834L11.8516 6.89145L10.7109 8.03989H12.5C12.9844 8.03989 13.4375 8.13103 13.8594 8.31333C14.2865 8.49564 14.6588 8.74562 14.9766 9.06332C15.2943 9.38105 15.5443 9.75343 15.7266 10.1805C15.9089 10.6024 16 11.0555 16 11.5399Z"})),OutgoingCall:r().createElement("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{fill:"currentColor",d:"M8.64844 6.64844L13.2891 2H10V1H15V6H14V2.71094L9.35156 7.35156L8.64844 6.64844ZM11.9531 9.21094C12.1562 9.21094 12.3542 9.25 12.5469 9.32812C12.7396 9.40625 12.9089 9.51823 13.0547 9.66406C13.1641 9.77344 13.2865 9.89062 13.4219 10.0156C13.5625 10.1354 13.7057 10.263 13.8516 10.3984C13.9974 10.5286 14.138 10.6667 14.2734 10.8125C14.4089 10.9583 14.5312 11.1094 14.6406 11.2656C14.75 11.4167 14.8359 11.5755 14.8984 11.7422C14.9661 11.9089 15 12.0807 15 12.2578C15 12.4609 14.9609 12.6589 14.8828 12.8516C14.8047 13.0443 14.6927 13.2135 14.5469 13.3594C14.2812 13.625 14.0417 13.8594 13.8281 14.0625C13.6146 14.2656 13.3906 14.4375 13.1562 14.5781C12.9271 14.7188 12.6719 14.8255 12.3906 14.8984C12.1094 14.9661 11.7734 15 11.3828 15C10.8151 15 10.2318 14.9115 9.63281 14.7344C9.03385 14.5573 8.4375 14.3125 7.84375 14C7.25 13.6875 6.66927 13.3151 6.10156 12.8828C5.53385 12.4505 4.99479 11.9792 4.48438 11.4688C3.97917 10.9583 3.51302 10.4193 3.08594 9.85156C2.65885 9.28385 2.29167 8.70573 1.98438 8.11719C1.67708 7.52344 1.4349 6.93229 1.25781 6.34375C1.08594 5.75 1 5.17708 1 4.625C1 4.22917 1.03385 3.89062 1.10156 3.60938C1.17448 3.32812 1.27865 3.07292 1.41406 2.84375C1.55469 2.61458 1.72656 2.39323 1.92969 2.17969C2.13281 1.96094 2.36979 1.71875 2.64062 1.45312C2.78646 1.30729 2.95573 1.19531 3.14844 1.11719C3.34115 1.03906 3.53906 1 3.74219 1C4.0026 1 4.2526 1.07031 4.49219 1.21094C4.73698 1.35156 4.96875 1.52344 5.1875 1.72656C5.40625 1.92969 5.61198 2.14323 5.80469 2.36719C5.9974 2.59115 6.17448 2.78385 6.33594 2.94531C6.48177 3.09115 6.59375 3.26042 6.67188 3.45312C6.75 3.64583 6.78906 3.84375 6.78906 4.04688C6.78906 4.25 6.75521 4.43229 6.6875 4.59375C6.61979 4.75521 6.53385 4.90104 6.42969 5.03125C6.33073 5.15625 6.22135 5.27344 6.10156 5.38281C5.98698 5.48698 5.8776 5.58854 5.77344 5.6875C5.67448 5.78646 5.59115 5.88542 5.52344 5.98438C5.45573 6.07812 5.42188 6.17969 5.42188 6.28906C5.42188 6.35156 5.46875 6.45312 5.5625 6.59375C5.66146 6.72917 5.79167 6.88802 5.95312 7.07031C6.11458 7.2526 6.29948 7.45312 6.50781 7.67188C6.72135 7.89062 6.9401 8.11198 7.16406 8.33594C7.39323 8.5599 7.61979 8.78125 7.84375 9C8.07292 9.21875 8.28385 9.42188 8.47656 9.60938C8.67448 9.79688 8.84635 9.96094 8.99219 10.1016C9.14323 10.2422 9.2526 10.3464 9.32031 10.4141C9.42969 10.5234 9.5599 10.5781 9.71094 10.5781C9.82031 10.5781 9.92188 10.5443 10.0156 10.4766C10.1146 10.4089 10.2109 10.3255 10.3047 10.2266C10.4036 10.1224 10.5052 10.013 10.6094 9.89844C10.7188 9.77865 10.8385 9.66927 10.9688 9.57031C11.099 9.46615 11.2422 9.38021 11.3984 9.3125C11.5599 9.24479 11.7448 9.21094 11.9531 9.21094ZM11.3828 14C11.7005 14 11.9661 13.9714 12.1797 13.9141C12.3984 13.8516 12.5938 13.763 12.7656 13.6484C12.9375 13.5339 13.1042 13.3932 13.2656 13.2266C13.4323 13.0599 13.6224 12.8698 13.8359 12.6562C13.9453 12.5469 14 12.4167 14 12.2656C14 12.1979 13.9583 12.1016 13.875 11.9766C13.7917 11.8464 13.6849 11.7057 13.5547 11.5547C13.4297 11.3984 13.2865 11.2422 13.125 11.0859C12.9688 10.9297 12.8151 10.7865 12.6641 10.6562C12.513 10.526 12.3724 10.4193 12.2422 10.3359C12.1172 10.2526 12.0208 10.2109 11.9531 10.2109C11.8438 10.2109 11.7396 10.2448 11.6406 10.3125C11.5417 10.3802 11.4427 10.4661 11.3438 10.5703C11.25 10.6693 11.1484 10.7786 11.0391 10.8984C10.9349 11.013 10.8177 11.1224 10.6875 11.2266C10.5573 11.3255 10.4115 11.4089 10.25 11.4766C10.0938 11.5443 9.91406 11.5781 9.71094 11.5781C9.5026 11.5781 9.30208 11.5391 9.10938 11.4609C8.92188 11.3776 8.75521 11.263 8.60938 11.1172L4.88281 7.39062C4.73698 7.24479 4.6224 7.07812 4.53906 6.89062C4.46094 6.69792 4.42188 6.4974 4.42188 6.28906C4.42188 6.08594 4.45573 5.90625 4.52344 5.75C4.59115 5.58854 4.67448 5.44271 4.77344 5.3125C4.8776 5.18229 4.98698 5.0651 5.10156 4.96094C5.22135 4.85156 5.33073 4.7474 5.42969 4.64844C5.53385 4.54948 5.61979 4.45312 5.6875 4.35938C5.75521 4.26042 5.78906 4.15625 5.78906 4.04688C5.78906 3.97917 5.7474 3.88281 5.66406 3.75781C5.58073 3.63281 5.47396 3.49479 5.34375 3.34375C5.21875 3.1875 5.07552 3.03125 4.91406 2.875C4.75781 2.71354 4.60156 2.57031 4.44531 2.44531C4.29427 2.3151 4.15625 2.20833 4.03125 2.125C3.90625 2.04167 3.8099 2 3.74219 2C3.58594 2 3.45312 2.05469 3.34375 2.16406C3.13021 2.3776 2.9401 2.5651 2.77344 2.72656C2.60677 2.88802 2.46615 3.05729 2.35156 3.23438C2.23698 3.40625 2.14844 3.59896 2.08594 3.8125C2.02865 4.02604 2 4.28906 2 4.60156C2 5.10156 2.08073 5.61979 2.24219 6.15625C2.40365 6.6875 2.6276 7.22135 2.91406 7.75781C3.20573 8.29427 3.54948 8.82031 3.94531 9.33594C4.34115 9.85156 4.77083 10.3411 5.23438 10.8047C5.69792 11.263 6.1875 11.6875 6.70312 12.0781C7.22396 12.4688 7.75 12.8073 8.28125 13.0938C8.8125 13.3802 9.34115 13.6042 9.86719 13.7656C10.3932 13.9219 10.8984 14 11.3828 14Z"})),"tasklist-svg":r().createElement("svg",{width:"16",height:"15",viewBox:"0 0 16 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{d:"M6 2H16V3H6V2ZM6 8V7H16V8H6ZM6 13V12H16V13H6ZM2 6C2.27604 6 2.53385 6.05208 2.77344 6.15625C3.01823 6.26042 3.23177 6.40365 3.41406 6.58594C3.59635 6.76823 3.73958 6.98177 3.84375 7.22656C3.94792 7.46615 4 7.72396 4 8C4 8.27604 3.94792 8.53646 3.84375 8.78125C3.73958 9.02083 3.59635 9.23177 3.41406 9.41406C3.23177 9.59635 3.01823 9.73958 2.77344 9.84375C2.53385 9.94792 2.27604 10 2 10C1.72396 10 1.46354 9.94792 1.21875 9.84375C0.979167 9.73958 0.768229 9.59635 0.585938 9.41406C0.403646 9.23177 0.260417 9.02083 0.15625 8.78125C0.0520833 8.53646 0 8.27604 0 8C0 7.72396 0.0520833 7.46615 0.15625 7.22656C0.260417 6.98177 0.403646 6.76823 0.585938 6.58594C0.768229 6.40365 0.979167 6.26042 1.21875 6.15625C1.46354 6.05208 1.72396 6 2 6ZM2 9.125C2.15625 9.125 2.30208 9.09635 2.4375 9.03906C2.57292 8.97656 2.6901 8.89583 2.78906 8.79688C2.89323 8.69271 2.97396 8.57292 3.03125 8.4375C3.09375 8.30208 3.125 8.15625 3.125 8C3.125 7.84375 3.09375 7.69792 3.03125 7.5625C2.97396 7.42708 2.89323 7.3099 2.78906 7.21094C2.6901 7.10677 2.57292 7.02604 2.4375 6.96875C2.30208 6.90625 2.15625 6.875 2 6.875C1.84375 6.875 1.69792 6.90625 1.5625 6.96875C1.42708 7.02604 1.30729 7.10677 1.20312 7.21094C1.10417 7.3099 1.02344 7.42708 0.960938 7.5625C0.903646 7.69792 0.875 7.84375 0.875 8C0.875 8.15625 0.903646 8.30208 0.960938 8.4375C1.02344 8.57292 1.10417 8.69271 1.20312 8.79688C1.30729 8.89583 1.42708 8.97656 1.5625 9.03906C1.69792 9.09635 1.84375 9.125 2 9.125ZM2 11C2.27604 11 2.53385 11.0521 2.77344 11.1562C3.01823 11.2604 3.23177 11.4036 3.41406 11.5859C3.59635 11.7682 3.73958 11.9818 3.84375 12.2266C3.94792 12.4661 4 12.724 4 13C4 13.276 3.94792 13.5365 3.84375 13.7812C3.73958 14.0208 3.59635 14.2318 3.41406 14.4141C3.23177 14.5964 3.01823 14.7396 2.77344 14.8438C2.53385 14.9479 2.27604 15 2 15C1.72396 15 1.46354 14.9479 1.21875 14.8438C0.979167 14.7396 0.768229 14.5964 0.585938 14.4141C0.403646 14.2318 0.260417 14.0208 0.15625 13.7812C0.0520833 13.5365 0 13.276 0 13C0 12.724 0.0520833 12.4661 0.15625 12.2266C0.260417 11.9818 0.403646 11.7682 0.585938 11.5859C0.768229 11.4036 0.979167 11.2604 1.21875 11.1562C1.46354 11.0521 1.72396 11 2 11ZM2 14.125C2.15625 14.125 2.30208 14.0964 2.4375 14.0391C2.57292 13.9766 2.6901 13.8958 2.78906 13.7969C2.89323 13.6927 2.97396 13.5729 3.03125 13.4375C3.09375 13.3021 3.125 13.1562 3.125 13C3.125 12.8438 3.09375 12.6979 3.03125 12.5625C2.97396 12.4271 2.89323 12.3099 2.78906 12.2109C2.6901 12.1068 2.57292 12.026 2.4375 11.9688C2.30208 11.9062 2.15625 11.875 2 11.875C1.84375 11.875 1.69792 11.9062 1.5625 11.9688C1.42708 12.026 1.30729 12.1068 1.20312 12.2109C1.10417 12.3099 1.02344 12.4271 0.960938 12.5625C0.903646 12.6979 0.875 12.8438 0.875 13C0.875 13.1562 0.903646 13.3021 0.960938 13.4375C1.02344 13.5729 1.10417 13.6927 1.20312 13.7969C1.30729 13.8958 1.42708 13.9766 1.5625 14.0391C1.69792 14.0964 1.84375 14.125 2 14.125ZM1.5 2.79688L3.64844 0.648438L4.35156 1.35156L1.5 4.20312L0.148438 2.85156L0.851562 2.14844L1.5 2.79688Z",fill:"#2266E3"})),"bubbleChart-svg":r().createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{d:"M0 16C0 7.16344 7.16344 0 16 0V0C24.8366 0 32 7.16344 32 16V16C32 24.8366 24.8366 32 16 32V32C7.16344 32 0 24.8366 0 16V16Z",fill:"currentColor"}),r().createElement("circle",{cx:"15.5",cy:"18.5",r:"2.5",fill:"white"}),r().createElement("circle",{cx:"20",cy:"12",r:"4",fill:"white"}),r().createElement("circle",{cx:"12.5",cy:"13.5",r:"1.5",fill:"white"}),r().createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.5 8C8.22386 8 8 8.22386 8 8.5V23.5C8 23.7761 8.22386 24 8.5 24L23.5 24C23.7761 24 24 23.7761 24 23.5C24 23.2239 23.7761 23 23.5 23L9 23V8.5C9 8.22386 8.77614 8 8.5 8Z",fill:"white"})),"funnelChart-svg":r().createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{d:"M0 16C0 7.16344 7.16344 0 16 0V0C24.8366 0 32 7.16344 32 16V16C32 24.8366 24.8366 32 16 32V32C7.16344 32 0 24.8366 0 16V16Z",fill:"currentColor"}),r().createElement("path",{d:"M15.3725 25.3966C15.4377 25.7473 15.6976 26 16 26C16.3024 26 16.5623 25.7473 16.6275 25.3966C16.8692 24.0964 17.1722 22.7884 17.521 21.5035C17.5557 21.376 17.4598 21.25 17.3276 21.25L14.6724 21.25C14.5402 21.25 14.4443 21.376 14.479 21.5035C14.8278 22.7884 15.1308 24.0964 15.3725 25.3966Z",fill:"white"}),r().createElement("path",{d:"M14.4372 20.0625C14.2167 20.0625 14.0225 19.918 13.9573 19.7074C13.6604 18.7476 13.3409 17.8098 13.0056 16.9076C12.9324 16.7105 13.0775 16.5 13.2877 16.5L18.7123 16.5C18.9225 16.5 19.0676 16.7105 18.9944 16.9076C18.6591 17.8098 18.3396 18.7476 18.0427 19.7074C17.9775 19.918 17.7833 20.0625 17.5628 20.0625L14.4372 20.0625Z",fill:"white"}),r().createElement("path",{d:"M12.2528 15.0033C12.3313 15.1901 12.5136 15.3125 12.7162 15.3125L19.2838 15.3125C19.4864 15.3125 19.6687 15.1901 19.7472 15.0033C20.1471 14.0522 20.5608 13.159 20.9783 12.3436C21.1164 12.074 20.9226 11.75 20.6197 11.75L11.3803 11.75C11.0774 11.75 10.8836 12.074 11.0217 12.3436C11.4392 13.159 11.8529 14.0522 12.2528 15.0033Z",fill:"white"}),r().createElement("path",{d:"M10.3072 10.5625C10.1334 10.5625 9.97236 10.4719 9.87937 10.325C9.30423 9.4168 8.73867 8.69089 8.20853 8.19911C7.78547 7.80666 8.04873 7 8.61611 7L23.3839 7C23.9513 7 24.2145 7.80666 23.7915 8.19911C23.2613 8.69089 22.6958 9.4168 22.1206 10.325C22.0276 10.4719 21.8666 10.5625 21.6928 10.5625L10.3072 10.5625Z",fill:"white"})),ResetColumns:r().createElement("svg",{viewBox:"0 0 15 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r().createElement("path",{d:"M15 9.5C15 10.099 14.9219 10.6745 14.7656 11.2266C14.6094 11.7786 14.3906 12.2969 14.1094 12.7812C13.8281 13.2604 13.4896 13.6979 13.0938 14.0938C12.6979 14.4896 12.2578 14.8281 11.7734 15.1094C11.2943 15.3906 10.7786 15.6094 10.2266 15.7656C9.67448 15.9219 9.09896 16 8.5 16C7.90104 16 7.32552 15.9219 6.77344 15.7656C6.22135 15.6094 5.70312 15.3906 5.21875 15.1094C4.73958 14.8281 4.30208 14.4896 3.90625 14.0938C3.51042 13.6979 3.17188 13.2604 2.89062 12.7812C2.60938 12.2969 2.39062 11.7786 2.23438 11.2266C2.07812 10.6745 2 10.099 2 9.5V9H3V9.5C3 10.0052 3.0651 10.4922 3.19531 10.9609C3.32552 11.4297 3.51042 11.8672 3.75 12.2734C3.98958 12.6797 4.27604 13.0521 4.60938 13.3906C4.94792 13.724 5.32031 14.0104 5.72656 14.25C6.13281 14.4896 6.57031 14.6745 7.03906 14.8047C7.50781 14.9349 7.99479 15 8.5 15C9.00521 15 9.49219 14.9349 9.96094 14.8047C10.4297 14.6745 10.8672 14.4896 11.2734 14.25C11.6797 14.0104 12.0495 13.724 12.3828 13.3906C12.7214 13.0521 13.0104 12.6797 13.25 12.2734C13.4896 11.8672 13.6745 11.4297 13.8047 10.9609C13.9349 10.4922 14 10.0052 14 9.5C14 8.99479 13.9349 8.50781 13.8047 8.03906C13.6745 7.57031 13.4896 7.13281 13.25 6.72656C13.0104 6.32031 12.7214 5.95052 12.3828 5.61719C12.0495 5.27865 11.6797 4.98958 11.2734 4.75C10.8672 4.51042 10.4297 4.32552 9.96094 4.19531C9.49219 4.0651 9.00521 4 8.5 4H1.95312L4.22656 6.27344L3.52344 6.97656L0.046875 3.5L3.52344 0.0234375L4.22656 0.726562L1.95312 3H8.5C9.09896 3 9.67448 3.07812 10.2266 3.23438C10.7786 3.39062 11.2943 3.60938 11.7734 3.89062C12.2578 4.17188 12.6979 4.51042 13.0938 4.90625C13.4896 5.30208 13.8281 5.74219 14.1094 6.22656C14.3906 6.70573 14.6094 7.22135 14.7656 7.77344C14.9219 8.32552 15 8.90104 15 9.5Z",fill:"currentColor"}))}}},56569:function(e,t,n){"use strict";n.d(t,{p:function(){return o},X:function(){return a}});var i=n(19608),r="data:image/svg+xml,%3Csvg",o=function(e){return(0,i.mergeStyles)(a(e))},a=function(e){var t,n=e?"& "+e:"&";return(t={})[n+"::-webkit-scrollbar"]={width:15,height:15},t[n+"::-webkit-scrollbar-track"]={background:"white"},t[n+"::-webkit-scrollbar-thumb"]={background:"#bebbb8",border:"5.5px solid white",borderRadius:"100px"},t[n+"::-webkit-scrollbar-thumb:hover"]={background:"#605e5c"},t[n+"::-webkit-scrollbar-button:single-button:increment:vertical"]={background:"url('"+r+' width="8" height="4" viewBox="0 0 8 4" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 4L0 0L8 0L4 4Z" fill="rgb(190,187,184)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white',height:15},t[n+"::-webkit-scrollbar-button:single-button:increment:vertical:hover"]={background:"url('"+r+' width="8" height="4" viewBox="0 0 8 4" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 4L0 0L8 0L4 4Z" fill="rgb(96,94,92)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white'},t[n+"::-webkit-scrollbar-button:single-button:increment:horizontal"]={background:"url('"+r+' width="4" height="8" viewBox="0 0 4 8" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 4L0 8L0 0L4 4Z" fill="rgb(190,187,184)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white',width:15},t[n+"::-webkit-scrollbar-button:single-button:increment:horizontal:hover"]={background:"url('"+r+' width="8" height="4" viewBox="0 0 8 4" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 0L8 4H0L4 0Z" fill="rgb(190,187,184)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white',width:15},t[n+"::-webkit-scrollbar-button:single-button:decrement:vertical:hover"]={background:"url('"+r+' width="8" height="4" viewBox="0 0 8 4" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M4 0L8 4H0L4 0Z" fill="rgb(96,94,92)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white'},t[n+"::-webkit-scrollbar-button:single-button:decrement:horizontal"]={background:"url('"+r+' width="4" height="8" viewBox="0 0 4 8" fill="none" xmlns="http://www.w3.org/2000/svg"%3E%3Cpath d="M0 4L4 0L4 8L0 4Z" fill="rgb(96,94,92)"/%3E%3C/svg%3E%0A\')\n            center center no-repeat, no-repeat white'},t}},74872:function(e,t,n){"use strict";n.d(t,{D:function(){return m}});var i=n(49037),r=n(59731),o=n(14594),a=n(31747),s=n(47482),l=n(4547),c=n(11753),d=n(2077),u=n(48945),p=n(4476),m=function(){function e(e,t){var n=this;this.fetchTask=function(e){return Promise.resolve(n.webApi.retrieveRecord("task",e).then((function(e){return e?{key:e.activityid,owner:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],subject:e.subject,description:e.description,friendlyDueDate:e["scheduledend@OData.Community.Display.V1.FormattedValue"],dueDate:null!==e.scheduledend?new Date(e.scheduledend):void 0,duration:null!==e.scheduleddurationminutes?e.scheduleddurationminutes:void 0,prioritycode:e.prioritycode,statecode:e.statecode}:void 0})))},this.fetchRecentOpportunities=function(e){var t='<fetch version="1.0" output-format="xml-platform" mapping="logical" distinct="false" returntotalrecordcount="true" page="1" count="3" no-lock="false">\n        <entity name="opportunity">\n           <order attribute="statecode" descending="false" />\n           <order attribute="estimatedclosedate" descending="true" />\n           <filter type="and">\n              <filter type="or">\n                 <condition attribute="statecode" operator="eq" value="0" />\n                 <filter type="and">\n                    <condition attribute="actualclosedate" operator="last-x-months" value="12" />\n                    <condition attribute="statecode" operator="eq" value="1" />\n                 </filter>\n              </filter>\n           </filter>\n           <attribute name="statecode" />\n           <attribute name="estimatedvalue" />\n           <attribute name="name" />\n           <attribute name="opportunityid" />\n           <order attribute="modifiedon" descending="true" />\n           <link-entity name="account" from="accountid" to="customerid" alias="bb">\n              <filter type="and">\n                 <condition attribute="accountid" operator="eq" uitype="account" value="'+e+'" />\n              </filter>\n           </link-entity>\n        </entity>\n     </fetch>';return Promise.resolve(n.webApi.retrieveMultipleRecords("opportunity","?fetchXml="+t).then((function(e){return e&&e.entities&&e.entities.length>0?e.entities:[]})))},this.fetchTasks=function(e,t){var i="?$filter=_regardingobjectid_value eq "+e+"&$select=subject,description,scheduledend,scheduleddurationminutes,prioritycode,statecode,_ownerid_value&$orderby=modifiedon desc";return Promise.resolve(n.webApi.retrieveMultipleRecords("task",i).then((function(n){return n&&n.entities&&n.entities.length>0?{recordId:e,recordType:t,taskList:n.entities.map((function(e){return{key:e.activityid,owner:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],subject:e.subject,description:e.description,friendlyDueDate:e["scheduledend@OData.Community.Display.V1.FormattedValue"],dueDate:null!==e.scheduledend?new Date(e.scheduledend):void 0,duration:null!==e.scheduleddurationminutes?e.scheduleddurationminutes:void 0,prioritycode:e.prioritycode,statecode:e.statecode}}))}:{recordId:e,recordType:t,taskList:[]}})))},this.createTask=function(e){return n.webApi.createRecord("task",e)},this.updateTask=function(e,t){return n.webApi.updateRecord("task",e,t)},this.deleteTask=function(e){return n.webApi.deleteRecord("task",e)},this.fetchNotes=function(e){var t="?$select=annotationid,subject,modifiedon,notetext,_modifiedby_value,_objectid_value,objectid_opportunity,objectid_contact,objectid_account,objectid_lead,isdocument,mimetype,filename&$filter=_objectid_value eq "+e.entityId+"&$orderby=modifiedon desc";return Promise.resolve(n.webApi.retrieveMultipleRecords("annotation",t).then((function(t){return t&&t.entities&&t.entities.length>0?{recordDetails:e,noteList:t.entities}:{recordDetails:e,noteList:[]}})))},this.fetchNote=function(e){return Promise.resolve(n.webApi.retrieveRecord("annotation",e,"?$select=annotationid,subject,modifiedon,notetext,_modifiedby_value,_objectid_value,objectid_opportunity,objectid_contact,objectid_account,objectid_lead,isdocument,mimetype,filename").then((function(e){return e})))},this.getNoteAttachment=function(e){return Promise.resolve(n.webApi.retrieveRecord("annotation",e,"?$select=documentbody").then((function(e){if("string"==typeof e.documentbody)return e.documentbody;throw new Error("Error in getting 'documentbody' from annotation. 'documentbody' of type "+typeof e.documentbody+" is not the expected type (string).")})))},this.getOrgUploadConstraints=function(){return Promise.resolve(n.webApi.retrieveMultipleRecords("organization","?$select=maxuploadfilesize").then((function(e){if("number"==typeof e.entities[0].maxuploadfilesize)return e.entities[0].maxuploadfilesize;throw new Error("Error in getting maxuploadfilesize from annotation. 'maxuploadfilesize of type "+typeof e.entities[0].maxuploadfilesize+" is not the expected type (Number).")})))},this.getRichTextStatus=function(){return Promise.resolve(n.webApi.retrieveMultipleRecords("organization","?$select=isrichtextnotesenabled").then((function(e){var t=e.entities[0].isrichtextnotesenabled;if(void 0!==!t)return t;throw new Error("Error getting rich text status. Returned: "+typeof t)})))},this.upsertNote=function(e,t){return e?n.webApi.updateRecord("annotation",e,t):n.webApi.createRecord("annotation",t)},this.deleteNote=function(e){return n.webApi.deleteRecord("annotation",e)},this.fetchActivities=function(e,t){var i="?$filter=_regardingobjectid_value eq "+e+" and (activitytypecode eq 'appointment' or activitytypecode eq 'phonecall' or activitytypecode eq 'email')"+(t?" and activityid eq "+t:"")+"&$select=subject&$orderby=createdon desc&$expand=activity_pointer_phonecall($select=actualdurationminutes,directioncode),activity_pointer_appointment($select=location,scheduledstart),activity_pointer_email($select=directioncode,description),activitypointer_activity_parties($filter=(participationtypemask eq 1 or participationtypemask eq 2 or participationtypemask eq 5 or participationtypemask eq 6);$select=participationtypemask,_partyid_value)";return Promise.resolve(n.webApi.retrieveMultipleRecords("activitypointer",i).then((function(t){return t&&t.entities&&t.entities.length>0?{recordId:e,activityList:t.entities.map((function(e){return d.g.createActivityByType(e)}))}:{recordId:e,activityList:[]}})))},this.fetchSystemForm=function(e,t){return(0,i.mG)(n,void 0,Promise,(function(){var n,r;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return[4,this.webApi.retrieveRecord("systemform",t,"?$select=formxml")];case 1:if(n=i.sent(),null===(r=o.V.parseFormXml(e,n.formxml)))throw new Error("failed to parse formXml (entity: "+e+", formId: "+t);return[2,r]}}))}))},this.fetchEntityMetadata=function(e,t){return(0,i.mG)(n,void 0,Promise,(function(){return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.recordContainerContext.metadataProvider.getEntityMetadata(e,t)];case 1:return[2,n.sent()]}}))}))},this.fetchEntityRecord=function(e,t,r){return(0,i.mG)(n,void 0,Promise,(function(){var n;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:return n=s.ZH.getRequiredAttributes(e).concat(r),[4,this.recordContainerContext.dataProvider.retrieveRecord(e,t,n)];case 1:return[2,i.sent()]}}))}))},this.fetchProcessInstance=function(e){var t,i=new l.L(e.entityId,null===(t=e.entityType)||void 0===t?void 0:t.toLowerCase());return Promise.resolve(n.webApi.execute(i).then((function(e){return e.json().then((function(e){if(e&&e.value&&e.value.length>0)return e.value[0]}))})))},this.fetchProcessActivePath=function(e){var t=new c.J(e);return Promise.resolve(n.webApi.execute(t).then((function(e){return e.json().then((function(t){return t&&e.ok?t:void 0}))})))},this.fetchProcessUniqueName=function(e){return a.$.get({key:e,cachingKeyUniquePrefix:r.as.Fetch_Process_Unique_Name,expiryTimeInMinutes:0,storageType:r.Z1.LOCAL_STORAGE,cacheRefreshInSync:!1,fetchAPI:function(){return Promise.resolve(n.webApi.retrieveRecord("workflow",e,"?$select=uniquename").then((function(e){return e.uniquename})))}})},this.updateProcessInstance=function(e,t,i){return Promise.resolve(n.webApi.updateRecord(e,t,i).then((function(e){return e})).catch((function(e){return u.D.reportError("updateProcessInstance","dataService","Error occured updating process instance",{error:e.toString()}),e})))},this.createDataSetRecord=function(e,t,i,r){var o;return null===(o=n.recordContainerContext)||void 0===o?void 0:o.datasetRecordProvider.buildDataSetRecord(e,t,i,r)},this.webApi=e.webAPI,this.recordContainerContext=t||p._.getContainerContext(e)}return e.prototype.getFormJson=function(){return this.formJson},e}()},11753:function(e,t,n){"use strict";n.d(t,{J:function(){return r}});var i=n(4547),r=function(){function e(e){this.ProcessInstanceId=new i.i(e)}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{ProcessInstanceId:{typeName:"Edm.Guid",structuralProperty:1}},operationType:1,operationName:"RetrieveActivePath"}},e}()},4547:function(e,t,n){"use strict";n.d(t,{i:function(){return i},L:function(){return r}});var i=function(e){this.guid=e},r=function(){function e(e,t){this.EntityId=new i(e),this.EntityLogicalName=t}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationType:1,operationName:"RetrieveProcessInstances"}},e}()},26747:function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var i=n(63804),r=n.n(i),o=function(e){var t=r().useRef(null);return r().useEffect((function(){var n,i="MscrmSalesDealManager.Collab",r={descriptor:{Parameters:{showTitle:!1},Id:i,DomId:i,Disabled:!1,Label:"",ShowLabel:!1,Name:i,Visible:!0},parameters:{primaryEntityId:{Static:!0,Primary:!1,Type:"SingleLine.Text",Value:null===(n=e.entity)||void 0===n?void 0:n.entityId,Usage:1}},childeventlisteners:[]},o=e.context.factory.createComponent(i,i,r);e.context.factory.bindDOMComponent(o,t.current)}),[e.context,e.entity]),r().createElement("div",{ref:t})}},38790:function(e,t,n){"use strict";n.d(t,{P:function(){return u}});var i=n(63804),r=n.n(i),o=n(70803),a=n(92165),s=n(48945),l=n(2077),c=n(10348),d=n(2257),u=function(e){var t=e.onActivityAdded,n=r().useState(!1),u=n[0],p=n[1],m=(0,i.useState)(1e3)[0],h=function(n){var i,r,a,s,c,d,u,m,h,g;e.datasetRecord&&(n===o.mh.Email?(null===(i=window.MscrmControls)||void 0===i||i.Sales.DealManager.WrapperContainer.executeWorkspaceCommand({command:"openEmail",entityId:e.entity.entityId,entityType:e.entity.entityType,entityName:e.datasetRecord.formattedValues.get("name"),emailParameters:{to:[{id:null===(r=e.datasetRecord.values.get("parentcontactid"))||void 0===r?void 0:r.id,entityType:null===(a=e.datasetRecord.values.get("parentcontactid"))||void 0===a?void 0:a.entityLogicalName,name:null===(s=e.datasetRecord.values.get("parentcontactid"))||void 0===s?void 0:s.displayName}]}}),p(!0)):l.g.OpenQuickCreateActivity(e.context,e.services.dataService,n,e.datasetRecord.recordId,e.datasetRecord.formattedValues.get("name")||"",e.entity.entityType,{to:[{id:null===(c=e.datasetRecord.values.get("parentaccountid"))||void 0===c?void 0:c.id,entityType:null===(d=e.datasetRecord.values.get("parentaccountid"))||void 0===d?void 0:d.entityLogicalName,name:null===(u=e.datasetRecord.values.get("parentaccountid"))||void 0===u?void 0:u.displayName}],requiredattendees:[{id:null===(m=e.datasetRecord.values.get("parentaccountid"))||void 0===m?void 0:m.id,entityType:null===(h=e.datasetRecord.values.get("parentaccountid"))||void 0===h?void 0:h.entityLogicalName,name:null===(g=e.datasetRecord.values.get("parentaccountid"))||void 0===g?void 0:g.displayName}]}).then((function(e){e&&t(e)})))},g=[{key:"newItem",text:s.D.getLocalizedString("Activities_Header_NewActivity"),cacheKey:"theCacheKey",iconProps:{iconName:"Add"},subMenuProps:{items:[{key:"appointmenetEvent",text:s.D.getLocalizedString("Activities_Header_NewAppointment"),iconProps:{iconName:"DateTime2"},onClick:function(){h(o.mh.Appointment)}},{key:"emailEvent",text:s.D.getLocalizedString("Activities_Header_NewEmail"),iconProps:{iconName:"Mail"},onClick:function(){h(o.mh.Email)}},{key:"callEvent",text:s.D.getLocalizedString("Activities_Header_NewPhonecall"),iconProps:{iconName:"Phone"},onClick:function(){h(o.mh.PhoneCall)}}]}}];return(0,c.Y)((function(){0==document.getElementsByClassName("jsPanel").length>0&&(t(null),p(!1))}),u?m:null),r().createElement(a.CommandBar,{styles:d.s,items:g,ariaLabel:s.D.getLocalizedString("Activities_Header_HelpText")})}},2257:function(e,t,n){"use strict";n.d(t,{s:function(){return i}});var i={root:{padding:"0px",height:32}}},952:function(e,t,n){"use strict";n.d(t,{Mc:function(){return l},CJ:function(){return c},bq:function(){return d},c:function(){return m}});var i,r=n(49037),o=n(19608),a=n(17754).rQ.palette.neutralSecondary,s=((i={})["& .inputFieldDiv"]={flexGrow:1,width:"100%"},i["& .fieldControlDiv"]={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",flexGrow:8,flexBasis:"0%",margin:"10px 0 12px 0"},i),l=(0,o.mergeStyles)((0,r.pi)({width:134},s)),c=(0,o.mergeStyles)((0,r.pi)({},s)),d=(0,o.mergeStyles)({display:"flex"}),u=(0,o.mergeStyles)({fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"16px",color:a,fontWeight:600}),p=(0,o.mergeStyles)({fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"20px",color:a,marginBottom:"8px"}),m=function(e){return"parentcontactid"===e?p:u}},84801:function(e,t,n){"use strict";n.d(t,{b:function(){return p}});var i=n(63804),r=n(59731),o=n(17875),a=n(97563),s=n(4476),l=n(47482),c=n(48945),d=n(73186),u=n(952),p=function(e){var t=e.attributesMetadata,n=e.cell,p=e.context,m=e.datasetRecord,h=e.entityMetadata,g=e.recordContainerContext,f=e.viewEventHandlers,y=e.services,v=n.datafieldName,C=n.labelDescription,S=n.showLabel,E=i.useCallback((function(e,t){var n;t===r.py.Account||t===r.py.Contact||t===r.py.Lead||t===r.py.Opportunity?null===(n=null==f?void 0:f.onOpenView)||void 0===n||n.call(f,{entityId:e,entityType:t},r.wO.Default):c.D.openEntityInMFD(t.toString().toLowerCase(),e,(function(){d.f.reload()}))}),[f]),b=null==t?void 0:t.get(v);return i.createElement("div",{className:"icv-section-row-cell "+u.Mc},i.createElement(a.J,{recordContainerContext:g||s._.getContainerContext(p),entityData:h,fieldData:b,dataSetRecordEntityMetaData:h,dataSetRecord:m,showLabel:S,customProps:{displayName:C,textStyles:o.l.getFieldTextStyle(null==b?void 0:b.dataType),showAdditionalPersonaDetails:!0},callbackHandlers:{openEntity:E,updateRecord:function(e){var t;return null===(t=null==f?void 0:f.updateRecord)||void 0===t?void 0:t.call(f,e)},isChannelIntegrationFrameworkSupported:function(){return c.D.isChannelIntegrationFrameworkSupported()}},attributesMetadata:t,columns:l.ZH.getColumnsFromAttributeMetadata(t),webAPI:p.webAPI,dataService:y.dataService}))}},88818:function(e,t,n){"use strict";n.d(t,{S:function(){return v}});var i=n(49037),r=n(63804),o=n.n(r),a=n(59731),s=n(70803),l=n(14594),c=n(75154),d=n(99491),u=n(48945),p=n(28741),m=n(17217),h=n(52618),g=n(73186),f=n(84718),y="COLAEntityView",v=function(e){function t(t){var n,i,r=e.call(this,t)||this;return r.state={activities:{recordId:r.props.entity.entityId,activityList:[]},tasks:{recordId:r.props.entity.entityId,recordType:r.props.entity.entityType,taskList:[]},notes:{recordDetails:r.props.entity,noteList:[]},recentOpportunities:[]},null===(i=null===(n=r.props.viewEventHandlers)||void 0===n?void 0:n.registerCommands)||void 0===i||i.call(n,r.getNavCommands()),r.props.inContextViewEventHandlers&&r.props.inContextViewEventHandlers.refreshRecordHandler&&r.props.inContextViewEventHandlers.refreshRecordHandler(r.refreshRecord.bind(r)),r.fetchInitialData(),r}return(0,i.ZT)(t,e),t.prototype.componentDidMount=function(){},t.prototype.render=function(){return this.state.formXml&&(this.state.entityRecord&&this.state.entityMetadata?this.state.datasetrecord||this.createDatasetRecord(this.state.entityMetadata,this.state.attributesMetadata,this.state.entityRecord):(this.state.entityMetadata||this.fetchEntityMetadata(),this.state.entityRecord||this.fetchEntity())),this.getView()},t.prototype.getView=function(){var e;u.D.reportInfo("render",y,"Entity data is fetched",{});var t=(0,i.pi)((0,i.pi)({},this.props),{formXml:this.state.formXml||{},datasetRecord:this.state.datasetrecord,activities:this.state.activities,onActivityAdded:this.onActivityAdded.bind(this),onTaskAdded:this.onTaskAdded.bind(this),tasks:this.state.tasks,notes:this.state.notes,recentOpportunities:this.state.recentOpportunities}),n=(0,i.pi)((0,i.pi)({},this.props),{tabs:(null===(e=this.state.formXml)||void 0===e?void 0:e.tabs)||[],entityMetadata:this.state.entityMetadata,attributesMetadata:this.state.attributesMetadata,datasetRecord:this.state.datasetrecord,activities:this.state.activities,tasks:this.state.tasks,onTaskAdded:this.onTaskAdded.bind(this),onActivityAdded:this.onActivityAdded.bind(this),notes:this.state.notes,recentOpportunities:this.state.recentOpportunities,viewEventHandlers:(0,i.pi)((0,i.pi)({},this.props.viewEventHandlers),{updateRecord:this.updateRecord.bind(this)})});return u.D.scenarioEnd(p.BG.openInContextView),o().createElement("div",{className:"icv-view-content-container"},o().createElement(d.h,(0,i.pi)({},t)),o().createElement(c.t,(0,i.pi)({},n)))},t.prototype.fetchInitialData=function(){this.loadFormXml(),this.loadActivities(),this.loadTasks(),this.loadNotes(),this.props.entity.entityType==a.py.Account&&this.loadRecentOpportunities()},t.prototype.loadFormXml=function(){var e=this,t=this.props.overrideSystemForms&&this.props.overrideSystemForms[this.props.entity.entityType]||l.V.getSystemFormIdByEntityType(this.props.entity.entityType);this.props.services.dataService.fetchSystemForm(this.props.entity.entityType,t).then((function(n){u.D.reportInfo("fetchInitialData-fetchSystemForm",y,h.dS.SUCCESS,{entityType:e.props.entity.entityType,formId:t}),e.setState({formXml:n})})).catch((function(n){var i,r;u.D.reportError("fetchInitialData-fetchSystemForm",y,h.dS.FAILED,{error:n,entityType:e.props.entity.entityType,formId:t}),null===(r=null===(i=e.props.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===r||r.call(i,u.D.getLocalizedString("ICV_Error_Message"))}))},t.prototype.updateViewTitle=function(){var e,t;this.state.entityMetadata&&(null===(t=null===(e=this.props.viewEventHandlers)||void 0===e?void 0:e.setViewTitle)||void 0===t||t.call(e,this.state.entityMetadata.displayName))},t.prototype.loadNotes=function(){var e=this;this.props.services.dataService.fetchNotes(this.props.entity).then((function(t){u.D.reportInfo("fetchInitialData-fetchNotes",y,h.dS.SUCCESS,{entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),t&&e.setState({notes:t})})).catch((function(t){var n,i;u.D.reportError("fetchInitialData-fetchNotes",y,h.dS.FAILED,{error:t,entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),null===(i=null===(n=e.props.viewEventHandlers)||void 0===n?void 0:n.openErrorView)||void 0===i||i.call(n,u.D.getLocalizedString("ICV_Error_Message"))}))},t.prototype.loadRecentOpportunities=function(){var e=this;this.props.services.dataService.fetchRecentOpportunities(this.props.entity.entityId).then((function(t){u.D.reportInfo("fetchInitialData-fetchRecentOpportunities",y,h.dS.SUCCESS,{entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),t&&e.setState({recentOpportunities:t})})).catch((function(t){var n,i;u.D.reportError("fetchInitialData-fetchRecentOpportunities",y,h.dS.FAILED,{error:t,entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),null===(i=null===(n=e.props.viewEventHandlers)||void 0===n?void 0:n.openErrorView)||void 0===i||i.call(n,u.D.getLocalizedString("ICV_Error_Message"))}))},t.prototype.loadTasks=function(){var e=this;this.props.services.dataService.fetchTasks(this.props.entity.entityId,this.props.entity.entityType).then((function(t){u.D.reportInfo("fetchInitialData-fetchTasks",y,h.dS.SUCCESS,{entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),t&&e.setState({tasks:t})})).catch((function(t){var n,i;u.D.reportError("fetchInitialData-fetchTasks",y,h.dS.FAILED,{error:t,entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),null===(i=null===(n=e.props.viewEventHandlers)||void 0===n?void 0:n.openErrorView)||void 0===i||i.call(n,u.D.getLocalizedString("ICV_Error_Message"))}))},t.prototype.loadActivities=function(){var e=this;this.props.services.dataService.fetchActivities(this.props.entity.entityId).then((function(t){u.D.reportInfo("fetchInitialData-fetchActivities",y,h.dS.SUCCESS,{entityId:e.props.entity.entityId,entityType:e.props.entity.entityType,activitiesCount:t.activityList.length,upcomingAppointmentsCount:t.activityList.filter((function(e){return e.activitytypecode===s.mh.Appointment&&e.isUpcoming})).length}),t&&e.setState({activities:t})})).catch((function(t){var n,i;u.D.reportError("fetchInitialData-fetchActivities",y,h.dS.FAILED,{error:t,entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),null===(i=null===(n=e.props.viewEventHandlers)||void 0===n?void 0:n.openErrorView)||void 0===i||i.call(n,u.D.getLocalizedString("ICV_Error_Message"))}))},t.prototype.fetchEntity=function(){var e,t,n=this;null===(t=this.props.services.dataService.fetchEntityRecord(this.props.entity.entityType,this.props.entity.entityId,(null===(e=this.state.formXml)||void 0===e?void 0:e.dataFields)||[]))||void 0===t||t.then((function(e){var t;u.D.reportInfo("fetchRecordSidePanelData-fetchEntityRecord",y,h.dS.SUCCESS,{entityId:n.props.entity.entityId,entityType:n.props.entity.entityType,dataFields:(null===(t=n.state.formXml)||void 0===t?void 0:t.dataFields)||[]}),e&&n.setState({entityRecord:e})})).catch((function(e){var t,i,r;u.D.reportError("fetchRecordSidePanelData-fetchEntityRecord",y,h.dS.FAILED,{error:e,entityId:n.props.entity.entityId,entityType:n.props.entity.entityType,dataFields:(null===(t=n.state.formXml)||void 0===t?void 0:t.dataFields)||[]}),null===(r=null===(i=n.props.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===r||r.call(i,u.D.getLocalizedString("ICV_Error_Message"))}))},t.prototype.fetchEntityMetadata=function(){var e,t=this;this.state.attributesMetadata||this.props.services.dataService.fetchEntityMetadata(this.props.entity.entityType,(null===(e=this.state.formXml)||void 0===e?void 0:e.dataFields)||[]).then((function(e){var n,r;if(u.D.reportInfo("fetchRecordSidePanelData-fetchEntityMetadata",y,h.dS.SUCCESS,{entityId:t.props.entity.entityId,entityType:t.props.entity.entityType,dataFields:(null===(n=t.state.formXml)||void 0===n?void 0:n.dataFields)||[]}),e){var o=e[0],a=e[1];null===(r=t.state.formXml)||void 0===r||r.dataFields.forEach((function(e,n){var r;if(!0===(null===(r=t.state.formXml)||void 0===r?void 0:r.dataFieldsIsReadOnly[n])){var o=a.get(e);if(o){var s=(0,i.pi)((0,i.pi)({},o),{validForUpdate:!1});a.set(e,s)}}})),t.setState({entityMetadata:o,attributesMetadata:a},t.updateViewTitle)}})).catch((function(e){var n,i,r;u.D.reportError("fetchRecordSidePanelData-fetchEntityMetadata",y,h.dS.FAILED,{error:e,entityId:t.props.entity.entityId,entityType:t.props.entity.entityType,dataFields:(null===(n=t.state.formXml)||void 0===n?void 0:n.dataFields)||[]}),null===(r=null===(i=t.props.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===r||r.call(i,u.D.getLocalizedString("ICV_Error_Message"))}))},t.prototype.createDatasetRecord=function(e,t,n){var i=this.props.services.dataService.createDataSetRecord(e,t,n,this.buildRecordUpdateHandler.bind(this));this.setState({datasetrecord:i})},t.prototype.onTaskAdded=function(e){if(e){var t=(0,i.pi)({},this.state.tasks);t.taskList.unshift(e),this.setState({tasks:t})}else this.loadTasks()},t.prototype.onActivityAdded=function(e){if(e){var t=(0,i.pi)({},this.state.activities);t.activityList=(0,i.pr)([e],t.activityList),this.setState({activities:t})}else this.loadActivities()},t.prototype.updateRecord=function(e){this.setState({datasetrecord:e})},t.prototype.refreshRecord=function(e){var t,n=this;this.state&&this.state.entityRecord&&(e==this.state.entityRecord.recordId||f.StringUtil.IsNullOrEmpty(e))&&this.state.entityMetadata&&this.props.services.dataService.fetchEntityRecord(this.props.entity.entityType,this.props.entity.entityId,(null===(t=this.state.formXml)||void 0===t?void 0:t.dataFields)||[]).then((function(e){if(u.D.reportInfo("refreshRecord-fetchEntityRecord",y,h.dS.SUCCESS,{entityId:n.props.entity.entityId,entityType:n.props.entity.entityType}),e){var t=n.props.services.dataService.createDataSetRecord(n.state.entityMetadata,n.state.attributesMetadata,e,n.buildRecordUpdateHandler.bind(n));n.setState({entityRecord:e,datasetrecord:t})}})).catch((function(e){var t,i;u.D.reportError("refreshRecord-fetchEntityRecord",y,h.dS.FAILED,{error:e,entityId:n.props.entity.entityId,entityType:n.props.entity.entityType}),null===(i=null===(t=n.props.viewEventHandlers)||void 0===t?void 0:t.openErrorView)||void 0===i||i.call(t,u.D.getLocalizedString("ICV_Error_Message"))}))},t.prototype.buildRecordUpdateHandler=function(e){if(e&&e.dataSetRecord){var t=e.dataSetRecord;0!==e.updateType&&this.setState({datasetrecord:t}),3!=e.updateType&&6!=e.updateType||this.props.inContextViewEventHandlers&&this.props.inContextViewEventHandlers.onRecordUpdate&&this.props.inContextViewEventHandlers.onRecordUpdate(t)}},t.prototype.getNavCommands=function(){return[this.getGoToRecordCommand()]},t.prototype.getGoToRecordCommand=function(){var e=this;return{toolTipContent:u.D.getLocalizedString("ICV_GoToRecord"),iconProps:m.P.goToIcon,ariaLabel:u.D.getLocalizedString("ICV_GoToRecord"),commandAction:function(){u.D.openEntityInMFD(e.props.entity.entityType.toString().toLowerCase(),e.props.entity.entityId,(function(){g.f.reload(),e.refreshRecord(e.props.entity.entityId)}))}}},t}(o().Component)},28560:function(e,t,n){"use strict";n.d(t,{Sl:function(){return s},jB:function(){return l},ic:function(){return c},B0:function(){return d},YK:function(){return u},F2:function(){return p},Xh:function(){return m},ot:function(){return h}});var i=n(19608),r=n(17754).rQ.palette,o=r.neutralPrimary,a=r.neutralSecondary,s=(0,i.mergeStyles)({display:"flex",flexDirection:"column",padding:20,paddingBottom:0}),l=(0,i.mergeStyles)({display:"flex",flexDirection:"row"}),c=(0,i.mergeStyles)({width:48,marginRight:12}),d=(0,i.mergeStyles)({height:48,display:"flex",flexDirection:"column",width:"calc(100% - 60px)"}),u=(0,i.mergeStyles)({fontSize:18,lineHeight:24,fontWeight:600,textOverflow:"ellipsis",overflowWrap:"break-word",wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",color:o}),p=(0,i.mergeStyles)({fontSize:14,lineHeight:20,textOverflow:"ellipsis",overflowWrap:"break-word",wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",color:a}),m=({color:o,cursor:"pointer",textDecoration:"none"}["&:hover"]={color:o,textDecoration:"underline"},(0,i.mergeStyles)({display:"flex",margin:"16px 0 8px 0"})),h=(0,i.mergeStyles)({padding:"8px"})},99491:function(e,t,n){"use strict";n.d(t,{h:function(){return E}});var i=n(49037),r=n(63804),o=n(59731),a=n(87018),s=n(4846),l=n(17217),c=n(42093),d=n(48945),u=n(52618),p=n(38790),m=n(19608),h=n(97369),g=n(35531),f=n(28741),y=n(28560),v=((0,m.mergeStyleSets)({root:{padding:"22px"}}),{gapSpace:0}),C="Header",S=window.location.href,E=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isCollaborationEnabled:n.isCollaborationFeatureEnabled()},n}return(0,i.ZT)(t,e),t.prototype.render=function(){if(d.D.reportInfo("render",C,"",{id:this.props.entity.entityId,type:this.props.entity.entityType}),null!=window.forceEnableCollaboration&&0!=window.forceEnableCollaboration&&this.enableCollaborationFeature(),this.state.isCollaborationEnabled!=this.isCollaborationFeatureEnabled()){var e=this.isCollaborationFeatureEnabled();this.setState({isCollaborationEnabled:e})}return this.getHeader()},t.prototype.getHeader=function(){var e,t="",n="";return this.props.datasetRecord&&this.props.formXml&&this.props.formXml.header&&(this.props.formXml&&this.props.formXml.header&&this.props.formXml.header.length>2&&(t=this.props.datasetRecord.formattedValues.get(this.props.formXml.header[1].datafieldName)||"",n=this.props.datasetRecord.formattedValues.get(this.props.formXml.header[2].datafieldName)||""),e={imageUrl:this.getEntityImageUrl(this.props.entity.entityType,this.props.entity.entityId),imageInitials:this.getEntityInitials(this.props.datasetRecord.formattedValues.get(this.props.formXml.header[0].datafieldName)||"")}),r.createElement("div",{className:"icv-header-container "+y.Sl},r.createElement(g.Shimmer,{customElementsGroup:h.W.getPersonaShimmer(),isDataLoaded:e&&(""!=t||""!=n||null!=e.imageUrl||null!=e.imageInitials)},r.createElement("div",{className:"icv-header-personaContainer "+y.jB},r.createElement(s.Persona,(0,i.pi)({},e,{size:s.PersonaSize.size48,className:"icv-header-personaIcon "+y.ic,imageAlt:d.D.getLocalizedString("ICV_Persona_Icon")})),this.props.formXml&&this.props.formXml.header&&this.getPersonaText(t,n))),this.getIconBar())},t.prototype.getEntityInitials=function(e){var t=e.split(" ");return t[1]?(t[0].charAt(0)+t[1].charAt(0)).toUpperCase():(t[0].charAt(0)+t[0].charAt(1)).toUpperCase()},t.prototype.getEntityImageUrl=function(e,t){var n;if(e==o.py.Contact||e==o.py.Account)return"./Image/download.aspx?Entity="+e+"&Attribute=entityimage&Id="+t;if(e==o.py.Opportunity){var i=(null===(n=this.props.datasetRecord)||void 0===n?void 0:n.formattedValues.get(this.props.formXml.header[0].datafieldName))||"";if(i)return"./Image/download.aspx?Entity="+o.py.Account+"&Attribute=entityimage&Id="+i}return""},t.prototype.getPersonaText=function(e,t){var n,i=this,o=null===(n=this.props.datasetRecord)||void 0===n?void 0:n.values.get(this.props.formXml.header[2].datafieldName),a=(null==o?void 0:o.entityLogicalName)||"",s=(null==o?void 0:o.id)||"";return r.createElement("div",{className:"icv-header-personaText "+y.B0},r.createElement("label",{className:"icv-header-primaryText "+y.YK,title:e},e),!a&&r.createElement("label",{className:"icv-header-secondaryText "+y.F2},t),a&&r.createElement("label",{className:"icv-header-secondaryText "+y.F2,onClick:function(){return i.openEntity(a,s)},title:t},t))},t.prototype.openEntity=function(e,t){var n,i;d.D.reportUserAction("openEntity",C,"Open record clicked",{type:e,id:t},u.EJ.CLICK,"Header subtitle clicked");var r=this.getEntityType(e);r?null===(i=null===(n=this.props.viewEventHandlers)||void 0===n?void 0:n.onOpenView)||void 0===i||i.call(n,{entityType:r,entityId:t},o.wO.Default):d.D.openEntityInMFD(e,t)},t.prototype.getEntityType=function(e){switch(e.toLowerCase()){case"account":return o.py.Account;case"contact":return o.py.Contact;case"opportunity":return o.py.Opportunity;case"lead":return o.py.Lead;default:return null}},t.prototype.getIconBar=function(){var e=this;return r.createElement("div",{className:"icv-header-reflowContainer "+y.Xh},r.createElement("div",{style:{width:"auto"}},r.createElement(p.P,(0,i.pi)({},this.props))),this.state.isCollaborationEnabled&&r.createElement("div",{style:{width:"auto"}},r.createElement(c.TooltipHost,{content:d.D.getLocalizedString("ICV_View_Chats"),calloutProps:v,directionalHint:c.DirectionalHint.bottomCenter},r.createElement(a.IconButton,{id:f.gT.openCollabButtonKey,iconProps:l.P.officeChat,className:"icv-header-iconStyle "+y.ot,ariaLabel:d.D.getLocalizedString("ICV_Chat"),onClick:function(){var t,n;d.D.reportUserAction("getIconBar",C,"Open chat clicked",{},u.EJ.CLICK,"Chat icon clicked"),null===(n=null===(t=e.props.viewEventHandlers)||void 0===t?void 0:t.onOpenView)||void 0===n||n.call(t,{entityId:e.props.entity.entityId,entityType:o.py.Chat},o.wO.Chat,e.props.relatedEntity||e.props.entity,null,f.gT.openCollabButtonKey)}}))),r.createElement("div",{style:{width:"auto"}},r.createElement(c.TooltipHost,{content:d.D.getLocalizedString("ICV_View_Notes"),calloutProps:v,directionalHint:c.DirectionalHint.bottomCenter},r.createElement(a.IconButton,{id:f.gT.openNotesButtonKey,iconProps:l.P.notes,className:"icv-header-iconStyle "+y.ot,ariaLabel:d.D.getLocalizedString("ICV_Notes"),onClick:function(){var t,n,i,r;d.D.reportUserAction("getIconBar",C,"Open Notes clicked",{count:(null===(n=null===(t=e.props.notes)||void 0===t?void 0:t.noteList)||void 0===n?void 0:n.length)||0},u.EJ.CLICK,"Notes icon clicked"),e.props.viewEventHandlers&&(null===(r=(i=e.props.viewEventHandlers).onOpenView)||void 0===r||r.call(i,{entityId:"",entityType:o.py.Note},o.wO.List,e.props.relatedEntity||e.props.entity,null,f.gT.openNotesButtonKey))}}))),r.createElement("div",{style:{width:"auto"}},r.createElement(c.TooltipHost,{content:d.D.getLocalizedString("ICV_View_Tasks"),calloutProps:v,directionalHint:c.DirectionalHint.bottomCenter},r.createElement(a.IconButton,{id:f.gT.openTasksButtonKey,iconProps:l.P.taskList,className:"icv-header-iconStyle "+y.ot,ariaLabel:d.D.getLocalizedString("ICV_Tasks"),onClick:function(){var t,n,i,r;d.D.reportUserAction("getIconBar",C,"Open tasks clicked",{count:(null===(n=null===(t=e.props.tasks)||void 0===t?void 0:t.taskList)||void 0===n?void 0:n.length)||0},u.EJ.CLICK,"Tasks icon clicked"),e.props.viewEventHandlers&&(null===(r=(i=e.props.viewEventHandlers).onOpenView)||void 0===r||r.call(i,{entityId:"",entityType:o.py.Task},o.wO.List,e.props.relatedEntity||e.props.entity,e.props.tasks,f.gT.openTasksButtonKey))}}))))},t.prototype.enableCollaborationFeature=function(){if(!this.isCollaborationFeatureEnabled()){var e=S.match("([?&]flags=([^&]+).*)[&]?$"),t=S;if(e){var n=e[0];t=S.replace(n,"")}window.location.assign(t+"&flags=FCB.EmbeddedCollaboration%3Dtrue"),this.setState({isCollaborationEnabled:!0})}},t.prototype.isCollaborationFeatureEnabled=function(){return void 0!==window.Xrm&&Boolean(Xrm.Internal.isFeatureEnabled("EmbeddedCollaboration"))},t}(r.Component)},83038:function(e,t,n){"use strict";n.d(t,{L:function(){return i}});var i=(0,n(19608).mergeStyles)({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"})},94340:function(e,t,n){"use strict";n.d(t,{X:function(){return l}});var i=n(49037),r=n(63804),o=n.n(r),a=n(84801),s=n(83038),l=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this;return o().createElement("div",{className:"icv-section-row "+s.L},this.props.row.cells&&this.props.row.cells.map((function(t){var n=(0,i.pi)((0,i.pi)({},e.props),{cell:t});return o().createElement(a.b,(0,i.pi)({},n,{key:n.cell.datafieldName}))})))},t}(o().Component)},80954:function(e,t,n){"use strict";n.d(t,{XJ:function(){return o},tR:function(){return a},kB:function(){return s}});var i=n(19608),r=n(17754).rQ.palette.neutralSecondary,o=(0,i.mergeStyles)({margin:"20px 0 0 0"}),a=(0,i.mergeStyles)({display:"flex",flexDirection:"row",paddingBottom:2,margin:"0 20px"}),s={fontSize:"12px",color:r,margin:"0 4px 0 0"}},6443:function(e,t,n){"use strict";n.d(t,{$:function(){return m}});var i=n(49037),r=n(63804),o=n.n(r),a=n(17217),s=n(6401),l=n(48945),c=n(52618),d=n(87018),u=n(80954),p="Section",m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isCollapsed:n.props.isCollapsed,commands:[]},n}return(0,i.ZT)(t,e),t.prototype.render=function(){return l.D.reportInfo("render",p,"",{section:this.props.section.key.toLowerCase()}),o().createElement("div",{className:"icv-section-container "+u.XJ},o().createElement("div",{className:"icv-section-header "+u.tR},o().createElement(d.ActionButton,{iconProps:{iconName:this.state.isCollapsed?a.P.chevronRight.iconName:a.P.chevronDown.iconName},ariaLabel:l.D.getLocalizedString("ICV_CollapseExpand",this.props.section.labelDescription),styles:{root:{width:"100%",padding:0,height:"32px"},rootHovered:{backgroundColor:"white"},rootPressed:{backgroundColor:"white"},icon:u.kB,iconHovered:{color:"#605E5C"},label:{color:"#323130",fontWeight:this.state.isCollapsed?400:600,fontSize:"14px",lineHeight:"20px"},flexContainer:{float:"left"}},onClick:this.setExpandCollapse.bind(this)},this.props.section.showLabel&&this.props.section.labelDescription),this.state.commands.length>0&&this.getCommands()),!this.state.isCollapsed&&s.P.getSectionView((0,i.pi)({},(0,i.pi)((0,i.pi)({},this.props),{registerCommands:this.registerCommands.bind(this)}))))},t.prototype.registerCommands=function(e){this.setState({commands:e})},t.prototype.getCommands=function(){return o().createElement("div",null,this.state.commands.map((function(e){return s.P.getNavigationCommand(e)})))},t.prototype.setExpandCollapse=function(){l.D.reportUserAction("setExpandCollapse",p,"Expand collapse clicked",{status:!this.state.isCollapsed,section:this.props.section.key.toLowerCase()},c.EJ.CLICK,"Expand or Collapse Icon"),this.setState({isCollapsed:!this.state.isCollapsed})},t}(o().Component)},88239:function(e,t,n){"use strict";n.d(t,{K:function(){return c}});var i=n(63804),r=n.n(i),o=n(59731),a=n(48945),s=n(21259),l=n(4432),c=function(e){return r().createElement("div",null,r().createElement(s.ActionButton,{className:"icv-showmore-button",styles:{rootHovered:{color:l.I.digitalBlue}},onClick:function(){var t,n;null===(n=null===(t=e.viewEventHandlers)||void 0===t?void 0:t.onOpenView)||void 0===n||n.call(t,{entityId:"",entityType:o.py.Chat},o.wO.Chat,e.relatedEntity||e.entity)}},a.D.getLocalizedString("Chat_Show_More_Button")))}},32298:function(e,t,n){"use strict";n.d(t,{r:function(){return g}});var i=n(63804),r=n.n(i),o=n(59731),a=n(48945),s=n(73186),l=n(17875),c=n(97563),d=n(4476),u=n(47482),p=n(50385),m=n(83038),h=n(952),g=function(e){var t,n=e.attributesMetadata,i=e.context,g=e.datasetRecord,f=e.entityMetadata,y=e.recordContainerContext,v=e.viewEventHandlers,C=e.services;r().useEffect((function(){a.D.reportInfo("render","SectionView","",{section:e.section.key.toLowerCase(),layout:e.fixedColumnLayout})}));var S=e.section.rows;e.fixedColumnLayout>0&&(S=function(t){var n,i=[];null===(n=e.section.rows)||void 0===n||n.map((function(e){var t;null===(t=e.cells)||void 0===t||t.map((function(e){i.push(e)}))})),a.D.reportInfo("render","SectionView","Filtered",{section:e.section.key.toLowerCase(),layout:e.fixedColumnLayout,cellCount:i.length});for(var r=[],o=0;o<i.length;o+=t){for(var s={cells:[]},l=o;l<o+t&&l<i.length;l++)s.cells.push(i[l]);r.push(s)}return r}(e.fixedColumnLayout));var E=(null==S?void 0:S[0])||null,b=(null===(t=null==E?void 0:E.cells)||void 0===t?void 0:t[0])||null,w=b.datafieldName,D=b.labelDescription,T=b.showLabel,x=r().useCallback((function(e,t){var n;t===o.py.Account||t===o.py.Contact||t===o.py.Lead||t===o.py.Opportunity?null===(n=null==v?void 0:v.onOpenView)||void 0===n||n.call(v,{entityId:e,entityType:t},o.wO.Default):a.D.openEntityInMFD(t.toString().toLowerCase(),e,(function(){s.f.reload()}))}),[v]),k=null==n?void 0:n.get(w);return r().createElement("div",{className:"icv-section-rows "+p.B},r().createElement("div",{className:"icv-section-row "+m.L},r().createElement("div",{className:"icv-section-row-cell "+h.CJ},r().createElement(c.J,{recordContainerContext:y||d._.getContainerContext(i),entityData:f,fieldData:k,dataSetRecordEntityMetaData:f,dataSetRecord:g,showLabel:T,customProps:{displayName:D,textStyles:l.l.getFieldTextStyle(null==k?void 0:k.dataType),showAdditionalPersonaDetails:!0},callbackHandlers:{openEntity:x,updateRecord:function(e){var t;return null===(t=null==v?void 0:v.updateRecord)||void 0===t?void 0:t.call(v,e)},isChannelIntegrationFrameworkSupported:function(){return a.D.isChannelIntegrationFrameworkSupported()}},attributesMetadata:n,columns:u.ZH.getColumnsFromAttributeMetadata(n),webAPI:i.webAPI,dataService:C.dataService}))))}},54100:function(e,t,n){"use strict";n.d(t,{PW:function(){return o},vz:function(){return a},u9:function(){return s}});var i=n(19608),r=n(17754).rQ.palette.neutralSecondary,o=(0,i.mergeStyles)({display:"flex",flexDirection:"column"}),a=(0,i.mergeStyles)({fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"16px",color:r,margin:"6px 0 0 0",textAlign:"center"}),s=(0,i.mergeStyles)({margin:"0 20px"})},83291:function(e,t,n){"use strict";n.d(t,{m:function(){return g}});var i=n(49037),r=n(59731),o=n(63804),a=n.n(o),s=n(17217),l=n(56505),c=n(21259),d=n(48945),u=n(52618),p=n(4432),m=n(28741),h=n(54100),g=function(e){function t(t){var n,i,r,o=e.call(this,t)||this;return o.state={noteList:(null===(n=o.props.notes)||void 0===n?void 0:n.noteList)||[]},o.props.notes&&(null===(r=(i=o.props).registerCommands)||void 0===r||r.call(i,[{toolTipContent:d.D.getLocalizedString("Notes_Add_a_Note"),ariaLabel:d.D.getLocalizedString("Notes_Add_a_Note"),iconProps:s.P.add,commandAction:function(){o.openAddNote(m.gT.addNoteCommand)},style:{color:p.I.digitalBlue},commandId:m.gT.addNoteCommand}])),o}return(0,i.ZT)(t,e),t.prototype.componentDidUpdate=function(e){this.props.notes&&e.notes&&this.props.notes.noteList.length!==e.notes.noteList.length&&this.setState({noteList:this.props.notes.noteList})},t.prototype.render=function(){return d.D.reportInfo("render","SectionNotesView","",{notesCount:this.state.noteList.length}),this.state.noteList.length>0?a().createElement("div",{className:"icv-section-notes "+h.PW},a().createElement(l.F,(0,i.pi)({},(0,i.pi)((0,i.pi)({},this.props),{note:this.state.noteList[0],deleteNoteHandler:this.handleDeleteNote.bind(this)}))),this.state.noteList.length>1&&this.getShowMoreButton()):a().createElement("div",{className:"notes-section-nocontent-label "+h.vz},d.D.getLocalizedString("Notes_NoRecordFound"))},t.prototype.getShowMoreButton=function(){return a().createElement(c.ActionButton,{className:"icv-showmore-button "+h.u9,styles:{rootHovered:{color:p.I.digitalBlue}},onClick:this.openNotesView.bind(this)},d.D.getLocalizedString("ICV_ShowMoreNotes"))},t.prototype.handleDeleteNote=function(e){var t,n;e?this.setState({noteList:this.state.noteList.filter((function(t){return t.annotationid!==e}))}):null===(n=null===(t=this.props.viewEventHandlers)||void 0===t?void 0:t.setErrorMessage)||void 0===n||n.call(t,d.D.getLocalizedString("Notes_ErrorMessage_Delete_Note"))},t.prototype.openAddNote=function(e){var t,n;null===(n=null===(t=this.props.viewEventHandlers)||void 0===t?void 0:t.onOpenView)||void 0===n||n.call(t,{entityId:"",entityType:r.py.Note},r.wO.Create,this.props.relatedEntity||this.props.entity,null,e)},t.prototype.openNotesView=function(){var e,t;d.D.reportUserAction("openNotesView","SectionNotesView","Show more notes clicked",{},u.EJ.CLICK,"Show more notes button"),null===(t=null===(e=this.props.viewEventHandlers)||void 0===e?void 0:e.onOpenView)||void 0===t||t.call(e,{entityId:"",entityType:r.py.Note},r.wO.List,this.props.relatedEntity||this.props.entity)},t}(a().Component)},49545:function(e,t,n){"use strict";n.d(t,{J:function(){return d}});var i=n(49037),r=n(48945),o=n(63804),a=n.n(o),s=n(12203),l=n(66916),c=n(59731),d=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this;return r.D.reportInfo("render","SectionRecentOpportunitiesView","",{recentOpportunitiesCount:this.props.recentOpportunities.length}),this.props.recentOpportunities.length>0?a().createElement("div",null,this.props.recentOpportunities.map((function(t){return a().createElement(s.o,(0,i.pi)({},(0,i.pi)((0,i.pi)({},e.props),{personaCardProps:{text:t.name,className:"recentOptyPersonaCard",onRenderPersonaCoin:e.onRenderPersonaCoin,onRenderSecondaryText:e.onRenderSecondaryText.bind(e,t["estimatedvalue@OData.Community.Display.V1.FormattedValue"],t["statecode@OData.Community.Display.V1.FormattedValue"]),entityId:t.opportunityid,entityType:c.py.Opportunity}})))}))):a().createElement("div",null,a().createElement("div",{className:"recentopportunities-section-nocontent-label"},r.D.getLocalizedString("RecentOpportunities_NoRecordFound")))},t.prototype.onRenderPersonaCoin=function(){return a().createElement("div",{className:"recentOptyPersonaCardCoinIconDiv"},a().createElement(l.Icon,{iconName:"DocumentSet",className:"recentOptyPersonaCardCoinIcon"}))},t.prototype.onRenderSecondaryText=function(e,t){return e&&t?a().createElement("div",null,e,a().createElement(l.Icon,{iconName:"LocationDot",className:"recentOptyPersonaCardSecondaryTextIcon"}),t):e||t?a().createElement("div",null," ",e||t):a().createElement("div",null)},t}(a().Component)},75124:function(e,t,n){"use strict";n.d(t,{r:function(){return o},t:function(){return a}});var i=n(19608),r=n(17754).rQ.palette.neutralSecondary,o=(0,i.mergeStyles)({fontFamily:"Segoe UI",fontSize:"12px",textAlign:"center",lineHeight:"16px",color:r}),a=(0,i.mergeStyles)({display:"flex",margin:"8px 0px 32px 0",justifyContent:"center"})},30217:function(e,t,n){"use strict";n.d(t,{e:function(){return y}});var i=n(49037),r=n(63804),o=n(48945),a=n(4432),s=n(17217),l=n(21259),c=n(52618),d=n(59731),u=n(35691),p=n(35758),m=n(23436),h=n(75124),g="sectionTasksView",f=function(e,t){switch(t.type){case"createdRecentList":var n=p.b.filterTasksByState(t.allTasks).inProgTaskList;return{recentTaskList:t.recentTaskList,showMoreVisible:n.length>3};case"addNewInProgressTask":return t.allTasks.unshift(t.itemToAdd),n=p.b.filterTasksByState(t.allTasks).inProgTaskList,(r=Object.assign([],e.recentTaskList)).length>=3&&r.pop(),{recentTaskList:(0,i.pr)([t.itemToAdd],r),showMoreVisible:n.length>3};case"deleteTask":return(0,i.pi)((0,i.pi)({},e),{recentTaskList:e.recentTaskList.filter((function(e){return e.key!==t.itemToDelete.key}))});case"moveToCompleted":var r;return r=(r=Object.assign([],e.recentTaskList)).filter((function(e){return e.key!=t.completedTask.key})),(n=p.b.filterTasksByState(t.allTasks).inProgTaskList).length>r.length&&r.push(n[r.length]),{recentTaskList:r,showMoreVisible:n.length>3}}},y=function(e){var t=r.useReducer(f,{recentTaskList:[],showMoreVisible:!1}),n=t[0],y=t[1],v=r.useState(""),C=v[0],S=v[1];r.useEffect((function(){var t,n,i;o.D.reportInfo("render",g,"",{}),null===(t=e.registerCommands)||void 0===t||t.call(e,[{toolTipContent:o.D.getLocalizedString("Tasks_Add_A_Task"),ariaLabel:o.D.getLocalizedString("Tasks_Add_A_Task"),iconProps:s.P.add,commandAction:E,style:{color:a.I.digitalBlue}}]);var r=(null===(n=e.tasks)||void 0===n?void 0:n.taskList)||[],l=p.b.filterTasksByState(r).inProgTaskList.slice(0,3);y({type:"createdRecentList",allTasks:r,recentTaskList:l}),S((null===(i=e.tasks)||void 0===i?void 0:i.recordType)||"")}),[e.tasks]);var E=function(){var t;if(e.isInlineAddTaskEnabled){var n=(null===(t=e.tasks)||void 0===t?void 0:t.taskList)||[];y({type:"addNewInProgressTask",itemToAdd:{key:m.Guid.newGuid(),owner:"",subject:"",statecode:d.lP.Open,description:"",dueDate:void 0,friendlyDueDate:void 0,duration:void 0,prioritycode:d.Cx.Normal,isTemporaryObject:!0},allTasks:n})}else p.b.OpenQuickCreateTask(e.context,e.services.dataService,e.tasks.recordId,C,e.entity.entityType).then((function(t){var n;t&&y({type:"addNewInProgressTask",allTasks:null===(n=e.tasks)||void 0===n?void 0:n.taskList,itemToAdd:t})}))},b=r.useCallback((function(){var t,n;o.D.reportUserAction("openTasksView",g,"Show more tasks clicked",{},c.EJ.CLICK,"Show more tasks button"),null===(n=null===(t=e.viewEventHandlers)||void 0===t?void 0:t.onOpenView)||void 0===n||n.call(t,{entityId:"",entityType:d.py.Task},d.wO.List,e.relatedEntity||e.entity,e.tasks)}),[]),w=r.useCallback((function(t,n){n&&y({type:"moveToCompleted",allTasks:e.tasks.taskList,completedTask:t})}),[]),D=r.useCallback((function(t){var n;y({type:"deleteTask",itemToDelete:t,allTasks:null===(n=e.tasks)||void 0===n?void 0:n.taskList}),t.isTemporaryObject||e.onTaskAdded(null)}),[e.onTaskAdded]),T=r.useCallback((function(){o.D.reportUserAction("onTaskAdded",g,"task add Completed",{},c.EJ.CLICK,"Add task"),e.onTaskAdded(null)}),[e.onTaskAdded]),x=r.useCallback((function(){e.onTaskAdded(null)}),[e.onTaskAdded]);return r.createElement(r.Fragment,null,n.recentTaskList.length>0?r.createElement("div",null,n.recentTaskList.map((function(t){return r.createElement("div",{key:t.key},r.createElement(u.A,(0,i.pi)({},e,{dataService:e.services.dataService,task:t,onTaskStateChanged:w,onTaskDeleted:D,onTaskCreated:T,onTaskUpdated:x,relatedEntity:e.relatedEntity||e.entity})))})),n.showMoreVisible&&r.createElement(l.ActionButton,{className:"icv-showmore-button",styles:{rootHovered:{color:a.I.digitalBlue}},onClick:b},o.D.getLocalizedString("Tasks_ShowMore"))):r.createElement("div",{className:h.t},r.createElement("label",{className:h.r},o.D.getLocalizedString("Tasks_EmptyList"))))}},50385:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var i=(0,n(19608).mergeStyles)({margin:"0 20px"})},5436:function(e,t,n){"use strict";n.d(t,{K:function(){return c}});var i=n(49037),r=n(63804),o=n.n(r),a=n(94340),s=n(48945),l=n(50385),c=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this;s.D.reportInfo("render","SectionView","",{section:this.props.section.key.toLowerCase(),layout:this.props.fixedColumnLayout});var t=this.props.section.rows;return this.props.fixedColumnLayout>0&&(t=this.filterRows(this.props.fixedColumnLayout)),o().createElement("div",{className:"icv-section-rows "+l.B},t.map((function(t){var n=(0,i.pi)((0,i.pi)({},e.props),{row:t});return o().createElement(a.X,(0,i.pi)({},n)," ")})))},t.prototype.filterRows=function(e){var t,n=[];null===(t=this.props.section.rows)||void 0===t||t.map((function(e){var t;null===(t=e.cells)||void 0===t||t.map((function(e){n.push(e)}))})),s.D.reportInfo("render","SectionView","Filtered",{section:this.props.section.key.toLowerCase(),layout:this.props.fixedColumnLayout,cellCount:n.length});for(var i=[],r=0;r<n.length;r+=e){for(var o={cells:[]},a=r;a<r+e&&a<n.length;a++)o.cells.push(n[a]);i.push(o)}return i},t}(o().Component)},81312:function(e,t,n){"use strict";n.d(t,{w:function(){return i}});var i=(0,n(19608).mergeStyles)({padding:"0 20px"})},28311:function(e,t,n){"use strict";n.d(t,{O:function(){return m}});var i=n(49037),r=n(63804),o=n.n(r),a=n(6443),s=n(52618),l=n(81277),c=n(48945),d=n(97369),u=n(35531),p=n(81312),m=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t,n,r,a,m,h,g,f;if(c.D.reportInfo("render","Tab","",{tab:null===(e=this.props.tab)||void 0===e?void 0:e.key}),(null===(t=this.props.tab)||void 0===t?void 0:t.key.toLowerCase())===s.gT.ACTIVITY){var y=(0,i.pi)((0,i.pi)({},this.props),{activities:this.props.activities||{recordId:this.props.entity.entityId,activityList:[]},onActivityAdded:this.props.onActivityAdded});return o().createElement(l.R,(0,i.pi)({},y))}var v=(null===(r=null===(n=this.props.tab)||void 0===n?void 0:n.columns)||void 0===r?void 0:r.length)>0&&(null===(a=this.props.tab)||void 0===a?void 0:a.columns[0].sections)&&(null===(m=this.props.tab)||void 0===m?void 0:m.columns[0].sections.length)>0,C=Boolean(v)?"":p.w;return o().createElement("div",{className:"icv-tab-content "+C},o().createElement(u.Shimmer,{customElementsGroup:d.W.getCOLAViewShimmer(),isDataLoaded:v},(null===(h=this.props.tab)||void 0===h?void 0:h.columns)&&(null===(g=this.props.tab)||void 0===g?void 0:g.columns.length)&&this.getSections(null===(f=this.props.tab)||void 0===f?void 0:f.columns[0].sections)))},t.prototype.getSections=function(e){var t=this;return c.D.reportInfo("render","Tab","",{sections:e.map((function(e){return e.key.toLowerCase()}))}),e=this.filterSections(e),c.D.reportInfo("render","Tab","Filtered",{sections:e.map((function(e){return e.key.toLowerCase()}))}),e&&e.map((function(e){var n=(0,i.pi)((0,i.pi)({},t.props),{section:e,isCollapsed:!1});return o().createElement(a.$,(0,i.pi)({},n,{key:n.section.labelDescription}))}))},t.prototype.filterSections=function(e){return e.filter((function(e){return e.key.toLowerCase()===s.gT.SUMMARY_KEY_DETAILS||e.key.toLowerCase()===s.gT.SUMMARY_CONTACTS||e.key.toLowerCase()===s.gT.SUMMARY_TASKS||e.key.toLowerCase()===s.gT.SUMMARY_NOTES||e.key.toLowerCase()===s.gT.SUMMARY_RECENTOPPORTUNITIES}))},t}(o().Component)},66487:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var i=(0,n(19608).mergeStyles)({padding:0})},75154:function(e,t,n){"use strict";n.d(t,{t:function(){return u}});var i=n(49037),r=n(63804),o=n.n(r),a=n(5373),s=n(28311),l=n(52618),c=n(48945),d=n(66487),u=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this;c.D.reportInfo("render","TabList","",{tabs:this.props.tabs.map((function(e){return e.key.toLowerCase()}))});var t,n=this.filterTabs();return c.D.reportInfo("render","TabList","Filtered",{tabs:n.map((function(e){return e.key.toLowerCase()}))}),t=n&&n.length>0&&this.props.entityMetadata?n.map((function(t){var n=(0,i.pi)((0,i.pi)({},e.props),{tab:t});return o().createElement(a.PivotItem,{className:"icv-pivot-content "+d.b,headerText:t.name},o().createElement(s.O,(0,i.pi)({},n,{key:t.key})))})):[o().createElement(a.PivotItem,{className:"icv-pivot-content "+d.b,headerText:""},o().createElement(s.O,(0,i.pi)({},this.props)))],o().createElement(a.Pivot,{className:"icv-tablist-header",styles:{root:{borderBottom:"1px",borderBottomStyle:"solid",borderColor:"#EAEAEA"},itemContainer:{overflow:"auto"}}},t)},t.prototype.filterTabs=function(){return this.props.tabs.filter((function(e){return e.key.toLowerCase()==l.gT.SUMMARY||e.key.toLowerCase()==l.gT.ACTIVITY}))},t}(o().Component)},23089:function(e,t,n){"use strict";n.d(t,{o:function(){return p}});var i=n(49037),r=n(48945),o=n(66916),a=n(63804),s=n.n(a),l=n(17217),c=n(99750),d=n(52618),u=n(4432),p=function(e){function t(t){return e.call(this,t)||this}return(0,i.ZT)(t,e),t.prototype.render=function(){return r.D.reportInfo("render","ErrorView","Error view shown",{}),s().createElement("div",{className:"icv-errorview-container"},s().createElement("div",{className:"icv-errorview-icon-container"},s().createElement(o.Icon,{iconName:l.P.error.iconName,className:"icv-errorview-icon"})),s().createElement("label",{className:"icv-errorview-title"},r.D.getLocalizedString("ICV_Error_Title")),s().createElement("label",{className:"icv-errorview-subtitle"},this.props.message),s().createElement(c.PrimaryButton,{onClick:this.onRefresh.bind(this),text:r.D.getLocalizedString("ICV_Error_RetryButtonLabel"),iconProps:l.P.refresh,styles:{root:{marginTop:"28px",backgroundColor:u.I.digitalBlue,border:"none"},rootHovered:{marginTop:"28px",backgroundColor:u.I.digitalBlue,border:"none"}}}))},t.prototype.onRefresh=function(){var e,t;r.D.reportUserAction("onRefresh","ErrorView","Try again clicked",{},d.EJ.CLICK,"Try again button"),null===(t=null===(e=this.props.viewEventHandlers)||void 0===e?void 0:e.openErrorView)||void 0===t||t.call(e,"")},t}(s().Component)},84034:function(e,t,n){"use strict";n.d(t,{w:function(){return g}});var i=n(49037),r=n(63804),o=n.n(r),a=n(87018),s=n(36957),l=n(8753),c=n(48945),d=n(90749),u=n(52618),p=n(25453),m=n(48909),h="AttachmentView",g=function(e){var t=e.note,n=e.isEditMode,r=e.fileName,g=e.pendingAttachmentChanges,f=e.uploadInProgress,y=e.handleUpload,v=e.clearAttachment,C=e.pendingAttachment,S=function(){return o().createElement("div",null,o().createElement("div",{className:d.p1},(C=n?r:null==t?void 0:t.filename,o().createElement(s.Icon,(0,i.pi)({className:d.QO},(0,l.EX)({extension:null==C?void 0:C.substr((null==C?void 0:C.lastIndexOf("."))+1),size:20,imageFileType:"png"})))),o().createElement(m.Text,{className:d.y7},null==(y=n?r:null==t?void 0:t.filename)?void 0:y.split(".").slice(0,-1).join(".")),n&&(g||(null==t?void 0:t.isdocument)&&!g)?f?o().createElement(p.Spinner,{size:p.SpinnerSize.medium}):o().createElement(a.IconButton,{iconProps:{iconName:"ChromeClose"},ariaLabel:c.D.getLocalizedString("Notes_Remove_Attachment_Button"),className:d.yi,onClick:v}):o().createElement(a.IconButton,{iconProps:{iconName:"Download"},className:d.yi,ariaLabel:c.D.getLocalizedString("Notes_Download_Attachment_Button"),onClick:function(n){t&&e.services.dataService.getNoteAttachment(t.annotationid).then((function(e){var n,i=document.createElement("a");document.body.appendChild(i);var r="data:"+t.mimetype+";base64,"+e;i.href=r,i.download=null!==(n=t.filename)&&void 0!==n?n:"",i.click()})).catch((function(e){c.D.reportError("onDownloadButtonClick",h,u.dS.FAILED,{error:e,noteId:t.annotationid})})),n.stopPropagation(),c.D.reportUserAction("onDownloadButtonClick",h,"Download button clicked",{noteId:null==t?void 0:t.annotationid,isCreate:!t},u.EJ.CLICK,"Download button")}})));var y,C};return n?C||(null==t?void 0:t.isdocument)&&!g?S():o().createElement("div",null,o().createElement("input",{type:"file",id:"fileUpload",className:d.al,onChange:function(e){e.target.files&&e.target.files[0]&&y&&y(e.target.files[0])}}),o().createElement(a.ActionButton,{id:"openFileUpload",iconProps:{iconName:"Attach"},allowDisabledFocus:!0,onClick:function(){var e;null===(e=document.getElementById("fileUpload"))||void 0===e||e.click(),c.D.reportUserAction("onAttachFileClick",h,"Attach file",{noteId:null==t?void 0:t.annotationid,isCreate:!t},u.EJ.CLICK,"Attach file button")}},c.D.getLocalizedString("Notes_AttachFile"))):(null==t?void 0:t.isdocument)?S():null}},90749:function(e,t,n){"use strict";n.d(t,{p1:function(){return o},QO:function(){return a},y7:function(){return s},yi:function(){return l},al:function(){return c}});var i=n(54988),r=n(19608),o=(0,r.mergeStyles)({display:"flex",height:32,flexDirection:"row"}),a=(0,r.mergeStyles)({margin:"auto",minWidth:"20px"}),s=(0,r.mergeStyles)({margin:"auto",flexGrow:1,paddingLeft:8,paddingRight:8,color:i.iX.gray160,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}),l=(0,r.mergeStyles)({color:i.iX.gray130,fontSize:16,fontWeight:400}),c=(0,r.mergeStyles)({display:"none"})},28597:function(e,t,n){"use strict";n.d(t,{B:function(){return E}});var i,r=n(49037),o=n(63804),a=n.n(o),s=n(59731),l=n(94118),c=n(45997),d=n(69876),u=n(85936),p=n(66966),m=n(84034),h=n(84718),g=n(48945),f=n(4848),y=n(52618),v=n(94589),C=n(4432),S=n(73200);!function(e){e.EditNoteView="EditNoteView",e.AttachmentView="AttachmentView"}(i||(i={}));var E=function(e){function t(t){var n,i,r,o,a,s,l,c,d,u=e.call(this,t)||this;return u.MAX_EDITOR_LENGTH=2e3,null===(i=null===(n=u.props.viewEventHandlers)||void 0===n?void 0:n.setViewTitle)||void 0===i||i.call(n,g.D.getLocalizedString("Notes_NotesEditTitle")),u.state={title:(null===(r=u.props.note)||void 0===r?void 0:r.subject)||"",noteText:(null===(o=u.props.note)||void 0===o?void 0:o.notetext)||"",documentBody:null===(a=u.props.note)||void 0===a?void 0:a.documentbody,fileName:null!==(l=null===(s=u.props.note)||void 0===s?void 0:s.filename)&&void 0!==l?l:"",pendingAttachmentChanges:!1,pendingAttachment:!1,disableSaveButton:h.StringUtil.IsNullOrEmpty(null===(c=u.props.note)||void 0===c?void 0:c.subject),uploadInProgress:!1,isFileSizeValid:!0,richTextEnabled:!0,richTextStatusLoading:!0},u.showPlaceholder=!(null===(d=u.props.note)||void 0===d?void 0:d.notetext),u}return(0,r.ZT)(t,e),t.prototype.componentDidMount=function(){try{this.getRichTextEnabledStatus()}catch(e){console.log("Error getting the current rich text status. ",e.message)}},t.prototype.getRichTextEnabledStatus=function(){return(0,r.mG)(this,void 0,void 0,(function(){var e,t;return(0,r.Jh)(this,(function(n){switch(n.label){case 0:e=this.state.richTextEnabled,n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,this.props.services.dataService.getRichTextStatus()];case 2:return e=n.sent(),[3,5];case 3:return t=n.sent(),console.log("Error getting the current rich text status",t.message),[3,5];case 4:return this.setState({richTextEnabled:e,richTextStatusLoading:!1}),[7];case 5:return[2]}}))}))},t.prototype.render=function(){var e,t;return g.D.reportInfo("render",i.AttachmentView,"",{noteId:null===(e=this.props.note)||void 0===e?void 0:e.annotationid,isCreate:!this.props.note}),this.state.richTextStatusLoading?a().createElement(a().Fragment,null):this.state.saveInProgress?a().createElement(f.P,{spinnerSize:2,loadingMessage:g.D.getLocalizedString("InContextView_Saving")}):a().createElement("div",{className:"icv-view-content-container"},a().createElement("div",{className:"note-editview-container"},this.getTitleField(),a().createElement(p.Label,null,g.D.getLocalizedString("Notes_Description")),this.getCKEditor(),a().createElement(m.w,(0,r.pi)({},this.props,{note:this.props.note||{},isEditMode:!0,handleUpload:this.handleUpload.bind(this),clearAttachment:this.clearAttachment.bind(this),pendingAttachmentChanges:this.state.pendingAttachmentChanges,pendingAttachment:this.state.pendingAttachment,fileName:null!==(t=this.state.fileName)&&void 0!==t?t:"",uploadInProgress:this.state.uploadInProgress})),this.getButtons()))},t.prototype.clearAttachment=function(){this.setState({fileName:"",documentBody:void 0,pendingAttachmentChanges:!0,pendingAttachment:!1,uploadInProgress:!1})},t.prototype.validateFileSize=function(e){var t,n=this;null===(t=this.props.services.dataService)||void 0===t||t.getOrgUploadConstraints().then((function(t){var r,o,a,s=e.size>t,l=e.size<1;if(s||l){n.clearAttachment();var c=s?g.D.getLocalizedString("Notes_ErrorMessage_Upload_Attachment_Too_Large",(0,S.bc)(t,"MB")):g.D.getLocalizedString("Notes_ErrorMessage_Upload_Attachment_Too_Small");null===(o=null===(r=n.props.viewEventHandlers)||void 0===r?void 0:r.setErrorMessage)||void 0===o||o.call(r,c),g.D.reportError("onAttachFileClick",i.AttachmentView,y.dS.FAILED,{error:c,noteId:null===(a=n.props.note)||void 0===a?void 0:a.annotationid,isCreate:!n.props.note,fileSize:e.size}),n.setState({isFileSizeValid:!1})}else n.setState({isFileSizeValid:!0})})).catch((function(e){g.D.reportError("onAttachFileClick",i.AttachmentView,y.dS.FAILED,{error:e})}))},t.prototype.handleUpload=function(e,t){var n=this;this.validateFileSize(e),this.state.isFileSizeValid&&(this.setState({fileName:e.name,pendingAttachmentChanges:!0,pendingAttachment:!0,uploadInProgress:!0}),(0,S.Wq)(e,t).then((function(t){n.setState({documentBody:t,uploadInProgress:!1}),g.D.reportInfo("onAttachFileClick",i.AttachmentView,y.dS.SUCCESS,{fileSize:e.size})})).catch((function(t){n.setState({uploadInProgress:!1}),g.D.reportError("onAttachFileClick",i.AttachmentView,y.dS.FAILED,{error:t,fileSize:e.size})})))},t.prototype.getTitleField=function(){var e=this;return a().createElement(l.TextField,{label:g.D.getLocalizedString("Notes_Title"),required:!0,"aria-label":g.D.getLocalizedString("Notes_Title"),id:"subjectNotes",placeholder:g.D.getLocalizedString("Notes_Subject"),defaultValue:this.state.title,styles:{root:{paddingBottom:v.TS.size10}},onChange:function(t){e.setState({title:t.target.value,disableSaveButton:h.StringUtil.IsNullOrEmpty(t.target.value)})}})},t.prototype.getCKEditor=function(){return a().createElement("div",null,a().createElement(u.L,{languageId:this.props.context.userSettings.languageId,placeholder:this.showPlaceholder?g.D.getLocalizedString("Notes_Add_a_Note"):"",data:this.state.noteText,style:{marginBottom:v.TS.size10,border:h.StringUtil.IsNullOrEmpty(this.state.errorMessage)?"1px solid #605E5C":"1px solid #A80000",borderRadius:C.B.size2px,background:C.I.white},eventHandlers:{onChange:this.onChangeEvent.bind(this)},richTextEnabled:this.state.richTextEnabled}),!h.StringUtil.IsNullOrEmpty(this.state.errorMessage)&&this.getErrorLabel())},t.prototype.onChangeEvent=function(e,t){this.showPlaceholder=!1;var n=t.getData().length;this.setState({noteText:t.getData(),errorMessage:n>this.MAX_EDITOR_LENGTH?g.D.getLocalizedString("Notes_ErrorMessage_Character_Limit"):void 0,disableSaveButton:!!(h.StringUtil.IsNullOrEmpty(this.state.title)||n>this.MAX_EDITOR_LENGTH)})},t.prototype.getButtons=function(){return a().createElement("div",{className:"note-editview-footer"},a().createElement(c.PrimaryButton,{text:g.D.getLocalizedString("Notes_Post_Note"),styles:{root:{marginLeft:C.B.size4px}},onClick:this.onSaveClick.bind(this),disabled:this.state.disableSaveButton}),a().createElement(d.DefaultButton,{text:g.D.getLocalizedString("InContextView_Cancel"),styles:{root:{marginLeft:C.B.size4px}},onClick:this.onCancelClick.bind(this)}))},t.prototype.onSaveClick=function(){var e,t,n,r,o=this;g.D.reportUserAction("onSaveClick",i.EditNoteView,"Save note clicked",{noteId:null===(e=this.props.note)||void 0===e?void 0:e.annotationid,isCreate:!this.props.note},y.EJ.CLICK,"Save note button");var a=this,s=this.updatedNote();s?(this.props.services.dataService.upsertNote(this.props.entity.entityId,s).then((function(e){var t,n,r,s,l,c;e&&e.entityType&&"annotation"===e.entityType.toLowerCase()?(g.D.reportInfo("onSaveClick",i.EditNoteView,y.dS.SUCCESS,{noteId:null===(t=o.props.note)||void 0===t?void 0:t.annotationid,isCreate:!o.props.note}),null===(r=null===(n=a.props.viewEventHandlers)||void 0===n?void 0:n.navigateBack)||void 0===r||r.call(n)):(g.D.reportError("onSaveClick",i.EditNoteView,y.dS.FAILED,{error:"Empty response returned",noteId:null===(s=o.props.note)||void 0===s?void 0:s.annotationid,isCreate:!o.props.note}),null===(c=null===(l=o.props.viewEventHandlers)||void 0===l?void 0:l.setErrorMessage)||void 0===c||c.call(l,g.D.getLocalizedString("Notes_ErrorMessage_Update_Note"))),a.setState({saveInProgress:!1})})).catch((function(e){var t,n,r;g.D.reportError("onSaveClick",i.EditNoteView,y.dS.FAILED,{error:e,noteId:null===(t=o.props.note)||void 0===t?void 0:t.annotationid,isCreate:!o.props.note}),null===(r=null===(n=o.props.viewEventHandlers)||void 0===n?void 0:n.setErrorMessage)||void 0===r||r.call(n,g.D.getLocalizedString("Notes_ErrorMessage_Update_Note")),a.setState({saveInProgress:!1})})),this.setState({saveInProgress:!0})):(g.D.reportWarning("onSaveClick",i.EditNoteView,y.dS.SUCCESS,{message:"Same record",noteId:null===(t=this.props.note)||void 0===t?void 0:t.annotationid,isCreate:!this.props.note}),null===(r=null===(n=this.props.viewEventHandlers)||void 0===n?void 0:n.navigateBack)||void 0===r||r.call(n))},t.prototype.updatedNote=function(){var e,t,n,i,r,o,a,s={};return this.state.title!==(null===(e=this.props.note)||void 0===e?void 0:e.subject)&&(s.subject=this.state.title),this.state.noteText!==(null===(t=this.props.note)||void 0===t?void 0:t.notetext)&&(s.notetext=this.state.noteText),this.state.pendingAttachmentChanges&&this.state.pendingAttachment!==(null===(n=this.props.note)||void 0===n?void 0:n.isdocument)&&(s.isdocument=this.state.pendingAttachment),this.state.documentBody!==(null===(i=this.props.note)||void 0===i?void 0:i.documentbody)&&(s.documentbody=this.state.documentBody),this.state.fileName!==(null===(r=this.props.note)||void 0===r?void 0:r.filename)&&(s.filename=this.state.fileName),(null===(o=this.props.note)||void 0===o?void 0:o._objectid_value)||(s[this.getKeyForRelatedEntity(null===(a=this.props.relatedEntity)||void 0===a?void 0:a.entityType)]=this.props.relatedEntity?"/"+g.D.getPluralNameOfEntity(this.props.relatedEntity.entityType)+"("+this.props.relatedEntity.entityId+")":null),Object.keys(s).length>0?s:null},t.prototype.getKeyForRelatedEntity=function(e){switch(e){case s.py.Opportunity:return"objectid_opportunity@odata.bind";case s.py.Contact:return"objectid_contact@odata.bind";case s.py.Account:return"objectid_account@odata.bind";case s.py.Lead:return"objectid_lead@odata.bind";default:return""}},t.prototype.onCancelClick=function(){var e,t,n;g.D.reportUserAction("onCancelClick",i.EditNoteView,"Save note cancelled",{noteId:null===(e=this.props.note)||void 0===e?void 0:e.annotationid,isCreate:!this.props.note},y.EJ.CLICK,"Save note cancel button"),null===(n=null===(t=this.props.viewEventHandlers)||void 0===t?void 0:t.navigateBack)||void 0===n||n.call(t)},t.prototype.getErrorLabel=function(){return a().createElement("label",{className:"notes-editnote-rte-error"},this.state.errorMessage)},t}(a().Component)},83154:function(e,t,n){"use strict";n.d(t,{E:function(){return r},P:function(){return o}});var i=n(19608),r=(0,i.mergeStyles)({padding:"14px 0",display:"flex",flexDirection:"column",overflow:"auto"}),o=(0,i.mergeStyles)({padding:"14px 20px",display:"flex",flexDirection:"column",overflow:"auto"})},56505:function(e,t,n){"use strict";n.d(t,{F:function(){return b}});var i=n(49037),r=n(63804),o=n.n(r),a=n(59731),s=n(87018),l=n(17217),c=n(85936),d=n(36957),u=n(59295),p=n(93170),m=n(84034),h=n(48945),g=n(4848),f=n(52618),y=n(4432),v=n(54988),C=n(94589),S=n(83154),E="NoteCard",b=function(e){function t(t){var n=e.call(this,t)||this;return n.state={showDialog:!1,actionInProgress:!1},n}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t=this;h.D.reportInfo("render",E,"",{noteId:this.props.note.annotationid});var n={root:{maxWidth:"100%",border:"0px",padding:"0 20px",selectors:{":hover::after":{border:"0px"},":hover":{backgroundColor:y.I.grey}}}};return this.state.actionInProgress?o().createElement(u.DocumentCard,{styles:n,className:"notecard-spinner-container"},o().createElement(g.P,{removeStyles:!0,spinnerSize:2,loadingMessage:h.D.getLocalizedString("InContextView_Deleting")})):o().createElement(u.DocumentCard,{styles:n,style:this.props.style,className:"notecard-document-container",onClick:function(){var e,n;h.D.reportUserAction("onNoteCardClick",E,"View note clicked",{noteId:t.props.note.annotationid,hasAttachment:t.props.note.isdocument},f.EJ.CLICK,"View note card"),null===(n=null===(e=t.props.viewEventHandlers)||void 0===e?void 0:e.onOpenView)||void 0===n||n.call(e,{entityId:t.props.note.annotationid,entityType:a.py.Note},a.wO.Default,t.props.relatedEntity||t.props.entity)}},o().createElement("div",{className:"notecard-container "+S.E},o().createElement("div",{className:"notecard-header"},o().createElement("div",{className:"notecard-title",title:this.props.note.subject},this.props.note.subject),o().createElement("label",{className:"notecard-timecontrol"},h.D.getFormattedDateString(this.props.note.modifiedon,this.props.context)),this.getHeaderIconsDiv()),o().createElement(c.L,{languageId:this.props.context.userSettings.languageId,data:this.props.note.notetext,readOnly:!0,numberOfLinesToDisplay:5,eventHandlers:{}}),o().createElement("div",{className:"notecard-owner-container"},o().createElement(d.Icon,{iconName:l.P.contact.iconName,className:"notecard-owner-avatar"}),o().createElement("label",{className:"notecard-owner-label"},this.props.note["_modifiedby_value@OData.Community.Display.V1.FormattedValue"])),this.props.note&&o().createElement(m.w,(0,i.pi)({},this.props,{isEditMode:!1,fileName:null!==(e=this.props.note.filename)&&void 0!==e?e:"",note:this.props.note}))),this.state.showDialog&&this.getDeleteDialog())},t.prototype.getHeaderIconsDiv=function(){var e={iconHovered:{color:v.iX.gray160},rootHovered:{backgroundColor:y.I.editDeletIconhover,width:y.B.size22px,height:y.B.size22px}};return o().createElement("div",{className:"notecard-editcontrol"},o().createElement(s.IconButton,{title:h.D.getLocalizedString("Notes_NotesEditTitle"),ariaLabel:h.D.getLocalizedString("Notes_NotesEditTitle"),styles:e,iconProps:{iconName:l.P.notesEdit.iconName,style:{fontSize:C.TS.size14}},className:"notecard-editcontrol-icon",onClick:this.onEditButtonClick.bind(this)}),o().createElement(s.IconButton,{title:h.D.getLocalizedString("Notes_NoteDeleteTitle"),ariaLabel:h.D.getLocalizedString("Notes_NoteDeleteTitle"),styles:e,iconProps:{iconName:l.P.deleteNotes.iconName,style:{fontSize:C.TS.size14}},className:"notecard-deletecontrol-icon",onClick:this.onDeleteButtonClick.bind(this)}))},t.prototype.onDeleteButtonClick=function(e){h.D.reportUserAction("onDeleteButtonClick",E,"Delete note clicked",{noteId:this.props.note.annotationid},f.EJ.CLICK,"Delete note icon"),this.setState({showDialog:!0}),e.stopPropagation()},t.prototype.getDeleteDialog=function(){var e={type:p.DialogType.close,title:h.D.getLocalizedString("Notes_Delete_Note"),closeButtonAriaLabel:h.D.getLocalizedString("InContextView_Cancel"),subText:h.D.getLocalizedString("Notes_Delete_Dialog_Confirmation")};return h.D.reportInfo("getDeleteDialog",E,"",{title:e.title}),o().createElement(p.Dialog,{hidden:!1,onDismiss:this.onDismiss.bind(this),dialogContentProps:e},o().createElement(p.DialogFooter,null,o().createElement(s.PrimaryButton,{onClick:this.onDeleteConfirm.bind(this),text:h.D.getLocalizedString("InContextView_Delete")}),o().createElement(s.DefaultButton,{onClick:this.onDismiss.bind(this),text:h.D.getLocalizedString("InContextView_Cancel")})))},t.prototype.onDismiss=function(){h.D.reportUserAction("onDialogDismiss",E,"Confirm note delete dismissed",{},f.EJ.CLICK,"Delete note cancel"),this.setState({showDialog:!1})},t.prototype.onDeleteConfirm=function(){var e=this;h.D.reportUserAction("onDeleteConfirm",E,"Conform note delete clicked",{noteId:this.props.note.annotationid},f.EJ.CLICK,"Delete note confirm"),this.props.services.dataService.deleteNote(this.props.note.annotationid).then((function(t){t&&t.id&&t.id===e.props.note.annotationid?(h.D.reportInfo("onDeleteConfirm",E,f.dS.SUCCESS,{noteId:e.props.note.annotationid}),e.props.deleteNoteHandler(e.props.note.annotationid)):(h.D.reportError("onDeleteConfirm",E,f.dS.FAILED,{error:"Empty response returned",noteId:e.props.note.annotationid}),e.props.deleteNoteHandler()),e.setState({actionInProgress:!1})})).catch((function(t){h.D.reportError("onDeleteConfirm",E,f.dS.FAILED,{error:t,noteId:e.props.note.annotationid}),e.props.deleteNoteHandler()})),this.setState({actionInProgress:!0,showDialog:!1})},t.prototype.onEditButtonClick=function(e){var t,n;h.D.reportUserAction("onEditButtonClick",E,"Edit note clicked",{noteId:this.props.note.annotationid},f.EJ.CLICK,"Edit note icon"),null===(n=null===(t=this.props.viewEventHandlers)||void 0===t?void 0:t.onOpenView)||void 0===n||n.call(t,{entityId:this.props.note.annotationid,entityType:a.py.Note},a.wO.Edit,this.props.relatedEntity||this.props.entity,this.props.note),e.stopPropagation()},t}(o().Component)},75464:function(e,t,n){"use strict";n.d(t,{E:function(){return f}});var i=n(49037),r=n(63804),o=n.n(r),a=n(59731),s=n(56505),l=n(4848),c=n(87018),d=n(17217),u=n(48945),p=n(36957),m=n(52618),h=n(4432),g="NoteListView",f=function(e){function t(t){var n,i,r=e.call(this,t)||this;return null===(i=null===(n=r.props.viewEventHandlers)||void 0===n?void 0:n.setViewTitle)||void 0===i||i.call(n,u.D.getLocalizedString("Notes_NotesListTitle")),r.state={notesList:r.props.notes?r.props.notes.noteList:[],isNotesFetched:!!r.props.notes},r.props.notes||r.props.services.dataService.fetchNotes(r.props.relatedEntity||r.props.primaryEntity).then((function(e){u.D.reportInfo("constructor",g,m.dS.SUCCESS,{entityId:e.recordDetails.entityId,entityType:e.recordDetails.entityType,notesCount:e.noteList.length}),r.setState({isNotesFetched:!0,notesList:e.noteList})})).catch((function(e){var t,n;u.D.reportError("constructor",g,m.dS.FAILED,{entityId:(r.props.relatedEntity||r.props.primaryEntity).entityId,entityType:(r.props.relatedEntity||r.props.primaryEntity).entityId,error:e}),null===(n=null===(t=r.props.viewEventHandlers)||void 0===t?void 0:t.openErrorView)||void 0===n||n.call(t,u.D.getLocalizedString("Notes_Error_Message"))})),r}return(0,i.ZT)(t,e),t.prototype.render=function(){var e=this,t={rootHovered:{backgroundColor:h.I.grey,color:h.I.digitalBlue}};if(this.state.isNotesFetched){u.D.reportInfo("render",g,"",{noteCount:this.state.notesList.length});var n;return n=0===this.state.notesList.length?this.emptyNotesView():o().createElement("div",{className:"notes-listview-container"},this.state.notesList.map((function(t){return o().createElement(s.F,(0,i.pi)({},e.props,{key:t.annotationid,note:t,deleteNoteHandler:e.handleDeleteNote.bind(e),style:{borderBottom:"solid 1px #EDEBE9",paddingRight:20,paddingLeft:20}}))}))),o().createElement("div",{className:"icv-view-content-container"},o().createElement(c.ActionButton,{styles:t,className:"notes-addnewnote-button",iconProps:{iconName:d.P.add.iconName,style:{color:h.I.digitalBlue}},onClick:this.onAddNoteClick.bind(this)},u.D.getLocalizedString("Notes_Add_a_Note")),n)}return this.notesViewLoading()},t.prototype.handleDeleteNote=function(e){var t,n;e?this.setState({notesList:this.state.notesList.filter((function(t){return t.annotationid!==e}))}):null===(n=null===(t=this.props.viewEventHandlers)||void 0===t?void 0:t.setErrorMessage)||void 0===n||n.call(t,u.D.getLocalizedString("Notes_ErrorMessage_Delete_Note"))},t.prototype.onAddNoteClick=function(){var e,t;null===(t=null===(e=this.props.viewEventHandlers)||void 0===e?void 0:e.onOpenView)||void 0===t||t.call(e,{entityId:"",entityType:a.py.Note},a.wO.Create,this.props.relatedEntity||this.props.entity)},t.prototype.emptyNotesView=function(){return o().createElement("div",{className:"notes-listview-empty-container"},o().createElement("div",{className:"notes-listview-icon-container"},o().createElement(p.Icon,{iconName:d.P.attachmentIcon.iconName,className:"notes-listview-icon"})),o().createElement("label",{className:"notes-listview-title"},u.D.getLocalizedString("Notes_Find_your_notes_here")),o().createElement("label",{className:"notes-listview-subtitle"},u.D.getLocalizedString("Notes_No_notes_Empty_state")))},t.prototype.notesViewLoading=function(){return o().createElement(l.P,{spinnerSize:2,loadingMessage:u.D.getLocalizedString("InContextView_Loading")})},t}(o().Component)},62863:function(e,t,n){"use strict";n.d(t,{W:function(){return C}});var i=n(49037),r=n(63804),o=n.n(r),a=n(59731),s=n(17217),l=n(36957),c=n(85936),d=n(84034),u=n(48945),p=n(87018),m=n(93170),h=n.n(m),g=n(4848),f=n(52618),y=n(83154),v="NoteView",C=function(e){function t(t){var n,i,r,o,a=e.call(this,t)||this;return null===(i=null===(n=a.props.viewEventHandlers)||void 0===n?void 0:n.setViewTitle)||void 0===i||i.call(n,u.D.getLocalizedString("Notes_NotesViewTitle")),null===(o=null===(r=a.props.viewEventHandlers)||void 0===r?void 0:r.registerCommands)||void 0===o||o.call(r,a.getNavCommands()),a.state={note:a.props.note||{},isNoteFetched:!!a.props.note,showDeleteDialog:!1,deletionInProgress:!1},a.props.note||a.props.services.dataService.fetchNote(a.props.entity.entityId).then((function(e){u.D.reportInfo("constructor",v,f.dS.SUCCESS,{noteId:a.props.entity.entityId,entityId:(a.props.relatedEntity||a.props.primaryEntity).entityId,entityType:(a.props.relatedEntity||a.props.primaryEntity).entityId}),a.setState({note:e,isNoteFetched:!0})})).catch((function(e){var t,n;u.D.reportError("constructor",v,f.dS.FAILED,{noteId:a.props.entity.entityId,entityId:(a.props.relatedEntity||a.props.primaryEntity).entityId,entityType:(a.props.relatedEntity||a.props.primaryEntity).entityId,error:e}),null===(n=null===(t=a.props.viewEventHandlers)||void 0===t?void 0:t.openErrorView)||void 0===n||n.call(t,u.D.getLocalizedString("Note_Error_Message"))})),a}return(0,i.ZT)(t,e),t.prototype.render=function(){var e;return this.state.deletionInProgress||!this.state.isNoteFetched?o().createElement(g.P,{spinnerSize:2,loadingMessage:u.D.getLocalizedString(this.state.deletionInProgress?"InContextView_Deleting":"InContextView_Loading")}):(u.D.reportInfo("render",v,"",{noteId:this.state.note.annotationid}),o().createElement("div",{className:"icv-view-content-container"},o().createElement("div",{className:"notecard-container "+y.P},this.state.showDeleteDialog&&this.getDeleteDialog(),o().createElement("div",{className:"notecard-header"},o().createElement("div",{className:"notecard-title",title:this.state.note.subject},this.state.note.subject),o().createElement("label",{className:"notecard-timecontrol"},u.D.getFormattedDateString(this.state.note.modifiedon,this.props.context))),o().createElement(c.L,{languageId:this.props.context.userSettings.languageId,style:{border:"none",marginBottom:"4px"},data:this.state.note.notetext,readOnly:!0,eventHandlers:{}}),o().createElement("div",{className:"notecard-owner-container"},o().createElement(l.Icon,{iconName:s.P.contact.iconName,className:"notecard-owner-avatar"}),o().createElement("label",{className:"notecard-owner-label"},this.state.note["_modifiedby_value@OData.Community.Display.V1.FormattedValue"])),this.state.note.isdocument&&o().createElement(d.w,(0,i.pi)({},this.props,{isEditMode:!1,fileName:null!==(e=this.state.note.filename)&&void 0!==e?e:"",note:this.state.note})))))},t.prototype.getNavCommands=function(){var e=[];return e.push(this.getEditNoteCommand()),e.push(this.getDeleteNoteCommand()),e},t.prototype.getEditNoteCommand=function(){return{toolTipContent:u.D.getLocalizedString("Notes_NotesEditTitle"),iconProps:s.P.notesEdit,ariaLabel:u.D.getLocalizedString("Notes_NotesEditTitle"),commandAction:this.openEditNote.bind(this)}},t.prototype.getDeleteNoteCommand=function(){return{toolTipContent:u.D.getLocalizedString("Notes_NoteDeleteTitle"),iconProps:s.P.deleteNotes,ariaLabel:u.D.getLocalizedString("Notes_NoteDeleteTitle"),commandAction:this.deleteNote.bind(this)}},t.prototype.openEditNote=function(){var e,t;null===(t=null===(e=this.props.viewEventHandlers)||void 0===e?void 0:e.onOpenView)||void 0===t||t.call(e,this.props.entity,a.wO.Edit,this.props.relatedEntity||this.props.entity,this.state.note)},t.prototype.deleteNote=function(){this.setState({showDeleteDialog:!0})},t.prototype.getDeleteDialog=function(){var e={type:m.DialogType.close,title:u.D.getLocalizedString("Tasks_Delete_Task"),closeButtonAriaLabel:u.D.getLocalizedString("InContextView_Cancel"),subText:u.D.getLocalizedString("Notes_Delete_Dialog_Confirmation")};return u.D.reportInfo("getDeleteDialog",v,"",{title:e.title}),o().createElement(h(),{hidden:!1,onDismiss:this.onDialogDismiss.bind(this),dialogContentProps:e},o().createElement(m.DialogFooter,null,o().createElement(p.PrimaryButton,{onClick:this.onDeleteConfirm.bind(this),text:u.D.getLocalizedString("InContextView_Delete")}),o().createElement(p.DefaultButton,{onClick:this.onDialogDismiss.bind(this),text:u.D.getLocalizedString("InContextView_Cancel")})))},t.prototype.onDialogDismiss=function(){u.D.reportUserAction("onDialogDismiss",v,"Confirm note delete dismissed",{noteId:this.state.note.annotationid},f.EJ.CLICK,"Delete note cancel"),this.setState({showDeleteDialog:!1})},t.prototype.onDeleteConfirm=function(){var e=this;u.D.reportUserAction("onDeleteConfirm",v,"Conform note delete clicked",{noteId:this.state.note.annotationid},f.EJ.CLICK,"Delete note confirm");var t=this;this.props.services.dataService.deleteNote(this.state.note.annotationid).then((function(n){var i,r,o,a;n&&n.id&&n.id===t.state.note.annotationid?(u.D.reportInfo("onDeleteConfirm",v,f.dS.SUCCESS,{noteId:e.state.note.annotationid}),null===(r=null===(i=e.props.viewEventHandlers)||void 0===i?void 0:i.navigateBack)||void 0===r||r.call(i)):(u.D.reportError("onDeleteConfirm",v,f.dS.FAILED,{error:"Empty response returned",noteId:e.state.note.annotationid}),null===(a=null===(o=e.props.viewEventHandlers)||void 0===o?void 0:o.setErrorMessage)||void 0===a||a.call(o,u.D.getLocalizedString("Notes_ErrorMessage_Delete_Note"))),e.setState({deletionInProgress:!1})})).catch((function(t){var n,i;u.D.reportError("onDeleteConfirm",v,f.dS.FAILED,{error:t,noteId:e.state.note.annotationid}),null===(i=null===(n=e.props.viewEventHandlers)||void 0===n?void 0:n.setErrorMessage)||void 0===i||i.call(n,u.D.getLocalizedString("Notes_ErrorMessage_Delete_Note"))})),this.setState({deletionInProgress:!0,showDeleteDialog:!1})},t}(o().Component)},12203:function(e,t,n){"use strict";n.d(t,{o:function(){return d}});var i=n(49037),r=n(63804),o=n.n(r),a=n(59731),s=n(78045),l=n(78207),c=n(48945),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={showDialog:!1,actionInProgress:!1},n}return(0,i.ZT)(t,e),t.prototype.render=function(){var e,t,n,i,r,d,u=this;return o().createElement("div",null,o().createElement(s.Persona,{title:null===(e=this.props.personaCardProps)||void 0===e?void 0:e.text,text:null===(t=this.props.personaCardProps)||void 0===t?void 0:t.text,secondaryText:null===(n=this.props.personaCardProps)||void 0===n?void 0:n.secondaryText,onRenderSecondaryText:null===(i=this.props.personaCardProps)||void 0===i?void 0:i.onRenderSecondaryText,showInitialsUntilImageLoads:!0,size:l.PersonaSize.size32,className:null===(r=this.props.personaCardProps)||void 0===r?void 0:r.className,onRenderPersonaCoin:null===(d=this.props.personaCardProps)||void 0===d?void 0:d.onRenderPersonaCoin,imageAlt:c.D.getLocalizedString("ICV_Persona_Icon"),onClick:function(){var e,t,n;(null===(e=u.props.viewEventHandlers)||void 0===e?void 0:e.onOpenView)&&(null===(t=u.props.personaCardProps)||void 0===t?void 0:t.entityId)&&(null===(n=u.props.personaCardProps)||void 0===n?void 0:n.entityType)&&u.props.viewEventHandlers.onOpenView({entityId:u.props.personaCardProps.entityId,entityType:u.props.personaCardProps.entityType},a.wO.Default)}}))},t}(o().Component)},61623:function(e,t,n){"use strict";n.d(t,{x:function(){return C}});var i=n(49037),r=n(48945),o=n(4432),a=n(87018),s=n(63804),l=n.n(s),c=n(59731),d=n(4848),u=n(71520),p=n(99506),m=n(94589),h=n(52618),g=n(97563),f=n(17875),y=n(23436),v="EditTaskView",C=function(e){var t=e.task,n=e.services,C=e.relatedEntity,S=e.viewEventHandlers,E=(0,s.useState)(!0),b=E[0],w=E[1],D=(0,s.useState)(!1),T=D[0],x=D[1],k=(0,s.useState)(e.task.subject),_=k[0],N=k[1],L=(0,s.useState)(),I=L[0],A=L[1],R=(0,s.useState)(),F=R[0],P=R[1],M=["ownerid","scheduledend","prioritycode"];return(0,s.useEffect)((function(){e.recordContainerContext&&e.recordContainerContext.metadataProvider.getEntityMetadata("task",M).then((function(e){A(e),P({recordId:y.Guid.newGuid(),isDirty:!1,isRecordValid:!0,isRecordActive:!0,isValid:new Map([["ownerid",!0]]),notifications:new Map,values:new Map([["ownerid",null],["scheduledend",null],["prioritycode",null]]),formattedValues:new Map([["ownerid",""],["scheduledend",""],["prioritycode",""]]),isReadOnly:new Map([["ownerid",!1],["scheduledend",!1],["prioritycode",!1]]),dirtyAttributes:new Map,attributesLastSaved:new Map,setValue:function(e,t){F&&F.values.set(e,t),P(F)},save:function(){},refresh:function(){}})}))}),[]),T?l().createElement(d.P,{spinnerSize:2,loadingMessage:r.D.getLocalizedString("InContextView_Saving")}):l().createElement("div",{className:"task-editview-container"},l().createElement("div",{className:"task-editview-label-container"},l().createElement(p.Label,null,r.D.getLocalizedString("Tasks_Subject")),l().createElement(p.Label,{styles:{root:{color:o.I.red,paddingLeft:o.B.size4px}}},"*")),l().createElement(u.TextField,{id:"subjectTasks",placeholder:r.D.getLocalizedString("Tasks_Subject"),defaultValue:_,styles:{root:{paddingBottom:m.TS.size10}},onChange:function(e){N(e.target.value),w(!!_)}}),I&&M.map((function(t){return l().createElement(g.J,{recordContainerContext:e.recordContainerContext,entityData:I[0],fieldData:I[1].get(t),dataSetRecord:F,showLabel:!0,customProps:{textStyles:f.l.getFieldTextStyle(I[1].get(t).dataType),showAdditionalPersonaDetails:!0},callbackHandlers:{openEntity:function(){return alert("openEntity clicked")}}})})),l().createElement("div",{className:"task-editview-footer"},l().createElement(a.PrimaryButton,{text:r.D.getLocalizedString("InContextView_Save"),styles:{root:{marginLeft:o.B.size4px}},onClick:function(){if(t.isTemporaryObject){x(!0);var o={subject:_};C&&(o["regardingobjectid_"+C.entityType+"_task@odata.bind"]="/"+r.D.getPluralNameOfEntity(C.entityType)+"("+C.entityId+")"),n.dataService.createTask(o).then((function(){var t,n;null===(n=null===(t=e.viewEventHandlers)||void 0===t?void 0:t.navigateBack)||void 0===n||n.call(t)})).catch((function(n){var i,o;r.D.reportError("onTaskCreate",v,h.dS.FAILED,{error:n,entityId:t.key,dataFields:["subject"]}),null===(o=null===(i=e.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===o||o.call(i,r.D.getLocalizedString("Tasks_ErrorMessage_Create_Task"))})).finally((function(){x(!1)}))}else t.statecode!==c.lP.Completed&&(x(!0),n.dataService.updateTask(t.key,{subject:_}).then((function(){return(0,i.mG)(void 0,void 0,void 0,(function(){var t,n;return(0,i.Jh)(this,(function(i){return null===(n=null===(t=e.viewEventHandlers)||void 0===t?void 0:t.navigateBack)||void 0===n||n.call(t),[2]}))}))})).catch((function(n){var i,o;r.D.reportError("onTaskUpdate",v,h.dS.FAILED,{error:n,entityId:t.key,dataFields:["subject"]}),null===(o=null===(i=e.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===o||o.call(i,r.D.getLocalizedString("Tasks_ErrorMessage_Update_Task"))})).finally((function(){x(!1)})))},disabled:!b}),l().createElement(a.DefaultButton,{text:r.D.getLocalizedString("InContextView_Cancel"),styles:{root:{marginLeft:o.B.size4px}},onClick:function(){var e;r.D.reportUserAction("onCancelClick",v,"Save task cancelled",{taskId:t.key,isCreate:t.isTemporaryObject},h.EJ.CLICK,"Save task cancel button"),null===(e=null==S?void 0:S.navigateBack)||void 0===e||e.call(S)}})))}},35758:function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var i=n(59731),r=function(){function e(){}return e.isToday=function(e){var t=new Date;return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},e.isYesterday=function(e){var t=new Date;return e.getDate()==t.getDate()-1&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},e.isOverdue=function(e){return e.getTime()<Date.now()},e.showEmptyListText=function(e,t,n){return void 0!==e&&0===e.length&&0==t.length&&0==n.length},e.filterTasksByState=function(e){var t=[],n=[];return e.forEach((function(e){e.statecode===i.lP.Completed?n.push(e):t.push(e)})),{inProgTaskList:t,completedTaskList:n}},e.OpenQuickCreateTask=function(e,t,n,i,r){return Promise.resolve(e.navigation.openForm({entityName:"task",useQuickCreateForm:!0},{regardingobjectid:n,regardingobjectidname:i,regardingobjectidtype:r.toLowerCase()}).then((function(e){return e.savedEntityReference?t.fetchTask(e.savedEntityReference[0].id):void 0})))},e}()},58797:function(e,t,n){"use strict";n.d(t,{X:function(){return o},R:function(){return a}});var i=n(19608),r=n(17754).WB.dynPrimary,o=(0,i.mergeStyles)({padding:"0 20px","&:hover":{backgroundColor:"#F3F2F1"},"&:focus-within":{backgroundColor:"#FFF",borderBottom:"1px solid "+r}}),a=(0,i.mergeStyles)({"& .ms-TextField-fieldGroup":{background:"transparent"}})},35691:function(e,t,n){"use strict";n.d(t,{A:function(){return x}});var i=n(49037),r=n(63804),o=n.n(r),a=n(99506),s=n(36711),l=n(14820),c=n(36957),d=n(21259),u=n(17217),p=n(59731),m=n(25453),h=n(48945),g=n(52618),f=n(35758),y=n(87018),v=n(4432),C=n(54988),S=n(94589),E=n(93170),b=n(71520),w=n(84718),D=n(58797),T="TaskListViewItem",x=function(e){var t=e.task,n=e.onTaskStateChanged,x=e.onTaskDeleted,k=e.onTaskCreated,_=e.onTaskUpdated,N=e.dataService,L=e.recordContainerContext,I=e.relatedEntity,A=(0,r.useState)(t.statecode==p.lP.Completed),R=A[0],F=A[1],P=(0,r.useState)(!1),M=P[0],O=P[1],V=(0,r.useState)(!1),z=V[0],B=V[1],U=(0,r.useState)(void 0),H=U[0],G=U[1],W=(0,r.useState)(""),j=W[0],X=W[1],K=(0,r.useState)(""),q=K[0],Z=K[1],J=(0,r.useState)(""),Q=J[0],Y=J[1],$=(0,r.useState)(!1),ee=$[0],te=$[1],ne=(0,r.useState)(t.subject),ie=ne[0],re=ne[1],oe=null;(0,r.useEffect)((function(){var e=t.statecode==p.lP.Completed;X("icv-tasks-lvi-subject"+(e?" icv-tasks-lvi-completed-metadata":""));var n=!1;if(t.dueDate){G(t.friendlyDueDate);var i=null==L?void 0:L.timezoneService.utcToUserLocal(t.dueDate);i&&f.b.isOverdue(i)&&(n=!0),O(n)}re(t.subject);var r=n&&!e?" icv-tasks-lvi-overdue-color":"";Z("icv-tasks-lvi-icon"+r),Y("icv-tasks-lvi-metadata-label"+r),null!=oe&&!0===t.isTemporaryObject&&w.StringUtil.IsNullOrEmpty(ie)&&oe.focus()}),[t,t.statecode,L]);var ae,se=o().useCallback((function(){var i=t.statecode!=p.lP.Completed?p.lP.Completed:p.lP.Open,r=i==p.lP.Completed;F(r),B(!0),N.updateTask(t.key,{statecode:i}).then((function(){t.statecode=i,null==n||n(t,r)})).catch((function(n){var i,r;h.D.reportError("onTaskUpdate",T,g.dS.FAILED,{error:n,entityId:t.key,dataFields:["name"]}),null===(r=null===(i=e.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===r||r.call(i,h.D.getLocalizedString("Tasks_ErrorMessage_Update_Task"))})).finally((function(){B(!1)}))}),[t,e.viewEventHandlers,N.updateTask,n]),le=o().useCallback((function(){t.isTemporaryObject||(te(!1),N.deleteTask(t.key).then((function(){null==x||x(t),h.D.reportUserAction("onTaskDelete",T,"task delete Completed",{},g.EJ.CLICK,"Delete task")})).catch((function(n){var i,r;h.D.reportError("onTaskDelete",T,g.dS.FAILED,{error:n,entityId:t.key,dataFields:["name"]}),null===(r=null===(i=e.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===r||r.call(i,h.D.getLocalizedString("Tasks_ErrorMessage_Delete_Task"))})).finally((function(){B(!1)})))}),[t,e.viewEventHandlers,N.deleteTask,x]),ce=o().useCallback((function(){return(0,i.mG)(void 0,void 0,void 0,(function(){return(0,i.Jh)(this,(function(e){return h.D.openEntityInMFD("task",t.key,(function(){null==_||_()})),[2]}))}))}),[t]),de=function(){h.D.reportUserAction("onDialogDismiss",T,"Confirm task delete dismissed",{},g.EJ.CLICK,"Delete task cancel"),te(!1)},ue=function(){t.isTemporaryObject&&(null==x||x(t))},pe={iconHovered:{color:C.iX.gray160},rootHovered:{backgroundColor:v.I.editDeletIconhover,width:v.B.size22px,height:v.B.size22px}},me=function(){if(t.isTemporaryObject){if(w.StringUtil.IsNullOrEmpty(ie))return void ue();B(!0);var n={subject:ie};I&&(n["regardingobjectid_"+I.entityType+"_task@odata.bind"]="/"+h.D.getPluralNameOfEntity(I.entityType)+"("+I.entityId+")"),N.createTask(n).then((function(e){return(0,i.mG)(void 0,void 0,void 0,(function(){var t;return(0,i.Jh)(this,(function(n){switch(n.label){case 0:return e&&e.entityType&&"task"===e.entityType.toLowerCase()?(ue(),[4,N.fetchTask(e.id)]):[3,2];case 1:(t=n.sent())&&(null==k||k(t)),h.D.reportUserAction("onTaskCreate",T,"task create Completed",{},g.EJ.CLICK,"Create task"),n.label=2;case 2:return[2]}}))}))})).catch((function(n){var i,r;h.D.reportError("onTaskCreate",T,g.dS.FAILED,{error:n,entityId:t.key,dataFields:["subject"]}),null===(r=null===(i=e.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===r||r.call(i,h.D.getLocalizedString("Tasks_ErrorMessage_Create_Task"))})).finally((function(){B(!1)}))}else if(t.statecode!==p.lP.Completed){if(w.StringUtil.IsNullOrEmpty(ie))return void re(t.subject);B(!0),N.updateTask(t.key,{subject:ie}).catch((function(n){var i,r;h.D.reportError("onTaskUpdate",T,g.dS.FAILED,{error:n,entityId:t.key,dataFields:["subject"]}),null===(r=null===(i=e.viewEventHandlers)||void 0===i?void 0:i.openErrorView)||void 0===r||r.call(i,h.D.getLocalizedString("Tasks_ErrorMessage_Update_Task"))})).finally((function(){B(!1)}))}};return o().createElement("div",{className:"taskcard-document-container "+D.X},o().createElement(s.Stack,{horizontal:!0,style:{height:"77px",alignItems:"center"}},o().createElement(d.ActionButton,{disabled:z||t.isTemporaryObject,style:{marginRight:"8px"},onClick:se,ariaLabel:h.D.getLocalizedString("ICV_UpdateTask")},o().createElement(l.Check,{checked:R})),o().createElement(s.Stack,{grow:!0},t.statecode!==p.lP.Completed&&o().createElement(b.TextField,{componentRef:function(e){oe=e},borderless:!0,className:j+" "+D.R,placeholder:h.D.getLocalizedString("Tasks_PlaceHolder_Add_A_Task"),value:ie,onChange:function(e){t.statecode!==p.lP.Completed&&re(e.target.value)},onBlur:me,onKeyDown:function(e){"Escape"==e.key?ue():"Enter"==e.key&&me()}}),t.statecode===p.lP.Completed&&o().createElement(a.Label,{className:j},t.subject),H&&o().createElement(s.Stack,{horizontal:!0,className:"icv-tasks-lvi-metadata-stack-style"},o().createElement(c.Icon,{iconName:"DateTime2",className:q}),o().createElement(a.Label,{className:Q},H)),t.owner&&o().createElement(s.Stack,{horizontal:!0,className:"icv-tasks-lvi-metadata-stack-style"},o().createElement(c.Icon,{iconName:u.P.contact.iconName,className:q}),o().createElement(a.Label,{className:Q},t.owner))),o().createElement("div",{className:"icv-tasks-lvi-right-icon-container"},z&&o().createElement(m.Spinner,{size:m.SpinnerSize.small}),!z&&M&&t.statecode!==p.lP.Completed&&o().createElement(c.Icon,{iconName:"BufferTimeBoth",className:"icv-tasks-lvi-overdue-color"})),void 0===t.isTemporaryObject&&o().createElement("div",{className:"taskcard-editcontrol"},o().createElement(y.IconButton,{title:h.D.getLocalizedString("Tasks_TasksEditTitle"),ariaLabel:h.D.getLocalizedString("Tasks_TasksEditTitle"),styles:pe,iconProps:{iconName:u.P.editTask.iconName,style:{fontSize:S.TS.size14}},className:"taskcard-editcontrol-icon",onClick:ce}),o().createElement(y.IconButton,{title:h.D.getLocalizedString("Tasks_Delete_Task"),ariaLabel:h.D.getLocalizedString("Tasks_Delete_Task"),styles:pe,iconProps:{iconName:u.P.deleteTask.iconName,style:{fontSize:S.TS.size14}},className:"taskcard-deletecontrol-icon",onClick:function(){h.D.reportUserAction("onTaskDeleteClicked",T,"Confirm task delete dialog visible",{},g.EJ.CLICK,"Delete task cancel"),te(!0)}})),!0===t.isTemporaryObject&&o().createElement("div",{className:"taskcard-editcontrol"},o().createElement(y.IconButton,{title:h.D.getLocalizedString("Tasks_Delete_Task"),ariaLabel:h.D.getLocalizedString("Tasks_Delete_Task"),styles:pe,iconProps:{iconName:u.P.deleteTask.iconName,style:{fontSize:S.TS.size14}},className:"taskcard-deletecontrol-icon",onClick:ue})),ee&&(ae={type:E.DialogType.close,title:h.D.getLocalizedString("Tasks_Delete_Task"),closeButtonAriaLabel:h.D.getLocalizedString("InContextView_Cancel"),subText:h.D.getLocalizedString("Tasks_Delete_Dialog_Confirmation")},h.D.reportInfo("getDeleteDialog",T,"",{title:ae.title}),o().createElement(E.Dialog,{hidden:!1,onDismiss:de,dialogContentProps:ae},o().createElement(E.DialogFooter,null,o().createElement(y.PrimaryButton,{onClick:le,text:h.D.getLocalizedString("InContextView_Delete")}),o().createElement(y.DefaultButton,{onClick:de,text:h.D.getLocalizedString("InContextView_Cancel")}))))))}},6401:function(e,t,n){"use strict";n.d(t,{D:function(){return i},P:function(){return x}});var i,r=n(49037),o=n(63804),a=n(59731),s=n(88818),l=n(62863),c=n(28597),d=n(75464),u=n(42093),p=n(1080),m=n(94577),h=n(74662),g=n(5436),f=n(32298),y=n(83291),v=n(30217),C=n(88239),S=n(49545),E=n(52618),b=n(48945),w=n(97369),D=n(61623),T=n(68703);!function(e){e.Default="default",e.Header="header"}(i||(i={}));var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),t.getView=function(e){switch(e.entity.entityType){case a.py.Account:case a.py.Opportunity:case a.py.Contact:case a.py.Lead:return o.createElement(s.S,(0,r.pi)({},e,{key:e.entity.entityId}));case a.py.Task:switch(e.viewMode){case a.wO.Create:return o.createElement(D.x,(0,r.pi)({},e));case a.wO.Edit:return o.createElement(D.x,(0,r.pi)({},e,{task:e.childViewProps}));default:return o.createElement(h.h,(0,r.pi)({},e,{isInlineAddTaskEnabled:!0}))}case a.py.Note:switch(e.viewMode){case a.wO.Default:return o.createElement(l.W,(0,r.pi)({},(0,r.pi)({},e)));case a.wO.Create:return o.createElement(c.B,(0,r.pi)({},(0,r.pi)({},e)));case a.wO.Edit:return o.createElement(c.B,(0,r.pi)({},(0,r.pi)((0,r.pi)({},e),{note:e.childViewProps})));default:return o.createElement(d.E,(0,r.pi)({},(0,r.pi)({},e)))}case a.py.Chat:return o.createElement("div",{className:"chat-view"})}return o.createElement("div",null)},t.getNavigationCommand=function(e,t){var n=t&&t===i.Header?"icv-navigation-topbar-commands-icon "+T.go:"icv-navigation-topbar-commands-icon";return o.createElement(u.TooltipHost,{content:e.toolTipContent,calloutProps:p.w,key:e.ariaLabel},o.createElement(m.IconButton,{id:e.commandId?e.commandId:"icv-navigation-topbar-"+e.iconProps.iconName+"-icon",iconProps:e.iconProps,className:n,style:e.style,ariaLabel:e.ariaLabel,onClick:function(){b.D.reportUserAction("getNavigationCommand","ViewFactory",e.toolTipContent+" is clicked",{},E.EJ.CLICK,e.toolTipContent),e.commandAction()}}))},t.getSectionView=function(e){switch(e.section.key.toLowerCase()){case E.gT.SUMMARY_KEY_DETAILS:var t=o.createElement(g.K,(0,r.pi)({},(0,r.pi)((0,r.pi)({},e),{fixedColumnLayout:2}))),n=w.W.getKeyDetailsShimmer(),i=e.section.rows&&e.section.rows.length>0;return w.W.wrapperComponentInShimmerContainer(t,n,i);case E.gT.SUMMARY_CONTACTS:return o.createElement(f.r,(0,r.pi)({},(0,r.pi)((0,r.pi)({},e),{fixedColumnLayout:1})));case E.gT.SUMMARY_RECENTOPPORTUNITIES:return o.createElement(S.J,(0,r.pi)({},(0,r.pi)({},e)));case E.gT.SUMMARY_NOTES:return o.createElement(y.m,(0,r.pi)({},(0,r.pi)({},e)));case E.gT.SUMMARY_TASKS:return o.createElement(v.e,(0,r.pi)({},(0,r.pi)((0,r.pi)({},e),{isInlineAddTaskEnabled:!0})));case E.gT.SUMMARY_COLLABORATION:return o.createElement(C.K,(0,r.pi)({},(0,r.pi)({},e)));default:return o.createElement(g.K,(0,r.pi)({},(0,r.pi)((0,r.pi)({},e),{fixedColumnLayout:0})))}},t}(o.Component)},77976:function(e,t,n){"use strict";n.d(t,{G:function(){return c}});var i=n(49037),r=n(96990),o=n(58253),a=n(95220),s=n(85563),l=(0,a.Ui)(r.hR,["columnsStatus","entityMetadata","attributesMetadata"]),c=(0,o.$j)((function(e){return(0,i.pi)((0,i.pi)({},e.datasetState),{isOpen:e.navigationState.isFilterPanelOpen})}),(function(e){return{setFilterExpression:function(t){e(a.Fo.setFilterExpression(t))},onDismiss:function(){e(s.c.setFilterPanelIsOpen(!1))}}}))(l)},66309:function(e,t,n){"use strict";n.d(t,{g:function(){return y}});var i=n(49037),r=n(63804),o=n.n(r),a=n(44316),s=n(40005),l=n(59731),c=n(50092),d=n(82361),u=n(48945),p=n(26972),m=n(7587),h=n(35154),g=n(77976),f=n(6432),y=function(e){var t,n=e.chartSettings,i=e.context,r=e.entityType,c=e.initAdminSettings,d=e.initExtraColumns,y=e.isAdminSettingsInitialized,S=e.onRecordUpdate,E=e.refreshGridRecordHandler,b=e.skipRefresh,w=o().useState(!1),D=w[0],T=w[1];o().useEffect((function(){var e=[];u.D.componentStart("app"),T(!0),C(i,r).then((function(t){c(t),e=(0,f.C)(r,t.charts),r===l.py.Opportunity&&d(e)})).catch((function(e){return console.error("failed to get admin settings: "+e)}))}),[i,r,c,d]),o().useEffect((function(){null==E||E((function(e){return S(e)}))}),[S,E]),o().useEffect((function(){D&&y&&(u.D.componentEnd("app"),T(!1))}),[D,y]);var x=o().useRef(),k=o().useRef();if(k.current!==r&&(k.current=r,x.current=void 0),!x.current||!b){var _=e.layoutType,N="list"===_||"combo"===_,L=u.D.getFeatureSupport(r),I=L.isStatsSupported,A=L.isChartSupported&&"combo"===_&&(null==n?void 0:n.some((function(e){return e.status})));x.current=o().createElement(s.Fabric,{className:"DM-Layout-Container"},o().createElement(m.y,null),o().createElement(g.G,null),I&&o().createElement(h.c,null),A&&o().createElement("div",{style:v.roundboxAutoHeight},o().createElement(p.B,{resizeChartComponent:e.resizeChartComponent})),N&&o().createElement(a.e,{dataSetError:i.parameters.Grid.error,dataSetUpdateCounter:e.dataSetUpdateCounter,refreshInContextView:e.refreshInContextView}))}return null!==(t=x.current)&&void 0!==t?t:null},v={roundboxAutoHeight:{boxShadow:"rgba(0, 0, 0, 0.133) 0px 0.6px 5px",marginTop:"16px",height:"auto",borderRadius:"3px"}},C=function(e,t){return(0,i.mG)(void 0,void 0,void 0,(function(){var n,r,o;return(0,i.Jh)(this,(function(a){switch(a.label){case 0:return n=e.webAPI,r=void 0,t===l.py.Opportunity?[3,1]:(r=(0,i.pi)({},d.Jf),[3,3]);case 1:return[4,(0,c.wv)(n)];case 2:o=a.sent(),r=null==o?void 0:o.settings,a.label=3;case 3:return r?[3,5]:[4,(0,c.Kd)(n)];case 4:a.sent()?(r=(0,i.pi)({},d.Sg),console.warn("[App] Falling back to default SI settings.")):(r=(0,i.pi)({},d.he),console.warn("[App] Falling back to default non-SI settings.")),a.label=5;case 5:return[2,r=(0,d.zl)(r,u.D.getLocalizedString("Deal_Tracker"),u.D.getLocalizedString("Sales_Funnel"))]}}))}))}},36591:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var i=n(49037),r=n(66309),o=n(58253),a=n(95220),s=n(55199),l=(0,o.$j)((function(e){var t;return(0,i.pi)((0,i.pi)({},e.datasetState),{isAdminSettingsInitialized:void 0!==e.settingsState.settings,chartSettings:null===(t=e.settingsState.settings)||void 0===t?void 0:t.charts})}),(function(e){return{initExtraColumns:function(t){e(a.Fo.initExtraColumns(t))},onRecordUpdate:function(t){e(a.Fo.updateLastSavedAttributes(t))},initAdminSettings:function(t){e(s.V.initAdminSettings(t))}}}))(r.g)},26972:function(e,t,n){"use strict";n.d(t,{B:function(){return s}});var i=n(58253),r=n(85563),o=n(45159),a=n(95220),s=(0,i.$j)((function(e){var t,n,i,r,o,a,s;return{dataset:e.datasetState.dataset,columnInfo:null===(t=e.datasetState.context)||void 0===t?void 0:t.parameters.Grid.columns,entityType:e.datasetState.entityType,webApi:null===(n=e.datasetState.context)||void 0===n?void 0:n.webAPI,chartSettings:null===(i=e.settingsState.settings)||void 0===i?void 0:i.charts,combinedAggregateFetchXml:e.datasetState.combinedAggregateFetchXml,gridParam:null===(o=null===(r=e.datasetState.context)||void 0===r?void 0:r.parameters)||void 0===o?void 0:o.Grid,entityDisplayCollectionName:null===(s=null===(a=e.datasetState.entityMetadata)||void 0===a?void 0:a.get(e.datasetState.entityType))||void 0===s?void 0:s.displayCollectionName}}),(function(e){return{onClick:function(t,n){e(r.c.openPrimaryEntity({entityId:t,entityType:n}))},setFilterPanelIsOpen:function(t){e(r.c.setFilterPanelIsOpen(t))},modifyFilterExpression:function(t){e(a.Fo.modifyFilterExpression(t))},addColumnsToDataset:function(t){e(a.Fo.addColumnsToDataset(t))}}}))(o.k)},35154:function(e,t,n){"use strict";n.d(t,{c:function(){return a}});var i=n(58253),r=n(3416),o=n(95220),a=(0,i.$j)((function(e){var t;return{dataset:e.datasetState.dataset,context:e.datasetState.context,entityMetadata:null===(t=e.datasetState.entityMetadata)||void 0===t?void 0:t.get(e.datasetState.entityType),dashletList:e.datasetState.dashletList,combinedAggregateFetchXml:e.datasetState.combinedAggregateFetchXml,dashletHasChanges:e.datasetState.dashletHasChanges}}),(function(e){return{setDashletHasChanges:function(t){e(o.Fo.setDashletHasChanges(t))}}}))(r.vL)},7587:function(e,t,n){"use strict";n.d(t,{y:function(){return l}});var i=n(49037),r=n(45401),o=n(58253),a=n(95220),s=n(85563),l=(0,o.$j)((function(e){var t,n;return(0,i.pi)((0,i.pi)({},e.datasetState),{dashletList:e.datasetState.dashletList,selectedView:e.datasetState.viewFilter,entityCollectionName:null===(n=null===(t=e.datasetState.entityMetadata)||void 0===t?void 0:t.get(e.datasetState.entityType))||void 0===n?void 0:n.displayCollectionName,pcfContextWebApi:e.datasetState.context.webAPI})}),(function(e){return{setLayoutType:function(t){e(a.Fo.setLayoutType(t))},setDashletList:function(t){e(a.Fo.setDashletList(t))},setFilterPanelIsOpen:function(t){e(s.c.setFilterPanelIsOpen(t))},setFilterExpression:function(t){e(a.Fo.setFilterExpression(t))},onViewSelected:function(t){e(a.Fo.setViewFilter(t))},setViewHasChanges:function(t){e(a.Fo.setViewHasChanges(t))},setDashletHasChanges:function(t){e(a.Fo.setDashletHasChanges(t))}}}))(r.p)},63856:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var i=n(49037),r=n(58253),o=n(72069),a=(0,n(95220).Ui)(o.d,["attributesMetadata","dataset","entityMetadata"]),s=(0,r.$j)((function(e){return(0,i.pi)((0,i.pi)({},e.datasetState),{webAPI:e.datasetState.context.webAPI,currentView:e.datasetState.viewFilter})}),(function(e){return{}}))(a)},1800:function(e,t,n){"use strict";n.d(t,{L:function(){return c}});var i=n(49037),r=n(58253),o=n(95220),a=n(12684),s=n(85563),l=(0,o.Ui)(a.O,["attributesMetadata","columnsStatus","dataset","firstColumn"]),c=(0,r.$j)((function(e){var t,n;return(0,i.pi)((0,i.pi)({},e.datasetState),{displayCollectionName:null===(n=null===(t=e.datasetState.entityMetadata)||void 0===t?void 0:t.get(e.datasetState.entityType))||void 0===n?void 0:n.displayCollectionName})}),(function(e){return{updateSelectedRecordsCount:function(t){e(o.Fo.updateSelectedRecordsCount(t))},openEntity:function(t,n){e(s.c.openPrimaryEntity({entityId:t,entityType:n}))},updateFirstColumn:function(t){e(o.Fo.updateFirstColumnInGrid(t))},updateColumnStatus:function(t){e(o.Fo.updateColumnStatus(t))},updateColumnsStatus:function(t){e(o.Fo.updateColumnsStatus(t))},updateTotalRowGroupsCount:function(t){e(o.Fo.updateTotalRowGroupsCount(t))},updateRowGroupsCollapsedCount:function(t){e(o.Fo.updateRowGroupsCollapsedCount(t))}}}))(l)},26717:function(e,t,n){"use strict";n.d(t,{b:function(){return c}});var i=n(49037),r=n(58253),o=n(85563),a=n(95220),s=n(86552),l=(0,a.Ui)(s.a,["attributesMetadata","columnsStatus","entityMetadata","firstColumn"]),c=(0,r.$j)((function(e){return(0,i.pi)((0,i.pi)({},e.datasetState),{isEditColumnPanelOpen:e.navigationState.isEditColumnPanelOpen,isDataLoaded:void 0!==e.datasetState.dataset,insertColumnIndex:e.navigationState.insertColumnIndex,insertColumnDirection:e.navigationState.insertColumnDirection,selectedView:e.datasetState.viewFilter})}),(function(e){return{setFilterExpression:function(t){e(a.Fo.setFilterExpression(t))},updateFirstColumn:function(t){e(a.Fo.updateFirstColumnInGrid(t))},updateColumnStatus:function(t){e(a.Fo.updateColumnStatus(t))},updateColumnsStatus:function(t){e(a.Fo.updateColumnsStatus(t))},updateSearchedRecordCount:function(t){e(a.Fo.updateSearchedRecordCount(t))},updateFieldSelectionMap:function(t){e(a.Fo.updateFieldSelectionMap(t))},updateRelationshipMap:function(t){e(a.Fo.updateRelationshipMap(t))},updateColumnsStatusAndDataset:function(t){e(a.Fo.updateColumnsStatusAndDataset(t))},onDismiss:function(){e(o.c.setEntityGridPanelIsOpen({isEditColumnPanelOpen:!1,insertColumnDirection:"",insertColumnIndex:-1}))}}}))(l)},37118:function(e,t,n){"use strict";n.d(t,{C:function(){return r}});var i=n(59731),r=function(e,t){switch(t){case i.py.Account:return o(e);case i.py.Opportunity:return s(e);case i.py.Contact:return a(e);case i.py.Lead:return l(e);default:return e}},o=function(e){return e.filter((function(e){var t=e.commandButtonId.split(".");return"HomepageGrid"===t[1]&&t[2]===i.py.Account})).filter((function(e){var t=e.commandButtonId.split(".");return"Activate"===t[3]||"Deactivate"===t[3]||"Assign"===t[3]}))},a=function(e){return e.filter((function(e){var t=e.commandButtonId.split(".");return"HomepageGrid"===t[1]&&t[2]===i.py.Contact})).filter((function(e){var t=e.commandButtonId.split(".");return"Activate"===t[3]||"Deactivate"===t[3]||"Assign"===t[3]}))},s=function(e){return e.filter((function(e){var t=e.commandButtonId.split(".");return"HomepageGrid"===t[1]&&t[2]===i.py.Opportunity})).filter((function(e){var t=e.commandButtonId.split(".");return"MarkAsWon"===t[3]||"MarkAsLost"===t[3]||"ReopenOpp"===t[3]}))},l=function(e){return e.filter((function(e){var t=e.commandButtonId.split(".");return"HomepageGrid"===t[1]&&t[2]===i.py.Lead})).filter((function(e){return"ConvertLeadQuick"===e.commandButtonId.split(".")[3]}))}},52658:function(e,t,n){"use strict";n.d(t,{G:function(){return L}});var i=n(49037),r=n(40005),o=n(59731),a=n(63804),s=n(1800),l=n(63856),c=n(15480),d=n(47482),u=n(26717),p=n(4476),m=n(58714),h=n(78195),g=n(97563),f=n(68573),y=n(23787),v=n(73186),C=n(28741),S=n(55318),E=n(48945),b=n(12684),w=n(37118),D=n(30443),T=n(20847),x=n(74872),k=n(69041),_=n(14809),N=n(6253),L=function(e){function t(n){var s=e.call(this,n)||this;return s.skipDatasetUpdate=!1,s.getEntityDataInProgress=!1,s.needsCreateColumnsStatus=!0,s.scriptLoaded=!1,s.createColumnsStatus=function(e,t){var n,i=s.props,r=i.columnsStatus,o=i.context,a=i.viewFilter;if(a){var l=o.parameters.Grid;s.needsCreateColumnsStatus=!1;var c=D.C.get(d.ZH.getColumnInfoCacheKey(a.id)),u=null===(n=a.fetchExpression)||void 0===n?void 0:n.linkEntities,p={};return a.columns.forEach((function(t,n){var i,o,a,m,h=t.fullyQualifiedName,g=e.get(h),f=null!==(o=null!==(i=null==c?void 0:c[h])&&void 0!==i?i:null==r?void 0:r[h])&&void 0!==o?o:{fieldName:h,baseFieldName:h,displayName:"",isHidden:!!t.hidden,index:n,width:void 0,isSortingAllowed:!1,rowGroup:!1,rowGroupIndex:void 0,isGroupingAllowed:!d.ZH.isNumericField(null==g?void 0:g.dataType),isExtraColumn:!1,entityType:s.props.entityType},y=l.columns.find((function(e){return e.name===h}));if(y&&(f.isSortingAllowed=!!y&&"MultiSelectPicklist"!==y.dataType),g){if(t.linkEntityAlias&&u){var v=(0,k.$S)(u,t.linkEntityAlias);m=v&&(null===(a=e.get(v.to))||void 0===a?void 0:a.displayName)}f.displayName=g.displayName+(m?" ("+m+")":"")}p[h]=f})),D.C.set(d.ZH.getResetColumnInfoCacheKey(a.id),p),c&&Object.values(c).map((function(t){if(!p[t.fieldName]){e.get(t.fieldName);var n=l.columns.find((function(e){return e.name===t.fieldName}));n&&(t.isSortingAllowed=!!n&&"MultiSelectPicklist"!==n.dataType),p[t.fieldName]=t}})),p}},s.lastRendered=null,s.updateColumnsStatus=function(){if(!s.needsCreateColumnsStatus)return!1;var e=s.props,t=e.attributesMetadata,n=e.entityMetadata;if(!t||!n)return!0;var i=s.createColumnsStatus(t,n);return void 0!==i&&i!==s.props.columnsStatus&&(s.skipDatasetUpdate=!1,s.props.updateColumnsStatus(i)),!0},s.getDialog=function(){var e;switch(null===(e=s.props.dialogStatus)||void 0===e?void 0:e.dialogReason){case o.$M.FieldErrorPreventingHideColumn:var t={type:r.DialogType.normal,showCloseButton:!0,title:E.D.getLocalizedString("WS_Grid_Dialog_Field_Error_Title"),subText:E.D.getLocalizedString("WS_Grid_Dialog_Field_Error_Message")},n=a.createElement(r.DialogFooter,null,a.createElement(r.PrimaryButton,{styles:{root:{background:"#2266E3 !important",borderColor:"#2266E3 !important"}},onClick:function(){s.props.updateDialogStatus({showDialog:!1,dialogReason:o.$M.FieldErrorPreventingHideColumn,additionalInfo:{focusOnErrorField:!0}})},text:E.D.getLocalizedString("WS_Grid_Dialog_Field_Error_PrimaryButton_Text")}));return a.createElement(m.k,{dialogContentProps:t,onDismiss:function(){return s.props.updateDialogStatus({showDialog:!1,dialogReason:o.$M.FieldErrorPreventingHideColumn})},dialogFooter:n});default:return null}},s.canHideColumn=function(e){var t,n,i=null===(t=s.datasetRecords)||void 0===t?void 0:t.find((function(t){return t.notifications.has(e)}));return!i||(s.props.updateDialogStatus({showDialog:!0,dialogReason:o.$M.FieldErrorPreventingHideColumn,additionalInfo:{fieldName:null===(n=i.notifications.entries().next().value)||void 0===n?void 0:n[0]}}),!1)},s.getColumns=function(e,t,n){var i=s.props,r=i.columnsStatus,o=i.context,a=i.viewFilter;if(!r||!a)return[];var l=o.parameters.Grid,c=[];return c.push({headerName:"",field:C.gT.checkboxColumnField,headerCheckboxSelection:!0,checkboxSelection:!0,width:48,resizable:!1,suppressMovable:!0,lockPosition:!0,sortable:!1,editable:!1,filter:!1,suppressKeyboardEvent:function(e){return 32!=e.event.keyCode},suppressHeaderKeyboardEvent:function(e){return!0}}),s.showRevertToDefaultSort=s.showRevertToDefault(),Object.values(r).forEach((function(i){var r,o,a=i.fieldName,d=l.columns.find((function(e){return e.name===a}));if(i.isSmartColumn){var u=(0,_.b)()[i.fieldName];d={alias:i.fieldName,dataType:null!==(r=u.dataType)&&void 0!==r?r:"",disableSorting:!1,displayName:u.displayName,imageProviderFunctionName:"",imageProviderWebresource:"",isHidden:!1,isPrimary:!1,name:u.fieldName,order:i.index,visualSizeFactor:100,attributes:"",validator:""}}if(i&&d){var p=null===(o=s.props.viewFilter)||void 0===o?void 0:o.columns.find((function(e){return e.fullyQualifiedName===a}));d.imageProviderFunctionName=null==p?void 0:p.imageProviderFunctionName,d.imageProviderWebresource=null==p?void 0:p.imageProviderWebresource,c.push({headerName:i.displayName,field:a,width:s.computeColumnWidth(i),hide:i.isHidden,refData:d,rowGroup:!!i.rowGroup,rowGroupIndex:i.rowGroupIndex,showRowGroup:!0,cellRendererFramework:f.v,cellRendererParams:{recordContainerContext:s.recordContainerContext,getCellImageInfo:l.getCellImageInfo,localeId:s.props.context.userSettings.languageId,createFieldControl:s.createFieldControl.bind(s,e),openEntity:function(e){return s.openEntity(e,s.props.entityType,!0)}},headerComponentFramework:y.Z,headerComponentParams:{dataType:null==d?void 0:d.dataType,totalRowGroupsCount:e,rowGroupsCollapsedCount:t,updateRowGroupsCollapsedCount:n,showRevertToDefaultSort:s.getShowRevertToDefaultSort,getFirstColumn:s.getFirstColumn,getColumnsStatus:s.getColumnsStatus,defaultSortInfo:s.props.defaultSortInfo,updateFirstColumn:s.props.updateFirstColumn,updateColumnStatus:s.props.updateColumnStatus,updateColumnsStatus:s.props.updateColumnsStatus,canHideColumn:s.canHideColumn,setEntityGridPanelIsOpen:s.props.setEntityGridPanelIsOpen,setFilterPanelIsOpen:s.props.setFilterPanelIsOpen,filterExpression:s.props.filterExpression},getQuickFilterText:function(e){return e.data.key==C.gT.loadMoreRowKey?b.O.searchTextEntered:e.colDef.hide?void 0:e.data[e.colDef.field]},valueFormatter:function(e){return e.value},keyCreator:function(e){var t=e.value;return null===t?E.D.getLocalizedString("WS_Grid_Grouping_Ungrouped"):t},lockPinned:!0,suppressKeyboardEvent:function(e){return s.suppressKeyboardEvents(e)},suppressHeaderKeyboardEvent:function(e){return s.suppressKeyboardEvents(e)}})}})),c.sort((function(e,t){var n,i;return(null===(n=r[e.field])||void 0===n?void 0:n.index)-(null===(i=r[t.field])||void 0===i?void 0:i.index)}))},s.computeColumnWidth=function(e){var t=s.props.firstColumn===e.fieldName?b.O.firstColWidthParams:b.O.otherColWidthParams;return e.width?Math.max(e.width,t.minWidth):t.defaultWidth},s.showRevertToDefault=function(){var e=s.props,t=e.defaultSortInfo,n=e.columnsStatus;return!!t&&!!n&&t.every((function(e){var t;return!(null===(t=n[e.name])||void 0===t?void 0:t.isHidden)}))&&JSON.stringify(t)!=JSON.stringify(v.f.grid.sorting)},s.getFirstColumn=function(){var e;return null!==(e=s.props.firstColumn)&&void 0!==e?e:""},s.getColumnsStatus=function(){var e;return null!==(e=s.props.columnsStatus)&&void 0!==e?e:{}},s.getShowRevertToDefaultSort=function(){return s.showRevertToDefaultSort},s.createDatasetRecords=function(){var e=s.props,t=e.attributesMetadata,n=e.context,i=e.entityMetadata,r=e.entityType,o=n.parameters.Grid,a=o.paging.totalResultCount;E.D.reportInfo("createDatasetRecords","layout","Number of rows in dataset: "+a,{totalRows:a});var l=o.columns.map((function(e){return e.name}));s.recordContainerContext=p._.getContainerContext(s.props.context),s.datasetRecords=i&&t&&r?d.ZH.createDatasetForFieldFactory(o,l,i.get(r),t,s.recordContainerContext,s.buildRecordUpdateHandler):[],E.D.reportInfo("createDatasetRecords","layout","Updated dataset",{}),s.props.updateDataset(Object.assign([],s.datasetRecords))},s.buildRecordUpdateHandler=function(e){var t=e.dataSetRecord,n=s.datasetRecords.findIndex((function(e){return e.recordId==t.recordId}));if(-1!==n){var i=s.datasetRecords[n];if(E.D.reportInfo("buildRecordUpdateHandler","layout","Update type: "+e.updateType,{}),(i.notifications.size>0||i.isSaveInProgress)&&(E.D.reportInfo("buildRecordUpdateHandler","layout",i.isSaveInProgress?"Field save in progress so refreshing that row to block other fields from being edited":"Field has an error so refreshing that row to block other fields from being edited",{}),s.refreshRow(i)),0!=e.updateType&&(i.values.forEach((function(e,n){var r=t.values.get(n);r&&e!=r&&i.values.set(n,r)})),i.formattedValues.forEach((function(e,n){var r=t.formattedValues.get(n);r&&e!=r&&i.formattedValues.set(n,r)})),s.props.updateRecord(i)),3==e.updateType||6==e.updateType){var r=S.Z.getRowLoadHandler();r&&r(s.getExecutionContext(i)),s.refreshRow(i),s.props.refreshInContextView(i.recordId)}}},s.getExecutionContext=function(e){var t=new h.ExecutionContextInputMetadata(s.props.entityMetadata.get(s.props.entityType)||{},s.props.attributesMetadata,d.ZH.getColumnsFromAttributeMetadata(s.props.attributesMetadata),s.props.context.webAPI);return h.ExecutionContextHelper.getExecutionContext(t,s.getRecordClientApi(e),e,void 0,{})},s.getRecordClientApi=function(e){return{setNotification:function(){},getNotification:function(){return""},getDisabled:function(t){return e.isReadOnly.get(t)||!0},setDisabled:function(t,n){var i=e.isReadOnly.get(t);!t||null!=i&&i==n||(e.isReadOnly.set(t,n),s.updateRecord(e))}}},s.refreshRow=function(e){var t=b.O.getRowNode(e.recordId);t&&b.O.refreshCells({rowNodes:[t],force:!0})},s.filterCommands=function(e){var t=s.props.entityType;return(0,w.C)(e,t).filter((function(e){return e.shouldBeVisible}))},s.createFieldControl=function(e,t,n,i){var r,o,l=s.props,c=l.entityMetadata,d=l.attributesMetadata,u=s.datasetRecords.find((function(e){return e.recordId==i}));if(!u||!c||!d)return a.createElement("div",null);var m=d.get(n),h=s.props.firstColumn===(null==m?void 0:m.name),f=s.filterCommands,y=n,C=(0,_.b)()[n];if(C){var S=u.values.get("statecode");y=C.computeField(S)}var b=d.get(y);return a.createElement(g.J,{recordContainerContext:t,entityData:c.get(y)||c.get(s.props.entityType),fieldData:b,dataSetRecordEntityMetaData:c.get(s.props.entityType),dataSetRecord:u,showLabel:!1,isEditable:null===(r=v.f.grid.records[i])||void 0===r?void 0:r.isEditable(y),customProps:{textStyles:s.getFieldTextStyle(null==m?void 0:m.dataType),showQuickActions:h,createCommands:{getRecordCommands:function(){return v.f.grid.retrieveRecordCommand([i],[])},customFilter:f},shouldAddAdditionalClass:e>0},callbackHandlers:{openEntity:function(e,t,n){return s.openEntity(e,t,n)},updateRecord:function(e){return s.updateRecord(e)},isChannelIntegrationFrameworkSupported:function(){return E.D.isChannelIntegrationFrameworkSupported()}},attributesMetadata:s.props.attributesMetadata,columns:null===(o=s.props.viewFilter)||void 0===o?void 0:o.columns.map((function(e){return e.fullyQualifiedName})),webAPI:s.props.context.webAPI,shouldRenderPlainTextInitially:!0,dataService:new x.D(s.props.context,p._.getContainerContext(s.props.context))})},s.updateRecord=function(e){E.D.reportInfo("updateRecord","layout","Update record and refresh grid called",{}),s.props.updateRecord(e);var t=s.datasetRecords.findIndex((function(t){return t.recordId==e.recordId}));s.datasetRecords[t]=e,s.refreshRow(e),E.D.reportInfo("updateRecord","layout","Update record and refresh grid completed",{})},s.getFieldTextStyle=function(e){switch(e){case r.EDataType.Lookup:case r.EDataType.Customer:case r.EDataType.Owner:return{fontSize:"14px",fontWeight:"normal",color:"#2266E3"};default:return{fontSize:"14px",fontWeight:"normal"}}},s.openEntity=function(e,t,n){void 0===n&&(n=!1),t!=o.py.Opportunity&&t!=o.py.Contact&&t!=o.py.Account&&t!=o.py.Lead||n?(E.D.reportUserAction("openEntity","layout","Open entity in MFD",{},"Open entity in MFD",t),E.D.openEntityInMFD(t.toString().toLowerCase(),e,(function(){v.f.reload(),s.props.refreshInContextView(e)}))):(E.D.TriggerSurvey("dealmanagerevent","dealmanageroverall"),s.props.onOpenEntity(e,t))},s.getEntityMetadata=function(){var e=s.props,t=e.context,n=e.entityType,r=e.entityMetadata,o=e.attributesMetadata,a=e.viewFilter,l=s.recordContainerContext.metadataProvider,c=t.parameters.Grid,u=[],p=[];c.columns.forEach((function(e){if(e.name&&!(null==o?void 0:o.get(e.name))){var t=(0,d.xM)(e.name);void 0!==t.linkEntityAlias?p.push(t):u.push(e.name)}}));var m=D.C.get(d.ZH.getColumnInfoCacheKey(null==a?void 0:a.id));m&&Object.values(m).forEach((function(e){var t;if(!e.isSmartColumn&&!(null==o?void 0:o.get(e.fieldName))){var n=(0,d.xM)(e.fieldName);void 0!==n.linkEntityAlias?(p.push(n),e.linkedEntity&&u.push(null===(t=e.linkedEntity)||void 0===t?void 0:t.to)):u.push(e.fieldName)}}));var h=[];if((!(null==r?void 0:r.get(n))||u.length>0)&&h.push(l.getEntityMetadata(n,u)),E.D.reportInfo("getEntityMetadata","layout","Fetching entity metadata",{}),p.length>0){var g=s.getLinkedEntitiesMetadata(c.linking.getLinkedEntities(),p,l);h=h.concat(g)}if(h.length>0){s.getEntityDataInProgress=!0;var f=new Map(null!=r?r:[]),y=new Map(null!=o?o:[]);return Promise.all(h).then((function(e){var r,o;E.D.reportInfo("getEntityMetadata","layout","Fetching linked entity metadata",{}),e.forEach((function(e){var t=e[0],n=e[1];f.set(t.name,t),n.forEach((function(e){var n=p.find((function(t){return t.name===e.name}));if(n){var i=n.fullyQualifiedName;f.set(i,t),e.name=i,y.set(i,e)}else y.set(e.name,e)}))}));var a=s.createColumnsStatus(y,f),l=s.props.firstColumn||(null===(r=c.columns.filter((function(e){return 0==e.order}))[0])||void 0===r?void 0:r.name)||c.columns[0].name,d=(0,i.pr)(c.sorting);s.skipDatasetUpdate=!1,s.getEntityDataInProgress=!1,s.props.updateMetadata({entityMetadata:f,attributesMetadata:y,firstColumn:l,columnsStatus:null!==(o=null!=a?a:s.props.columnsStatus)&&void 0!==o?o:{},defaultSortInfo:d});var u=f.get(n);u&&E.D.updatePageTitle(u.displayCollectionName+" - "+t.resources.getString("CC_DealManager_Page_Title"))})).catch((function(e){s.getEntityDataInProgress=!1,E.D.reportError("getEntityMetadata","layout","Error occured in getEntityMetadata",{error:e.toString()})})),!0}return!1},s.getLinkedEntitiesMetadata=function(e,t,n){var i=[],r=new Map;return e.forEach((function(e){var n,i=t.filter((function(t){return t.linkEntityAlias===e.alias})).map((function(e){return e.name})),o=null!==(n=r.get(e.name))&&void 0!==n?n:[];r.set(e.name,i.concat(o))})),r.forEach((function(e,t){i.push(n.getEntityMetadata(t,e))})),i},s.state={},E.D.componentStart(t.componentName),setTimeout((function(){T.V.preFetch(n.context),E.D.InitializeChannelIntegrationFameworkState()}),8e3),s}return(0,i.ZT)(t,e),t.prototype.componentDidUpdate=function(e){var n,i,r,a,s,l,c;0==(null===(n=this.props.dialogStatus)||void 0===n?void 0:n.showDialog)&&1==(null===(i=e.dialogStatus)||void 0===i?void 0:i.showDialog)&&(null===(r=e.dialogStatus)||void 0===r?void 0:r.dialogReason)==o.$M.FieldErrorPreventingHideColumn&&1==(null===(s=null===(a=this.props.dialogStatus)||void 0===a?void 0:a.additionalInfo)||void 0===s?void 0:s.focusOnErrorField)&&E.D.showErrorField((null===(c=null===(l=e.dialogStatus)||void 0===l?void 0:l.additionalInfo)||void 0===c?void 0:c.fieldName)+C.gT.fieldErrorClassName),this.props.entityMetadata&&E.D.componentEnd(t.componentName),this.props.webResource&&!this.scriptLoaded&&(S.Z.loadScripts(this.props.webResource.name,this.props.context),this.scriptLoaded=!0)},t.prototype.shouldComponentUpdate=function(e){return this.props.dataSetUpdateCounter!==e.dataSetUpdateCounter&&(this.needsCreateColumnsStatus=!0,this.skipDatasetUpdate=!1,v.f.loadMoreRowsClicked?v.f.loadMoreRowsClicked=!1:b.O.refreshCells({force:!0})),!0},t.prototype.render=function(){var e,t,n,r,o=this.props,d=o.context,m=o.entityType,h=o.entityMetadata,g=o.combinedAggregateFetchXml,f=o.viewFilter;if(!d||!m)return null;var y=null==h?void 0:h.get(m),S=d.parameters.Grid;if(S.loading){if(this.lastRendered&&this.skipDatasetUpdate)return this.lastRendered}else{this.recordContainerContext=p._.getContainerContext(d),v.f.grid!==S&&(v.f.initialize(S),this.needsCreateColumnsStatus=!0,this.skipDatasetUpdate=!1),this.state.lastCombinedAggregateFetchXml!==g&&void 0!==g&&void 0!==y&&(this.setState({lastCombinedAggregateFetchXml:g,totalRecordsCount:void 0}),(0,i.mG)(this,void 0,void 0,(function(){var e,t,n,r,o;return(0,i.Jh)(this,(function(i){switch(i.label){case 0:e=encodeURIComponent("<fetch distinct='false' mapping='logical' aggregate='true'><entity name='"+m+"'><attribute name='"+y.primaryIdField+"' alias='recordcount' aggregate='count' />"+g+"</entity></fetch>"),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,d.webAPI.retrieveMultipleRecords(m,"?fetchXml="+e)];case 2:return t=i.sent(),this.setState({totalRecordsCount:null===(o=null===(r=null==t?void 0:t.entities)||void 0===r?void 0:r[0])||void 0===o?void 0:o.recordcount}),[3,4];case 3:return n=i.sent(),console.error("Failed to get record count: "+n),[3,4];case 4:return[2]}}))})));var b=null==f?void 0:f.id;this.lastViewId!==b&&(this.needsCreateColumnsStatus=!0,E.D.reportUserAction("render","layout",this.lastViewId?"View changed from "+this.lastViewId+" to "+b:"Initial load with view "+b,this.lastViewId?{previousView:this.lastViewId,currentView:b}:{currentView:b},this.lastViewId?"View changed":"Initial load",""),this.lastViewId=b,this.skipDatasetUpdate=!1),!b||this.getEntityDataInProgress||this.getEntityMetadata()||this.updateColumnsStatus()||this.skipDatasetUpdate||(this.createDatasetRecords(),this.skipDatasetUpdate=!0)}return this.lastRendered=a.createElement(a.Fragment,null,a.createElement("div",{className:"entityGridDiv"},this.props.dataSetError?a.createElement(N.u,{getScenario:function(){return C.yW.Error}}):a.createElement(a.Fragment,null,a.createElement(c.e,{recordsVisible:null!==(t=null===(e=this.datasetRecords)||void 0===e?void 0:e.length)&&void 0!==t?t:0,totalRecords:null!==(n=this.state.totalRecordsCount)&&void 0!==n?n:0,canHideColumn:this.canHideColumn}),a.createElement(l.h,{recordContainerContext:this.recordContainerContext}),a.createElement(s.L,{getColumns:this.getColumns,onRowSelectionChanged:v.f.onRowSelectionChanged,getExecutionContext:this.getExecutionContext}),a.createElement(u.b,{canHideColumn:this.canHideColumn}))),(null===(r=this.props.dialogStatus)||void 0===r?void 0:r.showDialog)&&this.getDialog()),this.lastRendered},t.prototype.suppressKeyboardEvents=function(e){var t=e.columnApi.getAllDisplayedColumns(),n=e.event.keyCode;return t[1].colId===e.column.colId?!(9==n&&e.event.shiftKey):t[t.length-1].colId!==e.column.colId||!(9==n&&!e.event.shiftKey&&null==e.event.target.querySelector("[tabindex='0']"))},t.componentName="FullGrid",t}(a.Component)},44316:function(e,t,n){"use strict";n.d(t,{e:function(){return d}});var i=n(49037),r=n(58253),o=n(52658),a=n(85563),s=n(95220),l=n(48945),c=n(28741),d=(0,r.$j)((function(e){var t,n;return(0,i.pi)((0,i.pi)({},e.datasetState),{webResource:(null===(n=null===(t=e.settingsState.settings)||void 0===t?void 0:t.webResources)||void 0===n?void 0:n[0])||void 0})}),(function(e){return{onResize:function(t){e(a.c.sidePanelResize(t))},onOpenEntity:function(t,n){l.D.reportUserAction("onOpenEntity","entityGridContainer","opened InContextView",{},"open entity",n.toString()),l.D.scenarioStart(c.BG.openInContextView),e(a.c.openPrimaryEntity({entityId:t,entityType:n}))},updateMetadata:function(t){e(s.Fo.updateMetadata(t))},updateDataset:function(t){e(s.Fo.updateDataset(t))},updateRecord:function(t){e(s.Fo.updateRecord(t))},updateFirstColumn:function(t){e(s.Fo.updateFirstColumnInGrid(t))},updateColumnStatus:function(t){e(s.Fo.updateColumnStatus(t))},updateColumnsStatus:function(t){e(s.Fo.updateColumnsStatus(t))},updateDialogStatus:function(t){e(s.Fo.updateDialogStatus(t))},setFilterPanelIsOpen:function(t){e(a.c.setFilterPanelIsOpen(t))},setEntityGridPanelIsOpen:function(t){e(a.c.setEntityGridPanelIsOpen({isEditColumnPanelOpen:t.isEditColumnPanelOpen,insertColumnDirection:t.insertColumnDirection,insertColumnIndex:t.insertColumnIndex}))}}}))(o.G)},15480:function(e,t,n){"use strict";n.d(t,{e:function(){return c}});var i=n(49037),r=n(58253),o=n(95220),a=n(85563),s=n(91140),l=(0,o.Ui)(s.S,["entityMetadata","attributesMetadata","firstColumn","columnsStatus"]),c=(0,r.$j)((function(e){var t,n=null===(t=e.datasetState.entityMetadata)||void 0===t?void 0:t.get(e.datasetState.entityType);return(0,i.pi)((0,i.pi)({},e.datasetState),{isDataLoaded:void 0!==e.datasetState.dataset,selectedView:e.datasetState.viewFilter,isFiltered:void 0!==e.datasetState.filterExpression,displayCollectionName:null==n?void 0:n.displayCollectionName,entityDisplayName:null==n?void 0:n.displayName})}),(function(e){return{updateFirstColumn:function(t){e(o.Fo.updateFirstColumnInGrid(t))},updateColumnStatus:function(t){e(o.Fo.updateColumnStatus(t))},updateColumnsStatus:function(t){e(o.Fo.updateColumnsStatus(t))},updateSearchedRecordCount:function(t){e(o.Fo.updateSearchedRecordCount(t))},onViewSelected:function(t){e(o.Fo.setViewFilter(t))},setEntityGridPanelIsOpen:function(t){e(a.c.setEntityGridPanelIsOpen({isEditColumnPanelOpen:t.isEditColumnPanelOpen,insertColumnDirection:t.insertColumnDirection,insertColumnIndex:t.insertColumnIndex}))}}}))(l)},93313:function(e,t,n){"use strict";n.r(t),n.d(t,{EnhancedGridControl:function(){return C},DealManagerSettingsComponent:function(){return d.R},CommonUtils:function(){return c.D},InContextView:function(){return p.m},Chart:function(){return m.k},convertDataSetForChart:function(){return m.i},DashletPanel:function(){return h.vL},defaultDashletList:function(){return h.ol},EntityGrid:function(){return g.O},defaultSettings:function(){return f.he},EntityType:function(){return y.py}});var i=n(63804),r=n.n(i),o=n(40005),a=n(36591),s=n(58253),l=n(59531),c=n(48945),d=n(98515),u=n(95220),p=n(55535),m=n(45159),h=n(3416),g=n(12684),f=n(82361),y=n(59731);window.__cachedPromise&&window.__cachedPromise!=window.Promise&&(window.Promise=window.__cachedPromise),(0,o.initializeIcons)(),(0,o.initializeFileTypeIcons)();var v=null,C=function(e,t,n,i,o){c.D.initializeContext(e);var d=l.C.getState().datasetState,p=d.context,m=d.entityType;return p===e&&m===t||(l.C.dispatch(u.Fo.initControl(e,t)),l.C.subscribe((function(){var e=l.C.getState().navigationState.primaryEntity;v!==e&&(v=e,n.onOpenEntity(v))}))),r().createElement(s.zt,{store:l.C},r().createElement(a.z,{dataSetUpdateCounter:i,skipRefresh:o,refreshInContextView:n.refreshInContextView,refreshGridRecordHandler:n.refreshGridRecordHandler,resizeChartComponent:n.resizeChartComponent}))}},20847:function(e,t,n){"use strict";n.d(t,{V:function(){return i}});var i=function(){function e(){}return e.preFetch=function(e){},e}()},95220:function(e,t,n){"use strict";n.d(t,{MB:function(){return h},Ui:function(){return S},Fo:function(){return E}});var i=n(49037),r=n(40005),o=n(30443),a=n(47482),s=n(12684),l=n(69041),c=n(63804),d=n.n(c),u=n(14809),p=n(3416),m={layoutType:"combo",initialLoad:!0,viewHasChanges:!1,dashletHasChanges:!1,totalRowGroupsCount:0,rowGroupsCollapsedCount:0,selectedRecordsCount:0,searchedRecordCount:0,dataset:void 0,filterExpression:void 0,firstColumn:void 0,columnsStatus:void 0,defaultSortInfo:void 0,dialogStatus:void 0,showSpinnerInEmptyStateControl:void 0,viewFilter:void 0,extraLinkEntities:void 0,extraColumns:[],combinedAggregateFetchXml:void 0,fieldSelectionMap:void 0,relationshipsMap:void 0,dashletList:[]},h=function(e,t){var n,s,l,c,d;if(void 0===e)return{};switch(t.type){case"INIT_CONTROL":var u=t.state.entityType;o.C.setPrefix(u);var h=o.C.get("msdyn_dashlet_selection",p.ol);return(0,i.pi)((0,i.pi)((0,i.pi)((0,i.pi)({},m),{layoutType:o.C.get("layoutType","combo"),filterExpression:o.C.get("filterExpression")}),t.state),{dashletList:h,extraColumns:[{entityName:u,fieldName:r.DataSetUtils.getStateCodeAttributeNameFromEntity(u)}]});case"INIT_EXTRA_COLUMNS":var g=(0,i.pi)({},e);return f(g,(0,i.pr)(t.chartFieldConfigs,y(e.entityType))),g;case"UPDATE_METADATA":return(0,i.pi)((0,i.pi)({},e),t.state);case"UPDATE_SELECTED_RECORDS_COUNT":return(0,i.pi)((0,i.pi)({},e),{selectedRecordsCount:t.selectedRecordsCount});case"UPDATE_DIALOG_STATUS":return(0,i.pi)((0,i.pi)({},e),{dialogStatus:t.dialogStatus});case"UPDATE_TOTAL_ROW_GROUPS_COUNT":return(0,i.pi)((0,i.pi)({},e),{totalRowGroupsCount:t.totalRowGroupsCount,rowGroupsCollapsedCount:t.totalRowGroupsCount});case"UPDATE_COLLAPSED_ROW_GROUPS_COUNT":return(0,i.pi)((0,i.pi)({},e),{rowGroupsCollapsedCount:t.rowGroupsCollapsedCount});case"UPDATE_SEARCHED_RECORD_COUNT":return(0,i.pi)((0,i.pi)({},e),{searchedRecordCount:t.searchedRecordCount});case"UPDATE_DATASET":return(0,i.pi)((0,i.pi)({},e),{dataset:t.dataset,showSpinnerInEmptyStateControl:!1});case"UPDATE_LAST_SAVED_ATTRIBUTES":var C=null===(s=e.dataset)||void 0===s?void 0:s.find((function(e){return e.recordId===t.record.recordId}));return null==C||C.refresh(),(0,i.pi)({},e);case"UPDATE_RECORD":return(0,i.pi)((0,i.pi)({},e),{dataset:e.dataset&&(0,a.A7)(e.dataset,t.record,"recordId")});case"MODIFY_FILTER_EXPRESSION":var S=(0,i.pi)((0,i.pi)({},e),{filterExpression:t.filterModifierFunc(e.filterExpression),showSpinnerInEmptyStateControl:!0});return v(e,S),S;case"UPDATE_COLUMN_STATUS":var E=t.currentColumnStatus.fieldName,b=(0,i.pi)((0,i.pi)({},e.columnsStatus),((n={})[E]=t.currentColumnStatus,n));return o.C.set(a.ZH.getColumnInfoCacheKey(null===(l=e.viewFilter)||void 0===l?void 0:l.id),b),(0,i.pi)((0,i.pi)({},e),{columnsStatus:b});case"UPDATE_COLUMNS_STATUS":return o.C.set(a.ZH.getColumnInfoCacheKey(null===(c=e.viewFilter)||void 0===c?void 0:c.id),t.columnsStatus),(0,i.pi)((0,i.pi)({},e),{columnsStatus:t.columnsStatus});case"UPDATE_FIRST_COLUMN_IN_GRID":return(0,i.pi)((0,i.pi)({},e),{firstColumn:t.firstColumn});case"SET_LAYOUT_TYPE":return o.C.set("layoutType",t.layoutType),(0,i.pi)((0,i.pi)({},e),{layoutType:t.layoutType});case"SET_VIEW_FILTER":var w=(0,i.pi)((0,i.pi)({},e),{viewFilter:t.viewFilter});return v(e,w),w;case"ADD_COLUMNS":var D=(0,i.pi)({},e);return f(D,t.columns),v(e,D),D;case"UPDATE_COLUMNS_STATUS_DATASET":o.C.set(a.ZH.getColumnInfoCacheKey(null===(d=e.viewFilter)||void 0===d?void 0:d.id),t.columnsStatus);var T=(0,i.pi)((0,i.pi)({},e),{columnsStatus:t.columnsStatus});return v(e,T),T;case"UPDATE_FIELD_SELECTION_MAP":return(0,i.pi)((0,i.pi)({},e),{fieldSelectionMap:t.fieldSelectionMap});case"UPDATE_RELATIONSHIP_MAP":return(0,i.pi)((0,i.pi)({},e),{relationshipsMap:t.relationshipMap});case"UPDATE_VIEW_HAS_CHANGES":return(0,i.pi)((0,i.pi)({},e),{viewHasChanges:t.viewHasChanges});case"UPDATE_DASHLET_HAS_CHANGES":return(0,i.pi)((0,i.pi)({},e),{dashletHasChanges:t.dashletHasChanges});case"SET_DASHLET_LIST":return(0,i.pi)((0,i.pi)({},e),{dashletList:t.dashletList});default:return e}},g=function(e,t){var n,i,r,o;return e===t||e.fieldName===t.fieldName&&e.entityName===t.entityName&&(null===(n=e.linkEntity)||void 0===n?void 0:n.from)===(null===(i=t.linkEntity)||void 0===i?void 0:i.from)&&(null===(r=e.linkEntity)||void 0===r?void 0:r.to)===(null===(o=t.linkEntity)||void 0===o?void 0:o.to)},f=function(e,t){if(0!==e.extraColumns.length)for(var n=function(t){e.extraColumns.some((function(e){return g(e,t)}))||e.extraColumns.push(t)},i=0,r=t;i<r.length;i++)n(r[i]);else e.extraColumns=t},y=function(e){return"opportunity"===e?[{entityName:e,fieldName:"parentaccountid"},{entityName:e,fieldName:"parentcontactid"}]:[]},v=function(e,t){var n,c,d,p,m,h,f,y,v,S,E,b,w,D,T=null===(n=t.context)||void 0===n?void 0:n.parameters.Grid;if(null==T?void 0:T.error)null===(c=window.MscrmControls)||void 0===c||c.Sales.DealManager.WrapperContainer.executeRefreshOnInvalidDataSet();else if(T&&t.viewFilter&&t.entityType){if(T.loading&&!t.initialLoad)throw new Error("doing a refresh before the grid has finished loading will put it into a bad state");var x=void 0,k=[];if(e.filterExpression!==t.filterExpression||(null===(d=e.viewFilter)||void 0===d?void 0:d.fetchExpression)!==t.viewFilter.fetchExpression){var _=null!==(p=t.viewFilter.fetchExpression)&&void 0!==p?p:{entityName:t.entityType,linkEntities:[]},N=(0,l.L3)(_,t.filterExpression);N.filters?T.filtering.setFilter(N.filters):T.filtering.clearFilter(),x=null!==(m=N.linkEntities)&&void 0!==m?m:[];var L=t.filterExpression&&(0,r.convertFilterExpressionToFetchXmlModifiedFromPlatform)(t.filterExpression),I=L?(0,l.s6)(L):{},A=t.viewFilter.fetchXml,R=null!==(y=A&&(null===(f=null===(h=(0,l.s6)(A))||void 0===h?void 0:h.fetch)||void 0===f?void 0:f.entity))&&void 0!==y?y:{};(0,l.r9)(I,R),(0,l.Xd)(I),t.combinedAggregateFetchXml=(0,l.ep)(I)}void 0===t.extraLinkEntities&&(t.extraLinkEntities=[]);for(var F=null!==(v=T.linking.getLinkedEntities())&&void 0!==v?v:[],P=0,M=T.columns;P<M.length;P++){var O=M[P],V=null===(S=O.name)||void 0===S?void 0:S.indexOf(".");if(V>0){var z=O.name.slice(0,V);if(!(0,l.$S)(t.extraLinkEntities,z)){var B=(0,l.$S)(F,z);if(B){var U=(0,l.CL)(B);t.extraLinkEntities.push(U)}else console.error("Failed to find link entity alias ("+z+") required for column "+O.name)}}}if(e.viewFilter!==t.viewFilter){T.sorting.length=0;for(var H=0,G=t.viewFilter.columns;H<G.length;H++){var W=G[H];k.push(W)}}var j=o.C.get(a.ZH.getColumnInfoCacheKey(null===(E=t.viewFilter)||void 0===E?void 0:E.id)),X=(0,u.b)();j&&Object.values(j).map((function(e){var n=[];e.isSmartColumn?e.fieldName in X&&(n=X[e.fieldName].sourceFields.map((function(t){return{entityName:e.entityType,fieldName:t}}))):e.isExtraColumn&&(n=[{entityName:e.entityType,fieldName:e.baseFieldName,linkEntity:e.linkedEntity}]);for(var i=function(e){t.extraColumns.some((function(t){return g(t,e)}))||t.extraColumns.push(e)},r=0,o=n;r<o.length;r++)i(o[r])}));for(var K=function(e){if(e.fullyQualifiedName){if(T.columns.some((function(t){return t.name===e.fullyQualifiedName})))return t.columnsStatus&&t.columnsStatus[e.fieldName]&&e.fullyQualifiedName!==t.columnsStatus[e.fieldName].fieldName&&C(t,e.fieldName,e.fullyQualifiedName),"continue";console.warn("didn't find a column in dataset: "+e.fullyQualifiedName)}var n=void 0;if(e.linkEntity){var r=(0,l.pr)(t.extraLinkEntities,e.linkEntity);!r&&x&&(r=(0,l.pr)(x,e.linkEntity)),r||(r=(0,i.pi)((0,i.pi)({},e.linkEntity),{linkType:"outer",alias:"__"+e.linkEntity.name+"_"+e.linkEntity.from+"_"+e.linkEntity.to+"_outer"}),(x=null!=x?x:[]).push(r)),n=r.alias}k.push({name:e.fieldName,linkEntityAlias:n}),e.fullyQualifiedName=n?n+"."+e.fieldName:e.fieldName,t.columnsStatus&&t.columnsStatus[e.fieldName]&&C(t,e.fieldName,e.fullyQualifiedName)},q=0,Z=t.extraColumns;q<Z.length;q++)K(Z[q]);if(void 0!==x)if(T.linking.clear){T.linking.clear(),x.forEach((function(e){return T.linking.addLinkedEntity(e)}));for(var J=0,Q=null!==(b=t.extraLinkEntities)&&void 0!==b?b:[];J<Q.length;J++){var Y=Q[J];(0,l.$S)(x,Y.alias)||T.linking.addLinkedEntity(Y)}}else console.error("Unable to clear linked entities from dataset - this will prevent some views from working properly");k.forEach((function(e){var t;null===(t=T.addColumn)||void 0===t||t.call(T,e.name,e.linkEntityAlias)})),null===(D=null===(w=t.viewFilter)||void 0===w?void 0:w.columnSortingOrder)||void 0===D||D.forEach((function(e){T.sorting.push({name:e.name,sortDirection:"asc"===e.sort?0:1})})),t.initialLoad=!1,s.O.showLoadingOverlay(),T.refresh()}},C=function(e,t,n){var r;if(e.columnsStatus){var s=e.columnsStatus[t],l=e.columnsStatus,c=t,d=(l[c],(0,i._T)(l,["symbol"==typeof c?c:c+""]));d[n]=s,d[n].fieldName=n,e.columnsStatus=d,o.C.set(a.ZH.getColumnInfoCacheKey(null===(r=e.viewFilter)||void 0===r?void 0:r.id),e.columnsStatus)}},S=function(e,t,n){return void 0===n&&(n=null),function(i){for(var r=0,o=t;r<o.length;r++)if(void 0===i[o[r]])return n;return d().createElement(e,i)}},E={initControl:function(e,t){return{type:"INIT_CONTROL",state:{context:e,entityType:t}}},initExtraColumns:function(e){return{type:"INIT_EXTRA_COLUMNS",chartFieldConfigs:e}},updateMetadata:function(e){return{type:"UPDATE_METADATA",state:e}},updateDataset:function(e){return{type:"UPDATE_DATASET",dataset:e}},updateSelectedRecordsCount:function(e){return{type:"UPDATE_SELECTED_RECORDS_COUNT",selectedRecordsCount:e}},updateRecord:function(e){return{type:"UPDATE_RECORD",record:e}},updateLastSavedAttributes:function(e){return{type:"UPDATE_LAST_SAVED_ATTRIBUTES",record:e}},setFilterExpression:function(e){return{type:"MODIFY_FILTER_EXPRESSION",filterModifierFunc:function(){return null!=e?e:void 0}}},modifyFilterExpression:function(e){return{type:"MODIFY_FILTER_EXPRESSION",filterModifierFunc:e}},updateFirstColumnInGrid:function(e){return{type:"UPDATE_FIRST_COLUMN_IN_GRID",firstColumn:e}},updateColumnStatus:function(e){return{type:"UPDATE_COLUMN_STATUS",currentColumnStatus:e}},updateColumnsStatus:function(e){return{type:"UPDATE_COLUMNS_STATUS",columnsStatus:e}},updateDialogStatus:function(e){return{type:"UPDATE_DIALOG_STATUS",dialogStatus:e}},setLayoutType:function(e){return{type:"SET_LAYOUT_TYPE",layoutType:e}},updateTotalRowGroupsCount:function(e){return{type:"UPDATE_TOTAL_ROW_GROUPS_COUNT",totalRowGroupsCount:e}},updateRowGroupsCollapsedCount:function(e){return{type:"UPDATE_COLLAPSED_ROW_GROUPS_COUNT",rowGroupsCollapsedCount:e}},setViewFilter:function(e){return{type:"SET_VIEW_FILTER",viewFilter:e}},updateSearchedRecordCount:function(e){return{type:"UPDATE_SEARCHED_RECORD_COUNT",searchedRecordCount:e}},addColumnsToDataset:function(e){return{type:"ADD_COLUMNS",columns:e}},updateFieldSelectionMap:function(e){return{type:"UPDATE_FIELD_SELECTION_MAP",fieldSelectionMap:e}},updateRelationshipMap:function(e){return{type:"UPDATE_RELATIONSHIP_MAP",relationshipMap:e}},updateColumnsStatusAndDataset:function(e){return{type:"UPDATE_COLUMNS_STATUS_DATASET",columnsStatus:e}},setViewHasChanges:function(e){return{type:"UPDATE_VIEW_HAS_CHANGES",viewHasChanges:e}},setDashletHasChanges:function(e){return{type:"UPDATE_DASHLET_HAS_CHANGES",dashletHasChanges:e}},setDashletList:function(e){return{type:"SET_DASHLET_LIST",dashletList:e}}}},85563:function(e,t,n){"use strict";n.d(t,{y:function(){return r},c:function(){return o}});var i=n(49037),r=function(e,t){switch(void 0===e&&(e={primaryEntity:void 0,secondaryEntities:[],size:0,isFilterPanelOpen:!1,insertColumnDirection:"",insertColumnIndex:-1,isEditColumnPanelOpen:!1}),t.type){case"UPDATE_PRIMARY_ENTITY":return(0,i.pi)((0,i.pi)({},e),{primaryEntity:t.entity});case"REMOVE_PRIMARY_ENTITY":return{primaryEntity:void 0,secondaryEntities:[],size:0,isFilterPanelOpen:!1,insertColumnDirection:"",insertColumnIndex:-1,isEditColumnPanelOpen:!1};case"RESIZE":return(0,i.pi)((0,i.pi)({},e),{size:t.size});case"SET_FILTER_PANEL_IS_OPEN":return(0,i.pi)((0,i.pi)({},e),{isFilterPanelOpen:t.isOpen});case"SET_ENTITY_GRID_PANEL_IS_OPEN":return(0,i.pi)((0,i.pi)({},e),{isEditColumnPanelOpen:t.insertColumnStatus.isEditColumnPanelOpen,insertColumnIndex:t.insertColumnStatus.insertColumnIndex,insertColumnDirection:t.insertColumnStatus.insertColumnDirection});default:return e}},o={openPrimaryEntity:function(e){return{type:"UPDATE_PRIMARY_ENTITY",entity:e}},closePrimaryEntity:function(){return{type:"REMOVE_PRIMARY_ENTITY"}},sidePanelResize:function(e){return{type:"RESIZE",size:e}},setFilterPanelIsOpen:function(e){return{type:"SET_FILTER_PANEL_IS_OPEN",isOpen:e}},setEntityGridPanelIsOpen:function(e){return{type:"SET_ENTITY_GRID_PANEL_IS_OPEN",insertColumnStatus:e}}}},55199:function(e,t,n){"use strict";n.d(t,{I:function(){return i},V:function(){return r}});var i=function(e,t){switch(void 0===e&&(e={}),t.type){case"INIT_ADMIN_SETTINGS":return{settings:t.settings};default:return e}},r={initAdminSettings:function(e){return{type:"INIT_ADMIN_SETTINGS",settings:e}}}},59531:function(e,t,n){"use strict";n.d(t,{C:function(){return c}});var i=n(74978),r=n(53126),o=n(95220),a=n(85563),s=n(55199),l=(0,i.combineReducers)({datasetState:o.MB,navigationState:a.y,settingsState:s.I}),c=(0,i.createStore)(l,(0,i.applyMiddleware)(r.Z))},87643:function(e,t,n){"use strict";n.r(t),n.d(t,{SIClientUtilityLogger:function(){return l}});var i,r="SITraceEvent",o=function(){function e(){}var t=e.prototype;return t.reportInfo=function(t){e.reportLog("SITraceBIEvent",t)},t.ReportInfo=function(e){this.reportInfo(e)},t.reportUserAction=function(t){e.reportLog("SITraceCIEvent",t)},t.ReportUserAction=function(e){this.reportUserAction(e)},t.reportWarning=function(t){e.reportLog(r,t,2)},t.ReportWarning=function(e){this.reportWarning(e)},t.reportError=function(t){e.reportLog(r,t,1)},e.reportLog=function(t,n,i){try{var r=n&&n.context&&n.context.reporting?n.context.reporting:window.Xrm&&Xrm.Reporting?Xrm.Reporting:null,o=this.getXrmGlobalContext();if(o&&o.getCurrentAppName)o.getCurrentAppName().then((function(s){var l=new a(n.source,o&&o.organizationSettings&&o.organizationSettings.attributes&&o.organizationSettings.attributes.organizationId,n.area,t,s,n.action,n.actionOn,n.methodName,n.message,n.data,e.getCustomControlId(n),i);r&&r.reportEvent&&r.reportEvent(l)}));else if(n&&n.context){var s=n.context.client.orgSettings,l=s&&s.organizationId&&s.organizationId.substring(1,s.organizationId.length-1),c=new a(n.source,l,n.area,t,"",n.action,n.actionOn,n.methodName,n.message,n.data,e.getCustomControlId(n),i);r&&r.reportEvent&&r.reportEvent(c)}}catch(e){console.error(e)}},e.getXrmGlobalContext=function(){var e=null;try{e=window.Xrm&&Xrm.Utility&&Xrm.Utility.getGlobalContext()}catch(e){}return e},e.getCustomControlId=function(e){try{return e&&e.context&&e.context.client&&e.context.client._customControlProperties.manifest.CustomControlId}catch(e){return""}},t.getEventParams=function(e,t,n,i,r,o,a,s){return{area:t,context:e,methodName:n,source:i,action:a,actionOn:s,data:o,message:r}},t.GetEventParams=function(e,t,n,i,r,o,a,s){return this.getEventParams(e,t,n,i,r,o,a,s)},e}(),a=function(){function e(e,t,n,i,r,o,a,s,l,c,d,u){this.eventParameters=[],this.eventName=i,e&&this.addEventParameter("Source",e),t&&this.addEventParameter("OrgId",t),n&&this.addEventParameter("Area",n),r&&this.addEventParameter("appName",r),o&&this.addEventParameter("Action",o),a&&this.addEventParameter("ActionOn",a),s&&this.addEventParameter("MethodName",s),l&&this.addEventParameter("Message",l),c&&this.addEventParameter("Data",this.SafeJsonStringify(c)),d&&this.addEventParameter("CustomControlId",d),u&&this.addEventParameter("Level",u)}var t=e.prototype;return t.addEventParameter=function(e,t){var n={name:e,value:t};this.eventParameters.push(n)},t.SafeJsonStringify=function(e){try{return JSON.stringify(e)}catch(e){return console.error(e),""}},e}();!function(e){e[e.StartedTracking=0]="StartedTracking",e[e.IgnoredDuplicate=1]="IgnoredDuplicate"}(i||(i={}));var s=function(){function e(){}var t=e.prototype;return t.scenarioStart=function(t,n,r,o){void 0===o&&(o=!0);var a=t+"_"+n;if(e.trackedStopWatches[a])return i.IgnoredDuplicate;var s,l=r.performance.createPerformanceStopwatch(n,{area:t},o);return e.trackedStopWatches[a]={area:t,scenario:n,stopwatchCallback:l,start:null==(s=performance)?void 0:s.now(),context:r},i.StartedTracking},t.scenarioEnd=function(t,n,i){void 0===i&&(i={});var r=t+"_"+n,a=e.trackedStopWatches[r];if(a&&(a.stopwatchCallback(i),a.start)){var s,l=new o;l.reportInfo(l.getEventParams(a.context,t,"scenarioEnd","PerfUtil","",{n:n,s:a.start,d:(null==(s=performance)?void 0:s.now())-a.start},n))}e.trackedStopWatches[r]=null},t.componentStart=function(e,t){try{performance&&e&&t&&performance.mark(this.getCompStartMark(e,t))}catch(e){console.error(e)}},t.componentEnd=function(e,t){try{if(performance&&e&&t&&e.length>1&&t.length>0){var n=this.getCompStartMark(e,t);this.safeMeasure(this.getAreaPrefix(e)+t,n)}}catch(e){console.error(e)}},t.loadStart=function(e){performance&&e&&performance.mark(this.getLoadStartMark(e))},t.loadEnd=function(e,t){if(performance&&e&&e.length>1)try{var n=this.getAreaPrefix(e);this.safeMeasure(n+"AllComp",this.getLoadStartMark(e));var i=performance.getEntriesByType("measure").filter((function(e){return e.name.startsWith(n)})).map((function(e){return performance.clearMeasures(e.name),{n:e.name.replace(n,""),s:e.startTime,d:e.duration}})),r=new o;r.reportInfo(r.getEventParams(t,e,"loadEnd","PerfUtil","",i,"Load"))}catch(e){console.error(e)}},t.safeMeasure=function(e,t){performance.getEntriesByType("mark").find((function(e){return e.name==t}))&&(performance.measure(e,t),performance.clearMarks(t))},t.getLoadStartMark=function(e){return"l_s_"+e},t.getCompStartMark=function(e,t){return"c_s_"+e+"_"+t},t.getAreaPrefix=function(e){return"m_"+e},e}();s.trackedStopWatches={};var l=function(){};l.Telemetry=new o,l.PerfUtil=new s},40005:function(e,t,n){"use strict";e.exports=n(35563)},35563:function(e,t,n){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var r=n(29086),o=n(63804),a=i(o),s=n(5373),l=n(87643),c=i(n(53999)),d=n(87018),u=n(24652),p=n(39303),m=n(35531),h=n(4846),g=n(42093),f=n(92165),y=n(70979),v=n(84718),C=n(36957),S=n(64254),E=i(n(38122)),b=n(79270),w=n(25453),D=n(48909),T=n(93170),x=i(T),k=n(94118),_=n(45997),N=n(69876),L=n(66966),I=n(59295),A=n(94577),R=n(99506),F=n(61218),P=n(36711),M=n(14820),O=n(21259),V=n(71520),z=n(23436),B=n(29758),U=n(85234),H=n(20307),G=n(78195),W=n(28048),j=n(43179),X=n(72886),K=n(44170),q=n(67440),Z=n(13845),J=n(68480),Q=n(10176),Y=n(15220),$=n(5201),ee=n(71350),te=n(99709),ne=n(24694),ie=n(90065),re=n(55562),oe=n(49339),ae=n(10979),se=n(61376),le=n(66960),ce=n(63787),de=n(72429),ue=(n(72964),n(34343)),pe=n(74717);n(12780);n(8855),n(64858);var me,he,ge,fe,ye,ve,Ce,Se,Ee,be,we,De,Te,xe=n(78045),ke=n(78207),_e=n(66916),Ne=n(90347),Le=n(99750),Ie=n(84519),Ae={icons:{ResetFilter:a.createElement("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{fill:"currentColor",d:"M0 0.0398941H16V1.75083L12.2344 5.50863L11.5313 4.80553L15 1.32896V1.03989H1V1.32896L7 7.32895V13.0399H7.99219C7.99741 13.0503 8 13.1024 8 13.1961C8 13.2899 8 13.3967 8 13.5165V14.0399H6V7.75084L0 1.75083V0.0398941ZM16 11.5399C16 12.0243 15.9089 12.48 15.7266 12.9071C15.5443 13.3289 15.2943 13.6987 14.9766 14.0165C14.6588 14.3342 14.2865 14.5841 13.8594 14.7665C13.4375 14.9488 12.9844 15.0399 12.5 15.0399C12.0156 15.0399 11.5599 14.9488 11.1328 14.7665C10.7109 14.5841 10.3412 14.3342 10.0234 14.0165C9.70573 13.6987 9.45574 13.3289 9.27344 12.9071C9.09114 12.48 9 12.0243 9 11.5399H10C10 11.8836 10.0651 12.2092 10.1953 12.5165C10.3255 12.8185 10.5026 13.0841 10.7266 13.3133C10.9557 13.5373 11.2213 13.7144 11.5234 13.8446C11.8307 13.9748 12.1563 14.0399 12.5 14.0399C12.8437 14.0399 13.1667 13.9748 13.4687 13.8446C13.7708 13.7144 14.0339 13.5373 14.2578 13.3133C14.487 13.0841 14.6667 12.8185 14.7969 12.5165C14.9323 12.2092 15 11.8836 15 11.5399C15 11.1961 14.9323 10.8732 14.7969 10.5712C14.6667 10.269 14.487 10.006 14.2578 9.78207C14.0339 9.55292 13.7708 9.37324 13.4687 9.24303C13.1667 9.10761 12.8437 9.03989 12.5 9.03989H10.7109L11.8516 10.1883L11.1484 10.8914L8.79686 8.53989L11.1484 6.18834L11.8516 6.89145L10.7109 8.03989H12.5C12.9844 8.03989 13.4375 8.13103 13.8594 8.31333C14.2865 8.49564 14.6588 8.74562 14.9766 9.06332C15.2943 9.38105 15.5443 9.75343 15.7266 10.1805C15.9089 10.6024 16 11.0555 16 11.5399Z"})),OutgoingCall:a.createElement("svg",{viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{fill:"currentColor",d:"M8.64844 6.64844L13.2891 2H10V1H15V6H14V2.71094L9.35156 7.35156L8.64844 6.64844ZM11.9531 9.21094C12.1562 9.21094 12.3542 9.25 12.5469 9.32812C12.7396 9.40625 12.9089 9.51823 13.0547 9.66406C13.1641 9.77344 13.2865 9.89062 13.4219 10.0156C13.5625 10.1354 13.7057 10.263 13.8516 10.3984C13.9974 10.5286 14.138 10.6667 14.2734 10.8125C14.4089 10.9583 14.5312 11.1094 14.6406 11.2656C14.75 11.4167 14.8359 11.5755 14.8984 11.7422C14.9661 11.9089 15 12.0807 15 12.2578C15 12.4609 14.9609 12.6589 14.8828 12.8516C14.8047 13.0443 14.6927 13.2135 14.5469 13.3594C14.2812 13.625 14.0417 13.8594 13.8281 14.0625C13.6146 14.2656 13.3906 14.4375 13.1562 14.5781C12.9271 14.7188 12.6719 14.8255 12.3906 14.8984C12.1094 14.9661 11.7734 15 11.3828 15C10.8151 15 10.2318 14.9115 9.63281 14.7344C9.03385 14.5573 8.4375 14.3125 7.84375 14C7.25 13.6875 6.66927 13.3151 6.10156 12.8828C5.53385 12.4505 4.99479 11.9792 4.48438 11.4688C3.97917 10.9583 3.51302 10.4193 3.08594 9.85156C2.65885 9.28385 2.29167 8.70573 1.98438 8.11719C1.67708 7.52344 1.4349 6.93229 1.25781 6.34375C1.08594 5.75 1 5.17708 1 4.625C1 4.22917 1.03385 3.89062 1.10156 3.60938C1.17448 3.32812 1.27865 3.07292 1.41406 2.84375C1.55469 2.61458 1.72656 2.39323 1.92969 2.17969C2.13281 1.96094 2.36979 1.71875 2.64062 1.45312C2.78646 1.30729 2.95573 1.19531 3.14844 1.11719C3.34115 1.03906 3.53906 1 3.74219 1C4.0026 1 4.2526 1.07031 4.49219 1.21094C4.73698 1.35156 4.96875 1.52344 5.1875 1.72656C5.40625 1.92969 5.61198 2.14323 5.80469 2.36719C5.9974 2.59115 6.17448 2.78385 6.33594 2.94531C6.48177 3.09115 6.59375 3.26042 6.67188 3.45312C6.75 3.64583 6.78906 3.84375 6.78906 4.04688C6.78906 4.25 6.75521 4.43229 6.6875 4.59375C6.61979 4.75521 6.53385 4.90104 6.42969 5.03125C6.33073 5.15625 6.22135 5.27344 6.10156 5.38281C5.98698 5.48698 5.8776 5.58854 5.77344 5.6875C5.67448 5.78646 5.59115 5.88542 5.52344 5.98438C5.45573 6.07812 5.42188 6.17969 5.42188 6.28906C5.42188 6.35156 5.46875 6.45312 5.5625 6.59375C5.66146 6.72917 5.79167 6.88802 5.95312 7.07031C6.11458 7.2526 6.29948 7.45312 6.50781 7.67188C6.72135 7.89062 6.9401 8.11198 7.16406 8.33594C7.39323 8.5599 7.61979 8.78125 7.84375 9C8.07292 9.21875 8.28385 9.42188 8.47656 9.60938C8.67448 9.79688 8.84635 9.96094 8.99219 10.1016C9.14323 10.2422 9.2526 10.3464 9.32031 10.4141C9.42969 10.5234 9.5599 10.5781 9.71094 10.5781C9.82031 10.5781 9.92188 10.5443 10.0156 10.4766C10.1146 10.4089 10.2109 10.3255 10.3047 10.2266C10.4036 10.1224 10.5052 10.013 10.6094 9.89844C10.7188 9.77865 10.8385 9.66927 10.9688 9.57031C11.099 9.46615 11.2422 9.38021 11.3984 9.3125C11.5599 9.24479 11.7448 9.21094 11.9531 9.21094ZM11.3828 14C11.7005 14 11.9661 13.9714 12.1797 13.9141C12.3984 13.8516 12.5938 13.763 12.7656 13.6484C12.9375 13.5339 13.1042 13.3932 13.2656 13.2266C13.4323 13.0599 13.6224 12.8698 13.8359 12.6562C13.9453 12.5469 14 12.4167 14 12.2656C14 12.1979 13.9583 12.1016 13.875 11.9766C13.7917 11.8464 13.6849 11.7057 13.5547 11.5547C13.4297 11.3984 13.2865 11.2422 13.125 11.0859C12.9688 10.9297 12.8151 10.7865 12.6641 10.6562C12.513 10.526 12.3724 10.4193 12.2422 10.3359C12.1172 10.2526 12.0208 10.2109 11.9531 10.2109C11.8438 10.2109 11.7396 10.2448 11.6406 10.3125C11.5417 10.3802 11.4427 10.4661 11.3438 10.5703C11.25 10.6693 11.1484 10.7786 11.0391 10.8984C10.9349 11.013 10.8177 11.1224 10.6875 11.2266C10.5573 11.3255 10.4115 11.4089 10.25 11.4766C10.0938 11.5443 9.91406 11.5781 9.71094 11.5781C9.5026 11.5781 9.30208 11.5391 9.10938 11.4609C8.92188 11.3776 8.75521 11.263 8.60938 11.1172L4.88281 7.39062C4.73698 7.24479 4.6224 7.07812 4.53906 6.89062C4.46094 6.69792 4.42188 6.4974 4.42188 6.28906C4.42188 6.08594 4.45573 5.90625 4.52344 5.75C4.59115 5.58854 4.67448 5.44271 4.77344 5.3125C4.8776 5.18229 4.98698 5.0651 5.10156 4.96094C5.22135 4.85156 5.33073 4.7474 5.42969 4.64844C5.53385 4.54948 5.61979 4.45312 5.6875 4.35938C5.75521 4.26042 5.78906 4.15625 5.78906 4.04688C5.78906 3.97917 5.7474 3.88281 5.66406 3.75781C5.58073 3.63281 5.47396 3.49479 5.34375 3.34375C5.21875 3.1875 5.07552 3.03125 4.91406 2.875C4.75781 2.71354 4.60156 2.57031 4.44531 2.44531C4.29427 2.3151 4.15625 2.20833 4.03125 2.125C3.90625 2.04167 3.8099 2 3.74219 2C3.58594 2 3.45312 2.05469 3.34375 2.16406C3.13021 2.3776 2.9401 2.5651 2.77344 2.72656C2.60677 2.88802 2.46615 3.05729 2.35156 3.23438C2.23698 3.40625 2.14844 3.59896 2.08594 3.8125C2.02865 4.02604 2 4.28906 2 4.60156C2 5.10156 2.08073 5.61979 2.24219 6.15625C2.40365 6.6875 2.6276 7.22135 2.91406 7.75781C3.20573 8.29427 3.54948 8.82031 3.94531 9.33594C4.34115 9.85156 4.77083 10.3411 5.23438 10.8047C5.69792 11.263 6.1875 11.6875 6.70312 12.0781C7.22396 12.4688 7.75 12.8073 8.28125 13.0938C8.8125 13.3802 9.34115 13.6042 9.86719 13.7656C10.3932 13.9219 10.8984 14 11.3828 14Z"})),"tasklist-svg":a.createElement("svg",{width:"16",height:"15",viewBox:"0 0 16 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M6 2H16V3H6V2ZM6 8V7H16V8H6ZM6 13V12H16V13H6ZM2 6C2.27604 6 2.53385 6.05208 2.77344 6.15625C3.01823 6.26042 3.23177 6.40365 3.41406 6.58594C3.59635 6.76823 3.73958 6.98177 3.84375 7.22656C3.94792 7.46615 4 7.72396 4 8C4 8.27604 3.94792 8.53646 3.84375 8.78125C3.73958 9.02083 3.59635 9.23177 3.41406 9.41406C3.23177 9.59635 3.01823 9.73958 2.77344 9.84375C2.53385 9.94792 2.27604 10 2 10C1.72396 10 1.46354 9.94792 1.21875 9.84375C0.979167 9.73958 0.768229 9.59635 0.585938 9.41406C0.403646 9.23177 0.260417 9.02083 0.15625 8.78125C0.0520833 8.53646 0 8.27604 0 8C0 7.72396 0.0520833 7.46615 0.15625 7.22656C0.260417 6.98177 0.403646 6.76823 0.585938 6.58594C0.768229 6.40365 0.979167 6.26042 1.21875 6.15625C1.46354 6.05208 1.72396 6 2 6ZM2 9.125C2.15625 9.125 2.30208 9.09635 2.4375 9.03906C2.57292 8.97656 2.6901 8.89583 2.78906 8.79688C2.89323 8.69271 2.97396 8.57292 3.03125 8.4375C3.09375 8.30208 3.125 8.15625 3.125 8C3.125 7.84375 3.09375 7.69792 3.03125 7.5625C2.97396 7.42708 2.89323 7.3099 2.78906 7.21094C2.6901 7.10677 2.57292 7.02604 2.4375 6.96875C2.30208 6.90625 2.15625 6.875 2 6.875C1.84375 6.875 1.69792 6.90625 1.5625 6.96875C1.42708 7.02604 1.30729 7.10677 1.20312 7.21094C1.10417 7.3099 1.02344 7.42708 0.960938 7.5625C0.903646 7.69792 0.875 7.84375 0.875 8C0.875 8.15625 0.903646 8.30208 0.960938 8.4375C1.02344 8.57292 1.10417 8.69271 1.20312 8.79688C1.30729 8.89583 1.42708 8.97656 1.5625 9.03906C1.69792 9.09635 1.84375 9.125 2 9.125ZM2 11C2.27604 11 2.53385 11.0521 2.77344 11.1562C3.01823 11.2604 3.23177 11.4036 3.41406 11.5859C3.59635 11.7682 3.73958 11.9818 3.84375 12.2266C3.94792 12.4661 4 12.724 4 13C4 13.276 3.94792 13.5365 3.84375 13.7812C3.73958 14.0208 3.59635 14.2318 3.41406 14.4141C3.23177 14.5964 3.01823 14.7396 2.77344 14.8438C2.53385 14.9479 2.27604 15 2 15C1.72396 15 1.46354 14.9479 1.21875 14.8438C0.979167 14.7396 0.768229 14.5964 0.585938 14.4141C0.403646 14.2318 0.260417 14.0208 0.15625 13.7812C0.0520833 13.5365 0 13.276 0 13C0 12.724 0.0520833 12.4661 0.15625 12.2266C0.260417 11.9818 0.403646 11.7682 0.585938 11.5859C0.768229 11.4036 0.979167 11.2604 1.21875 11.1562C1.46354 11.0521 1.72396 11 2 11ZM2 14.125C2.15625 14.125 2.30208 14.0964 2.4375 14.0391C2.57292 13.9766 2.6901 13.8958 2.78906 13.7969C2.89323 13.6927 2.97396 13.5729 3.03125 13.4375C3.09375 13.3021 3.125 13.1562 3.125 13C3.125 12.8438 3.09375 12.6979 3.03125 12.5625C2.97396 12.4271 2.89323 12.3099 2.78906 12.2109C2.6901 12.1068 2.57292 12.026 2.4375 11.9688C2.30208 11.9062 2.15625 11.875 2 11.875C1.84375 11.875 1.69792 11.9062 1.5625 11.9688C1.42708 12.026 1.30729 12.1068 1.20312 12.2109C1.10417 12.3099 1.02344 12.4271 0.960938 12.5625C0.903646 12.6979 0.875 12.8438 0.875 13C0.875 13.1562 0.903646 13.3021 0.960938 13.4375C1.02344 13.5729 1.10417 13.6927 1.20312 13.7969C1.30729 13.8958 1.42708 13.9766 1.5625 14.0391C1.69792 14.0964 1.84375 14.125 2 14.125ZM1.5 2.79688L3.64844 0.648438L4.35156 1.35156L1.5 4.20312L0.148438 2.85156L0.851562 2.14844L1.5 2.79688Z",fill:"#2266E3"})),"bubbleChart-svg":a.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M0 16C0 7.16344 7.16344 0 16 0V0C24.8366 0 32 7.16344 32 16V16C32 24.8366 24.8366 32 16 32V32C7.16344 32 0 24.8366 0 16V16Z",fill:"currentColor"}),a.createElement("circle",{cx:"15.5",cy:"18.5",r:"2.5",fill:"white"}),a.createElement("circle",{cx:"20",cy:"12",r:"4",fill:"white"}),a.createElement("circle",{cx:"12.5",cy:"13.5",r:"1.5",fill:"white"}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.5 8C8.22386 8 8 8.22386 8 8.5V23.5C8 23.7761 8.22386 24 8.5 24L23.5 24C23.7761 24 24 23.7761 24 23.5C24 23.2239 23.7761 23 23.5 23L9 23V8.5C9 8.22386 8.77614 8 8.5 8Z",fill:"white"})),"funnelChart-svg":a.createElement("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M0 16C0 7.16344 7.16344 0 16 0V0C24.8366 0 32 7.16344 32 16V16C32 24.8366 24.8366 32 16 32V32C7.16344 32 0 24.8366 0 16V16Z",fill:"currentColor"}),a.createElement("path",{d:"M15.3725 25.3966C15.4377 25.7473 15.6976 26 16 26C16.3024 26 16.5623 25.7473 16.6275 25.3966C16.8692 24.0964 17.1722 22.7884 17.521 21.5035C17.5557 21.376 17.4598 21.25 17.3276 21.25L14.6724 21.25C14.5402 21.25 14.4443 21.376 14.479 21.5035C14.8278 22.7884 15.1308 24.0964 15.3725 25.3966Z",fill:"white"}),a.createElement("path",{d:"M14.4372 20.0625C14.2167 20.0625 14.0225 19.918 13.9573 19.7074C13.6604 18.7476 13.3409 17.8098 13.0056 16.9076C12.9324 16.7105 13.0775 16.5 13.2877 16.5L18.7123 16.5C18.9225 16.5 19.0676 16.7105 18.9944 16.9076C18.6591 17.8098 18.3396 18.7476 18.0427 19.7074C17.9775 19.918 17.7833 20.0625 17.5628 20.0625L14.4372 20.0625Z",fill:"white"}),a.createElement("path",{d:"M12.2528 15.0033C12.3313 15.1901 12.5136 15.3125 12.7162 15.3125L19.2838 15.3125C19.4864 15.3125 19.6687 15.1901 19.7472 15.0033C20.1471 14.0522 20.5608 13.159 20.9783 12.3436C21.1164 12.074 20.9226 11.75 20.6197 11.75L11.3803 11.75C11.0774 11.75 10.8836 12.074 11.0217 12.3436C11.4392 13.159 11.8529 14.0522 12.2528 15.0033Z",fill:"white"}),a.createElement("path",{d:"M10.3072 10.5625C10.1334 10.5625 9.97236 10.4719 9.87937 10.325C9.30423 9.4168 8.73867 8.69089 8.20853 8.19911C7.78547 7.80666 8.04873 7 8.61611 7L23.3839 7C23.9513 7 24.2145 7.80666 23.7915 8.19911C23.2613 8.69089 22.6958 9.4168 22.1206 10.325C22.0276 10.4719 21.8666 10.5625 21.6928 10.5625L10.3072 10.5625Z",fill:"white"})),ResetColumns:a.createElement("svg",{viewBox:"0 0 15 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M15 9.5C15 10.099 14.9219 10.6745 14.7656 11.2266C14.6094 11.7786 14.3906 12.2969 14.1094 12.7812C13.8281 13.2604 13.4896 13.6979 13.0938 14.0938C12.6979 14.4896 12.2578 14.8281 11.7734 15.1094C11.2943 15.3906 10.7786 15.6094 10.2266 15.7656C9.67448 15.9219 9.09896 16 8.5 16C7.90104 16 7.32552 15.9219 6.77344 15.7656C6.22135 15.6094 5.70312 15.3906 5.21875 15.1094C4.73958 14.8281 4.30208 14.4896 3.90625 14.0938C3.51042 13.6979 3.17188 13.2604 2.89062 12.7812C2.60938 12.2969 2.39062 11.7786 2.23438 11.2266C2.07812 10.6745 2 10.099 2 9.5V9H3V9.5C3 10.0052 3.0651 10.4922 3.19531 10.9609C3.32552 11.4297 3.51042 11.8672 3.75 12.2734C3.98958 12.6797 4.27604 13.0521 4.60938 13.3906C4.94792 13.724 5.32031 14.0104 5.72656 14.25C6.13281 14.4896 6.57031 14.6745 7.03906 14.8047C7.50781 14.9349 7.99479 15 8.5 15C9.00521 15 9.49219 14.9349 9.96094 14.8047C10.4297 14.6745 10.8672 14.4896 11.2734 14.25C11.6797 14.0104 12.0495 13.724 12.3828 13.3906C12.7214 13.0521 13.0104 12.6797 13.25 12.2734C13.4896 11.8672 13.6745 11.4297 13.8047 10.9609C13.9349 10.4922 14 10.0052 14 9.5C14 8.99479 13.9349 8.50781 13.8047 8.03906C13.6745 7.57031 13.4896 7.13281 13.25 6.72656C13.0104 6.32031 12.7214 5.95052 12.3828 5.61719C12.0495 5.27865 11.6797 4.98958 11.2734 4.75C10.8672 4.51042 10.4297 4.32552 9.96094 4.19531C9.49219 4.0651 9.00521 4 8.5 4H1.95312L4.22656 6.27344L3.52344 6.97656L0.046875 3.5L3.52344 0.0234375L4.22656 0.726562L1.95312 3H8.5C9.09896 3 9.67448 3.07812 10.2266 3.23438C10.7786 3.39062 11.2943 3.60938 11.7734 3.89062C12.2578 4.17188 12.6979 4.51042 13.0938 4.90625C13.4896 5.30208 13.8281 5.74219 14.1094 6.22656C14.3906 6.70573 14.6094 7.22135 14.7656 7.77344C14.9219 8.32552 15 8.90104 15 9.5Z",fill:"currentColor"}))}};function Re(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function Fe(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function a(e){Re(o,i,r,a,s,"next",e)}function s(e){Re(o,i,r,a,s,"throw",e)}a(void 0)}))}}function Pe(){return(Pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function Me(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ze(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Ve(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}!function(e){e.Opportunity="opportunity",e.Lead="lead",e.Contact="contact",e.Account="account",e.Task="task",e.Note="note",e.Chat="chat"}(me||(me={})),function(e){e[e.FieldErrorPreventingHideColumn=0]="FieldErrorPreventingHideColumn"}(he||(he={})),function(e){e[e.Mandatory=1]="Mandatory",e[e.Currency=2]="Currency",e[e.Date=3]="Date",e[e.None=4]="None",e[e.Email=5]="Email",e[e.Number=6]="Number"}(ge||(ge={})),function(e){e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High"}(fe||(fe={})),function(e){e[e.Open=0]="Open",e[e.Completed=1]="Completed",e[e.Canceled=2]="Canceled"}(ye||(ye={})),function(e){e[e.Default=0]="Default",e[e.List=1]="List",e[e.Edit=2]="Edit",e[e.Create=3]="Create",e[e.Chat=4]="Chat"}(ve||(ve={})),function(e){e[e.none=-1]="none",e[e.asc=0]="asc",e[e.desc=1]="desc"}(Ce||(Ce={})),function(e){e.Fetch_System_Form="Fetch_System_Form",e.Fetch_Entity_Metadata="Fetch_Entity_Metadata",e.Fetch_Process_Unique_Name="Fetch_Process_Unique_Name",e.Key_Local_0_sync="Key_Local_0_sync",e.Key_Session_0_sync="Key_Session_0_sync",e.Key_Local_1_sync="Key_Local_1_sync",e.Key_Session_1_sync="Key_Session_1_sync",e.Key_Local_1_async="Key_Local_1_async",e.Key_Session_1_async="Key_Session_1_async",e.Key_cache_miss="Key_cache_miss"}(Se||(Se={})),function(e){e[e.LOCAL_STORAGE=0]="LOCAL_STORAGE",e[e.SESSION_STORAGE=1]="SESSION_STORAGE"}(Ee||(Ee={})),function(e){e.Email="email",e.PhoneCall="phonecall",e.Appointment="appointment"}(be||(be={})),function(e){e[e.Sender=1]="Sender",e[e.ToRecipient=2]="ToRecipient",e[e.CCRecipient=3]="CCRecipient",e[e.BccRecipient=4]="BccRecipient",e[e.RequiredAttendee=5]="RequiredAttendee",e[e.OptionalAttendee=6]="OptionalAttendee",e[e.Organizer=7]="Organizer",e[e.Regarding=8]="Regarding",e[e.Owner=9]="Owner",e[e.Resource=10]="Resource",e[e.Customer=11]="Customer"}(we||(we={})),function(e){e[e.Incoming=0]="Incoming",e[e.Outgoing=1]="Outgoing"}(De||(De={}));var Be=function(){function e(){}return e.getSystemFormIdByEntityType=function(e){return this.configuredSystemForms[e]||this.oobSystemForms[e]},e.parseFormXml=function(e,t){if(DOMParser){var n=(new DOMParser).parseFromString(t,"text/xml");return{entityType:e,dataFields:this.getDatafields(n).dataFields,dataFieldsIsReadOnly:this.getDatafields(n).dataFieldsIsReadOnly,header:this.getHeader(n),tabs:this.getTabs(n)}}return null},e.getTabs=function(e){for(var t=[],n=e.getElementsByTagName("tab"),i=0;i<n.length&&i<2;i++){for(var r=n[i],o=this.getLabel(r),a=[],s=r.getElementsByTagName("column"),l=0;l<s.length;l++)a.push({sections:this.getSections(s[l])});t.push({key:r.getAttribute("name")||o,name:o,columns:a,showLabel:"true"==r.getAttribute("showlabel")})}return t},e.getLabel=function(e){var t="";return e&&e.childNodes.forEach((function(e){if("labels"==e.nodeName){var n=e.children[0];if(n){var i=n.getAttribute("description");i&&(t=i)}}})),t},e.getDatafields=function(e){for(var t=["statecode"],n=[!1],i=e.getElementsByTagName("control"),r=0;r<i.length;r++){var o=i[r].getAttribute("datafieldname"),a=i[r].getAttribute("disabled");o&&(t.push(o),n.push("true"===a))}return{dataFields:t,dataFieldsIsReadOnly:n}},e.getHeader=function(e){return this.getCells(e.getElementsByTagName("header")[0])},e.getSections=function(e){for(var t=[],n=e.getElementsByTagName("section"),i=0;i<n.length;i++){var r=n[i],o=this.getLabel(r);t.push({key:r.getAttribute("name")||o,labelDescription:o,showLabel:"true"==r.getAttribute("showlabel"),showTopBar:"true"==r.getAttribute("showbar"),rows:this.getRows(r)})}return t},e.getRows=function(e){var t=[];if(e)for(var n=e.getElementsByTagName("row"),i=0;i<n.length;i++)t.push({cells:this.getCells(n[i])});return t},e.getCells=function(e){for(var t=[],n=e.getElementsByTagName("cell"),i=0;i<n.length;i++){var r=n[i],o=r.getElementsByTagName("control")[0];if(o){var a=o.getAttribute("datafieldname"),s=r.getElementsByTagName("label")[0]&&r.getElementsByTagName("label")[0].getAttribute("description");a&&s&&t.push({key:r.getAttribute("name")||s,datafieldName:a,labelDescription:s,disabled:o&&"true"==o.getAttribute("disabled"),showLabel:"true"==r.getAttribute("showlabel")})}}return t},e}();Be.oobSystemForms=((Te={})[me.Opportunity]="BA7F7AD7-E0E7-43AA-BE19-5069DD9C60EB",Te[me.Account]="FACE3AA6-99C4-4B7E-AF07-55F121CDCA86",Te[me.Contact]="4C9C89B9-F909-4B34-8F63-B87D7FF2F0C4",Te[me.Lead]="E7D96C74-2D77-47B7-9A55-C5D26EB7074C",Te),Be.configuredSystemForms={};var Ue={backIcon:{iconName:"Back"},closeIcon:{iconName:"CalculatorMultiply"},goToIcon:{iconName:"OpenInNewWindow"},officeChat:{iconName:"OfficeChat"},taskList:{iconName:"tasklist-svg"},notes:{iconName:"QuickNote"},unselectedOption:{iconName:"LocationCircle"},selectedOption:{iconName:"CompletedSolid"},add:{iconName:"Add"},notesEdit:{iconName:"Edit"},quickNote:{iconName:"QuickNote"},contact:{iconName:"Contact"},download:{iconName:"Download"},powerPointDocument:{iconName:"PowerPointDocument"},wordDocument:{iconName:"WordDocument"},deleteNotes:{iconName:"Delete"},attachmentIcon:{iconName:"Attach"},chevronRight:{iconName:"ChevronRight"},chevronDown:{iconName:"ChevronDown"},error:{iconName:"Error"},refresh:{iconName:"SyncOccurence"},forward:{iconName:"Forward"},flag:{iconName:"Flag"},location:{iconName:"Location"},bubbleChart:{iconName:"bubbleChart-svg"},funnelChart:{iconName:"funnelChart-svg"},editTask:{iconName:"Edit"},deleteTask:{iconName:"Delete"},securityGroup:{iconName:"SecurityGroup"},editColumnReset:{iconName:"editColumnReset"}},He=function(e,t){return function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function l(e,t,n,i){var r=Object.create((t&&t.prototype instanceof u?t:u).prototype),o=new w(i||[]);return r._invoke=function(e,t,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=c(e,t,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(e,n,o),r}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d={};function u(){}function p(){}function m(){}var h={};h[r]=function(){return this};var g=Object.getPrototypeOf,f=g&&g(g(D([])));f&&f!==t&&n.call(f,r)&&(h=f);var y=m.prototype=u.prototype=Object.create(h);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){var i;this._invoke=function(r,o){function a(){return new t((function(i,a){!function i(r,o,a,s){var l=c(e[r],e,o);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==typeof u&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}(r,o,i,a)}))}return i=i?i.then(a,a):a()}}function S(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=c(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function w(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function D(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(n.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=y.constructor=m,m.constructor=p,p.displayName=s(m,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(C.prototype),C.prototype[o]=function(){return this},e.AsyncIterator=C,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var a=new C(l(t,n,i,r),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},v(y),s(y,a,"Generator"),y[r]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=D,w.prototype={constructor:w,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(n,i){return a.type="throw",a.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;b(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(t={exports:{}}),t.exports}(),Ge=function(){};Ge.area="Workspace";var We=function(){};We.openInContextView="Open InContext View",We.openView="Open View",We.changeLayout="Change Layout",We.changeSystemView="Change System View",We.applyFilter="Apply Filter";var je,Xe,Ke=function(){};Ke.loadMoreRowKey="loadMoreRowKey",Ke.aggregateRowKey="aggregateRowKey",Ke.checkboxColumnField="checkboxColumn",Ke.sortAscending="sortAscending",Ke.sortDescending="sortDescending",Ke.revertToDefaultSort="revertToDefaultSort",Ke.filterByThisColumn="filterByThisColumn",Ke.groupByThisColumn="groupByThisColumn",Ke.insertBasicColumnKey="insertBasicColumn",Ke.insertLeftBasicColumnKey="insertLeftBasicColumn",Ke.insertRightBasicColumnKey="insertRightBasicColumn",Ke.insertBasicColumnText="WS_Grid_Header_Insert_Basic_Column",Ke.insertLeftBasicColumnText="WS_Grid_Header_Insert_Left_Column",Ke.insertRightBasicColumnText="WS_Grid_Header_Insert_Right_Column",Ke.hideColumn="hideColumn",Ke.setAsFirstColumn="setAsFirstColumn",Ke.contextMenuFilterByColumn="WS_Grid_Header_Filter_By_Column",Ke.contextMenuHidecolumn="WS_Grid_Header_Hide_Column",Ke.contextMenuSetAsFirstColumn="WS_Grid_Header_Set_First_Column",Ke.contextMenuRevertToDefaultSort="WS_Grid_Header_Reset_To_Default_Sorting",Ke.contextMenuGroupByThisColumn="WS_Grid_Header_Group_By_This_Column",Ke.contextMenuSortAscNumber="WS_Grid_Header_Sort_Smaller_To_Larger",Ke.contextMenuSortDescNumber="WS_Grid_Header_Sort_To_Larger_To_Smaller",Ke.contextMenuSortAscDate="WS_Grid_Header_Oldest_To_Newest",Ke.contextMenuSortDescDate="WS_Grid_Header_Newest_to_Oldest",Ke.contextMenuSortAscString="WS_Grid_Header_A_To_Z",Ke.contextMenuSortDescString="WS_Grid_Header_Z_To_A",Ke.dropdownSelectAllKey="showall",Ke.dropdownSelectAllValue="WS_Grid_EditColumns_Show_All",Ke.dropdownSearchText="WS_Grid_EditColumns_Search",Ke.dropdownEditColumnsText="WS_Grid_EditColumns",Ke.editColumnPaneAddColumnTitle="WS_Grid_Pane_Header_AddColumn",Ke.editColumnPaneAddSmartColumnTitle="WS_Grid_Pane_Header_AddSmartColumn",Ke.dropdownAddBasicColumnText="WS_Grid_AddColumn_Basic",Ke.dropdownAddSmartColumnText="WS_Grid_AddColumn_Smart",Ke.dropdownAddRelatedColumnText="WS_Grid_AddColumn_Related",Ke.dropdownMoveUpText="WS_Grid_EditColumns_Move_Up",Ke.dropdownMoveDownText="WS_Grid_EditColumns_Move_Down",Ke.gridSearchText="WS_Grid_Searchbox",Ke.gridSearchboxClassName="gridSearchbox",Ke.stateCode="statecode",Ke.statusCode="statuscode",Ke.fieldErrorClassName="fieldErrorIconStyle",Ke.openNotesButtonKey="icv_openNotesButton",Ke.openTasksButtonKey="icv_openTasksButton",Ke.openCollabButtonKey="icv_openCollabButton",Ke.addNoteButtonKey="icv_addNoteButton",Ke.addNoteCommand="icv_addNoteCommand",Ke.aggregateMethodList=[Ke.aggMethodSum="sum",Ke.aggMethodAvg="avg",Ke.aggMethodMin="min",Ke.aggMethodMax="max"],Ke.formattedValueSuffix="@OData.Community.Display.V1.FormattedValue",Ke.customHeaderClassNamePrefix="customHeader-",Ke.recordLimit=250,Ke.commandBarButtonLocation="commandBarButton",Ke.updateButtonLocation="updateEntityViewButton",function(e){e.Spinner="spinner",e.Button="button"}(je||(je={})),function(e){e.NoData="noData",e.Error="error",e.RowCountExceedsLimit="rowCountExceedsLimit",e.SearchReturnedEmpty="searchReturnedEmpty",e.SearchReturnedEmptyTryChangingFilters="searchReturnedEmptyTryChangingFilters"}(Xe||(Xe={}));var qe=function(){function e(){}return e.initialize=function(){c.prefix=e.cachePrefix+"~"+e.appPrefix+"~"},e.get=function(t,n){return e.initialize(),c.get(t,n)},e.set=function(t,n){e.initialize(),c.set(t,n)},e.removeStorage=function(e){return c.rm(e)},e.setPrefix=function(t){e.appPrefix=t},e}();qe.aggregateCachePrefix="aggregate",qe.cachePrefix="D365ICV_VERSION_1_",qe.appPrefix="";var Ze=function(){function e(){}return e.TriggerEventAndHandleSurvey=function(t,n,i,r){void 0===r&&(r={});var o={TeamName:t,EventName:n,SurveyName:i,CallType:"triggerandvalidateeligibility"},a=new Array;a.push({name:"SurveyName",value:i}),a.push({name:"TeamName",value:t}),a.push({name:"TriggeringEvent",value:n}),e.HandlePromise(e.HandleCESAction(o),r,a)},e.GetSystemUserInformation=function(){var e=Fe(He.mark((function e(t){var n,i,r;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.location.origin,i=n+"/api/data/v9.0/systemusers?$filter=systemuserid eq "+t+"&$select=azureactivedirectoryobjectid",e.prev=2,e.next=5,fetch(i);case 5:return r=e.sent,e.next=8,r.json();case 8:return e.abrupt("return",{result:e.sent.value[0].azureactivedirectoryobjectid});case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",{err:e.t0});case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}(),e.HandleCESAction=function(e){var t=this.formsProId;return new Promise((function(n,i){var r=window.location.origin+"/api/data/v9.0/CustomerExperienceSurveysService",o=JSON.stringify(e),a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){var e=JSON.parse(this.responseText);if("True"==e.IsSuccess){var r,o,a,s,l=JSON.parse(e.CESResult);null!=(r=null==(o=window)||null==(a=o.location)||null==(s=a.href)?void 0:s.includes("forceSurveys"))&&r&&(l.Eligibility=!0,l.FormsProId=t),l.Eligibility&&null!=l.FormsProId&&n(l)}else n(null)}else i(this.status+": "+this.responseText)},a.open("POST",r,!0),a.setRequestHeader("Content-Type","application/json"),a.send(o)}))},e.HandlePromise=function(t,n,i){var r=this;t.then((function(t){if(t)try{var o=t.FormsProId,a=new window.top.SurveyEmbed(o,r.customerVoiceURL,r.customerVoiceAuthURl,"true");n.renderDimensions?a.renderPopup(e.GenerateFormContext(n,t.AADID),n.renderDimensions.width,n.renderDimensions.height):a.rederPopup(e.GenerateFormContext(n,t.AADID)),i.push({name:"Survey Rendered",value:!0}),i.push({name:"AADID",value:t.AADID}),i.push({name:"FormsProID",value:o}),Xrm.Reporting.reportSuccess(r.componentName,i)}catch(e){Xrm.Reporting.reportFailure(r.componentName,{name:"Failed to Render Survey",message:e.message},void 0,i)}})).catch((function(e){Xrm.Reporting.reportFailure(r.componentName,{name:"CESService Rejected",message:e},void 0,i)}))},e.HandleSendFeedbackClicked=function(t){try{var n,i;new window.top.SurveyEmbed(this.formsProId,this.customerVoiceURL,this.customerVoiceAuthURl,"true").renderPopup(e.GenerateFormContext(t),null==t||null==(n=t.renderDimensions)?void 0:n.width,null==t||null==(i=t.renderDimensions)?void 0:i.height)}catch(e){Xrm.Reporting.reportFailure(this.componentName,{name:"Failed to Render Survey",message:e.message},void 0)}},e.GenerateFormContext=function(){var t=Fe(He.mark((function t(n,i){var r,o,a,s,l,c,d,u,p,m,h,g;return He.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.context?n.context:Xrm.Utility.getGlobalContext(),o="",r&&r.client&&r.client.userAgent?(a=r.client.userAgent).isWin?o="Windows":a.isAndroidModern||a.isAndroid?o="Android":a.isIos&&(o="iOS"):(s=window.navigator.userAgent).indexOf("Win")>-1?o="Windows":s.indexOf("Android")>-1?o="Android":(s.indexOf("IPhone")>-1||s.indexOf("IPad")>-1)&&(o="iOS"),l="",c="",!i){t.next=9;break}l=i,t.next=17;break;case 9:if(""===(c=qe.get("azureActiveDirectoryObjectId",""))){t.next=13;break}l=c,t.next=17;break;case 13:return t.next=15,e.GetSystemUserInformation(r.userSettings.userId);case 15:(d=t.sent).result?(l=d.result,qe.set("azureActiveDirectoryObjectId",d.result)):Je.reportError("getSystemUserInformation","CustomerExperienceSurveyUtils","Error occured in getting system user information (aadid) from CDS",{error:d.toString()});case 17:if(u="en-US",r&&(u=e.GetLocale(r.getUserLcid())),p="",r&&r.organizationSettings&&r.organizationSettings.organizationId&&(p=r.organizationSettings.organizationId),m="",r&&r.organizationSettings&&r.organizationSettings.organizationTenant&&(m=r.organizationSettings.organizationTenant),h={locale:u,UserId:l,OrganizationId:p,Culture:u,UrlReferrer:window.location.href,DeviceType:o,UserTenantId:m,ProductContext:n.productContext||""},!n.formContextParameters){t.next=27;break}return g=Pe({},h,n.formContextParameters),t.abrupt("return",g);case 27:return t.abrupt("return",h);case 28:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.GetLocale=function(e){var t="en-US";switch(e){case 1025:t="ar";break;case 1028:t="zh-Hant";break;case 1030:t="da";break;case 1031:t="de";break;case 1034:t="es-ES";break;case 1035:t="fi";break;case 1036:t="fr-FR";break;case 1037:t="he";break;case 1040:t="it";break;case 1041:t="ja";break;case 1043:t="nl";break;case 1044:t="nb-no";break;case 1045:t="pl";break;case 1046:t="pt-br";break;case 1053:t="sv";break;case 1054:t="th";break;case 1055:t="tr";break;case 2052:t="zh-Hans";break;case 2068:t="nn-no";break;case 2070:t="pt-pt"}return t},e}();Ze.componentName="CustomerExperienceSurveyUtil",Ze.customerVoiceURL="https://customervoice.microsoft.com/",Ze.customerVoiceAuthURl="https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/",Ze.formsProId="v4j5cvGGr0GRqy180BHbRzLjZgexbElMtfDqlP_Vi3pUNjdRSFo0MjdZNVRJUFkzU1cyVzQwNEVUWS4u";var Je=function(){function e(){}return e.initializeContext=function(t){e.context=t},e.scenarioStart=function(t){l.SIClientUtilityLogger.PerfUtil.scenarioStart(Ge.area,t,e.context)},e.scenarioEnd=function(e){l.SIClientUtilityLogger.PerfUtil.scenarioEnd(Ge.area,e)},e.componentStart=function(e){l.SIClientUtilityLogger.PerfUtil.componentStart(Ge.area,e)},e.componentEnd=function(e){l.SIClientUtilityLogger.PerfUtil.componentEnd(Ge.area,e)},e.loadStart=function(){l.SIClientUtilityLogger.PerfUtil.loadStart(Ge.area)},e.loadEnd=function(){l.SIClientUtilityLogger.PerfUtil.loadEnd(Ge.area,this.context)},e.updatePageTitle=function(e){window&&window.document&&(window.document.title=e)},e.getFormattedDateString=function(e,t){var n=new Date,i=new Date(e);return n.getUTCFullYear===i.getUTCFullYear&&n.getUTCMonth===i.getUTCMonth&&0==n.getUTCDate()-i.getUTCDate()?this.getTimeStringInUserTimeZone(i,t):t.formatting.formatDateShort(i,!1)},e.getTimeStringInUserTimeZone=function(e,t){var n=t.formatting.formatTime(e,1),i=t.formatting.formatDateShort(e);return n.replace(i,"").trim()},e.getDateTime=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0);var i=new Date;return i.setDate(i.getDate()+e),i.setMonth(i.getMonth()+t),i.setFullYear(i.getFullYear()+n),i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate()},e.showErrorField=function(e){var t,n,i=document.getElementsByClassName(e);i&&i.length>0&&(null==(t=(n=i[0]).focus)||t.call(n))},e.setTabIndexOnEditColumnsDropDown=function(){var e,t=document.getElementsByClassName("editColumnsDropdownItemsDiv");null==t||null==(e=t[0])||e.setAttribute("tabindex","0")},e.openEntityInMFD=function(e,t,n){var i;window.Xrm&&(null==(i=window.Xrm.Navigation)||i.navigateTo({pageType:"entityrecord",entityName:e,entityId:t},{target:2,position:1,width:{value:80,unit:"%"}}).then((function(){n&&n()})))},e.reportUserAction=function(t,n,i,r,o,a){l.SIClientUtilityLogger.Telemetry.reportUserAction(e.getEventParams(t,n,i,r,o,a))},e.reportInfo=function(t,n,i,r,o,a){l.SIClientUtilityLogger.Telemetry.reportInfo(e.getEventParams(t,n,i,r,o,a))},e.reportWarning=function(t,n,i,r,o,a){l.SIClientUtilityLogger.Telemetry.reportWarning(e.getEventParams(t,n,i,r,o,a))},e.reportError=function(t,n,i,r,o,a){l.SIClientUtilityLogger.Telemetry.reportError(e.getEventParams(t,n,i,r,o,a))},e.getEventParams=function(t,n,i,r,o,a){return l.SIClientUtilityLogger.Telemetry.getEventParams(e.context,Ge.area,t,n,i,r,o,a)},e.getLocalizedString=function(t){if(e.context){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return e.context.resources.getString(t).format(i)}return t},e.TriggerSurvey=function(e,t){Ze.TriggerEventAndHandleSurvey("salesinsight",e,t,{productContext:"Sales Hub",renderDimensions:{width:"47vw",height:"60vh"}})},e.OpenFeedbackSurvey=function(){var e={productContext:"Sales Hub",renderDimensions:{width:function(e){switch(!0){case e<700:return"85vw";case e<1888:return"45vw";default:return"850px"}}(document.documentElement.clientWidth),height:document.documentElement.clientHeight>850?"680px":"80vh"}};Ze.HandleSendFeedbackClicked(e)},e.getPluralNameOfEntity=function(e){switch(e){case me.Opportunity:return"opportunities";case me.Contact:return"contacts";case me.Account:return"accounts";case me.Lead:return"leads";default:return""}},e.doesRecordCountExceedLimit=function(e){return e>Ke.recordLimit||-1==e},e.InitializeChannelIntegrationFameworkState=function(){e.isCIFSupportedInitialized||e.context.webAPI.retrieveMultipleRecords(e.channelIntegrationProviderEntityLogicalName,e.ciProviderEntityRecordQuery).then((function(t){var n;(null==t||null==(n=t.entities)?void 0:n.length)>0&&(e.isCIFSupported=!0)}),(function(t){e.isCIFSupported=!1}))},e.isChannelIntegrationFrameworkSupported=function(){return e.isCIFSupported},e.isRTL=function(){return e.context.userSettings.isRTL},e.getXrmGlobalContext=function(){var e=null;try{e=window.Xrm&&Xrm.Utility&&Xrm.Utility.getGlobalContext()}catch(e){}return e},e.SaveSetting=function(){var e=Fe(He.mark((function e(t,n){var i,r;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((i=this.getXrmGlobalContext())&&i.saveSettingValue&&i.getCurrentAppSetting)){e.next=6;break}if(null===i.getCurrentAppSetting(t)||void 0===i.getCurrentAppSetting(t)){e.next=6;break}return r={overrideScope:1},e.next=6,i.saveSettingValue(t,n,r);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}();Je.getFeatureSupport=function(e){return{isChartSupported:e===me.Opportunity,isStatsSupported:e===me.Opportunity}},Je.channelIntegrationProviderEntityLogicalName="msdyn_ciprovider",Je.ciProviderEntityRecordQuery="?$filter=statuscode eq 1&$select=msdyn_landingurl,msdyn_roleselector,msdyn_clicktoact,msdyn_appselector",Je.isCIFSupported=!1,Je.isCIFSupportedInitialized=!1,String.prototype.format=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=this,r=0;r<t[0].length;r++){var o=void 0===arguments[0][r]||null==arguments[0][r]?"":arguments[0][r].toString();i=i.replace(new RegExp("\\{"+r+"\\}","g"),o)}return i};var Qe=function(){};Qe.ACTIVITY="activity",Qe.SUMMARY="summary",Qe.SUMMARY_KEY_DETAILS="summary_keydetails",Qe.SUMMARY_CONTACTS="summary_contacts",Qe.SUMMARY_NOTES="summary_notes",Qe.SUMMARY_TASKS="summary_tasks",Qe.SUMMARY_COLLABORATION="summary_collaboration",Qe.SUMMARY_RECENTOPPORTUNITIES="summary_recentopportunities";var Ye=function(){};Ye.CLICK="Click";var $e=function(){};$e.SUCCESS="Success",$e.FAILED="Failed";var et=u.createTheme({palette:{themePrimary:"#2266E3",themeLighterAlt:"#f5f8fe",themeLighter:"#d8e4fb",themeLight:"#b8cef7",themeTertiary:"#759fee",themeSecondary:"#3a76e6",themeDarkAlt:"#1f5bcc",themeDark:"#1a4dac",themeDarker:"#13397f",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"}}),tt=et.palette.neutralSecondary,nt=u.mergeStyles({margin:"20px 0 0 0"}),it=u.mergeStyles({display:"flex",flexDirection:"row",paddingBottom:2,margin:"0 20px"}),rt={fontSize:"12px",color:tt,margin:"0 4px 0 0"},ot=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={isCollapsed:n.props.isCollapsed,commands:[]},n}Me(t,e);var n=t.prototype;return n.render=function(){return Je.reportInfo("render","Section","",{section:this.props.section.key.toLowerCase()}),a.createElement("div",{className:"icv-section-container "+nt},a.createElement("div",{className:"icv-section-header "+it},a.createElement(d.ActionButton,{iconProps:{iconName:this.state.isCollapsed?Ue.chevronRight.iconName:Ue.chevronDown.iconName},ariaLabel:Je.getLocalizedString("ICV_CollapseExpand",this.props.section.labelDescription),styles:{root:{width:"100%",padding:0,height:"32px"},rootHovered:{backgroundColor:"white"},rootPressed:{backgroundColor:"white"},icon:rt,iconHovered:{color:"#605E5C"},label:{color:"#323130",fontWeight:this.state.isCollapsed?400:600,fontSize:"14px",lineHeight:"20px"},flexContainer:{float:"left"}},onClick:this.setExpandCollapse.bind(this)},this.props.section.showLabel&&this.props.section.labelDescription),this.state.commands.length>0&&this.getCommands()),!this.state.isCollapsed&&Pi.getSectionView(Pe({},Pe({},this.props,{registerCommands:this.registerCommands.bind(this)}))))},n.registerCommands=function(e){this.setState({commands:e})},n.getCommands=function(){return a.createElement("div",null,this.state.commands.map((function(e){return Pi.getNavigationCommand(e)})))},n.setExpandCollapse=function(){Je.reportUserAction("setExpandCollapse","Section","Expand collapse clicked",{status:!this.state.isCollapsed,section:this.props.section.key.toLowerCase()},Ye.CLICK,"Expand or Collapse Icon"),this.setState({isCollapsed:!this.state.isCollapsed})},t}(a.Component),at=u.mergeStyles({display:"flex"}),st=u.mergeStyles({padding:0,listStyle:"none",margin:0}),lt=function(e){return o.createElement("ul",{className:st},o.Children.map(e.children,(function(e){return o.createElement("li",{className:at},e)})))},ct=function(){};ct.digitalBlue="#2266E3",ct.grey="#F3F2F1",ct.editDeletIconhover="#E1DFDD",ct.red="red",ct.white="#FFFFFF",ct.chartsNeutralDark="#888888",ct.chartsBlueLight="#418DED",ct.chartsTealLight="#0299A3",ct.chartsCautionDark="#D3561D";var dt=function(){};dt.size2px="2px",dt.size4px="4px",dt.size22px="22px",dt.size10px="10px";var ut,pt=u.mergeStyles({".showOutline &:focus":{outline:"solid 1px "+p.NeutralColors.gray130+" !important"}}),mt=u.mergeStyles({padding:"0 20px",height:32}),ht=u.mergeStyles({color:p.NeutralColors.gray160,fontSize:u.FontSizes.size14,lineHeight:u.FontSizes.size24,fontWeight:u.FontWeights.semibold}),gt=u.mergeStyles(ht,{color:p.NeutralColors.white,padding:"0 10px",marginLeft:-10,background:ct.digitalBlue,borderRadius:100}),ft=function(e){return o.createElement(u.Stack,{"aria-label":e.headerText,className:pt,tabIndex:0,tokens:{childrenGap:2}},o.createElement(u.Stack,{className:mt,horizontal:!0,tokens:{childrenGap:8},verticalAlign:"center"},"today"===e.relativeWeekday&&o.createElement(u.Text,{className:gt},Je.getLocalizedString("Activities_Today")),"yesterday"===e.relativeWeekday&&o.createElement(u.Text,{className:ht},Je.getLocalizedString("Activities_Yesterday")),e.relativeWeekday&&o.createElement("span",null,""),o.createElement(u.Text,{className:u.mergeStyles(ht,e.headerTextClassName)},e.headerText)),e.children)},yt=u.mergeStyles({width:28,height:28,position:"relative",display:"flex",alignItems:"center",justifyContent:"center"}),vt=u.mergeStyles({position:"absolute",width:"100%",height:"100%",top:0,left:0,borderRadius:"100%",backgroundColor:"currentColor",opacity:.1}),Ct=u.mergeStyles({width:16,height:16,color:"currentColor",fontSize:u.FontSizes.size16}),St=function(e){var t=o.useMemo((function(){return u.mergeStyles(yt,{color:e.color})}),[e.color]);return o.createElement("div",{className:t},o.createElement("div",{className:vt}),o.createElement(u.Icon,{iconName:e.iconName,className:Ct}))},Et=u.mergeStyles({overflow:"hidden",padding:"6px 0"}),bt=u.mergeStyles({background:p.NeutralColors.gray30,zIndex:1,width:2,height:"100%"}),wt=u.mergeStyles({height:12,flexShrink:0}),Dt=u.mergeStyles({height:"100%"}),Tt=u.mergeStyles({fontSize:u.FontSizes.size14,fontWeight:u.FontWeights.semibold,lineHeight:u.FontSizes.size20}),xt=u.mergeStyles({fontSize:u.FontSizes.size12,lineHeight:u.FontSizes.size20}),kt=u.mergeStyles(xt,{color:p.NeutralColors.gray160}),_t=u.mergeStyles(xt,{color:p.NeutralColors.gray130}),Nt=u.mergeStyles(((ut={width:"100%",height:"unset",border:0,textAlign:"left",padding:"0 20px",borderRadius:0,backgroundColor:"transparent"})["&:hover ."+bt]={backgroundColor:p.NeutralColors.gray40},ut["&:active ."+bt]={backgroundColor:p.NeutralColors.gray50},ut)),Lt=u.mergeStyles({color:p.NeutralColors.gray130}),It=u.mergeStyles({color:p.NeutralColors.gray130,fontSize:u.FontSizes.size12,lineHeight:u.FontSizes.size20}),At=function(e,t){if(!(t<=1))return 0===e?"bottom":e===t-1?"top":"both"},Rt={DateTime2:ct.chartsCautionDark,MailForward:ct.chartsBlueLight,MailForwardMirrored:ct.chartsBlueLight,OutgoingCall:ct.chartsTealLight,IncomingCall:ct.chartsTealLight},Ft=function(e){return e.isUpcoming?ct.chartsNeutralDark:Rt[e.iconName]},Pt=function(e){var t=e.onClick,n=e.activity,i=e.connector;return o.createElement(u.DefaultButton,{styles:{flexContainer:{display:"block"}},onClick:function(){return t(n)},className:Nt},o.createElement(u.Stack,{horizontal:!0,tokens:{childrenGap:8}},o.createElement(u.Stack.Item,{disableShrink:!0},o.createElement(u.Stack,{style:{height:"100%"}},o.createElement(u.Stack.Item,{align:"center",className:wt},o.createElement("div",{className:"both"===i||"top"===i?bt:""})),o.createElement(u.Stack.Item,{align:"center"},o.createElement(St,{iconName:n.iconName,color:Ft(n)})),o.createElement(u.Stack.Item,{align:"center",className:Dt},o.createElement("div",{className:"both"===i||"bottom"===i?bt:""})))),o.createElement(u.Stack.Item,{grow:!0,className:Et},o.createElement(u.Stack,null,o.createElement(u.Stack.Item,{shrink:!0},o.createElement(u.Stack,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:8}},o.createElement(u.Text,{className:Tt,title:n.header,nowrap:!0},n.header),o.createElement(u.Stack.Item,{disableShrink:!0},o.createElement(u.Text,{className:It},n.isUpcoming?n.formattedDate:n.timestamp)))),n.subHeader1&&o.createElement(u.Text,{className:kt,title:n.subHeader1,nowrap:!0},n.subHeader1),n.subHeader2&&o.createElement(u.Stack,{horizontal:!0,verticalAlign:"center",tokens:{childrenGap:6}},"appointment"===n.activitytypecode&&o.createElement(u.Icon,{iconName:"POI",className:Lt}),o.createElement(u.Text,{className:_t,title:n.subHeader2,nowrap:!0},n.subHeader2))))))},Mt=u.mergeStyles({margin:"22px 16px",border:0,borderTop:"1px solid "+p.NeutralColors.gray30}),Ot=u.mergeStyles({fontWeight:u.FontWeights.semibold,padding:"0 20px"}),Vt=u.mergeStyles({color:p.NeutralColors.gray130,fontWeight:p.FontWeights.regular}),zt=function(e){return o.createElement(ft,{headerText:Je.getLocalizedString("Activities_Upcoming_Appointments"),headerTextClassName:Vt},o.createElement(lt,null,e.activities.map((function(t){return o.createElement(Pt,{activity:t,key:t.activityid,onClick:e.onActivityClick})}))))},Bt=function(e){var t=e.activities,n=e.upcomingAppointments,i=e.onActivityClick,r=t.length>0,a=n.length>0,s=o.useMemo((function(){return r?function(e){for(var t,n,i=[],r=ze(e);!(n=r()).done;){var o=n.value;t&&o.formattedDate===t.formattedDate||i.push(t={activities:[],formattedDate:o.formattedDate,relativeWeekday:o.relativeWeekday}),t.activities.push(o)}return i}(t):[]}),[t,r]);return r||a?o.createElement("div",null,a&&o.createElement(zt,{activities:n,onActivityClick:i}),a&&r&&o.createElement("hr",{className:Mt}),r&&o.createElement(u.Stack,{tokens:{childrenGap:28}},s.map((function(e){var t=e.activities,n=e.formattedDate;return o.createElement(ft,{key:n,headerText:n,relativeWeekday:e.relativeWeekday},o.createElement(lt,null,t.map((function(e,n){return o.createElement(Pt,{key:e.activityid,onClick:i,activity:e,connector:At(n,t.length)})}))))})))):o.createElement("div",{className:Ot},Je.getLocalizedString("Activities_EmptyList"))},Ut=u.mergeStyles({margin:"22px 0"}),Ht=function e(t){o.useEffect((function(){Je.reportUserAction("ActivitiesControl",e.name,"",{},"loaded","")}),[]);var n=o.useMemo((function(){var e=[].concat(t.activities.activityList);e.sort((function(e,t){return t.date.getTime()-e.date.getTime()}));for(var n,i=[],r=[],o=ze(e);!(n=o()).done;){var a=n.value;a.activitytypecode===be.Appointment&&a.isUpcoming?r.push(a):i.push(a)}return{activities:i,upcomingAppointments:r}}),[t.activities.activityList]);return a.createElement("div",{className:Ut},a.createElement(Bt,{activities:n.activities,upcomingAppointments:n.upcomingAppointments,onActivityClick:function(e){e&&Je.openEntityInMFD(e.activitytypecode,e.activityid,(function(){t.onActivityAdded&&t.onActivityAdded(null)}))}}))},Gt=function(){};Gt.getPersonaShimmer=function(){return a.createElement("div",{className:"icv-header-personaContainer"},a.createElement(m.ShimmerElementsGroup,{shimmerElements:[{type:m.ShimmerElementType.circle,height:48},{type:m.ShimmerElementType.gap,width:14,height:48}]}),a.createElement(m.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:"100%",height:24},{type:m.ShimmerElementType.line,width:"100%",height:20}]}))},Gt.getFieldShimmer=function(){return a.createElement("div",null,a.createElement(m.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:"100%",height:42}]}))},Gt.getTitleShimmer=function(){return a.createElement("div",null,a.createElement(m.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:150,height:24}]}))},Gt.getCommandBarShimmer=function(){return a.createElement("div",null,a.createElement(m.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:"100%",height:12}]}))},Gt.getGridOrChartShimmer=function(){return a.createElement("div",null,a.createElement(m.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:"100%"}]}))},Gt.getButtonIconShimmer=function(){return a.createElement("div",null,a.createElement(m.ShimmerElementsGroup,{flexWrap:!0,width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:40,height:44}]}))},Gt.getCOLAViewShimmer=function(){return a.createElement(a.Fragment,null,Gt.getKeyDetailsShimmer(),Gt.getCommonSectionShimmer(),Gt.getCommonSectionShimmer())},Gt.getKeyDetailsShimmer=function(){return a.createElement(a.Fragment,null,a.createElement(m.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:m.ShimmerElementType.gap,width:"100%",height:30}]}),a.createElement(m.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:"100%",height:24}]}),a.createElement(m.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:m.ShimmerElementType.gap,width:"100%",height:20}]}),a.createElement(m.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:"100%",height:240}]}))},Gt.getCommonSectionShimmer=function(){return a.createElement(a.Fragment,null,a.createElement(m.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:m.ShimmerElementType.gap,width:"100%",height:20}]}),a.createElement(m.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:"100%",height:24}]}),a.createElement(m.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:m.ShimmerElementType.gap,width:"100%",height:20}]}),a.createElement(m.ShimmerElementsGroup,{width:"100%",shimmerElements:[{type:m.ShimmerElementType.line,width:"100%",height:80}]}))},Gt.wrapperComponentInShimmerContainer=function(e,t,n){return a.createElement(m.Shimmer,{customElementsGroup:t,isDataLoaded:n},e)},Gt.getChartShimmerStyles=function(){return{shimmerWrapper:[{width:"auto !important",minHeight:"350px !important",margin:"0px 0px 0px 16px !important"}]}},Gt.getGridOptionsShimmerStyles=function(){return{root:[{borderBottom:"1px solid #f3f2f1"}],shimmerWrapper:[{width:"auto !important",margin:"15px 20px",borderBottom:"1px solid #f3f2f1"}]}},Gt.getFilterBarShimmerStyles=function(){return{shimmerWrapper:[{width:"auto !important",margin:"10px 0px 10px 70%"}]}},Gt.getGridShimmerStyles=function(){return{dataWrapper:[{height:"100%"}],root:[{height:"100%"}],shimmerWrapper:[{margin:"20px 20px",width:"auto !important",height:"calc(100% - 40px)"}]}};var Wt=u.mergeStyles({padding:"0 20px"}),jt=function(e){function t(t){return e.call(this,t)||this}Me(t,e);var n=t.prototype;return n.render=function(){var e,t,n,i,r,o,s,l,c;if(Je.reportInfo("render","Tab","",{tab:null==(e=this.props.tab)?void 0:e.key}),(null==(t=this.props.tab)?void 0:t.key.toLowerCase())===Qe.ACTIVITY){var d=Pe({},this.props,{activities:this.props.activities||{recordId:this.props.entity.entityId,activityList:[]},onActivityAdded:this.props.onActivityAdded});return a.createElement(Ht,Object.assign({},d))}var u=(null==(n=this.props.tab)||null==(i=n.columns)?void 0:i.length)>0&&(null==(r=this.props.tab)?void 0:r.columns[0].sections)&&(null==(o=this.props.tab)?void 0:o.columns[0].sections.length)>0,p=Boolean(u)?"":Wt;return a.createElement("div",{className:"icv-tab-content "+p},a.createElement(m.Shimmer,{customElementsGroup:Gt.getCOLAViewShimmer(),isDataLoaded:u},(null==(s=this.props.tab)?void 0:s.columns)&&(null==(l=this.props.tab)?void 0:l.columns.length)&&this.getSections(null==(c=this.props.tab)?void 0:c.columns[0].sections)))},n.getSections=function(e){var t=this;return Je.reportInfo("render","Tab","",{sections:e.map((function(e){return e.key.toLowerCase()}))}),e=this.filterSections(e),Je.reportInfo("render","Tab","Filtered",{sections:e.map((function(e){return e.key.toLowerCase()}))}),e&&e.map((function(e){var n=Pe({},t.props,{section:e,isCollapsed:!1});return a.createElement(ot,Object.assign({},n,{key:n.section.labelDescription}))}))},n.filterSections=function(e){return e.filter((function(e){return e.key.toLowerCase()===Qe.SUMMARY_KEY_DETAILS||e.key.toLowerCase()===Qe.SUMMARY_CONTACTS||e.key.toLowerCase()===Qe.SUMMARY_TASKS||e.key.toLowerCase()===Qe.SUMMARY_NOTES||e.key.toLowerCase()===Qe.SUMMARY_RECENTOPPORTUNITIES}))},t}(a.Component),Xt=u.mergeStyles({padding:0}),Kt=function(e){function t(t){return e.call(this,t)||this}Me(t,e);var n=t.prototype;return n.render=function(){var e=this;Je.reportInfo("render","TabList","",{tabs:this.props.tabs.map((function(e){return e.key.toLowerCase()}))});var t,n=this.filterTabs();return Je.reportInfo("render","TabList","Filtered",{tabs:n.map((function(e){return e.key.toLowerCase()}))}),t=n&&n.length>0&&this.props.entityMetadata?n.map((function(t){var n=Pe({},e.props,{tab:t});return a.createElement(s.PivotItem,{className:"icv-pivot-content "+Xt,headerText:t.name},a.createElement(jt,Object.assign({},n,{key:t.key})))})):[a.createElement(s.PivotItem,{className:"icv-pivot-content "+Xt,headerText:""},a.createElement(jt,Object.assign({},this.props)))],a.createElement(s.Pivot,{className:"icv-tablist-header",styles:{root:{borderBottom:"1px",borderBottomStyle:"solid",borderColor:"#EAEAEA"},itemContainer:{overflow:"auto"}}},t)},n.filterTabs=function(){return this.props.tabs.filter((function(e){return e.key.toLowerCase()==Qe.SUMMARY||e.key.toLowerCase()==Qe.ACTIVITY}))},t}(a.Component),qt=function(){};qt.isToday=function(e){var t=new Date;return e.getDate()==t.getDate()&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},qt.isYesterday=function(e){var t=new Date;return e.getDate()==t.getDate()-1&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()},qt.isOverdue=function(e){return e.getTime()<Date.now()},qt.showEmptyListText=function(e,t,n){return void 0!==e&&0===e.length&&0==t.length&&0==n.length},qt.filterTasksByState=function(e){var t=[],n=[];return e.forEach((function(e){e.statecode===ye.Completed?n.push(e):t.push(e)})),{inProgTaskList:t,completedTaskList:n}},qt.OpenQuickCreateTask=function(e,t,n,i,r){return Promise.resolve(e.navigation.openForm({entityName:"task",useQuickCreateForm:!0},{regardingobjectid:n,regardingobjectidname:i,regardingobjectidtype:r.toLowerCase()}).then((function(e){return e.savedEntityReference?t.fetchTask(e.savedEntityReference[0].id):void 0})))};var Zt=function(){function e(){}return e.getDirectionCodeText=function(e){return Je.getLocalizedString(e===De.Outgoing?"Activities_DirectionCode_Outgoing":"Activities_DirectionCode_Incoming")},e}();Zt.createActivityParticpantsList=function(e){return e.activitypointer_activity_parties.map((function(e){return{participationTypeMask:e.participationtypemask,name:e["_partyid_value@OData.Community.Display.V1.FormattedValue"]}}))},Zt.createBaseActivity=function(e,t,n){void 0===t&&(t=e.createdon),void 0===n&&(n=e["createdon@OData.Community.Display.V1.FormattedValue"]);var i=n,r=i.indexOf(" "),o=i.substring(0,r);r>0&&(i=i.substr(r+1));var a=new Date(t),s=qt.isToday(a),l=qt.isYesterday(a),c=!s&&a.getTime()>Date.now(),d=null;return s?d="today":l&&(d="yesterday"),{activitytypecode:e.activitytypecode,activityId:e.activityid,activityFriendlyName:e["activitytypecode@OData.Community.Display.V1.FormattedValue"],subject:e.subject,participants:Zt.createActivityParticpantsList(e),date:a,timestamp:i,formattedDate:o,relativeWeekday:d,isUpcoming:c}},Zt.createAppointmentActivity=function(e){var t=Zt.createBaseActivity(e,e.activity_pointer_appointment[0].scheduledstart,e.activity_pointer_appointment[0]["scheduledstart@OData.Community.Display.V1.FormattedValue"]),n=e.activity_pointer_appointment[0].location||"",i="";return t.participants.length>0&&(i=2===t.participants.length?t.participants[0].name+Je.getLocalizedString("Activities_Appointment_Other"):t.participants.length>2?t.participants[0].name+Je.getLocalizedString("Activities_Appointment_Others",t.participants.length-1):t.participants[0].name),{activitytypecode:t.activitytypecode.toString().toLowerCase(),activityid:t.activityId,header:t.subject,subHeader1:i,subHeader2:n,iconName:"DateTime2",date:t.date,timestamp:t.timestamp,formattedDate:t.formattedDate,relativeWeekday:t.relativeWeekday,isUpcoming:t.isUpcoming}},Zt.createPhoneCallActivity=function(e){var t=Pe({},Zt.createBaseActivity(e),{activityFriendlyName:Je.getLocalizedString("Activities_PhoneCall_FriendlyName")}),n=e.activity_pointer_phonecall[0],i=n.directioncode,r=Je.getLocalizedString("Activities_PhoneCall_Duration",n["actualdurationminutes@OData.Community.Display.V1.FormattedValue"]),o=i===De.Outgoing?t.participants[1].name:t.participants[0].name,a=t.activityFriendlyName+" "+Zt.getDirectionCodeText(i)+" "+o,s=i===De.Outgoing?"OutgoingCall":"IncomingCall";return{activitytypecode:t.activitytypecode.toString().toLowerCase(),activityid:t.activityId,header:a,subHeader2:r,iconName:s,date:t.date,timestamp:t.timestamp,formattedDate:t.formattedDate,relativeWeekday:t.relativeWeekday,isUpcoming:t.isUpcoming}},Zt.createEmailActivity=function(e){var t,n=Zt.createBaseActivity(e),i=e.activity_pointer_email[0],r=i.directioncode,o=(null==(t=(new DOMParser).parseFromString(i.description,"text/html").body.textContent)?void 0:t.replace(/(\r\n|\n|\r)/gm,""))||"",a=n.subject||Je.getLocalizedString("Activities_Email_NoSubject"),s="",l=n.activityFriendlyName+" "+Zt.getDirectionCodeText(r)+" ";if(n.participants.length>0)if(r===De.Outgoing){var c=n.participants.find((function(e){return e.participationTypeMask===we.ToRecipient})),d=n.participants.find((function(e){return e.participationTypeMask===we.CCRecipient})),u=n.participants.find((function(e){return e.participationTypeMask===we.BccRecipient}));c?s=l+c.name:d?s=l+d.name:u&&(s=l+u.name)}else{var p=n.participants.find((function(e){return e.participationTypeMask===we.Sender}));p&&(s=l+p.name)}var m=r===De.Outgoing?"MailForward":"MailForwardMirrored";return{activitytypecode:n.activitytypecode.toString().toLowerCase(),activityid:n.activityId,header:a,subHeader1:s,subHeader2:o,iconName:m,date:n.date,timestamp:n.timestamp,formattedDate:n.formattedDate,relativeWeekday:n.relativeWeekday,isUpcoming:n.isUpcoming}},Zt.createActivityByType=function(e){switch(e.activitytypecode){case be.Email:return Zt.createEmailActivity(e);case be.PhoneCall:return Zt.createPhoneCallActivity(e);case be.Appointment:return Zt.createAppointmentActivity(e);default:throw new Error("Unexpected Activity type")}},Zt.OpenQuickCreateActivity=function(e,t,n,i,r,o,a){return Promise.resolve(e.navigation.openForm({entityName:n.toString(),useQuickCreateForm:!0,createFromEntity:{entityType:o.toLowerCase(),id:i,name:r}},a).then(function(){var e=Fe(He.mark((function e(n){return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.savedEntityReference){e.next=7;break}return e.next=3,t.fetchActivities(i,n.savedEntityReference[0].id);case 3:return e.abrupt("return",e.sent.activityList[0]);case 7:return e.abrupt("return",void 0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))};var Jt={root:{padding:"0px",height:32}},Qt=function(e){var t=e.onActivityAdded,n=a.useState(!1),i=n[0],r=n[1],s=o.useState(1e3)[0],l=function(n){var i,o,a,s,l,c,d,u,p,m;e.datasetRecord&&(n===be.Email?(null==(i=window.MscrmControls)||i.Sales.DealManager.WrapperContainer.executeWorkspaceCommand({command:"openEmail",entityId:e.entity.entityId,entityType:e.entity.entityType,entityName:e.datasetRecord.formattedValues.get("name"),emailParameters:{to:[{id:null==(o=e.datasetRecord.values.get("parentcontactid"))?void 0:o.id,entityType:null==(a=e.datasetRecord.values.get("parentcontactid"))?void 0:a.entityLogicalName,name:null==(s=e.datasetRecord.values.get("parentcontactid"))?void 0:s.displayName}]}}),r(!0)):Zt.OpenQuickCreateActivity(e.context,e.services.dataService,n,e.datasetRecord.recordId,e.datasetRecord.formattedValues.get("name")||"",e.entity.entityType,{to:[{id:null==(l=e.datasetRecord.values.get("parentaccountid"))?void 0:l.id,entityType:null==(c=e.datasetRecord.values.get("parentaccountid"))?void 0:c.entityLogicalName,name:null==(d=e.datasetRecord.values.get("parentaccountid"))?void 0:d.displayName}],requiredattendees:[{id:null==(u=e.datasetRecord.values.get("parentaccountid"))?void 0:u.id,entityType:null==(p=e.datasetRecord.values.get("parentaccountid"))?void 0:p.entityLogicalName,name:null==(m=e.datasetRecord.values.get("parentaccountid"))?void 0:m.displayName}]}).then((function(e){e&&t(e)})))},c=[{key:"newItem",text:Je.getLocalizedString("Activities_Header_NewActivity"),cacheKey:"theCacheKey",iconProps:{iconName:"Add"},subMenuProps:{items:[{key:"appointmenetEvent",text:Je.getLocalizedString("Activities_Header_NewAppointment"),iconProps:{iconName:"DateTime2"},onClick:function(){l(be.Appointment)}},{key:"emailEvent",text:Je.getLocalizedString("Activities_Header_NewEmail"),iconProps:{iconName:"Mail"},onClick:function(){l(be.Email)}},{key:"callEvent",text:Je.getLocalizedString("Activities_Header_NewPhonecall"),iconProps:{iconName:"Phone"},onClick:function(){l(be.PhoneCall)}}]}}];return function(e,t){var n=o.useRef();o.useEffect((function(){n.current=e}),[e]),o.useEffect((function(){if(null!==t){var e=setInterval((function(){null!=n.current&&n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){0==document.getElementsByClassName("jsPanel").length>0&&(t(null),r(!1))}),i?s:null),a.createElement(f.CommandBar,{styles:Jt,items:c,ariaLabel:Je.getLocalizedString("Activities_Header_HelpText")})},Yt=et.palette,$t=Yt.neutralPrimary,en=Yt.neutralSecondary,tn=u.mergeStyles({display:"flex",flexDirection:"column",padding:20,paddingBottom:0}),nn=u.mergeStyles({display:"flex",flexDirection:"row"}),rn=u.mergeStyles({width:48,marginRight:12}),on=u.mergeStyles({height:48,display:"flex",flexDirection:"column",width:"calc(100% - 60px)"}),an=u.mergeStyles({fontSize:18,lineHeight:24,fontWeight:600,textOverflow:"ellipsis",overflowWrap:"break-word",wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",color:$t}),sn=u.mergeStyles({fontSize:14,lineHeight:20,textOverflow:"ellipsis",overflowWrap:"break-word",wordBreak:"break-word",whiteSpace:"nowrap",overflow:"hidden",color:en}),ln=({color:$t,cursor:"pointer",textDecoration:"none"}["&:hover"]={color:$t,textDecoration:"underline"},u.mergeStyles({display:"flex",margin:"16px 0 8px 0"})),cn=u.mergeStyles({padding:"8px"}),dn={gapSpace:0},un=window.location.href,pn=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={isCollaborationEnabled:n.isCollaborationFeatureEnabled()},n}Me(t,e);var n=t.prototype;return n.render=function(){if(Je.reportInfo("render","Header","",{id:this.props.entity.entityId,type:this.props.entity.entityType}),null!=window.forceEnableCollaboration&&0!=window.forceEnableCollaboration&&this.enableCollaborationFeature(),this.state.isCollaborationEnabled!=this.isCollaborationFeatureEnabled()){var e=this.isCollaborationFeatureEnabled();this.setState({isCollaborationEnabled:e})}return this.getHeader()},n.getHeader=function(){var e,t="",n="";return this.props.datasetRecord&&this.props.formXml&&this.props.formXml.header&&(this.props.formXml&&this.props.formXml.header&&this.props.formXml.header.length>2&&(t=this.props.datasetRecord.formattedValues.get(this.props.formXml.header[1].datafieldName)||"",n=this.props.datasetRecord.formattedValues.get(this.props.formXml.header[2].datafieldName)||""),e={imageUrl:this.getEntityImageUrl(this.props.entity.entityType,this.props.entity.entityId),imageInitials:this.getEntityInitials(this.props.datasetRecord.formattedValues.get(this.props.formXml.header[0].datafieldName)||"")}),o.createElement("div",{className:"icv-header-container "+tn},o.createElement(m.Shimmer,{customElementsGroup:Gt.getPersonaShimmer(),isDataLoaded:e&&(""!=t||""!=n||null!=e.imageUrl||null!=e.imageInitials)},o.createElement("div",{className:"icv-header-personaContainer "+nn},o.createElement(h.Persona,Object.assign({},e,{size:h.PersonaSize.size48,className:"icv-header-personaIcon "+rn,imageAlt:Je.getLocalizedString("ICV_Persona_Icon")})),this.props.formXml&&this.props.formXml.header&&this.getPersonaText(t,n))),this.getIconBar())},n.getEntityInitials=function(e){var t=e.split(" ");return t[1]?(t[0].charAt(0)+t[1].charAt(0)).toUpperCase():(t[0].charAt(0)+t[0].charAt(1)).toUpperCase()},n.getEntityImageUrl=function(e,t){if(e==me.Contact||e==me.Account)return"./Image/download.aspx?Entity="+e+"&Attribute=entityimage&Id="+t;if(e==me.Opportunity){var n,i=(null==(n=this.props.datasetRecord)?void 0:n.formattedValues.get(this.props.formXml.header[0].datafieldName))||"";if(i)return"./Image/download.aspx?Entity="+me.Account+"&Attribute=entityimage&Id="+i}return""},n.getPersonaText=function(e,t){var n,i=this,r=null==(n=this.props.datasetRecord)?void 0:n.values.get(this.props.formXml.header[2].datafieldName),a=(null==r?void 0:r.entityLogicalName)||"",s=(null==r?void 0:r.id)||"";return o.createElement("div",{className:"icv-header-personaText "+on},o.createElement("label",{className:"icv-header-primaryText "+an,title:e},e),!a&&o.createElement("label",{className:"icv-header-secondaryText "+sn},t),a&&o.createElement("label",{className:"icv-header-secondaryText "+sn,onClick:function(){return i.openEntity(a,s)},title:t},t))},n.openEntity=function(e,t){Je.reportUserAction("openEntity","Header","Open record clicked",{type:e,id:t},Ye.CLICK,"Header subtitle clicked");var n,i=this.getEntityType(e);i?null==(n=this.props.viewEventHandlers)||null==n.onOpenView||n.onOpenView({entityType:i,entityId:t},ve.Default):Je.openEntityInMFD(e,t)},n.getEntityType=function(e){switch(e.toLowerCase()){case"account":return me.Account;case"contact":return me.Contact;case"opportunity":return me.Opportunity;case"lead":return me.Lead;default:return null}},n.getIconBar=function(){var e=this;return o.createElement("div",{className:"icv-header-reflowContainer "+ln},o.createElement("div",{style:{width:"auto"}},o.createElement(Qt,Object.assign({},this.props))),this.state.isCollaborationEnabled&&o.createElement("div",{style:{width:"auto"}},o.createElement(g.TooltipHost,{content:Je.getLocalizedString("ICV_View_Chats"),calloutProps:dn,directionalHint:g.DirectionalHint.bottomCenter},o.createElement(d.IconButton,{id:Ke.openCollabButtonKey,iconProps:Ue.officeChat,className:"icv-header-iconStyle "+cn,ariaLabel:Je.getLocalizedString("ICV_Chat"),onClick:function(){var t;Je.reportUserAction("getIconBar","Header","Open chat clicked",{},Ye.CLICK,"Chat icon clicked"),null==(t=e.props.viewEventHandlers)||null==t.onOpenView||t.onOpenView({entityId:e.props.entity.entityId,entityType:me.Chat},ve.Chat,e.props.relatedEntity||e.props.entity,null,Ke.openCollabButtonKey)}}))),o.createElement("div",{style:{width:"auto"}},o.createElement(g.TooltipHost,{content:Je.getLocalizedString("ICV_View_Notes"),calloutProps:dn,directionalHint:g.DirectionalHint.bottomCenter},o.createElement(d.IconButton,{id:Ke.openNotesButtonKey,iconProps:Ue.notes,className:"icv-header-iconStyle "+cn,ariaLabel:Je.getLocalizedString("ICV_Notes"),onClick:function(){var t,n;Je.reportUserAction("getIconBar","Header","Open Notes clicked",{count:(null==(t=e.props.notes)||null==(n=t.noteList)?void 0:n.length)||0},Ye.CLICK,"Notes icon clicked"),e.props.viewEventHandlers&&(null==e.props.viewEventHandlers.onOpenView||e.props.viewEventHandlers.onOpenView({entityId:"",entityType:me.Note},ve.List,e.props.relatedEntity||e.props.entity,null,Ke.openNotesButtonKey))}}))),o.createElement("div",{style:{width:"auto"}},o.createElement(g.TooltipHost,{content:Je.getLocalizedString("ICV_View_Tasks"),calloutProps:dn,directionalHint:g.DirectionalHint.bottomCenter},o.createElement(d.IconButton,{id:Ke.openTasksButtonKey,iconProps:Ue.taskList,className:"icv-header-iconStyle "+cn,ariaLabel:Je.getLocalizedString("ICV_Tasks"),onClick:function(){var t,n;Je.reportUserAction("getIconBar","Header","Open tasks clicked",{count:(null==(t=e.props.tasks)||null==(n=t.taskList)?void 0:n.length)||0},Ye.CLICK,"Tasks icon clicked"),e.props.viewEventHandlers&&(null==e.props.viewEventHandlers.onOpenView||e.props.viewEventHandlers.onOpenView({entityId:"",entityType:me.Task},ve.List,e.props.relatedEntity||e.props.entity,e.props.tasks,Ke.openTasksButtonKey))}}))))},n.enableCollaborationFeature=function(){if(!this.isCollaborationFeatureEnabled()){var e=un.match("([?&]flags=([^&]+).*)[&]?$"),t=un;e&&(t=un.replace(e[0],"")),window.location.assign(t+"&flags=FCB.EmbeddedCollaboration%3Dtrue"),this.setState({isCollaborationEnabled:!0})}},n.isCollaborationFeatureEnabled=function(){return void 0!==window.Xrm&&Boolean(Xrm.Internal.isFeatureEnabled("EmbeddedCollaboration"))},t}(o.Component),mn=function(){function e(){}return e.initialize=function(t){t.columns.sort((function(e,t){return e.order-t.order})),e.grid=t},e.loadMoreRows=function(){e.grid.paging.hasNextPage&&e.grid.paging.loadNextPage(),e.loadMoreRowsClicked=!0},e.sortColumn=function(t){var n;(n=e.grid.sorting).splice.apply(n,[0,e.grid.sorting.length].concat(t)),qe.set("sortInfo",t),e.grid.refresh()},e.onRowSelectionChanged=function(t){e.grid.setSelectedRecordIds(t)},e.reload=function(){e.grid&&e.grid.refresh()},e}();mn.loadMoreRowsClicked=!1;var hn,gn=function(e){function t(t){var n,i;return(i=e.call(this,t)||this).state={activities:{recordId:i.props.entity.entityId,activityList:[]},tasks:{recordId:i.props.entity.entityId,recordType:i.props.entity.entityType,taskList:[]},notes:{recordDetails:i.props.entity,noteList:[]},recentOpportunities:[]},null==(n=i.props.viewEventHandlers)||null==n.registerCommands||n.registerCommands(i.getNavCommands()),i.props.inContextViewEventHandlers&&i.props.inContextViewEventHandlers.refreshRecordHandler&&i.props.inContextViewEventHandlers.refreshRecordHandler(i.refreshRecord.bind(Oe(i))),i.fetchInitialData(),i}Me(t,e);var n=t.prototype;return n.componentDidMount=function(){},n.render=function(){return this.state.formXml&&(this.state.entityRecord&&this.state.entityMetadata?this.state.datasetrecord||this.createDatasetRecord(this.state.entityMetadata,this.state.attributesMetadata,this.state.entityRecord):(this.state.entityMetadata||this.fetchEntityMetadata(),this.state.entityRecord||this.fetchEntity())),this.getView()},n.getView=function(){var e;Je.reportInfo("render","COLAEntityView","Entity data is fetched",{});var t=Pe({},this.props,{formXml:this.state.formXml||{},datasetRecord:this.state.datasetrecord,activities:this.state.activities,onActivityAdded:this.onActivityAdded.bind(this),onTaskAdded:this.onTaskAdded.bind(this),tasks:this.state.tasks,notes:this.state.notes,recentOpportunities:this.state.recentOpportunities}),n=Pe({},this.props,{tabs:(null==(e=this.state.formXml)?void 0:e.tabs)||[],entityMetadata:this.state.entityMetadata,attributesMetadata:this.state.attributesMetadata,datasetRecord:this.state.datasetrecord,activities:this.state.activities,tasks:this.state.tasks,onTaskAdded:this.onTaskAdded.bind(this),onActivityAdded:this.onActivityAdded.bind(this),notes:this.state.notes,recentOpportunities:this.state.recentOpportunities,viewEventHandlers:Pe({},this.props.viewEventHandlers,{updateRecord:this.updateRecord.bind(this)})});return Je.scenarioEnd(We.openInContextView),a.createElement("div",{className:"icv-view-content-container"},a.createElement(pn,Object.assign({},t)),a.createElement(Kt,Object.assign({},n)))},n.fetchInitialData=function(){this.loadFormXml(),this.loadActivities(),this.loadTasks(),this.loadNotes(),this.props.entity.entityType==me.Account&&this.loadRecentOpportunities()},n.loadFormXml=function(){var e=this,t=this.props.overrideSystemForms&&this.props.overrideSystemForms[this.props.entity.entityType]||Be.getSystemFormIdByEntityType(this.props.entity.entityType);this.props.services.dataService.fetchSystemForm(this.props.entity.entityType,t).then((function(n){Je.reportInfo("fetchInitialData-fetchSystemForm","COLAEntityView",$e.SUCCESS,{entityType:e.props.entity.entityType,formId:t}),e.setState({formXml:n})})).catch((function(n){var i;Je.reportError("fetchInitialData-fetchSystemForm","COLAEntityView",$e.FAILED,{error:n,entityType:e.props.entity.entityType,formId:t}),null==(i=e.props.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("ICV_Error_Message"))}))},n.updateViewTitle=function(){var e;this.state.entityMetadata&&(null==(e=this.props.viewEventHandlers)||null==e.setViewTitle||e.setViewTitle(this.state.entityMetadata.displayName))},n.loadNotes=function(){var e=this;this.props.services.dataService.fetchNotes(this.props.entity).then((function(t){Je.reportInfo("fetchInitialData-fetchNotes","COLAEntityView",$e.SUCCESS,{entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),t&&e.setState({notes:t})})).catch((function(t){var n;Je.reportError("fetchInitialData-fetchNotes","COLAEntityView",$e.FAILED,{error:t,entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),null==(n=e.props.viewEventHandlers)||null==n.openErrorView||n.openErrorView(Je.getLocalizedString("ICV_Error_Message"))}))},n.loadRecentOpportunities=function(){var e=this;this.props.services.dataService.fetchRecentOpportunities(this.props.entity.entityId).then((function(t){Je.reportInfo("fetchInitialData-fetchRecentOpportunities","COLAEntityView",$e.SUCCESS,{entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),t&&e.setState({recentOpportunities:t})})).catch((function(t){var n;Je.reportError("fetchInitialData-fetchRecentOpportunities","COLAEntityView",$e.FAILED,{error:t,entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),null==(n=e.props.viewEventHandlers)||null==n.openErrorView||n.openErrorView(Je.getLocalizedString("ICV_Error_Message"))}))},n.loadTasks=function(){var e=this;this.props.services.dataService.fetchTasks(this.props.entity.entityId,this.props.entity.entityType).then((function(t){Je.reportInfo("fetchInitialData-fetchTasks","COLAEntityView",$e.SUCCESS,{entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),t&&e.setState({tasks:t})})).catch((function(t){var n;Je.reportError("fetchInitialData-fetchTasks","COLAEntityView",$e.FAILED,{error:t,entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),null==(n=e.props.viewEventHandlers)||null==n.openErrorView||n.openErrorView(Je.getLocalizedString("ICV_Error_Message"))}))},n.loadActivities=function(){var e=this;this.props.services.dataService.fetchActivities(this.props.entity.entityId).then((function(t){Je.reportInfo("fetchInitialData-fetchActivities","COLAEntityView",$e.SUCCESS,{entityId:e.props.entity.entityId,entityType:e.props.entity.entityType,activitiesCount:t.activityList.length,upcomingAppointmentsCount:t.activityList.filter((function(e){return e.activitytypecode===be.Appointment&&e.isUpcoming})).length}),t&&e.setState({activities:t})})).catch((function(t){var n;Je.reportError("fetchInitialData-fetchActivities","COLAEntityView",$e.FAILED,{error:t,entityId:e.props.entity.entityId,entityType:e.props.entity.entityType}),null==(n=e.props.viewEventHandlers)||null==n.openErrorView||n.openErrorView(Je.getLocalizedString("ICV_Error_Message"))}))},n.fetchEntity=function(){var e,t,n=this;null==(e=this.props.services.dataService.fetchEntityRecord(this.props.entity.entityType,this.props.entity.entityId,(null==(t=this.state.formXml)?void 0:t.dataFields)||[]))||e.then((function(e){var t;Je.reportInfo("fetchRecordSidePanelData-fetchEntityRecord","COLAEntityView",$e.SUCCESS,{entityId:n.props.entity.entityId,entityType:n.props.entity.entityType,dataFields:(null==(t=n.state.formXml)?void 0:t.dataFields)||[]}),e&&n.setState({entityRecord:e})})).catch((function(e){var t,i;Je.reportError("fetchRecordSidePanelData-fetchEntityRecord","COLAEntityView",$e.FAILED,{error:e,entityId:n.props.entity.entityId,entityType:n.props.entity.entityType,dataFields:(null==(t=n.state.formXml)?void 0:t.dataFields)||[]}),null==(i=n.props.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("ICV_Error_Message"))}))},n.fetchEntityMetadata=function(){var e,t=this;this.state.attributesMetadata||this.props.services.dataService.fetchEntityMetadata(this.props.entity.entityType,(null==(e=this.state.formXml)?void 0:e.dataFields)||[]).then((function(e){var n;if(Je.reportInfo("fetchRecordSidePanelData-fetchEntityMetadata","COLAEntityView",$e.SUCCESS,{entityId:t.props.entity.entityId,entityType:t.props.entity.entityType,dataFields:(null==(n=t.state.formXml)?void 0:n.dataFields)||[]}),e){var i,r=e[0],o=e[1];null==(i=t.state.formXml)||i.dataFields.forEach((function(e,n){var i;if(!0===(null==(i=t.state.formXml)?void 0:i.dataFieldsIsReadOnly[n])){var r=o.get(e);if(r){var a=Pe({},r,{validForUpdate:!1});o.set(e,a)}}})),t.setState({entityMetadata:r,attributesMetadata:o},t.updateViewTitle)}})).catch((function(e){var n,i;Je.reportError("fetchRecordSidePanelData-fetchEntityMetadata","COLAEntityView",$e.FAILED,{error:e,entityId:t.props.entity.entityId,entityType:t.props.entity.entityType,dataFields:(null==(n=t.state.formXml)?void 0:n.dataFields)||[]}),null==(i=t.props.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("ICV_Error_Message"))}))},n.createDatasetRecord=function(e,t,n){var i=this.props.services.dataService.createDataSetRecord(e,t,n,this.buildRecordUpdateHandler.bind(this));this.setState({datasetrecord:i})},n.onTaskAdded=function(e){if(e){var t=Pe({},this.state.tasks);t.taskList.unshift(e),this.setState({tasks:t})}else this.loadTasks()},n.onActivityAdded=function(e){if(e){var t=Pe({},this.state.activities);t.activityList=[e].concat(t.activityList),this.setState({activities:t})}else this.loadActivities()},n.updateRecord=function(e){this.setState({datasetrecord:e})},n.refreshRecord=function(e){var t,n=this;this.state&&this.state.entityRecord&&(e==this.state.entityRecord.recordId||v.StringUtil.IsNullOrEmpty(e))&&this.state.entityMetadata&&this.props.services.dataService.fetchEntityRecord(this.props.entity.entityType,this.props.entity.entityId,(null==(t=this.state.formXml)?void 0:t.dataFields)||[]).then((function(e){if(Je.reportInfo("refreshRecord-fetchEntityRecord","COLAEntityView",$e.SUCCESS,{entityId:n.props.entity.entityId,entityType:n.props.entity.entityType}),e){var t=n.props.services.dataService.createDataSetRecord(n.state.entityMetadata,n.state.attributesMetadata,e,n.buildRecordUpdateHandler.bind(n));n.setState({entityRecord:e,datasetrecord:t})}})).catch((function(e){var t;Je.reportError("refreshRecord-fetchEntityRecord","COLAEntityView",$e.FAILED,{error:e,entityId:n.props.entity.entityId,entityType:n.props.entity.entityType}),null==(t=n.props.viewEventHandlers)||null==t.openErrorView||t.openErrorView(Je.getLocalizedString("ICV_Error_Message"))}))},n.buildRecordUpdateHandler=function(e){if(e&&e.dataSetRecord){var t=e.dataSetRecord;0!==e.updateType&&this.setState({datasetrecord:t}),3!=e.updateType&&6!=e.updateType||this.props.inContextViewEventHandlers&&this.props.inContextViewEventHandlers.onRecordUpdate&&this.props.inContextViewEventHandlers.onRecordUpdate(t)}},n.getNavCommands=function(){return[this.getGoToRecordCommand()]},n.getGoToRecordCommand=function(){var e=this;return{toolTipContent:Je.getLocalizedString("ICV_GoToRecord"),iconProps:Ue.goToIcon,ariaLabel:Je.getLocalizedString("ICV_GoToRecord"),commandAction:function(){Je.openEntityInMFD(e.props.entity.entityType.toString().toLowerCase(),e.props.entity.entityId,(function(){mn.reload(),e.refreshRecord(e.props.entity.entityId)}))}}},t}(a.Component),fn={1025:"ar",1026:"bg",1027:"ca",1028:"zh",1029:"cs",1030:"da",1031:"de",1032:"el",1033:"en",1035:"fi",1036:"fr",1037:"he",1038:"hu",1040:"it",1041:"ja",1042:"ko",1043:"nl",1044:"nb",1045:"pl",1046:"pt-br",1048:"ro",1049:"ru",1050:"hr",1051:"sk",1053:"sv",1054:"th",1055:"tr",1057:"id",1058:"uk",1060:"sl",1061:"et",1062:"lv",1063:"lt",1066:"vi",1069:"eu",1081:"hi",1086:"ms",1087:"kk",1110:"gl",2052:"zh-cn",2070:"pt",2074:"sr-latn",3076:"zh",3082:"es",3098:"sr"},yn=function(e){function t(t){return e.call(this,t)||this}Me(t,e);var n=t.prototype;return n.render=function(){return this.props.readOnly?this.props.numberOfLinesToDisplay&&this.props.numberOfLinesToDisplay>0?this.getPTReadOnlyView():this.getRTEReadOnlyView():this.displayCKEditorView()},n.getPTReadOnlyView=function(){var e,t=document.createElement("div");return t.innerHTML=this.props.data||"",a.createElement("span",{className:"rte-plaintext-label",style:{"-webkit-line-clamp":null==(e=this.props.numberOfLinesToDisplay)?void 0:e.toString()}},t.innerText||t.textContent||"")},n.getRTEReadOnlyView=function(){return a.createElement("div",{style:this.props.style,dangerouslySetInnerHTML:{__html:this.props.data||""}})},n.displayCKEditorView=function(){var e,t=this,n=t.props.languageId,i=""+this.props.richTextEnabled,r=this.props.data?""+this.props.data:"";return a.createElement("div",{className:"document-editor"},a.createElement("div",{className:(e={richTextIsEnabled:this.props.richTextEnabled},u.mergeStyles({border:"1px solid grey",".ck,.ck__editor":{display:"flex",flexDirection:"column-reverse",".ck-toolbar":{backgroundColor:"transparent",border:"none",display:e.richTextIsEnabled?"initial":"none",".ck-toolbar__items":{fontSize:"8px"}},".ck-editor__editable":{height:"200px",border:"none",flexDirection:"column","&:focus":{boxShadow:"none",border:"none",outline:"none"},ul:{paddingLeft:"22px"},ol:{paddingLeft:"22px"}}}}))},a.createElement(S.CKEditor,{onReady:function(e){e.data.set(r)},editor:E,id:i,config:{toolbar:["bold","italic","underline","|","numberedList","bulletedList","|","link"],placeholder:Je.getLocalizedString("Notes_Add_a_Note"),language:fn[n||1033],title:Je.getLocalizedString("Richtext_Voice_Label",Je.getLocalizedString("Notes_Description"))},onChange:function(e,n){null==t.props.eventHandlers.onChange||t.props.eventHandlers.onChange(e,n)},onBlur:function(e,n){""==n.getData()&&(n.config.bodyClass="cke-placeholder"),null==t.props.eventHandlers.onBlur||t.props.eventHandlers.onBlur(e)},onFocus:function(e,n){t.props.data||(n.config.bodyClass="",n.setData(""))}})))},t}(a.Component),vn=u.mergeStyles({display:"flex",height:32,flexDirection:"row"}),Cn=u.mergeStyles({margin:"auto",minWidth:"20px"}),Sn=u.mergeStyles({margin:"auto",flexGrow:1,paddingLeft:8,paddingRight:8,color:p.NeutralColors.gray160,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}),En=u.mergeStyles({color:p.NeutralColors.gray130,fontSize:16,fontWeight:400}),bn=u.mergeStyles({display:"none"}),wn=function(e){var t=e.note,n=e.isEditMode,i=e.fileName,r=e.pendingAttachmentChanges,o=e.uploadInProgress,s=e.handleUpload,l=e.clearAttachment,c=function(){return a.createElement("div",null,a.createElement("div",{className:vn},(c=n?i:null==t?void 0:t.filename,a.createElement(C.Icon,Object.assign({className:Cn},b.getFileTypeIconProps({extension:null==c?void 0:c.substr((null==c?void 0:c.lastIndexOf("."))+1),size:20,imageFileType:"png"})))),a.createElement(D.Text,{className:Sn},null==(s=n?i:null==t?void 0:t.filename)?void 0:s.split(".").slice(0,-1).join(".")),n&&(r||null!=t&&t.isdocument&&!r)?o?a.createElement(w.Spinner,{size:w.SpinnerSize.medium}):a.createElement(d.IconButton,{iconProps:{iconName:"ChromeClose"},ariaLabel:Je.getLocalizedString("Notes_Remove_Attachment_Button"),className:En,onClick:l}):a.createElement(d.IconButton,{iconProps:{iconName:"Download"},className:En,ariaLabel:Je.getLocalizedString("Notes_Download_Attachment_Button"),onClick:function(n){t&&e.services.dataService.getNoteAttachment(t.annotationid).then((function(e){var n,i=document.createElement("a");document.body.appendChild(i),i.href="data:"+t.mimetype+";base64,"+e,i.download=null!=(n=t.filename)?n:"",i.click()})).catch((function(e){Je.reportError("onDownloadButtonClick","AttachmentView",$e.FAILED,{error:e,noteId:t.annotationid})})),n.stopPropagation(),Je.reportUserAction("onDownloadButtonClick","AttachmentView","Download button clicked",{noteId:null==t?void 0:t.annotationid,isCreate:!t},Ye.CLICK,"Download button")}})));var s,c};return n?e.pendingAttachment||null!=t&&t.isdocument&&!r?c():a.createElement("div",null,a.createElement("input",{type:"file",id:"fileUpload",className:bn,onChange:function(e){e.target.files&&e.target.files[0]&&s&&s(e.target.files[0])}}),a.createElement(d.ActionButton,{id:"openFileUpload",iconProps:{iconName:"Attach"},allowDisabledFocus:!0,onClick:function(){var e;null==(e=document.getElementById("fileUpload"))||e.click(),Je.reportUserAction("onAttachFileClick","AttachmentView","Attach file",{noteId:null==t?void 0:t.annotationid,isCreate:!t},Ye.CLICK,"Attach file button")}},Je.getLocalizedString("Notes_AttachFile"))):null!=t&&t.isdocument?c():null},Dn=function(e){function t(t){return e.call(this,t)||this}return Me(t,e),t.prototype.render=function(){return Je.reportInfo("render","LoadingControl",this.props.loadingMessage,{}),a.createElement(w.Spinner,{label:this.props.loadingMessage,styles:this.props.removeStyles?void 0:{root:{justifyContent:"unset",marginTop:"30%",height:"100%"}},style:this.props.style,size:this.props.spinnerSize,labelPosition:"bottom"})},t}(a.Component),Tn=u.mergeStyles({padding:"14px 0",display:"flex",flexDirection:"column",overflow:"auto"}),xn=u.mergeStyles({padding:"14px 20px",display:"flex",flexDirection:"column",overflow:"auto"}),kn=function(e){function t(t){var n,i,r;return null==(n=(r=e.call(this,t)||this).props.viewEventHandlers)||null==n.setViewTitle||n.setViewTitle(Je.getLocalizedString("Notes_NotesViewTitle")),null==(i=r.props.viewEventHandlers)||null==i.registerCommands||i.registerCommands(r.getNavCommands()),r.state={note:r.props.note||{},isNoteFetched:!!r.props.note,showDeleteDialog:!1,deletionInProgress:!1},r.props.note||r.props.services.dataService.fetchNote(r.props.entity.entityId).then((function(e){Je.reportInfo("constructor","NoteView",$e.SUCCESS,{noteId:r.props.entity.entityId,entityId:(r.props.relatedEntity||r.props.primaryEntity).entityId,entityType:(r.props.relatedEntity||r.props.primaryEntity).entityId}),r.setState({note:e,isNoteFetched:!0})})).catch((function(e){var t;Je.reportError("constructor","NoteView",$e.FAILED,{noteId:r.props.entity.entityId,entityId:(r.props.relatedEntity||r.props.primaryEntity).entityId,entityType:(r.props.relatedEntity||r.props.primaryEntity).entityId,error:e}),null==(t=r.props.viewEventHandlers)||null==t.openErrorView||t.openErrorView(Je.getLocalizedString("Note_Error_Message"))})),r}Me(t,e);var n=t.prototype;return n.render=function(){var e;return this.state.deletionInProgress||!this.state.isNoteFetched?a.createElement(Dn,{spinnerSize:2,loadingMessage:Je.getLocalizedString(this.state.deletionInProgress?"InContextView_Deleting":"InContextView_Loading")}):(Je.reportInfo("render","NoteView","",{noteId:this.state.note.annotationid}),a.createElement("div",{className:"icv-view-content-container"},a.createElement("div",{className:"notecard-container "+xn},this.state.showDeleteDialog&&this.getDeleteDialog(),a.createElement("div",{className:"notecard-header"},a.createElement("div",{className:"notecard-title",title:this.state.note.subject},this.state.note.subject),a.createElement("label",{className:"notecard-timecontrol"},Je.getFormattedDateString(this.state.note.modifiedon,this.props.context))),a.createElement(yn,{languageId:this.props.context.userSettings.languageId,style:{border:"none",marginBottom:"4px"},data:this.state.note.notetext,readOnly:!0,eventHandlers:{}}),a.createElement("div",{className:"notecard-owner-container"},a.createElement(C.Icon,{iconName:Ue.contact.iconName,className:"notecard-owner-avatar"}),a.createElement("label",{className:"notecard-owner-label"},this.state.note["_modifiedby_value@OData.Community.Display.V1.FormattedValue"])),this.state.note.isdocument&&a.createElement(wn,Object.assign({},this.props,{isEditMode:!1,fileName:null!=(e=this.state.note.filename)?e:"",note:this.state.note})))))},n.getNavCommands=function(){var e=[];return e.push(this.getEditNoteCommand()),e.push(this.getDeleteNoteCommand()),e},n.getEditNoteCommand=function(){return{toolTipContent:Je.getLocalizedString("Notes_NotesEditTitle"),iconProps:Ue.notesEdit,ariaLabel:Je.getLocalizedString("Notes_NotesEditTitle"),commandAction:this.openEditNote.bind(this)}},n.getDeleteNoteCommand=function(){return{toolTipContent:Je.getLocalizedString("Notes_NoteDeleteTitle"),iconProps:Ue.deleteNotes,ariaLabel:Je.getLocalizedString("Notes_NoteDeleteTitle"),commandAction:this.deleteNote.bind(this)}},n.openEditNote=function(){var e;null==(e=this.props.viewEventHandlers)||null==e.onOpenView||e.onOpenView(this.props.entity,ve.Edit,this.props.relatedEntity||this.props.entity,this.state.note)},n.deleteNote=function(){this.setState({showDeleteDialog:!0})},n.getDeleteDialog=function(){var e={type:T.DialogType.close,title:Je.getLocalizedString("Tasks_Delete_Task"),closeButtonAriaLabel:Je.getLocalizedString("InContextView_Cancel"),subText:Je.getLocalizedString("Notes_Delete_Dialog_Confirmation")};return Je.reportInfo("getDeleteDialog","NoteView","",{title:e.title}),a.createElement(x,{hidden:!1,onDismiss:this.onDialogDismiss.bind(this),dialogContentProps:e},a.createElement(T.DialogFooter,null,a.createElement(d.PrimaryButton,{onClick:this.onDeleteConfirm.bind(this),text:Je.getLocalizedString("InContextView_Delete")}),a.createElement(d.DefaultButton,{onClick:this.onDialogDismiss.bind(this),text:Je.getLocalizedString("InContextView_Cancel")})))},n.onDialogDismiss=function(){Je.reportUserAction("onDialogDismiss","NoteView","Confirm note delete dismissed",{noteId:this.state.note.annotationid},Ye.CLICK,"Delete note cancel"),this.setState({showDeleteDialog:!1})},n.onDeleteConfirm=function(){var e=this;Je.reportUserAction("onDeleteConfirm","NoteView","Conform note delete clicked",{noteId:this.state.note.annotationid},Ye.CLICK,"Delete note confirm");var t=this;this.props.services.dataService.deleteNote(this.state.note.annotationid).then((function(n){var i,r;n&&n.id&&n.id===t.state.note.annotationid?(Je.reportInfo("onDeleteConfirm","NoteView",$e.SUCCESS,{noteId:e.state.note.annotationid}),null==(i=e.props.viewEventHandlers)||null==i.navigateBack||i.navigateBack()):(Je.reportError("onDeleteConfirm","NoteView",$e.FAILED,{error:"Empty response returned",noteId:e.state.note.annotationid}),null==(r=e.props.viewEventHandlers)||null==r.setErrorMessage||r.setErrorMessage(Je.getLocalizedString("Notes_ErrorMessage_Delete_Note"))),e.setState({deletionInProgress:!1})})).catch((function(t){var n;Je.reportError("onDeleteConfirm","NoteView",$e.FAILED,{error:t,noteId:e.state.note.annotationid}),null==(n=e.props.viewEventHandlers)||null==n.setErrorMessage||n.setErrorMessage(Je.getLocalizedString("Notes_ErrorMessage_Delete_Note"))})),this.setState({deletionInProgress:!0,showDeleteDialog:!1})},t}(a.Component),_n=["B","KB","MB","GB"];!function(e){e.EditNoteView="EditNoteView",e.AttachmentView="AttachmentView"}(hn||(hn={}));var Nn=function(e){function t(t){var n,i,r,o,a,s,l,c,d;return(d=e.call(this,t)||this).MAX_EDITOR_LENGTH=2e3,null==(n=d.props.viewEventHandlers)||null==n.setViewTitle||n.setViewTitle(Je.getLocalizedString("Notes_NotesEditTitle")),d.state={title:(null==(i=d.props.note)?void 0:i.subject)||"",noteText:(null==(r=d.props.note)?void 0:r.notetext)||"",documentBody:null==(o=d.props.note)?void 0:o.documentbody,fileName:null!=(a=null==(s=d.props.note)?void 0:s.filename)?a:"",pendingAttachmentChanges:!1,pendingAttachment:!1,disableSaveButton:v.StringUtil.IsNullOrEmpty(null==(l=d.props.note)?void 0:l.subject),uploadInProgress:!1,isFileSizeValid:!0,richTextEnabled:!0,richTextStatusLoading:!0},d.showPlaceholder=!(null!=(c=d.props.note)&&c.notetext),d}Me(t,e);var n=t.prototype;return n.componentDidMount=function(){try{this.getRichTextEnabledStatus()}catch(e){console.log("Error getting the current rich text status. ",e.message)}},n.getRichTextEnabledStatus=function(){var e=Fe(He.mark((function e(){var t;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.richTextEnabled,e.prev=1,e.next=4,this.props.services.dataService.getRichTextStatus();case 4:t=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log("Error getting the current rich text status",e.t0.message);case 10:return e.prev=10,this.setState({richTextEnabled:t,richTextStatusLoading:!1}),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,7,10,13]])})));return function(){return e.apply(this,arguments)}}(),n.render=function(){var e,t;return Je.reportInfo("render",hn.AttachmentView,"",{noteId:null==(e=this.props.note)?void 0:e.annotationid,isCreate:!this.props.note}),this.state.richTextStatusLoading?a.createElement(a.Fragment,null):this.state.saveInProgress?a.createElement(Dn,{spinnerSize:2,loadingMessage:Je.getLocalizedString("InContextView_Saving")}):a.createElement("div",{className:"icv-view-content-container"},a.createElement("div",{className:"note-editview-container"},this.getTitleField(),a.createElement(L.Label,null,Je.getLocalizedString("Notes_Description")),this.getCKEditor(),a.createElement(wn,Object.assign({},this.props,{note:this.props.note||{},isEditMode:!0,handleUpload:this.handleUpload.bind(this),clearAttachment:this.clearAttachment.bind(this),pendingAttachmentChanges:this.state.pendingAttachmentChanges,pendingAttachment:this.state.pendingAttachment,fileName:null!=(t=this.state.fileName)?t:"",uploadInProgress:this.state.uploadInProgress})),this.getButtons()))},n.clearAttachment=function(){this.setState({fileName:"",documentBody:void 0,pendingAttachmentChanges:!0,pendingAttachment:!1,uploadInProgress:!1})},n.validateFileSize=function(e){var t,n=this;null==(t=this.props.services.dataService)||t.getOrgUploadConstraints().then((function(t){var i,r,o=e.size>t;if(o||e.size<1){var a,s;n.clearAttachment();var l=o?Je.getLocalizedString("Notes_ErrorMessage_Upload_Attachment_Too_Large",(i=t,r=_n.findIndex((function(e){return"MB"==e})),(i/Math.pow(1024,r)).toLocaleString(void 0)+" MB")):Je.getLocalizedString("Notes_ErrorMessage_Upload_Attachment_Too_Small");null==(a=n.props.viewEventHandlers)||null==a.setErrorMessage||a.setErrorMessage(l),Je.reportError("onAttachFileClick",hn.AttachmentView,$e.FAILED,{error:l,noteId:null==(s=n.props.note)?void 0:s.annotationid,isCreate:!n.props.note,fileSize:e.size}),n.setState({isFileSizeValid:!1})}else n.setState({isFileSizeValid:!0})})).catch((function(e){Je.reportError("onAttachFileClick",hn.AttachmentView,$e.FAILED,{error:e})}))},n.handleUpload=function(e,t){var n=this;this.validateFileSize(e),this.state.isFileSizeValid&&(this.setState({fileName:e.name,pendingAttachmentChanges:!0,pendingAttachment:!0,uploadInProgress:!0}),function(e,t){return new Promise((function(n,i){var r=new FileReader;r.onerror=i,r.onabort=i,t&&(r.onprogress=t),r.onload=function(){n(r.result.split(";base64,")[1])},r.readAsDataURL(e)}))}(e,t).then((function(t){n.setState({documentBody:t,uploadInProgress:!1}),Je.reportInfo("onAttachFileClick",hn.AttachmentView,$e.SUCCESS,{fileSize:e.size})})).catch((function(t){n.setState({uploadInProgress:!1}),Je.reportError("onAttachFileClick",hn.AttachmentView,$e.FAILED,{error:t,fileSize:e.size})})))},n.getTitleField=function(){var e=this;return a.createElement(k.TextField,{label:Je.getLocalizedString("Notes_Title"),required:!0,"aria-label":Je.getLocalizedString("Notes_Title"),id:"subjectNotes",placeholder:Je.getLocalizedString("Notes_Subject"),defaultValue:this.state.title,styles:{root:{paddingBottom:p.FontSizes.size10}},onChange:function(t){e.setState({title:t.target.value,disableSaveButton:v.StringUtil.IsNullOrEmpty(t.target.value)})}})},n.getCKEditor=function(){return a.createElement("div",null,a.createElement(yn,{languageId:this.props.context.userSettings.languageId,placeholder:this.showPlaceholder?Je.getLocalizedString("Notes_Add_a_Note"):"",data:this.state.noteText,style:{marginBottom:p.FontSizes.size10,border:v.StringUtil.IsNullOrEmpty(this.state.errorMessage)?"1px solid #605E5C":"1px solid #A80000",borderRadius:dt.size2px,background:ct.white},eventHandlers:{onChange:this.onChangeEvent.bind(this)},richTextEnabled:this.state.richTextEnabled}),!v.StringUtil.IsNullOrEmpty(this.state.errorMessage)&&this.getErrorLabel())},n.onChangeEvent=function(e,t){this.showPlaceholder=!1;var n=t.getData().length;this.setState({noteText:t.getData(),errorMessage:n>this.MAX_EDITOR_LENGTH?Je.getLocalizedString("Notes_ErrorMessage_Character_Limit"):void 0,disableSaveButton:!!(v.StringUtil.IsNullOrEmpty(this.state.title)||n>this.MAX_EDITOR_LENGTH)})},n.getButtons=function(){return a.createElement("div",{className:"note-editview-footer"},a.createElement(_.PrimaryButton,{text:Je.getLocalizedString("Notes_Post_Note"),styles:{root:{marginLeft:dt.size4px}},onClick:this.onSaveClick.bind(this),disabled:this.state.disableSaveButton}),a.createElement(N.DefaultButton,{text:Je.getLocalizedString("InContextView_Cancel"),styles:{root:{marginLeft:dt.size4px}},onClick:this.onCancelClick.bind(this)}))},n.onSaveClick=function(){var e,t=this;Je.reportUserAction("onSaveClick",hn.EditNoteView,"Save note clicked",{noteId:null==(e=this.props.note)?void 0:e.annotationid,isCreate:!this.props.note},Ye.CLICK,"Save note button");var n,i,r=this,o=this.updatedNote();o?(this.props.services.dataService.upsertNote(this.props.entity.entityId,o).then((function(e){var n,i,o,a;e&&e.entityType&&"annotation"===e.entityType.toLowerCase()?(Je.reportInfo("onSaveClick",hn.EditNoteView,$e.SUCCESS,{noteId:null==(n=t.props.note)?void 0:n.annotationid,isCreate:!t.props.note}),null==(i=r.props.viewEventHandlers)||null==i.navigateBack||i.navigateBack()):(Je.reportError("onSaveClick",hn.EditNoteView,$e.FAILED,{error:"Empty response returned",noteId:null==(o=t.props.note)?void 0:o.annotationid,isCreate:!t.props.note}),null==(a=t.props.viewEventHandlers)||null==a.setErrorMessage||a.setErrorMessage(Je.getLocalizedString("Notes_ErrorMessage_Update_Note"))),r.setState({saveInProgress:!1})})).catch((function(e){var n,i;Je.reportError("onSaveClick",hn.EditNoteView,$e.FAILED,{error:e,noteId:null==(n=t.props.note)?void 0:n.annotationid,isCreate:!t.props.note}),null==(i=t.props.viewEventHandlers)||null==i.setErrorMessage||i.setErrorMessage(Je.getLocalizedString("Notes_ErrorMessage_Update_Note")),r.setState({saveInProgress:!1})})),this.setState({saveInProgress:!0})):(Je.reportWarning("onSaveClick",hn.EditNoteView,$e.SUCCESS,{message:"Same record",noteId:null==(n=this.props.note)?void 0:n.annotationid,isCreate:!this.props.note}),null==(i=this.props.viewEventHandlers)||null==i.navigateBack||i.navigateBack())},n.updatedNote=function(){var e,t,n,i,r,o,a,s={};return this.state.title!==(null==(e=this.props.note)?void 0:e.subject)&&(s.subject=this.state.title),this.state.noteText!==(null==(t=this.props.note)?void 0:t.notetext)&&(s.notetext=this.state.noteText),this.state.pendingAttachmentChanges&&this.state.pendingAttachment!==(null==(n=this.props.note)?void 0:n.isdocument)&&(s.isdocument=this.state.pendingAttachment),this.state.documentBody!==(null==(i=this.props.note)?void 0:i.documentbody)&&(s.documentbody=this.state.documentBody),this.state.fileName!==(null==(r=this.props.note)?void 0:r.filename)&&(s.filename=this.state.fileName),null!=(o=this.props.note)&&o._objectid_value||(s[this.getKeyForRelatedEntity(null==(a=this.props.relatedEntity)?void 0:a.entityType)]=this.props.relatedEntity?"/"+Je.getPluralNameOfEntity(this.props.relatedEntity.entityType)+"("+this.props.relatedEntity.entityId+")":null),Object.keys(s).length>0?s:null},n.getKeyForRelatedEntity=function(e){switch(e){case me.Opportunity:return"objectid_opportunity@odata.bind";case me.Contact:return"objectid_contact@odata.bind";case me.Account:return"objectid_account@odata.bind";case me.Lead:return"objectid_lead@odata.bind";default:return""}},n.onCancelClick=function(){var e,t;Je.reportUserAction("onCancelClick",hn.EditNoteView,"Save note cancelled",{noteId:null==(e=this.props.note)?void 0:e.annotationid,isCreate:!this.props.note},Ye.CLICK,"Save note cancel button"),null==(t=this.props.viewEventHandlers)||null==t.navigateBack||t.navigateBack()},n.getErrorLabel=function(){return a.createElement("label",{className:"notes-editnote-rte-error"},this.state.errorMessage)},t}(a.Component),Ln=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={showDialog:!1,actionInProgress:!1},n}Me(t,e);var n=t.prototype;return n.render=function(){var e,t=this;Je.reportInfo("render","NoteCard","",{noteId:this.props.note.annotationid});var n={root:{maxWidth:"100%",border:"0px",padding:"0 20px",selectors:{":hover::after":{border:"0px"},":hover":{backgroundColor:ct.grey}}}};return this.state.actionInProgress?a.createElement(I.DocumentCard,{styles:n,className:"notecard-spinner-container"},a.createElement(Dn,{removeStyles:!0,spinnerSize:2,loadingMessage:Je.getLocalizedString("InContextView_Deleting")})):a.createElement(I.DocumentCard,{styles:n,style:this.props.style,className:"notecard-document-container",onClick:function(){var e;Je.reportUserAction("onNoteCardClick","NoteCard","View note clicked",{noteId:t.props.note.annotationid,hasAttachment:t.props.note.isdocument},Ye.CLICK,"View note card"),null==(e=t.props.viewEventHandlers)||null==e.onOpenView||e.onOpenView({entityId:t.props.note.annotationid,entityType:me.Note},ve.Default,t.props.relatedEntity||t.props.entity)}},a.createElement("div",{className:"notecard-container "+Tn},a.createElement("div",{className:"notecard-header"},a.createElement("div",{className:"notecard-title",title:this.props.note.subject},this.props.note.subject),a.createElement("label",{className:"notecard-timecontrol"},Je.getFormattedDateString(this.props.note.modifiedon,this.props.context)),this.getHeaderIconsDiv()),a.createElement(yn,{languageId:this.props.context.userSettings.languageId,data:this.props.note.notetext,readOnly:!0,numberOfLinesToDisplay:5,eventHandlers:{}}),a.createElement("div",{className:"notecard-owner-container"},a.createElement(C.Icon,{iconName:Ue.contact.iconName,className:"notecard-owner-avatar"}),a.createElement("label",{className:"notecard-owner-label"},this.props.note["_modifiedby_value@OData.Community.Display.V1.FormattedValue"])),this.props.note&&a.createElement(wn,Object.assign({},this.props,{isEditMode:!1,fileName:null!=(e=this.props.note.filename)?e:"",note:this.props.note}))),this.state.showDialog&&this.getDeleteDialog())},n.getHeaderIconsDiv=function(){var e={iconHovered:{color:p.NeutralColors.gray160},rootHovered:{backgroundColor:ct.editDeletIconhover,width:dt.size22px,height:dt.size22px}};return a.createElement("div",{className:"notecard-editcontrol"},a.createElement(d.IconButton,{title:Je.getLocalizedString("Notes_NotesEditTitle"),ariaLabel:Je.getLocalizedString("Notes_NotesEditTitle"),styles:e,iconProps:{iconName:Ue.notesEdit.iconName,style:{fontSize:p.FontSizes.size14}},className:"notecard-editcontrol-icon",onClick:this.onEditButtonClick.bind(this)}),a.createElement(d.IconButton,{title:Je.getLocalizedString("Notes_NoteDeleteTitle"),ariaLabel:Je.getLocalizedString("Notes_NoteDeleteTitle"),styles:e,iconProps:{iconName:Ue.deleteNotes.iconName,style:{fontSize:p.FontSizes.size14}},className:"notecard-deletecontrol-icon",onClick:this.onDeleteButtonClick.bind(this)}))},n.onDeleteButtonClick=function(e){Je.reportUserAction("onDeleteButtonClick","NoteCard","Delete note clicked",{noteId:this.props.note.annotationid},Ye.CLICK,"Delete note icon"),this.setState({showDialog:!0}),e.stopPropagation()},n.getDeleteDialog=function(){var e={type:T.DialogType.close,title:Je.getLocalizedString("Notes_Delete_Note"),closeButtonAriaLabel:Je.getLocalizedString("InContextView_Cancel"),subText:Je.getLocalizedString("Notes_Delete_Dialog_Confirmation")};return Je.reportInfo("getDeleteDialog","NoteCard","",{title:e.title}),a.createElement(T.Dialog,{hidden:!1,onDismiss:this.onDismiss.bind(this),dialogContentProps:e},a.createElement(T.DialogFooter,null,a.createElement(d.PrimaryButton,{onClick:this.onDeleteConfirm.bind(this),text:Je.getLocalizedString("InContextView_Delete")}),a.createElement(d.DefaultButton,{onClick:this.onDismiss.bind(this),text:Je.getLocalizedString("InContextView_Cancel")})))},n.onDismiss=function(){Je.reportUserAction("onDialogDismiss","NoteCard","Confirm note delete dismissed",{},Ye.CLICK,"Delete note cancel"),this.setState({showDialog:!1})},n.onDeleteConfirm=function(){var e=this;Je.reportUserAction("onDeleteConfirm","NoteCard","Conform note delete clicked",{noteId:this.props.note.annotationid},Ye.CLICK,"Delete note confirm"),this.props.services.dataService.deleteNote(this.props.note.annotationid).then((function(t){t&&t.id&&t.id===e.props.note.annotationid?(Je.reportInfo("onDeleteConfirm","NoteCard",$e.SUCCESS,{noteId:e.props.note.annotationid}),e.props.deleteNoteHandler(e.props.note.annotationid)):(Je.reportError("onDeleteConfirm","NoteCard",$e.FAILED,{error:"Empty response returned",noteId:e.props.note.annotationid}),e.props.deleteNoteHandler()),e.setState({actionInProgress:!1})})).catch((function(t){Je.reportError("onDeleteConfirm","NoteCard",$e.FAILED,{error:t,noteId:e.props.note.annotationid}),e.props.deleteNoteHandler()})),this.setState({actionInProgress:!0,showDialog:!1})},n.onEditButtonClick=function(e){var t;Je.reportUserAction("onEditButtonClick","NoteCard","Edit note clicked",{noteId:this.props.note.annotationid},Ye.CLICK,"Edit note icon"),null==(t=this.props.viewEventHandlers)||null==t.onOpenView||t.onOpenView({entityId:this.props.note.annotationid,entityType:me.Note},ve.Edit,this.props.relatedEntity||this.props.entity,this.props.note),e.stopPropagation()},t}(a.Component),In=function(e){function t(t){var n,i;return null==(n=(i=e.call(this,t)||this).props.viewEventHandlers)||null==n.setViewTitle||n.setViewTitle(Je.getLocalizedString("Notes_NotesListTitle")),i.state={notesList:i.props.notes?i.props.notes.noteList:[],isNotesFetched:!!i.props.notes},i.props.notes||i.props.services.dataService.fetchNotes(i.props.relatedEntity||i.props.primaryEntity).then((function(e){Je.reportInfo("constructor","NoteListView",$e.SUCCESS,{entityId:e.recordDetails.entityId,entityType:e.recordDetails.entityType,notesCount:e.noteList.length}),i.setState({isNotesFetched:!0,notesList:e.noteList})})).catch((function(e){var t;Je.reportError("constructor","NoteListView",$e.FAILED,{entityId:(i.props.relatedEntity||i.props.primaryEntity).entityId,entityType:(i.props.relatedEntity||i.props.primaryEntity).entityId,error:e}),null==(t=i.props.viewEventHandlers)||null==t.openErrorView||t.openErrorView(Je.getLocalizedString("Notes_Error_Message"))})),i}Me(t,e);var n=t.prototype;return n.render=function(){var e,t=this,n={rootHovered:{backgroundColor:ct.grey,color:ct.digitalBlue}};return this.state.isNotesFetched?(Je.reportInfo("render","NoteListView","",{noteCount:this.state.notesList.length}),e=0===this.state.notesList.length?this.emptyNotesView():a.createElement("div",{className:"notes-listview-container"},this.state.notesList.map((function(e){return a.createElement(Ln,Object.assign({},t.props,{key:e.annotationid,note:e,deleteNoteHandler:t.handleDeleteNote.bind(t),style:{borderBottom:"solid 1px #EDEBE9",paddingRight:20,paddingLeft:20}}))}))),a.createElement("div",{className:"icv-view-content-container"},a.createElement(d.ActionButton,{styles:n,className:"notes-addnewnote-button",iconProps:{iconName:Ue.add.iconName,style:{color:ct.digitalBlue}},onClick:this.onAddNoteClick.bind(this)},Je.getLocalizedString("Notes_Add_a_Note")),e)):this.notesViewLoading()},n.handleDeleteNote=function(e){var t;e?this.setState({notesList:this.state.notesList.filter((function(t){return t.annotationid!==e}))}):null==(t=this.props.viewEventHandlers)||null==t.setErrorMessage||t.setErrorMessage(Je.getLocalizedString("Notes_ErrorMessage_Delete_Note"))},n.onAddNoteClick=function(){var e;null==(e=this.props.viewEventHandlers)||null==e.onOpenView||e.onOpenView({entityId:"",entityType:me.Note},ve.Create,this.props.relatedEntity||this.props.entity)},n.emptyNotesView=function(){return a.createElement("div",{className:"notes-listview-empty-container"},a.createElement("div",{className:"notes-listview-icon-container"},a.createElement(C.Icon,{iconName:Ue.attachmentIcon.iconName,className:"notes-listview-icon"})),a.createElement("label",{className:"notes-listview-title"},Je.getLocalizedString("Notes_Find_your_notes_here")),a.createElement("label",{className:"notes-listview-subtitle"},Je.getLocalizedString("Notes_No_notes_Empty_state")))},n.notesViewLoading=function(){return a.createElement(Dn,{spinnerSize:2,loadingMessage:Je.getLocalizedString("InContextView_Loading")})},t}(a.Component),An=u.mergeStyles({padding:"0 20px","&:hover":{backgroundColor:"#F3F2F1"},"&:focus-within":{backgroundColor:"#FFF",borderBottom:"1px solid #2266E3"}}),Rn=u.mergeStyles({"& .ms-TextField-fieldGroup":{background:"transparent"}}),Fn=function(e){var t=e.task,n=e.onTaskStateChanged,i=e.onTaskDeleted,r=e.onTaskCreated,s=e.onTaskUpdated,l=e.dataService,c=e.recordContainerContext,u=e.relatedEntity,m=o.useState(t.statecode==ye.Completed),h=m[0],g=m[1],f=o.useState(!1),y=f[0],S=f[1],E=o.useState(!1),b=E[0],D=E[1],x=o.useState(void 0),k=x[0],_=x[1],N=o.useState(""),L=N[0],I=N[1],A=o.useState(""),F=A[0],z=A[1],B=o.useState(""),U=B[0],H=B[1],G=o.useState(!1),W=G[0],j=G[1],X=o.useState(t.subject),K=X[0],q=X[1],Z=null;o.useEffect((function(){var e=t.statecode==ye.Completed;I("icv-tasks-lvi-subject"+(e?" icv-tasks-lvi-completed-metadata":""));var n=!1;if(t.dueDate){_(t.friendlyDueDate);var i=null==c?void 0:c.timezoneService.utcToUserLocal(t.dueDate);i&&qt.isOverdue(i)&&(n=!0),S(n)}q(t.subject);var r=n&&!e?" icv-tasks-lvi-overdue-color":"";z("icv-tasks-lvi-icon"+r),H("icv-tasks-lvi-metadata-label"+r),null!=Z&&!0===t.isTemporaryObject&&v.StringUtil.IsNullOrEmpty(K)&&Z.focus()}),[t,t.statecode,c]);var J,Q=a.useCallback((function(){var i=t.statecode!=ye.Completed?ye.Completed:ye.Open,r=i==ye.Completed;g(r),D(!0),l.updateTask(t.key,{statecode:i}).then((function(){t.statecode=i,null==n||n(t,r)})).catch((function(n){var i;Je.reportError("onTaskUpdate","TaskListViewItem",$e.FAILED,{error:n,entityId:t.key,dataFields:["name"]}),null==(i=e.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("Tasks_ErrorMessage_Update_Task"))})).finally((function(){D(!1)}))}),[t,e.viewEventHandlers,l.updateTask,n]),Y=a.useCallback((function(){t.isTemporaryObject||(j(!1),l.deleteTask(t.key).then((function(){null==i||i(t),Je.reportUserAction("onTaskDelete","TaskListViewItem","task delete Completed",{},Ye.CLICK,"Delete task")})).catch((function(n){var i;Je.reportError("onTaskDelete","TaskListViewItem",$e.FAILED,{error:n,entityId:t.key,dataFields:["name"]}),null==(i=e.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("Tasks_ErrorMessage_Delete_Task"))})).finally((function(){D(!1)})))}),[t,e.viewEventHandlers,l.deleteTask,i]),$=a.useCallback(Fe(He.mark((function e(){return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Je.openEntityInMFD("task",t.key,(function(){null==s||s()}));case 1:case"end":return e.stop()}}),e)}))),[t]),ee=function(){Je.reportUserAction("onDialogDismiss","TaskListViewItem","Confirm task delete dismissed",{},Ye.CLICK,"Delete task cancel"),j(!1)},te=function(){t.isTemporaryObject&&(null==i||i(t))},ne={iconHovered:{color:p.NeutralColors.gray160},rootHovered:{backgroundColor:ct.editDeletIconhover,width:dt.size22px,height:dt.size22px}},ie=function(){if(t.isTemporaryObject){if(v.StringUtil.IsNullOrEmpty(K))return void te();D(!0);var n={subject:K};u&&(n["regardingobjectid_"+u.entityType+"_task@odata.bind"]="/"+Je.getPluralNameOfEntity(u.entityType)+"("+u.entityId+")"),l.createTask(n).then(function(){var e=Fe(He.mark((function e(t){var n;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.entityType||"task"!==t.entityType.toLowerCase()){e.next=7;break}return te(),e.next=4,l.fetchTask(t.id);case 4:(n=e.sent)&&(null==r||r(n)),Je.reportUserAction("onTaskCreate","TaskListViewItem","task create Completed",{},Ye.CLICK,"Create task");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(n){var i;Je.reportError("onTaskCreate","TaskListViewItem",$e.FAILED,{error:n,entityId:t.key,dataFields:["subject"]}),null==(i=e.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("Tasks_ErrorMessage_Create_Task"))})).finally((function(){D(!1)}))}else if(t.statecode!==ye.Completed){if(v.StringUtil.IsNullOrEmpty(K))return void q(t.subject);D(!0),l.updateTask(t.key,{subject:K}).catch((function(n){var i;Je.reportError("onTaskUpdate","TaskListViewItem",$e.FAILED,{error:n,entityId:t.key,dataFields:["subject"]}),null==(i=e.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("Tasks_ErrorMessage_Update_Task"))})).finally((function(){D(!1)}))}};return a.createElement("div",{className:"taskcard-document-container "+An},a.createElement(P.Stack,{horizontal:!0,style:{height:"77px",alignItems:"center"}},a.createElement(O.ActionButton,{disabled:b||t.isTemporaryObject,style:{marginRight:"8px"},onClick:Q,ariaLabel:Je.getLocalizedString("ICV_UpdateTask")},a.createElement(M.Check,{checked:h})),a.createElement(P.Stack,{grow:!0},t.statecode!==ye.Completed&&a.createElement(V.TextField,{componentRef:function(e){Z=e},borderless:!0,className:L+" "+Rn,placeholder:Je.getLocalizedString("Tasks_PlaceHolder_Add_A_Task"),value:K,onChange:function(e){t.statecode!==ye.Completed&&q(e.target.value)},onBlur:ie,onKeyDown:function(e){"Escape"==e.key?te():"Enter"==e.key&&ie()}}),t.statecode===ye.Completed&&a.createElement(R.Label,{className:L},t.subject),k&&a.createElement(P.Stack,{horizontal:!0,className:"icv-tasks-lvi-metadata-stack-style"},a.createElement(C.Icon,{iconName:"DateTime2",className:F}),a.createElement(R.Label,{className:U},k)),t.owner&&a.createElement(P.Stack,{horizontal:!0,className:"icv-tasks-lvi-metadata-stack-style"},a.createElement(C.Icon,{iconName:Ue.contact.iconName,className:F}),a.createElement(R.Label,{className:U},t.owner))),a.createElement("div",{className:"icv-tasks-lvi-right-icon-container"},b&&a.createElement(w.Spinner,{size:w.SpinnerSize.small}),!b&&y&&t.statecode!==ye.Completed&&a.createElement(C.Icon,{iconName:"BufferTimeBoth",className:"icv-tasks-lvi-overdue-color"})),void 0===t.isTemporaryObject&&a.createElement("div",{className:"taskcard-editcontrol"},a.createElement(d.IconButton,{title:Je.getLocalizedString("Tasks_TasksEditTitle"),ariaLabel:Je.getLocalizedString("Tasks_TasksEditTitle"),styles:ne,iconProps:{iconName:Ue.editTask.iconName,style:{fontSize:p.FontSizes.size14}},className:"taskcard-editcontrol-icon",onClick:$}),a.createElement(d.IconButton,{title:Je.getLocalizedString("Tasks_Delete_Task"),ariaLabel:Je.getLocalizedString("Tasks_Delete_Task"),styles:ne,iconProps:{iconName:Ue.deleteTask.iconName,style:{fontSize:p.FontSizes.size14}},className:"taskcard-deletecontrol-icon",onClick:function(){Je.reportUserAction("onTaskDeleteClicked","TaskListViewItem","Confirm task delete dialog visible",{},Ye.CLICK,"Delete task cancel"),j(!0)}})),!0===t.isTemporaryObject&&a.createElement("div",{className:"taskcard-editcontrol"},a.createElement(d.IconButton,{title:Je.getLocalizedString("Tasks_Delete_Task"),ariaLabel:Je.getLocalizedString("Tasks_Delete_Task"),styles:ne,iconProps:{iconName:Ue.deleteTask.iconName,style:{fontSize:p.FontSizes.size14}},className:"taskcard-deletecontrol-icon",onClick:te})),W&&(J={type:T.DialogType.close,title:Je.getLocalizedString("Tasks_Delete_Task"),closeButtonAriaLabel:Je.getLocalizedString("InContextView_Cancel"),subText:Je.getLocalizedString("Tasks_Delete_Dialog_Confirmation")},Je.reportInfo("getDeleteDialog","TaskListViewItem","",{title:J.title}),a.createElement(T.Dialog,{hidden:!1,onDismiss:ee,dialogContentProps:J},a.createElement(T.DialogFooter,null,a.createElement(d.PrimaryButton,{onClick:Y,text:Je.getLocalizedString("InContextView_Delete")}),a.createElement(d.DefaultButton,{onClick:ee,text:Je.getLocalizedString("InContextView_Cancel")}))))))},Pn=function(e,t){switch(t.type){case"createdLists":return{inProgressTasks:t.inProgressList,completedTasks:t.completedTasks};case"newTask":return Pe({},e,e.inProgressTasks.length>0&&!0===e.inProgressTasks[0].isTemporaryObject?{inProgressTasks:[t.itemToAdd].concat(e.inProgressTasks.slice(1))}:{inProgressTasks:[t.itemToAdd].concat(e.inProgressTasks)});case"addNewInProgressTask":return Pe({},e,{inProgressTasks:[t.itemToAdd].concat(e.inProgressTasks)});case"deleteTask":return e.inProgressTasks.find((function(e){return e.key===t.itemToDelete.key}))?Pe({},e,{inProgressTasks:e.inProgressTasks.filter((function(e){return e.key!==t.itemToDelete.key}))}):Pe({},e,{completedTasks:e.completedTasks.filter((function(e){return e.key!==t.itemToDelete.key}))});case"moveToInProgress":var n=e.completedTasks.indexOf(t.itemToMove);return{completedTasks:[].concat(e.completedTasks.slice(0,n),e.completedTasks.slice(n+1)),inProgressTasks:[t.itemToMove].concat(e.inProgressTasks)};case"moveToCompleted":var i=e.inProgressTasks.indexOf(t.itemToMove);return{inProgressTasks:[].concat(e.inProgressTasks.slice(0,i),e.inProgressTasks.slice(i+1)),completedTasks:[t.itemToMove].concat(e.completedTasks)}}},Mn=function e(t){var n=o.useState(""),i=n[0],r=n[1],s=o.useState(!1),l=s[0],c=s[1],d=o.useState(t.tasks),u=d[0],p=d[1],m=a.useReducer(Pn,{inProgressTasks:[],completedTasks:[]}),h=m[0],g=m[1],f=function(){t.relatedEntity&&t.services.dataService.fetchTasks(t.relatedEntity.entityId,t.relatedEntity.entityType).then((function(e){Je.reportInfo("constructor","tasksControl",$e.SUCCESS,{entityId:e.recordId,entityType:e.recordType,tasksCount:e.taskList.length}),p(e)})).catch((function(e){var n;Je.reportError("constructor","tasksControl",$e.FAILED,{entityId:t.relatedEntity.entityId,entityType:t.relatedEntity.entityType,error:e}),null==(n=t.viewEventHandlers)||null==n.openErrorView||n.openErrorView(Je.getLocalizedString("Tasks_Error_Message"))}))};o.useEffect((function(){var n;Je.reportUserAction("TasksControl",e.name,"",{},"loaded",""),null==(n=t.viewEventHandlers)||null==n.setViewTitle||n.setViewTitle(Je.getLocalizedString("Tasks_TasksListTitle")),u||f()}),[t.relatedEntity]),o.useEffect((function(){if(u){var e;r((null==(e=t.tasks)?void 0:e.recordType)||""),c(!0);var n=qt.filterTasksByState(u.taskList);g({type:"createdLists",inProgressList:n.inProgTaskList,completedTasks:n.completedTaskList})}}),[u]);var v=y.mergeStyles({fontSize:"16px",lineHeight:"100%",margin:"6px 0px"}),S=a.useCallback((function(e,t){g({type:t?"moveToCompleted":"moveToInProgress",itemToMove:e})}),[]),E=a.useCallback((function(e){g({type:"deleteTask",itemToDelete:e})}),[]),b=a.useCallback((function(e){Je.reportUserAction("onTaskAdded","tasksControl","task add Completed",{},Ye.CLICK,"Add task"),g({type:"newTask",itemToAdd:e})}),[]),w=a.useCallback((function(){f()}),[]);return a.createElement(a.Fragment,null,l?a.createElement(a.Fragment,null,a.createElement("div",{style:{borderBottom:"1px",borderBottomStyle:"solid",borderColor:"#EAEAEA"}},a.createElement(F.Link,{onClick:function(){t.isInlineAddTaskEnabled?g({type:"addNewInProgressTask",itemToAdd:{key:z.Guid.newGuid(),owner:"",subject:"",statecode:ye.Open,description:"",dueDate:void 0,friendlyDueDate:void 0,duration:void 0,prioritycode:fe.Normal,isTemporaryObject:!0}}):qt.OpenQuickCreateTask(t.context,t.services.dataService,(null==u?void 0:u.recordId)||"",i,(null==u?void 0:u.recordType.toString().toLowerCase())||"").then((function(e){e&&g({type:"moveToInProgress",itemToMove:e})}))},style:{margin:"8px"}}," ",a.createElement(C.FontIcon,{iconName:"Add",className:v,style:{marginLeft:"9px",marginRight:"8px"}})," ",Je.getLocalizedString("Tasks_Add_A_Task"))),qt.showEmptyListText(null==u?void 0:u.taskList,h.inProgressTasks,h.completedTasks)?a.createElement(R.Label,{style:{marginTop:"20px",marginLeft:"9px",fontFamily:"Segoe UI",fontSize:"12px",textAlign:"center",lineHeight:"16px"}},Je.getLocalizedString("Tasks_EmptyList")):a.createElement("div",{style:{overflow:"auto"}},a.createElement("div",{style:{marginTop:"20px",marginLeft:"20px"}},h.inProgressTasks.map((function(e){return a.createElement("div",{key:e.key},a.createElement(Fn,Object.assign({},t,{dataService:t.services.dataService,task:e,onTaskStateChanged:S,onTaskDeleted:E,onTaskCreated:b,onTaskUpdated:w,relatedEntity:t.relatedEntity})))})),h.completedTasks.length>0&&a.createElement(R.Label,{style:{margin:"16px 0px"}},Je.getLocalizedString("Tasks_Header_CompletedTaskList")),h.completedTasks.map((function(e){return a.createElement("div",{key:e.key},a.createElement(Fn,Object.assign({},t,{dataService:t.services.dataService,task:e,onTaskStateChanged:S,onTaskDeleted:E,onTaskCreated:b,onTaskUpdated:w,relatedEntity:t.relatedEntity})))}))))):a.createElement(Dn,{spinnerSize:1,loadingMessage:""}))},On=function(){function e(){}return e.initializeTheme=function(e){this.theme=e},e.getTheme=function(){return this.theme},e.getErrorButtonStyle=function(){return{root:{color:"#A4262C",background:"transparent"},rootHovered:{color:"#A4262C",background:"transparent"},rootPressed:{color:"#A4262C",background:"transparent"},rootFocused:{color:"#A4262C",background:"transparent"}}},e.getSavedButtonStyle=function(){return{root:{color:"#107C10",background:"transparent"},rootHovered:{color:"#107C10",background:"transparent"},rootPressed:{color:"#107C10",background:"transparent"},rootFocused:{color:"#107C10",background:"transparent"}}},e.getSpinnerStyles=function(){return{root:{marginLeft:10}}},e.getFieldTextStyle=function(e){switch(e){case B.EDataType.Lookup:case B.EDataType.Customer:case B.EDataType.Owner:return{fontSize:"14px",fontWeight:"normal",color:"#2266E3"};default:return{fontSize:"14px",fontWeight:"normal"}}},e}(),Vn=function(){function e(){}return e.loadScripts=function(t,n){G.ScriptSandbox.initialize(t,e.WebResources_Iframe_ID,n)},e.hasClientEventHandlers=function(){return G.ScriptSandbox.hasClientEventHandlers(e.WebResources_Iframe_ID)},e.getSaveHandler=function(){return G.ScriptSandbox.getSaveHandler(e.WebResources_Iframe_ID)},e.getChangeHandler=function(){return G.ScriptSandbox.getChangeHandler(e.WebResources_Iframe_ID)},e.getRowLoadHandler=function(){return G.ScriptSandbox.getRowLoadHandler(e.WebResources_Iframe_ID)},e.getWebresourceLoaderState=function(){return G.ScriptSandbox.getWebresourceLoaderState(e.WebResources_Iframe_ID)},e}();Vn.WebResources_Iframe_ID="Workspace_Webresource_Frame";var zn=function(e){function t(){return e.apply(this,arguments)||this}Me(t,e);var n=t.prototype;return n.render=function(){return this.props.data[this.props.column]==je.Spinner?this.getSpinner():this.getLoadMoreButton()},n.getSpinner=function(){return o.createElement("div",{style:{display:"flex",alignItems:"center",height:"100%",color:ct.digitalBlue}},o.createElement("div",{className:"grid-loader-spinner"}),o.createElement("div",{style:{marginLeft:"12px"}},Je.getLocalizedString("WS_Grid_Show_More_Rows_Loading")))},n.getLoadMoreButton=function(){return o.createElement(q.ActionButton,{className:"showMoreButton",onClick:this.loadMoreButtonHandler.bind(this),text:Hn.shouldDisplayShowAllButton()?Je.getLocalizedString("WS_Grid_Show_All"):Je.getLocalizedString("WS_Grid_Show_More_Rows")})},n.loadMoreButtonHandler=function(){if(Je.reportUserAction("loadMoreButtonHandler","showMoreRowsRenderer","Show more rows button clicked.",{},"Show more rows button clicked.",""),Hn.shouldDisplayShowAllButton()){var e;null==(e=document.querySelector("."+Ke.gridSearchboxClassName+" button"))||null==e.click||e.click()}else{mn.loadMoreRows();var t=this.props.node;t.data[this.props.column]=je.Spinner,t&&this.props.api.redrawRows({rowNodes:[t]})}},t}(o.Component),Bn=function(e){function t(){return e.apply(this,arguments)||this}Me(t,e);var n=t.prototype;return n.render=function(){var e=this;return Je.reportInfo("render","EmptyState","No rows view rendered",{}),o.createElement("div",{className:this.props.getScenario()==Xe.RowCountExceedsLimit?"dm-empty-state row-limit-exceeded":"dm-empty-state"},o.createElement("div",{className:"dm-empty-state-img"},o.createElement("img",{style:{height:"100px",width:"100px"},src:this.getImage()})),o.createElement(Z.Label,{className:"dm-empty-state-title"},this.getTitle()),o.createElement(Z.Label,{className:"dm-empty-state-desc"},this.getDescription()),this.props.showSpinner&&this.props.showButton&&this.getSpinner(),!this.props.showSpinner&&this.props.showButton?o.createElement(J.DefaultButton,{text:this.getButtonTitle(),iconProps:{iconName:this.props.getScenario()==Xe.NoData||this.props.getScenario()==Xe.RowCountExceedsLimit?"Filter":"Sync"},className:"dm-empty-state dm-button",onClick:function(){e.onSuggestedActionPerformed()}}):"")},n.getSpinner=function(){return o.createElement("div",{className:"dm-empty-state-spinner"})},n.onSuggestedActionPerformed=function(){this.props.getScenario()!=Xe.NoData&&this.props.getScenario()!=Xe.RowCountExceedsLimit||this.props.setFilterPanelIsOpen&&this.props.setFilterPanelIsOpen(!0),Je.reportUserAction("render","EmptyState","user click on suggested button",{NoRowsScenario:this.props.getScenario()},this.props.getScenario()==Xe.NoData||this.props.getScenario()==Xe.RowCountExceedsLimit?"Open Filter":"Refresh","")},n.getImage=function(){switch(this.props.getScenario()){case Xe.Error:return"/webresources/msdyn_/Images/ErrorLoadingRowsImage.svg";case Xe.NoData:case Xe.RowCountExceedsLimit:return"/webresources/msdyn_/Images/NoRowsImage.svg";case Xe.SearchReturnedEmptyTryChangingFilters:case Xe.SearchReturnedEmpty:return"/webresources/msdyn_/Images/EmptySearchImage.svg"}},n.getTitle=function(){switch(this.props.getScenario()){case Xe.RowCountExceedsLimit:return Je.getLocalizedString("WS_NoRows_LimitReachedTitle");case Xe.Error:return Je.getLocalizedString("WS_NoRows_ErrorTitle");case Xe.NoData:return Je.getLocalizedString("WS_NoRows_Title");case Xe.SearchReturnedEmptyTryChangingFilters:case Xe.SearchReturnedEmpty:return Je.getLocalizedString("WS_NoRows_SearchEmptyTitle")}},n.getButtonTitle=function(){switch(this.props.getScenario()){case Xe.Error:return Je.getLocalizedString("WS_NoRows_RefreshButtonTitle");case Xe.NoData:case Xe.RowCountExceedsLimit:return Je.getLocalizedString("WS_NoRows_ViewFitlersButtonTitle")}},n.getDescription=function(){switch(this.props.getScenario()){case Xe.RowCountExceedsLimit:return Je.getLocalizedString("WS_NoRows_LimitReachedMessage");case Xe.Error:return Je.getLocalizedString("WS_NoRows_ErrorMessage");case Xe.NoData:return Je.getLocalizedString("WS_NoRows_Message");case Xe.SearchReturnedEmptyTryChangingFilters:return Je.getLocalizedString("WS_NoRows_SearchEmptyMessage_TryChangingFilters");case Xe.SearchReturnedEmpty:return Je.getLocalizedString("WS_NoRows_SearchEmptyMessage")}},t}(o.Component);K.LicenseManager.setLicenseKey("CompanyName=Microsoft Corporation,LicensedApplication=Business Applications Group,LicenseType=SingleApplication,LicensedConcurrentDeveloperCount=-1,LicensedProductionInstancesCount=-1,AssetReference=AG-015323,ExpiryDate=26_June_2022_[v2]_MTY1NjE5ODAwMDAwMA==79f580f1282d65cd03f5ef15c3ff99af");var Un,Hn=function(e){function t(n){var i;return(i=e.call(this,n)||this).state={isScriptLoaded:!1},Je.componentStart(t.componentName),i}Me(t,e);var n=t.prototype;return n.componentWillUnmount=function(){t.gridApi=void 0,t.columnApi=void 0,t.currentGroupedColumnSortDir=-1,t.currentGroupedColumnDatatype=void 0,t.searchTextEntered="",t.aggregateRowData={},t.elementToFocus="",t.expandedRowGroups=[],t.searchActive=!1},n.render=function(){var e=!!this.props.dataset,t=this.props.displayCollectionName;return a.createElement(Q.Shimmer,{styles:Gt.getGridShimmerStyles(),customElementsGroup:Gt.getGridOrChartShimmer(),isDataLoaded:e&&!!t},e&&!!t&&this.getAgGrid())},n.getAgGrid=function(){var e,n,i,r=this.props.getColumns(this.props.totalRowGroupsCount,this.props.rowGroupsCollapsedCount,this.props.updateRowGroupsCollapsedCount,this.props.updateTotalRowGroupsCount);t.rows=this.getRows(r),mn.grid.paging.hasNextPage&&this.addRowForLoadMoreButton();var o=Object.values(this.props.columnsStatus).find((function(e){return e.rowGroup}));return t.currentGroupedColumnSortDir=null==(e=mn.grid)||null==(n=e.sorting.find((function(e){return e.name==(null==o?void 0:o.fieldName)})))?void 0:n.sortDirection,t.currentGroupedColumnDatatype=o&&(null==(i=this.props.attributesMetadata.get(o.fieldName))?void 0:i.dataType),a.createElement("div",{id:"workspaceEntityGrid",className:t.rows.length>0?"gridContainer":"gridContainer emptyGrid"},a.createElement("div",{className:"ag-theme-alpine",style:{height:"100%",width:"100%"}},a.createElement(W.AgGridReact,{modules:[j.ClientSideRowModelModule,X.RowGroupingModule],rowData:t.rows,columnDefs:r,applyColumnDefOrder:!0,isFullWidthCell:function(e){return e.data&&e.data.key==Ke.loadMoreRowKey},onSelectionChanged:this.onRowSelectionChanged.bind(this),onDragStopped:this.onDragStopped.bind(this),onRowClicked:this.onRowClicked.bind(this),animateRows:!1,debounceVerticalScrollbar:!1,suppressColumnVirtualisation:!0,enableRtl:Je.isRTL(),suppressDragLeaveHidesColumns:!0,groupUseEntireRow:!0,rowBuffer:10,headerHeight:42,getRowHeight:function(e){return e.data&&e.data.key==Ke.loadMoreRowKey?60:0==e.node.rowIndex?42:43},ensureDomOrder:!0,immutableData:!0,getRowNodeId:function(e){return e.key},isRowSelectable:function(e){return e.data&&e.data.key!=Ke.loadMoreRowKey&&e.data.key!=Ke.aggregateRowKey},onRowGroupOpened:this.onRowGroupOpened.bind(this),onColumnResized:this.onColumnResized.bind(this),onGridReady:this.onGridReady.bind(this),onRowDataUpdated:this.onRowDataUpdated.bind(this),onRowDoubleClicked:this.onRowDoubleClicked.bind(this),overlayLoadingTemplate:'<div class="grid-loader-spinner grid-loader-spinner-large"></div>',fullWidthCellRendererFramework:zn,fullWidthCellRendererParams:{column:Ke.loadMoreRowKey},noRowsOverlayComponentFramework:Bn,noRowsOverlayComponentParams:{getScenario:this.getScenario.bind(this)},groupRowRendererParams:{checkbox:!0,suppressDoubleClickExpand:!0},defaultGroupSortComparator:this.defaultGroupSortComparator.bind(this),rowSelection:"multiple",groupSelectsChildren:!0,suppressRowClickSelection:!0,suppressAggFuncInHeader:!0,defaultColDef:{sortable:!1,filter:!1,resizable:!0}})))},n.getScenario=function(){return mn.grid.error?Xe.Error:t.isSearchTextEntered()?Xe.SearchReturnedEmptyTryChangingFilters:Xe.NoData},n.onRowClicked=function(e){var n,i;t.searchActive&&(null==e||!e.node.expanded)&&t.filterExpandedRows(e.rowIndex),1==(null==(n=e.node)?void 0:n.group)&&(null==(i=e.node)||i.setExpanded(!e.node.expanded))},n.defaultGroupSortComparator=function(e,n){return e.key&&e.key!=Je.getLocalizedString("WS_Grid_Grouping_Ungrouped")?n.key&&n.key!=Je.getLocalizedString("WS_Grid_Grouping_Ungrouped")?1==t.currentGroupedColumnSortDir?t.currentGroupedColumnDatatype==B.EDataType.Date?new Date(n.key).getTime()-new Date(e.key).getTime():n.key.localeCompare(e.key):t.currentGroupedColumnDatatype==B.EDataType.Date?new Date(e.key).getTime()-new Date(n.key).getTime():e.key.localeCompare(n.key):-1:1},n.onColumnResized=function(e){if(1==(null==e?void 0:e.finished)&&"uiColumnDragged"==(null==e?void 0:e.source)){var n,i,r=null==e||null==(n=e.columns[0])?void 0:n.colId;Je.reportUserAction("onColumnResized","entityGrid","Column width resized. Column: "+r,{},"Column width resized","");var o=this.props.columnsStatus[r],a=this.props.firstColumn===r?t.firstColWidthParams:t.otherColWidthParams;o.width=Math.max(null==(i=e.columnApi)?void 0:i.getColumn(r).actualWidth,a.minWidth),this.props.updateColumnStatus(o)}},n.onRowGroupOpened=function(e){"rowGroupOpened"==(null==e?void 0:e.type)&&1==(null==e?void 0:e.expanded)?this.props.updateRowGroupsCollapsedCount(this.props.rowGroupsCollapsedCount-1):"rowGroupOpened"==(null==e?void 0:e.type)&&0==(null==e?void 0:e.expanded)&&(this.props.updateRowGroupsCollapsedCount(this.props.rowGroupsCollapsedCount+1),t.searchActive&&t.filterExpandedRows(e.rowIndex))},n.onGridReady=function(e){var n;t.gridApi=e.api,t.columnApi=e.columnApi,null==(n=document.querySelector(".ag-root"))||n.setAttribute("aria-label",this.props.displayCollectionName),this.updateTotalRowGroupsCount(),Je.componentEnd(t.componentName),Je.loadEnd()},n.onRowDataUpdated=function(e){this.updateTotalRowGroupsCount(),""!=t.elementToFocus&&setTimeout((function(){var e;null==(e=document.querySelector("."+t.elementToFocus))||e.focus(),t.elementToFocus=""}),100)},n.updateTotalRowGroupsCount=function(){var e=t.getCurrentRowGroupsCount();null!=e&&this.props.totalRowGroupsCount!=e&&this.props.updateTotalRowGroupsCount(e)},n.onRowDoubleClicked=function(e){var t,n=null==(t=e.data)?void 0:t.key;n&&n!==Ke.loadMoreRowKey&&n!==Ke.aggregateRowKey&&(Je.reportUserAction("onRowDoubleClicked","entityGrid","Double clicked on row",{},"Open entity",""),Je.scenarioStart(We.openInContextView),this.props.openEntity(n,this.props.entityType))},n.addRowForLoadMoreButton=function(){var e={};e.key=Ke.loadMoreRowKey,e[Ke.loadMoreRowKey]=je.Button,t.rows.push(e)},n.onRowSelectionChanged=function(e){var t=e.api.getSelectedRows().map((function(e){return e.key}));t&&(Je.reportUserAction("onRowSelectionChanged","entityGrid","Row selection changed. Selected "+t.length+" rows",{numberOfRowsSelected:t.length},"Row selection",""),this.props.onRowSelectionChanged(t),this.props.updateSelectedRecordsCount(t.length))},n.onDragStopped=function(e){var n,i=this;if("ag-react-container"==(null==e||null==(n=e.target)?void 0:n.className)){Je.reportUserAction("onDragStopped","entityGrid","Column dragged",{},"Column dragged","");var r=t.getAllGridColumns(),o={};null==r||r.map((function(e,t){o[e.getColId()]=i.props.columnsStatus[e.getColId()],o[e.getColId()].index=t}));var a=t.getFirstColumn();a!=this.props.firstColumn&&(Je.reportUserAction("onDragStopped","entityGrid","Column dragged to first column. Column: "+a,{updatedFirstColumn:a},"Column dragged to first position",""),e.api.refreshCells({columns:[a,this.props.firstColumn],force:!0}),this.props.updateFirstColumn(a)),this.props.updateColumnsStatus(o)}},n.getRows=function(e){var t=this,n=[],i=Vn.getRowLoadHandler();return Vn.getWebresourceLoaderState()!=G.ScriptLoadingStatus.Idle&&Vn.getWebresourceLoaderState()!=G.ScriptLoadingStatus.Loading||this.checkWebresourceStateAndRefreshGrid(),this.props.dataset.forEach((function(r){var o={};o.key=r.recordId,i&&i(t.props.getExecutionContext(r)),e.forEach((function(e){e.field&&(o[e.field]=r.formattedValues.get(e.field))})),n.push(o)})),n},n.checkWebresourceStateAndRefreshGrid=function(){var e=this;setTimeout((function(){var t=Vn.getWebresourceLoaderState();t==G.ScriptLoadingStatus.Loaded?(Je.reportInfo("checkWebresourceStateAndRefreshGrid","entityGrid","Script is Loaded.",{}),e.setState({isScriptLoaded:!0})):t!=G.ScriptLoadingStatus.Loading&&t!=G.ScriptLoadingStatus.Idle||(Je.reportInfo("checkWebresourceStateAndRefreshGrid","entityGrid","Script is still in Loading or Idle state. Re-checking state in 500ms",{}),e.checkWebresourceStateAndRefreshGrid())}),500)},t.moveColumn=function(e,t){var n;null==(n=this.columnApi)||null==n.moveColumn||n.moveColumn(e,t)},t.refreshCells=function(e){var t;null==(t=this.gridApi)||null==t.refreshCells||t.refreshCells(e)},t.getAllDisplayedColumns=function(){var e;return null==(e=this.columnApi)?void 0:e.getAllDisplayedColumns().slice(1)},t.getAllGridColumns=function(){var e;return null==(e=this.columnApi)?void 0:e.getAllGridColumns().slice(1)},t.getFirstColumn=function(){var e,t;return null==(e=this.columnApi)||null==(t=e.getAllDisplayedColumns())?void 0:t[1].getColId()},t.setColumnVisible=function(e,t){var n;null==(n=this.columnApi)||n.setColumnVisible(e,t)},t.setColumnsVisible=function(e,t){var n;null==(n=this.columnApi)||n.setColumnsVisible(e,t)},t.getRowNode=function(e){var t;return null==(t=this.gridApi)?void 0:t.getRowNode(e)},t.showLoadingOverlay=function(){var e;null==(e=this.gridApi)||null==e.showLoadingOverlay||e.showLoadingOverlay()},t.setPinnedBottomRowData=function(e){var t;null==(t=this.gridApi)||t.setPinnedBottomRowData(e)},t.isBottomRowPinned=function(){return this.gridApi&&this.gridApi.getPinnedBottomRowCount()>0},t.expandAll=function(){var e;return null==(e=this.gridApi)?void 0:e.expandAll()},t.collapseAll=function(){var e;return null==(e=this.gridApi)?void 0:e.collapseAll()},t.getCurrentRowGroupsCount=function(){var e,t=0,n=null==(e=this.gridApi)||null==e.getModel?void 0:e.getModel();return n?(null==n||n.forEachNode((function(e){(null==e?void 0:e.group)&&t++})),t):null},t.isSearchTextEntered=function(){return""!=t.searchTextEntered},t.shouldDisplayShowAllButton=function(){var e;return(null==(e=this.gridApi)?void 0:e.getDisplayedRowCount())!=t.rows.length&&t.isSearchTextEntered()},t.search=function(e){var n;t.searchTextEntered=e,null==(n=this.gridApi)||n.setQuickFilter(e),this.handleSearchScenarios(e)},t.handleSearchScenarios=function(e){var n,i,r,o,a=this;t.searchActive||this.getExpandedRowGroups();var s={key:Ke.loadMoreRowKey},l=null==(n=this.gridApi)?void 0:n.getRowNode(Ke.loadMoreRowKey),c=null==(i=this.gridApi)?void 0:i.getDisplayedRowCount();if(this.showAggregateRowIfNotPresent(c),""!=e&&(c>1&&l||c>0&&!l))this.handleTextSearched(c,s,l);else if(l&&1==c){var d;null==(d=this.gridApi)||d.applyTransactionAsync({remove:[s]},(function(){var e,t;null==(e=a.gridApi)||e.showNoRowsOverlay(),null==(t=a.gridApi)||t.setPinnedBottomRowData([])}))}else""==e&&c>0&&this.handleTextCleared(c,s,l);(l=null==(r=this.gridApi)?void 0:r.getRowNode(Ke.loadMoreRowKey))&&(null==(o=this.gridApi)||o.redrawRows({rowNodes:[l]}))},t.showAggregateRowIfNotPresent=function(e){var n,i;t.aggregateRowData!={}&&e>0&&0==(null==(n=this.gridApi)?void 0:n.getPinnedBottomRowCount())&&(null==(i=this.gridApi)||i.setPinnedBottomRowData([t.aggregateRowData]))},t.handleTextSearched=function(e,n,i){var r,o,a;null==(r=this.gridApi)||r.hideOverlay(),i||0==e||e==t.rows.length?e>t.rows.length&&(null==(a=this.gridApi)||a.applyTransaction({remove:[n]})):null==(o=this.gridApi)||o.applyTransaction({add:[n]})},t.handleTextCleared=function(e,n,i){var r,o,a,s;null==(r=this.gridApi)||r.hideOverlay(),this.showAggregateRowIfNotPresent(e),mn.grid.paging.hasNextPage&&!i&&(null==(o=this.gridApi)||o.applyTransaction({add:[n]})),!mn.grid.paging.hasNextPage&&i&&(null==(a=this.gridApi)||a.applyTransaction({remove:[n]}));var l=null==(s=this.gridApi)||null==s.getModel?void 0:s.getModel();t.collapseAll(),t.searchActive=!1,t.expandedRowGroups.forEach((function(e){var t,n;null!=l&&l.isRowPresent(e)?null==(t=l.getRow(e.rowIndex))||t.setExpanded(!0):null==l||null==(n=l.getRow(e.rowIndex))||n.setExpanded(!1)}))},t.getVisibleRowCount=function(){var e,t,n=null==(e=this.gridApi)?void 0:e.getRowNode(Ke.loadMoreRowKey),i=null==(t=this.gridApi)?void 0:t.getDisplayedRowCount();return n&&i>0?i-1:i},t.getExpandedRowGroups=function(){var e;if(t.searchActive)return null;var n=null==(e=this.gridApi)||null==e.getModel?void 0:e.getModel();if(!n)return null;t.expandedRowGroups=[],null==n||n.forEachNode((function(e){(null==e?void 0:e.group)&&e.expanded&&t.expandedRowGroups.push(e)})),t.expandAll(),t.searchActive=!0},t.filterExpandedRows=function(e){t.expandedRowGroups=t.expandedRowGroups.filter((function(t){return t.rowIndex!=e}))},t}(a.Component);Hn.componentName="grid",Hn.rows=[],Hn.firstColWidthParams={minWidth:264,defaultWidth:288},Hn.otherColWidthParams={minWidth:88,defaultWidth:180},Hn.searchTextEntered="",Hn.aggregateRowData={},Hn.elementToFocus="",Hn.expandedRowGroups=[],Hn.searchActive=!1;var Gn=et.palette.neutralSecondary,Wn=((Un={})["& .inputFieldDiv"]={flexGrow:1,width:"100%"},Un["& .fieldControlDiv"]={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",flexGrow:8,flexBasis:"0%",margin:"10px 0 12px 0"},Un),jn=u.mergeStyles(Pe({width:134},Wn)),Xn=u.mergeStyles(Pe({},Wn)),Kn=u.mergeStyles({display:"flex"}),qn=u.mergeStyles({fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"16px",color:Gn,fontWeight:600}),Zn=u.mergeStyles({fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"20px",color:Gn,marginBottom:"8px"}),Jn=function(e){function t(){var t;return(t=e.apply(this,arguments)||this).isFieldLockChecked=!1,t.savedIndicatorTimeout=8e3,t.errorMessage="",t.defaultPrevented=!1,t.tooltipDetails=U.FieldDisabledReason.None,t}Me(t,e);var n=t.prototype;return n.render=function(){var e,t,n,i,r;if(!this.props.shouldRenderPlainTextInitially||null!=(e=this.state)&&e.skipPlainTextRender||this.shouldSkipPlainTextRender()){if(this.isFieldLockChecked||(this.checkIfFieldIsLocked(),this.isFieldLockChecked=!0),this.props.fieldData){var o,s,l,c,d,u,p,h,g,f,y=(null==(o=this.props.dataSetRecord)?void 0:o.notifications.has(this.props.fieldData.name))||!1,v=(null==(s=this.props.dataSetRecord)?void 0:s.notifications)&&(null==(l=this.props.dataSetRecord)?void 0:l.notifications.size)>0||!1,C=y?null==(c=this.props.dataSetRecord)?void 0:c.notifications.get(this.props.fieldData.name):"";null!=(d=this.props.dataSetRecord)&&d.errorMessage&&null!=(u=this.props.dataSetRecord)&&u.dirtyAttributes.has(this.props.fieldData.name)&&Array.from(null==(p=this.props.dataSetRecord)?void 0:p.dirtyAttributes.keys())[0]==this.props.fieldData.name&&(y=!0,C=null==(f=this.props.dataSetRecord)?void 0:f.errorMessage),this.tooltipDetails=this.getTooltipDetails(y,v,this.props.fieldData.name);var S=this.isFieldDisabled();return a.createElement("div",{className:S?"fieldDisabled fieldControlDiv":"fieldEnabled fieldControlDiv"},this.props.showLabel&&(this.props.fieldData.displayName||(null==(h=this.props.customProps)?void 0:h.displayName))&&a.createElement("div",{className:"icv-cell-field "+Kn},a.createElement("label",{className:"icv-cell-field-label } "+("parentcontactid"===this.props.fieldData.metadataId?Zn:qn)},null!=(g=this.props.customProps)&&g.displayName?this.props.customProps.displayName:this.props.fieldData.displayName),this.props.fieldData.businessRequired&&this.getRequiredLabel()),a.createElement(m.Shimmer,{customElementsGroup:Gt.getFieldShimmer(),isDataLoaded:this.props.dataSetRecord&&null!=this.props.dataSetRecord.values},this.props.dataSetRecord&&this.renderControl(C,y,v,S)))}return a.createElement("div",null)}return this.setState({skipPlainTextRender:!0}),a.createElement("div",{className:null!=(t=this.props.customProps)&&t.showQuickActions?null!=(n=this.props.customProps)&&n.shouldAddAdditionalClass?"fieldControlDivAdditional firstColumnPlainText columnPlainText":"firstColumnPlainText columnPlainText":"columnPlainText"},(null==(i=this.props.dataSetRecord)?void 0:i.formattedValues.get(null==(r=this.props.fieldData)?void 0:r.name))||"-")},n.shouldSkipPlainTextRender=function(){var e,t,n;return(null==(e=this.props.fieldData)?void 0:e.dataType)==B.EDataType.Customer||(null==(t=this.props.fieldData)?void 0:t.dataType)==B.EDataType.Lookup||(null==(n=this.props.fieldData)?void 0:n.dataType)==B.EDataType.Owner},n.getTooltipDetails=function(e,t,n){var i,r;return e||(null==(i=this.props.entityData)?void 0:i.name)!=me.Opportunity||0==(null==(r=this.props.dataSetRecord)?void 0:r.values.get(Ke.stateCode))?n.indexOf(".")>=0?U.FieldDisabledReason.LinkedField:!e&&t?U.FieldDisabledReason.ErrorInOtherField:U.FieldDisabledReason.None:U.FieldDisabledReason.ClosedOpportunity},n.renderControl=function(e,n,i,r){var o,s,l,c,d,u,p,m,h,g,f,y,v,C,S,E,b=this,w=this,D=t.fieldControlFactory.getValueControl(null==(o=this.props.fieldData)?void 0:o.dataType),T=this.props.fieldData&&(null==(s=this.props.dataSetRecord)?void 0:s.formattedValues.get(this.props.fieldData.name)),x="workspace"+(null==(l=this.props.fieldData)?void 0:l.dataType);return this.props.fieldData&&a.createElement("div",{className:null!=(c=this.props.customProps)&&c.showQuickActions?null!=(d=this.props.customProps)&&d.shouldAddAdditionalClass?"fieldControlDivAdditional firstColumnFieldValueDiv fieldValueDiv":"firstColumnFieldValueDiv fieldValueDiv":"fieldValueDiv"},a.createElement("div",{className:"inputFieldDiv "+x},a.createElement(D,{value:null==(u=this.props.dataSetRecord)?void 0:u.values.get(this.props.fieldData.name),formattedValue:T,fieldContext:this.props.fieldData,entityContext:this.props.entityData,resolver:this.props.recordContainerContext.resolver,timezoneService:this.props.recordContainerContext.timezoneService,resources:this.props.recordContainerContext.resources,getToolTipContent:this.getToolTipContent.bind(this),getToolTipProps:this.getToolTipProps.bind(this),toolTipDetails:this.tooltipDetails,ariaLabel:T?this.props.fieldData&&this.props.fieldData.displayName+" "+T:this.props.fieldData&&this.props.fieldData.displayName,onChanged:function(e){var t;w.props.fieldData&&(w.checkAndTriggerSave(e),1==(null==(t=w.state)?void 0:t.hideSuccessIndicator)&&w.setState({hideSuccessIndicator:!1}))},recordId:null==(p=this.props.dataSetRecord)?void 0:p.recordId,hasError:n,disabled:r,customTextStyles:null==(m=this.props.customProps)?void 0:m.textStyles,additionalPersonaProps:null!=(h=this.props.customProps)&&h.showAdditionalPersonaDetails?this.getPersonaProps(this.props.fieldData):void 0,openEntity:function(e,t,n){var i,r,o;Je.reportUserAction("renderControl","fieldControl","Click entity/lookup field",{field:null==(i=b.props.fieldData)?void 0:i.name},"Open entity",null==(r=b.props.fieldData)?void 0:r.name),(null==(o=b.props.callbackHandlers)?void 0:o.openEntity)&&b.props.callbackHandlers.openEntity(e,t,n)},openEmail:function(e){var t,n;Je.reportUserAction("renderControl","fieldControl","Click email field",{field:null==(t=b.props.fieldData)?void 0:t.name},"Open email",null==(n=b.props.fieldData)?void 0:n.name),b.props.recordContainerContext.navigation.openUrl("mailto:"+e)},openPhone:function(e){var t,n,i;if(Je.reportUserAction("renderControl","fieldControl","Click phone field",{field:null==(t=b.props.fieldData)?void 0:t.name},"Open phone",null==(n=b.props.fieldData)?void 0:n.name),1==(null==(i=b.props.callbackHandlers)||null==i.isChannelIntegrationFrameworkSupported?void 0:i.isChannelIntegrationFrameworkSupported())){var r,o,a={type:"InitiateCall",data:{contactNumber:e,entityRecordId:null==(r=b.props.dataSetRecord)?void 0:r.recordId,entityLogicalName:null==(o=b.props.dataSetRecordEntityMetaData)?void 0:o.name}},s=new CustomEvent("ClickToAct",{detail:a});window.dispatchEvent(s)}else b.props.recordContainerContext.navigation.openUrl("tel:"+e)},openUrl:function(e){var t,n;Je.reportUserAction("renderControl","fieldControl","Click url field",{field:null==(t=b.props.fieldData)?void 0:t.name},"Open url",null==(n=b.props.fieldData)?void 0:n.name),b.props.recordContainerContext.navigation.openUrl(e)},showQuickActions:null==(g=this.props.customProps)?void 0:g.showQuickActions,createCommands:null==(f=this.props.customProps)?void 0:f.createCommands,saveInProgress:(null==(y=this.props.dataSetRecord)?void 0:y.isSaveInProgress)&&(null==(v=this.props.dataSetRecord)?void 0:v.dirtyAttributes.has(this.props.fieldData.name)),isSaveSuccessful:!(null!=(C=this.props.dataSetRecord)&&C.isSaveInProgress)&&!n&&!i&&!(this.state&&this.state.hideSuccessIndicator)&&(null==(S=this.props.dataSetRecord)?void 0:S.attributesLastSaved)&&(null==(E=this.props.dataSetRecord)?void 0:E.attributesLastSaved.has(this.props.fieldData.name)),onErrorRender:function(){return b.renderFieldErrorElement(e)},onSaveInProgressRender:function(){return b.renderSaveInProgressElement()},onSaveSuccessRender:function(){return b.renderFieldSavedElement()}})))},n.getToolTipProps=function(){var e,t=this;switch(this.tooltipDetails){case U.FieldDisabledReason.ClosedOpportunity:var n=null==(e=this.props.dataSetRecord)?void 0:e.formattedValues.get(Ke.stateCode),i=Je.getLocalizedString("WS_FieldControl_Opportunity_Marked_Closed",n);return{onRenderContent:function(){return a.createElement("div",{style:{display:"flex",flexDirection:"column",padding:"10px",maxWidth:"150px"}},a.createElement("span",{style:{fontSize:"12px"}},i," "),a.createElement(d.ActionButton,{className:"fieldToolTipButton",text:Je.getLocalizedString("WS_FieldControl_Reopen_Opportunity"),onClick:t.reopenOpportunity.bind(t)}))}};case U.FieldDisabledReason.ErrorInOtherField:var r=Je.getLocalizedString("WS_FieldControl_Error_In_Other_Field");return{onRenderContent:function(){var e;return a.createElement("div",{style:{display:"flex",padding:"10px",maxWidth:"200px"}},a.createElement(C.Icon,{iconName:"ErrorBadge",styles:{root:{color:"#A4262C",fontSize:"18px"}}}),a.createElement("div",{style:{display:"flex",paddingLeft:"10px",flexDirection:"column"}},a.createElement("span",{style:{fontWeight:520,fontSize:"14px"}},Je.getLocalizedString("WS_FieldControl_Fix_Errors")),a.createElement("span",{style:{fontSize:"12px",paddingTop:"10px"}},r," "),a.createElement(d.ActionButton,{className:"fieldToolTipButton",text:Je.getLocalizedString("WS_FieldControl_Show_Error_Field"),onClick:Je.showErrorField.bind(t,""+(null==(e=t.props.dataSetRecord)?void 0:e.recordId)+Ke.fieldErrorClassName)})))}};default:return}},n.getToolTipContent=function(){var e;switch(this.tooltipDetails){case U.FieldDisabledReason.None:return Je.getLocalizedString("WS_Edit_Button");case U.FieldDisabledReason.LinkedField:return Je.getLocalizedString("WS_FieldControl_Linked_Field_Error");case U.FieldDisabledReason.ClosedOpportunity:var t=null==(e=this.props.dataSetRecord)?void 0:e.formattedValues.get(Ke.stateCode);return Je.getLocalizedString("WS_FieldControl_Opportunity_Marked_Closed",t);case U.FieldDisabledReason.ErrorInOtherField:return Je.getLocalizedString("WS_FieldControl_Error_In_Other_Field");default:return}},n.renderSaveInProgressElement=function(){return a.createElement("div",{className:"inputFieldSaveInProgressDiv"},a.createElement(g.TooltipHost,{content:Je.getLocalizedString("WS_FieldControl_Applying_Changes")},a.createElement(w.Spinner,{className:"saveInProgressSpinner",styles:On.getSpinnerStyles(),size:w.SpinnerSize.medium})))},n.renderFieldErrorElement=function(e){var t,n,i,r,o=this;Je.reportInfo("renderFieldErrorElement","fieldControl","Error during saving field",{field:null==(t=this.props.fieldData)?void 0:t.name,error:e},"Error saving field",null==(n=this.props.fieldData)?void 0:n.name);var s={onRenderContent:function(){return a.createElement("div",{style:{display:"flex",padding:"10px",maxWidth:"200px"}},a.createElement(C.Icon,{iconName:"ErrorBadge",styles:{root:{color:"#A4262C",fontSize:"18px"}}}),a.createElement("div",{style:{display:"flex",paddingLeft:"10px",flexDirection:"column"}},a.createElement("span",{style:{fontWeight:520,fontSize:"14px"}},Je.getLocalizedString("WS_FieldControl_Invalid_Value")),a.createElement("span",{style:{fontSize:"12px",paddingTop:"10px"}},e," "),a.createElement(d.ActionButton,{className:"fieldToolTipButton",text:Je.getLocalizedString("WS_FieldControl_Undo_Changes"),onClick:o.undoHandler.bind(o)})))}};return a.createElement("div",{className:"inputFieldErrorDiv"},a.createElement(g.TooltipHost,{tooltipProps:s,delay:0},a.createElement(d.IconButton,{tabIndex:0,iconProps:{iconName:"ErrorBadge"},className:Ke.fieldErrorClassName+" "+(null==(i=this.props.dataSetRecord)?void 0:i.recordId)+Ke.fieldErrorClassName+" "+(null==(r=this.props.fieldData)?void 0:r.name)+Ke.fieldErrorClassName,styles:On.getErrorButtonStyle(),ariaLabel:e})))},n.reopenOpportunity=function(){var e,t,n=this;Je.reportUserAction("reopenOpportunity","fieldControl","Click reopen of opportunity from tooltip",{},"Reopen opportunity",""),Hn.showLoadingOverlay();var i=new Map;i.set(Ke.stateCode,0),i.set(Ke.statusCode,-1),this.props.dataSetRecord&&this.props.recordContainerContext.dataProvider.updateRecord(null==(e=this.props.entityData)?void 0:e.name,null==(t=this.props.dataSetRecord)?void 0:t.recordId,i).then((function(){var e;null==(e=n.props.dataSetRecord)||e.refresh()})).catch((function(e){Je.reportError("reopenOpportunity","fieldControl","Error occured while reopening opportunity",{error:e.toString()})}))},n.undoHandler=function(){var e,t,n,i,r;Je.reportUserAction("undoHandler","fieldControl","Undo editing of a field",{field:null==(e=this.props.fieldData)?void 0:e.name},"Undo edit",null==(t=this.props.fieldData)?void 0:t.name);var o=Object.assign({},this.props.dataSetRecord);if(null!=(n=this.props.fieldData)&&n.name&&null!=(i=this.props.dataSetRecord)&&i.dirtyAttributes.has(null==(r=this.props.fieldData)?void 0:r.name)){var a,s,l,c,d,u,p,m,h,g,f=null==(a=o.dirtyAttributes.get(null==(s=this.props.fieldData)?void 0:s.name))?void 0:a.prevValue,y=null==(l=o.dirtyAttributes.get(null==(c=this.props.fieldData)?void 0:c.name))?void 0:l.prevFormattedValue;o.attributesLastSaved.clear(),o.dirtyAttributes.delete(null==(d=this.props.fieldData)?void 0:d.name),o.isDirty=o.dirtyAttributes.size>0,o.notifications.delete(null==(u=this.props.fieldData)?void 0:u.name),o.isValid.set(null==(p=this.props.fieldData)?void 0:p.name,!0),o.values.set(null==(m=this.props.fieldData)?void 0:m.name,f),o.formattedValues.set(null==(h=this.props.fieldData)?void 0:h.name,y),null==(g=this.props.callbackHandlers)||null==g.updateRecord||g.updateRecord(o)}},n.renderFieldSavedElement=function(){var e=this;return setTimeout((function(){e.setState({hideSuccessIndicator:!0})}),this.savedIndicatorTimeout),a.createElement("div",{className:"inputFieldSavedDiv"},a.createElement(d.IconButton,{tabIndex:0,iconProps:{iconName:"Completed"},className:"fieldSavedIconStyle",styles:On.getSavedButtonStyle()}))},n.isFieldDisabled=function(){var e,t,n;return(null==(e=this.props.fieldData)?void 0:e.dataType)==B.EDataType.State||(null==(t=this.props.fieldData)?void 0:t.dataType)==B.EDataType.Status||this.state&&this.state.isLocked||(null==(n=this.props.dataSetRecord)?void 0:n.isSaveInProgress)||this.props.fieldData&&this.isDisabled(this.props.fieldData)},n.isDisabled=function(e){var t,n,i;if(this.tooltipDetails!=U.FieldDisabledReason.None)return!1;var r=null==(t=this.props.dataSetRecord)?void 0:t.isRecordActive,o=null==(n=this.props.dataSetRecord)?void 0:n.isReadOnly.get(e.name),a=null==(i=this.props.customProps)?void 0:i.isDisabled;return!(r&&!o&&(e.sourceType===B.AttributeSourceType.Persistent||null==e.sourceType)&&!a)},n.checkIfFieldIsLocked=function(){var e=this;this.props.fieldData&&!this.isDisabled(this.props.fieldData)&&this.props.isEditable&&this.props.isEditable.then((function(t){0==t&&e.setState({isLocked:!0})}))},n.getPersonaProps=function(e){var t,n;return e&&e.name.indexOf("contact")>-1?{cdsDataClient:null==(t=this.props.recordContainerContext)?void 0:t.dataProvider,keyForSecondaryText:"jobtitle"}:(null==e?void 0:e.dataType)===B.EDataType.Owner?{cdsDataClient:null==(n=this.props.recordContainerContext)?void 0:n.dataProvider,keyForSecondaryText:"title"}:void 0},n.checkAndTriggerSave=function(e){if(this.props.fieldData){var t,n=null==(t=this.props.dataSetRecord)?void 0:t.values.get(this.props.fieldData.name);if(n==e)return;this.errorMessage="";var i=Vn.getSaveHandler(),r=Vn.getChangeHandler();if(i||r){var o,a=JSON.parse(JSON.stringify(this.props.dataSetRecord));a.values=new Map,a.values.set(this.props.fieldData.name,e),a.isDirty=!0,a.dirtyAttributes=new Map,a.dirtyAttributes.set(this.props.fieldData.name,{prevValue:n,prevFormattedValue:null==(o=this.props.dataSetRecord)?void 0:o.formattedValues.get(this.props.fieldData.name)});var s=this.getExecutionContext(a);try{s&&r&&(r(s),Je.reportUserAction("checkAndTriggerSave","fieldControl","executed onchangehandler",{},"autosave",this.props.fieldData.name)),v.StringUtil.IsNullOrEmpty(this.errorMessage)&&s&&i&&(i(s),Je.reportUserAction("checkAndTriggerSave","fieldControl","executed onsavehandler",{},"autosave",this.props.fieldData.name))}catch(e){this.errorMessage=Je.getLocalizedString("WS_FieldControl_Scripting_Unhandled_Error"),Je.reportError("checkAndTriggerSave","fieldControl","Unhandled exception while executing onChangeHandler or onSaveHandler",{error:e},"autosave")}if(v.StringUtil.IsNullOrEmpty(this.errorMessage)){var l,c;null==(l=this.props.dataSetRecord)||l.setValue(this.props.fieldData.name,e),null==(c=this.props.dataSetRecord)||c.save()}else{var d,u,p,m,h,g,f,y;null==(d=this.props.dataSetRecord)||d.values.set(this.props.fieldData.name,e),this.props.dataSetRecord&&(this.props.dataSetRecord.isDirty=!0,null!=(g=this.props.dataSetRecord)&&g.dirtyAttributes.has(this.props.fieldData.name)||null==(f=this.props.dataSetRecord)||f.dirtyAttributes.set(this.props.fieldData.name,{prevValue:n,prevFormattedValue:null==(y=this.props.dataSetRecord)?void 0:y.formattedValues.get(this.props.fieldData.name)})),null==(u=this.props.dataSetRecord)||u.notifications.set(this.props.fieldData.name,this.errorMessage),null==(p=this.props.dataSetRecord)||p.isValid.set(this.props.fieldData.name,!1),null==(m=this.props.dataSetRecord)||m.formattedValues.set(this.props.fieldData.name,e);var C=Object.assign({},this.props.dataSetRecord);null==(h=this.props.callbackHandlers)||null==h.updateRecord||h.updateRecord(C)}}else{var S,E;Je.reportUserAction("checkAndTriggerSave","fieldControl","User edited the field",{field:this.props.fieldData.name},"User edit",this.props.fieldData.name),null==(S=this.props.dataSetRecord)||S.setValue(this.props.fieldData.name,e),null==(E=this.props.dataSetRecord)||E.save()}}},n.getExecutionContext=function(e){if(this.props.attributesMetadata&&this.props.columns&&this.props.entityData&&this.props.webAPI&&Vn.hasClientEventHandlers()){var t=new G.ExecutionContextInputMetadata(this.props.entityData,this.props.attributesMetadata,this.props.columns,this.props.webAPI);return G.ExecutionContextHelper.getExecutionContext(t,this.getRecordClientApi(),e,void 0,this.getEventArgs())}},n.getRecordClientApi=function(){var e=this;return{setNotification:function(t,n){t&&null!=n&&(e.errorMessage=n,Je.reportUserAction("setNotification","fieldControl","RecordClientApi.setNotification called",{},"scriptAction",t))},getNotification:function(t){var n;return null==(n=e.props.dataSetRecord)?void 0:n.notifications.get(t)},getDisabled:function(t){var n;return(null==(n=e.props.dataSetRecord)?void 0:n.isReadOnly.get(t))||!0},setDisabled:function(e){Je.reportUserAction("setDisabled","fieldControl","Ignored RecordClientApi.setDisabled attempted during save or update.",{},"scriptAction",e)}}},n.getEventArgs=function(){var e=this,t=this;return{isDefaultPrevented:function(){return e.defaultPrevented},preventDefault:function(){var e;t.errorMessage=Je.getLocalizedString("WS_FieldControl_Prevent_Default"),t.defaultPrevented=!0,Je.reportUserAction("preventDefault","fieldControl","PreventDefaultEventArguments.preventDefault called.",{},"preventDefault",(null==(e=t.props.fieldData)?void 0:e.name)||"")}}},n.getRequiredLabel=function(){return a.createElement(R.Label,{styles:{root:{color:"red",padding:"0 0 0 4px"}}},"*")},t}(a.Component);Jn.fieldControlFactory=new H.FieldControlsFactory;var Qn={INVALID_DATA_TYPE:"The attribute value is not of desired data type.",ATTRIBUTE_BUSINESS_REQUIRED:"This attribute is business required.",ATTRIBUTE_MAXIMUM_LENGTH_EXCEEDED:"The attribute value exceeded the maximum allowed length of {0} characters.",ATTRIBUTE_VALUE_OUT_OF_RANGE:"The attribute value must be between {0} and {1}",UNEXPECTED_ERROR:"Unexpected Error",LOADING_RESULTS:"loading results",NO_RESULTS_FOUND:"no results found",OPTIONSET_SELECT:"--Select--",TOTAL_RECORDS_COUNT:"{0}/{1}",ERROR_LOADING_CONTROL:"Error Loading Control",AGGREGATION_LIMIT_EXCEEDED_TOTAL_RECORDS_COUNT:"{0}+",CARD_DIV_ARIA_LABEL:"Draggable item. Press space bar to lift",REMOVE:"Remove"},Yn=function(){function e(e){this.resourceContext=e}return e.prototype.getLocalizedString=function(e){var t,n=this.resourceContext.getString(e);return n!==e&&null!=n||(n=Qn[t=e]?Qn[t]:t),n},e}(),$n=function(){};$n.EntityName="transactioncurrency",$n.CurrencyNameAttribute="currencyname",$n.CurrencySymbolAttribute="currencysymbol",$n.CurrencyPrecisionAttribute="currencyprecision",$n.IsoCurrencyCodeAttribute="isocurrencycode",$n.ExchangeRateAttribute="exchangerate";var ei=function(){function e(e){this.dataClient=e,this.attributesToBeRetrieved=[$n.CurrencyNameAttribute,$n.CurrencySymbolAttribute,$n.CurrencyPrecisionAttribute,$n.IsoCurrencyCodeAttribute,$n.ExchangeRateAttribute],this.transactionCurrenciesMap=new Map}var t=e.prototype;return t.getTransactionCurrency=function(){var e=Fe(He.mark((function e(t){return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Y.Validations.validateStringArgument(t,"id"),this.transactionCurrenciesMap.has(t)||this.transactionCurrenciesMap.set(t,this.retrieveTransactionCurrencyFromServer(t)),e.next=4,this.transactionCurrenciesMap.get(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.retrieveTransactionCurrencyFromServer=function(){var e=Fe(He.mark((function e(t){return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataClient.retrieveRecord($n.EntityName,t,this.attributesToBeRetrieved);case 2:return e.abrupt("return",this.buildTransactionCurrencyObject(t,e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.buildTransactionCurrencyObject=function(e,t){return{transactionCurrencyId:e,currencyName:t.values.get($n.CurrencyNameAttribute),currencySymbol:t.values.get($n.CurrencySymbolAttribute),currencyPrecision:t.values.get($n.CurrencyPrecisionAttribute),currencyCode:t.values.get($n.IsoCurrencyCodeAttribute),exchangeRate:t.values.get($n.ExchangeRateAttribute)}},e}(),ti=function(){function e(e,t){this.formatting=e,this.client=t}var t=e.prototype;return t.utcToBrowserTimeZone=function(e){return e?new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()):e},t.browserTimeZoneToUtc=function(e){return e?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())):e},t.utcToUserLocal=function(e){return e?new Date(e.getTime()+6e4*(this.getUserTimeZoneUtcOffset(e)+e.getTimezoneOffset())):e},t.userLocalToUtc=function(e){return e?new Date(e.getTime()-6e4*(this.getUserTimeZoneUtcOffset(e)+e.getTimezoneOffset())):e},t.formatTime=function(e,t){return this.formatting.formatTime(e,t)},t.formatDateShort=function(e,t){return this.formatting.formatDateShort(e)},t.getUserTimeZoneUtcOffset=function(e){return this.client.getUserTimeZoneUtcOffset(e)},e}(),ni=function(){function e(){}return e.getContainerContext=function(e){var t={formatting:e.formatting,webAPI:e.webAPI,controlUtilities:e.utils,navigation:e.navigation,resources:e.resources,telemetryLogger:e.reporting,page:e.page,client:e.client,hostIdentifier:"PipelineManager"};Y.Validations.validateNullArgument(t,"hostContext");var n=z.Guid.newGuid(),i=new $.TelemetryLogger(t.telemetryLogger,n,t.hostIdentifier),r=new te.CDSMetadataClient(t.controlUtilities,i),o=new ee.CDSDataClient(r,t.webAPI,t.page,i),a=new Yn(t.resources),s=new ne.AttributeValueFormatter(t.formatting),l=new ie.AttributeValueValidator(a),c=new re.AttributeValueComparator,d=new ei(o),u=new oe.DataSetRecordProvider(s,l,c,o,d,i);return{metadataProvider:r,resolver:t.lookupResolver?t.lookupResolver:new ae.LookupResolver(r,i),timezoneService:new ti(t.formatting,t.client),datasetRecordProvider:u,dataProvider:o,resources:a,navigation:t.navigation}},e.getDataverseAccess=function(){var e=n(8540).create({baseURL:document.location.origin}),t=le.createCDSClientWithHttpClient(e);return{axiosInstance:e,cdsResolver:new se.CDSResolver(t)}},e}();function ii(e){switch(e){case 0:return"and";case 1:return"or"}throw"invalid filter operator: "+e.toString()}function ri(e){switch(e){case 0:return"eq";case 1:return"ne";case 2:return"gt";case 3:return"lt";case 4:return"ge";case 5:return"le";case 6:return"like";case 7:return"not-like";case 8:return"in";case 9:return"not-in";case 10:return"between";case 11:return"not-between";case 12:return"null";case 13:return"not-null";case 14:return"yesterday";case 15:return"today";case 16:return"tomorrow";case 17:return"last-seven-days";case 18:return"next-seven-days";case 19:return"last-week";case 20:return"this-week";case 21:return"next-week";case 22:return"last-month";case 23:return"this-month";case 24:return"next-month";case 25:return"on";case 26:return"on-or-before";case 27:return"on-or-after";case 28:return"last-year";case 29:return"this-year";case 30:return"next-year";case 31:return"last-x-hours";case 32:return"next-x-hours";case 33:return"last-x-days";case 34:return"next-x-days";case 35:return"last-x-weeks";case 36:return"next-x-weeks";case 37:return"last-x-months";case 38:return"next-x-months";case 39:return"last-x-years";case 40:return"next-x-years";case 41:return"eq-userid";case 42:return"ne-userid";case 43:return"eq-businessid";case 44:return"ne-businessid";case 49:return"contain-values";case 51:return"eq-userlanguage";case 53:return"olderthan-x-months";case 54:return"begins-with";case 55:return"not-begin-with";case 56:return"ends-with";case 57:return"not-end-with";case 58:return"this-fiscal-year";case 59:return"this-fiscal-period";case 60:return"next-fiscal-year";case 61:return"next-fiscal-period";case 62:return"last-fiscal-year";case 63:return"last-fiscal-period";case 64:return"last-x-fiscal-years";case 65:return"last-x-fiscal-periods";case 66:return"next-x-fiscal-years";case 67:return"next-x-fiscal-periods";case 68:return"in-fiscal-year";case 69:return"in-fiscal-period";case 70:return"in-fiscal-period-and-year";case 71:return"in-or-before-fiscal-period-and-year";case 72:return"in-or-after-fiscal-period-and-year";case 73:return"eq-userteams";case 74:return"eq-useroruserteams";case 75:return"above";case 76:return"under";case 77:return"not-under";case 78:return"eq-or-above";case 79:return"eq-or-under";case 80:return"eq-useroruserhierarchy";case 81:return"eq-useroruserhierarchyandteams";case 82:return"olderthan-x-years";case 83:return"olderthan-x-weeks";case 84:return"olderthan-x-days";case 85:return"olderthan-x-hours";case 86:return"olderthan-x-minutes";case 87:return"contain-values";case 88:return"not-contain-values"}throw"invalid condition operator: "+e.toString()}r.registerIcons(Ae);var oi,ai,si,li=function(){function e(){}return e.getRequiredAttributes=function(e){switch(e){case me.Opportunity:return["opportunityid","statecode"];case me.Account:return["accountid","statecode"];case me.Contact:return["contactid","statecode"];case me.Lead:return["leadid","statecode"];default:return[]}},e.createDatasetForFieldFactory=function(e,t,n,i,r,o){var a=r.datasetRecordProvider,s=[];return e.records&&Object.values(e.records).forEach((function(e){var r=new Map,l=new Map;t.forEach((function(t){var n=i.get(t),o=ce.CDSResponseParser.getAttributeValue(t,n,null,e.getValue(t),e.getFormattedValue(t));null!=o?(r.set(t,o[0]),l.set(t,o[1])):(r.set(t,null),l.set(t,null))}));var c={values:r,formattedValues:l,recordId:e.getRecordId()},d=a.buildDataSetRecord(n,i,c,o);s.push(d)})),s},e.getColumnsFromAttributeMetadata=function(e){var t=[];return e&&e.forEach((function(e){t.push(e.name)})),t},e.getColumnInfoCacheKey=function(e){return e+"columnsInfo_v2"},e.getResetColumnInfoCacheKey=function(e){return e+"reset_columnsInfo_v2"},e.getAggregateFetchXml=function(e,t,n,i,r){return encodeURIComponent("<fetch distinct='false' mapping='logical' aggregate='true'><entity name='"+e+"'><attribute name='"+n+"' alias='"+i+"' aggregate='"+t+"' />"+r+"</entity></fetch>")},e.getUnEncodedAggregateFetchXml=function(e,t,n,i,r){return"<fetch distinct='false' mapping='logical' aggregate='true'><entity name='"+e+"'><attribute name='"+n+"' alias='"+i+"' aggregate='"+t+"' />"+r+"</entity></fetch>"},e.getAggregateFetchXmlWithLinkedEntity=function(e,t,n,i,r,o,a){return encodeURIComponent("<fetch distinct='false' mapping='logical' aggregate='true'><entity name='"+e+"'><link-entity name='"+t+"' from=\""+n+'" to="'+n+"\"><attribute name='"+r+"' alias='"+o+"' aggregate='"+i+"' /></link-entity>"+a+"</entity></fetch>")},e.isNumericField=function(e){return e===B.EDataType.WholeNumber||e===B.EDataType.Decimal||e===B.EDataType.Float||e===B.EDataType.Currency},e.getCustomHeaderClassName=function(e){var t=null==e?void 0:e.replace(".","-");return Ke.customHeaderClassNamePrefix+t},e}(),ci=function(e){var t=e.attributesMetadata,n=e.cell,i=e.context,r=e.datasetRecord,a=e.entityMetadata,s=e.recordContainerContext,l=e.viewEventHandlers,c=e.services,d=n.datafieldName,u=n.labelDescription,p=n.showLabel,m=o.useCallback((function(e,t){t===me.Account||t===me.Contact||t===me.Lead||t===me.Opportunity?null==l||null==l.onOpenView||l.onOpenView({entityId:e,entityType:t},ve.Default):Je.openEntityInMFD(t.toString().toLowerCase(),e,(function(){mn.reload()}))}),[l]),h=null==t?void 0:t.get(d);return o.createElement("div",{className:"icv-section-row-cell "+jn},o.createElement(Jn,{recordContainerContext:s||ni.getContainerContext(i),entityData:a,fieldData:h,dataSetRecordEntityMetaData:a,dataSetRecord:r,showLabel:p,customProps:{displayName:u,textStyles:On.getFieldTextStyle(null==h?void 0:h.dataType),showAdditionalPersonaDetails:!0},callbackHandlers:{openEntity:m,updateRecord:function(e){return null==l||null==l.updateRecord?void 0:l.updateRecord(e)},isChannelIntegrationFrameworkSupported:function(){return Je.isChannelIntegrationFrameworkSupported()}},attributesMetadata:t,columns:li.getColumnsFromAttributeMetadata(t),webAPI:i.webAPI,dataService:c.dataService}))},di=u.mergeStyles({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between"}),ui=function(e){function t(t){return e.call(this,t)||this}return Me(t,e),t.prototype.render=function(){var e=this;return a.createElement("div",{className:"icv-section-row "+di},this.props.row.cells&&this.props.row.cells.map((function(t){var n=Pe({},e.props,{cell:t});return a.createElement(ci,Object.assign({},n,{key:n.cell.datafieldName}))})))},t}(a.Component),pi=u.mergeStyles({margin:"0 20px"}),mi=function(e){function t(t){return e.call(this,t)||this}Me(t,e);var n=t.prototype;return n.render=function(){var e=this;Je.reportInfo("render","SectionView","",{section:this.props.section.key.toLowerCase(),layout:this.props.fixedColumnLayout});var t=this.props.section.rows;return this.props.fixedColumnLayout>0&&(t=this.filterRows(this.props.fixedColumnLayout)),a.createElement("div",{className:"icv-section-rows "+pi},t.map((function(t){var n=Pe({},e.props,{row:t});return a.createElement(ui,Object.assign({},n)," ")})))},n.filterRows=function(e){var t,n=[];null==(t=this.props.section.rows)||t.map((function(e){var t;null==(t=e.cells)||t.map((function(e){n.push(e)}))})),Je.reportInfo("render","SectionView","Filtered",{section:this.props.section.key.toLowerCase(),layout:this.props.fixedColumnLayout,cellCount:n.length});for(var i=[],r=0;r<n.length;r+=e){for(var o={cells:[]},a=r;a<r+e&&a<n.length;a++)o.cells.push(n[a]);i.push(o)}return i},t}(a.Component),hi=function(e){var t,n,i=e.attributesMetadata,r=e.context,o=e.datasetRecord,s=e.entityMetadata,l=e.recordContainerContext,c=e.viewEventHandlers,d=e.services;a.useEffect((function(){Je.reportInfo("render","SectionView","",{section:e.section.key.toLowerCase(),layout:e.fixedColumnLayout})}));var u=e.section.rows;e.fixedColumnLayout>0&&(u=function(t){var n,i=[];null==(n=e.section.rows)||n.map((function(e){var t;null==(t=e.cells)||t.map((function(e){i.push(e)}))})),Je.reportInfo("render","SectionView","Filtered",{section:e.section.key.toLowerCase(),layout:e.fixedColumnLayout,cellCount:i.length});for(var r=[],o=0;o<i.length;o+=t){for(var a={cells:[]},s=o;s<o+t&&s<i.length;s++)a.cells.push(i[s]);r.push(a)}return r}(e.fixedColumnLayout));var p=(null==(t=u)?void 0:t[0])||null,m=(null==p||null==(n=p.cells)?void 0:n[0])||null,h=m.datafieldName,g=m.labelDescription,f=m.showLabel,y=a.useCallback((function(e,t){t===me.Account||t===me.Contact||t===me.Lead||t===me.Opportunity?null==c||null==c.onOpenView||c.onOpenView({entityId:e,entityType:t},ve.Default):Je.openEntityInMFD(t.toString().toLowerCase(),e,(function(){mn.reload()}))}),[c]),v=null==i?void 0:i.get(h);return a.createElement("div",{className:"icv-section-rows "+pi},a.createElement("div",{className:"icv-section-row "+di},a.createElement("div",{className:"icv-section-row-cell "+Xn},a.createElement(Jn,{recordContainerContext:l||ni.getContainerContext(r),entityData:s,fieldData:v,dataSetRecordEntityMetaData:s,dataSetRecord:o,showLabel:f,customProps:{displayName:g,textStyles:On.getFieldTextStyle(null==v?void 0:v.dataType),showAdditionalPersonaDetails:!0},callbackHandlers:{openEntity:y,updateRecord:function(e){return null==c||null==c.updateRecord?void 0:c.updateRecord(e)},isChannelIntegrationFrameworkSupported:function(){return Je.isChannelIntegrationFrameworkSupported()}},attributesMetadata:i,columns:li.getColumnsFromAttributeMetadata(i),webAPI:r.webAPI,dataService:d.dataService}))))},gi=et.palette.neutralSecondary,fi=u.mergeStyles({display:"flex",flexDirection:"column"}),yi=u.mergeStyles({fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"16px",color:gi,margin:"6px 0 0 0",textAlign:"center"}),vi=u.mergeStyles({margin:"0 20px"}),Ci=function(e){function t(t){var n,i;return(i=e.call(this,t)||this).state={noteList:(null==(n=i.props.notes)?void 0:n.noteList)||[]},i.props.notes&&(null==i.props.registerCommands||i.props.registerCommands([{toolTipContent:Je.getLocalizedString("Notes_Add_a_Note"),ariaLabel:Je.getLocalizedString("Notes_Add_a_Note"),iconProps:Ue.add,commandAction:function(){Oe(i).openAddNote(Ke.addNoteCommand)},style:{color:ct.digitalBlue},commandId:Ke.addNoteCommand}])),i}Me(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){this.props.notes&&e.notes&&this.props.notes.noteList.length!==e.notes.noteList.length&&this.setState({noteList:this.props.notes.noteList})},n.render=function(){return Je.reportInfo("render","SectionNotesView","",{notesCount:this.state.noteList.length}),this.state.noteList.length>0?a.createElement("div",{className:"icv-section-notes "+fi},a.createElement(Ln,Object.assign({},Pe({},this.props,{note:this.state.noteList[0],deleteNoteHandler:this.handleDeleteNote.bind(this)}))),this.state.noteList.length>1&&this.getShowMoreButton()):a.createElement("div",{className:"notes-section-nocontent-label "+yi},Je.getLocalizedString("Notes_NoRecordFound"))},n.getShowMoreButton=function(){return a.createElement(O.ActionButton,{className:"icv-showmore-button "+vi,styles:{rootHovered:{color:ct.digitalBlue}},onClick:this.openNotesView.bind(this)},Je.getLocalizedString("ICV_ShowMoreNotes"))},n.handleDeleteNote=function(e){var t;e?this.setState({noteList:this.state.noteList.filter((function(t){return t.annotationid!==e}))}):null==(t=this.props.viewEventHandlers)||null==t.setErrorMessage||t.setErrorMessage(Je.getLocalizedString("Notes_ErrorMessage_Delete_Note"))},n.openAddNote=function(e){var t;null==(t=this.props.viewEventHandlers)||null==t.onOpenView||t.onOpenView({entityId:"",entityType:me.Note},ve.Create,this.props.relatedEntity||this.props.entity,null,e)},n.openNotesView=function(){var e;Je.reportUserAction("openNotesView","SectionNotesView","Show more notes clicked",{},Ye.CLICK,"Show more notes button"),null==(e=this.props.viewEventHandlers)||null==e.onOpenView||e.onOpenView({entityId:"",entityType:me.Note},ve.List,this.props.relatedEntity||this.props.entity)},t}(a.Component),Si=u.mergeStyles({fontFamily:"Segoe UI",fontSize:"12px",textAlign:"center",lineHeight:"16px",color:et.palette.neutralSecondary}),Ei=u.mergeStyles({display:"flex",margin:"8px 0px 32px 0",justifyContent:"center"}),bi=function(e,t){switch(t.type){case"createdRecentList":var n=qt.filterTasksByState(t.allTasks).inProgTaskList;return{recentTaskList:t.recentTaskList,showMoreVisible:n.length>3};case"addNewInProgressTask":t.allTasks.unshift(t.itemToAdd);var i=qt.filterTasksByState(t.allTasks).inProgTaskList,r=Object.assign([],e.recentTaskList);return r.length>=3&&r.pop(),{recentTaskList:[t.itemToAdd].concat(r),showMoreVisible:i.length>3};case"deleteTask":return Pe({},e,{recentTaskList:e.recentTaskList.filter((function(e){return e.key!==t.itemToDelete.key}))});case"moveToCompleted":var o=Object.assign([],e.recentTaskList);o=o.filter((function(e){return e.key!=t.completedTask.key}));var a=qt.filterTasksByState(t.allTasks).inProgTaskList;return a.length>o.length&&o.push(a[o.length]),{recentTaskList:o,showMoreVisible:a.length>3}}},wi=function(e){var t=o.useReducer(bi,{recentTaskList:[],showMoreVisible:!1}),n=t[0],i=t[1],r=o.useState(""),a=r[0],s=r[1];o.useEffect((function(){var t,n;Je.reportInfo("render","sectionTasksView","",{}),null==e.registerCommands||e.registerCommands([{toolTipContent:Je.getLocalizedString("Tasks_Add_A_Task"),ariaLabel:Je.getLocalizedString("Tasks_Add_A_Task"),iconProps:Ue.add,commandAction:l,style:{color:ct.digitalBlue}}]);var r=(null==(t=e.tasks)?void 0:t.taskList)||[],o=qt.filterTasksByState(r).inProgTaskList.slice(0,3);i({type:"createdRecentList",allTasks:r,recentTaskList:o}),s((null==(n=e.tasks)?void 0:n.recordType)||"")}),[e.tasks]);var l=function(){if(e.isInlineAddTaskEnabled){var t,n=(null==(t=e.tasks)?void 0:t.taskList)||[];i({type:"addNewInProgressTask",itemToAdd:{key:z.Guid.newGuid(),owner:"",subject:"",statecode:ye.Open,description:"",dueDate:void 0,friendlyDueDate:void 0,duration:void 0,prioritycode:fe.Normal,isTemporaryObject:!0},allTasks:n})}else qt.OpenQuickCreateTask(e.context,e.services.dataService,e.tasks.recordId,a,e.entity.entityType).then((function(t){var n;t&&i({type:"addNewInProgressTask",allTasks:null==(n=e.tasks)?void 0:n.taskList,itemToAdd:t})}))},c=o.useCallback((function(){var t;Je.reportUserAction("openTasksView","sectionTasksView","Show more tasks clicked",{},Ye.CLICK,"Show more tasks button"),null==(t=e.viewEventHandlers)||null==t.onOpenView||t.onOpenView({entityId:"",entityType:me.Task},ve.List,e.relatedEntity||e.entity,e.tasks)}),[]),d=o.useCallback((function(t,n){n&&i({type:"moveToCompleted",allTasks:e.tasks.taskList,completedTask:t})}),[]),u=o.useCallback((function(t){var n;i({type:"deleteTask",itemToDelete:t,allTasks:null==(n=e.tasks)?void 0:n.taskList}),t.isTemporaryObject||e.onTaskAdded(null)}),[e.onTaskAdded]),p=o.useCallback((function(){Je.reportUserAction("onTaskAdded","sectionTasksView","task add Completed",{},Ye.CLICK,"Add task"),e.onTaskAdded(null)}),[e.onTaskAdded]),m=o.useCallback((function(){e.onTaskAdded(null)}),[e.onTaskAdded]);return o.createElement(o.Fragment,null,n.recentTaskList.length>0?o.createElement("div",null,n.recentTaskList.map((function(t){return o.createElement("div",{key:t.key},o.createElement(Fn,Object.assign({},e,{dataService:e.services.dataService,task:t,onTaskStateChanged:d,onTaskDeleted:u,onTaskCreated:p,onTaskUpdated:m,relatedEntity:e.relatedEntity||e.entity})))})),n.showMoreVisible&&o.createElement(O.ActionButton,{className:"icv-showmore-button",styles:{rootHovered:{color:ct.digitalBlue}},onClick:c},Je.getLocalizedString("Tasks_ShowMore"))):o.createElement("div",{className:Ei},o.createElement("label",{className:Si},Je.getLocalizedString("Tasks_EmptyList"))))},Di=function(e){return a.createElement("div",null,a.createElement(O.ActionButton,{className:"icv-showmore-button",styles:{rootHovered:{color:ct.digitalBlue}},onClick:function(){var t;null==(t=e.viewEventHandlers)||null==t.onOpenView||t.onOpenView({entityId:"",entityType:me.Chat},ve.Chat,e.relatedEntity||e.entity)}},Je.getLocalizedString("Chat_Show_More_Button")))},Ti=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={showDialog:!1,actionInProgress:!1},n}return Me(t,e),t.prototype.render=function(){var e,t,n,i,r,o,s=this;return a.createElement("div",null,a.createElement(xe.Persona,{title:null==(e=this.props.personaCardProps)?void 0:e.text,text:null==(t=this.props.personaCardProps)?void 0:t.text,secondaryText:null==(n=this.props.personaCardProps)?void 0:n.secondaryText,onRenderSecondaryText:null==(i=this.props.personaCardProps)?void 0:i.onRenderSecondaryText,showInitialsUntilImageLoads:!0,size:ke.PersonaSize.size32,className:null==(r=this.props.personaCardProps)?void 0:r.className,onRenderPersonaCoin:null==(o=this.props.personaCardProps)?void 0:o.onRenderPersonaCoin,imageAlt:Je.getLocalizedString("ICV_Persona_Icon"),onClick:function(){var e,t,n;(null==(e=s.props.viewEventHandlers)?void 0:e.onOpenView)&&(null==(t=s.props.personaCardProps)?void 0:t.entityId)&&(null==(n=s.props.personaCardProps)?void 0:n.entityType)&&s.props.viewEventHandlers.onOpenView({entityId:s.props.personaCardProps.entityId,entityType:s.props.personaCardProps.entityType},ve.Default)}}))},t}(a.Component),xi=function(e){function t(t){return e.call(this,t)||this}Me(t,e);var n=t.prototype;return n.render=function(){var e=this;return Je.reportInfo("render","SectionRecentOpportunitiesView","",{recentOpportunitiesCount:this.props.recentOpportunities.length}),a.createElement("div",null,this.props.recentOpportunities.length>0?this.props.recentOpportunities.map((function(t){return a.createElement(Ti,Object.assign({},Pe({},e.props,{personaCardProps:{text:t.name,className:"recentOptyPersonaCard",onRenderPersonaCoin:e.onRenderPersonaCoin,onRenderSecondaryText:e.onRenderSecondaryText.bind(e,t["estimatedvalue@OData.Community.Display.V1.FormattedValue"],t["statecode@OData.Community.Display.V1.FormattedValue"]),entityId:t.opportunityid,entityType:me.Opportunity}})))})):a.createElement("div",{className:"recentopportunities-section-nocontent-label"},Je.getLocalizedString("RecentOpportunities_NoRecordFound")))},n.onRenderPersonaCoin=function(){return a.createElement("div",{className:"recentOptyPersonaCardCoinIconDiv"},a.createElement(_e.Icon,{iconName:"DocumentSet",className:"recentOptyPersonaCardCoinIcon"}))},n.onRenderSecondaryText=function(e,t){return e&&t?a.createElement("div",null,e,a.createElement(_e.Icon,{iconName:"LocationDot",className:"recentOptyPersonaCardSecondaryTextIcon"}),t):e||t?a.createElement("div",null," ",e||t):a.createElement("div",null)},t}(a.Component),ki=function(e){var t=e.task,n=e.services,i=e.relatedEntity,r=e.viewEventHandlers,s=o.useState(!0),l=s[0],c=s[1],u=o.useState(!1),m=u[0],h=u[1],g=o.useState(e.task.subject),f=g[0],y=g[1],v=o.useState(),C=v[0],S=v[1],E=o.useState(),b=E[0],w=E[1],D=["ownerid","scheduledend","prioritycode"];return o.useEffect((function(){e.recordContainerContext&&e.recordContainerContext.metadataProvider.getEntityMetadata("task",D).then((function(e){S(e),w({recordId:z.Guid.newGuid(),isDirty:!1,isRecordValid:!0,isRecordActive:!0,isValid:new Map([["ownerid",!0]]),notifications:new Map,values:new Map([["ownerid",null],["scheduledend",null],["prioritycode",null]]),formattedValues:new Map([["ownerid",""],["scheduledend",""],["prioritycode",""]]),isReadOnly:new Map([["ownerid",!1],["scheduledend",!1],["prioritycode",!1]]),dirtyAttributes:new Map,attributesLastSaved:new Map,setValue:function(e,t){b&&b.values.set(e,t),w(b)},save:function(){},refresh:function(){}})}))}),[]),m?a.createElement(Dn,{spinnerSize:2,loadingMessage:Je.getLocalizedString("InContextView_Saving")}):a.createElement("div",{className:"task-editview-container"},a.createElement("div",{className:"task-editview-label-container"},a.createElement(R.Label,null,Je.getLocalizedString("Tasks_Subject")),a.createElement(R.Label,{styles:{root:{color:ct.red,paddingLeft:dt.size4px}}},"*")),a.createElement(V.TextField,{id:"subjectTasks",placeholder:Je.getLocalizedString("Tasks_Subject"),defaultValue:f,styles:{root:{paddingBottom:p.FontSizes.size10}},onChange:function(e){y(e.target.value),c(!!f)}}),C&&D.map((function(t){return a.createElement(Jn,{recordContainerContext:e.recordContainerContext,entityData:C[0],fieldData:C[1].get(t),dataSetRecord:b,showLabel:!0,customProps:{textStyles:On.getFieldTextStyle(C[1].get(t).dataType),showAdditionalPersonaDetails:!0},callbackHandlers:{openEntity:function(){return alert("openEntity clicked")}}})})),a.createElement("div",{className:"task-editview-footer"},a.createElement(d.PrimaryButton,{text:Je.getLocalizedString("InContextView_Save"),styles:{root:{marginLeft:dt.size4px}},onClick:function(){if(t.isTemporaryObject){h(!0);var r={subject:f};i&&(r["regardingobjectid_"+i.entityType+"_task@odata.bind"]="/"+Je.getPluralNameOfEntity(i.entityType)+"("+i.entityId+")"),n.dataService.createTask(r).then((function(){var t;null==(t=e.viewEventHandlers)||null==t.navigateBack||t.navigateBack()})).catch((function(n){var i;Je.reportError("onTaskCreate","EditTaskView",$e.FAILED,{error:n,entityId:t.key,dataFields:["subject"]}),null==(i=e.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("Tasks_ErrorMessage_Create_Task"))})).finally((function(){h(!1)}))}else t.statecode!==ye.Completed&&(h(!0),n.dataService.updateTask(t.key,{subject:f}).then(Fe(He.mark((function t(){var n;return He.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==(n=e.viewEventHandlers)||null==n.navigateBack||n.navigateBack();case 1:case"end":return t.stop()}}),t)})))).catch((function(n){var i;Je.reportError("onTaskUpdate","EditTaskView",$e.FAILED,{error:n,entityId:t.key,dataFields:["subject"]}),null==(i=e.viewEventHandlers)||null==i.openErrorView||i.openErrorView(Je.getLocalizedString("Tasks_ErrorMessage_Update_Task"))})).finally((function(){h(!1)})))},disabled:!l}),a.createElement(d.DefaultButton,{text:Je.getLocalizedString("InContextView_Cancel"),styles:{root:{marginLeft:dt.size4px}},onClick:function(){Je.reportUserAction("onCancelClick","EditTaskView","Save task cancelled",{taskId:t.key,isCreate:t.isTemporaryObject},Ye.CLICK,"Save task cancel button"),null==r||null==r.navigateBack||r.navigateBack()}})))},_i=et.palette,Ni=_i.neutralPrimary,Li=_i.neutralSecondary,Ii=u.mergeStyles({display:"flex",borderBottom:"solid 1px #eaeaea",padding:"6px 8px"}),Ai=u.mergeStyles({display:"flex",flexGrow:1}),Ri=u.mergeStyles(((oi={FontFamily:"Segoe UI",fontSize:14,lineHeight:20,fontWeight:600,color:Ni,paddingLeft:8,alignSelf:"center"})["& .ms-Shimmer-dataWrapper"]={fontWeight:600},oi)),Fi=u.mergeStyles(((ai={color:Li})["& :hover"]={color:Li},ai));!function(e){e.Default="default",e.Header="header"}(si||(si={}));var Pi=function(e){function t(){return e.apply(this,arguments)||this}return Me(t,e),t.getView=function(e){switch(e.entity.entityType){case me.Account:case me.Opportunity:case me.Contact:case me.Lead:return o.createElement(gn,Object.assign({},e,{key:e.entity.entityId}));case me.Task:switch(e.viewMode){case ve.Create:return o.createElement(ki,Object.assign({},e));case ve.Edit:return o.createElement(ki,Object.assign({},e,{task:e.childViewProps}));default:return o.createElement(Mn,Object.assign({},e,{isInlineAddTaskEnabled:!0}))}case me.Note:switch(e.viewMode){case ve.Default:return o.createElement(kn,Object.assign({},Pe({},e)));case ve.Create:return o.createElement(Nn,Object.assign({},Pe({},e)));case ve.Edit:return o.createElement(Nn,Object.assign({},Pe({},e,{note:e.childViewProps})));default:return o.createElement(In,Object.assign({},Pe({},e)))}case me.Chat:return o.createElement("div",{className:"chat-view"})}return o.createElement("div",null)},t.getNavigationCommand=function(e,t){return o.createElement(g.TooltipHost,{content:e.toolTipContent,calloutProps:Vi,key:e.ariaLabel},o.createElement(A.IconButton,{id:e.commandId?e.commandId:"icv-navigation-topbar-"+e.iconProps.iconName+"-icon",iconProps:e.iconProps,className:t&&t===si.Header?"icv-navigation-topbar-commands-icon "+Fi:"icv-navigation-topbar-commands-icon",style:e.style,ariaLabel:e.ariaLabel,onClick:function(){Je.reportUserAction("getNavigationCommand","ViewFactory",e.toolTipContent+" is clicked",{},Ye.CLICK,e.toolTipContent),e.commandAction()}}))},t.getSectionView=function(e){switch(e.section.key.toLowerCase()){case Qe.SUMMARY_KEY_DETAILS:var t=o.createElement(mi,Object.assign({},Pe({},e,{fixedColumnLayout:2}))),n=Gt.getKeyDetailsShimmer();return Gt.wrapperComponentInShimmerContainer(t,n,e.section.rows&&e.section.rows.length>0);case Qe.SUMMARY_CONTACTS:return o.createElement(hi,Object.assign({},Pe({},e,{fixedColumnLayout:1})));case Qe.SUMMARY_RECENTOPPORTUNITIES:return o.createElement(xi,Object.assign({},Pe({},e)));case Qe.SUMMARY_NOTES:return o.createElement(Ci,Object.assign({},Pe({},e)));case Qe.SUMMARY_TASKS:return o.createElement(wi,Object.assign({},Pe({},e,{isInlineAddTaskEnabled:!0})));case Qe.SUMMARY_COLLABORATION:return o.createElement(Di,Object.assign({},Pe({},e)));default:return o.createElement(mi,Object.assign({},Pe({},e,{fixedColumnLayout:0})))}},t}(o.Component),Mi=function(e){function t(t){return e.call(this,t)||this}Me(t,e);var n=t.prototype;return n.render=function(){return Je.reportInfo("render","ErrorView","Error view shown",{}),a.createElement("div",{className:"icv-errorview-container"},a.createElement("div",{className:"icv-errorview-icon-container"},a.createElement(_e.Icon,{iconName:Ue.error.iconName,className:"icv-errorview-icon"})),a.createElement("label",{className:"icv-errorview-title"},Je.getLocalizedString("ICV_Error_Title")),a.createElement("label",{className:"icv-errorview-subtitle"},this.props.message),a.createElement(Le.PrimaryButton,{onClick:this.onRefresh.bind(this),text:Je.getLocalizedString("ICV_Error_RetryButtonLabel"),iconProps:Ue.refresh,styles:{root:{marginTop:"28px",backgroundColor:ct.digitalBlue,border:"none"},rootHovered:{marginTop:"28px",backgroundColor:ct.digitalBlue,border:"none"}}}))},n.onRefresh=function(){var e;Je.reportUserAction("onRefresh","ErrorView","Try again clicked",{},Ye.CLICK,"Try again button"),null==(e=this.props.viewEventHandlers)||null==e.openErrorView||e.openErrorView("")},t}(a.Component),Oi=function(e){var t=a.useRef(null);return a.useEffect((function(){var n,i="MscrmSalesDealManager.Collab",r={descriptor:{Parameters:{showTitle:!1},Id:i,DomId:i,Disabled:!1,Label:"",ShowLabel:!1,Name:i,Visible:!0},parameters:{primaryEntityId:{Static:!0,Primary:!1,Type:"SingleLine.Text",Value:null==(n=e.entity)?void 0:n.entityId,Usage:1}},childeventlisteners:[]},o=e.context.factory.createComponent(i,i,r);e.context.factory.bindDOMComponent(o,t.current)}),[e.context,e.entity]),a.createElement("div",{ref:t})},Vi={gapSpace:0},zi=!1,Bi=(function(e){function t(t){var n,i;return(i=e.call(this,t)||this).state={primaryView:{entity:i.props.primaryEntity,viewMode:ve.Default},secondaryViews:[],commands:[],viewTitle:""},null==(n=i.props.inContextViewEventHandlers)||null==n.openSecondaryEntityHandler||n.openSecondaryEntityHandler(i.openEntityHandler.bind(Oe(i))),setTimeout(function(){zi=!0}.bind(Oe(i)),3e3),i}Me(t,e);var n=t.prototype;n.render=function(){var e,t=this.state,n=t.primaryView,i=t.secondaryViews,r=i&&i[i.length-1],a=Pe({},this.props,{entity:r?r.entity:n.entity,viewMode:r?r.viewMode:n.viewMode,relatedEntity:r&&r.relatedEntity,childViewProps:r&&r.childViewProps,viewEventHandlers:{onOpenView:this.openViewHandler.bind(this),openErrorView:this.openErrorView.bind(this),navigateBack:this.popView.bind(this),setViewTitle:this.setNavigationTitle.bind(this),registerCommands:this.registerCommand.bind(this),setErrorMessage:this.setErrorNotification.bind(this),clearErrorMessage:this.onDismissMessageBar.bind(this)}});Je.reportInfo("render","Navigation","",{entityType:a.entity.entityType,entityId:a.entity.entityId,viewMode:a.viewMode,depth:this.state.secondaryViews.length+1});var s=Pi.getView(a),l="chat-view"===(null==s||null==(e=s.props)?void 0:e.className),c={display:l?"":"none"};return this.requestFocus(),o.createElement("aside",{className:"icv-view-container"},this.getNavigationTopBar(),o.createElement("div",{className:"icv-view-content"},!v.StringUtil.IsNullOrEmpty(this.state.errorViewMessage)&&this.getErrorView(a),!v.StringUtil.IsNullOrEmpty(this.state.errorNotification)&&this.errorMessageBar(),v.StringUtil.IsNullOrEmpty(this.state.errorViewMessage)&&s,o.createElement("div",{style:c,id:"embedded-chat-container"},(zi||l)&&o.createElement(Oi,Object.assign({},a)))))},n.getErrorView=function(e){return o.createElement(Mi,Object.assign({},Pe({},e,{message:this.state.errorViewMessage})))},n.getNavigationTopBar=function(){var e=this;return o.createElement("div",{className:"icv-navigation-topbar "+Ii},o.createElement("div",{className:"icv-navigation-topbar-title-container "+Ai},this.state.secondaryViews.length>0&&o.createElement(g.TooltipHost,{content:Je.getLocalizedString("InContextView_Back"),calloutProps:Vi},o.createElement(A.IconButton,{id:"icv-navigation-topbar-back-icon",iconProps:Ue.backIcon,className:"icv-navigation-topbar-commands-icon "+Fi,ariaLabel:Je.getLocalizedString("InContextView_Back"),onClick:function(){Je.reportUserAction("getNavigationTopBar","Navigation","Back button clicked",{depth:e.state.secondaryViews.length+1},Ye.CLICK,"Navigation back button"),e.popView()}})),o.createElement("label",{className:"icv-navigation-topbar-title "+Ri},o.createElement(m.Shimmer,{customElementsGroup:Gt.getTitleShimmer(),isDataLoaded:""!=this.state.viewTitle},this.state.viewTitle))),o.createElement("div",{className:"icv-navigation-topbar-commands-container"},this.state.commands.map((function(e){return Pi.getNavigationCommand(e,si.Header)})),o.createElement(g.TooltipHost,{content:Je.getLocalizedString("InContextView_CloseAll"),calloutProps:Vi},o.createElement(A.IconButton,{id:"icv-navigation-topbar-closeall-icon",iconProps:Ue.closeIcon,ariaLabel:Je.getLocalizedString("InContextView_CloseAll"),className:"icv-navigation-topbar-commands-icon "+Fi,onClick:function(){var t=e.state.secondaryViews.length>0?e.state.secondaryViews[e.state.secondaryViews.length-1]:e.state.primaryView;Je.reportUserAction("getNavigationTopBar","Navigation","Close panel clicked",{currentViewId:t.entity.entityId,currentViewType:t.entity.entityType,currentViewMode:t.viewMode,depth:e.state.secondaryViews.length+1},Ye.CLICK,"Navigation close panel"),e.resetSecondaryViews(),e.props.inContextViewEventHandlers&&e.props.inContextViewEventHandlers.onClose&&e.props.inContextViewEventHandlers.onClose()}}))))},n.setNavigationTitle=function(e){this.setState({viewTitle:e})},n.registerCommand=function(e){this.setState({commands:e})},n.requestFocus=function(){var e=this,t=this.state,n=t.secondaryViews,i=n&&n[n.length-1]||t.primaryView;i&&i.requestFocusId&&(setTimeout((function(){var e=document.getElementById(i.requestFocusId);e&&e.focus()}),500),this.setState(0==n.length?function(t){return Pe({},t,{primaryView:Pe({},e.state.primaryView,{requestFocusId:void 0})})}:function(e){var t=e.secondaryViews.slice(0,e.secondaryViews.length-1);return t.push(Pe({},e.secondaryViews[e.secondaryViews.length-1],{requestFocusId:void 0})),{secondaryViews:t,viewTitle:"",commands:[]}}))},n.openEntityHandler=function(e){this.openViewHandler(e,ve.Default)},n.openErrorView=function(e){this.setState({errorViewMessage:e})},n.openViewHandler=function(e,t,n,i,r){var o={entity:e,viewMode:t,relatedEntity:n,childViewProps:i};this.props.inContextViewEventHandlers&&this.props.inContextViewEventHandlers.onOpenView&&this.props.inContextViewEventHandlers.onOpenView(o),this.pushView(o,r)},n.pushView=function(e,t){var n=this,i=this.state,r=i.primaryView,o=i.secondaryViews;this.matchEntities(0===o.length?r.entity:o[o.length-1].entity,e.entity)&&e.viewMode===(0===o.length?r.viewMode:o[o.length-1].viewMode)?Je.reportWarning("pushView","Navigation","Duplicate view called",{type:e.entity.entityType,id:e.entity.entityId,mode:e.viewMode}):(0==o.length&&this.setState((function(e){return Pe({},e,{primaryView:Pe({},n.state.primaryView,{requestFocusId:t})})})),this.setState((function(n){if(n.secondaryViews.length>0){var i=n.secondaryViews.slice(0,n.secondaryViews.length-1);return i.push(Pe({},n.secondaryViews[n.secondaryViews.length-1],{requestFocusId:t})),i.push(e),{secondaryViews:i,viewTitle:"",commands:[]}}var r=n.secondaryViews.slice();return r.push(e),{secondaryViews:r,viewTitle:"",commands:[]}})))},n.matchEntities=function(e,t){return!v.StringUtil.IsNullOrUndefined(e.entityId)&&e.entityId===t.entityId&&e.entityType===t.entityType},n.popView=function(){var e=this;this.setState((function(t){return{secondaryViews:t.secondaryViews.slice(0,e.state.secondaryViews.length-1),viewTitle:"",commands:[],errorViewMessage:""}}))},n.resetSecondaryViews=function(){this.setState((function(){return{secondaryViews:[]}}))},n.errorMessageBar=function(){return o.createElement(Ne.MessageBar,{messageBarType:Ie.MessageBarType.error,isMultiline:!0,onDismiss:this.onDismissMessageBar.bind(this),dismissButtonAriaLabel:Je.getLocalizedString("ICV_Close")},this.state.errorNotification)},n.setErrorNotification=function(e){this.setState({errorNotification:e})},n.onDismissMessageBar=function(){this.setState({errorNotification:void 0})}}(o.Component),function(){function e(){}return e.get=function(e){var t=this,n=this.createKey(e.cachingKeyUniquePrefix,e.key),i=this.createDefaultValue(e.defaultValue),r=this.getCachedData(n,e.storageType,i),o=new Date(r.timestamp),a=r.data?JSON.parse(r.data):null;return a?(Je.reportInfo("get-CachingService",n,"Cache Hit",{storage:e.storageType}),this.isDataExpired(o,e.expiryTimeInMinutes)?e.cacheRefreshInSync?this.executeFetchAPI(e):(setTimeout((function(){t.executeFetchAPI(e)}),500),Promise.resolve(a)):Promise.resolve(a)):(Je.reportInfo("get-CachingService",n,"Cache Miss",{storage:e.storageType}),this.executeFetchAPI(e))},e.getCachedData=function(e,t,n){var i;switch(t){case Ee.LOCAL_STORAGE:return c.get(e,n);case Ee.SESSION_STORAGE:var r=null==(i=sessionStorage)?void 0:i.getItem(e);return r?JSON.parse(r):n}},e.createKey=function(e,t){return this.cachePrefix+"_"+e+"_"+t},e.createDefaultValue=function(e){return{timestamp:(new Date).toString(),data:JSON.stringify(e||null)}},e.setCachedData=function(e,t){var n,i=this.createKey(e.cachingKeyUniquePrefix,e.key),r={timestamp:(new Date).toString(),data:JSON.stringify(t)};switch(e.storageType){case Ee.LOCAL_STORAGE:c.set(i,r);break;case Ee.SESSION_STORAGE:null==(n=sessionStorage)||n.setItem(i,JSON.stringify(r))}},e.isDataExpired=function(e,t){return t>0&&t<((new Date).getTime()-e.getTime())/6e4},e.executeFetchAPI=function(e){var t=this;return Promise.resolve(e.fetchAPI().then((function(n){return t.setCachedData(e,n),n})))},e}());Bi.cachePrefix="D365_DEALMANAGER_V1";var Ui=function(e){this.guid=e},Hi=function(){function e(e,t){this.EntityId=new Ui(e),this.EntityLogicalName=t}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{EntityId:{typeName:"Edm.Guid",structuralProperty:1},EntityLogicalName:{typeName:"Edm.String",structuralProperty:1}},operationType:1,operationName:"RetrieveProcessInstances"}},e}(),Gi=function(){function e(e){this.ProcessInstanceId=new Ui(e)}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{ProcessInstanceId:{typeName:"Edm.Guid",structuralProperty:1}},operationType:1,operationName:"RetrieveActivePath"}},e}();!function(){function e(e,t){var n=this;this.fetchTask=function(e){return Promise.resolve(n.webApi.retrieveRecord("task",e).then((function(e){return e?{key:e.activityid,owner:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],subject:e.subject,description:e.description,friendlyDueDate:e["scheduledend@OData.Community.Display.V1.FormattedValue"],dueDate:null!==e.scheduledend?new Date(e.scheduledend):void 0,duration:null!==e.scheduleddurationminutes?e.scheduleddurationminutes:void 0,prioritycode:e.prioritycode,statecode:e.statecode}:void 0})))},this.fetchRecentOpportunities=function(e){return Promise.resolve(n.webApi.retrieveMultipleRecords("opportunity",'?fetchXml=<fetch version="1.0" output-format="xml-platform" mapping="logical" distinct="false" returntotalrecordcount="true" page="1" count="3" no-lock="false">\n        <entity name="opportunity">\n           <order attribute="statecode" descending="false" />\n           <order attribute="estimatedclosedate" descending="true" />\n           <filter type="and">\n              <filter type="or">\n                 <condition attribute="statecode" operator="eq" value="0" />\n                 <filter type="and">\n                    <condition attribute="actualclosedate" operator="last-x-months" value="12" />\n                    <condition attribute="statecode" operator="eq" value="1" />\n                 </filter>\n              </filter>\n           </filter>\n           <attribute name="statecode" />\n           <attribute name="estimatedvalue" />\n           <attribute name="name" />\n           <attribute name="opportunityid" />\n           <order attribute="modifiedon" descending="true" />\n           <link-entity name="account" from="accountid" to="customerid" alias="bb">\n              <filter type="and">\n                 <condition attribute="accountid" operator="eq" uitype="account" value="'+e+'" />\n              </filter>\n           </link-entity>\n        </entity>\n     </fetch>').then((function(e){return e&&e.entities&&e.entities.length>0?e.entities:[]})))},this.fetchTasks=function(e,t){return Promise.resolve(n.webApi.retrieveMultipleRecords("task","?$filter=_regardingobjectid_value eq "+e+"&$select=subject,description,scheduledend,scheduleddurationminutes,prioritycode,statecode,_ownerid_value&$orderby=modifiedon desc").then((function(n){return n&&n.entities&&n.entities.length>0?{recordId:e,recordType:t,taskList:n.entities.map((function(e){return{key:e.activityid,owner:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],subject:e.subject,description:e.description,friendlyDueDate:e["scheduledend@OData.Community.Display.V1.FormattedValue"],dueDate:null!==e.scheduledend?new Date(e.scheduledend):void 0,duration:null!==e.scheduleddurationminutes?e.scheduleddurationminutes:void 0,prioritycode:e.prioritycode,statecode:e.statecode}}))}:{recordId:e,recordType:t,taskList:[]}})))},this.createTask=function(e){return n.webApi.createRecord("task",e)},this.updateTask=function(e,t){return n.webApi.updateRecord("task",e,t)},this.deleteTask=function(e){return n.webApi.deleteRecord("task",e)},this.fetchNotes=function(e){return Promise.resolve(n.webApi.retrieveMultipleRecords("annotation","?$select=annotationid,subject,modifiedon,notetext,_modifiedby_value,_objectid_value,objectid_opportunity,objectid_contact,objectid_account,objectid_lead,isdocument,mimetype,filename&$filter=_objectid_value eq "+e.entityId+"&$orderby=modifiedon desc").then((function(t){return t&&t.entities&&t.entities.length>0?{recordDetails:e,noteList:t.entities}:{recordDetails:e,noteList:[]}})))},this.fetchNote=function(e){return Promise.resolve(n.webApi.retrieveRecord("annotation",e,"?$select=annotationid,subject,modifiedon,notetext,_modifiedby_value,_objectid_value,objectid_opportunity,objectid_contact,objectid_account,objectid_lead,isdocument,mimetype,filename").then((function(e){return e})))},this.getNoteAttachment=function(e){return Promise.resolve(n.webApi.retrieveRecord("annotation",e,"?$select=documentbody").then((function(e){if("string"==typeof e.documentbody)return e.documentbody;throw new Error("Error in getting 'documentbody' from annotation. 'documentbody' of type "+typeof e.documentbody+" is not the expected type (string).")})))},this.getOrgUploadConstraints=function(){return Promise.resolve(n.webApi.retrieveMultipleRecords("organization","?$select=maxuploadfilesize").then((function(e){if("number"==typeof e.entities[0].maxuploadfilesize)return e.entities[0].maxuploadfilesize;throw new Error("Error in getting maxuploadfilesize from annotation. 'maxuploadfilesize of type "+typeof e.entities[0].maxuploadfilesize+" is not the expected type (Number).")})))},this.getRichTextStatus=function(){return Promise.resolve(n.webApi.retrieveMultipleRecords("organization","?$select=isrichtextnotesenabled").then((function(e){var t=e.entities[0].isrichtextnotesenabled;if(void 0!==!t)return t;throw new Error("Error getting rich text status. Returned: "+typeof t)})))},this.upsertNote=function(e,t){return e?n.webApi.updateRecord("annotation",e,t):n.webApi.createRecord("annotation",t)},this.deleteNote=function(e){return n.webApi.deleteRecord("annotation",e)},this.fetchActivities=function(e,t){return Promise.resolve(n.webApi.retrieveMultipleRecords("activitypointer","?$filter=_regardingobjectid_value eq "+e+" and (activitytypecode eq 'appointment' or activitytypecode eq 'phonecall' or activitytypecode eq 'email')"+(t?" and activityid eq "+t:"")+"&$select=subject&$orderby=createdon desc&$expand=activity_pointer_phonecall($select=actualdurationminutes,directioncode),activity_pointer_appointment($select=location,scheduledstart),activity_pointer_email($select=directioncode,description),activitypointer_activity_parties($filter=(participationtypemask eq 1 or participationtypemask eq 2 or participationtypemask eq 5 or participationtypemask eq 6);$select=participationtypemask,_partyid_value)").then((function(t){return t&&t.entities&&t.entities.length>0?{recordId:e,activityList:t.entities.map((function(e){return Zt.createActivityByType(e)}))}:{recordId:e,activityList:[]}})))},this.fetchSystemForm=function(){var e=Fe(He.mark((function e(t,i){var r;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.webApi.retrieveRecord("systemform",i,"?$select=formxml");case 2:if(null!==(r=Be.parseFormXml(t,e.sent.formxml))){e.next=6;break}throw new Error("failed to parse formXml (entity: "+t+", formId: "+i);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.fetchEntityMetadata=function(){var e=Fe(He.mark((function e(t,i){return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.recordContainerContext.metadataProvider.getEntityMetadata(t,i);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),this.fetchEntityRecord=function(){var e=Fe(He.mark((function e(t,i,r){var o;return He.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=li.getRequiredAttributes(t).concat(r),e.next=3,n.recordContainerContext.dataProvider.retrieveRecord(t,i,o);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),this.fetchProcessInstance=function(e){var t,i=new Hi(e.entityId,null==(t=e.entityType)?void 0:t.toLowerCase());return Promise.resolve(n.webApi.execute(i).then((function(e){return e.json().then((function(e){if(e&&e.value&&e.value.length>0)return e.value[0]}))})))},this.fetchProcessActivePath=function(e){var t=new Gi(e);return Promise.resolve(n.webApi.execute(t).then((function(e){return e.json().then((function(t){return t&&e.ok?t:void 0}))})))},this.fetchProcessUniqueName=function(e){return Bi.get({key:e,cachingKeyUniquePrefix:Se.Fetch_Process_Unique_Name,expiryTimeInMinutes:0,storageType:Ee.LOCAL_STORAGE,cacheRefreshInSync:!1,fetchAPI:function(){return Promise.resolve(n.webApi.retrieveRecord("workflow",e,"?$select=uniquename").then((function(e){return e.uniquename})))}})},this.updateProcessInstance=function(e,t,i){return Promise.resolve(n.webApi.updateRecord(e,t,i).then((function(e){return e})).catch((function(e){return Je.reportError("updateProcessInstance","dataService","Error occured updating process instance",{error:e.toString()}),e})))},this.createDataSetRecord=function(e,t,i,r){var o;return null==(o=n.recordContainerContext)?void 0:o.datasetRecordProvider.buildDataSetRecord(e,t,i,r)},this.webApi=e.webAPI,this.recordContainerContext=t||ni.getContainerContext(e)}e.prototype.getFormJson=function(){return this.formJson}}();r.registerIcons(Ae),Object.defineProperty(t,"initializeFileTypeIcons",{enumerable:!0,get:function(){return b.initializeFileTypeIcons}}),Object.defineProperty(t,"DialogFooter",{enumerable:!0,get:function(){return T.DialogFooter}}),Object.defineProperty(t,"DialogType",{enumerable:!0,get:function(){return T.DialogType}}),Object.defineProperty(t,"EDataType",{enumerable:!0,get:function(){return B.EDataType}}),Object.defineProperty(t,"PrimaryButton",{enumerable:!0,get:function(){return q.PrimaryButton}}),Object.defineProperty(t,"DataSetUtils",{enumerable:!0,get:function(){return de.DataSetUtils}}),Object.defineProperty(t,"Fabric",{enumerable:!0,get:function(){return ue.Fabric}}),Object.defineProperty(t,"initializeIcons",{enumerable:!0,get:function(){return pe.initializeIcons}}),t.convertFilterExpressionToFetchXmlModifiedFromPlatform=function e(t,n){var i,r,o,a;n||(n=function(e){return e});var s="";if(!(null!=(i=t.filters)&&i.length||null!=(r=t.conditions)&&r.length))return s;if(null!=(o=t.conditions)&&o.length){var l;s+='<filter type="'+ii(t.filterOperator)+'"',s+=">";for(var c=0;c<t.conditions.length;c++){var d=t.conditions[c];if(s+="<condition ",d.entityAliasName&&(s+='entityname="'+d.entityAliasName+'" '),null==d.value)s+='attribute="'+d.attributeName+'" operator="'+ri(d.conditionOperator)+'"/>';else if("string"==typeof d.value||"number"==typeof d.value)s+='attribute="'+d.attributeName+'" operator="'+ri(d.conditionOperator)+'" value="'+n(d.value)+'" />';else{var u=d.value;s+='attribute="'+d.attributeName+'" operator="'+ri(d.conditionOperator)+'">';for(var p=0;p<u.length;p++)s+="<value>"+n(u[p])+"</value>";s+="</condition>"}}null==(l=t.filters)||l.forEach((function(t){s+=e(t,n)})),s+="</filter>"}else null!=(a=t.filters)&&a.length&&(s+='<filter type="'+ii(t.filterOperator)+'">',t.filters.forEach((function(t){s+=e(t,n)})),s+="</filter>");return s}},78195:function(e,t,n){"use strict";n.r(t),n.d(t,{ExecutionContextHelper:function(){return R},ExecutionContextInputMetadata:function(){return F},ScriptLoadingStatus:function(){return i},ScriptSandbox:function(){return P}});var i,r=n(87643),o=n(29758),a=function(){function e(e){void 0===e&&(e=document),this._jsLoadingPromises={},this._targetDocument=e}var t=e.prototype;return t.loadScript=function(e){var t=this,n=e;return this._jsLoadingPromises[n]||(this._jsLoadingPromises[n]=new Promise((function(n,i){var r=t._targetDocument.createElement("script");r.onload=function(){n()},r.onerror=function(){i()},r.src=e,t._targetDocument.body.appendChild(r)}))),this._jsLoadingPromises[n]},t.loadScripts=function(e){var t=this;return e.reduce((function(e,n){return e.then((function(){return t.loadScript(n)}))}),Promise.resolve())},t.removeIFrame=function(){var e=this._targetDocument;e&&e.parentNode&&e.parentNode.removeChild(e)},e}();!function(e){e[e.Idle=0]="Idle",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.NotFound=3]="NotFound",e[e.Failed=4]="Failed"}(i||(i={}));var s,l=function(){function e(t){var n;this._assetLoader={},this._iframe={},this.loaderStatus=i.Idle,this.iframeId=t,e._instances[t]||this._injectIFrame(t),this._assetLoader=new a(this._iframe.contentDocument?this._iframe.contentDocument:null==(n=this._iframe.contentWindow)?void 0:n.document)}e.getInstance=function(t,n){return void 0===n&&(n=!0),!e._instances[t]&&n&&(e._instances[t]=new e(t)),e._instances[t]};var t=e.prototype;return t._injectIFrame=function(e){this._iframe=document.createElement("iframe"),this._iframe.id=e,this._iframe.height="0",this._iframe.width="0",this._iframe.frameBorder="0",this._iframe.setAttribute("aria-label",e),document.body.appendChild(this._iframe)},t.loadWebResources=function(e){return this._assetLoader?this._assetLoader.loadScripts(e):Promise.reject("AssetLoader not initialized")},t.getHandler=function(e){var t=this._iframe.contentWindow[e];if(null!=t)return t},t.unloadIFrame=function(){if(e._instances[this.iframeId]){var t=document.getElementById(this.iframeId);t&&t.parentNode&&t.parentNode.removeChild(t),delete e._instances[this.iframeId]}},e}();function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,p(e,t)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}l._instances={},function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Usage=3]="Usage",e[e.Error=4]="Error"}(s||(s={}));var m,h=function(){function e(){this._usageData=new Map}var t=e.prototype;return t.setLogger=function(e){this._logger=e},t.reportUsageCall=function(e,t){this._getUsageCounter(e,t).totalCalls++},t.logCategory=function(e,t,n,i,r,o,a){this._logger&&this._logger.logCategory(e,t,n,i,r,o,a)},t.logError=function(e,t,n,i,r,o,a){this._logger&&this._logger.logError(e,t,n,i,r,o,a)},t._getUsageCounter=function(e,t){var n=e+"."+t,i=this._usageData.get(n);return i||(i=new g(e,t),this._usageData.set(n,i)),i},t._logApiUsageInfo=function(e,t){if(void 0===e&&(e={}),void 0===t&&(t=!0),this._logger){var n=e;this._usageData.forEach((function(e,t){n[t]=e.totalCalls})),this.logCategory(s.Usage,"ClientAPI","Client api usage metrics",n)}t&&this._clearData()},t._clearData=function(){this._usageData.clear()},d(e,null,[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),g=function(e,t){this.componentName=e,this.source=t,this.totalCalls=0},f=function(){function e(e,t,n){this._formContext=e,this._webApiContext=t,this._eventArgs=n}var t=e.prototype;return t.getEventArgs=function(){return this._eventArgs},t.getFormContext=function(){return h.instance.reportUsageCall("ClientApi.ExecutionContext","getFormContext"),this._formContext},t.getWebApiContext=function(){return h.instance.reportUsageCall("ClientApi.ExecutionContext","getWebApiContext"),this._webApiContext},e}(),y=function(){function e(e){this._entity=e}return e.prototype.getEntity=function(){return h.instance.reportUsageCall("ClientApi.FormData","getEntity"),this._entity},d(e,[{key:"entity",get:function(){return h.instance.reportUsageCall("ClientApi.FormData","entity"),this._entity}}]),e}(),v=function(){function e(){this._collection={}}var t=e.prototype;return t.forEach=function(e){var t=this;if(e&&"function"==typeof e){var n=0,i=function(i){var r=t._collection[i];!function(t){try{e(r,n)}catch(e){throw e}}(),n++};for(var r in this._collection)i(r)}},t.get=function(e){var t=null;return null==e?t=this.getAll():"string"==typeof e?t=this.getByName(e.toString()):"number"==typeof e&&(t=this.getByIndex(Number(e))),t},t.getLength=function(){return Object.keys(this._collection).length},t.getAll=function(){var e=this;return Object.keys(this._collection).map((function(t){return e._collection[t]}))},t.getByIndex=function(e){var t=null,n=Object.keys(this._collection);if(n.length>e){var i=n[e];t=this._collection[i]}return t},t.getByName=function(e){var t=this._collection[e];return void 0===t&&(t=null),t},t.add=function(e,t){this._collection[e]=t},e}(),C=function(){function e(){}return e.IsNullOrUndefined=function(e){return null==e},e.IsNullOrEmpty=function(t){return null==t||t===e.Empty},e.isBlank=function(e){var t;return this.IsNullOrEmpty(e)||""===(null==e||null==(t=e.toString())?void 0:t.trim())},d(e,null,[{key:"Empty",get:function(){return""}}]),e}(),S=function(){function e(e,t){this._controlName=e,this._editGridRow=t}var t=e.prototype;return t.getDisabled=function(){return h.instance.reportUsageCall("ClientApi.Control","getDisabled"),this._editGridRow.getDisabled(this._controlName)},t.setDisabled=function(e){h.instance.reportUsageCall("ClientApi.Control","setDisabled"),h.instance.reportUsageCall("ClientApi.Control","setDisabled_"+this._controlName+"_"+e),this._editGridRow.setDisabled(this._controlName,e)},t.setNotification=function(e,t){return h.instance.reportUsageCall("ClientApi.Control","setNotification"),h.instance.reportUsageCall("ClientApi.Control","setNotification_"+this._controlName),!!this._isValidMessage(e)&&(this._editGridRow.setNotification(this._controlName,e,t),!0)},t.clearNotification=function(e){return h.instance.reportUsageCall("ClientApi.Control","clearNotification"),h.instance.reportUsageCall("ClientApi.Control","clearNotification_"+this._controlName),!!this._editGridRow.getNotification(this._controlName,e)&&(this._editGridRow.setNotification(this._controlName,void 0,e),!0)},t._isValidMessage=function(e){return!C.isBlank(e)},e}(),E=function(){function e(e,t,n){this._attributeName=e,this._recordRow=t,this._dataSetRecord=n}var t=e.prototype;return t.getControls=function(){return h.instance.reportUsageCall("ClientApi.AttibuteBase","getControls"),this.controls},t.getName=function(){return h.instance.reportUsageCall("ClientApi.AttibuteBase","getName"),this._attributeName},t.getIsDirty=function(){var e=this._dataSetRecord,t=!1;return e.isDirty&&e.dirtyAttributes&&e.dirtyAttributes.has(this._attributeName)&&(t=!0),h.instance.reportUsageCall("ClientApi.AttibuteBase","getIsDirty"),t},t.getValueInternal=function(){var e={};return this._dataSetRecord&&(e.value=this._dataSetRecord.values.get(this._attributeName)),e},d(e,[{key:"controls",get:function(){if(!this._controls){this._controls=new v;var e=new S(this._attributeName,this._recordRow);this._controls.add(this._attributeName,e)}return h.instance.reportUsageCall("ClientApi.AttibuteBase","controls"),this._controls}}]),e}(),b=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.getValue=function(){var e;return h.instance.reportUsageCall("ClientApi.AttributeString","getValue"),(e=this.getValueInternal())?e.value:null},t}(E),w=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.getValue=function(){var e;return h.instance.reportUsageCall("ClientApi.AttributeNumber","getValue"),(e=this.getValueInternal())&&void 0!==e.value&&""!==e.value?e.value:null},t}(E),D=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.getValue=function(){var e;return h.instance.reportUsageCall("ClientApi.AttributeDateTime","getValue"),(e=this.getValueInternal()).value?e.value:null},t}(E),T=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.getValue=function(){var e;return h.instance.reportUsageCall("ClientApi.AttributeBoolean","getValue"),(e=this.getValueInternal())?e.value:null},t}(E),x=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.getValue=function(){var e;return h.instance.reportUsageCall("ClientApi.AttributeOptionSet","getValue"),(e=this.getValueInternal())?e.value:null},t}(E),k=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.getValue=function(){return h.instance.reportUsageCall("ClientApi.AttributeLookup","getValue"),function(e){var t=e&&e.value;if(t){var n={entityType:t.entityLogicalName,id:t.id,name:t.displayName},i=new Array;return i.push(n),i}return null}(this.getValueInternal())},t}(E),_=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype.getValue=function(){var e;return h.instance.reportUsageCall("ClientApi.AttributeUniqueIdentifier","getValue"),(e=this.getValueInternal())&&e.value?e.value:null},t}(E),N=function(){function e(e,t,n,i){this._entityName=i,this._recordClientApi=t,this._executionContextInputMetdata=e,this._dataSetRecord=n}var t=e.prototype;return t.getAttributes=function(){return h.instance.reportUsageCall("ClientApi.EntityApiImpl","getAttributes"),this.attributes},t.getEntityName=function(){return h.instance.reportUsageCall("ClientApi.EntityApiImpl","getEntityName"),h.instance.reportUsageCall("ClientApi.EntityApiImpl","getEntityName_"+this._entityName),this._entityName},t.getId=function(){return h.instance.reportUsageCall("ClientApi.EntityApiImpl","getId"),this._dataSetRecord&&this._dataSetRecord.recordId?"{"+this._dataSetRecord.recordId.toUpperCase()+"}":""},t._getAttributeNames=function(e){return e.getColumns()},t.getAttributeFromAttributeDescriptor=function(e,t){var n;switch(t){case o.EDataType.String:n=new b(e,this._recordClientApi,this._dataSetRecord);break;case o.EDataType.Decimal:case o.EDataType.Float:case o.EDataType.WholeNumber:case o.EDataType.Currency:n=new w(e,this._recordClientApi,this._dataSetRecord);break;case o.EDataType.Date:n=new D(e,this._recordClientApi,this._dataSetRecord);break;case o.EDataType.TwoOptions:n=new T(e,this._recordClientApi,this._dataSetRecord);break;case o.EDataType.OptionSet:case o.EDataType.State:case o.EDataType.Status:n=new x(e,this._recordClientApi,this._dataSetRecord);break;case o.EDataType.Lookup:case o.EDataType.Owner:case o.EDataType.Customer:n=new k(e,this._recordClientApi,this._dataSetRecord);break;case o.EDataType.UniqueIdentifier:n=new _(e,this._recordClientApi,this._dataSetRecord);break;default:n=new b(e,this._recordClientApi,this._dataSetRecord)}return n},d(e,[{key:"attributes",get:function(){var e=this;return this._attributes||(this._attributes=new v,this._getAttributeNames(this._executionContextInputMetdata).forEach((function(t){var n=function(e,t){var n=e.get(t);return t&&n?n.dataType:""}(e._executionContextInputMetdata.getAttributeMetadata(),t);if(n){var i=e.getAttributeFromAttributeDescriptor(t,n);e._attributes.add(t,i)}}))),h.instance.reportUsageCall("ClientApi.EntityApiImpl","attributes"),this._attributes}}]),e}(),L=function(){function e(e,t,n){this._recordClientApi=t,this._executionContextInputMetdata=e,this._dataSetRecord=n}var t=e.prototype;return t.getData=function(){return h.instance.reportUsageCall("ClientApi.FormContext","getData"),this.data},t.getEntityNameFromMetadata=function(e){return e.getEntityMetadata()&&e.getEntityMetadata().name?e.getEntityMetadata().name:""},d(e,[{key:"data",get:function(){if(!this._data){var e=this.getEntityNameFromMetadata(this._executionContextInputMetdata),t=new N(this._executionContextInputMetdata,this._recordClientApi,this._dataSetRecord,e);this._data=new y(t)}return h.instance.reportUsageCall("ClientApi.FormContext","data"),this._data}}]),e}();!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Usage=3]="Usage",e[e.Error=4]="Error"}(m||(m={}));var I=function(){function e(e){this._webApiContext=e.getWebApiContext()}var t=e.prototype;return t.retrieveRecord=function(e,t,n){return h.instance.logCategory(m.Info,"ClientApi.WebApiContext","retrieveRecord call is invoked",{entityType:e}),h.instance.reportUsageCall("ClientApi.WebApiContext","retrieveRecord"),this._webApiContext.retrieveRecord(e,t,n)},t.createRecord=function(e,t){return h.instance.logCategory(m.Info,"ClientApi.WebApiContext","createRecord call is invoked",{entityType:e}),h.instance.reportUsageCall("ClientApi.WebApiContext","createRecord"),this._webApiContext.createRecord(e,t)},t.updateRecord=function(e,t,n){return h.instance.logCategory(m.Info,"ClientApi.WebApiContext","updateRecord call is invoked",{entityType:e}),h.instance.reportUsageCall("ClientApi.WebApiContext","updateRecord"),this._webApiContext.updateRecord(e,t,n)},t.deleteRecord=function(e,t){return h.instance.logCategory(m.Info,"ClientApi.WebApiContext","deleteRecord call is invoked",{entityType:e}),h.instance.reportUsageCall("ClientApi.WebApiContext","deleteRecord"),this._webApiContext.deleteRecord(e,t)},e}(),A=function(){function e(){this._wasPreventDefaultCalled=!1}var t=e.prototype;return t.preventDefault=function(){this._wasPreventDefaultCalled=!0,h.instance.reportUsageCall("ClientApi.EventArgsImpl","preventDefault")},t.isDefaultPrevented=function(){return this._wasPreventDefaultCalled},e}(),R=function(){function e(){}return e.getExecutionContext=function(e,t,n,i,r,o){return new f(o||new L(e,t,n),i||new I(e),r||new A)},e}(),F=function(){function e(e,t,n,i){this._entityMetadata=e,this._attributesMetadata=t,this._columns=n,this._webApiContext=i}var t=e.prototype;return t.getEntityMetadata=function(){return this._entityMetadata},t.getAttributeMetadata=function(){return this._attributesMetadata},t.getColumns=function(){return this._columns},t.getWebApiContext=function(){return this._webApiContext},e}(),P=function(){function e(){}return e.initialize=function(t,n,i){e.context=i,e.loadWebResources([e.WebResourcesFilePathPrefix+t],n)},e.clearWebResources=function(e){var t=l.getInstance(e,!1);t&&t.unloadIFrame(),t.loaderStatus=i.Idle},e.hasClientEventHandlers=function(e){return l.getInstance(e).loaderStatus==i.Loaded},e.getWebresourceLoaderState=function(e){return l.getInstance(e).loaderStatus},e.getSaveHandler=function(t){var n=l.getInstance(t);return e.hasClientEventHandlers(t)&&n.getHandler("OnSave")},e.getChangeHandler=function(t){var n=l.getInstance(t);return e.hasClientEventHandlers(t)&&n.getHandler("OnChange")},e.getRowLoadHandler=function(t){var n=l.getInstance(t);return e.hasClientEventHandlers(t)&&n.getHandler("OnRowLoad")},e.loadWebResources=function(t,n){var o=l.getInstance(n);o.loaderStatus=i.Loading,o.loadWebResources(t).then((function(){e.updateHandlersFromLoadedWebResources(o),r.SIClientUtilityLogger.Telemetry.reportInfo(r.SIClientUtilityLogger.Telemetry.getEventParams(e.context,"ScriptSandbox","loadWebResources","","Successfully loaded webresources",{iframeId:n,webResources:t}))})).catch((function(a){o.loaderStatus=i.Failed,r.SIClientUtilityLogger.Telemetry.reportError(r.SIClientUtilityLogger.Telemetry.getEventParams(e.context,"ScriptSandbox","loadWebResources","","Error loading webresources",{error:a,iframeId:n,webResources:t}))}))},e.updateHandlersFromLoadedWebResources=function(t){var n=!1;e.ClientAPI_Handlers_Names.forEach((function(e){t.getHandler(e)&&(n=!0)})),t.loaderStatus=n?i.Loaded:i.NotFound},e}();P.ClientAPI_Handlers_Names=["OnRowLoad","OnSave","OnChange"],P.WebResourcesFilePathPrefix="WebResources/"},63804:function(e){"use strict";e.exports=React},27196:function(e){"use strict";e.exports=ReactDOM}},t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={377:0},t=[[93313,856,685,388,179,736]],i=function(){};function r(){for(var i,r=0;r<t.length;r++){for(var o=t[r],a=!0,s=1;s<o.length;s++){var l=o[s];0!==e[l]&&(a=!1)}a&&(t.splice(r--,1),i=n(n.s=o[0]))}return 0===t.length&&(n.x(),n.x=function(){}),i}n.x=function(){n.x=function(){},a=a.slice();for(var e=0;e<a.length;e++)o(a[e]);return(i=r)()};var o=function(r){for(var o,a,l=r[0],c=r[1],d=r[2],u=r[3],p=0,m=[];p<l.length;p++)a=l[p],n.o(e,a)&&e[a]&&m.push(e[a][0]),e[a]=0;for(o in c)n.o(c,o)&&(n.m[o]=c[o]);for(d&&d(n),s(r);m.length;)m.shift()();return u&&t.push.apply(t,u),i()},a=self.webpackChunkpipelinemanagementcomponent=self.webpackChunkpipelinemanagementcomponent||[],s=a.push.bind(a);a.push=o}(),n.x()}();
//# sourceMappingURL=pipelinemanagementcomponent.js.map