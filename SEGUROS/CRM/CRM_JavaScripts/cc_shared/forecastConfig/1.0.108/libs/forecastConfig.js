var forecastConfig=function(e){function t(t){for(var r,a,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&p.push(i[a][0]),i[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(u&&u(t);p.length;)p.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={0:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var s=window.webpackJsonpforecastConfig=window.webpackJsonpforecastConfig||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;return o.push([641,1]),n()}([,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(647),i=function(){function e(){}return e.UpdateCCFStringsProvider=function(e){this.ccfStringsProvider=e},e.GetString=function(e){return this.ccfStringsProvider?this.ccfStringsProvider.getLocalizedString(e):this.defaultProvider.getLocalizedString(e)},e.defaultProvider=new r.DefaultLocalizedStringsProvider,e}();t.GlobalLocalizedStringsProvider=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STRING_KEYS={SI_PACKAGE_NOTINSTALLED:"SI_PACKAGE_NOTINSTALLED",SI_LEARN_MORE:"SI_LEARN_MORE",FORECAST_CONFIG_HEADING_GRIDPAGE:"FORECAST_CONFIG_HEADING_GRIDPAGE",FORECAST_CONFIG_SUBHEADINGLINK_GRIDPAGE:"FORECAST_CONFIG_SUBHEADINGLINK_GRIDPAGE",FORECAST_CONFIG_SUBHEADING_GRIDPAGE:"FORECAST_CONFIG_SUBHEADING_GRIDPAGE",FORECAST_CONFIG_CREATE_BUTTON_GRIDPAGE:"FORECAST_CONFIG_CREATE_BUTTON_GRIDPAGE",FORECAST_CONFIG_TEMPLATE_HEADING_GRIDPAGE:"FORECAST_CONFIG_TEMPLATE_HEADING_GRIDPAGE",FC_CUSTOM_TEMPLATE_HEADING_GRIDPAGE:"FC_CUSTOM_TEMPLATE_HEADING_GRIDPAGE",FC_HIERARCHY_TEMPLATE_HEADING_GRIDPAGE:"FC_HIERARCHY_TEMPLATE_HEADING_GRIDPAGE",FC_TERRITORY_TEMPLATE_HEADING_GRIDPAGE:"FC_TERRITORY_TEMPLATE_HEADING_GRIDPAGE",FC_PRODUCT_TEMPLATE_HEADING_GRIDPAGE:"FC_PRODUCT_TEMPLATE_HEADING_GRIDPAGE",FC_HIERARCHY_TEMPLATE_SUBHEADING_GRIDPAGE:"FC_HIERARCHY_TEMPLATE_SUBHEADING_GRIDPAGE",FC_TERRITORY_TEMPLATE_SUBHEADING_GRIDPAGE:"FC_TERRITORY_TEMPLATE_SUBHEADING_GRIDPAGE",FC_CUSTOM_TEMPLATE_SUBHEADING_GRIDPAGE:"FC_CUSTOM_TEMPLATE_SUBHEADING_GRIDPAGE",FC_PRODUCT_TEMPLATE_SUBHEADING_GRIDPAGE:"FC_PRODUCT_TEMPLATE_SUBHEADING_GRIDPAGE",FC_MORE_COMMANDS:"FC_MORE_COMMANDS",FC_HIERARCHY_GRID_LABEL:"FC_HIERARCHY_GRID_LABEL",FC_GRID_ARIA_LABEL:"FC_GRID_ARIA_LABEL",FC_GRID_SELECTOR_ALL_GRIDPAGE:"FC_GRID_SELECTOR_ALL_GRIDPAGE",FC_GRID_SELECTOR_PUBLISHED_GRIDPAGE:"FC_GRID_SELECTOR_PUBLISHED_GRIDPAGE",FC_GRID_SELECTOR_DRAFTS_GRIDPAGE:"FC_GRID_SELECTOR_DRAFTS_GRIDPAGE",FC_GRID_SELECTOR_ARCHIVED_GRIDPAGE:"FC_GRID_SELECTOR_ARCHIVED_GRIDPAGE",FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE:"FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE",FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE:"FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE",FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE:"FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE",FC_GRID_COLUMN_NAME_FROM_GRIDPAGE:"FC_GRID_COLUMN_NAME_FROM_GRIDPAGE",FC_GRID_COLUMN_NAME_TO_GRIDPAGE:"FC_GRID_COLUMN_NAME_TO_GRIDPAGE",FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE:"FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE",FC_GRID_COLUMN_NAME_CREATEDON_GRIDPAGE:"FC_GRID_COLUMN_NAME_CREATEDON_GRIDPAGE",FC_GRID_COLUMN_NAME_ROLLUPENTITY_GRIDPAGE:"FC_GRID_COLUMN_NAME_ROLLUPENTITY_GRIDPAGE",FC_GRID_COLUMN_NAME_HIERARCHYENTITY_GRIDPAGE:"FC_GRID_COLUMN_NAME_HIERARCHYENTITY_GRIDPAGE",FC_EDIT_RIBBON_SAVE_EDITPAGE:"FC_EDIT_RIBBON_SAVE_EDITPAGE",FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE:"FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE",FC_EDIT_RIBBON_DELETE_EDITPAGE:"FC_EDIT_RIBBON_DELETE_EDITPAGE",FC_EDIT_RIBBON_CLOSE_EDITPAGE:"FC_EDIT_RIBBON_CLOSE_EDITPAGE",FC_EDIT_STATUS_STATUS_EDITPAGE:"FC_EDIT_STATUS_STATUS_EDITPAGE",FC_EDIT_STATUS_TYPE_EDITPAGE:"FC_EDIT_STATUS_TYPE_EDITPAGE",FC_EDIT_STATUS_OWNER_EDITPAGE:"FC_EDIT_STATUS_OWNER_EDITPAGE",FC_EDIT_FORECAST_TITLE_EDITPAGE:"FC_EDIT_FORECAST_TITLE_EDITPAGE",FC_EDIT_STEPPER_STAGE1_EDITPAGE:"FC_EDIT_STEPPER_STAGE1_EDITPAGE",FC_EDIT_STEPPER_STAGE2_EDITPAGE:"FC_EDIT_STEPPER_STAGE2_EDITPAGE",FC_EDIT_STEPPER_STAGE3_EDITPAGE:"FC_EDIT_STEPPER_STAGE3_EDITPAGE",FC_EDIT_STEPPER_STAGE4_EDITPAGE:"FC_EDIT_STEPPER_STAGE4_EDITPAGE",FC_EDIT_STEPPER_BUTTON_BACK_EDITPAGE:"FC_EDIT_STEPPER_BUTTON_BACK_EDITPAGE",FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE:"FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE",FC_EDIT_STEPPER_BUTTON_FINISH_EDITPAGE:"FC_EDIT_STEPPER_BUTTON_FINISH_EDITPAGE",FC_ROLLUP_ENTITY_STAGE1:"FC_ROLLUP_ENTITY_STAGE1",FC_HIERARCHY_ENTITY_STAGE1:"FC_HIERARCHY_ENTITY_STAGE1",FC_TOP_OF_HIERARCHY_STAGE1:"FC_TOP_OF_HIERARCHY_STAGE1",FC_TOP_OF_HIERARCHY2_STAGE1:"FC_TOP_OF_HIERARCHY2_STAGE1",FC_FORECAST_PERIOD_STAGE1:"FC_FORECAST_PERIOD_STAGE1",FC_FISCAL_YEAR_STAGE1:"FC_FISCAL_YEAR_STAGE1",FC_FORECAST_START_AT_STAGE1:"FC_FORECAST_START_AT_STAGE1",FC_NUMBER_OF_PERIODS_STAGE1:"FC_NUMBER_OF_PERIODS_STAGE1",FC_VALID_FROM_STAGE1:"FC_VALID_FROM_STAGE1",FC_VALID_TO_STAGE1:"FC_VALID_TO_STAGE1",FC_PREVIEW_HIERARCHY_NO_DATA_STAGE1:"FC_PREVIEW_HIERARCHY_NO_DATA_STAGE1",FC_PREVIEW_HIERARCHY_SELECT_ENTITY_STAGE1:"FC_PREVIEW_HIERARCHY_SELECT_ENTITY_STAGE1",FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1:"FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1",FC_HIERARCHY_ENTITY_SELECTOR_LABEL_STAGE1:"FC_HIERARCHY_ENTITY_SELECTOR_LABEL_STAGE1",FC_PREVIEW_HIERARCHY_COLUMN:"FC_PREVIEW_HIERARCHY_COLUMN",FC_LOADING:"FC_LOADING",FC_ADD_FILTERS_TEXT:"FC_ADD_FILTERS_TEXT",FC_DIALOG_DELETE_TITLE_GRIDPAGE:"FC_DIALOG_DELETE_TITLE_GRIDPAGE",FC_DIALOG_CREATE_SNAPSHOT_TITLE_GRIDPAGE:"FC_DIALOG_CREATE_SNAPSHOT_TITLE_GRIDPAGE",FC_DIALOG_DELETE_DESCRIPTION_GRIDPAGE:"FC_DIALOG_DELETE_DESCRIPTION_GRIDPAGE",FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE:"FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE",FC_DIALOG_ADD_SNAPSHOT_BUTTON_GRIDPAGE:"FC_DIALOG_ADD_SNAPSHOT_BUTTON_GRIDPAGE",FC_DIALOG_SNAPSHOT_LIMIT_INFO_TEXT:"FC_DIALOG_SNAPSHOT_LIMIT_INFO_TEXT",FC_DIALOG_SNAPSHOT_STATUS_EMPTY_TEXT:"FC_DIALOG_SNAPSHOT_STATUS_EMPTY_TEXT",FC_DIALOG_SECONDARYBUTTON_GRIDPAGE:"FC_DIALOG_SECONDARYBUTTON_GRIDPAGE",FC_DIALOG_PUBLISH_TITLE_GRIDPAGE:"FC_DIALOG_PUBLISH_TITLE_GRIDPAGE",FC_DIALOG_PUBLISH_DESCRIPTION_GRIDPAGE:"FC_DIALOG_PUBLISH_DESCRIPTION_GRIDPAGE",FC_DIALOG_PUBLISH_PRIMARYBUTTON_GRIDPAGE:"FC_DIALOG_PUBLISH_PRIMARYBUTTON_GRIDPAGE",FC_DIALOG_DEACTIVATE_TITLE_GRIDPAGE:"FC_DIALOG_DEACTIVATE_TITLE_GRIDPAGE",FC_DIALOG_DEACTIVATE_DESCRIPTION_GRIDPAGE:"FC_DIALOG_DEACTIVATE_DESCRIPTION_GRIDPAGE",FC_DIALOG_DEACTIVATE_PRIMARYBUTTON_GRIDPAGE:"FC_DIALOG_DEACTIVATE_PRIMARYBUTTON_GRIDPAGE",FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_SECONDARYBUTTON:"FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_SECONDARYBUTTON",FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_TITLE:"FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_TITLE",FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_DESCRIPTION:"FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_DESCRIPTION",FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_PRIMARYBUTTON:"FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_PRIMARYBUTTON",FC_CONFIGURATION_SECTION_HEADER_STAGE1:"FC_CONFIGURATION_SECTION_HEADER_STAGE1",FC_CONFIGURATION_SECTION_SUBTITLE_STAGE1:"FC_CONFIGURATION_SECTION_SUBTITLE_STAGE1",FC_CONFIGURATION_SECTION_SUBTITLE2_STAGE1:"FC_CONFIGURATION_SECTION_SUBTITLE2_STAGE1",FC_CONFIGURATION_SECTION_SUBTITLE3_STAGE1:"FC_CONFIGURATION_SECTION_SUBTITLE3_STAGE1",FC_SCHEDULING_SECTION_HEADER_STAGE1:"FC_SCHEDULING_SECTION_HEADER_STAGE1",FC_SCHEDULING_SECTION_SUBTITLE_STAGE1:"FC_SCHEDULING_SECTION_SUBTITLE_STAGE1",FC_TOP_OF_HIERARCHY_WITH_PLACEHOLDER_STAGE1:"FC_TOP_OF_HIERARCHY_WITH_PLACEHOLDER_STAGE1",CREATE_SNAPSHOT_ERROR_FORECAST_NOT_STARTED:"CREATE_SNAPSHOT_ERROR_FORECAST_NOT_STARTED",CREATE_SNAPSHOT_ERROR_FORECAST_ENDED:"CREATE_SNAPSHOT_ERROR_FORECAST_ENDED",FC_PUBLISH_HEADING:"FC_PUBLISH_HEADING",FC_PUBLISH_TEXT:"FC_PUBLISH_TEXT",FC_PUBLISH_SUCCESS:"FC_PUBLISH_SUCCESS",FC_PUBLISH_INPROGRESS:"FC_PUBLISH_INPROGRESS",FC_PUBLISH_FAILED:"FC_PUBLISH_FAILED",FC_PUBLISH_ARCHIVED:"FC_PUBLISH_ARCHIVED",FC_QUOTA_HEADING:"FC_QUOTA_HEADING",FC_QUOTA_TEXT_LINE1:"FC_QUOTA_TEXT_LINE1",FC_QUOTA_TEXT_LINE2:"FC_QUOTA_TEXT_LINE2",FC_QUOTA_DOWNLOAD_TEXT:"FC_QUOTA_DOWNLOAD_TEXT",FC_QUOTA_UPLOAD_FILE:"FC_QUOTA_UPLOAD_FILE",FC_QUOTA_UPLOAD_LINE1:"FC_QUOTA_UPLOAD_LINE1",FC_QUOTA_UPLOAD_LINE2:"FC_QUOTA_UPLOAD_LINE2",FC_QUOTA_UPLOAD_DRAG:"FC_QUOTA_UPLOAD_DRAG",FC_QUOTA_UPLOADING:"FC_QUOTA_UPLOADING",FC_QUOTA_PROCESSING:"FC_QUOTA_PROCESSING",FC_QUOTA_STEP1:"FC_QUOTA_STEP1",FC_QUOTA_STEP2:"FC_QUOTA_STEP2",FC_QUOTA_SUCCESS:"FC_QUOTA_SUCCESS",FC_QUOTA_DOWNLOAD_FAILED:"FC_QUOTA_DOWNLOAD_FAILED",FC_QUOTA_FAILED:"FC_QUOTA_FAILED",FC_QUOTA_FAILED_UNKNOWN:"FC_QUOTA_FAILED_UNKNOWN",FC_QUOTA_FAILED_GUID_TAMPERED:"FC_QUOTA_FAILED_GUID_TAMPERED",FC_QUOTA_FAILED_INVALID_ROWS:"FC_QUOTA_FAILED_INVALID_ROWS",FC_QUOTA_FAILED_INVALID_CONTENT:"FC_QUOTA_FAILED_INVALID_CONTENT",FC_QUOTA_FAILED_INVALID_FILE:"FC_QUOTA_FAILED_INVALID_FILE",FC_QUOTA_FAILED_INVALID_SIZE:"FC_QUOTA_FAILED_INVALID_SIZE",FC_QUOTA_UPLOAD_FAILED:"FC_QUOTA_UPLOAD_FAILED",FC_QUOTA_FAILED_FETCH_FAILED:"FC_QUOTA_FAILED_FETCH_FAILED",FC_QUOTA_FAILED_INVALID_FORECASTCONFIGURATION:"FC_QUOTA_FAILED_INVALID_FORECASTCONFIGURATION",FC_COLUMN_OPTION_HEADER_STAGE2:"FC_COLUMN_OPTION_HEADER_STAGE2",FC_COLUMN_OPTION_SUBHEADER_STAGE2:"FC_COLUMN_OPTION_SUBHEADER_STAGE2",FC_OPTIONSET_PANEL_RIBBON_CHOOSE_SELECTED:"FC_OPTIONSET_PANEL_RIBBON_CHOOSE_SELECTED",FC_CHANGE_OPTIONSET_DIALOG_TITLE:"FC_CHANGE_OPTIONSET_DIALOG_TITLE",FC_CHANGE_OPTIONSET_DIALOG_DESCRIPTION:"FC_CHANGE_OPTIONSET_DIALOG_DESCRIPTION",FC_CHANGE_OPTIONSET_DIALOG_PRIMARY_BUTTON:"FC_CHANGE_OPTIONSET_DIALOG_PRIMARY_BUTTON",FC_AUTOPOPULATE_DIALOG_TITLE:"FC_AUTOPOPULATE_DIALOG_TITLE",FC_AUTOPOPULATE_DIALOG_DESCRIPTION:"FC_AUTOPOPULATE_DIALOG_DESCRIPTION",FC_AUTOPOPULATE_DIALOG_PRIMARY_BUTTON:"FC_AUTOPOPULATE_DIALOG_PRIMARY_BUTTON",FC_AUTOPOPULATE_DIALOG_NO_BUTTON:"FC_AUTOPOPULATE_DIALOG_NO_BUTTON",FC_COLUMN_EDITOR_COLUMN_TYPE_ROLLUP:"FC_COLUMN_EDITOR_COLUMN_TYPE_ROLLUP",FC_COLUMN_EDITOR_COLUMN_TYPE_CALCULATED:"FC_COLUMN_EDITOR_COLUMN_TYPE_CALCULATED",FC_COLUMN_EDITOR_COLUMN_TYPE_SIMPLE:"FC_COLUMN_EDITOR_COLUMN_TYPE_SIMPLE",FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA:"FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA",FC_COLUMN_EDITOR_COLUMN_TYPE_PREDICTIVE:"FC_COLUMN_EDITOR_COLUMN_TYPE_PREDICTIVE",FC_COLUMN_EDITOR_COLUMN_TYPE_OWNER:"FC_COLUMN_EDITOR_COLUMN_TYPE_OWNER",FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY:"FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY",FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY:"FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY",FC_COLUMN_EDITOR_COLUMN_DATATYPE_CURRENCY:"FC_COLUMN_EDITOR_COLUMN_DATATYPE_CURRENCY",FC_COLUMN_EDITOR_COLUMN_DATATYPE_DECIMAL:"FC_COLUMN_EDITOR_COLUMN_DATATYPE_DECIMAL",FC_COLUMN_EDITOR_COLUMN_DATATYPE_TEXT:"FC_COLUMN_EDITOR_COLUMN_DATATYPE_TEXT",FC_COLUMN_EDITOR_INFORMATION_ICON_LABEL:"FC_COLUMN_EDITOR_INFORMATION_ICON_LABEL",FC_COLUMN_EDITOR_NAME_SECTION:"FC_COLUMN_EDITOR_NAME_SECTION",FC_COLUMN_EDITOR_CALCULATION_SECTION:"FC_COLUMN_EDITOR_CALCULATION_SECTION",FC_COLUMN_CALCULATED_SUGGESTION_AVAILABLE:"FC_COLUMN_CALCULATED_SUGGESTION_AVAILABLE",FC_COLUMN_CALCULATED_SUGGESTION_UNAVAILABLE:"FC_COLUMN_CALCULATED_SUGGESTION_UNAVAILABLE",FC_COLUMN_EDITOR_TYPE_SECTION:"FC_COLUMN_EDITOR_TYPE_SECTION",FC_COLUMN_EDITOR_DATATYPE_SECTION:"FC_COLUMN_EDITOR_DATATYPE_SECTION",FC_COLUMN_EDITOR_AMOUNT_FIELD_SECTION:"FC_COLUMN_EDITOR_AMOUNT_FIELD_SECTION",FC_COLUMN_EDITOR_DESCRIPTION_FIELD_SECTION:"FC_COLUMN_EDITOR_DESCRIPTION_FIELD_SECTION",FC_COLUMN_EDITOR_DATE_FIELD_SECTION:"FC_COLUMN_EDITOR_DATE_FIELD_SECTION",FC_COLUMN_EDITOR_ATTRIBUTE_FIELD_SELECTION:"FC_COLUMN_EDITOR_ATTRIBUTE_FIELD_SELECTION",FC_COLUMN_EDITOR_SELECTOR_SECTION:"FC_COLUMN_EDITOR_SELECTOR_SECTION",FC_COLUMN_EDITOR_ALLOW_ADJUSTMENTS_SECTION:"FC_COLUMN_EDITOR_ALLOW_ADJUSTMENTS_SECTION",FC_COLUMN_EDITOR_SHOW_IN_TREND_CHART_SECTION:"FC_COLUMN_EDITOR_SHOW_IN_TREND_CHART_SECTION",FC_COLUMN_EDITOR_SHOW_PROGRESS_SECTION:"FC_COLUMN_EDITOR_SHOW_PROGRESS_SECTION",FC_COLUMN_EDITOR_UNIQUE_NAME_SECTION:"FC_COLUMN_EDITOR_UNIQUE_NAME_SECTION",FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE:"FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE",FC_COLUMN_EDITOR_IMPROPER_UNIQUE_NAME_MESSAGE:"FC_COLUMN_EDITOR_IMPROPER_UNIQUE_NAME_MESSAGE",FC_COLUMN_EDITOR_NAME_PLACEHOLDER:"FC_COLUMN_EDITOR_NAME_PLACEHOLDER",FC_COLUMN_EDITOR_CALCULATION_PLACEHOLDER:"FC_COLUMN_EDITOR_CALCULATION_PLACEHOLDER",FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER:"FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER",FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER_SECONDARY:"FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER_SECONDARY",FC_COLUMN_ASSOCIATED_WITH_UNIQUENAME:"FC_COLUMN_ASSOCIATED_WITH_UNIQUENAME",FC_COLUMN_EDITOR_TYPE_PLACEHOLDER:"FC_COLUMN_EDITOR_TYPE_PLACEHOLDER",FC_COLUMN_EDITOR_DATATYPE_PLACEHOLDER:"FC_COLUMN_EDITOR_DATATYPE_PLACEHOLDER",FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER:"FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER",FC_COLUMN_EDITOR_DESCRIPTION_PLACEHOLDER:"FC_COLUMN_EDITOR_DESCRIPTION_PLACEHOLDER",FC_COLUMN_EDITOR_DESCRIPTION_DESCRIPTION:"FC_COLUMN_EDITOR_DESCRIPTION_DESCRIPTION",FC_COLUMN_OVERVIEW_PREDECTIVE_FORECASTING:"FC_COLUMN_OVERVIEW_PREDECTIVE_FORECASTING",FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION:"FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION",FC_COLUMN_OVERVIEW_LINK:"FC_COLUMN_OVERVIEW_LINK",FC_COLUMN_OVERVIEW_DELETE_DIALOG_TITLE:"FC_COLUMN_OVERVIEW_DELETE_DIALOG_TITLE",FC_COLUMN_OVERVIEW_DELETE_DIALOG_DESCRIPTION:"FC_COLUMN_OVERVIEW_DELETE_DIALOG_DESCRIPTION",FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE:"FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE",FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE:"FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE",FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP:"FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP",FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN:"FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN",FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN:"FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN",FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET:"FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET",FC_PREVIEW_GRID_HEADING_STAGE2:"FC_PREVIEW_GRID_HEADING_STAGE2",FC_ADDITIONAL_FILTER_HEADING:"FC_ADDITIONAL_FILTER_HEADING",FC_ADDITIONAL_FILTER_SUB_HEADING:"FC_ADDITIONAL_FILTER_SUB_HEADING",FC_OPTIONSET_PANEL_HEADER:"FC_OPTIONSET_PANEL_HEADER",FC_OPTIONSET_PANEL_OPTION_SUBHEADER:"FC_OPTIONSET_PANEL_OPTION_SUBHEADER",FC_COLUMN_OVERVIEW_RIBBON_ADD_FROM_OPTION_SET:"FC_COLUMN_OVERVIEW_RIBBON_ADD_FROM_OPTION_SET",FC_COLUMN_SELECTOR_ROW_TOOLTIP_STATUS:"FC_COLUMN_SELECTOR_ROW_TOOLTIP_STATUS",FC_COLUMN_SELECTOR_ROW_TOOLTIP_LOCK:"FC_COLUMN_SELECTOR_ROW_TOOLTIP_LOCK",FC_COLUMN_SELECTOR_QUOTA_ROW_TOOLTIP:"FC_COLUMN_SELECTOR_QUOTA_ROW_TOOLTIP",FC_COLUMN_EDITOR_DATEFIELD_HELPER:"FC_COLUMN_EDITOR_DATEFIELD_HELPER",FC_COLUMN_EDITOR_OPTIONSET_HELPER:"FC_COLUMN_EDITOR_OPTIONSET_HELPER",FC_COLUMN_EDITOR_AMOUNTFIELD_HELPER:"FC_COLUMN_EDITOR_AMOUNTFIELD_HELPER",FC_COLUMN_EDITOR_TYPEFIELD_HELPER:"FC_COLUMN_EDITOR_TYPEFIELD_HELPER",FC_COLUMN_EDITOR_DATATYPEFIELD_HELPER:"FC_COLUMN_EDITOR_DATATYPEFIELD_HELPER",FC_COLUMN_EDITOR_SELECTORFIELD_HELPER:"FC_COLUMN_EDITOR_SELECTORFIELD_HELPER",FC_COLUMN_EDITOR_ATTRIBUTE_HELPER:"FC_COLUMN_EDITOR_ATTRIBUTE_HELPER",FC_COLUMN_EDITOR_DESCRIPTION_HELPER:"FC_COLUMN_EDITOR_DESCRIPTION_HELPER",FC_CRM_DELETING_CALLS:"FC_CRM_DELETING_CALLS",FC_CRM_ARCHIVING_CALLS:"FC_CRM_ARCHIVING_CALLS",FC_CRM_PUBLISHING_CALLS:"FC_CRM_PUBLISHING_CALLS",FC_CRM_SAVING_CALLS:"FC_CRM_SAVING_CALLS",FC_CRM_PROCESSING_CALLS:"FC_CRM_PROCESSING_CALLS",FC_CREATE_SNAPSHOT_CALLS:"FC_CREATE_SNAPSHOT_CALLS",FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE",FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE",FC_GRID_CREATE_SNAPSHOT_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_CREATE_SNAPSHOT_CONTEXTUALBUTTON_GRIDPAGE",FC_GRID_PUBLISH_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_PUBLISH_CONTEXTUALBUTTON_GRIDPAGE",FC_EDIT_FIELD_MANDATORY_MESSAGE:"FC_EDIT_FIELD_MANDATORY_MESSAGE",FC_STAGE1_ROLLUP_ENTITY_HELPTEXT:"FC_STAGE1_ROLLUP_ENTITY_HELPTEXT",FC_STAGE1_HIERARCHY_ENTITY_HELPTEXT:"FC_STAGE1_HIERARCHY_ENTITY_HELPTEXT",FD_NOTIFICATION_MESSAGE:"FD_NOTIFICATION_MESSAGE",FORECAST_CONFIG_GENERIC_PUBLISH_FAILURE:"FORECAST_CONFIG_GENERIC_PUBLISH_FAILURE",FORECAST_CONFIG_GENERIC_DELETE_FAILURE:"FORECAST_CONFIG_GENERIC_DELETE_FAILURE",FORECAST_CONFIG_GENERIC_UPDATE_FAILURE:"FORECAST_CONFIG_GENERIC_UPDATE_FAILURE",FORECAST_CONFIG_GENERIC_RETREIVE_HIERARCHY_FAILURE:"FORECAST_CONFIG_GENERIC_RETREIVE_HIERARCHY_FAILURE",FORECAST_CONFIG_GENERIC_RETREIVE_METADATA_FAILURE:"FORECAST_CONFIG_GENERIC_RETREIVE_METADATA_FAILURE",FORECAST_CONFIG_GENERIC_RETREIVE_ORGANIZATION_INFO_FAILURE:"FORECAST_CONFIG_GENERIC_RETREIVE_ORGANIZATION_INFO_FAILURE",FC_GRID_DEACTIVATE_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_DEACTIVATE_CONTEXTUALBUTTON_GRIDPAGE",FC_WARNING_FD_REMOVED_FC_ADDED:"FC_WARNING_FD_REMOVED_FC_ADDED",FC_WARNING_READ_MORE:"FC_WARNING_READ_MORE",FC_DELETE_FAILURE_TITLE:"FC_DELETE_FAILURE_TITLE",FC_PUBLISH_FAILED_MORE_THAN_SIX:"FC_PUBLISH_FAILED_MORE_THAN_SIX",FC_PUBLISH_FAILED_MAXCOUNT:"FC_PUBLISH_FAILED_MAXCOUNT",FC_PUBLISH_FAILURE_TITLE:"FC_PUBLISH_FAILURE_TITLE",FC_CREATE_FAILURE_TITLE:"FC_CREATE_FAILURE_TITLE",FC_UPDATE_FAILURE_TITLE:"FC_UPDATE_FAILURE_TITLE",FC_FETCHING_ORG_FAILURE_TITLE:"FC_FETCHING_ORG_FAILURE_TITLE",FC_ERROR_SOMETHING_WENT_WRONG_TITLE:"FC_ERROR_SOMETHING_WENT_WRONG_TITLE",FC_ERROR_DELETE_COLUMN_HEADER:"FC_ERROR_DELETE_COLUMN_HEADER",FC_ERROR_DELETE_COLUMN_DEPENDENTLIST:"FC_ERROR_DELETE_COLUMN_DEPENDENTLIST",FC_FETCHING_FAILURE_TITLE:"FC_FETCHING_FAILURE_TITLE",FC_ERROR_TRY_AGAIN_DESC:"FC_ERROR_TRY_AGAIN_DESC",FC_HIERARCHY_FAILURE_DESC:"FC_HIERARCHY_FAILURE_DESC",FC_ORG_DETAILS_DESC:"FC_ORG_DETAILS_DESC",FC_FETCHING_FAILURE_DESC:"FC_FETCHING_FAILURE_DESC",FC_OK:"FC_OK",FC_TEMPLATE_TYPE_ORG_CHART:"FC_TEMPLATE_TYPE_ORG_CHART",FC_Title:"FC_Title",FC_Date:"FC_Date",FC_Number:"FC_Number",FC_Increase:"FC_Increase",FC_Decrease:"FC_Decrease",FC_TEMPLATE_TYPE_TERRITORY_BASED:"FC_TEMPLATE_TYPE_TERRITORY_BASED",FC_TEMPLATE_TYPE_CREATE_FROM_SCRATCH:"FC_TEMPLATE_TYPE_CREATE_FROM_SCRATCH",FC_TERRITORY_ENTITY_DISPLAYNAME:"FC_TERRITORY_ENTITY_DISPLAYNAME",FC_FORM_LOAD_ERROR_INVALID_TEMPLATE_TYPE:"FC_FORM_LOAD_ERROR_INVALID_TEMPLATE_TYPE",FC_FORM_LOAD_ERROR_MISSING_TEMPLATE_TYPE:"FC_FORM_LOAD_ERROR_MISSING_TEMPLATE_TYPE",FC_FORM_LOAD_ERROR_MISSING_FCID:"FC_FORM_LOAD_ERROR_MISSING_FCID",FC_HIERARCHY_ROUTE_TWO_LEVELS:"FC_HIERARCHY_ROUTE_TWO_LEVELS",FC_HIERARCHY_ROUTE_THREE_LEVELS:"FC_HIERARCHY_ROUTE_THREE_LEVELS",FC_HIERARCHY_ROUTE_FIELD_LABEL:"FC_HIERARCHY_ROUTE_FIELD_LABEL",FC_HIERARCHY_ROUTE_FIELD_PLACEHOLDER:"FC_HIERARCHY_ROUTE_FIELD_PLACEHOLDER",FC_HIERARCHY_ROUTE_CONTROL_NOOPTION_MESSAGE:"FC_HIERARCHY_ROUTE_CONTROL_NOOPTION_MESSAGE",FC_HIERARCHY_ROUTE_CONTROL_FILTER_NOOPTION_MESSAGE:"FC_HIERARCHY_ROUTE_CONTROL_FILTER_NOOPTION_MESSAGE",FC_HIERARCHY_ROUTE_CONTROL_NOOPTION_BOTH_MESSAGE:"FC_HIERARCHY_ROUTE_CONTROL_NOOPTION_BOTH_MESSAGE",FC_HIERARCHY_ROUTE_CONTROL_HEADER_MESSAGE:"FC_HIERARCHY_ROUTE_CONTROL_HEADER_MESSAGE",FC_HIERARCHY_ROUTE_CONTROL_GROUP_RELATED_TOOLTIP:"FC_HIERARCHY_ROUTE_CONTROL_GROUP_RELATED_TOOLTIP",FC_HIERARCHY_ROUTE_CONTROL_GROUP_SEARCH:"FC_HIERARCHY_ROUTE_CONTROL_GROUP_SEARCH",FC_HIERARCHY_ROUTE_CONTROL_GROUP_RELATED:"FC_HIERARCHY_ROUTE_CONTROL_GROUP_RELATED",FC_PERMISSIONS_ATTRIBUTE_NONE:"FC_PERMISSIONS_ATTRIBUTE_NONE",FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_TITLE:"FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_TITLE",FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_SUBTITLE:"FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_SUBTITLE",FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL:"FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL",FC_PERMISSIONS_STAGE_HIERARCHY_ATTRIBUTE_FIELD_LABEL:"FC_PERMISSIONS_STAGE_HIERARCHY_ATTRIBUTE_FIELD_LABEL",FC_HIERARCHY_REL_NOT_PRESENT_MESSAGE:"FC_HIERARCHY_REL_NOT_PRESENT_MESSAGE",FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_HEADER:"FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_HEADER",FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_SUBITITLE:"FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_SUBITITLE",FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_NONE:"FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_NONE",FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_ALLOWALL:"FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_ALLOWALL",FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_SPECIFIC_ROLES:"FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_SPECIFIC_ROLES",FC_PERMISSIONS_STAGE_ROLE_PICKER_PLACEHOLDER:"FC_PERMISSIONS_STAGE_ROLE_PICKER_PLACEHOLDER",FC_PERMISSIONS_STAGE_ROLE_PICKER_NO_DATA:"FC_PERMISSIONS_STAGE_ROLE_PICKER_NO_DATA",FC_PERMISSIONS_STAGE_ROLE_PICKER_ITEM_REMOVE_BUTTON_TOOLTIP:"FC_PERMISSIONS_STAGE_ROLE_PICKER_ITEM_REMOVE_BUTTON_TOOLTIP",FC_PERMISSIONS_MESSAGE_USER_ONLY:"FC_PERMISSIONS_MESSAGE_USER_ONLY",FC_PERMISSIONS_MESSAGE_ROLE_ONLY:"FC_PERMISSIONS_MESSAGE_ROLE_ONLY",FC_PERMISSIONS_MESSAGE_ALLOW_ALL_ONLY:"FC_PERMISSIONS_MESSAGE_ALLOW_ALL_ONLY",FC_PERMISSIONS_MESSAGE_USER_AND_ROLE:"FC_PERMISSIONS_MESSAGE_USER_AND_ROLE",FC_PERMISSIONS_MESSAGE_USER_AND_ALLOW_ALL:"FC_PERMISSIONS_MESSAGE_USER_AND_ALLOW_ALL",FC_PERMISSIONS_MANDATORY_ERROR_MESSAGE:"FC_PERMISSIONS_MANDATORY_ERROR_MESSAGE",FC_ROLLUP_ENTITY_VIEWSELECTOR_LABEL:"FC_ROLLUP_ENTITY_VIEWSELECTOR_LABEL",FC_HIERARCHY_REL_NOT_PRESENT_DIALOG_HEADER:"FC_HIERARCHY_REL_NOT_PRESENT_DIALOG_HEADER",SNAPSHOT_STATUS_GRID_NAME_HEADER:"SNAPSHOT_STATUS_GRID_NAME_HEADER",SNAPSHOT_STATUS_GRID_CREATEDAT_HEADER:"SNAPSHOT_STATUS_GRID_CREATEDAT_HEADER",SNAPSHOT_STATUS_GRID_CREATEDBYNAME_HEADER:"SNAPSHOT_STATUS_GRID_CREATEDBYNAME_HEADER",SNAPSHOT_STATUS_GRID_STATUS_HEADER:"SNAPSHOT_STATUS_GRID_STATUS_HEADER",SNAPSHOT_STATUS_GRID_ARIA_LABEL:"SNAPSHOT_STATUS_GRID_ARIA_LABEL",SNAPSHOT_STATUS_GRID_MORE_COMMANDS:"SNAPSHOT_STATUS_GRID_MORE_COMMANDS",SNAPSHOT_STATUS_DELETE_SNAPSHOT_CONFIRM:"SNAPSHOT_STATUS_DELETE_SNAPSHOT_CONFIRM",SNAPSHOT_STATUS_CREATE_SNAPSHOT_CONFIRM:"SNAPSHOT_STATUS_CREATE_SNAPSHOT_CONFIRM",SNAPSHOT_STATUS_CREATE_SNAPSHOT_CANCEL:"SNAPSHOT_STATUS_CREATE_SNAPSHOT_CANCEL",SNAPSHOT_STATUS_CREATE_SNAPSHOT_MESSAGE:"SNAPSHOT_STATUS_CREATE_SNAPSHOT_MESSAGE",SNAPSHOT_STATUS_DELETE_SNAPSHOT_MESSAGE:"SNAPSHOT_STATUS_DELETE_SNAPSHOT_MESSAGE",SNAPSHOT_STATUS_CREATE_SNAPSHOt_TITLE:"SNAPSHOT_STATUS_CREATE_SNAPSHOt_TITLE",SNAPSHOT_STATUS_DELETE_SNAPSHOT_TITLE:"SNAPSHOT_STATUS_DELETE_SNAPSHOT_TITLE",EXP_PARSER_ERROR_INVALID_CHARACTER:"EXP_PARSER_ERROR_INVALID_CHARACTER",EXP_PARSER_ERROR_INVALID_COLUMNREF:"EXP_PARSER_ERROR_INVALID_COLUMNREF",EXP_PARSER_ERROR_INVALID_COLUMNTYPE:"EXP_PARSER_ERROR_INVALID_COLUMNTYPE",EXP_PARSER_ERROR_INVALID_COLUMN_DATATYPE:"EXP_PARSER_ERROR_INVALID_COLUMN_DATATYPE",EXP_PARSER_ERROR_MISSING_OPERAND:"EXP_PARSER_ERROR_MISSING_OPERAND",EXP_PARSER_ERROR_MISSING_RIGHT_PARANTHESIS:"EXP_PARSER_ERROR_MISSING_RIGHT_PARANTHESIS",EXP_PARSER_ERROR_UNEXPECTED_TOKENS:"EXP_PARSER_ERROR_UNEXPECTED_TOKENS",EXP_PARSER_ERROR_SELFREFERENCE:"EXP_PARSER_ERROR_SELFREFERENCE",EXP_PARSER_ERROR_CIRCULAR_DEPENDENCY:"EXP_PARSER_ERROR_CIRCULAR_DEPENDENCY",EXP_VALIDATION_ERROR_NULL_UNDEFINED_ARGUMENT:"EXP_VALIDATION_ERROR_NULL_UNDEFINED_ARGUMENT",EXP_VALDATION_ERROR_NULL_EMPTY_ARGUMENT:"EXP_VALDATION_ERROR_NULL_EMPTY_ARGUMENT",MF_ENABLE_ADMIN_SETTINGS_DIALOG:"MF_ENABLE_ADMIN_SETTINGS_DIALOG",MF_ADMIN_SETTINGS_CONTENT_DESC:"MF_ADMIN_SETTINGS_CONTENT_DESC",MF_ADMIN_SETTINGS_CONTENT_TITLE:"MF_ADMIN_SETTINGS_CONTENT_TITLE",MF_ADMIN_SETTINGS_ENABLE_BUTTON_TEXT:"MF_ADMIN_SETTINGS_ENABLE_BUTTON_TEXT",MF_ADMIN_SETTINGS_LEARN_MORE_BUTTON_TEXT:"MF_ADMIN_SETTINGS_LEARN_MORE_BUTTON_TEXT",MF_ADMIN_SETTINGS_DIALOG_TITLE:"MF_ADMIN_SETTINGS_DIALOG_TITLE",MF_ADMIN_SETTINGS_DIALOG_DESC:"MF_ADMIN_SETTINGS_DIALOG_DESC",MF_ADMIN_SETTINGS_DIALOG_PRIMARYBUTTON:"MF_ADMIN_SETTINGS_DIALOG_PRIMARYBUTTON",MF_ADMIN_SETTINGS_ENABLE_FAILED_PRIVILEGE_MESSAGE:"MF_ADMIN_SETTINGS_ENABLE_FAILED_PRIVILEGE_MESSAGE",SNAPSHOT_STATUS_IN_PROGRESS:"SNAPSHOT_STATUS_IN_PROGRESS",SNAPSHOT_STATUS_FAIL:"SNAPSHOT_STATUS_FAIL",SNAPSHOT_STATUS_SUCCESS:"SNAPSHOT_STATUS_SUCCESS",NoFcMsgTitle:"NoFcMsgTitle",NoFcMsgDesc:"NoFcMsgDesc",NoFcMsgLearnMore:"NoFcMsgLearnMore",MF_MAX_HIERARCHY_RECORDS_MESSAGE:"MF_MAX_HIERARCHY_RECORDS_MESSAGE",CREATE_SNAPSHOT_PLACEHOLDER:"CREATE_SNAPSHOT_PLACEHOLDER",CREATE_SNAPSHOT_FAILED_PRIVILEGE_MESSAGE:"CREATE_SNAPSHOT_FAILED_PRIVILEGE_MESSAGE",CREATE_SNAPSHOT_GENERIC_ERROR_MESSAGE:"CREATE_SNAPSHOT_GENERIC_ERROR_MESSAGE",CREATE_SNAPSHOT_FIELD_NAME:"CREATE_SNAPSHOT_FIELD_NAME",PF_LAST_PREDICTED_ON:"PF_LAST_PREDICTED_ON",PF_PREDICTION_FAILED:"PF_PREDICTION_FAILED",PF_PREDICTION_INFO_TOOLTIP:"PF_PREDICTION_INFO_TOOLTIP",PF_PREDICTION_FAILED_INTERNALEXC_TOOLTIP:"PF_PREDICTION_FAILED_INTERNALEXC_TOOLTIP",PF_PREDICTION_FAILED_INSUFFICIENTDATA_TOOLTIP:"PF_PREDICTION_FAILED_INSUFFICIENTDATA_TOOLTIP",PF_PREDICTIONSTATUS_INPROGRESS_TOOLTIP:"PF_PREDICTIONSTATUS_INPROGRESS_TOOLTIP",INVALID_SNAPSHOT_NAME:"INVALID_SNAPSHOT_NAME",FC_STEP:"Step ",FORECAST_PREDICTIVE_HEADING_GRIDPAGE:"FORECAST_PREDICTIVE_HEADING_GRIDPAGE",FORECAST_PREDICTIONS_GRIDPAGE:"FORECAST_PREDICTIONS_GRIDPAGE",FORECAST_SNAPSHOTS_GRIDPAGE:"FORECAST_SNAPSHOTS_GRIDPAGE",FORECAST_PREDICTIVE_DETAILS_GRIDPAGE:"FORECAST_PREDICTIVE_DETAILS_GRIDPAGE",FORECAST_SNAPSHOTS_DETAILS_GRIDPAGE:"FORECAST_SNAPSHOTS_DETAILS_GRIDPAGE",FORECAST_PREDICTIVE_FCLIST_GRIDPAGE:"FORECAST_PREDICTIVE_FCLIST_GRIDPAGE",FORECAST_PREDICTIVE_ENABLE_GRIDPAGE:"FORECAST_PREDICTIVE_ENABLE_GRIDPAGE",FORECAST_PREDICTIVE_MINIMUM_REQ_GRIDPAGE:"FORECAST_PREDICTIVE_MINIMUM_REQ_GRIDPAGE",FORECAST_PREDICTIVE_VISIBILITY_GRIDPAGE:"FORECAST_PREDICTIVE_VISIBILITY_GRIDPAGE",FORECAST_PREDICTIVE_NOFORECAST_GRIDPAGE:"FORECAST_PREDICTIVE_NOFORECAST_GRIDPAGE",FORECAST_PREDICTIVE_EMPOWERTEAM_GRIDPAGE:"FORECAST_PREDICTIVE_EMPOWERTEAM_GRIDPAGE",FORECAST_PREDICTIVE_LINK_FCPREDICTION_GRIDPAGE:"FORECAST_PREDICTIVE_LINK_FCPREDICTION_GRIDPAGE",FORECAST_PREDICTIVE_LINK_GRIDPAGE:"FORECAST_PREDICTIVE_LINK_GRIDPAGE",FORECAST_PREDICTIVE_STATUS_ON:"FORECAST_PREDICTIVE_STATUS_ON",FORECAST_PREDICTIVE_STATUS_OFF:"FORECAST_PREDICTIVE_STATUS_OFF",FC_GRID_COLUMN_NAME_PREDICTION_STATUS_GRIDPAGE:"FC_GRID_COLUMN_NAME_PREDICTION_STATUS_GRIDPAGE",FC_GRID_COLUMN_NAME_FREQUENCY_GRIDPAGE:"FC_GRID_COLUMN_NAME_FREQUENCY_GRIDPAGE",FC_GRID_COLUMN_NAME_PREDICTION_LASTRUNDATE_GRIDPAGE:"FC_GRID_COLUMN_NAME_PREDICTION_LASTRUNDATE_GRIDPAGE"}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=[];function o(e,t,n,r,o,a,s){void 0===r&&(r={}),i.map((function(i){i.logLevel<=e&&i.logCategory(e,t,n,r,o,a,s)}))}t.logInfo=function(e,t,n,i,a,s){void 0===n&&(n={}),o(r.ILogLevel.Info,e,t,n,i,a,s)},t.logError=function(e,t,n,r,o,a,s){void 0===r&&(r={}),i.map((function(i){i.logError(e,t,n,r,o,a,s)}))},t.logWarning=function(e,t,n,i,a,s){void 0===n&&(n={}),o(r.ILogLevel.Warning,e,t,n,i,a,s)},t.logUsage=function(e,t,n,i,a,s){void 0===n&&(n={}),o(r.ILogLevel.Usage,e,t,n,i,a,s)},t.addLogger=function(e){i.push(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Enabled=0]="Enabled",e[e.Disabled=1]="Disabled",e[e.Locked=2]="Locked",e[e.Incomplete=3]="Incomplete",e[e.DuplicateUniqueName=4]="DuplicateUniqueName"}(t.ForecastColumnStatus||(t.ForecastColumnStatus={})),function(e){e[e.Rollup=0]="Rollup",e[e.Calculated=1]="Calculated",e[e.Simple=2]="Simple",e[e.Predictive=3]="Predictive",e[e.HierarchyPrimary=4]="HierarchyPrimary",e[e.HierarchySecondary=5]="HierarchySecondary"}(t.ForecastColumnType||(t.ForecastColumnType={})),function(e){e[e.Currency=1]="Currency",e[e.Decimal=2]="Decimal",e[e.SingleLineOfText=3]="SingleLineOfText",e[e.NotSupported=4]="NotSupported"}(t.ForecastColumnDataType||(t.ForecastColumnDataType={})),function(e){e[e.FcbOff=0]="FcbOff",e[e.FcbOn=1]="FcbOn"}(t.PredictiveAvailabilityStateType||(t.PredictiveAvailabilityStateType={})),function(e){e[e.Draft=1]="Draft",e[e.Processing=2]="Processing",e[e.Published=3]="Published",e[e.Failed=4]="Failed",e[e.Archived=5]="Archived"}(t.IForecastConfigStatus||(t.IForecastConfigStatus={})),function(e){e[e.OrgChart=1]="OrgChart",e[e.TerritoryBased=2]="TerritoryBased",e[e.ProductBased=3]="ProductBased",e[e.Custom=4]="Custom"}(t.ForecastConfigTemplateType||(t.ForecastConfigTemplateType={})),function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Usage=3]="Usage",e[e.Error=4]="Error"}(t.ILogLevel||(t.ILogLevel={})),function(e){e[e.NOTIFY_RECOMPUTE_STATUS_EVENTS=0]="NOTIFY_RECOMPUTE_STATUS_EVENTS",e[e.NOTIFY_FC_PUBLISH_EVENTS=1]="NOTIFY_FC_PUBLISH_EVENTS",e[e.NOTIFY_QUOTA_UPLOAD_EVENTS=2]="NOTIFY_QUOTA_UPLOAD_EVENTS",e[e.NOTIFY_MANUAL_ADJUSTMENT_EVENTS=3]="NOTIFY_MANUAL_ADJUSTMENT_EVENTS"}(t.NotificationEventType||(t.NotificationEventType={})),function(e){e[e.INFORMATION=0]="INFORMATION",e[e.WARNING=1]="WARNING",e[e.ERROR=2]="ERROR"}(t.NotificationMessageType||(t.NotificationMessageType={})),function(e){e[e.All=1]="All",e[e.User=2]="User",e[e.Role=3]="Role"}(t.PermissionType||(t.PermissionType={})),function(e){e[e.GenericError=1]="GenericError",e[e.ActiveFCCountThresholdExceeded=2]="ActiveFCCountThresholdExceeded"}(t.AzActivationFailureType||(t.AzActivationFailureType={}))},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(97),o=n(7),a=n(8),s=n(393),l=n(87),c=n(105),u=n(96),d=n(164);t.NON_REQ_FIELDS=["statusDescription","id","owner","columns","startAtQuater","startAtMonth","additionalFilter","createdon"],t.ForecastConfig_Fields_Stage1=["name","rollupEntity","hierarchyEntity","hierarchyRelationship","topOfHierarchy","period","fiscalyear","fromDate","toDate","numberOfRecurrences","startAtQuater","startAtMonth","rollupEntityDefaultView"],t.ForecastConfig_Fields_Stage2=["forecastCategoryAttributeName","name"],t.ForecastConfig_Fields_Stage3=["forecastCategoryAttributeName","name"],t.ForecastConfig_Fields_Stage4=["permissionsData","name"],t.OrderedFormStages=[i.ForecastConfigStage.General,i.ForecastConfigStage.Permission,i.ForecastConfigStage.View,i.ForecastConfigStage.Quota];var p=function(){function e(){}return e.getForecastConfigFieldsForStage=function(e){switch(e){case i.ForecastConfigStage.General:return t.ForecastConfig_Fields_Stage1;case i.ForecastConfigStage.View:return t.ForecastConfig_Fields_Stage2;case i.ForecastConfigStage.Quota:return t.ForecastConfig_Fields_Stage3;case i.ForecastConfigStage.Permission:return t.ForecastConfig_Fields_Stage4;default:return[]}},e.GetStageStepId=function(e){switch(e){case i.ForecastConfigStage.General:return"1";case i.ForecastConfigStage.Permission:return"2";case i.ForecastConfigStage.View:return"3";case i.ForecastConfigStage.Quota:return"4";default:return""}},e.GetStageTitleText=function(e){switch(e){case i.ForecastConfigStage.General:return"1";case i.ForecastConfigStage.Permission:return"2";case i.ForecastConfigStage.View:return"3";case i.ForecastConfigStage.Quota:return"4";default:return""}},e.GetStageDecriptionText=function(e){switch(e){case i.ForecastConfigStage.General:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_EDIT_STEPPER_STAGE1_EDITPAGE);case i.ForecastConfigStage.View:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_EDIT_STEPPER_STAGE2_EDITPAGE);case i.ForecastConfigStage.Quota:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_EDIT_STEPPER_STAGE3_EDITPAGE);case i.ForecastConfigStage.Permission:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_EDIT_STEPPER_STAGE4_EDITPAGE);default:return""}},e.getIndexOfStage=function(e){return t.OrderedFormStages.indexOf(e)},e.GetLengthofOrderedStepperStages=function(){return t.OrderedFormStages.length},e.getDelphiStepViaIndex=function(e){return t.OrderedFormStages[e]},e.getStageFromStepId=function(e){switch(e){case"1":return i.ForecastConfigStage.General;case"2":return i.ForecastConfigStage.Permission;case"3":return i.ForecastConfigStage.View;case"4":return i.ForecastConfigStage.Quota;default:return-1}},e.getPreviousStage=function(t){var n=e.getIndexOfStage(t);return e.getDelphiStepViaIndex(n-1)},e.getNextStage=function(t){var n=e.getIndexOfStage(t);return e.getDelphiStepViaIndex(n+1)},e.isFirstStageofOrderedStepperStages=function(t){return 0==e.getIndexOfStage(t)},e.isLastStageofOrderedStepperStages=function(t){return e.getIndexOfStage(t)==e.GetLengthofOrderedStepperStages()-1},e.IsRequiredField=function(e){return-1==t.NON_REQ_FIELDS.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},e.FieldHasNonNullValue=function(e,t){if(null==t)return!1;var n=""!==t;return n&&t&&0==t.length&&(n=!1),n},e.IsFieldPresentInStageForm=function(e,t){return-1!=t.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},e.GetColumnInfoStatus=function(e,t,n,i){return e&&e.columnType==r.ForecastColumnType.Predictive?i.isSIPackageInstalled?r.ForecastColumnStatus.Enabled:r.ForecastColumnStatus.Disabled:this.IsColumnInfoLocked(e)||this.IsFCInProgress(n)?r.ForecastColumnStatus.Disabled:this.AreRequiredFieldsFilledForColumnInfo(e)?t?r.ForecastColumnStatus.DuplicateUniqueName:r.ForecastColumnStatus.Enabled:r.ForecastColumnStatus.Incomplete},e.AreRequiredFieldsFilledForColumnInfo=function(e){var t=this.FieldHasNonNullValue("title",e.title);return t=(t=t&&this.FieldHasNonNullValue("columnType",e.columnType))&&this.FieldHasNonNullValue("uniqueName",e.uniqueName),e.columnType==r.ForecastColumnType.Rollup?t=t&&this.FieldHasNonNullValue("dateField",e.dateField)&&this.FieldHasNonNullValue("amountField",e.amountField):e.columnType==r.ForecastColumnType.Calculated?t=t&&this.FieldHasNonNullValue("calculatedFieldExpression",e.calculatedFieldExpression):e.columnType==r.ForecastColumnType.HierarchySecondary&&(t=t&&null!=e.hierarchyAttributeInfo&&null!=e.hierarchyAttributeInfo&&null!=e.hierarchyAttributeInfo.attributeName&&null!=e.hierarchyAttributeInfo.relationship),t},e.IsColumnInfoLocked=function(e){return e.columnType==r.ForecastColumnType.HierarchyPrimary},e.GetColumnDataTypeOptionsBasedOnCurrentType=function(e){var t=[{key:r.ForecastColumnDataType.SingleLineOfText,text:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_DATATYPE_TEXT)},{key:r.ForecastColumnDataType.Currency,text:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_DATATYPE_CURRENCY)},{key:r.ForecastColumnDataType.Decimal,text:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_DATATYPE_DECIMAL)}],n=t.filter((function(e){return e.key!==r.ForecastColumnDataType.SingleLineOfText}));switch(e){case r.ForecastColumnType.Calculated:return n}return t},e.GetColumnTypeOptionsBasedOnCurrentType=function(e){var t=[{key:r.ForecastColumnType.Rollup,text:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_ROLLUP)},{key:r.ForecastColumnType.Calculated,text:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_CALCULATED)},{key:r.ForecastColumnType.Simple,text:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_SIMPLE)},{key:r.ForecastColumnType.HierarchyPrimary,text:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY)},{key:r.ForecastColumnType.HierarchySecondary,text:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY)}],n=t.filter((function(e){return e.key==r.ForecastColumnType.Rollup||e.key==r.ForecastColumnType.Calculated||e.key==r.ForecastColumnType.HierarchySecondary||e.key==r.ForecastColumnType.Simple}));switch(e){case r.ForecastColumnType.Rollup:case r.ForecastColumnType.Calculated:case r.ForecastColumnType.HierarchySecondary:case r.ForecastColumnType.Simple:case void 0:return n}return t},e.GetIsColumnTypeControlDisabledBasedOnCurrentType=function(e,t){switch(t){case r.ForecastColumnType.HierarchyPrimary:return!0;case r.ForecastColumnType.Simple:if("quota"==e)return!0}return!1},e.GetIsShowInChartDisabledBasedOnDataType=function(e){switch(e){case r.ForecastColumnDataType.Currency:return!1;default:return!0}return!0},e.GetIsColumnDataTypeControlDisabledBasedOnCurrentType=function(e,t){switch(t){case r.ForecastColumnType.Calculated:case void 0:return!1;case r.ForecastColumnType.Simple:return"quota"==e}return!0},e.ConvertCrmDataTypeToForecastConfigColumnDataType=function(e){switch(e){case d.EDataType.Decimal:case d.EDataType.Float:case d.EDataType.WholeNumber:return r.ForecastColumnDataType.Decimal;case d.EDataType.String:case d.EDataType.MultilineText:case d.EDataType.Owner:case d.EDataType.Lookup:return r.ForecastColumnDataType.SingleLineOfText;case d.EDataType.Currency:return r.ForecastColumnDataType.Currency}return r.ForecastColumnDataType.NotSupported},e.IsColumnOverviewContextButtonDisabled=function(e,t,n,i,o,a){switch(e){case s.ColumnSelectorActionType.Delete:if(this.IsFormStatusReadOnly(n))return!0;if("quota"==i||t==r.ForecastColumnType.HierarchyPrimary||t==r.ForecastColumnType.Predictive)return!0;break;case s.ColumnSelectorActionType.MoveUp:if(!o||t==r.ForecastColumnType.HierarchyPrimary||1==a)return!0;break;case s.ColumnSelectorActionType.MoveDown:if(!o||t==r.ForecastColumnType.HierarchyPrimary)return!0;break;case s.ColumnSelectorActionType.Configure:if(t==r.ForecastColumnType.Predictive)return!0}return!1},e.IsFormStatusReadOnly=function(e){return e==r.IForecastConfigStatus.Published||e==r.IForecastConfigStatus.Archived||this.IsFCInProgress(e)},e.IsFCInProgress=function(e){return e==r.IForecastConfigStatus.Processing},e.getTitleForGenericErrorDialog=function(e){switch(e){case l.IErrorDialogType.GenericFailure:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE);case l.IErrorDialogType.ForecastConfigDeleteFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_DELETE_FAILURE_TITLE);case l.IErrorDialogType.ForecastConfigPublishFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_PUBLISH_FAILURE_TITLE);case l.IErrorDialogType.FetchingHierarchyDataFailed:case l.IErrorDialogType.RetreivingMetadataFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE);case l.IErrorDialogType.FetchingOrgDetailsFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_FETCHING_ORG_FAILURE_TITLE);case l.IErrorDialogType.ForecastConfigUpdateFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_UPDATE_FAILURE_TITLE);case l.IErrorDialogType.ForecastConfigFetchingFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE);case l.IErrorDialogType.ForecastConfigCreateFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_CREATE_FAILURE_TITLE);case l.IErrorDialogType.ForecastConfigFormLoadError:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE);case l.IErrorDialogType.ForecastConfigColDeleteFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_DELETE_COLUMN_HEADER);case l.IErrorDialogType.HierarchyRelationsDoesntExistDialog:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_HIERARCHY_REL_NOT_PRESENT_DIALOG_HEADER);case l.IErrorDialogType.EnableMFAdminSettingsFailedDialog:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.MF_ENABLE_ADMIN_SETTINGS_DIALOG)}return""},e.getDescriptionForGenericErrorDialog=function(e){switch(e){case l.IErrorDialogType.GenericFailure:case l.IErrorDialogType.ForecastConfigDeleteFailed:case l.IErrorDialogType.ForecastConfigPublishFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_TRY_AGAIN_DESC);case l.IErrorDialogType.FetchingHierarchyDataFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_HIERARCHY_FAILURE_DESC);case l.IErrorDialogType.RetreivingMetadataFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ORG_DETAILS_DESC);case l.IErrorDialogType.FetchingOrgDetailsFailed:case l.IErrorDialogType.ForecastConfigUpdateFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_TRY_AGAIN_DESC);case l.IErrorDialogType.ForecastConfigFetchingFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_FETCHING_FAILURE_DESC);case l.IErrorDialogType.ForecastConfigCreateFailed:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_TRY_AGAIN_DESC)}return""},e.getRelationshipDepth=function(e){for(var t=0,n=JSON.parse(JSON.stringify(e));null!=n&&null!=n.relationship;)t+=1,n=n.relationship;return t},e.getHierarchyRouteDisplayStrings=function(e,t){var n=[],r=JSON.parse(JSON.stringify(e));if(null!=t[r.entityName]){n.push(t[r.entityName].DisplayName);for(var i=r.entityName,o=r.relationship;null!=o&&null!=o.linkedByAttribute;){if(null==t[i]||null==t[i].AttributesMetadata||null==t[i].AttributesMetadata.DependentAttributes)return[];var a=t[i].AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName==o.linkedByAttribute}));a&&n.push(a.DisplayName),i=o.entityName,o=o.relationship}}return n},e.getColumnForPermissionsAttribute=function(t){if(t&&null!=t.permissionAttribueInfo&&"systemuserid"!=t.permissionAttribueInfo.attributeName)return{id:u.generateNewGuid(),title:t.permissionAttribueInfo.attributeName,dataType:r.ForecastColumnDataType.SingleLineOfText,columnType:r.ForecastColumnType.HierarchySecondary,isActive:!0,uniqueName:c.filterNonValidCharactersForUniqueName(t.permissionAttribueInfo.attributeName),hierarchyAttributeInfo:e.getLookupNameAttributeInfo(t.permissionAttribueInfo),isPermissionsColumn:!0}},e.sortBasedOnDisplayName=function(e,t){var n=e.title.toLowerCase(),r=t.title.toLowerCase();return n<r?-1:n>r?1:e.uniqueName<t.uniqueName?-1:1},e.getLookupNameAttributeInfo=function(t){for(var n=JSON.parse(JSON.stringify(t)),r=n.attributeName,i=n.relationship;null!=i.relationship;)i=i.relationship;var o=e.getLookupEntityInfo(r,i.entityName),a=o.lookupEntityName,s=o.primaryNameAttribute;return i.relationship={entityName:a,linkedByAttribute:r,relationship:null},n.attributeName=s,n},e.getLookupEntityInfo=function(e,t){return{lookupEntityName:"systemuser",primaryNameAttribute:"fullname"}},e}();t.ForecastingBusinessLogicProvider=p},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateFCPredictionStatus=function(e){return{type:"@@FormData/UpdateFCPredictionStatus",payload:{fcPredictionStatus:e}}},t.UpdateFieldValue=function(e,t){return{type:"@@FormData/UpdateFieldValue",payload:{data:e},context:t}},t.TriggerEditFormDiscard=function(e,t){return{type:"@@FormData/DiscardValue",payload:{shouldDiscardSelectedFields:e,fields:t}}},t.UpdateActiveForecastConfig=function(e){return{type:"@@ActiveForecastConfig/Update",payload:{forecastConfig:e}}},t.UpdateForecastConfigList=function(e){return{type:"@@FCList/Update",payload:{forecastConfigList:e}}},t.UpdateForecastConfigListMetadata=function(e){return{type:"@@FCList/UpdateMetadata",payload:{forecastConfigList:e}}},t.UpdateShowWarningsFlag=function(e){return{type:"@@FormUI/UpdateShowWarningsFlag",payload:{showWarnings:e}}},t.TriggerUndoColumnFormChanges=function(){return{type:"@@SaveEvents/TriggerUndoColumnFormChanges",payload:{}}},t.TriggerSave=function(e,t){return{type:"@@SaveEvents/TriggerSave",payload:{shouldClose:e,shouldCloseColumnEditorForm:t}}},t.TriggerFormRefreshed=function(){return{type:"@@FormEvents/FormRefreshed",payload:{}}},t.updateViewList=function(e,t){var n;return{type:"@@FormEvents/UpdateView",payload:{value:(n={},n[e]=t,n)}}},t.DetermineHierarchySelectorDialog=function(e,t){return{type:"@@HierarchyEntity/DetermineDialogFromState",payload:{data:e},context:t}},t.onHierarchyEntityActionCreator=function(e,t){return{type:"@@EditApp/OnUpdateHierarchyEntityShowDialog",payload:{hierarchyEntitydialogHiddenState:e,selectedHierarchyEntityName:t}}},t.FormsProSurveyActionCreator=function(e){return{type:"@@EditApp/FormsProSurveyDisplay",payload:{triggerSource:e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateIsEditorOpened=function(e){return{type:"@@ColumnEditorState/UpdateIsEditorOpened",payload:{isEditorOpened:e}}},t.UpdateHasUniqueNameBeenEdited=function(e){return{type:"@@ColumnEditorState/UpdateHasUniqueNameBeenEdited",payload:{hasUniqueNameBeenEdited:e}}},t.UpdateActiveForecastColumn=function(e){return{type:"@@ColumnEditorState/UpdateActiveForecastColumn",payload:{column:e}}},t.UpdateIsCalculatedFieldExpressionErrorHidden=function(e){return{type:"@@ColumnEditorState/UpdateIsCalculatedFieldExpressionErrorHidden",payload:{isCalculatedFieldExpressionErrorHidden:e}}},t.UpdateCalculatedFieldExpressionErrorMessage=function(e){return{type:"@@ColumnEditorState/UpdateCalculatedFieldExpressionErrorMessage",payload:{calculatedFieldExpressionErrorMessage:e}}},t.UpdateCalculatedFieldExpressionSuggestions=function(e){return{type:"@@ColumnEditorState/UpdateCalculatedFieldExpressionSuggestions",payload:{calculatedFieldExpressionSuggestions:e}}},t.UpdateIsSuggestionCalloutVisible=function(e){return{type:"@@ColumnEditorState/UpdateIsSuggestionCalloutVisible",payload:{isSuggestionCalloutVisible:e}}},t.UpdateColumnInfoField=function(e,t,n){return{type:"@@FormData/UpdateColumnInfoField",payload:{colId:e,fieldName:t,value:n}}},t.ClearRollupAndCalculatedColumns=function(){return{type:"@@FormData/ClearRollupAndCalculatedColumns",payload:{}}},t.AddColumn=function(e){return{type:"@@FormData/AddColumn",payload:{column:e}}},t.DeleteColumn=function(e){return{type:"@@FormData/DeleteColumn",payload:{id:e}}},t.ReplaceColumn=function(e,t){return{type:"@@FormData/ReplaceColumn",payload:{id:e,column:t}}},t.UpdateOptionSetList=function(e,t){return{type:"@@ColumnEditor/UpdateOptionSetInfoList",payload:{rollupEntity:e,list:t}}},t.UpdateIsChangeConfirmationDialogOpen=function(e){return{type:"@@ColumnEditorState/UpdateIsChangeConfirmationDialogOpen",payload:{isOpen:e}}},t.UpdateIsColumnConfigAutoPopulateDialogOpen=function(e){return{type:"@@ColumnOverview/UpdateIsColumnConfigAutoPopulateDialogOpen",payload:{isOpen:e}}},t.UpdateIsOptionSetSelectorOpened=function(e){return{type:"@@ColumnEditorState/UpdateIsOptionSetSelectorOpened",payload:{isOpen:e}}},t.TriggerCategoryValuesFetch=function(){return{type:"@@ColumnEditor/TriggerCategoryValuesFetch",payload:{}}},t.TriggerColumnConfigAutoPopulate=function(){return{type:"@@ColumnEditor/TriggerColumnConfigAutoPopulate",payload:{}}},t.UpdateSelectedOptionSetValue=function(e){return{type:"@@OptionSetChoiceList/UpdateSelectedValue",payload:{value:e}}},t.UpdatePredictiveAvailabilityState=function(e){return{type:"@@PredictiveFeature/UpdateAvailabilityState",payload:{value:e}}},t.ClearHierarchySecondaryColumns=function(){return{type:"@@FormData/ClearHierarchySecondaryColumns",payload:{}}}},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(130),o=n(164),a=n(833),s=n(834),l=n(835),c=n(836),u=n(837),d=n(838),p=n(839),_=n(840),E=n(841),S=n(457);t.createCrmDataAccessFromCrmUrl=function(e,t){var n=S.create({baseURL:e}),r=i.createCDSClientWithHttpClient(n),f=new o.CDSResolver(r);return{cdsResolver:f,cdsClient:r,forecastConfigAccess:new a.ForecastConfigDataAccess(n),crmMetadataAccess:new _.CrmMetaDataAccess(n),hierarchyDataAccess:new s.HierarchyDataAccess(n,f),quotaDataAccess:new l.QuotaDataAccess(n),organizationDataAccess:new c.OrganizationDataAccess(n,t),forecastDefintionDataAccess:new u.ForecastDefinitionDataAccess(n),siDataAccess:new d.SIDataAccess(n),roleDataAccess:new p.RoleDataAccess(n),snapshotDataAccess:new E.ForecastSnapshotDataAccess(n)}},t.getCrmDataAccessInstance=function(){return r},t.setCrmDataAccessInstsance=function(e){console.log("Setting Global CrmDataAccess instance"),r=e}},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=n(497),o=n(163),a=n(97),s=n(173);function l(e){return c(e.FormFieldData)}function c(e){var t=!0;return Object.keys(e).map((function(n){var i=e[n];r.ForecastingBusinessLogicProvider.IsRequiredField(n)&&!r.ForecastingBusinessLogicProvider.FieldHasNonNullValue(n,i)&&(t=!1)})),t}function u(e){return E(e.FormFieldData,e.ActiveForecastConfigInfo)}function d(e){return _(e.ActiveForecastConfigInfo)}function p(e){return e.mainPageType==o.IMainPageType.EditPage&&""==e.FormFieldData.id}t.GetFormData_fromState=function(e){return e.FormFieldData},t.GetSILicenseStatusFromState=function(e){return e.crmOrgInfo.isSILicenseAvailable},t.GetSIPackageStatusFromState=function(e){return e.crmOrgInfo.isSIPackageInstalled},t.GetFormState_FromState=function(e){return{showEmptyWarnings:e.formUIState.showEmptyFieldWarnings,hasAllRequiredFieldsFilled:l(e)}},t.GetHasRequiredFieldsFilled_FromState=l,t.GetHasRequiredFieldsFilled=c,t.IsFormValidForSave_FromState=function(e){return 0==r.ForecastingBusinessLogicProvider.IsFormStatusReadOnly(e.FormFieldData.status)?u(e):u(e)&&s.GetHasRequiredFieldsFilled_ForStage_FromState(e,a.ForecastConfigStage.General)&&s.GetHasRequiredFieldsFilled_ForStage_FromState(e,a.ForecastConfigStage.Permission)&&s.GetHasRequiredFieldsFilled_ForStage_FromState(e,a.ForecastConfigStage.View)&&s.GetHasRequiredFieldsFilled_ForStage_FromState(e,a.ForecastConfigStage.Quota)},t.GetIsFormDirty_FromState=u,t.GetIsFormLocked_FromState=d,t.ArePostPublishUpdatableFieldsUpdatable=function(e){return!(d(e)&&!p(e))||!function(e){return!!e.FormFieldData.columns.find((function(e){return"quota"===e.id}))}(e)&&!r.ForecastingBusinessLogicProvider.IsFCInProgress(e.ActiveForecastConfigInfo.status)},t.GetIsFormInCreateMode_FromState=p;function _(e){return r.ForecastingBusinessLogicProvider.IsFormStatusReadOnly(e.status)}function E(e,t){var n=!1,r=["fromDate","toDate","columns","owner","hierarchyRelationship","permissionsData"],i=["hierarchyRelationship","permissionsData"];return Object.keys(e).map((function(o){(r.indexOf(o)<0&&e[o]!=t[o]||i.indexOf(o)>=0&&JSON.stringify(e[o])!=JSON.stringify(t[o]))&&(n=!0)})),!!n||function(e,t){var n=!1;return e.columns.length!=t.columns.length||(e.columns.map((function(e,r){S(e,t.columns[r])&&(n=!0)})),n)}(e,t)}function S(e,t){var n=!1,r=i.FakeColumnInfoData.Rollup_Committed();return Object.keys(r).map((function(r){e[r]!=t[r]&&(n=!0)})),n}t.IsFormLocked=_,t.IsFormDirty=E,t.AreColumnsDifferent=S},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(163),i=n(95),o=n(86),a=n(391),s=n(97),l=n(16),c=n(87),u=n(648);t.initialAppState={mainPageType:r.IMainPageType.GridPage,ForecastConfigList:[],ForecastHierarchyList:[],ActiveForecastConfigInfo:i.GetEmptyForecastConfigInfo(),FormFieldData:i.GetEmptyForecastConfigInfo(),stepperActiveStage:s.ForecastConfigStage.General,isSavingDialogHidden:!0,gridFilterOption:o.IForecastConfigFilterOptions.All,crmOrgInfo:{calenderStartDate:"",clientUrl:"",orgId:"",isSIPackageInstalled:!0,isSILicenseAvailable:!1,isAdminSettingsEnabled:null,featureState:{isManualForecastEnabled:!0,isPredictiveEnabled:!1,isSnapshotEnabled:!1}},formUIState:{showEmptyFieldWarnings:!1},columnEditorState:a.initialForecastColumnEditorState,quotaUploadStageState:i.GetEmptyQuotaStageStatus(),isFetchingHierarchyData:!1,gridAppDialogState:o.GetInitialForecastConfigGridAppDialogState(),editAppDialogState:u.GetInitialForecastConfigEditAppDialogState(),PredictiveAvailabilityState:l.PredictiveAvailabilityStateType.FcbOff,genericErrorDialogState:c.GetDefaultErrorDialogState(),fdNotificationState:{arePublishedFDsPresent:!1,isDismissed:!1},entityMetadataList:{},orgSecurityRolesList:[],rollupEntityViewList:{},predictionStatusForFC:i.GetEmptyForecastPredictionStatus()}},,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(65),i=n(108),o=n(41),a=n(15);function s(e){return r.AreColumnsDifferent(e.columnEditorState.uneditedColumnInfo,i.GetActiveForecastColumnInfo_FromState(e))}t.GetOptionSetAttributeInfoList_FromState=function(e){var t=e.FormFieldData.rollupEntity;if(t){var n=e.columnEditorState.optionSetAttributeInfoDict[t];if(n)return n}return[]},t.GetIsCurrentlyEditingColumnNew_FromState=function(e){return void 0===e.columnEditorState.uneditedColumnInfo.columnType},t.GetForecastCategoryAttribute_FromState=function(e){return e.FormFieldData.forecastCategoryAttributeName},t.GetSelectedOptionSetAttribute_FromState=function(e){return e.columnEditorState.selectedAttributeVal},t.Get_IsChooseSelectedOptionSetButtonDisabled_FromState=function(e){return e.FormFieldData.forecastCategoryAttributeName===e.columnEditorState.selectedAttributeVal},t.Get_IsOptionSetChangeDescructive_FromState=function(e){return e.FormFieldData.forecastCategoryAttributeName!==e.columnEditorState.selectedAttributeVal&&""!=e.FormFieldData.forecastCategoryAttributeName},t.Get_IsColumnEditorRibbonSaveCloseDisabled_FromState=function(e){var t=i.GetActiveForecastColumnInfo_FromState(e);return!s(e)||!o.ForecastingBusinessLogicProvider.AreRequiredFieldsFilledForColumnInfo(t)||i.IsUniqueNameForCurrentForecastColumnDuplicateInFC(e)||!i.IsUniqueNameForCurrentForecastColumnProper(e)||!i.IsHierarchyColumnAttributeFilled(e)},t.Get_IsColumnEditorFormDirty=s,t.Get_IsAddColumnButtonHidden_FromState=function(e){return""==e.FormFieldData.forecastCategoryAttributeName},t.GetPreviewGridColumnList_FromState=function(e){return i.GetForecastColumnsWithStatusList_FromState(e).filter((function(e){return 1==e.isActive}))},t.Get_ShouldShowPredictiveColumn_FromState=function(e){return 1==e.crmOrgInfo.isSILicenseAvailable&&"opportunity"==e.FormFieldData.rollupEntity&&1==e.crmOrgInfo.featureState.isPredictiveEnabled},t.Get_IsAdditionalFilterSameAsDefault=function(e){var t=!1;if(null==e.FormFieldData.additionalFilter)return!0;try{var n=(new DOMParser).parseFromString(e.FormFieldData.additionalFilter,"text/xml");n.getElementsByTagName("entity")&&n.getElementsByTagName("entity").length>0&&0==n.getElementsByTagName("entity")[0].childElementCount&&(t=!0)}catch(e){a.logError("Error while parsing Add filters",e,"")}return t},t.GetHierarchyAttributeInfoType_FromState=function(e,t){if(null!=t.entityMetadataList[t.ActiveForecastConfigInfo.hierarchyEntity]){var n=t.entityMetadataList[t.ActiveForecastConfigInfo.hierarchyEntity].AttributesMetadata.DependentAttributes.find((function(t){return t.LogicalName==e}));if(null!=n)return n.AttributeType}return""}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.All=0]="All",e[e.Published=1]="Published",e[e.Drafts=2]="Drafts",e[e.Archived=3]="Archived"}(t.IForecastConfigFilterOptions||(t.IForecastConfigFilterOptions={})),function(e){e[e.CANCEL=0]="CANCEL",e[e.CLOSE=1]="CLOSE",e[e.DELETE=2]="DELETE"}(t.IDeleteDialogActionType||(t.IDeleteDialogActionType={})),function(e){e[e.CANCEL=0]="CANCEL",e[e.CLOSE=1]="CLOSE",e[e.PUBLISH=2]="PUBLISH"}(t.IPublishDialogActionType||(t.IPublishDialogActionType={})),function(e){e[e.CANCEL=0]="CANCEL",e[e.CLOSE=1]="CLOSE",e[e.DEACTIVATE=2]="DEACTIVATE"}(t.IArchiveDialogActionType||(t.IArchiveDialogActionType={})),function(e){e[e.CANCEL=0]="CANCEL",e[e.CLOSE=1]="CLOSE",e[e.CREATE_SNAPSHOT=2]="CREATE_SNAPSHOT"}(t.ICreateSnapshotDialogActionType||(t.ICreateSnapshotDialogActionType={})),function(e){e[e.CANCEL=0]="CANCEL",e[e.CLOSE=1]="CLOSE",e[e.ENABLE=2]="ENABLE"}(t.IEnableManualForecastingActionType||(t.IEnableManualForecastingActionType={})),function(e){e[e.CANCEL=0]="CANCEL",e[e.CLOSE=1]="CLOSE",e[e.UPDATE=2]="UPDATE"}(t.IHierarchyEntityChangeActionType||(t.IHierarchyEntityChangeActionType={})),t.GetInitialForecastConfigGridAppDialogState=function(){return{isGridDeleteDialogHidden:!0,isGridPublishDialogHidden:!0,isGridArchiveDialogHidden:!0,isGridCreateSnapshotDialogHidden:!0,gridActionableRow:"",isEnableManualForecastingDialogHidden:!0}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.GenericFailure=0]="GenericFailure",e[e.ForecastConfigDeleteFailed=1]="ForecastConfigDeleteFailed",e[e.ForecastSnapshotCreateFailed=2]="ForecastSnapshotCreateFailed",e[e.ForecastConfigPublishFailed=3]="ForecastConfigPublishFailed",e[e.FetchingHierarchyDataFailed=4]="FetchingHierarchyDataFailed",e[e.RetreivingMetadataFailed=5]="RetreivingMetadataFailed",e[e.FetchingOrgDetailsFailed=6]="FetchingOrgDetailsFailed",e[e.ForecastConfigUpdateFailed=7]="ForecastConfigUpdateFailed",e[e.ForecastConfigFetchingFailed=8]="ForecastConfigFetchingFailed",e[e.ForecastConfigCreateFailed=9]="ForecastConfigCreateFailed",e[e.ForecastConfigFormLoadError=10]="ForecastConfigFormLoadError",e[e.ForecastConfigColDeleteFailed=11]="ForecastConfigColDeleteFailed",e[e.HierarchyRelationsDoesntExistDialog=12]="HierarchyRelationsDoesntExistDialog",e[e.EnableMFAdminSettingsFailedDialog=13]="EnableMFAdminSettingsFailedDialog"}(r=t.IErrorDialogType||(t.IErrorDialogType={})),t.GetDefaultErrorDialogState=function(){return{dialogType:r.GenericFailure,isDialogHidden:!0,customMessage:""}}},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(96),o=n(211),a=n(7),s=n(8),l=n(297),c=n(105);function u(){return{displayName:"",entityLogicalName:"",id:""}}function d(e){return[{id:i.generateNewGuid(),title:"HierarchyPrimary",columnType:r.ForecastColumnType.HierarchyPrimary,isActive:!0,dataType:r.ForecastColumnDataType.SingleLineOfText,uniqueName:"owner"},{id:i.generateNewGuid(),title:a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA),columnType:r.ForecastColumnType.Simple,isActive:!0,dataType:r.ForecastColumnDataType.Currency,uniqueName:c.filterNonValidCharactersForUniqueName("quota"),showInTrendChart:!0,colorCode:"#18A03C"},{id:i.generateNewGuid(),title:a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_PREDICTIVE),columnType:r.ForecastColumnType.Predictive,isActive:!1,uniqueName:c.filterNonValidCharactersForUniqueName("predictive"),dataType:r.ForecastColumnDataType.Currency,amountField:"actualvalue",dateField:"actualclosedate",selector:"<fetch version = '1.0' output-format='xml-platform' mapping='logical' distinct='false'><entity name = 'opportunity' ><attribute name='opportunityid' /><order attribute = 'name' descending='false' /><filter type = 'and' ><condition attribute='statecode' operator='eq' value='1' /><condition attribute = 'statuscode' operator='eq' value='3' /></filter></entity></fetch>",showProgressComparedToQuota:!1,isManuallyAdjustable:!1,showInTrendChart:!0,colorCode:"#118DFF"}]}function p(){return{Id:"",ForecastConfigutaionId:"",OrgId:"",Status:o.QuotaStatus.New,UniqueFileName:"",UploadFileName:"",UploadedOn:new Date,ErrorCode:""}}t.GetEmptyForecastConfigInfo=function(e){var t=e&&l.forecastConfigTemplates[e]?e:r.ForecastConfigTemplateType.OrgChart,n=l.forecastConfigTemplates[t];return{id:"",name:"",rollupEntity:n.rollupEntity,hierarchyEntity:n.hierarchyEntity,topOfHierarchy:"",period:"1",fiscalyear:"",fromDate:(new Date).toDateString(),toDate:(new Date).toDateString(),status:r.IForecastConfigStatus.Draft,statusDescription:"Draft",forecastCategoryAttributeName:"",owner:{displayName:"",entityLogicalName:"",id:""},numberOfRecurrences:1,startAtQuater:"",startAtMonth:"",columns:d(t),additionalFilter:'<fetch version="1.0" mapping="logical"><entity name="'+n.rollupEntity+'"></entity></fetch>',templateType:t,hierarchyRelationship:n.hierarchyRelationship,permissionsData:null,rollupEntityDefaultView:"",createdon:""}},t.GetEmptyHierarchyRelationship=function(){return{entityName:"",linkedByAttribute:null,relationship:null}},t.GetEmptyForecastHierarchyDisplayInfo=function(){return{id:"",displayName:"",parentId:"",extraAttributesValues:{}}},t.getEmptyDataRecord=u,t.GetInitialColumns=d,t.GetSampleForecastQuotaColumnInfo=function(){return{id:"quota",title:"Quota",columnType:r.ForecastColumnType.Simple,dataType:r.ForecastColumnDataType.Currency,isActive:!0,uniqueName:"quota"}},t.GetNewEmptyForecastColumnInfo=function(){return{id:i.generateNewGuid(),title:"",isActive:!0,uniqueName:""}},t.GetEmptyForecastPredictionStatus=function(){return{PredictionOn:"",PredictionStatus:"",ErrorCode:"",ErrorDetails:"",ModifiedOn:""}},t.GetEmptyQuotaStageStatus=function(){return{isFetched:!1,downloadStatus:o.QuotaDownloadStatus.New,isPublishing:!1,quotaStatusInfo:p()}},t.GetEmptyQuotaStatusInfo=p},function(e,t,n){"use strict";function r(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.generateNewGuid=r,t.createNewContext=function(e){return void 0===e&&(e="page-init"),{correlationId:r(),triggerSource:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Stage1=0]="Stage1",e[e.Stage2=1]="Stage2"}(t.FCConfigFormStage||(t.FCConfigFormStage={})),function(e){e[e.General=1]="General",e[e.Permission=2]="Permission",e[e.View=3]="View",e[e.Quota=4]="Quota"}(t.ForecastConfigStage||(t.ForecastConfigStage={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onClickOkErrorDialogActionCreator=function(){return{type:"@@Utility/OnOkErrorDialogClick",payload:{isErrorDialogHidden:!0}}},t.onErrorShowDialogActionCreator=function(e,t){return void 0===t&&(t=""),{type:"@@Utility/OnErrorShowDialog",payload:{errorDialogType:e,isErrorDialogHidden:!1,message:t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onRowSelectedActionCreator=function(e){return{type:"@@GridApp/ROW_SELECTED",payload:{rowSelected:e}}},t.onGridAppDialogDeleteStateActionCreator=function(e){return{type:"@@GridApp/ON_UPDATE_DIALOG_DELETE_STATE",payload:{gridAppDeletedialogHiddenState:e}}},t.onGridAppDialogCreateSnapshotStateActionCreator=function(e){return{type:"@@GridApp/ON_UPDATE_DIALOG_CREATE_SNAPSHOT_STATE",payload:{gridAppCreateSnapshotdialogHiddenState:e}}},t.onGridAppDialogPublishStateActionCreator=function(e){return{type:"@@GridApp/ON_UPDATE_DIALOG_PUBLISH_STATE",payload:{gridAppPublishedialogHiddenState:e}}},t.onGridAppDialogArchiveStateActionCreator=function(e){return{type:"@@GridApp/ON_UPDATE_DIALOG_ARCHIVE_STATE",payload:{gridAppArchivedialogHiddenState:e}}},t.onClickDeleteDialogActionCreator=function(e){return{type:"@@GridApp/ON_DELETE_CONFIRM_DIALOG_CLICK",payload:{dialogActionClicked:e}}},t.onClickPublishDialogActionCreator=function(e){return{type:"@@GridApp/ON_PUBLISH_CONFIRM_DIALOG_CLICK",payload:{dialogActionClicked:e}}},t.onClickArchiveDialogActionCreator=function(e){return{type:"@@GridApp/ON_ARCHIVE_CONFIRM_DIALOG_CLICK",payload:{dialogActionClicked:e}}},t.onClickCreateSnapshotStateActionCreator=function(e,t){return{type:"@@GridApp/ON_CREATE_SNAPSHOT_CONFIRM_DIALOG_CLICK",payload:{dialogActionClicked:e,snapshotName:t}}},t.onEnableManualForecastingDialogClickActionCreator=function(e){return{type:"@@GridApp/ON_ENABLE_MANUAL_FORECASTING_DIALOG_CLICK",payload:{dialogActionClicked:e}}},t.enableManualForecastingDialogHiddenStateActionCreator=function(e){return{type:"@@GridApp/ON_ENABLE_MANUAL_FORECASTING_DIALOG_STATE",payload:{dialogHidden:e}}}},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sanitizeNameString=function(e){return e&&e.trim&&""==e.trim()?"":e&&e.substring?e.substring(0,50):e},t.sanitizeUniqueName=function(e){return e&&e.toLowerCase&&e.substring&&(e=e.toLowerCase().substring(0,50)),e},t.filterNonValidCharactersForUniqueName=function(e){return e&&e.toLowerCase&&e.replace&&e.substring?e.replace(/\s/g,"").replace(/[^A-Za-z0-9_]/g,"").replace(/^[_0-9]+/g,"").toLowerCase().substring(0,50):e},t.isUniqueNameProper=function(e){return 0==e.length||null!==e.match(/^[a-zA-Z][a-zA-Z_0-9]*$/g)}},,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),o=n(65),a=n(41),s=n(497),l=n(109),c=n(82),u=n(105),d=n(323),p=n(164),_=n(173),E=n(97);function S(e){var t=e.FormFieldData.columns;return e.FormFieldData.columns.filter((function(t){return t.columnType!=i.ForecastColumnType.Predictive||c.Get_ShouldShowPredictiveColumn_FromState(e)})).map((function(n){if(n.columnType==i.ForecastColumnType.HierarchyPrimary){var o=l.getHierarchyEntityDisplayName(e);n.title="HierarchyPrimary"==n.title||""!=o?o:n.title}var s=m(t,n),c=a.ForecastingBusinessLogicProvider.GetColumnInfoStatus(n,s,e.FormFieldData.status,e.crmOrgInfo),u=f(n.id,e.FormFieldData);return r({},n,{status:c,dependentCalculatedColumns:u})}))}function f(e,t){var n=d.ExpressionParserFactory.getCalculatedFieldExpressionParser(),r=[];try{r=n.getReferencingCalculatedColumns(t,e)}catch(e){}return r}function C(e){var t=I(e),n=e.FormFieldData.columns.find((function(e){return e.id==t}));return n?(void 0===n.dataType&&void 0!==n.columnType&&(n.columnType!==i.ForecastColumnType.HierarchyPrimary&&n.columnType!==i.ForecastColumnType.HierarchySecondary?n.dataType=i.ForecastColumnDataType.Currency:n.dataType=i.ForecastColumnDataType.SingleLineOfText),n):s.FakeColumnInfoData.Owner()}function m(e,t){return!!e.find((function(e){return e.id!=t.id&&e.uniqueName==t.uniqueName}))}function g(e){var t=e.ActiveForecastConfigInfo,n=C(e),r=t.columns.find((function(e){return e.id==n.id}));return!!(r&&r.uniqueName&&u.isUniqueNameProper(r.uniqueName))}function T(e){return e.columnEditorState.isSuggestionCalloutVisible}function I(e){return e.columnEditorState.activeForecastColumnId}t.GetForecastColumnsListForPreviewGrid_FromState=function(e){return _.getActiveStepperStage(e)==E.ForecastConfigStage.General?S(e).filter((function(e){return e.columnType===i.ForecastColumnType.HierarchyPrimary})):S(e)},t.GetForecastColumnsWithStatusList_FromState=S,t.GetDependentCalculatedColumnsForForecastColumnInfo=f,t.GetActiveForecastColumnInfo_FromState=C,t.IsCurrentColumnManuallyAdjusted=function(e){var t=I(e),n=e.ActiveForecastConfigInfo.columns.find((function(e){return e.id==t}));return!(!n||!n.isManuallyAdjustable)&&n.isManuallyAdjustable},t.AreUniqueNamesDuplicateInFC=function(e){var t=e.FormFieldData.columns,n=new Set(t.map((function(e){return e.uniqueName})));return!(t.length==n.size)},t.IsUniqueNameForCurrentForecastColumnDuplicateInFC=function(e){return m(e.FormFieldData.columns,C(e))},t.AreUniqueNamesProperInFC=function(e){var t=e.FormFieldData.columns,n=!0;return t.forEach((function(e){n=n&&u.isUniqueNameProper(e.uniqueName)})),n},t.IsUniqueNameForCurrentForecastColumnProper=function(e){var t=C(e);return u.isUniqueNameProper(t.uniqueName)},t.IsActiveColumnUniqueNameAlreadyStoredInDB=g,t.IsUniqueNameDisabled=function(e){var t=g(e);return o.GetIsFormLocked_FromState(e)||t},t.IsCalculatedFieldSuggestionsCalloutVisible_FromState=T,t.GetIsColumnEditorOpened_FromState=function(e){return e.columnEditorState.idEditorOpened},t.GetIsCalculatedFieldExpressionErrorHidden_FromState=function(e){return!!T(e)||e.columnEditorState.isCalculatedFieldExpressionErrorHidden},t.GetCalculatedFieldExpressionErrorMessage_FromState=function(e){return e.columnEditorState.calculatedFieldExpressionErrorMessage},t.GetCalculatedFieldExpressionSuggestions_FromState=function(e){return e.columnEditorState.calculatedFieldExpressionSuggestions},t.GetIsOptionSetEditorOpened_FromState=function(e){return e.columnEditorState.isOptionSetSelectorOpened},t.GetPredictiveAvailabilityState=function(e){return e.PredictiveAvailabilityState},t.GetActiveColumnId_FromState=I,t.GetShowMaxHierarchyMessage_FromState=function(e){return null!=e.ForecastHierarchyList&&e.ForecastHierarchyList.length>=5e3},t.GetSelectedHierarchySecondaryAttributeFromEntity=function(e){var t="",n=C(e),r=n?n.hierarchyAttributeInfo:null;return r&&(t=r.relationship.relationship?r.relationship.relationship.linkedByAttribute:r.attributeName),t},t.IsHierarchyColumnAttributeFilled=function(e){var t=C(e);if(t.columnType==i.ForecastColumnType.HierarchySecondary){if(e.FormFieldData.hierarchyEntity&&t.hierarchyAttributeInfo){var n=e.entityMetadataList[e.FormFieldData.hierarchyEntity].AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName==t.hierarchyAttributeInfo.attributeName}));return!n||n.AttributeType.slice(0,-4)!=p.EDataType.Lookup}return!1}return!0},t.setDatatypefromCrmDatatype=function(e){switch(e.slice(0,-4)){case p.EDataType.Lookup:case p.EDataType.String:return i.ForecastColumnDataType.SingleLineOfText;case p.EDataType.Currency:return i.ForecastColumnDataType.Currency;case p.EDataType.Decimal:case p.EDataType.WholeNumber:return i.ForecastColumnDataType.Decimal;default:return i.ForecastColumnDataType.NotSupported}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(8);function o(e){var t="",n=e.FormFieldData.hierarchyEntity;return null!=n&&a(e,n)&&(t=e.entityMetadataList[n].DisplayName),t}function a(e,t){return null!=e.entityMetadataList[t]}function s(e,t){return a(e,t)&&void 0!==e.entityMetadataList[t].AttributesMetadata&&void 0!==e.entityMetadataList[t].AttributesMetadata.DependentAttributes}function l(e,t){return a(e,t)&&void 0!==e.entityMetadataList[t].EntityRelationshipCollection}t.getHierarchyEntityDisplayName=o,t.IsEntityMetadataAvailable_InState=a,t.IsEntityAttributeMetadataAvailable_InState=s,t.IsEntityRelationshipMetadaAvailable_InState=l,t.GetSILicenseStatusFromState=function(e){return e.crmOrgInfo.isSILicenseAvailable},t.getAttributeDisplayName=function(e,t,n){if(s(n,e)){var r=n.entityMetadataList[e].AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName==t}));if(r)return r.DisplayName}},t.isEntityHierarchyRelationshipConfigured=function(e){var t=e.FormFieldData.hierarchyEntity;return!!l(e,t)&&void 0!==e.entityMetadataList[t].EntityRelationshipCollection.DependentRelationships.find((function(e){return 1==e.IsHierarchical}))},t.getHierarchyRelationshipNotConfiguredErrorMessage=function(e){return r.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_HIERARCHY_REL_NOT_PRESENT_MESSAGE).replace("{0}",o(e))},t.getRolesFromState=function(e){return e.orgSecurityRolesList},t.areRolesFetched_FromState=function(e){return e.orgSecurityRolesList.length>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Lookup=0]="Lookup",e[e.OptionSet=1]="OptionSet",e[e.EntityPicker=2]="EntityPicker",e[e.NumberPicker=3]="NumberPicker",e[e.DatePicker=4]="DatePicker",e[e.AmountField=5]="AmountField",e[e.DateField=6]="DateField",e[e.ViewPicker=7]="ViewPicker"}(t.ICrmAttributeType||(t.ICrmAttributeType={})),function(e){e[e.CreateForm=0]="CreateForm",e[e.EditForm=1]="EditForm"}(t.FormType||(t.FormType={}))},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateCrmClientUrlAndOrgId=function(e,t){return{type:"@@CrmOrgInfo/UpdateClientUrlAndOrgId",payload:{url:e,orgId:t}}},t.UpdateOrgFiscalCalenderStartDate=function(e){return{type:"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate",payload:{fiscalStartDate:e}}},t.UpdateManualForecastingEnabledSettings=function(e){return{type:"@@CrmOrgInfo/UpdateManualForecastingEnabledSettings",payload:{isAdminSettingsEnabled:e}}},t.EnableManualForecastingAdminSettingsActionCreator=function(){return{type:"@@CrmOrgInfo/EnableManualForecastingAdminSettingsAction",payload:{}}},t.TriggerFetchOrgSettings=function(){return{type:"@@CrmOrgInfo/TriggerFetchOrgSettings",payload:{}}},t.TriggerUpdateSIPackageStatus=function(){return{type:"@@CrmOrgInfo/TriggerUpdateSIPackageStatus",payload:{}}},t.UpdateSIPackageStatus=function(e){return{type:"@@CrmOrgInfo/UpdateSIPackageStatus",payload:{isInstalled:e}}},t.TriggerUpdateSILicenseAvailableStatus=function(){return{type:"@@CrmOrgInfo/TriggerUpdateSILicenseAvailable",payload:{}}},t.TriggerUpdateFeatureState=function(){return{type:"@@CrmOrgInfo/TriggerUpdateFeatureState",payload:{}}},t.UpdateFeatureState=function(e){return{type:"@@CrmOrgInfo/UpdateFeatureState",payload:{featureState:e}}},t.UpdateSILicenseAvailableStatus=function(e){return{type:"@@CrmOrgInfo/UpdateSILicenseAvailable",payload:{isSILicenseAvailable:e}}},t.SetEntityMetadata=function(e,t){var n;return{type:"@@Metadata/SetEntityMetadata",payload:{value:(n={},n[e]=t,n)}}}},,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Identifier=1]="Identifier",e[e.Number=2]="Number",e[e.Plus=3]="Plus",e[e.Minus=4]="Minus",e[e.Multiple=5]="Multiple",e[e.Divide=6]="Divide",e[e.LeftParenthesis=7]="LeftParenthesis",e[e.RightParenthesis=8]="RightParenthesis"}(t.TokenType||(t.TokenType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(175),i=n(843),o=n(502),a=function(){function e(){}return e.GetNavigationHandlerObject=function(e){return r.CrmNavigationHelpers.isCrmUrlNavigationEnabled()?new i.CrmNavigationHandler:new o.ReduxNavigationHandler(e)},e}();t.NavigationHandlerFactory=a},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.GridPage=0]="GridPage",e[e.EditPage=1]="EditPage",e[e.PredictivePage=2]="PredictivePage"}(t.IMainPageType||(t.IMainPageType={}))},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o,a,s=n(130),l=n(46),c=n(825);!function(e){e.OneToMany="OneToManyRelationship",e.ManyToOne="ManyToOneRelationship"}(o=t.RelationshipType||(t.RelationshipType={})),function(e){e.String="String",e.MultilineText="Memo",e.WholeNumber="Integer_None",e.Date="DateTime",e.OptionSet="Picklist",e.MultiOptionSet="MultiSelectPicklistType",e.TwoOptions="Boolean",e.Lookup="Lookup",e.Customer="Customer",e.Owner="Owner",e.Currency="Money",e.Float="Double",e.Decimal="Decimal",e.Language="Integer_Language",e.UniqueIdentifier="UniqueIdentifier",e.Duration="Integer_Duration"}(a=t.EDataType||(t.EDataType={})),t.getCDSResolver=function(e,t,n){return void 0===n&&(n="9.0"),new u(s.createCDSClient(e,void 0))};var u=function(){function e(e){this.cdsClient=e,this.dependentEntities={},this.orgLanguages=void 0,this.resolvedFields={},this.resolvedFieldsMetadata={},this.resolvedRelatedEntities={},this.resolvedOptionSetMembers={},this.resolvedEntityViews={},this.rawdependentEntities={}}return e.prototype.fetchDependentEntityMetadata=function(e){return r(this,void 0,Promise,(function(){return i(this,(function(t){return void 0===this.dependentEntities[e]&&(this.dependentEntities[e]=this.cdsClient.then((function(t){return t.fetchEntityAndRelatedEntityMetadata({entityName:e})}))),[2,this.dependentEntities[e]]}))}))},e.prototype.resolveFields=function(e){return r(this,void 0,Promise,(function(){return i(this,(function(t){return void 0===this.resolvedFields[e.name]&&(this.resolvedFields[e.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var t=[];e&&(e.AttributesMetadata.DependentAttributes.forEach((function(e){var n={name:e.LogicalName,displayName:e.DisplayName,metadataId:e.AttributeId,format:e.AttributeFormatType,maxValue:e.MaxValue,minValue:e.MinValue,precision:e.Precision,targets:e.Targets,maxLength:e.MaxLength,dataType:d(e)};t.push(n)})),t=t.sort((function(e,t){return e.displayName.localeCompare(t.displayName)})));return t}))),[2,this.resolvedFields[e.name]]}))}))},e.prototype.resolveRelatedEntities=function(e){return r(this,void 0,Promise,(function(){return i(this,(function(t){return void 0===this.resolvedRelatedEntities[e.name]&&(this.resolvedRelatedEntities[e.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var t=[];if(e){var n=e.EntityRelationshipCollection.DependentRelationships,r=e.DependantEntitiesCollection.DependantEntities;n.filter((function(e){return e.EntityRelationshipType!==l.RelationshipTypeExt.ManyToManyRelationship})).forEach((function(n){var i=r.find((function(e){return e.LogicalName===n.RelationshipEntity}));if(i){var a={name:i.LogicalName,displayName:i.DisplayName,metadataId:i.EntityId,primaryIdField:i.PrimaryIdAttribute,primaryNameField:i.PrimaryNameAttribute},s=n.EntityRelationshipType===l.RelationshipTypeExt.ManyToOneRelationship?e.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName===n.ReferencingAttribute})):i.Attributes.DependentAttributes.find((function(e){return e.LogicalName===n.ReferencingAttribute})),c={referencedFieldName:n.ReferencedAttribute,referencingFieldName:n.ReferencingAttribute,displayName:s?s.DisplayName:n.ReferencingAttribute,isHierarchical:n.IsHierarchical,relationshipType:n.EntityRelationshipType===l.RelationshipTypeExt.OneToManyRelationship?o.OneToMany:o.ManyToOne};t.push([a,c])}})),t=t.sort((function(e,t){return e[0].displayName.localeCompare(t[0].displayName)}))}return t}))),[2,this.resolvedRelatedEntities[e.name]]}))}))},e.prototype.resolveOptionSetMembers=function(e,t){return r(this,void 0,Promise,(function(){return i(this,(function(n){return void 0===this.resolvedOptionSetMembers[e.name+"-"+t.name]&&(this.resolvedOptionSetMembers[e.name+"-"+t.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var n=[];if(e){var r=e.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName===t.name}));r&&r.OptionSet&&(("Picklist"===r.OptionSet.Type||"State"===r.OptionSet.Type||"Status"===r.OptionSet.Type)&&r.OptionSet.Options&&r.OptionSet.Options.OptionList?r.OptionSet.Options.OptionList.forEach((function(e){n.push({displayName:e.Label,value:e.Value})})):"Boolean"===r.OptionSet.Type&&(r.OptionSet.TrueOption&&n.push({displayName:r.OptionSet.TrueOption.Label,value:r.OptionSet.TrueOption.Value}),r.OptionSet.FalseOption&&n.push({displayName:r.OptionSet.FalseOption.Label,value:r.OptionSet.FalseOption.Value}))),n=n.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))}return n}))),[2,this.resolvedOptionSetMembers[e.name+"-"+t.name]]}))}))},e.prototype.resolveLookupRecords=function(e,t,n){return r(this,void 0,Promise,(function(){return i(this,(function(e){throw new Error("working on it")}))}))},e.prototype.resolveLookupRecordsSimple=function(e,t,n){return r(this,void 0,Promise,(function(){var r,o,a,s,l,c,u;return i(this,(function(d){switch(d.label){case 0:return[4,this.fetchDependentEntityMetadata(e.name)];case 1:return r=d.sent(),o=[],[4,this.cdsClient];case 2:if(a=d.sent(),!(r&&t&&t.length>0))return[3,6];s=function(t){var s,l,c;return i(this,(function(i){switch(i.label){case 0:if(!(s=t===e.name?r:r.DependantEntitiesCollection.DependantEntities.find((function(e){return e.LogicalName===t}))))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),l=s.EntitySetName+"?$select="+s.PrimaryNameAttribute+","+s.PrimaryIdAttribute+"&$orderby="+s.PrimaryNameAttribute+" asc&$top=100",n&&n.searchString?(l+="&$filter=contains("+s.PrimaryNameAttribute+",'"+n.searchString+"')","systemuser"===t&&(l+=" and isdisabled eq false")):"systemuser"===t&&(l+="&$filter=isdisabled eq false"),[4,a.executeOperation(l,"GET",{},void 0,{scenarioName:"CDSResolver.ResolveLookupRecordsSimple"})];case 2:return(c=i.sent())&&c.value&&c.value.forEach((function(e){o.push({entityLogicalName:s.LogicalName,id:e[s.PrimaryIdAttribute],displayName:e[s.PrimaryNameAttribute]})})),[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}}))},l=0,c=t,d.label=3;case 3:return l<c.length?(u=c[l],[5,s(u)]):[3,6];case 4:d.sent(),d.label=5;case 5:return l++,[3,3];case 6:return[2,o]}}))}))},e.prototype.resolveLookupRecordsById=function(e,t,n){return r(this,void 0,Promise,(function(){var r,o,a,s,l,c,u;return i(this,(function(d){switch(d.label){case 0:return[4,this.fetchDependentEntityMetadata(e.name)];case 1:return r=d.sent(),o=[],[4,this.cdsClient];case 2:if(a=d.sent(),!(r&&t&&t.length>0&&n&&n.length>0))return[3,6];s=function(t){var s,l,c,u;return i(this,(function(i){switch(i.label){case 0:if(!(s=t===e.name?r:r.DependantEntitiesCollection.DependantEntities.find((function(e){return e.LogicalName===t}))))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),l="",n.forEach((function(e){l&&(l+=" or "),l+=s.PrimaryIdAttribute+" eq "+e})),c=s.EntitySetName+"?$select="+s.PrimaryNameAttribute+","+s.PrimaryIdAttribute+"&$filter=("+l+")",[4,a.executeOperation(c,"GET",{},void 0,{scenarioName:"CDSResolver.ResolveLookupRecordsById"})];case 2:return(u=i.sent())&&u.value&&u.value.forEach((function(e){o.push({entityLogicalName:s.LogicalName,entityDisplayName:s.DisplayName,id:e[s.PrimaryIdAttribute],displayName:e[s.PrimaryNameAttribute]})})),[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}}))},l=0,c=t,d.label=3;case 3:return l<c.length?(u=c[l],[5,s(u)]):[3,6];case 4:d.sent(),d.label=5;case 5:return l++,[3,3];case 6:return[2,o]}}))}))},e.prototype.resolveEntityViews=function(e){return r(this,void 0,Promise,(function(){return i(this,(function(t){if(void 0===this.resolvedEntityViews[e.name])try{this.resolvedEntityViews[e.name]=this.cdsClient.then((function(t){return t.fetchList("View",{entityId:e.metadataId,entityName:e.name,solutionName:""},void 0,{scenarioName:"CDSResolver.ResolveEntityViews"}).then((function(e){var t=[],n=e.data;return n.length>0&&(n.forEach((function(e){var n={name:e.name,isDefault:e.isdefault,savedQueryId:e.savedqueryid,queryType:e.querytype,columns:[]};t.push(n)})),t=t.sort((function(e,t){return e.name.localeCompare(t.name)}))),t}))}))}catch(e){}return[2,this.resolvedEntityViews[e.name]]}))}))},e.prototype.resolveOrganizationEnabledLanguages=function(){return r(this,void 0,Promise,(function(){return i(this,(function(e){if(void 0===this.orgLanguages)try{this.orgLanguages=this.cdsClient.then((function(e){return e.fetchOrganizationEnabledLanguages().then((function(e){var t=e;return t=t.sort((function(e,t){return e.label.localeCompare(t.label)}))}))}))}catch(e){}return[2,this.orgLanguages]}))}))},e.prototype.getLocalizedLabels=function(){return r(this,void 0,Promise,(function(){var e,t,n;return i(this,(function(r){switch(r.label){case 0:e={},t=[],Object.keys(c.AllLabelsMap).forEach((function(n){var r=n;c.AllLabelsMap[r].resourceIdentifier&&t.push(c.AllLabelsMap[r].resourceIdentifier),e[r]=c.AllLabelsMap[r].local})),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this.cdsClient];case 2:return[4,(n=r.sent()).localizationService.fetchResourceStrings(t)];case 3:return r.sent(),Object.keys(c.AllLabelsMap).forEach((function(t){var r=t;c.AllLabelsMap[r].resourceIdentifier&&(e[r]=n.localizationService.getResourceString(c.AllLabelsMap[r].resourceIdentifier)||e[r])})),[3,5];case 4:return r.sent(),[3,5];case 5:return[2,e]}}))}))},e.prototype.resolveFieldsMetadata=function(e){return void 0===this.resolvedFieldsMetadata[e.name]&&(this.resolvedFieldsMetadata[e.name]=this.fetchRawEntityMetadata(e.name).then((function(e){var t=e.Attributes,n=[];return t.forEach((function(e){e.AttributeType=e.AttributeType+"Type";var t={name:e.LogicalName,displayName:e&&e.DisplayName&&e.DisplayName.UserLocalizedLabel&&e.DisplayName.UserLocalizedLabel.Label||e.LogicalName,metadataId:e.MetadataId,format:e.AttributeFormatType,maxValue:e.MaxValue,minValue:e.MinValue,precision:e.Precision,targets:e.Targets,maxLength:e.MaxLength,dataType:d(e),CalculationOf:e.CalculationOf};n.push(t)})),n=n.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))}))),this.resolvedFieldsMetadata[e.name]},e.prototype.fetchRawEntityMetadata=function(e){return void 0===this.rawdependentEntities[e]&&(this.rawdependentEntities[e]=this.cdsClient.then((function(t){var n="EntityDefinitions(LogicalName%20%3D%20'"+e+"')?%24select=MetadataId%2CIsCustomEntity%2CLogicalName%2CLogicalCollectionName%2CObjectTypeCode%2CDisplayName%2CPrimaryNameAttribute%2CPrimaryIdAttribute&%24expand=Attributes%2COneToManyRelationships(%24select%3DMetadataId%2CIsHierarchical%2CReferencedAttribute%2CReferencingAttribute)";return t.executeOperation(n,"GET",{}).then((function(e){return new Promise((function(t){t(e)}))}))}))),this.rawdependentEntities[e]},e}();function d(e){switch(e.AttributeType){case l.AttributeTypeCode.Memo+"Type":return a.MultilineText;case l.AttributeTypeCode.Integer+"Type":if(e.AttributeFormatType){if("Language"===e.AttributeFormatType)return a.Language;if("Duration"===e.AttributeFormatType)return a.Duration}return a.WholeNumber;case l.AttributeTypeCode.DateTime+"Type":return a.Date;case l.AttributeTypeCode.Picklist+"Type":case l.AttributeTypeCode.State+"Type":case l.AttributeTypeCode.Status+"Type":case l.AttributeTypeCode.EntityName+"Type":return a.OptionSet;case"MultiSelectPicklistType":return a.MultiOptionSet;case l.AttributeTypeCode.Boolean+"Type":return a.TwoOptions;case l.AttributeTypeCode.Lookup+"Type":return a.Lookup;case l.AttributeTypeCode.Customer+"Type":return a.Customer;case l.AttributeTypeCode.Owner+"Type":return a.Owner;case l.AttributeTypeCode.Money+"Type":return a.Currency;case l.AttributeTypeCode.Double+"Type":return a.Float;case l.AttributeTypeCode.Decimal+"Type":return a.Decimal;case l.AttributeTypeCode.Uniqueidentifier+"Type":return a.UniqueIdentifier;default:return a.String}}t.CDSResolver=u},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(498),i=n(322),o=n(41),a=n(97),s=n(108),l=n(225);function c(e){return e.stepperActiveStage}function u(e,t){var n=o.ForecastingBusinessLogicProvider.getForecastConfigFieldsForStage(t),r=p(e.FormFieldData,n);return t==a.ForecastConfigStage.View?r=r&&d(e)&&!s.AreUniqueNamesDuplicateInFC(e)&&s.AreUniqueNamesProperInFC(e):t==a.ForecastConfigStage.Permission&&(r=r&&l.arePermissionsConfigured(e)),r}function d(e){var t=!0;return e.FormFieldData.columns.map((function(e){t=t&&o.ForecastingBusinessLogicProvider.AreRequiredFieldsFilledForColumnInfo(e)})),t}function p(e,t){var n=!0;return Object.keys(e).map((function(r){var i=e[r];o.ForecastingBusinessLogicProvider.IsFieldPresentInStageForm(r,t)&&o.ForecastingBusinessLogicProvider.IsRequiredField(r)&&!o.ForecastingBusinessLogicProvider.FieldHasNonNullValue(r,i)&&(n=!1)})),n}function _(e,t){return{state:t,stepId:o.ForecastingBusinessLogicProvider.GetStageStepId(e),title:o.ForecastingBusinessLogicProvider.GetStageTitleText(e),description:o.ForecastingBusinessLogicProvider.GetStageDecriptionText(e)}}t.getStageStateProps=function(e){var t=[],n=e.stepperActiveStage,i=u(e,n),s=r.IDelphiState.Current;n!=a.ForecastConfigStage.Quota&&(s=i?r.IDelphiState.CurrentCompleted:r.IDelphiState.Current);var l=_(n,s);return t[o.ForecastingBusinessLogicProvider.getIndexOfStage(n)]=l,function(e,t){var n=o.ForecastingBusinessLogicProvider.isFirstStageofOrderedStepperStages(t)?t:o.ForecastingBusinessLogicProvider.getPreviousStage(t);for(;n!=t;){var i=_(n,r.IDelphiState.Completed);e[o.ForecastingBusinessLogicProvider.getIndexOfStage(n)]=i,t=n,n=o.ForecastingBusinessLogicProvider.isFirstStageofOrderedStepperStages(t)?t:o.ForecastingBusinessLogicProvider.getPreviousStage(t)}}(t,n),function(e,t,n,i,s){var l=o.ForecastingBusinessLogicProvider.isLastStageofOrderedStepperStages(n)?n:o.ForecastingBusinessLogicProvider.getNextStage(n),c=!s;for(;l!=n;){var d=void 0,p=u(e,l);c?d=r.IDelphiState.Disabled:(d=p&&l!=a.ForecastConfigStage.Quota?r.IDelphiState.Completed:i==r.IDelphiState.Completed||i==r.IDelphiState.CurrentCompleted?r.IDelphiState.Enabled:r.IDelphiState.Disabled,p||(c=!0));var E=_(l,d);t[o.ForecastingBusinessLogicProvider.getIndexOfStage(l)]=E,n=l,i=d,l=o.ForecastingBusinessLogicProvider.isLastStageofOrderedStepperStages(n)?n:o.ForecastingBusinessLogicProvider.getNextStage(n)}}(e,t,n,s,i),t},t.getActiveStepperStage=c,t.AreRequiredFieldsForCurrentStageFilled=function(e){return u(e,c(e))},t.GetHasRequiredFieldsFilled_ForStage_FromState=u,t.AreRequiredFieldsForAllColumnsFilled=d,t.GetHasRequiredFieldsFilled_ForStage=p,t.getStageInfo=_,t.getBackButtonState=function(e){var t=e.stepperActiveStage;return(o.ForecastingBusinessLogicProvider.isFirstStageofOrderedStepperStages(t)?t:o.ForecastingBusinessLogicProvider.getPreviousStage(t))!=t?i.IStepperButtonState.Enabled:i.IStepperButtonState.Hide},t.getNextButtonState=function(e){return u(e,e.stepperActiveStage)?i.IStepperButtonState.Enabled:i.IStepperButtonState.Disabled}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(8);function o(e){var t=window.Xrm;t&&t.Utility.showProgressIndicator(e)}function a(){var e=window.Xrm;e&&e.Utility.closeProgressIndicator()}t.showOrHideCrmLoaading=function(e,t){void 0===t&&(t=r.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_CRM_PROCESSING_CALLS)),e?o(t):a()},t.showCrmLoading=o,t.hideCrmLoading=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.isCrmUrlNavigationEnabled=function(){return null!=window.Xrm},e.navigateWithParams=function(e){var t={pageType:"control",controlName:"ForecastingControls.FieldControls.CCFForecastConfig",data:e};window.Xrm.Navigation.navigateTo(t)},e.navigateToCustomControl=function(e,t,n){var r={pageType:"control",controlName:e,data:t};window.Xrm.Navigation.navigateTo(r,n)},e.navigateToEntityForm=function(t,n){if(e.isCrmUrlNavigationEnabled()){var r={pageType:"entityrecord",entityName:t,entityId:n};window.Xrm.Navigation.navigateTo(r)}},e}();t.CrmNavigationHelpers=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onGridSelectorChangeActionCreator=function(e){return{type:"@@GridApp/ON_GRID_SELECTOR_CHANGE",payload:{selectedvalue:e}}},t.changeMainPageType=function(e){return{type:"@@mainPage/ChangeType",payload:{newType:e}}},t.updateFDPresent=function(e){return{type:"@@delfiConfig/UpdateFDPresent",payload:{fdPresent:e}}},t.dismissFDNotification=function(e){return{type:"@@delfiConfig/DismissFDNotification",payload:{dismiss:e}}},t.updateForecastConfigDisplayInfo=function(e,t){return{type:"@@delfiConfig/UpdateForecastConfigDisplayInfo",payload:{id:e,data:t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdatePermissionsData=function(e){return{type:"@@PermissionsData/UpdatePermissionData",payload:{permissionsData:e}}},t.UpdatePermissionsAttribute=function(e,t){return{type:"@@PermissionsData/UpdatePermissionsAttribute",payload:{attributeName:e},isInternal:t}},t.AddPermissionRole=function(e){return{type:"@@PermissionsData/AddPermissionsRoleAction",payload:{roleId:e}}},t.DeletePermissionRole=function(e){return{type:"@@PermissionsData/DeletePermissionsRoleAction",payload:{roleId:e}}},t.SetAdditionalViewingPermissionType=function(e){return{type:"@@PermissionsData/SetAdditionalViewingPermissionTypeAction",payload:{type:e}}},t.TriggerFetchSecurityRolesList=function(){return{type:"@@OrgSecurityRoles/TriggerFetchSecurityRoles",payload:{}}},t.SetSecurityRolesListInState=function(e){return{type:"@@OrgSecurityRoles/SetSecurityRolesInState",payload:{roles:e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(86),o=n(7),a=n(8);function s(e,t){var n=e.filter((function(e){return e.status==t}));return n&&n.length>0?n:[]}t.GetFCList_FromState=function(e){switch(e.gridFilterOption){case i.IForecastConfigFilterOptions.All:return e.ForecastConfigList;case i.IForecastConfigFilterOptions.Drafts:return s(e.ForecastConfigList,r.IForecastConfigStatus.Draft);case i.IForecastConfigFilterOptions.Published:return s(e.ForecastConfigList,r.IForecastConfigStatus.Published);case i.IForecastConfigFilterOptions.Archived:return s(e.ForecastConfigList,r.IForecastConfigStatus.Archived);default:return e.ForecastConfigList}},t.getPredictionStatusFromConfig=function(e){var t=!1;return e.forEach((function(e){3===e.columnType&&!0===e.isActive&&(t=!0)})),t},t.shouldShowFDNotification=function(e){return!e.fdNotificationState.isDismissed&&0==e.ForecastConfigList.filter((function(e){return e.status==r.IForecastConfigStatus.Published})).length&&e.fdNotificationState.arePublishedFDsPresent},t.getlocalizedFCPublishErrorMessage=function(e){if("FCLimitExceeded"==e)return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_PUBLISH_FAILED_MORE_THAN_SIX);try{var t=JSON.parse(e);if(t)switch(t.FailureType){case r.AzActivationFailureType.ActiveFCCountThresholdExceeded:var n=JSON.parse(t.Data);if(n&&null!=n.MaximumActiveCount)return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_PUBLISH_FAILED_MAXCOUNT).replace("{0}",""+n.MaximumActiveCount)}}catch(e){}return""},t.Get_ShowCreateSnapshot_FromState=function(e){return e.crmOrgInfo.isSILicenseAvailable&&e.crmOrgInfo.isSIPackageInstalled&&e.crmOrgInfo.featureState.isSnapshotEnabled},t.ShouldShowEnableForecastingPage_FromState=function(e){return!e.crmOrgInfo.isAdminSettingsEnabled},t.isEnableManualForecastingFlagFetched_FromState=function(e){return null!==e.crmOrgInfo.isAdminSettingsEnabled},t.Get_ShowNoFCsMessage_FromState=function(e){return 0==e.ForecastConfigList.length}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Uploaded=1]="Uploaded",e[e.InProgress=2]="InProgress",e[e.Success=3]="Success",e[e.Failed=4]="Failed",e[e.New=5]="New",e[e.Uploading=6]="Uploading"}(t.QuotaStatus||(t.QuotaStatus={})),function(e){e[e.New=1]="New",e[e.InProgress=2]="InProgress",e[e.Success=3]="Success",e[e.Failed=4]="Failed"}(t.QuotaDownloadStatus||(t.QuotaDownloadStatus={})),t.ERROR_CODES={FETCH_FAILED:"FETCH_FAILED",UPLOAD_FAILED:"UPLOAD_FAILED",GUID_TAMPERED:"GUID_TAMPERED",INVALID_ROWS:"INVALID_ROWS",INVALID_CONTENT:"INVALID_CONTENT",INVALID_FILE:"INVALID_FILE",INVALID_SIZE:"INVALID_SIZE",INVALID_FORECASTCONFIGURATION:"INVALID_FORECASTCONFIGURATION"},t.MAX_UPLOAD_FILESIZE_MB=20,t.MAX_UPLOAD_FILESIZE_BYTES=20971520},,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(224),i=n(7),o=n(8),a=function(){function e(){}return e.validateNullArgument=function(e,t){if(null==e)throw new Error(r.StringFormatter.formatString(i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.EXP_VALIDATION_ERROR_NULL_UNDEFINED_ARGUMENT),t))},e}();t.Validations=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))},e}();t.StringFormatter=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(297),o=n(41),a=n(109),s=n(7),l=n(8);function c(e,t){var n=!1;if(null!=t.FormFieldData.permissionsData&&t.FormFieldData.permissionsData.permissionTypes.indexOf(e)>=0)switch(e){case r.PermissionType.Role:null!=t.FormFieldData.permissionsData.permissionRoles&&t.FormFieldData.permissionsData.permissionRoles.length>0&&(n=!0);break;case r.PermissionType.User:null!=t.FormFieldData.permissionsData.permissionAttribueInfo&&(n=!0);break;case r.PermissionType.All:n=!0}return n}function u(e){return c(r.PermissionType.User,e)||c(r.PermissionType.Role,e)||c(r.PermissionType.All,e)}function d(e){return e&&null!=e.find((function(e){return e.isPermissionsColumn&&1==e.isPermissionsColumn}))}t.None_Option_Key="-1",t.getSelectedPermissionAttribute_FromState=function(e){return c(r.PermissionType.User,e)?e.FormFieldData.permissionsData.permissionAttribueInfo.attributeName:t.None_Option_Key},t.getSelectedPermissionRoles_FromState=function(e){var t=[];return null!=e.FormFieldData.permissionsData&&null!=e.FormFieldData.permissionsData.permissionRoles&&(t=e.FormFieldData.permissionsData.permissionRoles.map((function(e){return e.roleId}))),t},t.IsPermissionTypeConfigured_FromState=c,t.isRoleBasedPermissionTypeOptionSelectedFromState=function(e){return null!=e.FormFieldData.permissionsData&&e.FormFieldData.permissionsData.permissionTypes.indexOf(r.PermissionType.Role)>=0},t.getPermissionAttributeByTemplateType=function(e){return null!=i.forecastConfigTemplates[e]&&null!=i.forecastConfigTemplates[e].permissionsData.permissionAttribueInfo?i.forecastConfigTemplates[e].permissionsData.permissionAttribueInfo.attributeName:""},t.getPermissionAttributeControlDisabledState=function(e){return e.FormFieldData.id.length>0&&o.ForecastingBusinessLogicProvider.IsFormStatusReadOnly(e.FormFieldData.status)},t.getSuggestionListForRolesListFromState=function(e){return a.getRolesFromState(e).map((function(e){return{itemValue:e.roleId,itemName:e.roleName}})).sort((function(e,t){return e.itemName.localeCompare(t.itemName)}))},t.getAdditionalForecastViewingPermissionOptions=function(){return[{key:t.None_Option_Key,text:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_NONE)},{key:r.PermissionType.All.toString(),text:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_ALLOWALL)},{key:r.PermissionType.Role.toString(),text:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_SPECIFIC_ROLES)}]},t.getAdditionalViewingPermissionType_FromState=function(e){return c(r.PermissionType.All,e)?r.PermissionType.All:c(r.PermissionType.Role,e)?r.PermissionType.Role:null},t.arePermissionsConfigured=u,t.getPermissionStageInfoErrorMessage=function(e){if(!u(e))return s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MANDATORY_ERROR_MESSAGE);var t=c(r.PermissionType.User,e),n=c(r.PermissionType.Role,e),i=c(r.PermissionType.All,e);return t?i?s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_AND_ALLOW_ALL):n?s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_AND_ROLE):s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_ONLY):i?s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_ALLOW_ALL_ONLY):n?s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_ROLE_ONLY):""},t.doesPermissionColumnExist=d,t.getPermissionsColumnId=function(e){return d(e.FormFieldData.columns)?e.FormFieldData.columns.find((function(e){return 1==e.isPermissionsColumn})).id:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(95),i=function(){function e(){}return e.isXrmEnabled=function(){return null!=window.Xrm},e.getLoggedInUserInfo=function(){if(e.isXrmEnabled()){var t=window.Xrm.Utility.getGlobalContext().userSettings;return{entityLogicalName:"systemuser",displayName:t.userName,id:t.userId}}return r.getEmptyDataRecord()},e.isUserLanguageRTL=function(){return!!e.isXrmEnabled()&&window.Xrm.Utility.getGlobalContext().userSettings.isRTL},e.isFCBEnabled=function(t){return!!e.isXrmEnabled()&&window.Xrm.Internal.isFeatureEnabled(t)},e}();t.XrmHelper=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41);t.onStepClickActionCreator=function(e){return{type:"@@EditApp/ON_STEP_CLICK",payload:{activeStage:r.ForecastingBusinessLogicProvider.getStageFromStepId(e)}}},t.onButtonClickActionCreator=function(e){return{type:"@@EditApp/ON_STEPPER_BUTTON_CLICK",payload:{buttonTypeClicked:e}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClearPreviewGridHierarchyData=function(){return{type:"@@PreviewGrid/ClearGridHierarchyData",payload:{}}},t.AddPreviewGridHierarchyData=function(e){return{type:"@@PreviewGrid/AddGridHierarchyData",payload:{forecastHierarchyList:e}}},t.ReorderColumn=function(e,t,n){return void 0===n&&(n=!1),{type:"@@PreviewGrid/Reorder",payload:{dragIndex:e,targetIndex:t,areIndicesActual:n}}},t.ReorderColumnsWithId=function(e,t){return{type:"@@PreviewGrid/ReorderColumnsWithId",payload:{dragColId:e,targetColId:t}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16);t.forecastConfigTemplates={1:{templateType:r.ForecastConfigTemplateType.OrgChart,rollupEntity:"opportunity",hierarchyEntity:"systemuser",hierarchyRelationship:{entityName:"opportunity",linkedByAttribute:null,relationship:{entityName:"systemuser",linkedByAttribute:"ownerid",relationship:null}},permissionsData:{permissionTypes:[r.PermissionType.User],permissionAttribueInfo:{attributeName:"systemuserid",relationship:{entityName:"systemuser",linkedByAttribute:null,relationship:null}},permissionRoles:null}},2:{templateType:r.ForecastConfigTemplateType.TerritoryBased,rollupEntity:"opportunity",hierarchyEntity:"territory",hierarchyRelationship:{entityName:"opportunity",linkedByAttribute:null,relationship:{entityName:"account",linkedByAttribute:"parentaccountid",relationship:{entityName:"territory",linkedByAttribute:"territoryid",relationship:null}}},permissionsData:{permissionTypes:[r.PermissionType.User],permissionAttribueInfo:{attributeName:"managerid",relationship:{entityName:"territory",linkedByAttribute:null,relationship:null}},permissionRoles:null}},4:{templateType:r.ForecastConfigTemplateType.Custom,rollupEntity:"opportunity",hierarchyEntity:"",hierarchyRelationship:{entityName:"opportunity",linkedByAttribute:null,relationship:null},permissionsData:{permissionTypes:[],permissionAttribueInfo:null,permissionRoles:null}}}},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.Get=function(){return this.dateFormatterProvider},e.Set=function(e){this.dateFormatterProvider=e},e}();t.DateFormatterProvider=r},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Hide=0]="Hide",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(t.IStepperButtonState||(t.IStepperButtonState={})),function(e){e[e.BACK=0]="BACK",e[e.NEXT=1]="NEXT"}(t.IStepperButton||(t.IStepperButton={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(826),i=n(830),o=function(){function e(){}return e.getCalculatedFieldExpressionParser=function(){return new r.ExpressionParser},e}();t.ExpressionParserFactory=o;var a=function(){function e(){}return e.getSuggestionProvier=function(){return new i.SuggestionsProvider},e}();t.SuggestionProviderFactory=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorPosition=n,r}return i(t,e),t}(Error);t.ParseError=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(110),i=n(43),o=n(95),a=n(174),s=n(175),l=n(227),c=n(7),u=n(8),d=n(98),p=n(87),_=n(15),E=function(){function e(e,t){this.dispatch=e,this.dataAccess=t}return e.prototype.OnValueChange=function(e,t){e.hierarchyEntity?this.dispatch(i.DetermineHierarchySelectorDialog(e.hierarchyEntity,t)):this.dispatch(i.UpdateFieldValue(e,t))},e.prototype.RefreshForm=function(e,t){var n=this;return new Promise((function(a){if(n.dispatch(i.UpdateShowWarningsFlag(!1)),e.formType==r.FormType.EditForm&&e.formInput.fcId){var s=e.formInput.fcId;_.logInfo("formEventsHandler","",t,"refresh-fc-form-start"),n.dataAccess.fetchForecastConfig(s).then((function(e){_.logInfo("formEventsHandler","",t,"refresh-fc-form-end"),n.dispatch(i.UpdateActiveForecastConfig(e)),n.dispatch(i.UpdateFieldValue(e,t)),a(e),n.dispatch(i.TriggerFormRefreshed())})).catch((function(){n.dispatch(d.onErrorShowDialogActionCreator(p.IErrorDialogType.ForecastConfigFetchingFailed))})),e.formInput.siLicenseAvailable&&n.dataAccess.fetchPredictionStatusForFC(s).then((function(e){n.dispatch(i.UpdateFCPredictionStatus(e))})).catch((function(){n.dispatch(i.UpdateFCPredictionStatus({}))}))}else if(e.formType==r.FormType.CreateForm){var l=e.formInput.templateType,c=o.GetEmptyForecastConfigInfo(l);n.dispatch(i.UpdateActiveForecastConfig(c)),n.dispatch(i.UpdateFieldValue(c,t)),a(c),n.dispatch(i.TriggerFormRefreshed())}else a(o.GetEmptyForecastConfigInfo()),n.dispatch(i.TriggerFormRefreshed())}))},e.prototype.UpdateStepperStage=function(e){this.dispatch(l.onStepClickActionCreator(e))},e.prototype.UpdateData=function(e,t,n,i,o){var s=this;if(a.showOrHideCrmLoaading(!0,c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_CRM_SAVING_CALLS)),e){var l=this.getDiff(t,n);_.logInfo("formEventsHandler","",o,"update-fc-start"),this.dataAccess.updateForecastConfig(e,l).then((function(t){_.logInfo("formEventsHandler","",o,"update-fc-end");var n={formType:r.FormType.EditForm,formInput:{fcId:e}};s.RefreshForm(n,o).then((function(){a.showOrHideCrmLoaading(!1)}))})).catch((function(){a.showOrHideCrmLoaading(!1),s.dispatch(d.onErrorShowDialogActionCreator(p.IErrorDialogType.ForecastConfigUpdateFailed))}))}else _.logInfo("formEventsHandler","",o,"create-fc-start"),this.dataAccess.createForecastConfig(t).then((function(e){_.logInfo("formEventsHandler","",o,"create-fc-end");var t={formType:r.FormType.EditForm,formInput:{fcId:e}};s.RefreshForm(t,o).then((function(){a.showOrHideCrmLoaading(!1),i||s.navigateCrmToEditPagePostCreation(e)}))})).catch((function(){s.dispatch(d.onErrorShowDialogActionCreator(p.IErrorDialogType.ForecastConfigCreateFailed))}))},e.prototype.navigateCrmToEditPagePostCreation=function(e){if(s.CrmNavigationHelpers.isCrmUrlNavigationEnabled()){var t={isEditMode:"true",id:e,isNew:"true"};s.CrmNavigationHelpers.navigateWithParams(t)}},e.prototype.getDiff=function(e,t){var n={};return Object.keys(e).map((function(r){e[r]!=t[r]&&(n[r]=e[r])})),n},e}();t.FormEventsHandler=E},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),l=a(n(364)),c=n(110),u=n(23),d=n(325),p=a(n(1145)),_=n(65),E=a(n(1148)),S=a(n(1149)),f=a(n(1150)),C=a(n(614)),m=n(41),g=n(109),T=a(n(1151)),I=n(96),h=n(15),A=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.renderFormControl=function(e,t,n,r,i,a,u,d){void 0===a&&(a=!0),void 0===u&&(u=!1),u=u||this.props.isFormLocked;var _,g=this.generateCommonFormControlProps(e,t,n,r,a,u,i);switch(r){case c.ICrmAttributeType.OptionSet:_=s.default.createElement(C.default,o({},o({},g,d)));break;case c.ICrmAttributeType.EntityPicker:var I=o({},g,{entityType:d?d.entityType:""});_=s.default.createElement(E.default,o({},I));break;case c.ICrmAttributeType.DatePicker:_=s.default.createElement(f.default,o({},g));break;case c.ICrmAttributeType.Lookup:var h=o({},g,{targetEntity:n});_=s.default.createElement(p.default,o({},h));break;case c.ICrmAttributeType.NumberPicker:var A=o({},g,{minValue:1,maxValue:d&&d.maxValue?d.maxValue:4});_=s.default.createElement(S.default,o({},A));break;case c.ICrmAttributeType.ViewPicker:var y=null!=d?d.viewDict:null,R=o({},g,{rollupEntityViewList:{viewDic:y}});_=s.default.createElement(T.default,o({},R))}var D=!m.ForecastingBusinessLogicProvider.FieldHasNonNullValue(e,g.value)&&this.props.formState.showEmptyWarnings;return s.default.createElement(l.default,o({},o({},g,{labelText:i,isEmpty:D})),_)},t.prototype.generateCommonFormControlProps=function(e,t,n,r,i,o,a){var s=this;return a=i?a+" *":a,{id:e,attributeInfo:{id:e,name:t,entityName:n,type:r},onChange:function(r){var i,o=((i={})[e]=r,i),a=I.createNewContext("on-field-change-of-"+e);h.logUsage("ForecastConfigurationForm-"+e+"-ValueChange","onChange",{control:e,attrLogicalName:t,entityName:n,value:r},"Change","onChange"),s.props.formEventsHandler.OnValueChange(o,a)},value:""+this.props.formData[e],crmDataAcces:this.props.crmDataAccess,label:a,childrenType:r,isMandatory:i,isDisabled:o}},t}(s.default.Component);function y(e){return{formData:_.GetFormData_fromState(e),isFormDirty:_.GetIsFormDirty_FromState(e),formState:_.GetFormState_FromState(e),activeStage:e.stepperActiveStage,isFormLocked:_.GetIsFormLocked_FromState(e),arePostPublishUpdatableFieldsUpdatable:_.ArePostPublishUpdatableFieldsUpdatable(e),orgUrl:e.crmOrgInfo.clientUrl,hierarchyEntityDisplayName:g.getHierarchyEntityDisplayName(e),rollupEntityViewList:e.rollupEntityViewList,isSILicenseAvailable:_.GetSILicenseStatusFromState(e),isSIPackageInstalled:_.GetSIPackageStatusFromState(e)}}t.default=A;var R=function(e,t){return{formEventsHandler:new d.FormEventsHandler(e,t.crmDataAccess.forecastConfigAccess)}};t.ConnectedFormGenerator=function(e){return u.connect(y,R)(e)}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(110);n(1143);var l=n(22),c=n(7),u=n(8),d=n(61),p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.valueIsEmpty=function(){return 1==this.props.isEmpty},t.prototype.renderIconWithTooltip=function(e,t,n){var r=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_COLUMN_EDITOR_INFORMATION_ICON_LABEL);return a.default.createElement(l.TooltipHost,{hostClassName:"formLabelHelpContainer",content:e,id:t,directionalHint:l.DirectionalHint.rightCenter},a.default.createElement(d.IconButton,{iconProps:{iconName:n},className:"ms-IconExample formLabelHelpIcon",ariaLabel:r}))},t.prototype.render=function(){var e=this.props.isMandatory?this.props.labelText+" *":this.props.labelText,t=void 0,n=void 0,r="FormControlDecorator";if(this.valueIsEmpty()){var i=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_EDIT_FIELD_MANDATORY_MESSAGE);n=a.default.createElement("span",{className:"formWarningText"},i),r+=" delfiFormFieldError"}this.props.childrenType===s.ICrmAttributeType.Lookup&&(t=a.default.createElement("div",{className:"formLabel"},a.default.createElement("span",{className:"formLabelText"},e)));var o=void 0;return this.props.helperText&&(o=this.renderIconWithTooltip(this.props.helperText,"formId","Info")),a.default.createElement("div",{className:r},t,o,this.props.children,n)},t}(a.default.Component);t.default=p},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),o=n(22);t.RibbonBase=function(e){return i.createElement("div",null,i.createElement(o.CommandBar,{items:e.items,styles:{root:{height:"44px",background:"none",borderBottom:"thin solid #E1DFDD"}}}))}},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(252),o=n(645),a=n(71),s=n(659),l=n(832),c=n(842),u=n(844),d=n(504),p=n(846),_=n(847),E=n(848),S=n(849),f=n(850),C=n(501),m=n(851),g=n(852),T=n(853),I=n(854),h=n(855),A=n(856),y=n(858),R=n(859),D=n(860),O=n(861);function F(e){var t=[],n=window.__REDUX_DEVTOOLS_EXTENSION__;n&&t.push(n());var r=[E.forecastConfigActionsMiddleware,D.orgSettingsMiddleware,s.scheduleCalculationMiddleware,I.securityRolesFetcherMiddleware,l.categoryValuesFetcherMiddleware,g.columnInfoEditsMiddleware,R.selectorChangeTriggerRelatedCleanupMiddleware,c.saveEventsMiddleware,h.permissionDataMiddleware,u.dialogRendererMiddleware,d.hierarchyFetcherTriggerMiddleware,f.previewGridColumnReorderMiddleware,C.colconfigautopopulationMiddleware,S.amountBaseFieldFetcherMiddleware,p.optionSetInfoListFetcherMiddleware,_.quotaStatusFetcherMiddleware,m.siAvailabilityMiddleware,T.hierarchyEntitiesMetadataFetcherMiddleware,A.chartValuesForColumnMiddleware,y.viewListFetcherMiddleware,O.formsProSurveyMiddleware],a=i.compose.apply(void 0,[i.applyMiddleware.apply(void 0,r)].concat(t));return i.createStore(o.rootReducer,e,a)}t.default=F,t.store=F(a.initialAppState),t.resetStore=function(){t.store=F(r({},r({},a.initialAppState,{crmOrgInfo:r({},a.initialAppState.crmOrgInfo,{calenderStartDate:t.store.getState().crmOrgInfo.calenderStartDate,isAdminSettingsEnabled:t.store.getState().crmOrgInfo.isAdminSettingsEnabled,isSILicenseAvailable:t.store.getState().crmOrgInfo.isSILicenseAvailable})})))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16);!function(e){e[e.Overview=0]="Overview",e[e.ColumnEditor=1]="ColumnEditor",e[e.OptionSetSelector=2]="OptionSetSelector"}(t.ColumnEditorPanelType||(t.ColumnEditorPanelType={})),t.initialForecastColumnEditorState={idEditorOpened:!1,hasUniqueNameBeenEdited:!0,isOptionSetSelectorOpened:!1,activeForecastColumnId:"",uneditedColumnInfo:{id:"",title:"",columnType:r.ForecastColumnType.HierarchyPrimary,isActive:!0,uniqueName:""},isCalculatedFieldExpressionErrorHidden:!0,calculatedFieldExpressionErrorMessage:"",calculatedFieldExpressionSuggestions:{forecastColumns:[]},isSuggestionCalloutVisible:!1,optionSetAttributeInfoDict:{},isChangeConfirmationDialogOpen:!1,isColumnConfigAutopopulationDialogOpen:!1,selectedAttributeVal:""}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(391),o=n(16);t.columnEditorStateReducer=function(e,t){var n;switch(void 0===e&&(e=i.initialForecastColumnEditorState),t.type){case"@@ColumnEditorState/UpdateIsEditorOpened":return r({},e,{idEditorOpened:t.payload.isEditorOpened});case"@@ColumnEditorState/UpdateHasUniqueNameBeenEdited":return r({},e,{hasUniqueNameBeenEdited:t.payload.hasUniqueNameBeenEdited});case"@@ColumnEditorState/UpdateIsOptionSetSelectorOpened":return r({},e,{isOptionSetSelectorOpened:t.payload.isOpen});case"@@ColumnEditorState/UpdateIsChangeConfirmationDialogOpen":return r({},e,{isChangeConfirmationDialogOpen:t.payload.isOpen});case"@@ColumnOverview/UpdateIsColumnConfigAutoPopulateDialogOpen":return r({},e,{isColumnConfigAutopopulationDialogOpen:t.payload.isOpen});case"@@ColumnEditorState/UpdateActiveForecastColumn":return r({},e,{activeForecastColumnId:t.payload.column.id,uneditedColumnInfo:r({},t.payload.column)});case"@@ColumnEditorState/UpdateIsCalculatedFieldExpressionErrorHidden":return r({},e,{isCalculatedFieldExpressionErrorHidden:t.payload.isCalculatedFieldExpressionErrorHidden});case"@@ColumnEditorState/UpdateCalculatedFieldExpressionErrorMessage":return r({},e,{calculatedFieldExpressionErrorMessage:t.payload.calculatedFieldExpressionErrorMessage});case"@@ColumnEditorState/UpdateCalculatedFieldExpressionSuggestions":return r({},e,{calculatedFieldExpressionSuggestions:t.payload.calculatedFieldExpressionSuggestions});case"@@ColumnEditorState/UpdateIsSuggestionCalloutVisible":return r({},e,{isSuggestionCalloutVisible:t.payload.isSuggestionCalloutVisible});case"@@ColumnEditor/UpdateOptionSetInfoList":return r({},e,{optionSetAttributeInfoDict:r({},e.optionSetAttributeInfoDict,(n={},n[t.payload.rollupEntity]=t.payload.list,n))});case"@@OptionSetChoiceList/UpdateSelectedValue":return r({},e,{selectedAttributeVal:t.payload.value});default:return e}},t.PredictiveAvailabilityStateReducer=function(e,t){switch(void 0===e&&(e=o.PredictiveAvailabilityStateType.FcbOff),t.type){case"@@PredictiveFeature/UpdateAvailabilityState":return t.payload.value;default:return e}}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,s=o(n(0)),l=n(16),c=n(22),u=n(7),d=n(8),p=n(41),_=n(302);!function(e){e.Configure="configure",e.CheckBoxClicked="checkBox",e.Delete="delete",e.MoveUp="moveUp",e.MoveDown="moveDown"}(a=t.ColumnSelectorActionType||(t.ColumnSelectorActionType={}));var E=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderItem=function(e){return s.default.createElement("div",null)},n._onRenderOverflowButton=function(e){return s.default.createElement(c.IconButton,{tabIndex:0,ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_MORE_COMMANDS),className:n.state.isContextOpen?"":"columnMoreButton",styles:{root:{minWidth:0,alignSelf:"stretch",height:"auto",width:25,paddingTop:5,paddingBottom:5},rootHovered:{},rootExpanded:{color:"#2266E3 !important"},menuIcon:{height:"auto",lineHeight:"normal"},menuIconHovered:{color:"#2266E3"},menuIconExpanded:{color:"#2266E3"}},menuIconProps:{iconName:"MoreVertical"},menuProps:{items:e,onMenuOpened:function(){n.setState({isContextOpen:!0})},onMenuDismissed:function(){n.setState({isContextOpen:!1})}}})},n.state={isContextOpen:!1},n}return i(t,e),t.prototype.renderOverflow=function(){var e=this;return s.default.createElement(c.OverflowSet,{styles:{root:{marginLeft:5}},items:[],overflowItems:[{key:"configure",name:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE),disabled:p.ForecastingBusinessLogicProvider.IsColumnOverviewContextButtonDisabled(a.Configure,this.props.columnType,this.props.formStatus,this.props.columnUniqueName,this.props.arePostPublishUpdatableFieldsUpdatable,this.props.order),iconProps:{iconName:"Settings"},onClick:function(){e.props.onAction(a.Configure)}},{key:"delete",name:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE),disabled:p.ForecastingBusinessLogicProvider.IsColumnOverviewContextButtonDisabled(a.Delete,this.props.columnType,this.props.formStatus,this.props.columnUniqueName,this.props.arePostPublishUpdatableFieldsUpdatable,this.props.order),onClick:function(){e.props.onAction(a.Delete)},iconProps:{iconName:"Delete"}},{key:"moveUp",name:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP),disabled:p.ForecastingBusinessLogicProvider.IsColumnOverviewContextButtonDisabled(a.MoveUp,this.props.columnType,this.props.formStatus,this.props.columnUniqueName,this.props.arePostPublishUpdatableFieldsUpdatable,this.props.order),onClick:function(){e.props.onAction(a.MoveUp)},iconProps:{iconName:"Up"}},{key:"moveDown",name:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN),disabled:p.ForecastingBusinessLogicProvider.IsColumnOverviewContextButtonDisabled(a.MoveDown,this.props.columnType,this.props.formStatus,this.props.columnUniqueName,this.props.arePostPublishUpdatableFieldsUpdatable,this.props.order),onClick:function(){e.props.onAction(a.MoveDown)},iconProps:{iconName:"Down"}}],onRenderOverflowButton:this._onRenderOverflowButton,onRenderItem:this._onRenderItem})},t.prototype.renderStatusIcon=function(e){var t;switch(e){case l.ForecastColumnStatus.Incomplete:var n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_SELECTOR_ROW_TOOLTIP_STATUS);t=this.renderWarningIconWithTooltip(n);break;case l.ForecastColumnStatus.DuplicateUniqueName:n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE);t=this.renderWarningIconWithTooltip(n)}if("quota"==this.props.columnUniqueName){n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_SELECTOR_QUOTA_ROW_TOOLTIP);t=this.renderIconWithTooltip(n,"quotaColumn","Info")}else if("predictive"==this.props.columnUniqueName){var r=this.props.fcPredictionStatus;if(r&&r.PredictionStatus){if("completed"==r.PredictionStatus.toLowerCase()){var i=_.DateFormatterProvider.Get();n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.PF_LAST_PREDICTED_ON)+" "+i.formatDate(new Date(r.PredictionOn),!1);t=this.renderIconWithTooltip(n,"predictiveid","Info")}else if("failed"==r.PredictionStatus.toLowerCase()&&r.ErrorCode){n="";n="internalexception"==r.ErrorCode.toLowerCase()?u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.PF_PREDICTION_FAILED_INTERNALEXC_TOOLTIP):"insufficientdataexception"==r.ErrorCode.toLowerCase()?u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.PF_PREDICTION_FAILED_INSUFFICIENTDATA_TOOLTIP):u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.PF_PREDICTION_FAILED).replace("{0}",r.ErrorCode);t=this.renderIconWithTooltip(n,"predictiveid","Warning",{root:{color:"#FF0000"},rootHovered:{color:"#FF0000"}})}else if("inprogress"==r.PredictionStatus.toLowerCase()){n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.PF_PREDICTIONSTATUS_INPROGRESS_TOOLTIP);t=this.renderIconWithTooltip(n,"predictiveid","Info")}}else{n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.PF_PREDICTION_INFO_TOOLTIP);t=this.renderIconWithTooltip(n,"predictiveid","Info")}}return t},t.prototype.renderWarningIconWithTooltip=function(e){return this.renderIconWithTooltip(e,"status","WarningSolid",{root:{color:"#A80000"}})},t.prototype.renderLockIcon=function(){var e;switch(this.props.columnType){case l.ForecastColumnType.Predictive:var t=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_SELECTOR_ROW_TOOLTIP_LOCK);e=this.renderIconWithTooltip(t,"predictiveLock","Lock")}return e},t.prototype.renderIconWithTooltip=function(e,t,n,r){return s.default.createElement(c.TooltipHost,{content:e,id:t,directionalHint:c.DirectionalHint.rightCenter},s.default.createElement(c.IconButton,{iconProps:{iconName:n},className:"ms-IconExample columnIcon",styles:r,ariaLabel:e}))},t.prototype.render=function(){var e=this,t=this.props.status==l.ForecastColumnStatus.Disabled,n="columnRow";return this.state.isContextOpen&&(n+=" expandedColumnRow"),s.default.createElement("div",{className:n},s.default.createElement(c.Checkbox,{className:"columnCheckbox",label:this.props.title,checked:this.props.isActive,disabled:t,onChange:function(t,n){e.props.onAction(a.CheckBoxClicked)}}),s.default.createElement("div",{className:"iconsWarningAndGear"},this.renderStatusIcon(this.props.status),this.renderOverflow()))},t}(s.default.Component);t.ColumnSelectorRow=E},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=function(){function e(){}return e.Rollup_Bestcase=function(){return{id:"bestcase_col",title:"Bestcase",columnType:r.ForecastColumnType.Rollup,isActive:!0,amountField:"estimated_revenue",amountBaseField:"estimated_revenue_base",dateField:"estimated_closedate",optionSetValue:100000001,uniqueName:"BESTCASE",showProgressComparedToQuota:!0,isManuallyAdjustable:!0}},e.Rollup_Committed=function(){return{id:"commited_col",title:"Commited",columnType:r.ForecastColumnType.Rollup,dataType:r.ForecastColumnDataType.Currency,isActive:!0,amountField:"estimated_revenue",amountBaseField:"estimated_revenue_base",dateField:"estimated_closedate",optionSetValue:100000002,uniqueName:"COMITTED",calculatedFieldExpression:"",showProgressComparedToQuota:!0,isManuallyAdjustable:!0,hierarchyAttributeInfo:{attributeName:"",relationship:{entityName:"",linkedByAttribute:null,relationship:null}},description:"",colorCode:"",showInTrendChart:!1}},e.Owner=function(){return{id:"owner",title:"Owner",columnType:r.ForecastColumnType.HierarchyPrimary,isActive:!0,uniqueName:"Owner"}},e.Predictive=function(){return{id:"predictive",title:"Predictive",columnType:r.ForecastColumnType.Predictive,isActive:!0,uniqueName:"Predictive"}},e}();t.FakeColumnInfoData=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Current=0]="Current",e[e.Completed=1]="Completed",e[e.CurrentCompleted=2]="CurrentCompleted",e[e.Enabled=3]="Enabled",e[e.Disabled=4]="Disabled"}(t.IDelphiState||(t.IDelphiState={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(827),i=n(137),o=n(223),a=n(324),s=n(224),l=n(7),c=n(8),u=function(){function e(){}return e.prototype.parseExpressionToTokens=function(e,t){o.Validations.validateNullArgument(e,"expression");for(var n=[],r=e,i=0;r.length>0;){var u=this.getWhiteSpaceLength(r);if(u>0)i+=u,r=r.slice(u);else{var d=null;if(null===d&&(d=this.parseIdentifier(r,i)),null===d&&(d=this.parseNumber(r,i)),null===d&&(d=this.parseOperator(r,i)),null===d&&(d=this.parseParenthesis(r,i)),null===d){if(!t)throw new a.ParseError(s.StringFormatter.formatString(l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.EXP_PARSER_ERROR_INVALID_CHARACTER),r[0],(i+1).toString()),i);d=this.buildUnknownToken(r,i)}n.push(d),i+=d.length,r=r.slice(d.length)}}return n},e.prototype.parseIdentifier=function(t,n){var r=null,o=t.match(e.identifierRegex);return o&&o.length>0&&(r=this.buildToken(i.TokenType.Identifier,o[0],n)),r},e.prototype.parseNumber=function(t,n){var r=null,o=t.match(e.numberRegex);return o&&o.length>0&&(r=this.buildToken(i.TokenType.Number,o[0],n)),r},e.prototype.parseOperator=function(e,t){var n=null,r=i.TokenType.Unknown;return"+"===e[0]?r=i.TokenType.Plus:"-"===e[0]?r=i.TokenType.Minus:"*"===e[0]?r=i.TokenType.Multiple:"/"===e[0]&&(r=i.TokenType.Divide),r!==i.TokenType.Unknown&&(n=this.buildToken(r,e[0],t)),n},e.prototype.parseParenthesis=function(e,t){var n=null,r=i.TokenType.Unknown;return"("===e[0]?r=i.TokenType.LeftParenthesis:")"===e[0]&&(r=i.TokenType.RightParenthesis),r!==i.TokenType.Unknown&&(n=this.buildToken(r,e[0],t)),n},e.prototype.buildUnknownToken=function(e,t){return this.buildToken(i.TokenType.Unknown,e[0],t)},e.prototype.getWhiteSpaceLength=function(t){var n=-1,r=t.match(e.whiteSpaceRegex);return r&&r.length>0&&(n=r[0].length),n},e.prototype.buildToken=function(e,t,n){var i=null!=t?t.length:0;return new r.Token(e,t,n,i)},e.identifierRegex=/^[A-Z][0-9A-Z_]*/i,e.numberRegex=/^\d+\.?\d*|^\.\d+/,e.whiteSpaceRegex=/^\s+/,e}();t.LexicalAnalyzer=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(137),i=n(16),o=function(){function e(){}return e.isOperator=function(e){return e===r.TokenType.Plus||e===r.TokenType.Minus||e===r.TokenType.Multiple||e===r.TokenType.Divide},e.isValidDependencyType=function(e,t){return this.isValidColumnType(e)&&this.isValidColumnDataType(t)},e.isValidColumnType=function(e){return e!==i.ForecastColumnType.HierarchySecondary&&e!==i.ForecastColumnType.HierarchyPrimary},e.isValidColumnDataType=function(e){return e===i.ForecastColumnDataType.Currency||e===i.ForecastColumnDataType.Decimal},e}();t.ExpressionParserUtils=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=n(16),o=n(82);t.ORG_TEMPLATE_DATE_FIELD="estimatedclosedate",t.ORG_TEMPLATE_AMOUNT_FIELD="estimatedvalue",t.ORG_TEMPLATE_ACTUAL_DATE_FIELD="actualclosedate",t.ORG_TEMPLATE_ACTUAL_AMOUNT_FIELD="actualvalue",t.ORG_TEMPLATE_AMOUNT_BASE_FIELD="estimatedvalue_base",t.ORG_TEMPLATE_ACTULAMOUNT_BASE_FIELD="actualvalue_base",t.colconfigautopopulationMiddleware=function(e){var n=e.getState;return function(e){return function(a){if("@@ColumnEditor/TriggerColumnConfigAutoPopulate"==a.type){var s=n();if("msdyn_forecastcategory"==o.GetSelectedOptionSetAttribute_FromState(s)){var l=!0;s.FormFieldData.columns.map((function(e){e.columnType==i.ForecastColumnType.Rollup&&(e.amountField||e.dateField)&&(l=!1)})),l&&s.FormFieldData.columns.map((function(n){var i=n.optionSetValue<=100000004,o=i?t.ORG_TEMPLATE_DATE_FIELD:t.ORG_TEMPLATE_ACTUAL_DATE_FIELD,a=i?t.ORG_TEMPLATE_AMOUNT_FIELD:t.ORG_TEMPLATE_ACTUAL_AMOUNT_FIELD,s=i?t.ORG_TEMPLATE_AMOUNT_BASE_FIELD:t.ORG_TEMPLATE_ACTULAMOUNT_BASE_FIELD;e(r.UpdateColumnInfoField(n.id,"dateField",o)),e(r.UpdateColumnInfoField(n.id,"amountField",a)),e(r.UpdateColumnInfoField(n.id,"amountBaseField",s)),100000002!=n.optionSetValue&&100000003!=n.optionSetValue||e(r.UpdateColumnInfoField(n.id,"isManuallyAdjustable",!0)),function(e){return 100000005==e.optionSetValue}(n)&&e(r.UpdateColumnInfoField(n.id,"showProgressComparedToQuota",!0))}))}}return e(a)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(95),o=n(176),a=n(163),s=n(16),l=function(){function e(e){this.dispatch=e}return e.prototype.OpenCreatePage=function(e){if(!e||!(e in s.ForecastConfigTemplateType))throw new Error("Invalid template type received for forecast configuration create page.");i.GetEmptyForecastConfigInfo(e);this.dispatch(r.UpdateFieldValue({templateType:e})),this.dispatch(o.changeMainPageType(a.IMainPageType.EditPage))},e.prototype.OpenEditPage=function(e){var t={id:e};this.dispatch(r.UpdateFieldValue(t)),this.dispatch(o.changeMainPageType(a.IMainPageType.EditPage))},e.prototype.OpenGridPage=function(){this.dispatch(o.changeMainPageType(a.IMainPageType.GridPage))},e.prototype.OpenPredictivePage=function(){this.dispatch(o.changeMainPageType(a.IMainPageType.PredictivePage))},e}();t.ReduxNavigationHandler=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(297),o=n(7),a=n(8);t.getLocalizedTemplateName=function(e){switch(e){case r.ForecastConfigTemplateType.OrgChart:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_TEMPLATE_TYPE_ORG_CHART);case r.ForecastConfigTemplateType.TerritoryBased:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_TEMPLATE_TYPE_TERRITORY_BASED);case r.ForecastConfigTemplateType.Custom:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_TEMPLATE_TYPE_CREATE_FROM_SCRATCH);default:return""}},t.setDefaultTemplateBasedValuesForExistingRecords=function(e){var t=r.ForecastConfigTemplateType.OrgChart;e.templateType=t,e.hierarchyRelationship=i.forecastConfigTemplates[t].hierarchyRelationship},t.getDefaultPermissionDataByTemplate=function(e){return void 0!==i.forecastConfigTemplates[e]?i.forecastConfigTemplates[e].permissionsData:null}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(228),o=n(53),a=n(845),s=n(98),l=n(87),c=n(119),u=n(15),d=n(16),p=n(43);function _(e,t,n,c,p){var _=o.getCrmDataAccessInstance();if(_){var S=p&&r({},p.context)||{};u.logInfo("hierarchyFetcherMiddleware","",S,"hierarchy-list-fetch-start"),e(a.FetchHierarchyStartedDataActionCreator()),_.hierarchyDataAccess.fetchForecastHierarchy(t,n,function(e,t){var n=e.FormFieldData.columns;return function(e){return e.filter((function(e){return e.columnType===d.ForecastColumnType.HierarchySecondary&&e.hierarchyAttributeInfo})).map((function(e){return E(e.hierarchyAttributeInfo)}))}(t&&t.payload&&t.payload.data&&t.payload.data.columns||n)}(c,p)).then((function(t){u.logInfo("hierarchyFetcherMiddleware","",S,"hierarchy-list-fetch-success"),e(i.ClearPreviewGridHierarchyData()),e(i.AddPreviewGridHierarchyData(t)),e(a.FetchHierarchyCompletedDataActionCreator())}),(function(t){console.error("An error occurred while fetching the hierarchy: "+t),e(s.onErrorShowDialogActionCreator(l.IErrorDialogType.FetchingHierarchyDataFailed)),e(a.FetchHierarchyCompletedDataActionCreator())}))}else console.warn("CrmDataAccess object is null. Unable to fetch category option members")}function E(e){return e?e.relationship&&e.relationship.relationship?e.relationship.relationship.linkedByAttribute:e.attributeName:""}t.hierarchyFetcherTriggerMiddleware=function(e){var t=e.getState;return function(e){return function(n){if(("@@FormData/UpdateFieldValue"==n.type&&n.payload.data.hierarchyEntity||"@@FormData/UpdateFieldValue"==n.type&&n.payload.data.topOfHierarchy)&&(function(e,t,n){if(void 0!==t.payload.data.hierarchyEntity&&null!==t.payload.data.hierarchyEntity&&t.payload.data.hierarchyEntity.length>0){var r=t.payload.data.hierarchyEntity;if(null==e().entityMetadataList[r]){var i=o.getCrmDataAccessInstance();if(!i)return void console.warn("CrmDataAccess object is null. Unable to fetch entity metadata");i.cdsResolver.cdsClient.then((function(e){e.fetchEntityAndRelatedEntityMetadata({entityName:r}).then((function(e){n(c.SetEntityMetadata(r,e))}))})).catch((function(e){u.logError("Delphi-Config Fetch Hierarchy metadata",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{})}))}}}(t,n,e),function(e,t,n){var r=void 0!==t.payload.data.hierarchyEntity?t.payload.data.hierarchyEntity:e().FormFieldData.hierarchyEntity,i=void 0!==t.payload.data.topOfHierarchy?t.payload.data.topOfHierarchy:e().FormFieldData.topOfHierarchy;if(r&&i){var o=e().FormFieldData;if(r==o.hierarchyEntity&&i==o.topOfHierarchy)return;if(r!==o.hierarchyEntity&&""!==o.topOfHierarchy){var a={topOfHierarchy:""};return void n(p.UpdateFieldValue(a))}_(n,r,i,e(),t)}}(t,n,e)),"@@FormData/UpdateColumnInfoField"==n.type&&"hierarchyAttributeInfo"==n.payload.fieldName&&n.payload.value||"@@FormData/ReplaceColumn"==n.type&&n.payload.column&&n.payload.column.hierarchyAttributeInfo||"@@FormData/AddColumn"==n.type&&n.payload.column&&n.payload.column.hierarchyAttributeInfo){var r=e(n),i=t();return _(e,i.FormFieldData.hierarchyEntity,i.FormFieldData.topOfHierarchy,i),r}return e(n)}}},t.getLinkedAttributeNameFromColumnInfo=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Publish=function(){return{type:"@@EditApp/PublishAction",payload:{}}},t.QuotaStatusFetch=function(){return{type:"@@EditApp/QuotaStatusFetchAction",payload:{}}},t.QuotaUploadStart=function(e,t){return{type:"@@EditApp/QuotaUploadStartAction",payload:{fileName:e,fileContent:t}}},t.QuotaDownload=function(){return{type:"@@EditApp/QuotaDownloadAction",payload:{}}},t.QuotaUploadStatusUpdate=function(e){return{type:"@@EditApp/QuotaUploadStatusUpdateAction",payload:{quotaUploadStatus:e}}},t.QuotaUploadFetchUpdate=function(e){return{type:"@@EditApp/QuotaUploadFetchUpdateAction",payload:{isFetched:e}}},t.QuotaUploadDownloadUpdate=function(e){return{type:"@@EditApp/QuotaUploadDownloadUpdateAction",payload:{downloadStatus:e}}},t.QuotaUploadPublishUpdate=function(e){return{type:"@@EditApp/QuotaUploadPublishUpdateAction",payload:{isPublishing:e}}},t.NotificationConnect=function(){return{type:"@@EditApp/NotificationConnectAction",payload:{}}},t.PublishSubscribe=function(){return{type:"@@EditApp/PublishSubscribeAction",payload:{}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.Get=function(){return this.signalRNotificationProvider},e.Set=function(e){this.signalRNotificationProvider=e},e}();t.NotificationProvider=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(89),l=n(45),c=n(22);l.initializeIcons();var u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={cachedResults:void 0},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.generateMakerXControlProps(this.props);t.resolver.resolveOptionSetMembers(t.entityContext,t.fieldContext).then((function(t){e.props.sortByDisplayName?e.props.sortByDisplayName&&(t=t.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))):t=t.sort((function(e,t){return e.value-t.value})),e.setState({cachedResults:t})}))},t.prototype.componentDidUpdate=function(e){var t=this.generateMakerXControlProps(this.props),n=this.generateMakerXControlProps(e);t.fieldContext!==n.fieldContext&&(void 0===n.fieldContext||n.fieldContext&&t.fieldContext&&t.fieldContext.name!==n.fieldContext.name)&&(this.setState({cachedResults:void 0}),this.componentDidMount())},t.prototype.render=function(){var e=this,t=this.getDropDownStyles(),n=this.getDropDownOptions();return a.default.createElement("div",{className:"crmFabricOptionsetControl"},a.default.createElement(c.Dropdown,{label:this.props.label,ariaLabel:this.props.label,title:this.props.label,onChange:function(t,n){n&&e.props.onChange(n.key.toString())},selectedKey:""!=this.props.value?parseInt(this.props.value):void 0,options:n,disabled:this.props.isDisabled,styles:t,onRenderPlaceHolder:function(){var t=a.default.createElement("div",null,a.default.createElement(c.Spinner,null));return e.state.cachedResults&&(t=""),t}}))},t.prototype.getDropDownOptions=function(){return this.state.cachedResults?this.state.cachedResults.map((function(e){return{key:e.value,text:e.displayName}})):[]},t.prototype.generateMakerXControlProps=function(e){var t={name:e.attributeInfo.entityName,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},n={metadataId:e.attributeInfo.id,name:e.attributeInfo.name,displayName:e.attributeInfo.name,dataType:s.EDataType.UniqueIdentifier};return{resolver:e.crmDataAcces.cdsResolver,entityContext:t,fieldContext:n}},t.prototype.getDropDownStyles=function(){var e={title:{display:"flex",alignItems:"center",justifyContent:"center"}};return this.state.cachedResults&&(e.title={}),e},t}(a.default.Component);t.default=u},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(16),l=n(1157),c=n(248),u=n(23),d=n(108);n(1164);var p=n(228),_=n(65),E=n(22),S=n(7),f=n(8),C=n(15),m=function(e){function t(t){var n=e.call(this,t)||this;return n.handleColumnReorder=function(e,t){n.props.arePostPublishUpdatableFieldsUpdatable&&n.props.columnInfoList[e].columnType!=s.ForecastColumnType.HierarchyPrimary&&0!==t&&n.props.onColumnReorder(e,t)},n.state={},n.provider=new c.DelfiGridProvider,n.delfActions=n.provider.getDelfiActions(),n}return i(t,e),t.prototype.render=function(){if(this.props.isFetchingHierarchy)return a.default.createElement("div",{className:"hierarchyPreviewMessageWrapper"},a.default.createElement(E.Spinner,{ariaLabel:S.GlobalLocalizedStringsProvider.GetString(f.STRING_KEYS.FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1),label:S.GlobalLocalizedStringsProvider.GetString(f.STRING_KEYS.FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1),size:E.SpinnerSize.large}));var e=l.convertColumnConfigInfoToDelfiData(this.props.columnInfoList,this.props.hierarchyEnitityPreviewRecords,this.props.activeColumnId);if(this.delfActions.updateColumnReorderConfig(this.handleColumnReorder.bind(this)),this.delfActions.updateGridInput(e),e.rows.length>0){var t=e.rows[0];this.delfActions.expandRow(t.id,!0)}return a.default.createElement("div",{className:"previewGrid",style:{height:"calc(100% - 50px)"}},this.provider.render())},t}(a.default.Component);t.PreviewGrid=m,t.default=m;t.ConnectedPreviewGrid=u.connect((function(e){return{hierarchyEnitityPreviewRecords:e.ForecastHierarchyList,columnInfoList:d.GetForecastColumnsListForPreviewGrid_FromState(e),activeColumnId:e.columnEditorState.idEditorOpened?d.GetActiveColumnId_FromState(e):"",isFormReadonly:_.GetIsFormLocked_FromState(e),isFetchingHierarchy:e.isFetchingHierarchyData,arePostPublishUpdatableFieldsUpdatable:_.ArePostPublishUpdatableFieldsUpdatable(e)}}),(function(e){return{onColumnReorder:function(t,n){C.logUsage("PreviewGrid.ColumnReorder","",{dragIndex:t,targetIndex:n},"Reorder"),e(p.ReorderColumn(t,n))}}}))(m)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(89),l=n(45),c=n(22),u=n(110),d=n(7),p=n(8);l.initializeIcons(),t.CrnAttributePicker_None_Option_Key="-1";var _=function(e){function n(t){var n=e.call(this,t)||this;return n.onRenderItem=function(e,t){return"disabled"!==e.key&&t(e)},n.onRenderTitle=function(e,t){return"disabled"!==(Array.isArray(e)?e[0]:e).key&&t(e)},n.state={cachedResults:void 0},n}return i(n,e),n.prototype.componentDidMount=function(){var e=this,t=this.generateMakerXControlProps(this.props);this.props.attributesTypes?this.props.crmDataAcces.cdsResolver.resolveFields(t.entityContext).then((function(t){e.setState({cachedResults:t})})):this.props.crmDataAcces.cdsResolver.resolveFieldsMetadata(t.entityContext).then((function(t){e.setState({cachedResults:t})}))},n.prototype.componentDidUpdate=function(e){var t=this.generateMakerXControlProps(this.props),n=this.generateMakerXControlProps(e);t.entityContext!==n.entityContext&&(void 0===n.entityContext||n.entityContext&&t.entityContext&&t.entityContext.name!==n.entityContext.name)&&(this.setState({cachedResults:void 0}),this.componentDidMount())},n.prototype.render=function(){var e=this,t=this.getDropDownStyles(),n=this.getDropDownOptions();return a.default.createElement("div",{className:"crmAttributePickerControl"},a.default.createElement(c.Dropdown,{label:this.props.label,onChange:function(t,n){n&&"disabled"!==n.key&&e.props.onChange(n.key.toString())},selectedKey:""!=this.props.value?this.props.value:void 0,options:n,disabled:this.props.isDisabled,styles:t,placeHolder:this.props.placeHolder,onRenderTitle:this.onRenderTitle,onRenderItem:this.onRenderItem,onRenderPlaceHolder:function(){var t=a.default.createElement("div",null,a.default.createElement(c.Spinner,null));return e.state.cachedResults&&(t=e.props.placeHolder),t}}))},n.prototype.getDropDownOptions=function(){var e=this;if(!this.state.cachedResults)return[];var n=this.state.cachedResults.filter((function(t){return e.props.attributesTypes?e.props.attributeInfo.lookupEntityName?-1!=e.props.attributesTypes.indexOf(t.dataType)&&-1!=t.targets.indexOf(e.props.attributeInfo.lookupEntityName)||void 0!==e.props.attributeInfo.entityPrimaryIdAttribute&&-1!=[s.EDataType.UniqueIdentifier].indexOf(t.dataType)&&e.props.attributeInfo.entityName===e.props.attributeInfo.lookupEntityName&&t.name===e.props.attributeInfo.entityPrimaryIdAttribute:-1!=e.props.attributesTypes.indexOf(t.dataType):e.props.attributeInfo.type==u.ICrmAttributeType.OptionSet?-1!=[s.EDataType.OptionSet].indexOf(t.dataType):e.props.attributeInfo.type==u.ICrmAttributeType.DateField?-1!=[s.EDataType.Date].indexOf(t.dataType):e.props.attributeInfo.type==u.ICrmAttributeType.AmountField?-1!=[s.EDataType.Currency].indexOf(t.dataType)&&!t.CalculationOf:e.props.attributeInfo.type==u.ICrmAttributeType.Lookup?void 0!==e.props.attributeInfo.lookupEntityName?-1!=[s.EDataType.Lookup].indexOf(t.dataType)&&t.targets&&-1!=t.targets.indexOf(e.props.attributeInfo.lookupEntityName)||void 0!==e.props.attributeInfo.entityPrimaryIdAttribute&&-1!=[s.EDataType.UniqueIdentifier].indexOf(t.dataType)&&e.props.attributeInfo.entityName===e.props.attributeInfo.lookupEntityName&&t.name===e.props.attributeInfo.entityPrimaryIdAttribute:-1!=[s.EDataType.Lookup].indexOf(t.dataType):!e.props.attributeInfo.type})).map((function(e){return{key:e.name,text:e.displayName}}));return void 0!==this.props.showNoneOption&&1==this.props.showNoneOption&&n.push({key:t.CrnAttributePicker_None_Option_Key,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_PERMISSIONS_ATTRIBUTE_NONE)}),[{key:"disabled",text:""}].concat(n)},n.prototype.generateMakerXControlProps=function(e){var t={name:e.attributeInfo.entityName,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},n={metadataId:e.attributeInfo.id,name:e.attributeInfo.name,displayName:e.attributeInfo.name,dataType:s.EDataType.UniqueIdentifier};return{resolver:e.crmDataAcces.cdsResolver,entityContext:t,fieldContext:n}},n.prototype.getDropDownStyles=function(){var e={title:{display:"flex",alignItems:"center",justifyContent:"center"}};return this.state.cachedResults&&(e.title={}),e},n}(a.default.Component);t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=n(105),o=n(323),a=function(){function e(){}return e.UpdateColumnFieldValue=function(e,t,n,i){e(r.UpdateColumnInfoField(t,n,i))},e.UpdateCalculatedFieldExpressionValue=function(t,n,i,o,a){t(r.UpdateIsCalculatedFieldExpressionErrorHidden(!0)),t(r.UpdateColumnInfoField(o.id,"calculatedFieldExpression",i)),e.ShowSuggestionsForCalculatedFieldExpression(t,i,n,o,a)},e.OnCalculatedFieldExpressionBlur=function(t,n,r,i,o){e.ValidateCalculatedFieldExpression(n,o,i,t)},e.UpdateUniqueName=function(e,t,n){this.UpdateColumnFieldValue(e,t,"uniqueName",i.sanitizeUniqueName(n)),e(r.UpdateHasUniqueNameBeenEdited(!0))},e.ApplySuggestions=function(t,n,i,a,s){var l=o.SuggestionProviderFactory.getSuggestionProvier().applySuggestion(n.calculatedFieldExpression,i,a,s.targetToken);e.UpdateColumnFieldValue(t,n.id,"calculatedFieldExpression",l),t(r.UpdateIsCalculatedFieldExpressionErrorHidden(!0))},e.OnCalculatedFieldExpressionFocus=function(t,n,i,o,a){0==n.length&&null!==i&&(t(r.UpdateIsCalculatedFieldExpressionErrorHidden(!0)),e.ShowSuggestionsForCalculatedFieldExpression(t,n,i,o,a))},e.OnSuggestionCalloutDismiss=function(e){e(r.UpdateIsSuggestionCalloutVisible(!1))},e.ValidateCalculatedFieldExpression=function(e,t,n,i){var a=o.ExpressionParserFactory.getCalculatedFieldExpressionParser();try{a.parseExpression(e,t,n.uniqueName,n.id),i(r.UpdateIsCalculatedFieldExpressionErrorHidden(!0))}catch(e){i(r.UpdateIsCalculatedFieldExpressionErrorHidden(!1)),i(r.UpdateCalculatedFieldExpressionErrorMessage(e.message))}},e.ShowSuggestionsForCalculatedFieldExpression=function(e,t,n,i,a){var s=o.SuggestionProviderFactory.getSuggestionProvier().getSuggestions(t,a,n,i.id);e(r.UpdateCalculatedFieldExpressionSuggestions(s)),s.forecastColumns.length>0?e(r.UpdateIsSuggestionCalloutVisible(!0)):e(r.UpdateIsSuggestionCalloutVisible(!1))},e}();t.ColumnEditorFormOperations=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a,s=o(n(0)),l=n(23),c=n(365),u=n(82),d=n(619),p=n(7),_=n(8),E=n(15);!function(e){e[e.ChooseSelected=0]="ChooseSelected",e[e.Cancel=1]="Cancel"}(a=t.OptionSetSelectorRibbonActionType||(t.OptionSetSelectorRibbonActionType={}));var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){return s.createElement(c.RibbonBase,{items:this.getRibbonItems()})},t.prototype.getRibbonItems=function(){return[this.chooseSelectedButton(),this.verticleDivider(),this.cancelButton()]},t.prototype.verticleDivider=function(){return{key:"verticalDivider",onRender:function(){return s.createElement("div",{className:"ribbonButtonDivider"})}}},t.prototype.chooseSelectedButton=function(){var e=this;return{key:"chooseSelected",className:"ribbonBtn",name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_OPTIONSET_PANEL_RIBBON_CHOOSE_SELECTED),disabled:this.props.isSaveCloseDisabled,iconProps:{iconName:"CheckMark",style:{color:"#107C10"}},onClick:function(){E.logUsage("OptionSetSelectorRibbon.ChooseSelected button","",{},"Click"),e.props.onClick(a.ChooseSelected,e.props.isOptionSetChangeDescructive)}}},t.prototype.cancelButton=function(){var e=this;return{key:"cancel",className:"ribbonBtn",name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),iconProps:{iconName:"Cancel",style:{color:"#A80000"}},onClick:function(){E.logUsage("OptionSetSelectorRibbon.Cancel button","",{},"Click"),e.props.onClick(a.Cancel,e.props.isOptionSetChangeDescructive)}}},t}(s.Component);t.ConnectedOptionSetSelectorRibbon=l.connect((function(e){return{isSaveCloseDisabled:u.Get_IsChooseSelectedOptionSetButtonDisabled_FromState(e),isOptionSetChangeDescructive:u.Get_IsOptionSetChangeDescructive_FromState(e)}}),(function(e){return{onClick:function(t,n){d.OptionSetRibbonOperations.OnClickHandler(e,t,n)}}}))(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(618),i=n(44),o=function(){function e(){}return e.OnClickHandler=function(e,t,n){switch(t){case r.OptionSetSelectorRibbonActionType.ChooseSelected:this.ChooseSelected(e,n);break;case r.OptionSetSelectorRibbonActionType.Cancel:this.CloseWithoutSave(e)}},e.ChooseSelected=function(e,t){t?e(i.UpdateIsChangeConfirmationDialogOpen(!0)):this.SaveFieldAndClose(e)},e.SaveFieldAndClose=function(e){this.dismissPanel(e),e(i.TriggerCategoryValuesFetch())},e.CloseWithoutSave=function(e){this.dismissPanel(e)},e.dismissPanel=function(e){e(i.UpdateIsEditorOpened(!1)),e(i.UpdateIsOptionSetSelectorOpened(!1))},e}();t.OptionSetRibbonOperations=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a,s=o(n(0)),l=n(23),c=n(365),u=n(82),d=n(1195),p=n(7),_=n(8),E=n(15);!function(e){e[e.SaveAndClose=0]="SaveAndClose",e[e.Cancel=1]="Cancel"}(a=t.ColumnEditorRibbonActionType||(t.ColumnEditorRibbonActionType={}));var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){return s.createElement(c.RibbonBase,{items:this.getRibbonItems()})},t.prototype.getRibbonItems=function(){return[this.chooseSelectedButton(),this.verticleDivider(),this.cancelButton()]},t.prototype.verticleDivider=function(){return{key:"verticalDivider",onRender:function(){return s.createElement("div",{className:"ribbonButtonDivider"})}}},t.prototype.chooseSelectedButton=function(){var e=this;return{key:"saveAndClose",className:"ribbonBtn",name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE),disabled:this.props.isSaveCloseDisabled,iconProps:{iconName:"CheckMark",style:{color:"#107C10"}},onClick:function(){E.logUsage("ColumnEditorRibbon.SaveClose button","",{},"Click"),e.props.onClick(a.SaveAndClose)}}},t.prototype.cancelButton=function(){var e=this;return{key:"cancel",className:"ribbonBtn",name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),iconProps:{iconName:"Cancel",style:{color:"#A80000"}},onClick:function(){E.logUsage("ColumnEditorRibbon.Cancel button","",{},"Click"),e.props.onClick(a.Cancel)}}},t}(s.Component);t.ConnectedColumnEditorRibbon=l.connect((function(e){return{isSaveCloseDisabled:u.Get_IsColumnEditorRibbonSaveCloseDisabled_FromState(e)}}),(function(e){return{onClick:function(t){d.ColumnEditorRibbonOperations.OnClickHandler(e,t)}}}))(S)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a,s=o(n(0)),l=n(23),c=n(365),u=n(1196),d=n(65),p=n(82),_=n(7),E=n(8),S=n(15);!function(e){e[e.CreateNewColumn=0]="CreateNewColumn",e[e.ChooseOptionSet=1]="ChooseOptionSet"}(a=t.ColumnOverviewRibbonActionType||(t.ColumnOverviewRibbonActionType={}));var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){return s.createElement(c.RibbonBase,{items:this.getRibbonItems()})},t.prototype.getRibbonItems=function(){var e=void 0;return[e=this.props.isAddColumnHidden?this.addOptionSetButton(e):this.addColumnAndChooseOptionSetSplitButton(e)]},t.prototype.addOptionSetButton=function(e){var t=this;return{key:"createNew",disabled:this.props.isFormLocked,name:_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_FROM_OPTION_SET),onClick:function(){S.logUsage("ColumnOverviewRibbon.ChooseOptionSet button","",{},"Click"),t.props.onClick(a.ChooseOptionSet)},className:"ribbonBtn",iconProps:{iconName:"Add"},buttonStyles:{root:{}}}},t.prototype.addColumnAndChooseOptionSetSplitButton=function(e){var t=this;return{key:"createNew",name:_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN),ariaLabel:_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN),disabled:this.props.isFormLocked,className:"ribbonBtn",iconProps:{iconName:"Add"},split:!0,buttonStyles:{root:{},splitButtonMenuButton:{background:"none"}},subMenuProps:{items:[{key:"addOptionSet",name:_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET),ariaLabel:_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET),onClick:function(){S.logUsage("ColumnOverviewRibbon.ChangeOptionSet button","",{},"Click"),t.props.onClick(a.ChooseOptionSet)}}]},onClick:function(){S.logUsage("ColumnOverviewRibbon.AddColumn button","",{},"Click"),t.props.onClick(a.CreateNewColumn)}}},t}(s.Component);t.ConnectedColumnOverviewRibbon=l.connect((function(e){return{isAddColumnHidden:p.Get_IsAddColumnButtonHidden_FromState(e),isFormLocked:d.GetIsFormLocked_FromState(e)}}),(function(e){return{onClick:function(t){u.ColumnOverviewRibbonOperations.OnClickHandler(e,t)}}}))(f)},,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(86),c=n(23),u=n(99),d=n(7),p=n(8),_=n(15),E=function(e){function t(t){var n=e.call(this,t)||this;return n._closeDialog=function(){_.logUsage("ForecastConfigGridDeleteConfirmationDialog.Close","",{},"Click"),n.props.onClickDeleteDialog(l.IDeleteDialogActionType.CLOSE)},n._onClickConfirm=function(){_.logUsage("ForecastConfigGridDeleteConfirmationDialog.OK","",{},"Click"),n.props.onClickDeleteDialog(l.IDeleteDialogActionType.DELETE)},n._onCancel=function(){_.logUsage("ForecastConfigGridDeleteConfirmationDialog.Cancel","",{},"Click"),n.props.onClickDeleteDialog(l.IDeleteDialogActionType.CANCEL)},n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._closeDialog,modalProps:{styles:{main:{outline:"1px solid transparent !important"}}},dialogContentProps:{type:s.DialogType.normal,title:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DELETE_TITLE_GRIDPAGE),subText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DELETE_DESCRIPTION_GRIDPAGE)}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickConfirm,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE)}),a.default.createElement(s.DefaultButton,{onClick:this._onCancel,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE)}))))},t}(a.default.Component);t.ForecastConfigGridConfirmationDialog=E,t.default=E,t.ConnectedForecastConfigGridConfirmationDialog=c.connect((function(e){return{isHidden:e.gridAppDialogState.isGridDeleteDialogHidden,rowId:e.gridAppDialogState.gridActionableRow}}),(function(e){return{onClickDeleteDialog:function(t){e(u.onClickDeleteDialogActionCreator(t))}}}))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(176),o=n(178),a=n(99),s=n(98),l=n(87),c=n(15),u=function(){function e(e,t){this.dispatch=e,this.dataAccess=t}return e.prototype.RefreshGrid=function(e){var t=this;return new Promise((function(n){c.logInfo("gridEventsHandler","",e,"grid-refresh-start"),t.dataAccess.fetchForecastConfigList().then((function(i){c.logInfo("gridEventsHandler","",e,"grid-refresh-end");var o=t.FetchPredictionStatus(i);t.dispatch(r.UpdateForecastConfigList(o)),t.dispatch(r.UpdateForecastConfigListMetadata(o)),n(o)})).catch((function(){t.dispatch(s.onErrorShowDialogActionCreator(l.IErrorDialogType.ForecastConfigFetchingFailed))}))}))},e.prototype.FetchPredictionStatus=function(e){return e.forEach((function(e){e.isPredictive=o.getPredictionStatusFromConfig(e.columns)})),e},e.prototype.FetchPredictionLastRunDate=function(e){var t=this;e.forEach((function(e){if(!0===e.isPredictive){var n={},r=e.id;t.dataAccess.fetchPredictionStatusForFC(e.id).then((function(e){n.lastRunDate=e.PredictionOn.split("T")[0],void 0!==n.lastRunDate&&""!==n.lastRunDate||(n.lastRunDate="--"),t.dispatch(i.updateForecastConfigDisplayInfo(r,n))})).catch((function(){n.lastRunDate="--",t.dispatch(i.updateForecastConfigDisplayInfo(r,n))}))}}))},e.prototype.DeleteForecastConfig=function(e){this.dispatch(a.onRowSelectedActionCreator(e)),this.dispatch(a.onGridAppDialogDeleteStateActionCreator(!1))},e.prototype.DeactivateForecastConfig=function(e){this.dispatch(a.onRowSelectedActionCreator(e)),this.dispatch(a.onGridAppDialogArchiveStateActionCreator(!1))},e.prototype.PublishForecastConfig=function(e){this.dispatch(a.onRowSelectedActionCreator(e)),this.dispatch(a.onGridAppDialogPublishStateActionCreator(!1))},e.prototype.CreateSnapshotOfForecastConfig=function(e){this.dispatch(a.onRowSelectedActionCreator(e)),this.dispatch(a.onGridAppDialogCreateSnapshotStateActionCreator(!1))},e}();t.GridEventsHandler=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(176),i=n(176),o=n(16),a=function(){function e(e,t){this.dispatch=e,this.dataAccess=t}return e.prototype.HideNotifications=function(){this.dispatch(r.dismissFDNotification(!0))},e.prototype.ValidateAndTriggerFDFetch=function(e){var t=this,n=0;null!=e&&void 0!==e&&(n=e.filter((function(e){return e.status==o.IForecastConfigStatus.Published})).length),0==n&&this.dataAccess.getPublishedForecastDefinitionCount().then((function(e){t.dispatch(i.updateFDPresent(e>0))}),(function(){}))},e}();t.FDNotificationEventHandler=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(248),l=n(1232);n(1236);var c=n(1238),u=n(15),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){var e=new s.DelfiGridProvider,t=e.getDelfiActions(),n=l.convertForecastConfigInfoToDelfiData(this.props.forecastConfigs,this.props.entityMetadataList,this.props.isPredictivePage),r=this.getForecastConfigLinkClickConfig();return t.updateGridInput(n),t.updateLinkConfig(r),this.props.isPredictivePage||t.updateContextMenuConfig(c.getForecastConfigContextMenuHandlers(this.props.gridEventsHandler,this.props.navigationHandlers,this.props.forecastConfigs,this.props.shouldShowCreateSnapshotButton),c.getForecastConfigContextMenuOptions()),a.default.createElement("div",{className:"configGrid"},e.render())},t.prototype.getForecastConfigLinkClickConfig=function(){var e=this;return{onClick:function(t){u.logUsage("FCGrid.TitleLink","",{fcId:t},"Click"),e.props.navigationHandlers.OpenEditPage(t)}}},t}(a.default.Component);t.ForecastConfigGrid=d,t.default=d},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(366),l=n(86),c=n(176),u=n(23),d=n(7),p=n(8),_=n(15),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){return a.createElement("div",null,a.createElement(s.Pivot,{selectedKey:this.props.activeOptionKey.toString(),onLinkClick:this.onLinkClick.bind(this)},a.createElement(s.PivotItem,{headerText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_SELECTOR_ALL_GRIDPAGE),id:l.IForecastConfigFilterOptions.All.toString()}),a.createElement(s.PivotItem,{headerText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_SELECTOR_PUBLISHED_GRIDPAGE),id:l.IForecastConfigFilterOptions.Published.toString()}),a.createElement(s.PivotItem,{headerText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_SELECTOR_DRAFTS_GRIDPAGE),id:l.IForecastConfigFilterOptions.Drafts.toString()}),a.createElement(s.PivotItem,{headerText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_SELECTOR_ARCHIVED_GRIDPAGE),id:l.IForecastConfigFilterOptions.Archived.toString()})))},t.prototype.onLinkClick=function(e){e&&e.props&&e.props.id&&(_.logUsage("FCGrid.FilterSelector","",{filterID:e.props.id},"Click","onLinkClick"),this.props.onSelectorChangeEvent&&this.props.onSelectorChangeEvent(this.getForecastConfigFilterOption(e.props.id)))},t.prototype.getForecastConfigFilterOption=function(e){switch(e){case"0":return l.IForecastConfigFilterOptions.All;case"1":return l.IForecastConfigFilterOptions.Published;case"2":return l.IForecastConfigFilterOptions.Drafts;case"3":return l.IForecastConfigFilterOptions.Archived;default:return l.IForecastConfigFilterOptions.All}},t}(a.Component);t.GridFilterSelector=E,t.default=E,t.ConnectedGridFilterSelector=u.connect((function(e){return{activeOptionKey:e.gridFilterOption}}),(function(e){return{onSelectorChangeEvent:function(t){return e(c.onGridSelectorChangeActionCreator(t))}}}))(E)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0));n(1256);var o=n(1258);t.default=function(e){var t=e.titleLabel,n=e.descLabel,r=e.learnMoreLabel,a=e.learnMoreLink;return i.default.createElement("div",{className:"noFcMsgContainer"},o.CrystallBallIcon,i.default.createElement("span",{className:"noFcMsgTitle"},t),i.default.createElement("span",{className:"noFcMsgDesc"},n," ",i.default.createElement("a",{href:a,target:"_blank"},r)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(99),i=function(){function e(e){this.dispatch=e}return e.prototype.EnableManualForecastingOrgSettings=function(){this.dispatch(r.enableManualForecastingDialogHiddenStateActionCreator(!1))},e}();t.AdminSettingsEventsHandler=i},,,,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(642)),o=n(643);i.unregister();var a=(new o.DelfiBootManager).boot;t.delfiConfigBoot=a},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function r(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}t.register=function(t){if("serviceWorker"in navigator){if(new URL(e.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var i=e.env.PUBLIC_URL+"/service-worker.js";n?(!function(e,t){fetch(e).then((function(n){var i=n.headers.get("content-type");404===n.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):r(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(i,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):r(i,t)}))}},t.unregister=function(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}}).call(this,n(85))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(390),o=n(862),a=r(n(0)),s=r(n(48)),l=r(n(863)),c=n(119),u=n(7),d=n(15),p=n(506),_=n(302),E=function(){function e(){}return e.prototype.boot=function(e,t,n,r,E,f,C){void 0===n&&(n=""),S(f),-1!=window.location.href.indexOf("isNew")||i.resetStore(),u.GlobalLocalizedStringsProvider.UpdateCCFStringsProvider(r),p.NotificationProvider.Set(E),_.DateFormatterProvider.Set(C);var m=new o.DelfiConfigActions(i.store.dispatch,i.store.getState);return i.store.dispatch(c.UpdateCrmClientUrlAndOrgId(t,n)),s.default.render(a.default.createElement(l.default,null),e),d.logInfo("BootManager","Boot Completed",{}),m},e}();function S(e){d.addLogger(e)}t.DelfiBootManager=E,t.InitLoggers=S},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(252),i=n(646),o=n(649),a=n(650),s=n(651),l=n(652),c=n(392),u=n(653),d=n(654),p=n(655),_=n(656),E=n(392),S=n(657),f=n(658);t.rootReducer=r.combineReducers({gridFilterOption:o.gridAppActionsReducer,FormFieldData:i.formDataReducer,ActiveForecastConfigInfo:a.ActiveFCDataReducer,ForecastConfigList:a.FCListReducer,mainPageType:o.mainPageTypeReducer,crmOrgInfo:s.crmOrgInfoReducer,formUIState:i.formUIStateReducer,columnEditorState:c.columnEditorStateReducer,stepperActiveStage:l.editAppStepperActionsReducer,ForecastHierarchyList:u.HierarchyListReducer,isSavingDialogHidden:l.editAppStepperDialogActionsReducer,quotaUploadStageState:d.quotaUploadReducer,isFetchingHierarchyData:p.HierarchyPreviewReducer,gridAppDialogState:_.configGridDialogStateActionsReducer,editAppDialogState:i.EditAppDialogReducer,PredictiveAvailabilityState:E.PredictiveAvailabilityStateReducer,genericErrorDialogState:S.utilityActionReducer,fdNotificationState:o.fdInformationStateReducer,entityMetadataList:s.entityMetadataReducer,orgSecurityRolesList:f.orgSecurityRolesListReducer,rollupEntityViewList:i.rollupEntityViewListReducer,predictionStatusForFC:i.predictionStatusForFCReducer})},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),o=n(71);t.formDataReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.FormFieldData),t.type){case"@@FormData/UpdateFieldValue":return r({},e,t.payload.data);case"@@FormData/UpdateColumnInfoField":var n=e.columns.map((function(e){var n;return e.id==t.payload.colId?r({},e,((n={})[t.payload.fieldName]=t.payload.value,n)):e}));return r({},e,{columns:n});case"@@FormData/ClearRollupAndCalculatedColumns":n=e.columns.filter((function(e){return e.columnType!=i.ForecastColumnType.Rollup&&e.columnType!=i.ForecastColumnType.Calculated}));return r({},e,{columns:n});case"@@FormData/AddColumn":n=e.columns.concat([t.payload.column]);return r({},e,{columns:n});case"@@FormData/ReplaceColumn":n=e.columns.map((function(e){return e.id==t.payload.id?r({},t.payload.column):e}));return r({},e,{columns:n});case"@@FormData/DeleteColumn":return r({},e,{columns:e.columns.filter((function(e){return e.id!=t.payload.id}))});case"@@FormData/ClearHierarchySecondaryColumns":n=e.columns.filter((function(e){return e.columnType!=i.ForecastColumnType.HierarchySecondary}));return r({},e,{columns:n});case"@@PreviewGrid/ReorderColumnsWithId":var a=e.columns.findIndex((function(e){return e.id==t.payload.dragColId})),s=e.columns.findIndex((function(e){return e.id==t.payload.targetColId})),l=e.columns[a],c=e.columns.slice();return c.splice(a,1),c.splice(s,0,l),r({},e,{columns:c});default:return e}},t.formUIStateReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.formUIState),t.type){case"@@FormUI/UpdateShowWarningsFlag":return r({},e,{showEmptyFieldWarnings:t.payload.showWarnings});default:return e}},t.rollupEntityViewListReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.rollupEntityViewList),t.type){case"@@FormEvents/UpdateView":return r({},e,t.payload.value);default:return e}},t.predictionStatusForFCReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.predictionStatusForFC),t.type){case"@@FormData/UpdateFCPredictionStatus":return r({},e,t.payload.fcPredictionStatus);default:return e}},t.EditAppDialogReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.editAppDialogState),t.type){case"@@EditApp/OnUpdateHierarchyEntityShowDialog":return r({},e,{hierarchyEntitydialogHiddenState:t.payload.hierarchyEntitydialogHiddenState,selectedHierarchyEntityName:t.payload.selectedHierarchyEntityName});default:return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=function(){function e(){var e;this.stringDict=((e={})[r.STRING_KEYS.SI_PACKAGE_NOTINSTALLED]="Please ask your admin to install Sales Insights to activate premium forecasting capabilities.",e[r.STRING_KEYS.SI_LEARN_MORE]="Learn more",e[r.STRING_KEYS.FORECAST_CONFIG_TEMPLATE_HEADING_GRIDPAGE]="Recommended templates",e[r.STRING_KEYS.FORECAST_CONFIG_SUBHEADINGLINK_GRIDPAGE]="Learn more about forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_SUBHEADING_GRIDPAGE]="Seeing whats next can mean smarter choices now. Choose a template below to get started, or configure one from scratch.",e[r.STRING_KEYS.FORECAST_CONFIG_HEADING_GRIDPAGE]="Fast-track your forecast",e[r.STRING_KEYS.FORECAST_CONFIG_CREATE_BUTTON_GRIDPAGE]="Start from scratch",e[r.STRING_KEYS.FC_TERRITORY_TEMPLATE_SUBHEADING_GRIDPAGE]="Structure your orgs data and predictions by sales regions",e[r.STRING_KEYS.FC_TERRITORY_TEMPLATE_HEADING_GRIDPAGE]="Territory forecast",e[r.STRING_KEYS.FC_PRODUCT_TEMPLATE_SUBHEADING_GRIDPAGE]="See rollups and projections based on product and product category hierarchies",e[r.STRING_KEYS.FC_PRODUCT_TEMPLATE_HEADING_GRIDPAGE]="Product-based forecast  (coming soon)",e[r.STRING_KEYS.FC_HIERARCHY_TEMPLATE_SUBHEADING_GRIDPAGE]="See rollups and projections based on your orgs reporting structure",e[r.STRING_KEYS.FC_HIERARCHY_TEMPLATE_HEADING_GRIDPAGE]="Org chart forecast",e[r.STRING_KEYS.FC_CUSTOM_TEMPLATE_HEADING_GRIDPAGE]="Create from Scratch",e[r.STRING_KEYS.FC_CUSTOM_TEMPLATE_SUBHEADING_GRIDPAGE]="Configure a forecast without pre-populated fields.",e[r.STRING_KEYS.FC_MORE_COMMANDS]="More actions",e[r.STRING_KEYS.FC_HIERARCHY_GRID_LABEL]="Hierarchy preview table",e[r.STRING_KEYS.FC_GRID_ARIA_LABEL]="Forecast config table",e[r.STRING_KEYS.FC_GRID_SELECTOR_PUBLISHED_GRIDPAGE]="Active",e[r.STRING_KEYS.FC_GRID_SELECTOR_DRAFTS_GRIDPAGE]="Draft",e[r.STRING_KEYS.FC_GRID_SELECTOR_ARCHIVED_GRIDPAGE]="Inactive",e[r.STRING_KEYS.FC_GRID_SELECTOR_ALL_GRIDPAGE]="All",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_TO_GRIDPAGE]="To",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE]="Status",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_CREATEDON_GRIDPAGE]="Created on",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_ROLLUPENTITY_GRIDPAGE]="Rollup entity",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_HIERARCHYENTITY_GRIDPAGE]="Hierarchy entity",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE]="Period",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE]="Owner",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_FROM_GRIDPAGE]="From",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE]="Forecast name",e[r.STRING_KEYS.FC_EDIT_RIBBON_SAVE_EDITPAGE]="Save",e[r.STRING_KEYS.FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE]="Save & close",e[r.STRING_KEYS.FC_EDIT_RIBBON_DELETE_EDITPAGE]="Delete",e[r.STRING_KEYS.FC_EDIT_RIBBON_CLOSE_EDITPAGE]="Close",e[r.STRING_KEYS.FC_EDIT_STATUS_STATUS_EDITPAGE]="Status",e[r.STRING_KEYS.FC_EDIT_STATUS_TYPE_EDITPAGE]="Type",e[r.STRING_KEYS.FC_EDIT_STATUS_OWNER_EDITPAGE]="Owner",e[r.STRING_KEYS.FC_EDIT_FORECAST_TITLE_EDITPAGE]="Forecast configuration",e[r.STRING_KEYS.FC_EDIT_STEPPER_STAGE1_EDITPAGE]="General",e[r.STRING_KEYS.FC_EDIT_STEPPER_STAGE2_EDITPAGE]="Layout",e[r.STRING_KEYS.FC_EDIT_STEPPER_STAGE3_EDITPAGE]="Activate & add quotas",e[r.STRING_KEYS.FC_EDIT_STEPPER_STAGE4_EDITPAGE]="Permissions",e[r.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_BACK_EDITPAGE]="Back",e[r.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE]="Next",e[r.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_FINISH_EDITPAGE]="Finish",e[r.STRING_KEYS.FC_ROLLUP_ENTITY_STAGE1]="Rollup entity",e[r.STRING_KEYS.FC_HIERARCHY_ENTITY_STAGE1]="This hierarchy is made up of",e[r.STRING_KEYS.FC_TOP_OF_HIERARCHY_STAGE1]="Top user in hierarchy",e[r.STRING_KEYS.FC_TOP_OF_HIERARCHY2_STAGE1]="Top of hierarchy",e[r.STRING_KEYS.FC_FORECAST_PERIOD_STAGE1]="Forecast period",e[r.STRING_KEYS.FC_FISCAL_YEAR_STAGE1]="Fiscal year",e[r.STRING_KEYS.FC_FORECAST_START_AT_STAGE1]="Forecast starts at",e[r.STRING_KEYS.FC_NUMBER_OF_PERIODS_STAGE1]="Number of periods",e[r.STRING_KEYS.FC_VALID_FROM_STAGE1]="Valid from",e[r.STRING_KEYS.FC_VALID_TO_STAGE1]="Valid to",e[r.STRING_KEYS.FC_PREVIEW_HIERARCHY_NO_DATA_STAGE1]="No data to show",e[r.STRING_KEYS.FC_PREVIEW_HIERARCHY_SELECT_ENTITY_STAGE1]="A preview shows here once the top of the hierarchy is assigned.",e[r.STRING_KEYS.FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1]="Creating preview",e[r.STRING_KEYS.FC_PREVIEW_HIERARCHY_COLUMN]="User",e[r.STRING_KEYS.FC_LOADING]="Loading",e[r.STRING_KEYS.FC_ADD_FILTERS_TEXT]="Add filters",e[r.STRING_KEYS.FC_DIALOG_DELETE_TITLE_GRIDPAGE]="Delete forecast?",e[r.STRING_KEYS.FC_DIALOG_CREATE_SNAPSHOT_TITLE_GRIDPAGE]="Snapshot history",e[r.STRING_KEYS.FC_DIALOG_DELETE_DESCRIPTION_GRIDPAGE]="Once you delete a forecast, the forecast configuration and all forecast data will be removed. This cannot be undone.",e[r.STRING_KEYS.FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE]="Delete",e[r.STRING_KEYS.FC_DIALOG_ADD_SNAPSHOT_BUTTON_GRIDPAGE]="Add snapshot",e[r.STRING_KEYS.FC_DIALOG_SNAPSHOT_LIMIT_INFO_TEXT]="A snapshot has already been added for this 24-hour period. You can delete it and add a new snapshot, or wait and add it tomorrow.",e[r.STRING_KEYS.FC_DIALOG_SNAPSHOT_STATUS_EMPTY_TEXT]="You haven't taken any snapshots yet. Please do so and come back here to check its status.",e[r.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE]="Cancel",e[r.STRING_KEYS.FC_DIALOG_PUBLISH_TITLE_GRIDPAGE]="Confirm Activate",e[r.STRING_KEYS.FC_DIALOG_PUBLISH_DESCRIPTION_GRIDPAGE]="Are you sure you want to activate the Forecast Configuration",e[r.STRING_KEYS.FC_DIALOG_PUBLISH_PRIMARYBUTTON_GRIDPAGE]="Activate",e[r.STRING_KEYS.FC_SCHEDULING_SECTION_HEADER_STAGE1]="Scheduling",e[r.STRING_KEYS.FC_SCHEDULING_SECTION_SUBTITLE_STAGE1]="Set the time frame for your forecast.",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_HEADER_STAGE1]="General properties",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_SUBTITLE_STAGE1]="Set your forecast type and rollup hierarchy",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_SUBTITLE2_STAGE1]="Choose your forecast model, select a hierarchy, and define a time span and frequency for calculating results.",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_SUBTITLE3_STAGE1]="Set your forecast type and rollup hierarchy",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_HEADER_STAGE1]="Configuration",e[r.STRING_KEYS.FC_HIERARCHY_ENTITY_SELECTOR_LABEL_STAGE1]="Hierarchy entity",e[r.STRING_KEYS.FC_COLUMN_OPTION_HEADER_STAGE2]="Layout and columns",e[r.STRING_KEYS.FC_COLUMN_OPTION_SUBHEADER_STAGE2]="Add and remove columns for your chosen template, and change order using drag-and-drop.",e[r.STRING_KEYS.FC_PUBLISH_HEADING]="Activate forecast",e[r.STRING_KEYS.FC_PUBLISH_TEXT]="Activates forecast and begins auto-calculations. Forecast will be available to all users with access.",e[r.STRING_KEYS.FC_PUBLISH_SUCCESS]="Forecast successfully activated",e[r.STRING_KEYS.FC_PUBLISH_ARCHIVED]="This forecast has been deactivated and cant be reactivated.",e[r.STRING_KEYS.FC_PUBLISH_INPROGRESS]="Activating...",e[r.STRING_KEYS.FC_PUBLISH_FAILED]="Activate failed. Try again later.",e[r.STRING_KEYS.FC_QUOTA_HEADING]="Upload quota and other static data for this forecast",e[r.STRING_KEYS.FC_QUOTA_TEXT_LINE1]="Quotas and simple data can be upload any time after the configuration is activated using the template below.",e[r.STRING_KEYS.FC_QUOTA_TEXT_LINE2]="If a quota column was selected in the view step, but a quota file wasnt uploaded it will not show in the forecast grid view.",e[r.STRING_KEYS.FC_QUOTA_DOWNLOAD_TEXT]="Download simple data column template",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_FILE]="Browse and upload a file",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_LINE1]="Click to upload new simple data",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_LINE2]="Or drag & drop the template here",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_DRAG]="Drop your file here",e[r.STRING_KEYS.FC_QUOTA_UPLOADING]="Uploading",e[r.STRING_KEYS.FC_QUOTA_PROCESSING]="Processing",e[r.STRING_KEYS.FC_QUOTA_STEP1]="step 1/2",e[r.STRING_KEYS.FC_QUOTA_STEP2]="step 2/2",e[r.STRING_KEYS.FC_QUOTA_SUCCESS]="{0}, {1} processing succeeded",e[r.STRING_KEYS.FC_QUOTA_DOWNLOAD_FAILED]="Template download failed. Please try again later",e[r.STRING_KEYS.FC_QUOTA_FAILED]="{0}, {1} processing failed ({2})",e[r.STRING_KEYS.FC_QUOTA_FAILED_UNKNOWN]="Unknown error occurred",e[r.STRING_KEYS.FC_QUOTA_FAILED_GUID_TAMPERED]="Mandatory guids have been tampered",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_ROWS]="Rows contain invalid data",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_CONTENT]="File contains invalid content",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_FILE]="Only excel files are allowed",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_SIZE]="File size should be less than {0}",e[r.STRING_KEYS.FC_COLUMN_EDITOR_IMPROPER_UNIQUE_NAME_MESSAGE]="The name must start with a letter. From there, use numbers, letters, or underscores. No spaces or special characters.",e[r.STRING_KEYS.FC_ERROR_DELETE_COLUMN_HEADER]="Cannot delete dependent column.",e[r.STRING_KEYS.FC_ERROR_DELETE_COLUMN_DEPENDENTLIST]="This column is being used by : {0}",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_FORECASTCONFIGURATION]="Excel contains invalid forecast configuration",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_FAILED]="Upload Failed.Please try again later",e[r.STRING_KEYS.FC_QUOTA_FAILED_FETCH_FAILED]="Last quota upload fetch failed. Please try again later",e[r.STRING_KEYS.FC_COLUMN_OPTION_HEADER_STAGE2]="Column Options",e[r.STRING_KEYS.FC_COLUMN_OPTION_SUBHEADER_STAGE2]="Add or remove columns. To change the column order, drag and drop a field",e[r.STRING_KEYS.FC_OPTIONSET_PANEL_RIBBON_CHOOSE_SELECTED]="Choose selected",e[r.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_TITLE]="Overwrite current grid layout?",e[r.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_DESCRIPTION]="This replaces your current column configuration with that of the new template.",e[r.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_PRIMARY_BUTTON]="Replace",e[r.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_TITLE]="Auto-configure columns",e[r.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_DESCRIPTION]="Automatically populate forecast columns with standard configurationsor Cancel to manually configure each one.",e[r.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_PRIMARY_BUTTON]="Auto-configure",e[r.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_NO_BUTTON]="Cancel",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_ROLLUP]="Rollup",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_CALCULATED]="Calculated",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_SIMPLE]="Simple",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA]="Quota",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_OWNER]="User",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY]="Hierarchy pivot",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY]="Hierarchy related",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_PREDICTIVE]="Prediction",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_DATATYPE_CURRENCY]="Currency",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_DATATYPE_DECIMAL]="Decimal",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_DATATYPE_TEXT]="Single line of text",e[r.STRING_KEYS.FC_COLUMN_EDITOR_INFORMATION_ICON_LABEL]="Info",e[r.STRING_KEYS.FC_COLUMN_EDITOR_NAME_SECTION]="Name",e[r.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SECTION]="Calculation",e[r.STRING_KEYS.FC_COLUMN_EDITOR_TYPE_SECTION]="Type",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DATATYPE_SECTION]="Data type",e[r.STRING_KEYS.FC_COLUMN_EDITOR_AMOUNT_FIELD_SECTION]="Amount field",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DATE_FIELD_SECTION]="Date field",e[r.STRING_KEYS.FC_COLUMN_EDITOR_SELECTOR_SECTION]="Selector",e[r.STRING_KEYS.FC_COLUMN_EDITOR_ATTRIBUTE_HELPER]="Select an attribute",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DESCRIPTION_HELPER]="This description will show when a user hovers over the forecast column header",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DESCRIPTION_FIELD_SECTION]="Description",e[r.STRING_KEYS.FC_COLUMN_EDITOR_ATTRIBUTE_FIELD_SELECTION]="Attribute field",e[r.STRING_KEYS.FC_COLUMN_EDITOR_ALLOW_ADJUSTMENTS_SECTION]="Allow adjustments",e[r.STRING_KEYS.FC_COLUMN_EDITOR_SHOW_IN_TREND_CHART_SECTION]="Show column in charts",e[r.STRING_KEYS.FC_COLUMN_EDITOR_SHOW_PROGRESS_SECTION]="Show progress compared to quota",e[r.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_SECTION]="Unique name",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE]="Unique name already exists.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_NAME_PLACEHOLDER]="Name this forecast column",e[r.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_PLACEHOLDER]="Enter Value",e[r.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER]="Name",e[r.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER_SECONDARY]="Unique Name",e[r.STRING_KEYS.FC_COLUMN_ASSOCIATED_WITH_UNIQUENAME]="{0} is associated with {1}",e[r.STRING_KEYS.FC_COLUMN_CALCULATED_SUGGESTION_AVAILABLE]="Suggestions available, press up or down arrow to choose",e[r.STRING_KEYS.FC_COLUMN_CALCULATED_SUGGESTION_UNAVAILABLE]="Suggestions closed",e[r.STRING_KEYS.FC_COLUMN_EDITOR_TYPE_PLACEHOLDER]="Select a type",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DATATYPE_PLACEHOLDER]="Select a data type",e[r.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER]="Unique Name for this forecast column",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DESCRIPTION_PLACEHOLDER]="Enter a description",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DESCRIPTION_DESCRIPTION]="Max 100 characters",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_FORECASTING]="Predictive forecasting",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION]="Harness the Power of AI to Predict your sales revenue.",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_LINK]="Learn more",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_DELETE_DIALOG_TITLE]="Delete the Column",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_DELETE_DIALOG_DESCRIPTION]="Deleting this column will also delete all its configuration",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE]="Configure",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE]="Delete",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP]="Move up",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN]="Move down",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN]="Add column",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET]="Change option set",e[r.STRING_KEYS.FC_PREVIEW_GRID_HEADING_STAGE2]="Preview",e[r.STRING_KEYS.FC_ADDITIONAL_FILTER_HEADING]="Additional filters",e[r.STRING_KEYS.FC_ADDITIONAL_FILTER_SUB_HEADING]="Apply additional filters to the forecast",e[r.STRING_KEYS.FC_OPTIONSET_PANEL_HEADER]="Select an option set from the list",e[r.STRING_KEYS.FC_OPTIONSET_PANEL_OPTION_SUBHEADER]="Columns",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_FROM_OPTION_SET]="Add from option set",e[r.STRING_KEYS.FC_COLUMN_SELECTOR_ROW_TOOLTIP_STATUS]="Required fields have not been filled",e[r.STRING_KEYS.FC_COLUMN_SELECTOR_ROW_TOOLTIP_LOCK]="The organization does not have active AI for Sales license",e[r.STRING_KEYS.FC_COLUMN_SELECTOR_QUOTA_ROW_TOOLTIP]="Be sure to upload quota data",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DATEFIELD_HELPER]="Select a date field for the selected record type (ex: actual close date for opportunity records). Any record falling between the selected start date and the end date will be included.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_OPTIONSET_HELPER]="Select the option set attribute of rollup entity which would be used to populate forecast categories.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_SELECTORFIELD_HELPER]="Select the option set value which this column represents.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_TYPEFIELD_HELPER]="Enter the column type.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DATATYPEFIELD_HELPER]="Select the data type of the column.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_AMOUNTFIELD_HELPER]="Enter the name of the field data rolls up from.",e[r.STRING_KEYS.FC_CRM_DELETING_CALLS]="Deleting",e[r.STRING_KEYS.FC_CRM_PUBLISHING_CALLS]="Activating",e[r.STRING_KEYS.FC_CRM_SAVING_CALLS]="Saving",e[r.STRING_KEYS.FC_CRM_PROCESSING_CALLS]="Processing",e[r.STRING_KEYS.FC_GRID_PUBLISH_CONTEXTUALBUTTON_GRIDPAGE]="Activate",e[r.STRING_KEYS.FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE]="Edit",e[r.STRING_KEYS.FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE]="Delete",e[r.STRING_KEYS.FC_GRID_CREATE_SNAPSHOT_CONTEXTUALBUTTON_GRIDPAGE]="Add/view snapshots",e[r.STRING_KEYS.FC_EDIT_FIELD_MANDATORY_MESSAGE]="Field cannot be empty",e[r.STRING_KEYS.FC_STAGE1_ROLLUP_ENTITY_HELPTEXT]="Rollup entity is set by your template choice. To change it, use a different template.",e[r.STRING_KEYS.FC_STAGE1_HIERARCHY_ENTITY_HELPTEXT]="Hierarchy type is set by your template choice. To change it, use a different template.",e[r.STRING_KEYS.FD_NOTIFICATION_MESSAGE]="Please use forecast configuration to configure your forecasts instead of forecast definition.",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_PUBLISH_FAILURE]="Failure has occurred, while activating Forecast configuration. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_DELETE_FAILURE]="Failure has occurred, while deleting Forecast configuration. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_UPDATE_FAILURE]="Failure has occurred, while updating Forecast configuration. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_RETREIVE_HIERARCHY_FAILURE]="Failure has occurred, while retrieving hierarchy data. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_RETREIVE_METADATA_FAILURE]="Failure has occurred, while retrieving metadata. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_RETREIVE_ORGANIZATION_INFO_FAILURE]="Failure has occured, while retrieving organization information. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FC_GRID_DEACTIVATE_CONTEXTUALBUTTON_GRIDPAGE]="Deactivate",e[r.STRING_KEYS.FC_WARNING_FD_REMOVED_FC_ADDED]="Warning: Forecast definitions have been removed and replaced by Forecast configurations.",e[r.STRING_KEYS.FC_WARNING_READ_MORE]="Please read more.",e[r.STRING_KEYS.FC_DELETE_FAILURE_TITLE]="Forecast couldn't be deleted",e[r.STRING_KEYS.FC_PUBLISH_FAILED_MORE_THAN_SIX]="Maximum limit of 6 active forecast configurations reached. Please remove or deactivate any existing forecast configuration to continue.",e[r.STRING_KEYS.FC_PUBLISH_FAILED_MAXCOUNT]="Maximum limit of {0} active forecast configurations reached. Please remove or deactivate any existing forecast configuration to continue.",e[r.STRING_KEYS.FC_PUBLISH_FAILURE_TITLE]="Forecast wasn't activated",e[r.STRING_KEYS.FC_CREATE_FAILURE_TITLE]="Forecast couldn't be created",e[r.STRING_KEYS.FC_UPDATE_FAILURE_TITLE]="Problem updating forecast",e[r.STRING_KEYS.FC_FETCHING_ORG_FAILURE_TITLE]="Problem loading org info",e[r.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE]="Something went wrong",e[r.STRING_KEYS.FC_FETCHING_FAILURE_TITLE]="Problem loading forecast",e[r.STRING_KEYS.FC_ERROR_TRY_AGAIN_DESC]="Try again, or contact Dynamics Sales Forecasting if the problem persists.",e[r.STRING_KEYS.FC_HIERARCHY_FAILURE_DESC]="Hierarchy data didn't come through. Try again, or contact Dynamics Sales Forecasting if the problem persists.",e[r.STRING_KEYS.FC_ORG_DETAILS_DESC]="Some metadata didn't load. Try again, or contact Dynamics Sales Forecasting if the problem persists.",e[r.STRING_KEYS.FC_FETCHING_FAILURE_DESC]="Forecast data didn't come through. Try again, or contact Dynamics Sales Forecasting if the problem persists.",e[r.STRING_KEYS.FC_OK]="OK",e[r.STRING_KEYS.FC_TEMPLATE_TYPE_ORG_CHART]="Org Chart",e[r.STRING_KEYS.FC_Title]="forecast configuration title",e[r.STRING_KEYS.FC_Date]="Select a date..",e[r.STRING_KEYS.FC_Number]="Select a number",e[r.STRING_KEYS.FC_Increase]="Increase value by 1",e[r.STRING_KEYS.FC_Decrease]="Decrease value by 1",e[r.STRING_KEYS.FC_TEMPLATE_TYPE_TERRITORY_BASED]="Territory forecast",e[r.STRING_KEYS.FC_TEMPLATE_TYPE_CREATE_FROM_SCRATCH]="Custom",e[r.STRING_KEYS.FC_TERRITORY_ENTITY_DISPLAYNAME]="Territory",e[r.STRING_KEYS.FC_TOP_OF_HIERARCHY_WITH_PLACEHOLDER_STAGE1]="Top {0} in hierarchy",e[r.STRING_KEYS.FC_FORM_LOAD_ERROR_INVALID_TEMPLATE_TYPE]="Invalid template type received for forecast configuration create page.",e[r.STRING_KEYS.FC_FORM_LOAD_ERROR_MISSING_TEMPLATE_TYPE]="Template type is required for forecast configuration create page.",e[r.STRING_KEYS.FC_FORM_LOAD_ERROR_MISSING_FCID]="Forecast configuration id is required for edit page.",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_TWO_LEVELS]="{0} > {1} > {2}",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_THREE_LEVELS]="{0} > {1} > {2} > {3}",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_FIELD_LABEL]="Rollup to hierarchy relationship",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_FIELD_PLACEHOLDER]="Select hierarchy route",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_NOOPTION_MESSAGE]="There is no direct relationship between rollup and hierarchy entity. Choose attribute from Related entities.",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_NOOPTION_BOTH_MESSAGE]="There is no relationship between the rollup and hierarchy entity. Reselect the hierarchy entity.",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_FILTER_NOOPTION_MESSAGE]="There are no  attributes to display.",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_HEADER_MESSAGE]="Define the relationship between the rollup entity and hierarchy entity. Only entities with a hierarchical relationship are displayed.",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_GROUP_RELATED_TOOLTIP]="This will show related attributes",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_GROUP_SEARCH]="Search",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_GROUP_RELATED]="Related",e[r.STRING_KEYS.FC_PERMISSIONS_ATTRIBUTE_NONE]="None",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_TITLE]="User security field",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_SUBTITLE]="Select the lookup field of type SystemUser on the hierarchy entity that identifies who the owner of the forecast is at each level of the hierarchy.",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL]="Hierarchy entity",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ATTRIBUTE_FIELD_LABEL]="User lookup field",e[r.STRING_KEYS.FC_HIERARCHY_REL_NOT_PRESENT_MESSAGE]="Hierarchy relationship is not enabled for {0} entity. Please contact your system administrator.",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PICKER_ITEM_REMOVE_BUTTON_TOOLTIP]="Remove role",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_ONLY]="Security field users can see the data that belongs directly to them or their descendants and can make adjustments. ",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_ROLE_ONLY]="Only users with the right security role can see all data, but no one can make adjustments.",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_ALLOW_ALL_ONLY]="All users are able to see the full forecast, but no one can make adjustments.",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_AND_ROLE]="Users with the right security role can see all data; only security field users can make adjustments to their own forecast and their descendants.",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_AND_ALLOW_ALL]="All users are able to see the full forecast; only security field users can make adjustments to their own forecast and their descendants.",e[r.STRING_KEYS.FC_PERMISSIONS_MANDATORY_ERROR_MESSAGE]="You must chose a security user field or select a security role to provide access to the forecast data.",e[r.STRING_KEYS.FC_DIALOG_DEACTIVATE_TITLE_GRIDPAGE]="Deactivate forecast?",e[r.STRING_KEYS.FC_DIALOG_DEACTIVATE_DESCRIPTION_GRIDPAGE]="Once you deactivate a forecast, all scheduled recalculations stop and no further changes are made to forecast data.",e[r.STRING_KEYS.FC_DIALOG_DEACTIVATE_PRIMARYBUTTON_GRIDPAGE]="Deactivate",e[r.STRING_KEYS.FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_SECONDARYBUTTON]="Cancel",e[r.STRING_KEYS.FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_TITLE]="Change hierarchy entity",e[r.STRING_KEYS.FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_DESCRIPTION]="Modifying the hierarchy entity will clear hierarchy related configurations in later stages.",e[r.STRING_KEYS.FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_PRIMARYBUTTON]="Okay",e[r.STRING_KEYS.FC_CRM_ARCHIVING_CALLS]="Deactivating",e[r.STRING_KEYS.FC_ROLLUP_ENTITY_VIEWSELECTOR_LABEL]="Default underlying records view",e[r.STRING_KEYS.FC_HIERARCHY_REL_NOT_PRESENT_DIALOG_HEADER]="Configuration error",e[r.STRING_KEYS.SNAPSHOT_STATUS_GRID_NAME_HEADER]="Name",e[r.STRING_KEYS.SNAPSHOT_STATUS_GRID_CREATEDAT_HEADER]="Created at",e[r.STRING_KEYS.SNAPSHOT_STATUS_GRID_CREATEDBYNAME_HEADER]="Created by",e[r.STRING_KEYS.SNAPSHOT_STATUS_GRID_STATUS_HEADER]="Status",e[r.STRING_KEYS.SNAPSHOT_STATUS_GRID_ARIA_LABEL]="Snapshot status grid",e[r.STRING_KEYS.SNAPSHOT_STATUS_GRID_MORE_COMMANDS]="More commands like Delete snapshot",e[r.STRING_KEYS.SNAPSHOT_STATUS_DELETE_SNAPSHOT_CONFIRM]="Delete",e[r.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_CONFIRM]="Create",e[r.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_CANCEL]="Cancel",e[r.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_MESSAGE]="Creating snapshot, this could take a few minutes. You can continue with your work.",e[r.STRING_KEYS.SNAPSHOT_STATUS_DELETE_SNAPSHOT_MESSAGE]="Are you sure you want to delete the snapshot?",e[r.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOt_TITLE]="Create Snapshot",e[r.STRING_KEYS.SNAPSHOT_STATUS_DELETE_SNAPSHOT_TITLE]="Confirm Delete",e[r.STRING_KEYS.EXP_PARSER_ERROR_CIRCULAR_DEPENDENCY]="The formula is invalid. The column reference - {0} results in a circular dependency.",e[r.STRING_KEYS.EXP_PARSER_ERROR_INVALID_CHARACTER]="Invalid character '{0}' at position '{1}'.",e[r.STRING_KEYS.EXP_PARSER_ERROR_INVALID_COLUMNREF]="The formula contains invalid column reference - '{0}' at position '{1}'.",e[r.STRING_KEYS.EXP_PARSER_ERROR_INVALID_COLUMNTYPE]="The column reference - '{0}' at position '{1}' of type '{2}' can't be used in the formula.",e[r.STRING_KEYS.EXP_PARSER_ERROR_INVALID_COLUMN_DATATYPE]="The column reference - '{0}' at position '{1}' of data type '{2}' can't be used in the formula.",e[r.STRING_KEYS.EXP_PARSER_ERROR_MISSING_OPERAND]="The formula is invalid. You are possibly missing an operand.",e[r.STRING_KEYS.EXP_PARSER_ERROR_MISSING_RIGHT_PARANTHESIS]="Missing matching right parenthesis.",e[r.STRING_KEYS.EXP_PARSER_ERROR_SELFREFERENCE]="The formula is invalid. It contains column reference to the current column.",e[r.STRING_KEYS.EXP_PARSER_ERROR_UNEXPECTED_TOKENS]="The formula contains '{0}' at position '{1}', which is unexpected.",e[r.STRING_KEYS.EXP_VALDATION_ERROR_NULL_EMPTY_ARGUMENT]="The argument '{0}' can't be null or empty.",e[r.STRING_KEYS.EXP_VALIDATION_ERROR_NULL_UNDEFINED_ARGUMENT]="The argument '{0}' can't be null or undefined.",e[r.STRING_KEYS.MF_ENABLE_ADMIN_SETTINGS_DIALOG]="An error occurred while enabling forecasting.",e[r.STRING_KEYS.MF_ADMIN_SETTINGS_CONTENT_DESC]="Plan, predict, and adapt with forecasting, the powerful new tool for truly strategic sales. Accessible from the sales hub or opportunity record, forecasting provides custom views for tracking sales against targets.",e[r.STRING_KEYS.MF_ADMIN_SETTINGS_CONTENT_TITLE]="Forecastingsee the future and stay in control",e[r.STRING_KEYS.MF_ADMIN_SETTINGS_ENABLE_BUTTON_TEXT]="Enable forecasting",e[r.STRING_KEYS.MF_ADMIN_SETTINGS_LEARN_MORE_BUTTON_TEXT]="Learn more",e[r.STRING_KEYS.MF_ADMIN_SETTINGS_DIALOG_TITLE]="Enable forecasting?",e[r.STRING_KEYS.MF_ADMIN_SETTINGS_DIALOG_DESC]="Are you sure you want to enable forecasting for your organization?",e[r.STRING_KEYS.MF_ADMIN_SETTINGS_DIALOG_PRIMARYBUTTON]="Enable",e[r.STRING_KEYS.SNAPSHOT_STATUS_IN_PROGRESS]="In progress",e[r.STRING_KEYS.SNAPSHOT_STATUS_FAIL]="Fail",e[r.STRING_KEYS.SNAPSHOT_STATUS_SUCCESS]="Success",e[r.STRING_KEYS.MF_ADMIN_SETTINGS_ENABLE_FAILED_PRIVILEGE_MESSAGE]="You can't perform this action because you don't have privileges to update organization settings.",e[r.STRING_KEYS.NoFcMsgTitle]="Your team hasnt started any forecasts yet",e[r.STRING_KEYS.NoFcMsgDesc]="Still havent tried forecasting? Give it a tryits a powerful way to manage projections and progress in a changing sales landscape.",e[r.STRING_KEYS.NoFcMsgLearnMore]="Learn more",e[r.STRING_KEYS.MF_MAX_HIERARCHY_RECORDS_MESSAGE]="The preview is limited to 5000 items in the hierarchy",e[r.STRING_KEYS.CREATE_SNAPSHOT_PLACEHOLDER]="Enter snapshot name.",e[r.STRING_KEYS.CREATE_SNAPSHOT_FAILED_PRIVILEGE_MESSAGE]="You can't perform this action because you don't have privileges to create snapshots.",e[r.STRING_KEYS.CREATE_SNAPSHOT_GENERIC_ERROR_MESSAGE]="Something went wrong. Please try again later.",e[r.STRING_KEYS.CREATE_SNAPSHOT_FIELD_NAME]="Snapshot name",e[r.STRING_KEYS.INVALID_SNAPSHOT_NAME]="Names cant include '$'.",e[r.STRING_KEYS.PF_LAST_PREDICTED_ON]="Last predicted on",e[r.STRING_KEYS.PF_PREDICTION_FAILED]="Prediction failed with errorcode {0}",e[r.STRING_KEYS.PF_PREDICTION_INFO_TOOLTIP]="This column will predict the total opportunity won value using the actual revenue field.",e[r.STRING_KEYS.PF_PREDICTION_FAILED_INSUFFICIENTDATA_TOOLTIP]="Prediction failed with insufficient data",e[r.STRING_KEYS.PF_PREDICTION_FAILED_INTERNALEXC_TOOLTIP]="Unexpected error occurred. Please contact your system administrator",e[r.STRING_KEYS.PF_PREDICTIONSTATUS_INPROGRESS_TOOLTIP]="Prediction is in progress",e[r.STRING_KEYS.FC_STEP]="Step ",e[r.STRING_KEYS.FORECAST_PREDICTIVE_HEADING_GRIDPAGE]="Forecast Predictions and Snapshots",e[r.STRING_KEYS.FORECAST_PREDICTIONS_GRIDPAGE]="Forecast Predictions: ",e[r.STRING_KEYS.FORECAST_SNAPSHOTS_GRIDPAGE]="Snapshots: ",e[r.STRING_KEYS.FORECAST_PREDICTIVE_DETAILS_GRIDPAGE]="Leverage the power of AI to project how much revenue your sales teams can expect to win, based on historical data and current trends. You can see the eligible forecasts here.",e[r.STRING_KEYS.FORECAST_SNAPSHOTS_DETAILS_GRIDPAGE]="Compare forecasts from different moments to better understand how theyre trending over time and use the Flow visualization to see how deals are moving through your pipeline. Snapshots can be taken directly from the forecast configurations.",e[r.STRING_KEYS.FORECAST_PREDICTIVE_FCLIST_GRIDPAGE]="List of forecasts where Predictive Forecasting can be enabled.",e[r.STRING_KEYS.FORECAST_PREDICTIVE_ENABLE_GRIDPAGE]="To enable or disable the predictions, show/hide the column in Layout stage of the selected forecast configuration.",e[r.STRING_KEYS.FORECAST_PREDICTIVE_MINIMUM_REQ_GRIDPAGE]="The list below only shows the forecasts that meet the minimum requirements needed to run the predictive models.",e[r.STRING_KEYS.FORECAST_PREDICTIVE_VISIBILITY_GRIDPAGE]="Forecasting is a powerful way to drive visibility and accountability in your sales process.",e[r.STRING_KEYS.FORECAST_PREDICTIVE_NOFORECAST_GRIDPAGE]="Your team hasnt started any forecasts yet.",e[r.STRING_KEYS.FORECAST_PREDICTIVE_EMPOWERTEAM_GRIDPAGE]="Empower your team to project sales revenue more accurately with AI powered forecast predictions and interactive snapshot comparisons.",e[r.STRING_KEYS.FORECAST_PREDICTIVE_LINK_FCPREDICTION_GRIDPAGE]="Learn more about the feature and minimum requirements needed.",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_PREDICTION_STATUS_GRIDPAGE]="Prediction Shown",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_FREQUENCY_GRIDPAGE]="Frequency",e[r.STRING_KEYS.FORECAST_PREDICTIVE_LINK_GRIDPAGE]="Learn more.",e[r.STRING_KEYS.FORECAST_PREDICTIVE_STATUS_ON]="On",e[r.STRING_KEYS.FORECAST_PREDICTIVE_STATUS_OFF]="Off",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_PREDICTION_LASTRUNDATE_GRIDPAGE]="Last Run Date",e[r.STRING_KEYS.CREATE_SNAPSHOT_ERROR_FORECAST_NOT_STARTED]="You cannot take a snapshot of a forecast that will start in a future date.",e[r.STRING_KEYS.CREATE_SNAPSHOT_ERROR_FORECAST_ENDED]="You cannot take a snapshot of a forecast that has ended.",e)}return e.prototype.getLocalizedString=function(e){return this.stringDict[e]},e}();t.DefaultLocalizedStringsProvider=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetInitialForecastConfigEditAppDialogState=function(){return{hierarchyEntitydialogHiddenState:!0,selectedHierarchyEntityName:""}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(71);t.gridAppActionsReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.gridFilterOption),t.type){case"@@GridApp/ON_GRID_SELECTOR_CHANGE":return t.payload.selectedvalue;default:return e}return e},t.mainPageTypeReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.mainPageType),t.type){case"@@mainPage/ChangeType":return t.payload.newType;default:return e}return e},t.fdInformationStateReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.fdNotificationState),t.type){case"@@delfiConfig/UpdateFDPresent":return r({},e,{arePublishedFDsPresent:t.payload.fdPresent});case"@@delfiConfig/DismissFDNotification":return r({},e,{isDismissed:t.payload.dismiss});default:return e}return e}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(71);t.ActiveFCDataReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.ActiveForecastConfigInfo),t.type){case"@@ActiveForecastConfig/Update":return r({},t.payload.forecastConfig);default:return e}},t.FCListReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.ForecastConfigList),t.type){case"@@FCList/Update":return t.payload.forecastConfigList.slice();case"@@delfiConfig/UpdateForecastConfigDisplayInfo":return e.map((function(e){return e.id===t.payload.id?r({},e,t.payload.data):e}));default:return e}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(71);t.crmOrgInfoReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.crmOrgInfo),t.type){case"@@CrmOrgInfo/UpdateClientUrlAndOrgId":return r({},e,{clientUrl:t.payload.url,orgId:t.payload.orgId});case"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate":return r({},e,{calenderStartDate:t.payload.fiscalStartDate});case"@@CrmOrgInfo/UpdateManualForecastingEnabledSettings":return r({},e,{isAdminSettingsEnabled:t.payload.isAdminSettingsEnabled});case"@@CrmOrgInfo/UpdateSIPackageStatus":return r({},e,{isSIPackageInstalled:t.payload.isInstalled});case"@@CrmOrgInfo/UpdateSILicenseAvailable":return r({},e,{isSILicenseAvailable:t.payload.isSILicenseAvailable});case"@@CrmOrgInfo/UpdateFeatureState":return r({},e,{featureState:t.payload.featureState});default:return e}return e},t.entityMetadataReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.entityMetadataList),t.type){case"@@Metadata/SetEntityMetadata":return r({},e,t.payload.value)}return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.editAppStepperActionsReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.stepperActiveStage),t.type){case"@@EditApp/ON_STEP_CLICK":return t.payload.activeStage;default:return e}return e},t.editAppStepperDialogActionsReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.isSavingDialogHidden),t.type){case"@@EditApp/ON_UPDATE_DIALOG_STATE":return t.payload.dialogHiddenState;default:return e}return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.HierarchyListReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.ForecastHierarchyList),t.type){case"@@PreviewGrid/AddGridHierarchyData":return t.payload.forecastHierarchyList.slice();case"@@PreviewGrid/ClearGridHierarchyData":return[];default:return e}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(71);t.quotaUploadReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.quotaUploadStageState),t.type){case"@@EditApp/QuotaUploadStatusUpdateAction":return r({},e,{quotaStatusInfo:t.payload.quotaUploadStatus});case"@@EditApp/QuotaUploadFetchUpdateAction":return r({},e,{isFetched:t.payload.isFetched});case"@@EditApp/QuotaUploadDownloadUpdateAction":return r({},e,{downloadStatus:t.payload.downloadStatus});case"@@EditApp/QuotaUploadPublishUpdateAction":return r({},e,{isPublishing:t.payload.isPublishing});default:return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.HierarchyPreviewReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.isFetchingHierarchyData),t.type){case"@@HierarchyPreview/FetchHierarchyStarted":return!0;case"@@HierarchyPreview/FetchHierarchyCompleted":return!1;default:return e}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(71);t.configGridDialogStateActionsReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.gridAppDialogState),t.type){case"@@GridApp/ON_UPDATE_DIALOG_DELETE_STATE":return r({},e,{isGridDeleteDialogHidden:t.payload.gridAppDeletedialogHiddenState});case"@@GridApp/ON_UPDATE_DIALOG_PUBLISH_STATE":return r({},e,{isGridPublishDialogHidden:t.payload.gridAppPublishedialogHiddenState});case"@@GridApp/ON_UPDATE_DIALOG_ARCHIVE_STATE":return r({},e,{isGridArchiveDialogHidden:t.payload.gridAppArchivedialogHiddenState});case"@@GridApp/ON_UPDATE_DIALOG_CREATE_SNAPSHOT_STATE":return r({},e,{isGridCreateSnapshotDialogHidden:t.payload.gridAppCreateSnapshotdialogHiddenState});case"@@GridApp/ROW_SELECTED":return r({},e,{gridActionableRow:t.payload.rowSelected});case"@@GridApp/ON_ENABLE_MANUAL_FORECASTING_DIALOG_STATE":return r({},e,{isEnableManualForecastingDialogHidden:t.payload.dialogHidden});default:return e}return e}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(71);t.utilityActionReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.genericErrorDialogState),t.type){case"@@Utility/OnOkErrorDialogClick":return r({},e,{isDialogHidden:t.payload.isErrorDialogHidden});case"@@Utility/OnErrorShowDialog":return{dialogType:t.payload.errorDialogType,isDialogHidden:t.payload.isErrorDialogHidden,customMessage:t.payload.message};default:return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.orgSecurityRolesListReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.orgSecurityRolesList),t.type){case"@@OrgSecurityRoles/SetSecurityRolesInState":return t.payload.roles}return e}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(660),o=n(43),a=n(661),s=n(65);function l(e,t){var n=r({},e().FormFieldData);return{periodType:d(c("period",t.payload.data,n)),startMonth:parseInt(c("startAtMonth",t.payload.data,n)),startQuarter:parseInt(c("startAtQuater",t.payload.data,n)),numRecurrences:c("numberOfRecurrences",t.payload.data,n),year:i.YEAR_OFFSET+parseInt(c("fiscalyear",t.payload.data,n)),calenderStart:p(e)}}function c(e,t,n){return Object.keys(t).indexOf(e)>0?t[e]:n[e]}function u(e,t,n){var r=function(e){return new i.DefaultScheduleFieldsProvider(new Date,p(e))}(t);n(o.UpdateFieldValue({fiscalyear:(r.GetYear(e==a.ForecastPeriodType.Quarterly)-i.YEAR_OFFSET).toString(),startAtQuater:r.GetStartQuarter().toString(),startAtMonth:r.GetStartMonth().toString()}))}function d(e){return"0"==e?a.ForecastPeriodType.Monthly:a.ForecastPeriodType.Quarterly}function p(e){return e().crmOrgInfo.calenderStartDate}t.scheduleCalculationMiddleware=function(e){var t=e.getState,n=e.dispatch;return function(e){return function(r){if("@@mainPage/ChangeType"==r.type||"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate"==r.type){var i=e(r);return s.GetIsFormInCreateMode_FromState(t())&&""!==p(t)&&function(e){var t=e().FormFieldData;return["numberOfRecurrences","startAtMonth","startAtQuater","period","fiscalyear"].some((function(e){return void 0===t[e]||""===t[e]}))}(t)&&u(a.ForecastPeriodType.Quarterly,t,n),i}if("@@FormData/UpdateFieldValue"==r.type){if(function(e,t){var n=e().FormFieldData.period;return void 0!==t.payload.data.period&&null!==t.payload.data.period&&1==Object.keys(t.payload.data).length&&n!==t.payload.data.period}(t,r)){!function(e){e.payload.data.fiscalyear=void 0,e.payload.data.startAtMonth=void 0,e.payload.data.startAtQuater=void 0,e.payload.data.numberOfRecurrences=1}(r);i=e(r);return u(d(r.payload.data.period),t,n),i}if(function(e){var t=["numberOfRecurrences","startAtMonth","startAtQuater","period","fiscalyear"];return Object.keys(e.payload.data).every((function(e){return t.indexOf(e)>-1}))}(r))return function(e,t,n){var r=e(t);return function(e,t){var n=new a.ScheduleCalculator(e),r={fromDate:n.startDate().toDateString(),toDate:n.endDate().toDateString()};t(o.UpdateFieldValue(r))}(l(n,t),e),r}(e,r,t)}return e(r)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.YEAR_OFFSET=2018;var r=function(){function e(e,t){this.curDate=e,this.calStart=new Date(t)}return e.prototype.GetYear=function(e){void 0===e&&(e=!0);var t=new Date(this.calStart);return t.setFullYear(this.curDate.getFullYear()),e&&this.curDate<t?this.curDate.getFullYear()-1:this.curDate.getFullYear()},e.prototype.GetStartQuarter=function(){var e=new Date(this.calStart);e.setFullYear(this.curDate.getFullYear()),this.curDate<e&&e.setFullYear(this.curDate.getFullYear()-1);for(var t=0;this.curDate>e;)e.setMonth(e.getMonth()+3),t++;return(t-1)%4},e.prototype.GetStartMonth=function(){return this.curDate.getMonth()},e}();t.DefaultScheduleFieldsProvider=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.input=e}return e.prototype.startDate=function(){if(this.input.periodType==i.Quarterly)return new o(this.input).startDate();var e=new Date(this.input.calenderStart?this.input.calenderStart:"");return e.setFullYear(this.input.year),e.setMonth(this.input.startMonth),e.setDate(e.getDate()),e},e.prototype.endDate=function(){if(this.input.periodType==i.Quarterly)return new o(this.input).endDate();var e=new Date(this.input.calenderStart?this.input.calenderStart:"");return e.setFullYear(this.input.year),e.setMonth(this.input.startMonth+this.input.numRecurrences),e.setDate(e.getDate()-1),e},e}();t.ScheduleCalculator=r;var i,o=function(){function e(e){this.input=e}return e.prototype.startDate=function(){if(!this.input.calenderStart)throw new Error("Please provide calenderStart");var e=new Date(this.input.calenderStart);return e.setFullYear(this.input.year),e.setMonth(e.getMonth()+3*this.input.startQuarter),e.setDate(e.getDate()),e},e.prototype.endDate=function(){if(!this.input.calenderStart)throw new Error("Please provide calenderStart");var e=new Date(this.input.calenderStart);return e.setFullYear(this.input.year),e.setMonth(e.getMonth()+3*(this.input.startQuarter+this.input.numRecurrences)),e.setDate(e.getDate()-1),e},e}();!function(e){e[e.Quarterly=0]="Quarterly",e[e.Monthly=1]="Monthly"}(i=t.ForecastPeriodType||(t.ForecastPeriodType={}))},,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllLabelsMap={contains:{local:"Contains",resourceIdentifier:"Web._tools.search.search.js_12_2"},doesNotContain:{local:"Does not contain",resourceIdentifier:"Web._tools.search.search.js_12_3_SentenceCase"},beginsWith:{local:"Begins with",resourceIdentifier:"Web._tools.search.search.js_12_4_SentenceCase"},doesNotBeginWith:{local:"Does not begin with",resourceIdentifier:"Web._tools.search.search.js_12_5_SentenceCase"},endsWith:{local:"Ends with",resourceIdentifier:"Web._tools.search.search.js_12_6_SentenceCase"},doesNotEndWith:{local:"Does not end with",resourceIdentifier:"Web._tools.search.search.js_12_7_SentenceCase"},containsData:{local:"Contains data",resourceIdentifier:"Web._tools.search.search.js_12_8_SentenceCase"},doesNotContainData:{local:"Does not contain data",resourceIdentifier:"Web._tools.search.search.js_12_9_SentenceCase"},equals:{local:"Equals",resourceIdentifier:"Web._tools.search.search.js_12_0"},doesNotEqual:{local:"Does not equal",resourceIdentifier:"Web._tools.search.search.js_12_1_SentenceCase"},greaterThan:{local:"Is greater than",resourceIdentifier:"Web._tools.search.search.js_15_0_SentenceCase"},greaterThanOrEqualTo:{local:"Is greater than or equal to",resourceIdentifier:"Web._tools.search.search.js_15_1_SentenceCase"},lessThan:{local:"Is less than",resourceIdentifier:"Web._tools.search.search.js_15_2_SentenceCase"},lessThanOrEqualTo:{local:"Is less than or equal to",resourceIdentifier:"Web._tools.search.search.js_15_3_SentenceCase"},dateQuarter:{local:"Quarter {0}",resourceIdentifier:"ViewDesigner.RecordFilter.quarter"},dateFiscalYear:{local:"FY{0}",resourceIdentifier:"FiscalYear_Format_String_NoSpace"},on:{local:"On",resourceIdentifier:"Web._tools.search.search.js_16_0"},onOrAfter:{local:"On or after",resourceIdentifier:"Web._tools.search.search.js_16_1_SentenceCase"},onOrBefore:{local:"On or before",resourceIdentifier:"Web._tools.search.search.js_16_2_SentenceCase"},yesterday:{local:"Yesterday",resourceIdentifier:"Web._tools.search.search.js_16_3"},today:{local:"Today",resourceIdentifier:"Web._tools.search.search.js_16_4"},tomorrow:{local:"Tomorrow",resourceIdentifier:"Web._tools.search.search.js_16_5"},nextSevenDays:{local:"Next 7 days",resourceIdentifier:"Web._tools.search.search.js_16_6_SentenceCase"},lastSevenDays:{local:"Last 7 days",resourceIdentifier:"Web._tools.search.search.js_16_7_SentenceCase"},nextWeek:{local:"Next week",resourceIdentifier:"Web._tools.search.search.js_16_8_SentenceCase"},lastWeek:{local:"Last week",resourceIdentifier:"Web._tools.search.search.js_16_9_SentenceCase"},thisWeek:{local:"This week",resourceIdentifier:"Web._tools.search.search.js_16_10_SentenceCase"},nextMonth:{local:"Next month",resourceIdentifier:"Web._tools.search.search.js_16_11_SentenceCase"},lastMonth:{local:"Last month",resourceIdentifier:"Web._tools.search.search.js_16_12_SentenceCase"},thisMonth:{local:"This month",resourceIdentifier:"Web._tools.search.search.js_16_13_SentenceCase"},nextYear:{local:"Next year",resourceIdentifier:"Web._tools.search.search.js_16_14_SentenceCase"},lastYear:{local:"Last year",resourceIdentifier:"Web._tools.search.search.js_16_15_SentenceCase"},thisYear:{local:"This year",resourceIdentifier:"Web._tools.search.search.js_16_16_SentenceCase"},lastXHours:{local:"Last x hours",resourceIdentifier:"AF_Option_LastXHours_SentenceCase"},nextXHours:{local:"Next x hours",resourceIdentifier:"AF_Option_NextXHours_SentenceCase"},lastXDays:{local:"Last x days",resourceIdentifier:"AF_Option_LastXDays_SentenceCase"},nextXDays:{local:"Next x days",resourceIdentifier:"AF_Option_NextXDays_SentenceCase"},lastXWeeks:{local:"Last x weeks",resourceIdentifier:"AF_Option_LastXWeeks_SentenceCase"},nextXWeeks:{local:"Next x weeks",resourceIdentifier:"AF_Option_NextXWeeks_SentenceCase"},lastXMonths:{local:"Last x months",resourceIdentifier:"AF_Option_LastXMonths_SentenceCase"},nextXMonths:{local:"Next x months",resourceIdentifier:"AF_Option_NextXMonths_SentenceCase"},lastXYears:{local:"Last x years",resourceIdentifier:"AF_Option_LastXYears_SentenceCase"},nextXYears:{local:"Next x years",resourceIdentifier:"AF_Option_NextXYears_SentenceCase"},anyTime:{local:"Any time",resourceIdentifier:"Web._tools.search.search.js_16_17_SentenceCase"},olderThanXMinutes:{local:"Older than a minutes",resourceIdentifier:"AF_Option_OlderThanXMinutes_SentenceCase"},olderThanXHours:{local:"Older than x hours",resourceIdentifier:"AF_Option_OlderThanXHours_SentenceCase"},olderThanXDays:{local:"Older than x days",resourceIdentifier:"AF_Option_OlderThanXDays_SentenceCase"},olderThanXWeeks:{local:"Older than x weeks",resourceIdentifier:"AF_Option_OlderThanXWeeks_SentenceCase"},olderThanXMonths:{local:"Older than x months",resourceIdentifier:"AF_Option_OlderThanXMonths_SentenceCase"},olderThanXYears:{local:"Older than x years",resourceIdentifier:"AF_Option_OlderThanXYears_SentenceCase"},inFiscalYear:{local:"In fiscal year",resourceIdentifier:"AF_Option_InFiscalYear_SentenceCase"},lastFiscalYear:{local:"Last fiscal year",resourceIdentifier:"AF_Option_LastFiscalYear_SentenceCase"},thisFiscalYear:{local:"This fiscal year",resourceIdentifier:"AF_Option_ThisFiscalYear_SentenceCase"},nextFiscalYear:{local:"Next fiscal year",resourceIdentifier:"AF_Option_NextFiscalYear_SentenceCase"},lastXFiscalYears:{local:"Last x fiscal years",resourceIdentifier:"AF_Option_LastXFiscalYears_SentenceCase"},nextXFiscalYears:{local:"Next x fiscal years",resourceIdentifier:"AF_Option_NextXFiscalYears_SentenceCase"},inFiscalPeriod:{local:"In fiscal period",resourceIdentifier:"AF_Option_InFiscalPeriod_SentenceCase"},lastFiscalPeriod:{local:"Last fiscal period",resourceIdentifier:"AF_Option_LastFiscalPeriod_SentenceCase"},thisFiscalPeriod:{local:"This fiscal period",resourceIdentifier:"AF_Option_ThisFiscalPeriod_SentenceCase"},nextFiscalPeriod:{local:"Next fiscal period",resourceIdentifier:"AF_Option_NextFiscalPeriod_SentenceCase"},lastXFiscalPeriods:{local:"Last x fiscal periods",resourceIdentifier:"AF_Option_LastXFiscalPeriods_SentenceCase"},nextXFiscalPeriods:{local:"Next x fiscal periods",resourceIdentifier:"AF_Option_NextXFiscalPeriods_SentenceCase"},inFiscalPeriodAndYear:{local:"In fiscal period and year",resourceIdentifier:"AF_Option_InFiscalPeriodAndYear_SentenceCase"},inOrAfterFiscalPeriodAndYear:{local:"In or after fiscal period",resourceIdentifier:"AF_Option_InOrAfterFiscalPeriod_SentenceCase"},inOrBeforeFiscalPeriodAndYear:{local:"In or before fiscal period",resourceIdentifier:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase"},containValues:{local:"Contain values",resourceIdentifier:"Web._tools.search.search.js_17_4_SentenceCase"},doesNotContainValues:{local:"Does not contain values",resourceIdentifier:"Web._tools.search.search.js_17_5_SentenceCase"},equalsCurrentUserLanguage:{local:"Equals current user language",resourceIdentifier:"AF_Option_EqUserLanguage_SentenceCase"},isCurrentUser:{local:"Equals current user",resourceIdentifier:"Web._tools.search.search.js_17_0_SentenceCase"},notCurrentUser:{local:"Does not equal current user",resourceIdentifier:"Web._tools.search.search.js_17_1_SentenceCase"},isCurrentBusinessUnit:{local:"Equals current business unit",resourceIdentifier:"Web._tools.search.search.js_19_1_SentenceCase"},notCurrentBusinessUnit:{local:"Does not equal current business unit",resourceIdentifier:"Web._tools.search.search.js_19_2_SentenceCase"},under:{local:"Under",resourceIdentifier:"Web._tools.search.search.js_12_18"},notUnder:{local:"Not under",resourceIdentifier:"Web._tools.search.search.js_12_19_SentenceCase"},above:{local:"Above",resourceIdentifier:"ViewDesigner.RecordFilter.above"},aboveOrEqual:{local:"Equals or above",resourceIdentifier:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase"},underOrEqual:{local:"Equals or under",resourceIdentifier:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase"},isCurrentUserOrReportingHierarchy:{local:"Equals current user or his reporting hierarchy",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase"},isCurrentUserAndTeamsOrReportingHierarchyAndTeams:{local:"Equals current user and his teams or his reporting hierarchy and their teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase"},isCurrentUserTeams:{local:"Equals current user's teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase"},isCurrentUserOrTeams:{local:"Equals current user or user's teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase"},addButton:{local:"Add",resourceIdentifier:"Workflow.DynamicExpressions.Add"},addRow:{local:"Add row",resourceIdentifier:"MenuItem_Label_AddRow_SentenceCase"},addGroup:{local:"Add group",resourceIdentifier:"MenuItem_Label_AddGroup_SentenceCase"},addRelatedEntity:{local:"Add related entity",resourceIdentifier:"MenuItem_Label_AddRelatedEntity_SentenceCase"},deleteExpression:{local:"Delete",resourceIdentifier:"Web._controls.listedit.buttons.Delete"},moveUpExpression:{local:"Move up",resourceIdentifier:"Web._controls.listedit.buttons.MoveUp_SentenceCase"},moveDownExpression:{local:"Move down",resourceIdentifier:"Web._controls.listedit.buttons.MoveDown_SentenceCase"},makeGroup:{local:"Group",resourceIdentifier:"CC_Timeline_Group"},ungroup:{local:"Ungroup",resourceIdentifier:"AF_MenuItem_UnGroup"},errorQuickFind:{local:"View belongs to a quick find, expression editing is not available",resourceIdentifier:"AF_Error_QuickFindView"},errorMalformed:{local:"Malformed expression, could not render",resourceIdentifier:"AF_Error_MalformedExpression"},andGroup:{local:"And",resourceIdentifier:"AF_Text_And_SentenceCase"},orGroup:{local:"Or",resourceIdentifier:"AF_Text_Or_SentenceCase"},relatedEntityPlaceholder:{local:"Choose a related entity",resourceIdentifier:"AF_Message_ChooseRelatedEntity"},doesNotContainDataWarning:{local:"Conditions cannot be added under relationships with no related data",resourceIdentifier:"AF_Error_DoesnNotContainData"},inputControlLabel:{local:"Value",resourceIdentifier:"ViewDesigner.ConditionFilter.Value.Label"},fieldSelectorControlLabel:{local:"Field selector",resourceIdentifier:"AF_Aria_FieldSelector"},operatorSelectorControlLabel:{local:"Operator",resourceIdentifier:"SystemCustomization.BusinessRules.Expression.Operator"},fieldPlaceholder:{local:"Select a field",resourceIdentifier:"Audit.Incontext.Filters.AttributesGroup"},durationUnit:{local:"minutes",resourceIdentifier:"CC_Duration_Minutes"},noValue:{local:"Provide a value for the condition",resourceIdentifier:"AF_Message_NoValue"},loadingResults:{local:"Loading..",resourceIdentifier:"RelatedInformation.DataLoading"},noResults:{local:"No results found.",resourceIdentifier:"RelatedInformation.NoResults"},maxLength:{local:"Input text has more characters than the maximum allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxLength"},minValue:{local:"Input value is lower than the minimum value allowed for this field ({0})",resourceIdentifier:"AF_Error_MinValue"},maxValue:{local:"Input value is greater than the maximum value allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxValue"},maxPrecision:{local:"Input value has a greater precision than the maximum allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxPrecision"},errorNoValues:{local:"Provide at least one value for the condition",resourceIdentifier:"AF_Error_NoValues"},viewAll:{local:"View all options",resourceIdentifier:"AF_Message_ViewAllOptions"},incorrectDataType:{local:"Incorrect data type",resourceIdentifier:"AF_Error_IncorrectDataType"},invalidField:{local:"{0} has been removed from the system or is no longer available for filtering",resourceIdentifier:"AF_Error_InvalidField"},moreCommandsAriaLabel:{local:"More commands",resourceIdentifier:"AF_Aria_MoreCommands"},rowSelectorAriaLabel:{local:"Row selector",resourceIdentifier:"AF_Aria_RowSelector"},groupSelectorAriaLabel:{local:"Group selector",resourceIdentifier:"AF_Aria_GroupSelector"},groupExpandAriaLabel:{local:"Expand",resourceIdentifier:"AF_MenuItem_Expand"},groupCollapseAriaLabel:{local:"Collapse",resourceIdentifier:"AF_MenuItem_Collapse"},groupExpandAriaDescription:{local:"Expand this group",resourceIdentifier:"AF_Aria_GroupExpand"},groupCollapseAriaDescription:{local:"Collapse this group",resourceIdentifier:"AF_Aria_GroupCollapse"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(499),i=n(828),o=n(16),a=n(223),s=n(829),l=n(137),c=function(){function e(){this.lexAnalyzer=new r.LexicalAnalyzer,this.syntaxAnalyzer=new i.SyntaxAnalyzer,this.columnReferencesValidator=new s.ColumnReferencesValidator(this.lexAnalyzer)}return e.prototype.parseExpression=function(e,t,n,r){a.Validations.validateNullArgument(e,"expression"),a.Validations.validateNullArgument(t,"config");var i=this.lexAnalyzer.parseExpressionToTokens(e),o=this.syntaxAnalyzer.parseTokensToAST(i);return this.columnReferencesValidator.validateColumnReferences(i,t,n,r),JSON.stringify(o)},e.prototype.getReferencingCalculatedColumns=function(e,t){var n=this;a.Validations.validateNullArgument(e,"forecastConfig"),a.Validations.validateNullArgument(t,"columnId");var r=[],i=e.columns&&e.columns.find((function(e){return e.id===t}));if(i){var o=i.uniqueName,s=this.getAllCalculatedColumns(e);s&&s.forEach((function(e){if(e.calculatedFieldExpression){var t=n.lexAnalyzer.parseExpressionToTokens(e.calculatedFieldExpression);n.doesColumnIdentifierTokenExist(t,o)&&r.push(e)}}))}return r},e.prototype.getAllCalculatedColumns=function(e){return e.columns.filter((function(e){return e.columnType===o.ForecastColumnType.Calculated}))},e.prototype.doesColumnIdentifierTokenExist=function(e,t){return e&&e.some((function(e){return e.tokenType===l.TokenType.Identifier&&e.value===t}))},e}();t.ExpressionParser=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n,r){this.tokenType=e,this.value=t,this.index=n,this.length=r};t.Token=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(137),i=n(223),o=n(324),a=n(224),s=n(7),l=n(8),c=function(){function e(){}return e.prototype.parseTokensToAST=function(e){i.Validations.validateNullArgument(e,"tokens");var t=this.getExpression(e,0),n=t[0],r=t[1];return n<e.length&&this.throwInvalidTokenError(e[n]),{root:r}},e.prototype.getExpression=function(e,t){if(t>=e.length)throw new o.ParseError(s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.EXP_PARSER_ERROR_MISSING_OPERAND));var n="",i=0,a=[r.TokenType.Number,r.TokenType.Identifier,r.TokenType.LeftParenthesis],c=e[t];if(a.includes(c.tokenType)){var u=this.getTerm(e,t),d=u[0],p=u[1],_=this.getExpressionSuffix(e,t+d),E=_[0],S=_[1],f=_[2];i=d+E,n=null!==S&&null!==f?{left:p,operator:S,right:f}:p}else this.throwInvalidTokenError(c);return[i,n]},e.prototype.getTerm=function(e,t){if(t>=e.length)throw new o.ParseError(s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.EXP_PARSER_ERROR_MISSING_OPERAND));var n="",i=0,a=[r.TokenType.Number,r.TokenType.Identifier,r.TokenType.LeftParenthesis],c=e[t];if(a.includes(c.tokenType)){var u=this.getFactor(e,t),d=u[0],p=u[1],_=this.getTermSuffix(e,t+d),E=_[0],S=_[1],f=_[2];i=d+E,n=null!==S&&null!==f?{left:p,operator:S,right:f}:p}else this.throwInvalidTokenError(c);return[i,n]},e.prototype.getExpressionSuffix=function(e,t){var n=0,i=null,o=null;if(t<e.length){var a=e[t];if(a.tokenType===r.TokenType.Plus||a.tokenType===r.TokenType.Minus){n+=1,i=a.value;var s=this.getExpression(e,t+n);n+=s[0],o=s[1]}else a.tokenType!==r.TokenType.Divide&&a.tokenType!==r.TokenType.Multiple&&a.tokenType!==r.TokenType.RightParenthesis&&this.throwInvalidTokenError(a)}return[n,i,o]},e.prototype.getFactor=function(e,t){if(t>=e.length)throw new o.ParseError(s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.EXP_PARSER_ERROR_MISSING_OPERAND));var n="",i=0,a=(r.TokenType.Number,r.TokenType.Identifier,r.TokenType.LeftParenthesis,e[t]);if(a.tokenType===r.TokenType.Number)i=1,n=Number(a.value);else if(a.tokenType===r.TokenType.Identifier)i=1,n=a.value;else if(a.tokenType===r.TokenType.LeftParenthesis){i+=1;var c=this.getExpression(e,t+i),u=c[0];n=c[1];var d=t+(i+=u);if(!(d<e.length&&e[d].tokenType===r.TokenType.RightParenthesis))throw new o.ParseError(s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.EXP_PARSER_ERROR_MISSING_RIGHT_PARANTHESIS));i+=1}else this.throwInvalidTokenError(a);return[i,n]},e.prototype.getTermSuffix=function(e,t){var n=0,i=null,o=null;if(t<e.length){var a=e[t];if(a.tokenType===r.TokenType.Multiple||a.tokenType===r.TokenType.Divide){n+=1,i=a.value;var s=this.getTerm(e,t+n);n+=s[0],o=s[1]}else a.tokenType!==r.TokenType.Plus&&a.tokenType!==r.TokenType.Minus&&a.tokenType!==r.TokenType.RightParenthesis&&this.throwInvalidTokenError(a)}return[n,i,o]},e.prototype.throwInvalidTokenError=function(e){throw new o.ParseError(a.StringFormatter.formatString(s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.EXP_PARSER_ERROR_UNEXPECTED_TOKENS),this.tokenTypeToMsg(e.tokenType),(e.index+1).toString()),e.index)},e.prototype.tokenTypeToMsg=function(e){var t="";return e===r.TokenType.LeftParenthesis?t="(":e===r.TokenType.RightParenthesis?t=")":e===r.TokenType.Plus||e===r.TokenType.Minus||e===r.TokenType.Multiple||e===r.TokenType.Divide?t="operator":e===r.TokenType.Identifier?t="column reference":e===r.TokenType.Number&&(t="number"),t},e}();t.SyntaxAnalyzer=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(137),i=n(16),o=n(224),a=n(324),s=n(500),l=n(7),c=n(8),u=function(){function e(e){this.lexicalAnalyzer=e}return e.prototype.validateColumnReferences=function(e,t,n,u){e.forEach((function(e){if(e.tokenType===r.TokenType.Identifier){var n=e.value,u=void 0;if(t.columns&&t.columns.length>0&&(u=t.columns.find((function(e){return e.uniqueName===n}))),void 0===u)throw new a.ParseError(o.StringFormatter.formatString(l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.EXP_PARSER_ERROR_INVALID_COLUMNREF),n,(e.index+1).toString()),e.index);if(!s.ExpressionParserUtils.isValidColumnType(u.columnType)){var d=u.columnType==i.ForecastColumnType.HierarchyPrimary?c.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY:c.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY;throw new a.ParseError(o.StringFormatter.formatString(l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.EXP_PARSER_ERROR_INVALID_COLUMNTYPE),n,(e.index+1).toString(),u.columnType?l.GlobalLocalizedStringsProvider.GetString(d):""),e.index)}if(!s.ExpressionParserUtils.isValidColumnDataType(u.dataType))throw new a.ParseError(o.StringFormatter.formatString(l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.EXP_PARSER_ERROR_INVALID_COLUMN_DATATYPE),n,(e.index+1).toString(),u.dataType?l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_DATATYPE_TEXT):""),e.index)}})),n=n||"_root",this.detectCircularDependency(e,t,n,u)},e.prototype.detectCircularDependency=function(e,t,n,r){var i=this,s=this.createDependencyGraph(e,t,n,r),u=new Map;u.set(n,!0);var d=s.get(n);d&&d.forEach((function(e){if(e===n)throw new a.ParseError(l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.EXP_PARSER_ERROR_SELFREFERENCE));if(i.detectCycleRecursive(n,e,s,u))throw new a.ParseError(o.StringFormatter.formatString(l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.EXP_PARSER_ERROR_CIRCULAR_DEPENDENCY),e))}))},e.prototype.detectCycleRecursive=function(e,t,n,r){var i=!1;r.set(t,!0);var o=n.get(t);if(o)for(var a=0;a<o.length;a++){var s=o[a];if(s===e||!r.get(s)&&this.detectCycleRecursive(e,s,n,r)){i=!0;break}}return i},e.prototype.createDependencyGraph=function(e,t,n,r){var o=this,a=new Map;return a.set(n,this.findCalculatedColumns(e,t,n)),t&&t.columns&&t.columns.forEach((function(e){if(e&&e.columnType===i.ForecastColumnType.Calculated&&e.calculatedFieldExpression&&(void 0===r||e.id!==r)){var s=o.lexicalAnalyzer.parseExpressionToTokens(e.calculatedFieldExpression);a.set(e.uniqueName,o.findCalculatedColumns(s,t,n))}})),a},e.prototype.findCalculatedColumns=function(e,t,n){var o=[];return e.forEach((function(e){if(e.tokenType===r.TokenType.Identifier){var a=e.value;if(a===n)o.push(n);else{var s=void 0;t.columns&&t.columns.length>0&&(s=t.columns.find((function(e){return e.uniqueName===a}))),s&&s.columnType===i.ForecastColumnType.Calculated&&o.push(s.uniqueName)}}})),o},e}();t.ColumnReferencesValidator=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(499),i=n(223),o=n(831),a=n(137),s=n(500),l=n(41),c=function(){function e(){this.lexAnalyzer=new r.LexicalAnalyzer}return e.prototype.getSuggestions=function(e,t,n,r){i.Validations.validateNullArgument(e,"expression"),i.Validations.validateNullArgument(t,"config"),n<0&&(n=0);var l=this.lexAnalyzer.parseExpressionToTokens(e,!0),c=this.getNearestLeftToken(l,n),u=[];return void 0===c||s.ExpressionParserUtils.isOperator(c.tokenType)||c.tokenType===a.TokenType.LeftParenthesis?u=this.getForecastColumnSuggestions(t,"",r):c.tokenType===a.TokenType.Identifier&&(u=this.getForecastColumnSuggestions(t,c.value,r)),new o.Suggestions(u,c&&c.tokenType===a.TokenType.Identifier?c:void 0)},e.prototype.applySuggestion=function(e,t,n,r){i.Validations.validateNullArgument(e,"expression"),i.Validations.validateNullArgument(t,"columnUniqueName"),n<0&&(n=0);var o=void 0===r?n:r.index,a=void 0===r?0:r.length;return e.substring(0,o)+t+e.substring(o+a)},e.prototype.getNearestLeftToken=function(e,t){var n;if(e&&e.length>0)for(var r=0;r<e.length;r++){var i=e[r];if(i.tokenType===a.TokenType.Identifier&&i.index<=t)n=i;else{if(!(i.index<t))break;n=i}}return n},e.prototype.getForecastColumnSuggestions=function(e,t,n){var r=[];return e.columns&&e.columns.forEach((function(e){e.id!==n&&s.ExpressionParserUtils.isValidDependencyType(e.columnType,e.dataType)&&(void 0===t||e.uniqueName.toLowerCase().startsWith(t.toLowerCase())||e.title.toLowerCase().startsWith(t.toLowerCase()))&&r.push(e)})),r.sort(l.ForecastingBusinessLogicProvider.sortBasedOnDisplayName)},e}();t.SuggestionsProvider=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.forecastColumns=e,this.targetToken=t};t.Suggestions=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=n(53),o=n(164),a=n(16),s=n(43),l=n(501),c=n(105),u=n(96);t.categoryValuesFetcherMiddleware=function(e){var t=e.getState;return function(e){return function(n){return"@@ColumnEditor/TriggerCategoryValuesFetch"==n.type&&(e(s.UpdateFieldValue({forecastCategoryAttributeName:t().columnEditorState.selectedAttributeVal})),e(r.ClearRollupAndCalculatedColumns()),function(e,t){var n=i.getCrmDataAccessInstance();if(!n)return void console.warn("CrmDataAccess object is null. Unable to fetch category option members");var s=e().FormFieldData.rollupEntity,d=e().FormFieldData.forecastCategoryAttributeName,p=function(e,t){var n={name:e,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},r={metadataId:"",name:t,displayName:"",dataType:o.EDataType.MultiOptionSet};return{entityContext:n,fieldContext:r}}(s,d),_=p.entityContext,E=p.fieldContext;n.cdsResolver.resolveOptionSetMembers(_,E).then((function(n){console.log(JSON.stringify(n,null,2)),d==e().FormFieldData.forecastCategoryAttributeName&&(n.map((function(e){var n=function(e,t){return{id:u.generateNewGuid(),title:e.displayName,columnType:a.ForecastColumnType.Rollup,dataType:a.ForecastColumnDataType.Currency,isActive:!0,uniqueName:c.filterNonValidCharactersForUniqueName(e.displayName),optionSetValue:e.value,isManuallyAdjustable:!1,showProgressComparedToQuota:!1}}(e);t(r.AddColumn(n))})),"msdyn_forecastcategory"==d&&new Promise((function(e){var t=i.getCrmDataAccessInstance();t||(console.warn("CrmDataAccess object is null. Unable to validate column config autopopulation"),e(!0)),t.cdsResolver.resolveFields({name:"opportunity",displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""}).then((function(t){var n=0;t.map((function(e){e.name==l.ORG_TEMPLATE_AMOUNT_FIELD&&n++,e.name==l.ORG_TEMPLATE_DATE_FIELD&&n++,e.name==l.ORG_TEMPLATE_ACTUAL_DATE_FIELD&&n++,e.name==l.ORG_TEMPLATE_ACTUAL_AMOUNT_FIELD&&n++})),e(4==n)})).catch((function(){e(!1)}))})).then((function(e){e&&t(r.UpdateIsColumnConfigAutoPopulateDialogOpen(!0))})))}))}(t,e)),"@@ColumnEditorState/UpdateIsOptionSetSelectorOpened"==n.type&&1==n.payload.isOpen&&e(r.UpdateSelectedOptionSetValue(t().FormFieldData.forecastCategoryAttributeName)),e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(95),i=n(174),o=n(15),a=n(7),s=n(8),l="msdyn_forecastconfigurationid,msdyn_name,msdyn_hierarchyentity,msdyn_rollupentity,msdyn_rootentityrecordid,msdyn_forecastcategoryattribute,msdyn_startingfiscalyear,msdyn_periodtype,msdyn_numberofrecurrences,msdyn_startingfiscalquarter,msdyn_startingfiscalmonth,msdyn_startdate,msdyn_enddate,statuscode,_ownerid_value,msdyn_columns,msdyn_errormessage,msdyn_templatetype,msdyn_hierarchyrelationship,msdyn_additionalfilter,msdyn_permissionsdata,msdyn_rollupdefaultviewid,createdon",c=function(){function e(e){this.axiosInstance=e}return e.prototype.fetchForecastConfigList=function(){var e=this;return new Promise((function(t,n){var r={method:"GET",url:"api/data/v9.0/msdyn_forecastconfigurations?$select="+l+"&$orderby=createdon desc",headers:{Prefer:'odata.include-annotations="*"'}};i.showOrHideCrmLoaading(!0,a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_LOADING)),e.axiosInstance.request(r).then((function(n){var r=n.data.value.map((function(t){return e.convertForecastConfigJSONtoDisplayObject(t)}));t(r),i.showOrHideCrmLoaading(!1)})).catch((function(e){o.logError("Delphi-Config Fetch ForecastConfiguration",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),n(e)}))}))},e.prototype.fetchPredictionStatusForFC=function(e){var t=this;return new Promise((function(n,r){var i={method:"POST",url:"api/data/v9.0/msdyn_ForecastInstanceActions",headers:{Prefer:'odata.include-annotations="*"'},data:{ServiceName:"snapshot-services",WebApiName:"FetchPredictionStatus",RequestJson:'{"ForecastConfigurationId":"'+e+'"}'}};t.axiosInstance.request(i).then((function(e){var t=JSON.parse(e.data.response);n(t)})).catch((function(e){o.logError("Fetching prediction status for FC",e,"Please contact Dynamics Sales Forecasting",{}),r(e)}))}))},e.prototype.fetchForecastConfig=function(e){var t=this;return new Promise((function(n,r){var i={method:"GET",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")?$select="+l,headers:{Prefer:'odata.include-annotations="*"'}};t.axiosInstance.request(i).then((function(e){var r=t.convertForecastConfigJSONtoDomainObject(e.data);n(r)})).catch((function(e){o.logError("Delphi-Config Fetch ForecastConfiguration",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e)}))}))},e.prototype.updateForecastConfig=function(e,t){var n=this;return new Promise((function(r,a){var s=n.convertDomainObjectToForecastConfigJSON(t),l={method:"PATCH",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")",data:s};n.axiosInstance.request(l).then((function(e){r("")})).catch((function(e){o.logError("Delphi-Config update ForecastConfiguration",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),a(e),i.showOrHideCrmLoaading(!1)}))}))},e.prototype.deleteForecastConfig=function(e){var t=this;return new Promise((function(n,r){var l={method:"DELETE",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")"};i.showOrHideCrmLoaading(!0,a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_CRM_DELETING_CALLS)),t.axiosInstance.request(l).then((function(e){n(""),i.showOrHideCrmLoaading(!1)})).catch((function(e){o.logError("Delphi-Config Delete",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e),i.showOrHideCrmLoaading(!1)}))}))},e.prototype.publishForecastConfig=function(e){var t=this;return new Promise((function(n,r){var i={method:"PATCH",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")",data:{statuscode:2}};t.axiosInstance.request(i).then((function(e){n("")})).catch((function(e){o.logError("Delphi-Config Activate",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e)}))}))},e.prototype.deactivateForecastConfig=function(e){var t=this;return new Promise((function(n,r){var l={method:"PATCH",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")",data:{statuscode:5,statecode:1}};i.showOrHideCrmLoaading(!0,a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_CRM_ARCHIVING_CALLS)),t.axiosInstance.request(l).then((function(e){n(),i.showOrHideCrmLoaading(!1)})).catch((function(e){i.showOrHideCrmLoaading(!1),o.logError("Delphi-Config Deactivate",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e)}))}))},e.prototype.createForecastConfig=function(e){var t=this;return new Promise((function(n,r){var a={method:"POST",url:"api/data/v9.0/msdyn_forecastconfigurations",data:t.convertDomainObjectToForecastConfigJSON(e)};t.axiosInstance.request(a).then((function(e){var t,r=e.headers["odata-entityid"],i=(t=/\(([^)]+)\)/.exec(""+r))?t[1]:"";n(i)})).catch((function(e){o.logError("Delphi-Config Create",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e),i.showOrHideCrmLoaading(!1)}))}))},e.prototype.convertDomainObjectToForecastConfigJSON=function(e){var t={};return null!=e.name&&(t.msdyn_name=e.name),null!=e.hierarchyEntity&&(t.msdyn_hierarchyentity=e.hierarchyEntity),null!=e.rollupEntity&&(t.msdyn_rollupentity=e.rollupEntity),null!=e.topOfHierarchy&&(t.msdyn_rootentityrecordid=e.topOfHierarchy),null!=e.fiscalyear&&(t.msdyn_startingfiscalyear=parseInt(e.fiscalyear)),null!=e.period&&(t.msdyn_periodtype=parseInt(e.period)),null!=e.numberOfRecurrences&&(t.msdyn_numberofrecurrences=e.numberOfRecurrences),null!=e.startAtQuater&&(t.msdyn_startingfiscalquarter=parseInt(e.startAtQuater)),null!=e.startAtMonth&&(t.msdyn_startingfiscalmonth=parseInt(e.startAtMonth)),null!=e.fromDate&&(t.msdyn_startdate=e.fromDate),null!=e.toDate&&(t.msdyn_enddate=e.toDate),null!=e.forecastCategoryAttributeName&&(t.msdyn_forecastcategoryattribute=e.forecastCategoryAttributeName),null!=e.columns&&(t.msdyn_columns=JSON.stringify(e.columns)),null!=e.templateType&&(t.msdyn_templatetype=e.templateType.toString()),null!=e.hierarchyRelationship&&(t.msdyn_hierarchyrelationship=JSON.stringify(e.hierarchyRelationship)),null!=e.permissionsData&&(t.msdyn_permissionsdata=JSON.stringify(e.permissionsData)),null!=e.additionalFilter&&null!=e.additionalFilter&&(t.msdyn_additionalfilter=e.additionalFilter.toString()),null!=e.rollupEntityDefaultView&&null!=e.rollupEntityDefaultView&&(t.msdyn_rollupdefaultviewid=e.rollupEntityDefaultView.toString()),t},e.prototype.convertForecastConfigJSONtoDisplayObject=function(e){var t={id:e._ownerid_value,displayName:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],entityLogicalName:"systemuser"},n=r.GetEmptyForecastConfigInfo();return n.id=e.msdyn_forecastconfigurationid,n.name=e.msdyn_name,n.period=e["msdyn_periodtype@OData.Community.Display.V1.FormattedValue"]||n.period,n.fromDate=e["msdyn_startdate@OData.Community.Display.V1.FormattedValue"]||n.fromDate,n.toDate=e["msdyn_enddate@OData.Community.Display.V1.FormattedValue"]||n.toDate,n.status=e.statuscode||n.status,n.statusDescription=e["statuscode@OData.Community.Display.V1.FormattedValue"]||n.status,n.owner=t||n.owner,n.createdon=e["createdon@OData.Community.Display.V1.FormattedValue"],n.columns=e.msdyn_columns?JSON.parse(e.msdyn_columns):[],n.rollupEntity=e.msdyn_rollupentity,n.hierarchyEntity=e.msdyn_hierarchyentity,n},e.prototype.convertForecastConfigJSONtoDomainObject=function(e){var t={id:e._ownerid_value,displayName:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],entityLogicalName:"systemuser"},n=r.GetEmptyForecastConfigInfo();return n.id=e.msdyn_forecastconfigurationid,n.name=e.msdyn_name,n.hierarchyEntity=e.msdyn_hierarchyentity||n.hierarchyEntity,n.rollupEntity=e.msdyn_rollupentity||n.rollupEntity,n.topOfHierarchy=e.msdyn_rootentityrecordid||n.topOfHierarchy,n.forecastCategoryAttributeName=e.msdyn_forecastcategoryattribute||n.forecastCategoryAttributeName,n.fiscalyear=e.msdyn_startingfiscalyear,n.period=e.msdyn_periodtype,n.numberOfRecurrences=e.msdyn_numberofrecurrences,n.startAtQuater=e.msdyn_startingfiscalquarter,n.startAtMonth=e.msdyn_startingfiscalmonth,n.fromDate=e.msdyn_startdate||n.fromDate,n.toDate=e.msdyn_enddate||n.toDate,n.status=e.statuscode||n.status,n.owner=t||n.owner,n.statusDescription=e["statuscode@OData.Community.Display.V1.FormattedValue"]||n.statusDescription,n.publishErrorMessage=e.msdyn_errormessage||n.publishErrorMessage,n.templateType=null!=e.msdyn_templatetype?Number(e.msdyn_templatetype):n.templateType,n.additionalFilter=e.msdyn_additionalfilter||n.additionalFilter,n.rollupEntityDefaultView=e.msdyn_rollupdefaultviewid||n.rollupEntityDefaultView,null!=e.msdyn_hierarchyrelationship&&(n.hierarchyRelationship=u(e.msdyn_hierarchyrelationship,"Received error parsing permissions data json")||n.hierarchyRelationship),null!=e.msdyn_permissionsdata&&(n.permissionsData=u(e.msdyn_permissionsdata,"Received error parsing permissions data json")||n.permissionsData),n.columns=e.msdyn_columns?JSON.parse(e.msdyn_columns):r.GetInitialColumns(n.templateType),n},e}();function u(e,t){if(null!=e){var n=function(e){try{return{jsonObject:JSON.parse(e),error:void 0}}catch(e){return{jsonObject:void 0,error:e}}}(e),r=n.jsonObject,i=n.error;if(r)return r;i&&t&&o.logError(t,i,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",e)}}t.ForecastConfigDataAccess=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(95),i=n(15),o=function(){function e(e,t){this.axiosInstance=e,this.cdsResolver=t}return e.prototype.fetchForecastHierarchy=function(e,t,n){var r=this;return void 0===n&&(n=[]),new Promise((function(o,a){r.cdsResolver.cdsClient.then((function(i){i.fetchEntityAndRelatedEntityMetadata({entityName:e}).then((function(i){r.getforecastHierarchy(i,e,t,n).then((function(e){o(e)}))}))})).catch((function(e){i.logError("Delphi-Config Fetch Forecast HierarchyData",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),a(e)}))}))},e.prototype.createExtraAttributesFetchXmlString=function(e){var t="";return e.map((function(e){t+="<attribute name='"+e+"' />"})),t},e.prototype.getforecastHierarchy=function(e,t,n,r){var o=this,a=e.PrimaryNameAttribute,s=e.PrimaryIdAttribute,l=e.EntityRelationshipCollection,c="",u=e.EntitySetName;l.DependentRelationships.forEach((function(e){1==e.IsHierarchical&&(console.log(JSON.stringify(e)),c=e.ReferencingAttribute)}));var d=this.createExtraAttributesFetchXmlString(r),p="\n        <fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' >\n            <entity name= '"+t+"'>\n            <attribute name= '"+s+"' />\n            <attribute name= '"+a+"' />\n            <attribute name= '"+s+"' rowaggregate='CountChildren' alias='childCount'/>\n            <attribute name='"+c+"' />\n            "+d+"\n            <filter type='and'>\n                <condition attribute='"+s+"' operator='eq-or-under' value='"+n+"' />\n            </filter>\n          </entity>\n        </fetch>\n        ";return new Promise((function(e,t){var l={method:"GET",url:"api/data/v9.0/"+u+"?fetchXml="+encodeURIComponent(p),headers:{Prefer:'odata.include-annotations="*"'}};o.axiosInstance.request(l).then((function(t){var i=t.data.value.map((function(e){return o.convertForecastHierarchyJSONtoDisplayObject(e,a,s,c,n,r)}));e(i)})).catch((function(e){i.logError("Delfi-Config Fetch HierarchyData",e,"Please contact Dynamics Sales Forecasting - Delphi Grid team",{}),t(e)}))}))},e.prototype.convertForecastHierarchyJSONtoDisplayObject=function(e,t,n,i,o,a){var s=r.GetEmptyForecastHierarchyDisplayInfo();return s.id=e[n],s.displayName=e[t],s.parentId=e["_"+i+"_value"]?e["_"+i+"_value"]:null,s.hasChildren=void 0!==e.childCount&&parseInt(e.childCount)>0,a.map((function(t){var n="_"+t+"_value@OData.Community.Display.V1.FormattedValue";s.extraAttributesValues[t]=e[n]||e[t]})),s},e.prototype.isUserHierarchy=function(e){return"systemuser"===e.toLowerCase().trim()},e}();t.HierarchyDataAccess=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=function(){function e(e){this.axiosInstance=e}return e.prototype.downloadQuotaTemplate=function(e){var t=this;return new Promise((function(n,i){var o={ForecastConfigurationId:e};t.CallCustomAction("quota-download",o).then((function(e){var t=e.data.response,r=JSON.parse(t);200==r.Code?n(r.Body):i(r.Message)})).catch((function(e){r.logError("Delphi-Config downloadQuotaTemplate",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),i(e)}))}))},e.prototype.uploadQuotaExcel=function(e,t,n){var i=this;return new Promise((function(o,a){var s={ForecastConfigurationId:e,Filename:t,FileContent:n};i.CallCustomAction("quota-upload",s).then((function(e){var t=e.data.response,n=JSON.parse(t);200==n.Code?o(n.Body):a(n.Message)})).catch((function(e){a(e),r.logError("Delphi-Config uploadQuotaTemplate",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{})}))}))},e.prototype.fetchQuotaUploadStatus=function(e){var t=this;return new Promise((function(n,i){var o={ForecastConfigurationId:e};t.CallCustomAction("fetch-quota",o).then((function(e){var t=e.data.response,r=JSON.parse(t);200==r.Code&&r.Body?n(r.Body[0]):i(r.Message)})).catch((function(e){i(e),r.logError("Delphi-Config fetchQuotaUploadStatus",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{})}))}))},e.prototype.CallCustomAction=function(e,t){return this.axiosInstance.post("api/data/v9.0/msdyn_ForecastInstanceActions",{WebApiName:e,RequestJson:JSON.stringify(t),ServiceName:"mf-services"})},e}();t.QuotaDataAccess=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(15),a=function(){function e(e,t){this.axiosInstance=e,this.orgId=t,this.cachedEntityResponse=[],this.cachedHierarchyEntityResponse=[]}return e.prototype.getHierarchialEntities=function(){var e=this;return new Promise((function(t,n){e.cachedHierarchyEntityResponse.length>0?t(e.cachedHierarchyEntityResponse):e.axiosInstance.request({method:"GET",url:"api/data/v9.0/RelationshipDefinitions/Microsoft.Dynamics.CRM.OneToManyRelationshipMetadata?$filter=IsHierarchical%20eq%20true&$select=ReferencedEntity,%20ReferencedEntityNavigationPropertyName"}).then((function(n){var r=n.data.value,i=[];e.cachedEntityResponse.length>0?(i=e.cachedEntityResponse.filter((function(e){return r.some((function(t){return t.ReferencedEntity===e.LogicalName}))})),e.cachedHierarchyEntityResponse=i,t(e.cachedHierarchyEntityResponse)):e.getOrgEntities().then((function(n){i=n.filter((function(e){return r.some((function(t){return t.ReferencedEntity===e.LogicalName}))})),e.cachedHierarchyEntityResponse=i,t(e.cachedHierarchyEntityResponse)}))}),(function(e){n(e)}))}))},e.prototype.getOrgEntities=function(){var e=this;return new Promise((function(t,n){e.cachedEntityResponse.length>0?t(e.cachedEntityResponse):e.axiosInstance.request({method:"GET",url:"/api/data/v9.0/EntityDefinitions?$select=MetadataId,LogicalName,DisplayName,PrimaryIdAttribute,ObjectTypeCode,IsCustomizable,OwnershipType,CanCreateAttributes&$filter=IsValidForAdvancedFind%20eq%20true"}).then((function(n){var r=n.data.value;e.cachedEntityResponse=r,t(e.cachedEntityResponse)}),(function(e){n(e)}))}))},e.prototype.getOrgFiscalCalendarStartDate=function(){return r(this,void 0,Promise,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t){var n={method:"GET",url:"api/data/v9.0/organizations("+e.orgId+")?$select=fiscalcalendarstart"};e.axiosInstance.request(n).then((function(e){var n=new Date(e.data.fiscalcalendarstart).toDateString();t(n)}),(function(e){o.logError("Delphi-Config Fiscal Year Fetch",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{});var n=(new Date).getFullYear();t(new Date(n,1,1).toDateString())}))}))]}))}))},e.prototype.getOrgSettings=function(){return r(this,void 0,Promise,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t){var n={method:"GET",url:"api/data/v9.0/organizations("+e.orgId+")?$select=fiscalcalendarstart,ismanualsalesforecastingenabled"};e.axiosInstance.request(n).then((function(e){var n=new Date(e.data.fiscalcalendarstart).toDateString(),r=e.data.ismanualsalesforecastingenabled;t({fiscalcalendarstart:n,ismanualsalesforecastingenabled:r})}),(function(e){o.logError("Delphi-Config org settings fetch",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{});var n=(new Date).getFullYear();t({fiscalcalendarstart:new Date(n,1,1).toDateString(),ismanualsalesforecastingenabled:!1})}))}))]}))}))},e.prototype.enableManualForecastingAdminSettings=function(){return r(this,void 0,Promise,(function(){var e=this;return i(this,(function(t){return[2,new Promise((function(t,n){var r={method:"PATCH",url:"api/data/v9.0/organizations("+e.orgId+")?$select=ismanualsalesforecastingenabled",data:{ismanualsalesforecastingenabled:!0},headers:{"Content-Type":"application/json",Prefer:"return=representation"}};e.axiosInstance.request(r).then((function(e){var n=e.data.ismanualsalesforecastingenabled;t(n)}),(function(e){var t=e&&e.response&&e.response.data&&e.response.data.error;o.logError("Delphi-Config admin settings enable",t,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),n(t||e)}))}))]}))}))},e}();t.OrganizationDataAccess=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.axiosInstance=e}return e.prototype.getPublishedForecastDefinitionCount=function(){var e=this;return new Promise((function(t,n){var r=0;e.axiosInstance.request({method:"GET",url:"api/data/v9.0/msdyn_forecastdefinitions?$filter=statuscode eq 3&$count=true"}).then((function(e){null==e||isNaN(e.data["@odata.count"])||(r=e.data["@odata.count"]),t(r)}),(function(e){console.log("Error occurred while fetching active forecast definition count. Details: "+e),n(e)}))}))},e}();t.ForecastDefinitionDataAccess=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=function(){function e(e){this.axiosInstance=e}return e.prototype.isSIPackageInstalled=function(){var t=this;return new Promise((function(n){t.axiosInstance.request({method:"GET",url:"api/data/v9.0/EntityDefinitions(LogicalName='opportunity')/Attributes"}).then((function(r){r&&200==r.status?r&&JSON.stringify(r.data).includes(e.OPP_SCORE_ATTRIBUTE)?n(!0):n(!1):n(t.isMsdyn_opportunityScorePresentInOpportunityEntity())})).catch((function(e){r.logError("Error while determining SI package status using entity metadata",e,"")}))}))},e.prototype.isMsdyn_opportunityScorePresentInOpportunityEntity=function(){var t=this;return new Promise((function(n){var i={method:"GET",url:"api/data/v9.0/opportunities?$select="+e.OPP_SCORE_ATTRIBUTE+"&$top=1"};t.axiosInstance.request(i).then((function(e){e&&200==e.status?n(!0):n(!1)})).catch((function(e){r.logError("Error while determining SI package status using GET opportunity",e,"")}))}))},e.prototype.isSILicenseAvailable=function(){var e=this;return new Promise((function(t){e.axiosInstance.request({method:"POST",url:"api/data/v9.0/msdyn_ForecastInstanceActions",data:{WebApiName:"SILicenseCheck",RequestJson:"SILicenseCheck",ServiceName:"snapshot-services"}}).then((function(e){null!=e.data&&("True"==e.data.response&&t(!0));t(!1)})).catch((function(e){r.logError("An error occurred while fetching the SI License status: ",e,""),t(!1)}))}))},e.prototype.getFeatureEnablementState=function(){var e=this;return new Promise((function(t,n){var i={isManualForecastEnabled:!0,isPredictiveEnabled:!1,isSnapshotEnabled:!1};e.axiosInstance.request({method:"POST",url:"api/data/v9.0/msdyn_ForecastInstanceActions",data:{WebApiName:"fetch-geo-settings",RequestJson:'{"Settings":["FeatureState"]}',ServiceName:"mf-services"}}).then((function(e){if(null!=e.data){var n=e.data.response,r=JSON.parse(n);if(r&&r.SettingsInformation&&r.SettingsInformation.FeatureState){var o=r.SettingsInformation.FeatureState.replace(/\\/g,""),a=JSON.parse(o);null!=a.ManualForecast&&null!=a.ManualForecast&&(i.isManualForecastEnabled=1===a.ManualForecast),null!=a.PredictiveForecast&&null!=a.PredictiveForecast&&(i.isPredictiveEnabled=1===a.PredictiveForecast),null!=a.Snapshot&&null!=a.Snapshot&&(i.isSnapshotEnabled=1===a.Snapshot)}}t(i)})).catch((function(e){r.logError("An error occurred while fetching feature state: ",e,""),t(i)}))}))},e.OPP_SCORE_ATTRIBUTE="msdyn_opportunityscore",e}();t.SIDataAccess=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=n(226),o=function(){function e(e){this.axiosInstance=e,this.cachedRoles=[]}return e.prototype.getRoles=function(){var e=this;return new Promise((function(t,n){e.cachedRoles.length>0?t(e.cachedRoles):e.axiosInstance.request({method:"GET",url:"/api/data/v9.0/roles?$select=_parentrootroleid_value,name"}).then((function(n){n.data.value.forEach((function(t){-1==e.cachedRoles.findIndex((function(e){return e.roleId==t._parentrootroleid_value}))&&e.cachedRoles.push({roleId:t._parentrootroleid_value,roleName:t.name})})),t(e.cachedRoles)}),(function(e){r.logError("Delfi-config fetch org roles",e,"",{userId:i.XrmHelper.getLoggedInUserInfo().id}),n(e)}))}))},e}();t.RoleDataAccess=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15),i=function(){function e(e){this.axiosInstance=e,this.cacheOneToManyRelationships={}}return e.prototype.getGridViewDefinitions=function(e){var t=this;return new Promise((function(n,i){var o={method:"GET",url:"api/data/v9.0/savedqueries?$filter=(querytype eq 0 or querytype eq 1) and returnedtypecode eq '"+e+"' &$select=savedqueryid, name&$orderby=querytype desc,name asc"};t.axiosInstance.request(o).then((function(e){if(e&&e.data&&e.data.value){var t=e.data.value.map((function(e){return{id:e.savedqueryid,title:e.name}}));n(t)}else n([])})).catch((function(e){r.logError("Delphi-Config Fetch Views",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),i(e)}))}))},e.prototype.getOneToManyRelationships=function(e,t){var n=this;return new Promise((function(i,o){if(n.cacheOneToManyRelationships[e+t])i(n.cacheOneToManyRelationships[e+t]);else{var a={method:"GET",url:"api/data/v9.0/RelationshipDefinitions/Microsoft.Dynamics.CRM.OneToManyRelationshipMetadata?$select=ReferencedEntity,ReferencedAttribute,ReferencingEntity,ReferencingAttribute,IsHierarchical,IsCustomRelationship&$filter=ReferencingEntity eq '"+e+"' or ReferencedEntity eq '"+t+"'"};n.axiosInstance.request(a).then((function(r){r&&r.data&&r.data.value?(n.cacheOneToManyRelationships[e+t]=r.data.value,i(r.data.value)):o()})).catch((function(e){r.logError("Delphi-Config Fetch one to many relationships",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),o(e)}))}}))},e}();t.CrmMetaDataAccess=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.axiosInstance=e}return e.prototype.getSnapshotStatus=function(e,t){var n=this;return new Promise((function(r,i){var o,a={ForecastConfigurationId:e,PageInfo:t};n.axiosInstance.post("api/data/v9.0/msdyn_ForecastInstanceActions",{WebApiName:"RetrieveSnapshotStatusForConfiguration",RequestJson:JSON.stringify(a),ServiceName:"snapshot-services"}).then((function(e){if(null!=e&&null!==e.data&&void 0!==e.data){var t=e.data;null!=t&&(o=JSON.parse(t.response))}r(o)})).catch((function(e){console.log("Error occurred while fetching snapshot status information. Details: "+e),i(e)}))}))},e.prototype.createForecastSnapshot=function(e,t){var n=this;return new Promise((function(r,i){var o={ForecastConfigurationId:e,SnapshotName:t};n.axiosInstance.post("api/data/v9.0/msdyn_ForecastInstanceActions",{WebApiName:"SnapshotBuilder",RequestJson:JSON.stringify(o),ServiceName:"snapshot-services"}).then((function(e){null!=e&&null!==e.data&&void 0!==e.data&&null!==e.data.response&&void 0!==e.data.response&&r(e.data.response)})).catch((function(e){console.log("Error occured while creating the snapshot. Details:"+e),i(e)}))}))},e.prototype.deleteSnapshot=function(e){var t=this;return new Promise((function(n,r){var i={OperationName:0,SnapshotId:e};t.axiosInstance.post("api/data/v9.0/msdyn_ForecastInstanceActions",{WebApiName:"DeleteOperation",RequestJson:JSON.stringify(i),ServiceName:"snapshot-services"}).then((function(e){n()})).catch((function(e){console.log("Error occured while deleting the snapshot. Details: "+e),r(e)}))}))},e}();t.ForecastSnapshotDataAccess=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(325),o=n(53),a=n(65),s=n(44),l=n(82),c=n(173),u=n(138),d=n(97),p=n(108),_=n(323),E=n(41),S=n(503),f=n(177),C=n(96);function m(e,t,n,l,d){var p=e(),_=p.stepperActiveStage;if(a.GetIsFormDirty_FromState(p)){if(function(e,t){var n=E.ForecastingBusinessLogicProvider.getForecastConfigFieldsForStage(t);return!c.GetHasRequiredFieldsFilled_ForStage(e.FormFieldData,n)}(p,_))return void t(r.UpdateShowWarningsFlag(!0));if(g(e)){var S=o.getCrmDataAccessInstance();if(S)new i.FormEventsHandler(t,S.forecastConfigAccess).UpdateData(p.FormFieldData.id,p.FormFieldData,p.ActiveForecastConfigInfo,n,d),n&&function(e){u.NavigationHandlerFactory.GetNavigationHandlerObject(e).OpenGridPage()}(t),l&&(t(s.UpdateIsEditorOpened(!1)),t(s.UpdateIsOptionSetSelectorOpened(!1)));else console.warn("Saving attempted when crmDataAccess was NULL")}}else g(e)&&l&&(t(s.UpdateIsEditorOpened(!1)),t(s.UpdateIsOptionSetSelectorOpened(!1)))}function g(e){var t=e(),n=p.GetActiveForecastColumnInfo_FromState(t),r=t.FormFieldData,i=!0;if(n.calculatedFieldExpression){var o=_.ExpressionParserFactory.getCalculatedFieldExpressionParser();try{o.parseExpression(n.calculatedFieldExpression,r,n.uniqueName,n.id)}catch(e){i=!1}}return i}t.saveEventsMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@SaveEvents/TriggerUndoColumnFormChanges"==n.type){var i=t();if(l.GetIsCurrentlyEditingColumnNew_FromState(i))e(s.DeleteColumn(i.columnEditorState.activeForecastColumnId));else{var o=JSON.parse(JSON.stringify(i.columnEditorState.uneditedColumnInfo));e(s.ReplaceColumn(o.id,o))}}if("@@FormData/DiscardValue"==n.type){i=t();var a=JSON.parse(JSON.stringify(i.ActiveForecastConfigInfo));if(n.payload.shouldDiscardSelectedFields){var c={};n.payload.fields.map((function(e){c[e]=a[e]})),e(r.UpdateFieldValue(c))}else e(r.UpdateFieldValue(a))}if("@@SaveEvents/TriggerSave"==n.type){var u=C.createNewContext("fc-save-click");m(t,e,n.payload.shouldClose,n.payload.shouldCloseColumnEditorForm,u)}if("@@EditApp/ON_STEPPER_BUTTON_CLICK"==n.type||"@@EditApp/ON_STEP_CLICK"==n.type){u=C.createNewContext("fc-stepper-click");m(t,e,void 0,void 0,u)}return"@@FormEvents/FormRefreshed"==n.type&&function(e,t){var n=e();if(null==n.FormFieldData.permissionsData&&n.stepperActiveStage==d.ForecastConfigStage.Permission){var r=C.createNewContext("fc-permissions-autopopulate"),i=S.getDefaultPermissionDataByTemplate(n.FormFieldData.templateType);null!==i&&(t(f.UpdatePermissionsData(i)),m(e,t,void 0,void 0,r))}}(t,e),e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(175),i=function(){function e(){}return e.prototype.OpenCreatePage=function(e){var t={isEditMode:"true",id:""};e&&(t.templateType=e.toString()),r.CrmNavigationHelpers.navigateWithParams(t)},e.prototype.OpenEditPage=function(e){var t={isEditMode:"true",id:e};r.CrmNavigationHelpers.navigateWithParams(t)},e.prototype.OpenGridPage=function(){r.CrmNavigationHelpers.navigateWithParams({isEditMode:"false",id:""})},e.prototype.OpenPredictivePage=function(){r.CrmNavigationHelpers.navigateWithParams({isEditMode:"false",id:"",isPredictiveMode:"true"})},e}();t.CrmNavigationHandler=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(322),i=n(227),o=n(97),a=n(41),s=n(138);t.dialogRendererMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@EditApp/ON_STEPPER_BUTTON_CLICK"==n.type&&n.payload.buttonTypeClicked==r.IStepperButton.NEXT){var l=void 0;if((u=t().stepperActiveStage)==o.ForecastConfigStage.Quota)!function(e){s.NavigationHandlerFactory.GetNavigationHandlerObject(e).OpenGridPage()}(e);else{l=a.ForecastingBusinessLogicProvider.isLastStageofOrderedStepperStages(u)?u:a.ForecastingBusinessLogicProvider.getNextStage(u);var c=a.ForecastingBusinessLogicProvider.GetStageStepId(l);l!=u&&e(i.onStepClickActionCreator(c))}}if("@@EditApp/ON_STEPPER_BUTTON_CLICK"==n.type&&n.payload.buttonTypeClicked==r.IStepperButton.BACK){var u=t().stepperActiveStage,d=a.ForecastingBusinessLogicProvider.isFirstStageofOrderedStepperStages(u)?u:a.ForecastingBusinessLogicProvider.getPreviousStage(u);c=a.ForecastingBusinessLogicProvider.GetStageStepId(d);e(i.onStepClickActionCreator(c))}return e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchHierarchyStartedDataActionCreator=function(){return{type:"@@HierarchyPreview/FetchHierarchyStarted",payload:{}}},t.FetchHierarchyCompletedDataActionCreator=function(){return{type:"@@HierarchyPreview/FetchHierarchyCompleted",payload:{}}}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(82),a=n(53),s=n(44),l=n(164);t.optionSetInfoListFetcherMiddleware=function(e){var t=this,n=e.getState;return function(e){return function(c){return r(t,void 0,void 0,(function(){var t,u,d,p,_,E=this;return i(this,(function(S){if("@@FormData/UpdateFieldValue"==c.type&&c.payload.data.rollupEntity){if(t=e(c),u=n(),d=c.payload.data.rollupEntity,0==o.GetOptionSetAttributeInfoList_FromState(u).length){if(!(p=a.getCrmDataAccessInstance()))return console.warn("CrmDataAccess object is null. Unable to fetch optionset attributes"),[2];_={name:d,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},p.cdsResolver.resolveFields(_).then((function(t){return r(E,void 0,void 0,(function(){var n,r,o,a,c,u,_,E,S,f;return i(this,(function(i){switch(i.label){case 0:n=[],r=0,i.label=1;case 1:return r<t.length?(o=t[r]).dataType!=l.EDataType.OptionSet?[3,3]:(a=o.name,c=function(e,t){var n={name:e,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},r={metadataId:"",name:t,displayName:"",dataType:l.EDataType.MultiOptionSet};return{entityContext:n,fieldContext:r}}(d,a),u=c.entityContext,_=c.fieldContext,[4,p.cdsResolver.resolveOptionSetMembers(u,_)]):[3,4];case 2:E=i.sent(),S=E.map((function(e){return e.displayName})),f={displayName:o.displayName,logicalName:o.name,members:S},n.push(f),i.label=3;case 3:return r++,[3,1];case 4:return e(s.UpdateOptionSetList(d,n)),[2]}}))}))}))}return[2,t]}return[2,e(c)]}))}))}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(505),o=n(53),a=n(211),s=n(95),l=n(506),c=n(16),u=n(325),d=n(7),p=n(8),_=n(110),E=n(15),S=n(96);function f(e,t,n,r){var o={formType:_.FormType.EditForm,formInput:{fcId:e.id}};new u.FormEventsHandler(t,n.forecastConfigAccess).RefreshForm(o,r).then((function(){t(i.QuotaUploadPublishUpdate(!1))}))}t.quotaStatusFetcherMiddleware=function(e){var t=e.getState;return function(e){return function(r){if("@@EditApp/QuotaStatusFetchAction"==r.type&&function(e){var r=o.getCrmDataAccessInstance();if(!r)return void console.warn("CrmDataAccess object is null. Unable to fetch quota");var l=t().ActiveForecastConfigInfo.id;r.quotaDataAccess.fetchQuotaUploadStatus(t().ActiveForecastConfigInfo.id).then((function(t){t&&(t.Status==a.QuotaStatus.InProgress&&n(l,e),e(i.QuotaUploadStatusUpdate(t))),e(i.QuotaUploadFetchUpdate(!0))})).catch((function(){var t=s.GetEmptyQuotaStatusInfo();t.Status=a.QuotaStatus.Failed,t.ErrorCode="FETCH_FAILED",e(i.QuotaUploadStatusUpdate(t)),e(i.QuotaUploadFetchUpdate(!0)),C(l,c.NotificationEventType.NOTIFY_QUOTA_UPLOAD_EVENTS)}))}(e),"@@EditApp/QuotaUploadStartAction"==r.type){var u=s.GetEmptyQuotaStatusInfo();u.Status=a.QuotaStatus.Uploading,e(i.QuotaUploadStatusUpdate(u)),e(i.QuotaUploadDownloadUpdate(a.QuotaDownloadStatus.New)),function(e,r){var l=o.getCrmDataAccessInstance();if(!l)return void console.warn("CrmDataAccess object is null. Unalbe to upload quota");var c=t().ActiveForecastConfigInfo.id;n(c,r),l.quotaDataAccess.uploadQuotaExcel(t().ActiveForecastConfigInfo.id,e.payload.fileName,e.payload.fileContent).then((function(e){r(i.QuotaUploadStatusUpdate(e))})).catch((function(){var t=s.GetEmptyQuotaStatusInfo();t.Status=a.QuotaStatus.Failed,t.ErrorCode="UPLOAD_FAILED",t.UploadFileName=e.payload.fileName,r(i.QuotaUploadStatusUpdate(t)),C(c,r)}))}(r,e)}if("@@EditApp/QuotaDownloadAction"==r.type&&t().quotaUploadStageState.downloadStatus!=a.QuotaDownloadStatus.InProgress&&(e(i.QuotaUploadDownloadUpdate(a.QuotaDownloadStatus.InProgress)),function(e){var n=o.getCrmDataAccessInstance();if(!n)return void console.warn("CrmDataAccess object is null. Unable to download quota");n.quotaDataAccess.downloadQuotaTemplate(t().ActiveForecastConfigInfo.id).then((function(n){!function(e,t){var n="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+e,r=(t||d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_FORECAST_TITLE_EDITPAGE))+"_"+d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_SIMPLE)+".xlsx";if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(function(e){var t=e.split(/[:;,]/),n=t[1],r=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),i=r.length,o=0,a=new Uint8Array(i);for(;o<i;++o)a[o]=r.charCodeAt(o);return new Blob([a],{type:n})}(n),r);else{var i=document.createElement("a");document.body.appendChild(i),i.href=n,i.download=r,i.style.display="none",i.click(),document.body.removeChild(i)}}(n,t().ActiveForecastConfigInfo.name),e(i.QuotaUploadDownloadUpdate(a.QuotaDownloadStatus.Success))})).catch((function(t){e(i.QuotaUploadDownloadUpdate(a.QuotaDownloadStatus.Failed)),E.logError("Quota Download Error",t,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team")}))}(e)),"@@EditApp/PublishAction"==r.type&&(e(i.QuotaUploadPublishUpdate(!0)),function(e,t){var n=S.createNewContext("fc-publish-click");m(e().ActiveForecastConfigInfo.id,t,n);var r=e().ActiveForecastConfigInfo,i=o.getCrmDataAccessInstance();if(i){var a=r.id;E.logInfo("quotaUploadMiddleware","",n,"publish-fc-req-start"),i.forecastConfigAccess.publishForecastConfig(a).then((function(){E.logInfo("quotaUploadMiddleware","",n,"publish-fc-req-end"),f(r,t,i,n)})).catch((function(){f(r,t,i,n)}))}}(t,e)),"@@EditApp/NotificationConnectAction"==r.type){var _=l.NotificationProvider.Get();_&&_.connect()}return"@@EditApp/PublishSubscribeAction"==r.type&&m(t().ActiveForecastConfigInfo.id,e),e(r)}};function n(e,n){l.NotificationProvider.Get().subscribe({groupId:e,eventName:c.NotificationEventType.NOTIFY_QUOTA_UPLOAD_EVENTS},(function(r){var o=t().quotaUploadStageState.quotaStatusInfo;o.Status=r.Properties.QuotaUploadStatus,o.ErrorCode=r.Properties.ErrorCode,n(i.QuotaUploadStatusUpdate(o)),C(e,c.NotificationEventType.NOTIFY_QUOTA_UPLOAD_EVENTS)}))}function C(e,t){l.NotificationProvider.Get().unsubscribe({groupId:e,eventName:t})}function m(e,n,a){var s=o.getCrmDataAccessInstance();l.NotificationProvider.Get().subscribe({groupId:e,eventName:c.NotificationEventType.NOTIFY_FC_PUBLISH_EVENTS},(function(o){E.logInfo("quotaUploadMiddleware","",a,"publish-fc-signalR-recv");var l=t().ActiveForecastConfigInfo,d={formType:_.FormType.EditForm,formInput:{fcId:l.id}};new u.FormEventsHandler(n,s.forecastConfigAccess).RefreshForm(d,a).then((function(t){n(i.QuotaUploadFetchUpdate(!0)),C(e,c.NotificationEventType.NOTIFY_FC_PUBLISH_EVENTS),function(e,t,n){if(e.status===c.IForecastConfigStatus.Failed){E.logInfo("quotaUploadMiddleware","",r({},n),"publish-fc-fail");var i=JSON.parse(e.publishErrorMessage);if(i.FailureType===c.AzActivationFailureType.ActiveFCCountThresholdExceeded){var o=JSON.parse(i.Data).CurrentActivatedCount;t.forecastConfigAccess.fetchForecastConfigList().then((function(e){var t=e.filter((function(e){return e.status===c.IForecastConfigStatus.Archived})).map((function(e){return e.id})),i=e.filter((function(e){return e.status===c.IForecastConfigStatus.Published})).map((function(e){return e.id})),a=o!==i.length,s={archivedFCIds:t,publishedFCIds:i,activatedCountInAzure:o,isThereActiveCountDiff:a};E.logInfo("quotaUploadMiddleware","",r({},n,{pubLogData:s}),"publish-fc-fail-max-limit")}))}}e.status===c.IForecastConfigStatus.Published&&E.logInfo("quotaUploadMiddleware","",r({},n),"publish-fc-success")}(t,s,a)}))}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),i=n(86),o=n(99),a=n(43),s=n(163),l=n(138),c=n(15),u=n(174),d=n(7),p=n(8),_=n(98),E=n(87),S=n(16),f=n(178),C=n(119),m=n(96);function g(e,t){var n=e(),i=r.getCrmDataAccessInstance(),o=n.mainPageType;i?o==s.IMainPageType.GridPage?i.forecastConfigAccess.fetchForecastConfigList().then((function(e){t(a.UpdateForecastConfigList(e))})).catch((function(){t(_.onErrorShowDialogActionCreator(E.IErrorDialogType.ForecastConfigFetchingFailed))})):console.log("No Refresh Needed for edit app"):console.warn("Refresh attempted when crmDataAccess was NULL ")}function T(e){l.NavigationHandlerFactory.GetNavigationHandlerObject(e).OpenGridPage()}t.forecastConfigActionsMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@GridApp/ON_DELETE_CONFIRM_DIALOG_CLICK"==n.type&&n.payload.dialogActionClicked==i.IDeleteDialogActionType.DELETE){var a="";(l=(I=t()).mainPageType)==s.IMainPageType.EditPage?a=I.ActiveForecastConfigInfo.id:l==s.IMainPageType.GridPage&&(a=I.gridAppDialogState.gridActionableRow),c.logUsage("DelfiConfigApp.Delete","Grid_App_Delete_Confirmed_Button_Clicked",{ButtonName:"Delete",rowselected:a}),function(e,t,n){var i=e().mainPageType,o=r.getCrmDataAccessInstance(),a=m.createNewContext("fc-delete-click");o?""!=n&&(c.logInfo("fc-config-middleware","",a,"delete-fc-start"),o.forecastConfigAccess.deleteForecastConfig(n).then((function(n){c.logInfo("fc-config-middleware","",a,"delete-fc-end"),i==s.IMainPageType.EditPage?T(t):g(e,t)})).catch((function(){t(_.onErrorShowDialogActionCreator(E.IErrorDialogType.ForecastConfigDeleteFailed))}))):console.warn("Delete attempted when crmDataAccess was NULL")}(t,e,a),e(o.onGridAppDialogDeleteStateActionCreator(!0))}if("@@GridApp/ON_DELETE_CONFIRM_DIALOG_CLICK"!=n.type||n.payload.dialogActionClicked!=i.IDeleteDialogActionType.CANCEL&&n.payload.dialogActionClicked!=i.IDeleteDialogActionType.CLOSE||(e(o.onRowSelectedActionCreator("")),e(o.onGridAppDialogDeleteStateActionCreator(!0))),"@@GridApp/ON_CREATE_SNAPSHOT_CONFIRM_DIALOG_CLICK"==n.type&&n.payload.dialogActionClicked==i.ICreateSnapshotDialogActionType.CREATE_SNAPSHOT){var l,I=t(),h=n.payload.snapshotName;a="";(l=I.mainPageType)==s.IMainPageType.EditPage?a=I.ActiveForecastConfigInfo.id:l==s.IMainPageType.GridPage&&(a=I.gridAppDialogState.gridActionableRow),c.logUsage("DelfiConfigApp.CreateSnapshot","Grid_App_Create_Snapshot_Confirmed_Button_Clicked",{ButtonName:"Create_Snapshot",rowselected:a}),function(e,t,n,i){var o=e().mainPageType,a=r.getCrmDataAccessInstance();a?""!=n&&a.snapshotDataAccess.createForecastSnapshot(n,i).then((function(n){o==s.IMainPageType.EditPage?T(t):g(e,t)})).catch((function(){t(_.onErrorShowDialogActionCreator(E.IErrorDialogType.ForecastSnapshotCreateFailed))})):console.warn("Create Snapshot attempted when crmDataAccess was NULL")}(t,e,a,h),e(o.onGridAppDialogCreateSnapshotStateActionCreator(!0))}if("@@GridApp/ON_CREATE_SNAPSHOT_CONFIRM_DIALOG_CLICK"!=n.type||n.payload.dialogActionClicked!=i.ICreateSnapshotDialogActionType.CANCEL&&n.payload.dialogActionClicked!=i.ICreateSnapshotDialogActionType.CLOSE||(e(o.onRowSelectedActionCreator("")),e(o.onGridAppDialogCreateSnapshotStateActionCreator(!0))),"@@GridApp/ON_PUBLISH_CONFIRM_DIALOG_CLICK"==n.type&&n.payload.dialogActionClicked==i.IPublishDialogActionType.PUBLISH&&(!function(e,t){var n=e(),i=r.getCrmDataAccessInstance();i?""!=n.gridAppDialogState.gridActionableRow&&(c.logUsage("DelfiConfigApp.Publish","Grid_App_Publish_Confirmed_Button_Clicked",{ButtonName:"Publish",rowselected:n.gridAppDialogState.gridActionableRow}),u.showOrHideCrmLoaading(!0,d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_CRM_PUBLISHING_CALLS)),i.forecastConfigAccess.publishForecastConfig(n.gridAppDialogState.gridActionableRow).then((function(r){i.forecastConfigAccess.fetchForecastConfig(n.gridAppDialogState.gridActionableRow).then((function(e){if(e.status==S.IForecastConfigStatus.Failed&&e.publishErrorMessage){var n=f.getlocalizedFCPublishErrorMessage(e.publishErrorMessage);n&&t(_.onErrorShowDialogActionCreator(E.IErrorDialogType.ForecastConfigPublishFailed,n))}u.showOrHideCrmLoaading(!1)})),g(e,t)})).catch((function(){t(_.onErrorShowDialogActionCreator(E.IErrorDialogType.ForecastConfigPublishFailed)),u.showOrHideCrmLoaading(!1)}))):console.warn("Publish attempted when crmDataAccess was NULL")}(t,e),e(o.onGridAppDialogPublishStateActionCreator(!0))),"@@GridApp/ON_PUBLISH_CONFIRM_DIALOG_CLICK"!=n.type||n.payload.dialogActionClicked!=i.IPublishDialogActionType.CANCEL&&n.payload.dialogActionClicked!=i.IPublishDialogActionType.CLOSE||(e(o.onRowSelectedActionCreator("")),e(o.onGridAppDialogPublishStateActionCreator(!0))),"@@GridApp/ON_ENABLE_MANUAL_FORECASTING_DIALOG_CLICK"==n.type&&(n.payload.dialogActionClicked==i.IEnableManualForecastingActionType.ENABLE&&e(C.EnableManualForecastingAdminSettingsActionCreator()),e(o.enableManualForecastingDialogHiddenStateActionCreator(!0))),"@@GridApp/ON_ARCHIVE_CONFIRM_DIALOG_CLICK"==n.type&&n.payload.dialogActionClicked==i.IArchiveDialogActionType.DEACTIVATE){a=(I=t()).gridAppDialogState.gridActionableRow;c.logUsage("DelfiConfigApp.Deactivate","Grid_App_Deactivate_Confirmed_Button_Clicked",{ButtonName:"DeActivate",rowselected:a}),function(e,t,n){e();var i=r.getCrmDataAccessInstance();i?""!=n&&i.forecastConfigAccess.deactivateForecastConfig(n).then((function(n){g(e,t)})).catch((function(){t(_.onErrorShowDialogActionCreator(E.IErrorDialogType.GenericFailure))})):console.warn("DeActivate attempted when crmDataAccess was NULL")}(t,e,a),e(o.onGridAppDialogArchiveStateActionCreator(!0))}return"@@GridApp/ON_ARCHIVE_CONFIRM_DIALOG_CLICK"!=n.type||n.payload.dialogActionClicked!=i.IArchiveDialogActionType.CANCEL&&n.payload.dialogActionClicked!=i.IArchiveDialogActionType.CLOSE||(e(o.onRowSelectedActionCreator("")),e(o.onGridAppDialogArchiveStateActionCreator(!0))),e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=n(53);t.amountBaseFieldFetcherMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@FormData/UpdateColumnInfoField"==n.type&&"amountField"==n.payload.fieldName&&n.payload.value){var o=t().FormFieldData.rollupEntity;(function(e,t){return new Promise((function(n,r){var o=i.getCrmDataAccessInstance();if(o)if(t){var a={name:t,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""};o.cdsResolver.resolveFieldsMetadata(a).then((function(t){var r=t.find((function(t){return t.CalculationOf==e}));r?n(r.name):(n(e),console.warn("Couldnt find base amount field for the selected field"))}))}else r("EntityName not defined");else r("CRMDataAccess not defined")}))})(n.payload.value,o).then((function(t){e(r.UpdateColumnInfoField(n.payload.colId,"amountBaseField",t))})).catch((function(e){console.warn("Error while fetching amount base field - "+e)}))}return e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(82),i=n(228);t.previewGridColumnReorderMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@PreviewGrid/Reorder"==n.type){var o=r.GetPreviewGridColumnList_FromState(t()),a=o[n.payload.dragIndex].id,s=o[n.payload.targetIndex].id;e(i.ReorderColumnsWithId(a,s))}return e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),i=n(119),o=n(43),a=n(15);t.siAvailabilityMiddleware=function(e){var t=e.getState;return function(e){return function(n){return"@@CrmOrgInfo/TriggerUpdateSIPackageStatus"==n.type&&function(e,t){var n=r.getCrmDataAccessInstance();if(!n)return void a.logWarning("fetchSIPackageStatus","CrmDataAccess object is null. Unable to fetch SI Package Status");n.siDataAccess.isSIPackageInstalled().then((function(e){t(i.UpdateSIPackageStatus(e))}),(function(e){a.logError("An error occurred while fetching the SI Package status: ",e,"")}))}(0,e),"@@CrmOrgInfo/TriggerUpdateSILicenseAvailable"==n.type&&function(e,t){var n=r.getCrmDataAccessInstance();if(!n)return void a.logWarning("fetchSILicenseAvailableStatus","CrmDataAccess object is null. Unable to fetch SI License Status");n.siDataAccess.isSILicenseAvailable().then((function(r){t(i.UpdateSILicenseAvailableStatus(r));var a=e();r&&a.FormFieldData&&a.FormFieldData.id&&n.forecastConfigAccess.fetchPredictionStatusForFC(a.FormFieldData.id).then((function(e){t(o.UpdateFCPredictionStatus(e))}))}))}(t,e),"@@CrmOrgInfo/TriggerUpdateFeatureState"==n.type&&function(e,t){var n=r.getCrmDataAccessInstance();if(!n)return void a.logWarning("fetchAndSetFeatureState","CrmDataAccess object is null. Unable to fetch geo feature state");n.siDataAccess.getFeatureEnablementState().then((function(e){t(i.UpdateFeatureState(e))}))}(0,e),e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=n(16),o=n(105),a=n(53),s=n(82);t.columnInfoEditsMiddleware=function(e){var t=e.getState;return function(e){return function(n){var l,c,u,d=t();if("@@FormData/UpdateColumnInfoField"==n.type&&"title"==n.payload.fieldName&&!t().columnEditorState.hasUniqueNameBeenEdited){var p=o.filterNonValidCharactersForUniqueName(n.payload.value);e(r.UpdateColumnInfoField(n.payload.colId,"uniqueName",p))}if("@@FormData/UpdateColumnInfoField"==n.type&&"columnType"==n.payload.fieldName&&(n.payload.value==i.ForecastColumnType.Calculated&&e(r.UpdateColumnInfoField(n.payload.colId,"calculatedFieldExpression","")),n.payload.value==i.ForecastColumnType.Rollup&&e(r.UpdateColumnInfoField(n.payload.colId,"dataType",i.ForecastColumnDataType.Currency)),n.payload.value==i.ForecastColumnType.HierarchySecondary&&e(r.UpdateColumnInfoField(n.payload.colId,"hierarchyAttributeInfo",null))),"@@FormData/UpdateColumnInfoField"==n.type&&"hierarchyAttributeInfo"==n.payload.fieldName){var _=n.payload.value;"LookupType"==s.GetHierarchyAttributeInfoType_FromState(_.attributeName,t())&&(l=_.attributeName,c=_.relationship.entityName,u=a.getCrmDataAccessInstance(),new Promise((function(e,t){u.cdsClient.then((function(n){return n.fetchEntityAndRelatedEntityMetadata({entityName:c}).then((function(r){var i=r.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName==l}));if(null!=i&&null!=i.Targets&&i.Targets.length>0){var o=i.Targets[0];n.fetchEntityAndRelatedEntityMetadata({entityName:o}).then((function(t){var n={attributeName:t.PrimaryNameAttribute,relationship:{entityName:c,linkedByAttribute:null,relationship:{entityName:o,linkedByAttribute:l,relationship:null}}};e(n)}))}else t()}))}))}))).then((function(t){e(r.UpdateColumnInfoField(n.payload.colId,"hierarchyAttributeInfo",t))}))}if("@@FormData/UpdateColumnInfoField"==n.type&&"dataType"==n.payload.fieldName&&n.payload.value!==i.ForecastColumnDataType.Currency){var E=d.FormFieldData.columns.find((function(e){return e.id==n.payload.colId}));E&&E.showProgressComparedToQuota&&e(r.UpdateColumnInfoField(n.payload.colId,"showProgressComparedToQuota",!1))}return e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(109),i=n(53),o=n(119),a=n(15),s=n(98),l=n(87),c=n(138),u=n(43);t.hierarchyEntitiesMetadataFetcherMiddleware=function(e){var t=e.getState;return function(e){return function(i){if("@@FormData/UpdateFieldValue"==i.type&&(i.payload.data.hierarchyEntity||i.payload.data.rollupEntity)){var o={hierarchyRelationship:void 0};e(u.UpdateFieldValue(o))}if("@@FormData/UpdateFieldValue"==i.type&&i.payload.data.hierarchyRelationship)for(var a=t(),s=JSON.parse(JSON.stringify(i.payload.data.hierarchyRelationship));null!=s;)r.IsEntityMetadataAvailable_InState(a,s.entityName)?s.entityName==a.FormFieldData.hierarchyEntity&&d(a,e):n(a,s.entityName,e),s=s.relationship;if("@@FCList/UpdateMetadata"==i.type){a=t();for(var p=[],_=i.payload.forecastConfigList,E=0;E<_.length;E++){var S=_[E].rollupEntity,f=_[E].hierarchyEntity;p.includes(S)||p.push(S),p.includes(f)||p.push(f)}for(E=0;E<p.length;E++)r.IsEntityMetadataAvailable_InState(a,p[E])||n(a,p[E],e)}if("@@Metadata/SetEntityMetadata"==i.type&&void 0!==i.payload.value[t().FormFieldData.hierarchyEntity]){var C=e(i);return d(a=t(),e),C}return"@@Utility/OnOkErrorDialogClick"==i.type&&t().genericErrorDialogState.dialogType==l.IErrorDialogType.HierarchyRelationsDoesntExistDialog&&function(e){c.NavigationHandlerFactory.GetNavigationHandlerObject(e).OpenGridPage()}(e),e(i)}};function n(e,t,n){return new Promise((function(e,r){var s=i.getCrmDataAccessInstance();if(!s){var l="CrmDataAccess object is null. Unable to fetch entity metadata: "+t;console.warn(l),r(l)}s.cdsResolver.cdsClient.then((function(r){r.fetchEntityAndRelatedEntityMetadata({entityName:t}).then((function(r){n(o.SetEntityMetadata(t,r)),e(!0)}))})).catch((function(e){a.logError("Delphi-Config entity metadata",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",t),r(e)}))}))}function d(e,t){0==r.isEntityHierarchyRelationshipConfigured(e)&&t(s.onErrorShowDialogActionCreator(l.IErrorDialogType.HierarchyRelationsDoesntExistDialog,r.getHierarchyRelationshipNotConfiguredErrorMessage(e)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),i=n(109),o=n(177);t.securityRolesFetcherMiddleware=function(e){var t=e.getState,n=e.dispatch;return function(e){return function(a){return"@@OrgSecurityRoles/TriggerFetchSecurityRoles"!=a.type||i.areRolesFetched_FromState(t())||function(e,t){var n=[];e.getRoles().then((function(e){n=e.map((function(e){return{roleId:e.roleId,roleName:e.roleName}})),t(o.SetSecurityRolesListInState(n))})).catch((function(){t(o.SetSecurityRolesListInState(n))}))}(r.getCrmDataAccessInstance().roleDataAccess,n),e(a)}}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(16),o=n(43),a=n(41),s=n(109),l=n(44),c=n(225);function u(e){if(null!=e.FormFieldData.permissionsData){var t=c.IsPermissionTypeConfigured_FromState(i.PermissionType.User,e);return r({},e.FormFieldData.permissionsData,{permissionTypes:t?[i.PermissionType.User]:[]})}return null}function d(e,t){return null==e.FormFieldData.permissionsData?{permissionTypes:[t],permissionAttribueInfo:null,permissionRoles:null}:r({},e.FormFieldData.permissionsData,{permissionTypes:E(t,e)})}function p(e,t){return null==t.FormFieldData.permissionsData.permissionRoles?[{roleId:e,roleName:""}]:-1==t.FormFieldData.permissionsData.permissionRoles.findIndex((function(t){return t.roleId==e}))?t.FormFieldData.permissionsData.permissionRoles.concat([{roleId:e,roleName:""}]):t.FormFieldData.permissionsData.permissionRoles}function _(e,t){if(null!=t.FormFieldData.permissionsData.permissionRoles){var n=[];return t.FormFieldData.permissionsData.permissionRoles.forEach((function(t){t.roleId!=e&&n.push(r({},t))})),n}return null}function E(e,t){var n=c.IsPermissionTypeConfigured_FromState(i.PermissionType.User,t),r=t.FormFieldData.permissionsData.permissionTypes.slice();switch(e){case i.PermissionType.User:n||(r=r.concat([e]));break;case i.PermissionType.Role:case i.PermissionType.All:r=n?[i.PermissionType.User,e]:[e]}return r}function S(e,t){if(c.IsPermissionTypeConfigured_FromState(e,t)){var n=[];return t.FormFieldData.permissionsData.permissionTypes.forEach((function(t){t!=e&&n.push(t)})),n}return t.FormFieldData.permissionsData.permissionTypes}function f(e,t,n){n(o.UpdateFieldValue({permissionsData:e})),function(e,t,n){var r=a.ForecastingBusinessLogicProvider.getColumnForPermissionsAttribute(e),i=c.doesPermissionColumnExist(t.FormFieldData.columns);if(r){var o=e.permissionAttribueInfo,u=s.getAttributeDisplayName(o.relationship.entityName,o.attributeName,t);if(u&&(r.title=u||r.title),i){var d=c.getPermissionsColumnId(t);n(l.ReplaceColumn(d,r))}else n(l.AddColumn(r))}else i&&n(l.DeleteColumn(c.getPermissionsColumnId(t)))}(e,t,n)}function C(e,t){return{attributeName:e,relationship:{entityName:t.FormFieldData.hierarchyEntity,linkedByAttribute:null,relationship:null}}}t.permissionDataMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@PermissionsData/UpdatePermissionData"==n.type){var a=t();f(n.payload.permissionsData,a,e)}else if("@@PermissionsData/UpdatePermissionsAttribute"==n.type){f(s=function(e,t){var n,o=e.payload.attributeName;n=null!=o?null==t.FormFieldData.permissionsData?{permissionTypes:[i.PermissionType.User],permissionAttribueInfo:C(o,t),permissionRoles:null}:r({},t.FormFieldData.permissionsData,{permissionTypes:E(i.PermissionType.User,t),permissionAttribueInfo:C(o,t)}):t.FormFieldData.templateType==i.ForecastConfigTemplateType.Custom&&e.isInternal?{permissionTypes:[],permissionAttribueInfo:null,permissionRoles:null}:r({},t.FormFieldData.permissionsData,{permissionTypes:S(i.PermissionType.User,t),permissionAttribueInfo:null});return n}(n,a=t()),a,e)}else if("@@PermissionsData/AddPermissionsRoleAction"==n.type){a=t();var s=function(e,t){var n;n=null==t.FormFieldData.permissionsData?{permissionTypes:[i.PermissionType.Role],permissionAttribueInfo:null,permissionRoles:[{roleId:e,roleName:""}]}:r({},t.FormFieldData.permissionsData,{permissionTypes:E(i.PermissionType.Role,t),permissionRoles:p(e,t)});return n}(n.payload.roleId,a);e(o.UpdateFieldValue({permissionsData:s}))}else if("@@PermissionsData/DeletePermissionsRoleAction"==n.type){if(null!=(a=t()).FormFieldData.permissionsData){s=function(e,t){return r({},t.FormFieldData.permissionsData,{permissionRoles:_(e,t)})}(n.payload.roleId,a);e(o.UpdateFieldValue({permissionsData:s}))}}else if("@@PermissionsData/SetAdditionalViewingPermissionTypeAction"==n.type){a=t();null==n.payload.type?e(o.UpdateFieldValue({permissionsData:u(a)})):n.payload.type!=i.PermissionType.All&&n.payload.type!=i.PermissionType.Role||e(o.UpdateFieldValue({permissionsData:d(a,n.payload.type)}))}return e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=n(16),o=n(857);t.chartValuesForColumnMiddleware=function(e){var t=e.getState;return function(e){return function(s){var l=t();if("@@FormData/AddColumn"==s.type){var c=s.payload.column,u=a(c,l);c.colorCode=u.colorCode,c.showInTrendChart=u.showInTrendChart}else if("@@FormData/UpdateColumnInfoField"==s.type){if("columnType"==s.payload.fieldName)n(d=l.FormFieldData.columns.find((function(e){return e.id==s.payload.colId})),(u=a(d,l,s.payload.value)).colorCode,u.showInTrendChart,s,e);else if("optionSetValue"==s.payload.fieldName){if("msdyn_forecastcategory"==l.FormFieldData.forecastCategoryAttributeName){var d=l.FormFieldData.columns.find((function(e){return e.id==s.payload.colId})),p=o.fetchColorAndTrendChartValuesForFCOptionSet(l,s.payload.value);n(d,p.colorCode,p.showInTrendChart,s,e)}}else if("dataType"==s.payload.fieldName){if(s.payload.value!==i.ForecastColumnDataType.Currency)(d=l.FormFieldData.columns.find((function(e){return e.id==s.payload.colId})))&&d.showInTrendChart&&e(r.UpdateColumnInfoField(s.payload.colId,"showInTrendChart",!1))}}return e(s)}};function n(e,t,n,i,o){e&&(e.showInTrendChart!==n&&o(r.UpdateColumnInfoField(i.payload.colId,"showInTrendChart",n)),e.colorCode!==t&&o(r.UpdateColumnInfoField(i.payload.colId,"colorCode",t)))}function a(e,t,n){var r="",a=!1,s={};if(e){var l=n||e.columnType;if(l==i.ForecastColumnType.Rollup&&"msdyn_forecastcategory"==t.FormFieldData.forecastCategoryAttributeName){var c=o.fetchColorAndTrendChartValuesForFCOptionSet(t,e.optionSetValue);r=c.colorCode,a=c.showInTrendChart}else l!=i.ForecastColumnType.Calculated&&l!=i.ForecastColumnType.Rollup||(r=o.fetchColorCodeForColumn(t))}return s.colorCode=r,s.showInTrendChart=a,s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=["#FCE100","#FFAA44","#7A7574","#E3008C","#00B7C3","#A4262C","#0078d4"];function o(e){var t=e.FormFieldData.columns,n=e.FormFieldData.forecastCategoryAttributeName,o=[];t.forEach((function(e){e.colorCode&&(e.columnType==r.ForecastColumnType.Calculated||e.columnType==r.ForecastColumnType.Rollup&&"msdyn_forecastcategory"!==n)&&o.push(e.colorCode)}));for(var a=0;a<i.length;a++)if(!o.includes(i[a]))return i[a];return i[Math.floor(Math.random()*i.length)]}t.fetchColorCodeForColumn=o,t.fetchColorAndTrendChartValuesForFCOptionSet=function(e,t){var n="",r=!1,i={};switch(t){case 100000001:n="#BD8608";break;case 100000002:n="#009EB3",r=!0;break;case 100000003:n="#18A03C",r=!0;break;case 100000004:n="#750985";break;case 100000005:n="#8CBD18",r=!0;break;case 100000006:n="#E04854";break;default:n=o(e),r=!1}return i.colorCode=n,i.showInTrendChart=r,i}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(53),a=n(43);function s(e,t,n){e&&"opportunity"==e?t.find((function(e){return"bf649add-6c30-ea11-a813-000d3a5475f7"==e.id}))?n.rollupEntityDefaultView="bf649add-6c30-ea11-a813-000d3a5475f7":t.find((function(e){return"00000000-0000-0000-00aa-000000666800"==e.id}))&&(n.rollupEntityDefaultView="00000000-0000-0000-00aa-000000666800"):n.rollupEntityDefaultView=t[0].id}t.viewListFetcherMiddleware=function(e){var t=this,n=e.getState;return function(e){return function(l){return r(t,void 0,void 0,(function(){var t,r,c,u,d;return i(this,(function(i){if("@@FormData/UpdateFieldValue"==l.type&&l.payload.data.rollupEntity){if(t=e(l),r=n(),c=l.payload.data.rollupEntity,u={},null==r.rollupEntityViewList[c]||0==r.rollupEntityViewList[c].length){if(!(d=o.getCrmDataAccessInstance()))return console.warn("CrmDataAccess object is null. Unable to fetch views"),[2];d.crmMetadataAccess.getGridViewDefinitions(c).then((function(t){null!=t&&t.length>0&&(s(c,t,u),c!=r.FormFieldData.rollupEntity||r.FormFieldData.rollupEntityDefaultView!==u.rollupEntityDefaultView?e(a.UpdateFieldValue(u)):null!=r.FormFieldData.rollupEntityDefaultView&&""!=r.FormFieldData.rollupEntityDefaultView||e(a.UpdateFieldValue(u)),e(a.updateViewList(c,t)))}))}else r.FormFieldData.rollupEntityDefaultView!==r.rollupEntityViewList[c][0].id&&(s(c,r.rollupEntityViewList[c],u),e(a.UpdateFieldValue(u)));return[2,t]}return[2,e(l)]}))}))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(16),o=n(44),a=n(177);t.selectorChangeTriggerRelatedCleanupMiddleware=function(e){var t=e.getState;return function(e){return function(n){var s;"@@FormData/UpdateFieldValue"==n.type&&n.payload.data.hierarchyEntity&&((l=t()).FormFieldData.templateType==i.ForecastConfigTemplateType.Custom&&l.FormFieldData.hierarchyEntity&&l.FormFieldData.hierarchyEntity!==n.payload.data&&(e(a.UpdatePermissionsAttribute(null,!0)),e(o.ClearHierarchySecondaryColumns())));if("@@HierarchyEntity/DetermineDialogFromState"==n.type&&n.payload.data){var l=t();if(n.payload.data!==l.FormFieldData.hierarchyEntity)if(n.payload.data!==l.FormFieldData.hierarchyEntity&&(l.FormFieldData.permissionsData&&l.FormFieldData.permissionsData.permissionAttribueInfo&&""!=l.FormFieldData.permissionsData.permissionAttribueInfo.attributeName||l.FormFieldData.columns.filter((function(e){return e.columnType==i.ForecastColumnType.HierarchySecondary})).length>0))e(r.onHierarchyEntityActionCreator(!1,n.payload.data));else{var c=((s={}).hierarchyEntity=n.payload.data,s);e(r.UpdateFieldValue(c,n.context))}}return e(n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53),i=n(119),o=n(98),a=n(87),s=n(8),l=n(7),c=n(174),u=n(226);t.orgSettingsMiddleware=function(e){var t=e.getState,n=e.dispatch;return function(e){return function(d){return"@@CrmOrgInfo/TriggerFetchOrgSettings"==d.type&&!1===function(e){return""!==e().crmOrgInfo.calenderStartDate}(t)?function(e,t){e.getOrgSettings().then((function(e){var n=e.ismanualsalesforecastingenabled||u.XrmHelper.isFCBEnabled("April2020Update");t(i.UpdateOrgFiscalCalenderStartDate(e.fiscalcalendarstart)),t(i.UpdateManualForecastingEnabledSettings(n))})).catch((function(){t(o.onErrorShowDialogActionCreator(a.IErrorDialogType.FetchingOrgDetailsFailed))}))}(r.getCrmDataAccessInstance().organizationDataAccess,n):"@@CrmOrgInfo/EnableManualForecastingAdminSettingsAction"==d.type&&function(e,t){e.enableManualForecastingAdminSettings().then((function(e){t(i.UpdateManualForecastingEnabledSettings(e)),c.showOrHideCrmLoaading(!1,l.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_LOADING))})).catch((function(e){e&&"0x80040220"===e.code?t(o.onErrorShowDialogActionCreator(a.IErrorDialogType.EnableMFAdminSettingsFailedDialog,l.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.MF_ADMIN_SETTINGS_ENABLE_FAILED_PRIVILEGE_MESSAGE))):t(o.onErrorShowDialogActionCreator(a.IErrorDialogType.EnableMFAdminSettingsFailedDialog)),c.showOrHideCrmLoaading(!1,l.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_LOADING))}))}(r.getCrmDataAccessInstance().organizationDataAccess,n),e(d)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15);t.formsProSurveyMiddleware=function(e){return e.getState,function(e){return function(t){var n,i,o;return"@@EditApp/FormsProSurveyDisplay"==t.type&&t.payload.triggerSource&&(n=t.payload.triggerSource,i=window.location.origin,o=new CesLib(i,"forecastingadminsurvey"),r.logInfo("FormsProSurveyMiddleware-callTriggerAndValidateEligibility-start","callTriggerAndValidateEligibility-Started",{},"Network-Started"),o.callTriggerAndValidateEligibilityAPI("forecastingadminpageevent").then((function(e){if(e){var t=new SurveyEmbed(e,"https://forms.office.com/formspro/","https://mfpembedcdnmsit.azureedge.net/mfpembedcontmsit/","true"),i=window.Xrm.Utility.getGlobalContext(),a=i.userSettings&&i.userSettings.userId&&i.userSettings.userId.toString().replace(/[{}]/g,""),s="";i&&i.userSettings&&i.userSettings.languageId&&(s=o.getLanguageCode(i.userSettings.languageId));var l={locale:s,UserId:a,OrganizationId:i.organizationSettings.organizationId,Culture:s,UrlReferrer:window.location.href,ProductContext:"Forecasting",TriggerSource:n};t.renderPopup(l),r.logInfo("FormsProSurveyMiddleware-callTriggerAndValidateEligibility-end","Displayed survey to the user, call completed",{orgId:l.OrganizationId,TriggerSource:l.TriggerSource})}else r.logInfo("FormsProSurveyMiddleware-callTriggerAndValidateEligibility-end","Validating eligibility for the survey call completed",{})})).catch((function(e){r.logError("FormsProSurveyMiddleware-callTriggerAndValidateEligibility-end",e,"callTriggerAndValidateEligibility")}))),e(t)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(502),o=n(44),a=n(98),s=n(87),l=n(7),c=n(8),u=function(){function e(e,t){void 0===t&&(t=void 0),this.dispatch=e,this.getState=t,this.navigationHandlers=new i.ReduxNavigationHandler(e)}return e.prototype.showGridPage=function(){this.navigationHandlers.OpenGridPage()},e.prototype.showEditPage=function(e){e?this.navigationHandlers.OpenEditPage(e):this.dispatch(a.onErrorShowDialogActionCreator(s.IErrorDialogType.ForecastConfigFormLoadError,l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_FORM_LOAD_ERROR_MISSING_FCID)))},e.prototype.showCreatePage=function(e){if(e){var t=Number(e);t!=r.ForecastConfigTemplateType.OrgChart&&t!=r.ForecastConfigTemplateType.TerritoryBased&&t!=r.ForecastConfigTemplateType.Custom&&this.dispatch(a.onErrorShowDialogActionCreator(s.IErrorDialogType.ForecastConfigFormLoadError,l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_FORM_LOAD_ERROR_INVALID_TEMPLATE_TYPE))),this.navigationHandlers.OpenCreatePage(t)}else this.dispatch(a.onErrorShowDialogActionCreator(s.IErrorDialogType.ForecastConfigFormLoadError,l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_FORM_LOAD_ERROR_MISSING_TEMPLATE_TYPE)))},e.prototype.SetPredictiveAvailabilityState=function(e){this.dispatch(o.UpdatePredictiveAvailabilityState(e))},e.prototype.updateCrmDataAccess=function(e){},e.prototype.updateUCIActionsObject=function(e){},e.prototype.showPredictivePage=function(){this.navigationHandlers.OpenPredictivePage()},e}();t.DelfiConfigActions=u},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0));n(864);var o=n(390),a=n(23),s=n(869),l=n(53),c={};t.default=function(){var e=o.store.getState().crmOrgInfo.clientUrl,t=o.store.getState().crmOrgInfo.orgId;null==c[e]&&(c[e]=l.createCrmDataAccessFromCrmUrl(e,t));var n=c[e];return l.setCrmDataAccessInstsance(n),i.default.createElement("div",{className:"DelfiConfigApp"},i.default.createElement(a.Provider,{store:o.store},i.default.createElement(s.ConnectedMainAppContainer,{crmDataAccess:n})))}},function(e,t,n){var r=n(865);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".DelfiConfigApp {\n  /* padding: 20px; */\n  background-color: white;\n  color: #323130 !important;\n  overflow-y: auto; }\n",""])},,,,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(45),l=n(23),c=n(163),u=n(870),d=n(1231),p=n(1259),_=n(119),E=n(1262),S=n(177);s.initializeIcons();var f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.componentDidMount=function(){this.props.triggerFetchOrgSettings()},t.prototype.render=function(){var e=void 0;return e=this.props.isPredictivePageOpened?a.default.createElement(p.ConnectedSIGridApp,{crmDataAccess:this.props.crmDataAccess}):this.props.isEditPageOpened?a.default.createElement(u.ConnectedEditApp,{crmDataAccess:this.props.crmDataAccess}):a.default.createElement(d.ConnectedGridApp,{crmDataAccess:this.props.crmDataAccess}),a.default.createElement("div",{className:"MainAppContainer"},e,a.default.createElement(E.ConnectedForecastConfigGenericErrorDialog,null))},t}(a.default.Component);t.default=f;t.ConnectedMainAppContainer=l.connect((function(e){return{isEditPageOpened:e.mainPageType==c.IMainPageType.EditPage,isPredictivePageOpened:e.mainPageType==c.IMainPageType.PredictivePage}}),(function(e){return{triggerFetchOrgSettings:function(){e(_.TriggerFetchOrgSettings()),e(S.TriggerFetchSecurityRolesList()),e(_.TriggerUpdateSIPackageStatus()),e(_.TriggerUpdateSILicenseAvailableStatus()),e(_.TriggerUpdateFeatureState())}}}))(f)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(871),l=n(16),c=n(1166),u=n(363),d=n(45),p=n(1169),_=n(1172);n(1175);var E=n(1177),S=n(97),f=n(1206),C=n(1211),m=n(623),g=n(1216),T=n(1217),I=n(41),h=n(174),A=n(7),y=n(8),R=n(110),D=n(1225),O=n(22),F=n(175),N=n(96);d.initializeIcons();var P=function(e){function t(t){var n=e.call(this,t)||this;return n.renderStageForm=function(){return n.props.activeStage==S.ForecastConfigStage.Quota?a.default.createElement(T.ConnectedStage3Form,{key:"stage3"}):n.props.activeStage==S.ForecastConfigStage.General?a.default.createElement(s.ConnectedStage1Form,{crmDataAccess:n.props.crmDataAccess}):n.props.activeStage==S.ForecastConfigStage.Permission?a.default.createElement(D.ConnectedStagePermissionsForm,{crmDataAccess:n.props.crmDataAccess}):a.default.createElement(E.ConnectedStage2Form,{crmDataAccess:n.props.crmDataAccess})},n.renderWarningForSIPackage=function(){return a.default.createElement(O.MessageBar,{messageBarType:O.MessageBarType.warning,isMultiline:!1,dismissButtonAriaLabel:"Close",onDismiss:function(){n.setState({isMessageDismissed:!0})}},A.GlobalLocalizedStringsProvider.GetString(y.STRING_KEYS.SI_PACKAGE_NOTINSTALLED),a.default.createElement(O.Link,{onClick:function(){F.CrmNavigationHelpers.navigateToCustomControl("MscrmControls.UnifiedConfigCustomControl.UnifiedConfigCustomControl")}},A.GlobalLocalizedStringsProvider.GetString(y.STRING_KEYS.SI_LEARN_MORE)))},n.state={isMessageDismissed:!1},n.stageContainerDivRef=void 0,n}return i(t,e),t.prototype.componentDidUpdate=function(e){this.props.activeStage!==e.activeStage&&void 0!==this.stageContainerDivRef&&null!==this.stageContainerDivRef&&void 0!==this.stageContainerDivRef.scrollTop&&(this.stageContainerDivRef.scrollTop=0)},t.prototype.componentDidMount=function(){var e=this;h.showOrHideCrmLoaading(!0,A.GlobalLocalizedStringsProvider.GetString(y.STRING_KEYS.FC_LOADING));var t=this.getFormLoadInput(),n=N.createNewContext("fc-edit-form-load");this.props.formEventsHandler.RefreshForm(t,n).then((function(t){t.status!=l.IForecastConfigStatus.Draft&&e.props.formEventsHandler.UpdateStepperStage(I.ForecastingBusinessLogicProvider.GetStageStepId(S.ForecastConfigStage.Quota)),h.showOrHideCrmLoaading(!1)}))},t.prototype.getFormLoadInput=function(){return this.props.formData.id.length>0?{formType:R.FormType.EditForm,formInput:{fcId:this.props.formData.id,siLicenseAvailable:this.props.isSILicenseAvailable}}:{formType:R.FormType.CreateForm,formInput:{templateType:this.props.formData.templateType}}},t.prototype.setStageContainerRef=function(e){this.stageContainerDivRef=e},t.prototype.render=function(){return a.default.createElement("div",{className:"editPageApp"},a.default.createElement("div",null,!this.props.isSILicenseAvailable||this.props.isSIPackageInstalled||this.state.isMessageDismissed?null:this.renderWarningForSIPackage()),a.default.createElement("div",null,a.default.createElement(C.ConnectedEditAppRibbon,null)),a.default.createElement("div",{className:"formSectionDivider"}),a.default.createElement("div",{className:"titleContainer"},a.default.createElement(c.ConnectedTitleEditor,{crmDataAccess:this.props.crmDataAccess}),a.default.createElement("div",null,a.default.createElement(f.ConnectedEditAppStatusInfo,null))),a.default.createElement("div",{className:"stepperContainer"},a.default.createElement(p.ConnectedDelphiStepperControl,null)),a.default.createElement("div",{style:{marginTop:16},className:"sectionDividerShadow"}),a.default.createElement("div",{ref:this.setStageContainerRef.bind(this),className:"stageAndFooterContainer"},a.default.createElement("div",{className:"stageContainer"},this.renderStageForm()),a.default.createElement("div",{className:"stepperButtonFooterStyle"},a.default.createElement(_.ConnectedDelphiStepperButton,null))),a.default.createElement(m.ConnectedForecastConfigGridConfirmationDialog,null),a.default.createElement(g.ConnectedUpdateHierarchySelectionConfirmationDialog,null))},t}(a.default.Component);t.default=P,t.ConnectedEditApp=u.ConnectedFormGenerator(P)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(0)),c=a(n(872)),u=n(110),d=s(n(363));n(1152);var p=n(1154),_=n(7),E=n(8),S=a(n(364)),f=n(16),C=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){return l.default.createElement("div",null,this.renderStage1())},t.prototype.renderStage1=function(){return l.default.createElement("div",null,l.default.createElement("div",{className:"sectionHeader"},_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_CONFIGURATION_SECTION_HEADER_STAGE1)),l.default.createElement("div",{className:"sectionSubtitle"},_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_CONFIGURATION_SECTION_SUBTITLE_STAGE1)),l.default.createElement("div",{className:"configurationWrapper"},l.default.createElement("div",{className:"configurationSecEntitySelection"},l.default.createElement("div",null,this.renderRollupEntity()),l.default.createElement("div",{style:{marginTop:24}},this.renderHierarchyEntity()),l.default.createElement("div",{style:{marginTop:24}},this.renderHierarchyRoute()),l.default.createElement("div",{style:{marginTop:24}},this.renderTopOfHierarchy()),l.default.createElement("div",{style:{marginTop:24}},this.renderRollupViewSelector())),this.renderHierarchyPreview()),l.default.createElement("div",{style:{marginTop:32}}),l.default.createElement("div",{className:"sectionHeader"},_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_SCHEDULING_SECTION_HEADER_STAGE1)),l.default.createElement("div",{className:"sectionSubtitle"},_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_SCHEDULING_SECTION_SUBTITLE_STAGE1)),l.default.createElement("div",{className:"schedulingWrapper"},l.default.createElement("div",{className:"periodSelector"},this.renderForecastPeriodSelector()),l.default.createElement("div",{className:"yearSelector"},this.renderYearSelector()),l.default.createElement("div",{className:"startAt"},this.renderStartsAt()),l.default.createElement("div",{className:"numRec"},this.renderNumRecurrences()),l.default.createElement("div",{className:"validFrom"},this.renderValidFrom()),l.default.createElement("div",{className:"validTo"},this.renderValidTo())))},t.prototype.renderHierarchyEntity=function(){var e=u.ICrmAttributeType.EntityPicker,t=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_HIERARCHY_ENTITY_SELECTOR_LABEL_STAGE1),n=this.props.formData.templateType!=f.ForecastConfigTemplateType.Custom;return this.renderFormControl("hierarchyEntity","hierarchyEntity","forecastconfiguration",e,t,!1,n,{entityType:"hierarchial"})},t.prototype.renderHierarchyRoute=function(){var e=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_HIERARCHY_ROUTE_FIELD_LABEL),t=this.props.formData.rollupEntity,n=u.ICrmAttributeType.Lookup,r=this.generateCommonFormControlProps("hierarchyRelationship","hierarchyRelationship",t,n,!1,this.props.isFormLocked,e),i=o({},r,{hierarchyEntity:this.props.formData.hierarchyEntity,hierarchyRelationship:this.props.formData.hierarchyRelationship});return l.default.createElement(S.default,o({},o({},r,{labelText:e})),l.default.createElement(c.default,o({},i)))},t.prototype.renderRollupEntity=function(){var e=u.ICrmAttributeType.EntityPicker,t=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_ROLLUP_ENTITY_STAGE1);return this.renderFormControl("rollupEntity","rollupEntity","forecastconfiguration",e,t,!1,!0)},t.prototype.renderRollupViewSelector=function(){var e=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_ROLLUP_ENTITY_VIEWSELECTOR_LABEL),t=this.props.formData.rollupEntity,n=u.ICrmAttributeType.ViewPicker;return this.renderFormControl("rollupEntityDefaultView","rollupEntityDefaultView",t,n,e,!1,!1,{viewDict:this.props.rollupEntityViewList[t]})},t.prototype.renderTopOfHierarchy=function(){var e=this.props.formData.hierarchyEntity,t=u.ICrmAttributeType.Lookup,n=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_TOP_OF_HIERARCHY2_STAGE1);return this.renderFormControl("topOfHierarchy","",e,t,n,!1)},t.prototype.renderHierarchyPreview=function(){return l.default.createElement("div",{className:"hierarchyPreviewSection"},l.default.createElement("span",{className:"hierarchyPreviewTitle"},_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_PREVIEW_GRID_HEADING_STAGE2)),l.default.createElement("div",{className:"hierarchyPreview"},l.default.createElement(p.ConnectedHierarchyPreview,null)))},t.prototype.renderForecastPeriodSelector=function(){var e=u.ICrmAttributeType.OptionSet,t=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_FORECAST_PERIOD_STAGE1);return this.renderFormControl("period","msdyn_periodtype","msdyn_forecastconfiguration",e,t,!1)},t.prototype.renderYearSelector=function(){var e=u.ICrmAttributeType.OptionSet,t=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_FISCAL_YEAR_STAGE1);return this.renderFormControl("fiscalyear","msdyn_startingfiscalyear","msdyn_forecastconfiguration",e,t,!1)},t.prototype.renderNumRecurrences=function(){var e,t,n=u.ICrmAttributeType.NumberPicker,r=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_NUMBER_OF_PERIODS_STAGE1),i=((e={}).maxValue=4,e);return""+this.props.formData.period=="0"&&((t={}).maxValue=12,i=t),this.renderFormControl("numberOfRecurrences","numberOfRecurrences","forecastconfiguration",n,r,!1,!1,i)},t.prototype.renderStartsAt=function(){return""+this.props.formData.period=="0"?this.renderStartsAtMonth():this.renderStartsAtQuater()},t.prototype.renderStartsAtMonth=function(){var e,t=u.ICrmAttributeType.OptionSet,n=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_FORECAST_START_AT_STAGE1),r=((e={}).sortByDisplayName=!1,e);return this.renderFormControl("startAtMonth","msdyn_startingfiscalmonth","msdyn_forecastconfiguration",t,n,!1,!1,r)},t.prototype.renderStartsAtQuater=function(){var e=u.ICrmAttributeType.OptionSet,t=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_FORECAST_START_AT_STAGE1);return this.renderFormControl("startAtQuater","msdyn_startingfiscalquarter","msdyn_forecastconfiguration",e,t,!1)},t.prototype.renderValidFrom=function(){var e=u.ICrmAttributeType.DatePicker,t=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_VALID_FROM_STAGE1);return this.renderFormControl("fromDate","msdyn_startdate","msdyn_forecastconfiguration",e,t,!1,!0)},t.prototype.renderValidTo=function(){var e=u.ICrmAttributeType.DatePicker,t=_.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_VALID_TO_STAGE1);return this.renderFormControl("toDate","msdyn_validto","msdyn_forecastconfiguration",e,t,!1,!0)},t}(d.default);t.default=C,t.ConnectedStage1Form=d.ConnectedFormGenerator(C)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=s(n(0)),c=n(89),u=n(45),d=n(7),p=n(8),_=s(n(1140)),E=n(41),S=n(15);u.initializeIcons();var f=function(e){function t(t){var n=e.call(this,t)||this;return n.isEndLogged=!1,n.isStartLogged=!1,n.state={entityAttributes:{},oneToManyRelation:{}},n}return i(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){var e,t,n,r;return a(this,(function(i){switch(i.label){case 0:return this.isStartLogged||(S.logUsage("CrmCustomAttributePickerControl","initialize-start",{rollupEntity:this.props.attributeInfo.entityName,hierarchyEntity:this.props.hierarchyEntity},"initialize-start"),this.isStartLogged=!0),this.getOrgEntites(),this.props.attributeInfo.entityName&&!this.state.entityAttributes[this.props.attributeInfo.entityName]&&this.fetchEntityAttributes(this.props.attributeInfo.entityName),this.props.hierarchyEntity&&!this.state.entityAttributes[this.props.hierarchyEntity]&&this.fetchEntityAttributes(this.props.hierarchyEntity),this.props.hierarchyRelationship&&this.props.hierarchyRelationship.relationship&&this.fetchEntityAttributes(this.props.hierarchyRelationship.relationship.entityName),[4,this.props.crmDataAcces.organizationDataAccess.getHierarchialEntities()];case 1:return e=i.sent(),t=e.map((function(e){return e.LogicalName})),this.setState({hierarchialEntities:t}),this.props.attributeInfo.entityName&&this.props.hierarchyEntity&&(n=this.props.attributeInfo.entityName,r=this.props.hierarchyEntity,this.getRelationships(n,r)),[2]}}))}))},t.prototype.componentDidUpdate=function(e){this.props.hierarchyEntity==e.hierarchyEntity&&this.props.attributeInfo.entityName==e.attributeInfo.entityName||this.componentDidMount()},t.prototype.render=function(){var e=this.getDropDownOptions(),t=this.getHierarchyRoute(),n=this.props.isDisabled||0==this.props.attributeInfo.entityName.length||0==this.props.hierarchyEntity.length,r=e.find((function(e){return"related"==e.key}))&&e.find((function(e){return"related"==e.key})).options.length>0?d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_NOOPTION_MESSAGE):d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_NOOPTION_BOTH_MESSAGE);return l.default.createElement("div",{className:"PivotalDropdownControl","aria-required":"true"},l.default.createElement(_.default,{placeHolder:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_FIELD_PLACEHOLDER),groups:e,value:t,onChange:this.onChange.bind(this),disabled:n,error:""==t&&e.length>0,emptyOptionMessage:r,emptyfilterMessage:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_FILTER_NOOPTION_MESSAGE),onRenderHeader:this.onRenderDropdownHeader.bind(this)}))},t.prototype.onRenderDropdownHeader=function(){return l.default.createElement("div",{style:{margin:"10px"}},d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_HEADER_MESSAGE))},t.prototype.getHierarchyRoute=function(){var e="",t=this.props.hierarchyRelationship;if(!t)return"";if(!t.entityName||!t.relationship)return"";var n=E.ForecastingBusinessLogicProvider.getRelationshipDepth(t),r=[],i=JSON.parse(JSON.stringify(t));if(this.state.entityDisplayNames&&this.state.entityAttributes&&this.state.entityAttributes[i.entityName]&&(1==n||this.state.entityAttributes[i.relationship.entityName])){r.push(this.state.entityDisplayNames[i.entityName]);var o=i.relationship;if(r.push(this.getAttributeNameFromRelation(this.state.entityAttributes[i.entityName],o.linkedByAttribute)),o&&o.relationship){var a=o.relationship;r.push(this.getAttributeNameFromRelation(this.state.entityAttributes[o.entityName],a.linkedByAttribute))}r.push(this.state.entityDisplayNames[this.props.hierarchyEntity]),r&&r.length>0&&(1==n?e=d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_TWO_LEVELS):2==n&&(e=d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_THREE_LEVELS)),r.forEach((function(t,n){e=e.replace("{"+n+"}",t)})))}return e},t.prototype.onChange=function(e,t){if(e.data.targets[0]==this.props.hierarchyEntity&&"related"!=t.key){var n={entityName:this.props.attributeInfo.entityName,linkedByAttribute:null,relationship:{entityName:e.data.targets[0],linkedByAttribute:e.key,relationship:null}};this.props.onChange(n)}else{var r={entityName:e.subgroupEntity,linkedByAttribute:e.subgroupid,relationship:{entityName:e.data.targets[0],linkedByAttribute:e.key,relationship:null}};n={entityName:this.props.attributeInfo.entityName,linkedByAttribute:null,relationship:r};e.data.targets[0]==this.props.hierarchyEntity&&this.props.onChange(n)}},t.prototype.getDropDownOptions=function(){var e=this,t=[];if(!(this.state.entityDisplayNames&&this.state.oneToManyRelation&&this.state.oneToManyRelation[this.props.attributeInfo.entityName+this.props.hierarchyEntity]&&this.state.hierarchialEntities&&this.state.entityAttributes&&this.state.entityAttributes[this.props.attributeInfo.entityName]&&this.state.entityAttributes[this.props.hierarchyEntity]))return[];var n=!0;if(this.state.oneToManyRelation[this.props.attributeInfo.entityName+this.props.hierarchyEntity].relations.forEach((function(t){e.state.entityAttributes[t]||(n=!1)})),!n)return[];this.isEndLogged||(S.logUsage("CrmCustomAttributePickerControl","initialize-success",{rollupEntity:this.props.attributeInfo.entityName,hierarchyEntity:this.props.hierarchyEntity},"initialize-success"),this.isEndLogged=!0);var r=this.state.entityAttributes[this.props.attributeInfo.entityName].filter((function(t){var n=e.state.oneToManyRelation[e.props.attributeInfo.entityName+e.props.hierarchyEntity];return(t.dataType==c.EDataType.Lookup||t.dataType==c.EDataType.Owner)&&e.state.hierarchialEntities.includes(t.targets[0])&&n.relationsDirect.find((function(e){return e.ReferencingAttribute==t.name}))})).map((function(t){return{key:t.name,text:t.displayName+" ("+e.state.entityDisplayNames[t.targets[0]]+")",data:t,closeOnClick:!0}}));t.push({key:this.props.attributeInfo.entityName,text:this.state.entityDisplayNames[this.props.attributeInfo.entityName],options:r,searchBoxProps:{placeholder:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_GROUP_SEARCH)}});var i=this.state.entityAttributes[this.props.attributeInfo.entityName].filter((function(t){var n=e.state.oneToManyRelation[e.props.attributeInfo.entityName+e.props.hierarchyEntity];return(t.dataType==c.EDataType.Lookup||t.dataType==c.EDataType.Owner)&&e.state.hierarchialEntities.includes(t.targets[0])&&n.relations.includes(t.targets[0])&&n.relationsFromRollup.find((function(e){return e.ReferencingAttribute==t.name}))&&!n.relationsDirect.find((function(e){return e.ReferencingAttribute==t.name}))})),o=[];return i.forEach((function(t){var n=e.state.entityAttributes[t.targets[0]].filter((function(t){var n=e.state.oneToManyRelation[e.props.attributeInfo.entityName+e.props.hierarchyEntity];return(t.dataType==c.EDataType.Lookup||t.dataType==c.EDataType.Owner)&&n.relationsToHierarchy.find((function(e){return e.ReferencingAttribute==t.name}))&&e.state.hierarchialEntities.includes(t.targets[0])})).map((function(n){return{key:n.name,text:n.displayName+" ("+e.state.entityDisplayNames[n.targets[0]]+")",data:n,closeOnClick:!0,subgroupid:t.name,subgroupName:t.displayName+" ("+e.state.entityDisplayNames[t.targets[0]]+")",subgroupEntity:t.targets[0]}}));o=o.concat(n)})),t.push({key:"related",text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_GROUP_RELATED),options:o,disabled:0==o.length,isExpandable:!0,searchBoxProps:{placeholder:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_ROUTE_CONTROL_GROUP_SEARCH)}}),t},t.prototype.getAttributeNameFromRelation=function(e,t){var n=e.find((function(e){return e.name==t}));return n&&n.targets&&this.state.entityDisplayNames?n.displayName+" ("+this.state.entityDisplayNames[n.targets[0]]+")":""},t.prototype.fetchEntityAttributes=function(e){var t=this,n={name:e,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""};S.logInfo("CrmCustomAttributePickerControl","fetchEntityAttributes-Started",e,"Network-Started"),this.props.crmDataAcces.cdsResolver.resolveFields(n).then((function(n){var r=t.state.entityAttributes;r[e]=n,S.logInfo("CrmCustomAttributePickerControl","fetchEntityAttributes-Ended",e,"Network-Ended"),t.setState({entityAttributes:r})})).catch((function(t){S.logError("CrmCustomAttributePickerControl",t,"fetchEntityAttributes",e,"Network-Error")}))},t.prototype.getOrgEntites=function(){var e=this;S.logInfo("CrmCustomAttributePickerControl","getOrgEntities-Started",{},"Network-Started"),this.props.crmDataAcces.organizationDataAccess.getOrgEntities().then((function(t){var n={};t.forEach((function(e){n[e.LogicalName]=e.DisplayName.UserLocalizedLabel&&e.DisplayName.UserLocalizedLabel.Label})),S.logInfo("CrmCustomAttributePickerControl","getOrgEntities-Ended",{},"Network-Ended"),e.setState({entityDisplayNames:n})})).catch((function(e){S.logError("CrmCustomAttributePickerControl",e,"getOrgEntities",{},"Network-Error")}))},t.prototype.getRelationships=function(e,t){var n=this;S.logInfo("CrmCustomAttributePickerControl","getOneToManyRelationships-Started",{rollupEntity:e,hierarchyEntity:t},"Network-Started"),this.props.crmDataAcces.crmMetadataAccess.getOneToManyRelationships(e,t).then((function(r){S.logInfo("CrmCustomAttributePickerControl","getOneToManyRelationships-Ended",{rollupEntity:e,hierarchyEntity:t},"Network-Ended");var i=[],o=[],a=[],s=[],l=[];r.forEach((function(e){"owner"==e.ReferencedEntity&&(e.ReferencedEntity="systemuser"),"owner"==e.ReferencingAttribute&&(e.ReferencingAttribute="systemuser"),e.ReferencingEntity==n.props.attributeInfo.entityName&&e.ReferencedEntity==n.props.hierarchyEntity&&l.push(e),e.ReferencingEntity==n.props.attributeInfo.entityName&&(i.push(e.ReferencedEntity),a.push(e)),e.ReferencedEntity==n.props.hierarchyEntity&&(o.push(e.ReferencingEntity),s.push(e))})),i=Array.from(new Set(i)),o=Array.from(new Set(o));var c=i.filter((function(e){return o.includes(e)})),u=n.state.oneToManyRelation;n.state.hierarchialEntities&&(c=c.filter((function(e){return n.state.hierarchialEntities.includes(e)}))),c.forEach((function(e){n.fetchEntityAttributes(e)})),u[e+t]={relations:c,relationsFromRollup:a,relationsToHierarchy:s,relationsDirect:l},n.setState({oneToManyRelation:u})}))},t}(l.default.Component);t.default=f},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22);n(1141);var l=n(60),c=function(e){function t(t){var n=e.call(this,t)||this;return n._menuButtonElement=a.default.createRef(),n.state={isDropdownVisible:!!n.props.close&&n.props.close},n}return i(t,e),t.prototype.render=function(){var e,t=this;return e=this.props.disabled||0!=this.props.groups.length?this.props.value&&this.props.value.length?this.props.value:this.props.placeHolder:a.default.createElement("div",{style:{width:"100%"}},a.default.createElement(s.Spinner,{size:s.SpinnerSize.medium})),a.default.createElement("div",{ref:this._menuButtonElement,title:this.props.value},a.default.createElement(s.DefaultButton,{disabled:!(!this.props.disabled&&0!=this.props.groups.length)&&this.props.disabled,className:this.props.error?"customdropdownbutton error":"customdropdownbutton",iconProps:{iconName:"ChevronDownMed",styles:{root:{margin:"0px",fontSize:"12px",color:"#605E5C"}}},onClick:function(){t.setState({isDropdownVisible:!t.state.isDropdownVisible})}},e),this.state.isDropdownVisible?this.renderCallout():s.nullRender())},t.prototype.renderCallout=function(){var e=this;return a.default.createElement(s.Callout,{role:"alertdialog",gapSpace:0,directionalHint:s.DirectionalHint.bottomRightEdge,target:this._menuButtonElement.current,setInitialFocus:!0,isBeakVisible:!1,style:{minWidth:300,width:412},onDismiss:function(){e.setState({isDropdownVisible:!1})}},this.props.onRenderHeader&&this.props.onRenderHeader(),this.renderPivot())},t.prototype.renderPivot=function(){var e=this,t=[];return this.props.groups.forEach((function(n){var r=n.disabled;t.push(a.default.createElement(s.PivotItem,{itemKey:n.key,headerText:n.text,headerButtonProps:{disabled:!!r,"data-order":3,style:r?{opacity:.4}:{}},onRenderItemLink:function(e,t){return a.default.createElement("span",null,t(e),n.tooltipProps?a.default.createElement(s.TooltipHost,{content:n.tooltipProps.message,id:"relatedTooltip",calloutProps:{gapSpace:0},styles:{root:{display:"inline-block",fontSize:"12px",marginLeft:"5px",marginTop:"-1px"}}},a.default.createElement(l.Icon,{iconName:"Info","aria-describedby":"relatedTooltip"})):s.nullRender())}},e.renderPivotItem(n)))})),a.default.createElement(s.Pivot,{selectedKey:this.props.selectedGroupKey,onLinkClick:this.props.onGroupChange},t)},t.prototype.renderPivotItem=function(e){var t=this,n=this.state.searchString&&this.state.searchString[e.key]?this.state.searchString[e.key]:"";return a.default.createElement("div",{style:{paddingTop:"8px",paddingBottom:"8px"}},e.searchBoxProps?a.default.createElement(s.SearchBox,{styles:{root:{borderRadius:"2px",marginLeft:"8px",marginRight:"8px"}},value:n,placeholder:e.searchBoxProps.placeholder,onEscape:function(){var n;t.setState({searchString:(n={},n[e.key]="",n)})},onClear:function(){var n;t.setState({searchString:(n={},n[e.key]="",n)})},onChange:function(n,r){var i;t.setState({searchString:(i={},i[e.key]=r||"",i)})},onSearch:function(n){var r;t.setState({searchString:(r={},r[e.key]=n||"",r)})}}):s.nullRender(),0==e.options.length?this.renderEmptyMessage():e.isExpandable?this.renderExpandableList(e,n):this.renderList(e,n))},t.prototype.renderEmptyMessage=function(){return a.default.createElement("div",{className:"listContainer","data-is-scrollable":!0},a.default.createElement("div",{style:{padding:"8px"}},this.props.emptyOptionMessage))},t.prototype.renderList=function(e,t){var n=this,r=e.options.filter((function(e){return-1!=e.text.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}));return 0==r.length?a.default.createElement("div",{className:"detaillistcontainer","data-is-scrollable":!0},a.default.createElement("div",{style:{padding:"8px"}},this.props.emptyfilterMessage)):a.default.createElement("div",{className:"listContainer","data-is-scrollable":!0},a.default.createElement(s.List,{items:r,onRenderCell:function(t){return a.default.createElement("div",null,a.default.createElement(s.CommandBarButton,{className:"dropdownRowButton",text:t.text,checked:t.key==n.props.selectedOptionKey,onClick:function(){n.props.onChange(t,e),t.closeOnClick&&n.setState({isDropdownVisible:!n.state.isDropdownVisible})}}))}}))},t.prototype.renderExpandableList=function(e,t){var n=this,r=e.options.filter((function(e){return-1!=e.text.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())})),i=this.getGroups(r);return 0==r.length?a.default.createElement("div",{className:"detaillistcontainer","data-is-scrollable":!0},a.default.createElement("div",{style:{padding:"8px"}},this.props.emptyfilterMessage)):a.default.createElement("div",{className:"detaillistcontainer","data-is-scrollable":!0},a.default.createElement(s.DetailsList,{selectionMode:s.SelectionMode.none,layoutMode:s.DetailsListLayoutMode.justified,items:r,groups:i,columns:[{key:"text",name:"Name",fieldName:"name",minWidth:170,maxWidth:200,isResizable:!1}],groupProps:{showEmptyGroups:!0},compact:!0,onRenderDetailsHeader:function(e){return s.nullRender()},onRenderRow:function(t){return a.default.createElement("div",null,a.default.createElement(s.CommandBarButton,{className:"dropdownRowButton",text:t.item.text,style:{paddingLeft:"40px"},checked:t.item.key==n.props.selectedOptionKey,onClick:function(){n.props.onChange(t.item,e),t.item.closeOnClick&&n.setState({isDropdownVisible:!n.state.isDropdownVisible})}}))}}))},t.prototype.getGroups=function(e){var t=e.sort((function(e,t){return e.subgroupName.toLocaleLowerCase()>t.subgroupName.toLocaleLowerCase()?1:-1})),n={},r={},i=[];return t.forEach((function(e){n[e.subgroupid]=(n[e.subgroupid]||0)+1})),t.forEach((function(e,t){r[e.subgroupid]||(r[e.subgroupid]={key:e.subgroupid,name:e.subgroupName,startIndex:t,count:n[e.subgroupid]},i.push({key:e.subgroupid,name:e.subgroupName,startIndex:t,count:n[e.subgroupid],isCollapsed:!0}))})),i},t}(a.default.Component);t.default=c},function(e,t,n){var r=n(1142);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,'.dropdownRowButton {\n  background-color: white;\n  padding: 8px;\n  font-family: Segoe UI;\n  font-size: 14px;\n  color: #323130;\n  width: 100%;\n  text-align: start; }\n  .dropdownRowButton .ms-Button-label {\n    line-height: 20px; }\n\n.customdropdownbutton.is-disabled {\n  background-color: #F3F2F1;\n  border: none;\n  color: #a19f9d; }\n  .customdropdownbutton.is-disabled .ms-Button-icon {\n    color: #a19f9d; }\n\n.customdropdownbutton.error {\n  border: 1px solid #a4262c; }\n  .customdropdownbutton.error:hover {\n    border: 1px solid #a4262c; }\n  .customdropdownbutton.error:focus {\n    border: 2px solid #a4262c; }\n\n.customdropdownbutton {\n  padding-left: 8px;\n  padding-right: 8px;\n  min-width: 220;\n  width: 100%;\n  border: 1px solid #a19f9d;\n  background-color: white;\n  border-radius: 2px; }\n  .customdropdownbutton:hover {\n    border: 1px solid #605E5C;\n    background-color: white; }\n  .customdropdownbutton:focus {\n    border: 2px solid #0078d4;\n    background-color: white; }\n  .customdropdownbutton .ms-Button-flexContainer {\n    flex-direction: row-reverse; }\n  .customdropdownbutton .ms-Button-label {\n    text-align: start;\n    text-align: left;\n    font-weight: 400;\n    margin-left: 0px; }\n  .customdropdownbutton .ms-Button-textContainer {\n    overflow: hidden;\n    white-space: nowrap; }\n  .customdropdownbutton .ms-Button-label {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 14px;\n    line-height: 20px; }\n\n.listContainer {\n  overflow: auto;\n  height: 180px;\n  margin-top: 8px;\n  border-top: 1px solid #EDEBE9; }\n  .listContainer .ms-List-page {\n    border-bottom: none !important; }\n\n.detaillistcontainer {\n  overflow: auto;\n  height: 180px;\n  margin-top: 8px;\n  border-top: 1px solid #EDEBE9; }\n  .detaillistcontainer span[class^="headerCount-"] {\n    display: none; }\n  .detaillistcontainer .ms-DetailsList {\n    overflow: hidden; }\n  .detaillistcontainer .ms-GroupHeader {\n    background-color: white;\n    height: 36px; }\n  .detaillistcontainer .ms-GroupHeader-title {\n    font-family: Segoe UI;\n    font-size: 14px;\n    line-height: 20px;\n    /* identical to box height, or 143% */\n    /* Neutrals / Web / Gray 160 #323130 */\n    color: black;\n    font-weight: 600;\n    padding-left: 0px; }\n  .detaillistcontainer .ms-List-page {\n    border-bottom: none !important; }\n',""])},function(e,t,n){var r=n(1144);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".formLabel,\n.FormControlDecorator .ms-Dropdown-label,\n.CrmNumberPickerControl .ms-Label,\n.ms-TextField-wrapper .ms-Label,\n.crmAttributePickerControl .ms-Label {\n  font-weight: 600;\n  padding: 5px 0;\n  display: flex;\n  color: #333333; }\n\n.delfiFormFieldError .ms-BasePicker-text {\n  border-color: #a4262c; }\n\n.delfiFormFieldError .formWarningText {\n  color: #a4262c;\n  font-size: 12px;\n  line-height: 16px; }\n\n.formLabelHelpContainer {\n  clear: both;\n  float: right;\n  margin-top: 4px; }\n\n.formLabelHelpIcon {\n  font-size: 14px;\n  width: 24px;\n  height: 24px; }\n\n.CrmNumberPickerControl div:first-child {\n  margin-bottom: 0px; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),l=n(89),c=n(45);n(1146),c.initializeIcons();var u=function(e){function t(t){var n=e.call(this,t)||this;return n.pickerRef=s.default.createRef(),n.pickerRef=s.default.createRef(),n.state={displayName:""},n}return i(t,e),t.prototype.shouldComponentUpdate=function(e,t){return this.props.value!==e.value||this.props.targetEntity!==e.targetEntity},t.prototype.onChange=function(e,t){e.length>0?(this.props.onChange(e[0].id),this.setState({displayName:e[0].displayName})):this.props.onChange(e)},t.prototype.componentDidMount=function(){this.setLookUpAsRequired()},t.prototype.componentDidUpdate=function(){this.setLookUpAsRequired()},t.prototype.setLookUpAsRequired=function(){var e=this.pickerRef&&this.pickerRef.current&&this.pickerRef.current.querySelector("input");e&&e.setAttribute("aria-required","true")},t.prototype.render=function(){var e=this.generateMakerXControlProps(),t=""==this.props.value?" delfiFormFieldError":"";return s.default.createElement("div",{className:"crmLookupControl"+t,"aria-required":"true",ref:this.pickerRef,"aria-live":"polite"},s.default.createElement(l.LookupPicker,o({},e)))},t.prototype.generateMakerXControlProps=function(){var e={name:this.props.targetEntity,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},t={metadataId:this.props.attributeInfo.id,name:this.props.attributeInfo.name,displayName:this.props.attributeInfo.name,dataType:l.EDataType.UniqueIdentifier},n="";return this.props.value&&(n=[{entityLogicalName:this.props.targetEntity,id:this.props.value,displayName:this.state.displayName}]),{resolver:this.props.crmDataAcces.cdsResolver,value:n,onChange:this.onChange.bind(this),entityContext:e,fieldContext:t,labels:{inputControlLabel:this.props.value,loadingResults:"Loading",noResults:"No Results"},singleSelect:!0,disabled:this.props.isDisabled}},t}(s.default.Component);t.default=u},function(e,t,n){var r=n(1147);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".ms-BasePicker-text {\n  border-width: thin !important;\n  width: 412px; }\n\n.ms-Suggestions-container,\n.ms-Persona-primaryText {\n  width: 370px !important; }\n\n.ms-TooltipHost {\n  display: hidden !important; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(45),l=n(22);s.initializeIcons();var c=function(e){function t(t){var n=e.call(this,t)||this;return n._onChange=function(e,t){n.props.onChange(t.key)},n.state={options:[]},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.entityType&&"hierarchial"==this.props.entityType?this.props.crmDataAcces.organizationDataAccess.getHierarchialEntities().then((function(t){var n=t.map((function(e){return{key:e.LogicalName,text:e.DisplayName.UserLocalizedLabel&&e.DisplayName.UserLocalizedLabel.Label}}));e.setState({options:n})})):this.props.crmDataAcces.organizationDataAccess.getOrgEntities().then((function(t){var n=t.map((function(e){return{key:e.LogicalName,text:e.DisplayName.UserLocalizedLabel&&e.DisplayName.UserLocalizedLabel.Label}}));e.setState({options:n})}))},t.prototype.render=function(){var e=this,t=this.getDropDownOptions(),n=this.getDropDownStyles();return a.default.createElement("div",{className:"CrmEntityPickerControl"},a.default.createElement(l.Dropdown,{label:this.props.label,onChange:this._onChange.bind(this),selectedKey:this.props.value?this.props.value:void 0,options:t,role:"combobox","aria-haspopup":"listbox",disabled:this.props.isDisabled,styles:n,onRenderPlaceHolder:function(){var t=a.default.createElement("div",{style:{marginTop:5}},a.default.createElement(l.Spinner,null));return e.state.options.length>0&&(t=""),t}}))},t.prototype.getDropDownStyles=function(){return{dropdown:{width:412}}},t.prototype.getDropDownOptions=function(){return this.state.options.sort((function(e,t){return e.text.localeCompare(t.text)}))},t}(a.default.Component);t.default=c},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(45),l=n(22),c=n(7),u=n(8);s.initializeIcons();var d=function(e){function t(t){var n=e.call(this,t)||this;return n._onChange=function(e,t){t&&parseInt(e)<n.props.maxValue&&n.props.onChange(parseInt(e)+1),!t&&parseInt(e)>n.props.minValue&&n.props.onChange(parseInt(e)-1)},n._handleBlur=function(e){var t=parseInt(e);isNaN(t)||t<n.props.minValue?t=n.props.minValue:t>n.props.maxValue&&(t=n.props.maxValue),n.props.onChange(t)},n.state={},n}return i(t,e),t.prototype.render=function(){var e=this;return a.default.createElement("div",{className:"CrmNumberPickerControl"},a.default.createElement(l.SpinButton,{label:this.props.label,labelPosition:0,value:""+this.props.value,min:this.props.minValue,max:this.props.maxValue,step:1,disabled:this.props.isDisabled,ariaLabel:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Number),incrementButtonAriaLabel:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Increase),decrementButtonAriaLabel:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Decrease),onIncrement:function(t){e._onChange(t,!0)},onDecrement:function(t){e._onChange(t,!1)},onBlur:function(t){e._handleBlur(t.target.value)},styles:{spinButtonWrapper:{borderWidth:"thin"}}}))},t}(a.default.Component);t.default=d},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(45),l=n(22),c=n(7),u=n(8);s.initializeIcons();var d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:"CrmDatePickerControl"},a.default.createElement(l.DatePicker,{label:this.props.label,value:new Date(this.props.value),placeholder:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Date),ariaLabel:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Date),disabled:this.props.isDisabled}))},t}(a.default.Component);t.default=d},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(45),l=n(22);s.initializeIcons();var c=function(e){function t(t){var n=e.call(this,t)||this;return n._onChange=function(e,t){n.props.onChange(t.key)},n.state={},n}return i(t,e),t.prototype.render=function(){var e=this,t=this.getDropDownOptions(),n=this.getDropDownStyles();return a.default.createElement("div",{className:"CrmViewPickerControl"},a.default.createElement(l.Dropdown,{label:this.props.label,onChange:this._onChange.bind(this),selectedKey:this.props.value?this.props.value:void 0,options:t,calloutProps:{directionalHintFixed:!0,styles:{calloutMain:{height:288}}},disabled:this.props.isDisabled,styles:n,"aria-required":"true",onRenderPlaceHolder:function(){var t=a.default.createElement("div",{style:{marginTop:5}},a.default.createElement(l.Spinner,null));return e.props.attributeInfo.entityName&&null!=e.props.rollupEntityViewList.viewDic&&e.props.rollupEntityViewList.viewDic.length>0&&(t=""),t}}))},t.prototype.getDropDownStyles=function(){return{dropdown:{width:412}}},t.prototype.getDropDownOptions=function(){if(this.props.attributeInfo.entityName&&null!=this.props.rollupEntityViewList.viewDic&&this.props.rollupEntityViewList.viewDic.length>0){var e=this.props.rollupEntityViewList.viewDic.sort((function(e,t){return e.title.localeCompare(t.title)}));return this.convertTypeToDropDownOption(e)}return[]},t.prototype.convertTypeToDropDownOption=function(e){return e.map((function(e){return{key:e.id,text:e.title}}))},t}(a.default.Component);t.default=c},function(e,t,n){var r=n(1153);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".schedulingWrapper {\n  margin-top: 24px;\n  display: grid;\n  grid-template-columns: 198px 198px auto;\n  grid-template-rows: 60px 60px 60px;\n  grid-column-gap: 16px;\n  grid-row-gap: 24px;\n  margin-top: 23px; }\n\n.periodSelector {\n  grid-column-start: 1;\n  grid-row-start: 1; }\n\n.yearSelector {\n  grid-column-start: 2;\n  grid-row-start: 1; }\n\n.startAt {\n  grid-column-start: 1;\n  grid-row-start: 2; }\n\n.numRec {\n  grid-column-start: 2;\n  grid-row-start: 2; }\n\n.validFrom {\n  grid-column-start: 1;\n  grid-row-start: 3; }\n\n.validTo {\n  grid-column-start: 2;\n  grid-row-start: 3; }\n\n.formSectionDivider {\n  width: 100%;\n  /* height: 1px; */\n  height: 0;\n  border-bottom: thin solid #E1DFDD;\n  /* Neutral/Grey 40 */\n  /* background: #E1DFDD; */ }\n\n.configurationWrapper {\n  margin-top: 24px;\n  display: grid;\n  grid-template-columns: 412px 24px auto;\n  grid-template-rows: auto;\n  grid-column-gap: 0px;\n  grid-row-gap: 24px;\n  margin-top: 23px; }\n\n.configurationSecEntitySelection {\n  grid-column-start: 1;\n  grid-row-start: 1; }\n\n.verticalDivider {\n  width: 0;\n  border-right: thin solid #E1DFDD;\n  height: 100%;\n  grid-column: 2; }\n\n.hierarchyPreviewSection {\n  width: 100%;\n  height: 100%;\n  grid-column: 3;\n  min-width: 412px;\n  margin-right: 32px;\n  display: flex;\n  flex-direction: column; }\n\n.hierarchyPreview {\n  border: thin solid #E1DFDD;\n  width: 100%;\n  height: 100%;\n  margin-top: 4px; }\n\n.hierarchyPreviewTitle {\n  font-size: 14px;\n  line-height: 20px;\n  font-family: 'Segoe UI';\n  color: #323130;\n  font-weight: 600; }\n\n.sectionSubtitle {\n  color: #605E5C;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  font-family: 'Segoe UI';\n  margin-top: 8px; }\n\n.sectionHeader {\n  font-family: Segoe UI;\n  font-size: 18px;\n  line-height: 24px;\n  color: #323130;\n  font-weight: 600; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(23);n(1155);var l=n(41),c=n(8),u=n(7),d=n(109),p=n(615),_=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){return l.ForecastingBusinessLogicProvider.FieldHasNonNullValue("",this.props.hierarchyEntity)&&l.ForecastingBusinessLogicProvider.FieldHasNonNullValue("",this.props.topOfHierarchy)?this.renderGrid():a.default.createElement("div",{className:"hierarchyPreviewMessageWrapper"},a.default.createElement("p",{className:"selectEntityPreviewMessage"},u.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_PREVIEW_HIERARCHY_SELECT_ENTITY_STAGE1)))},t.prototype.renderGrid=function(){return a.default.createElement(p.ConnectedPreviewGrid,null)},t}(a.default.Component);t.HierarchyPreview=_;t.ConnectedHierarchyPreview=s.connect((function(e){return{hierarchyEntity:e.FormFieldData.hierarchyEntity,topOfHierarchy:e.FormFieldData.topOfHierarchy,previewHeaderText:d.getHierarchyEntityDisplayName(e)}}))(_)},function(e,t,n){var r=n(1156);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".hierarchyPreviewMessageWrapper {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center; }\n\n.selectEntityPreviewMessage {\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C; }\n\n.generatingPreviewMessage {\n  font-family: 'Segoe UI';\n  font-size: 12px;\n  line-height: 16px;\n  height: 16px;\n  color: #0078D4; }\n\n.hierarchyPreviewGrid {\n  padding-left: 16px; }\n  .hierarchyPreviewGrid .ms-List-page {\n    border-bottom: none !important; }\n    .hierarchyPreviewGrid .ms-List-page .ms-List-cell {\n      background: white !important;\n      height: 42px !important; }\n    .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow-cellCheck {\n      align-items: center !important;\n      display: flex !important; }\n    .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow {\n      border-bottom: thin solid #E1DFDD !important;\n      min-height: 42px !important; }\n      .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell {\n        border-left: none !important;\n        height: 42px !important;\n        padding-bottom: 0px !important; }\n        .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectedCell {\n          border-color: transparent !important; }\n        .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .delfiIcon {\n          margin-right: 9px;\n          margin-left: 4px; }\n        .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .readOnlyCell {\n          height: 12px;\n          width: 48px;\n          background: #E1DFDD;\n          margin-top: -2px;\n          text-align: start; }\n        .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .hierarchy-cell {\n          margin-left: -50px; }\n          .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .hierarchy-cell .readOnlyCell {\n            height: auto;\n            width: auto;\n            background: none !important; }\n  .hierarchyPreviewGrid .ms-DetailsHeader {\n    border: 0px !important;\n    border-bottom: thin solid #E1DFDD !important;\n    border-top: none !important;\n    height: auto !important; }\n    .hierarchyPreviewGrid .ms-DetailsHeader .ms-DetailsHeader-cell {\n      border-left: none !important;\n      padding: 0px !important;\n      text-align: left !important;\n      font-size: 14px !important;\n      height: 30px !important;\n      font-weight: 600 !important; }\n      .hierarchyPreviewGrid .ms-DetailsHeader .ms-DetailsHeader-cell:hover {\n        background-color: none; }\n      .hierarchyPreviewGrid .ms-DetailsHeader .ms-DetailsHeader-cell .ms-DetailsHeader-cellTitle {\n        text-align: left !important;\n        margin-top: 0px !important;\n        display: block;\n        color: #323130 !important;\n        letter-spacing: 0.02em;\n        text-overflow: ellipsis;\n        line-height: 20px !important; }\n  .hierarchyPreviewGrid .activeColumn {\n    background: #F3F2F1; }\n  .hierarchyPreviewGrid .delfiGridContainer {\n    height: 100% !important; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(504);function o(e){var t=[];return e.forEach((function(n){n.isActive&&(n.columnType==r.ForecastColumnType.HierarchyPrimary?t.push(a(e)):t.push({id:n.id,header:n.title,type:"string",width:100,isEditable:n.isManuallyAdjustable,shouldShowProgress:n.showProgressComparedToQuota}))})),t}function a(e){var t=e.find((function(e){return e.columnType==r.ForecastColumnType.HierarchyPrimary}));if(null==t)throw new Error("Owner column missing from configuration");return{id:t.id,header:t.title,type:"string",width:150,isHierarchy:!0,isEditable:!1}}function s(e,t){for(var n=[],r={},i=0;i<t.length;i++)r=l(e,t[i]),0==i&&(r.parentId=void 0),n.push(r);return n}function l(e,t){for(var n={},o=0;o<e.length;o++){if(n.id=t.id,e[o].columnType==r.ForecastColumnType.HierarchyPrimary?n[e[o].id]=t.displayName:e[o].isActive&&(n[e[o].id]=""),e[o].columnType==r.ForecastColumnType.HierarchySecondary){var a=e[o].hierarchyAttributeInfo;n[e[o].id]=t.extraAttributesValues[a?i.getLinkedAttributeNameFromColumnInfo(a):""]}n.parentId=t.parentId}return n}t.convertColumnConfigInfoToDelfiData=function(e,t,n){for(var r=[],i=[],a=o(e),l=s(e,t),c=0;c<l.length;c++){for(var u={id:l[c].id,parentId:l[c].parentId,mayHaveChildren:l[c].mayHaveChildren,getDisplayFormattedValue:{},getEditValue:{},getIconUrl:{},getIconTooltip:{},getProgress:{},getStrikeValue:{},getUrlArgs:{}},d=0;d<a.length;d++){var p=a[d].id;u.getDisplayFormattedValue[p]=l[c][p],a[d].isEditable&&(u.getIconUrl[p]="Edit"),a[d].shouldShowProgress&&(u.getProgress[p]=.75)}r.push(u)}for(c=0;c<a.length;c++){var _={id:a[c].id,header:a[c].header,dataType:1,width:a[c].width,isEditable:!1,ishierarchial:"undefined"!=a[c].isHierarchy&&a[c].isHierarchy,columnHeaderClass:a[c].id==n?"activeColumn":void 0};i.push(_)}return{rows:r,columns:i}},t.getColumnMetaData=o,t.getHierarchyColumnMetaData=a,t.getSamplePreviewGridData=s,t.getSampleRowDataFromColumnInfo=l,t.create_UUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}},,,,,,,function(e,t,n){var r=n(1165);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".previewGrid {\n  padding-left: 24px;\n  padding-right: 24px; }\n  .previewGrid .ms-List-page {\n    border-bottom: none !important; }\n    .previewGrid .ms-List-page .ms-List-cell {\n      background: white !important;\n      height: 44px !important; }\n    .previewGrid .ms-List-page .ms-DetailsRow-cellCheck {\n      align-items: center !important;\n      display: flex !important; }\n    .previewGrid .ms-List-page .ms-DetailsRow {\n      border-bottom: thin solid #E1DFDD !important;\n      min-height: 44px !important; }\n      .previewGrid .ms-List-page .ms-DetailsRow:hover {\n        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1) !important;\n        z-index: 10; }\n      .previewGrid .ms-List-page .ms-DetailsRow.is-selected {\n        background: #F3F2F1 !important; }\n      .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell {\n        border-left: none !important;\n        height: 44px !important;\n        padding-bottom: 0px !important; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlCellDiv {\n          justify-content: flex-start !important;\n          font-size: 14px !important;\n          color: #323130 !important;\n          letter-spacing: 0.005em; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .cellContextmenu {\n          margin-left: 12px !important;\n          align-items: flex-start !important;\n          font-size: 12px !important;\n          color: #605E5C !important;\n          letter-spacing: 0.02em; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass {\n          color: #323130 !important;\n          text-decoration: none !important; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass:hover {\n            color: #2266E3 !important; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectedCell {\n          border-color: transparent !important; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .delfiIcon {\n          margin-right: 9px; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv {\n          margin-top: 7px;\n          width: 100%; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv .ms-ProgressIndicator-itemProgress {\n            width: 100% !important;\n            max-width: 55px !important; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv .ms-ProgressIndicator {\n            margin-top: -2px !important; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv .ms-ProgressIndicator-progressBar {\n            background: #2266E3 !important; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv .readOnlyCell:empty {\n            height: 12px;\n            width: 48px;\n            background: #E1DFDD;\n            border: 1px solid transparent; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .readOnlyCell:empty {\n          height: 12px;\n          width: 48px;\n          background: #E1DFDD;\n          text-align: start; }\n        @media screen and (-ms-high-contrast: active) {\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .readOnlyCell {\n            border: 1px solid transparent; } }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .hierarchy-cell {\n          margin-left: -46px; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .hierarchy-cell .readOnlyCell {\n            height: auto;\n            width: auto;\n            background: none !important;\n            color: #323130 !important; }\n  .previewGrid .ms-DetailsHeader {\n    border: 0px !important;\n    border-bottom: thin solid #E1DFDD !important;\n    border-top: none !important;\n    height: inherit !important; }\n    .previewGrid .ms-DetailsHeader .ms-DetailsHeader-cell {\n      border-left: none !important;\n      padding: 0px !important;\n      text-align: left !important;\n      font-size: 12px !important;\n      font-weight: 600 !important;\n      height: 30px !important; }\n      .previewGrid .ms-DetailsHeader .ms-DetailsHeader-cell:hover {\n        background-color: none; }\n      .previewGrid .ms-DetailsHeader .ms-DetailsHeader-cell .ms-DetailsHeader-cellTitle {\n        text-align: left !important;\n        margin-top: 0px !important;\n        display: block;\n        color: #323130 !important;\n        letter-spacing: 0.02em;\n        text-overflow: ellipsis; }\n  .previewGrid .activeColumn {\n    background: #F3F2F1; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0));n(1167);var s=n(22),l=n(45),c=n(363),u=n(41),d=n(7),p=n(8),_=n(105);l.initializeIcons();var E=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=function(e,t){null!=t&&n.props.onChange(_.sanitizeNameString(t))},n.state={},n}return i(t,e),t.prototype.render=function(){var e=void 0;this.props.showEmptyWarning&&(e=a.default.createElement("p",{style:{display:"inline",color:"rgb(164, 38, 44)"}},d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_FIELD_MANDATORY_MESSAGE)));var t="/webresources/Forecasting/Images/msdyn_ForecastInstanceEntityIcon.svg";this.props.orgUrl&&(t=""+this.props.orgUrl+t);var n=""==this.props.title?" ":"";return a.default.createElement("div",{className:"titleHeader"},a.default.createElement("div",{className:"titleWithInput"},a.default.createElement(s.TextField,{autoFocus:!0,ariaLabel:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_Title),"aria-required":"true",styles:{field:{fontSize:20,fontWeight:600,lineHeight:32}},value:this.props.title,required:!0,disabled:this.props.isDisabled,onChange:this.onChange.bind(this),errorMessage:n,placeholder:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE)}),e))},t}(a.default.Component);t.default=E,t.TitleEditorFormWarpper=function(e){var t=e.formState.showEmptyWarnings&&!u.ForecastingBusinessLogicProvider.FieldHasNonNullValue("name",e.formData.name);return a.default.createElement(E,{orgUrl:e.orgUrl,title:""+e.formData.name,isDisabled:!e.arePostPublishUpdatableFieldsUpdatable,onChange:function(t){e.formEventsHandler.OnValueChange({name:t})},showEmptyWarning:t})},t.ConnectedTitleEditor=c.ConnectedFormGenerator(t.TitleEditorFormWarpper)},function(e,t,n){var r=n(1168);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".titleHeader {\n  display: flex;\n  flex-direction: column; }\n\n.imageClass {\n  width: 56px;\n  height: 56px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: #EDEBE9;\n  border-radius: 50%; }\n\n.titleWithInput {\n  font-family: Segoe UI;\n  font-size: 12px;\n  line-height: 16px;\n  width: 341px;\n  height: 32px; }\n\n.forecastConfigurationLabeldiv {\n  margin-top: 11px;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 600; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0));n(1170);var s=n(22),l=n(45),c=n(498),u=n(23),d=n(227),p=n(173),_=n(15),E=n(7),S=n(8);l.initializeIcons();var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderStepperDiv=function(){var e=a.createElement(s.Icon,{iconName:"Accept",className:"ms-IconExample"}),n=0,r=[],i=E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_STEP);return t.props.delphiStepItems.forEach((function(o){if(n++,o.state!=c.IDelphiState.Disabled)var s=a.createElement("div",{className:"delphiStepperStepCircleLabel",onClick:function(){t.onStepClick(o)}},a.createElement("div",{tabIndex:0,"aria-label":i.concat(n.toString()).concat(o.description).concat(c.IDelphiState[o.state]),role:"button"},a.createElement("div",{className:"delphiStepper"+c.IDelphiState[o.state]},t.getStepCicleContents(o,e))),a.createElement("div",{style:{width:"150px",textAlign:"center"},className:"delphiStepperLabel"+c.IDelphiState[o.state]},o.description));else s=a.createElement("div",{className:"delphiStepperStepCircleLabel",onClick:function(){t.onStepClick(o)}},a.createElement("div",{className:"delphiStepper"+c.IDelphiState[o.state],"aria-label":"step ".concat(n.toString()).concat(o.description).concat(c.IDelphiState[o.state]),role:"button"},t.getStepCicleContents(o,e)),a.createElement("div",{style:{width:"150px",textAlign:"center"},className:"delphiStepperLabel"+c.IDelphiState[o.state]},o.description));if(r.push(s),!t.lastStageStepperControl(n)){var l=a.createElement("div",{className:"delphiStepperlineDiv"});r.push(l)}})),a.createElement("div",{className:"delphiStepperListContainer"},r)},t}return i(t,e),t.prototype.onStepClick=function(e){e.state!=c.IDelphiState.Disabled&&this.props.onStepClick(e.stepId)},t.prototype.render=function(){return this.renderStepperDiv()},t.prototype.getStepCicleContents=function(e,t){return e.state==c.IDelphiState.Completed||e.state==c.IDelphiState.CurrentCompleted?t:e.title},t.prototype.lastStageStepperControl=function(e){return e==this.props.delphiStepItems.length},t}(a.Component);t.DelphiStepperControl=f,t.default=f,t.ConnectedDelphiStepperControl=u.connect((function(e){return{delphiStepItems:p.getStageStateProps(e)}}),(function(e){return{onStepClick:function(t){_.logUsage("StepperStageButton","",{newActiveStage:t},"Click"),e(d.onStepClickActionCreator(t))}}}))(f)},function(e,t,n){var r=n(1171);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".delphiStepperListContainer {\n  display: flex;\n  flex-direction: row;\n  align-items: start;\n  margin-left: 10px;\n  margin-right: 10px;\n  min-width: 412px; }\n\n.delphiStepperLabelDisabled {\n  color: #696969; }\n\n.delphiStepperLabelCurrent {\n  font-weight: 600; }\n\n.delphiStepperLabelCurrentCompleted {\n  font-weight: 600; }\n\n.delphiStepperStepCircleLabel {\n  width: 2rem;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  overflow: visible; }\n\n.delphiStepperCurrent {\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #0742AB;\n  border: 1px solid #0742AB;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white; }\n\n.delphiStepperCurrent:hover {\n  background: #0B53CE;\n  cursor: pointer; }\n\n.delphiStepperCompleted {\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #2266E3;\n  border: 1px solid #2266E3;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white; }\n\n.delphiStepperCompleted:hover {\n  background: #0B53CE;\n  cursor: pointer; }\n\n.delphiStepperCurrentCompleted {\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #0742AB;\n  border: 1px solid #0742AB;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white; }\n\n.delphiStepperCurrentCompleted:hover {\n  background: #0B53CE;\n  cursor: pointer; }\n\n.delphiStepperDisabled {\n  pointer-events: none;\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #FFFFFF;\n  border: 1px solid #E1DFDD;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #A19F9D; }\n\n.delphiStepperEnabled {\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #FFFFFF;\n  border: 1px solid #A19F9D;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #323130; }\n\n.delphiStepperEnabled:hover {\n  cursor: pointer;\n  background: #F3F2F1; }\n\n.delphiStepperlineDiv {\n  width: 86px;\n  margin-top: 1rem;\n  margin-left: 1px;\n  margin-right: 1px;\n  border: 1px solid transparent;\n  background: #A19F9D; }\n\n@media screen and (-ms-high-contrast: active) {\n  .delphiStepperlineDiv {\n    border: 1px solid transparent; } }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(61),l=n(322);n(1173);var c=n(23),u=n(173),d=n(227),p=n(65),_=n(97),E=n(7),S=n(8),f=n(15),C=function(e){function t(t){var n=e.call(this,t)||this;return n.renderButtonDiv=function(){var e,t,r;if(n.props.backButtonState==l.IStepperButtonState.Hide)return e=n.props.nextButtonState==l.IStepperButtonState.Disabled,t=!0,r=!0,a.default.createElement("div",{className:"stepperButtonDiv"},n.getStepperNextButton(e,E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE)));var i;return e=n.props.nextButtonState==l.IStepperButtonState.Disabled,t=n.props.backButtonState==l.IStepperButtonState.Disabled,r=!1,i=n.props.currentActiveStage==_.ForecastConfigStage.Quota?E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_FINISH_EDITPAGE):E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE),a.default.createElement("div",{className:"stepperButtonDiv"},n.getStepperPrevButton(t,r),n.getStepperNextButton(e,i))},n.state={hideDialog:!0},n}return i(t,e),t.prototype.render=function(){return this.renderButtonDiv()},t.prototype.getStepperPrevButton=function(e,t){return a.default.createElement("div",{className:"buttonDiv"},a.default.createElement(s.DefaultButton,{text:E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_BACK_EDITPAGE),disabled:e,hidden:t,onClick:this.onBack.bind(this),styles:{root:{border:"thin solid #8A8886"}}}))},t.prototype.getStepperNextButton=function(e,t){return a.default.createElement("div",{className:"buttonDiv"},a.default.createElement(s.PrimaryButton,{styles:{root:{backgroundColor:"#2266E3",color:"#ffffff",borderRadius:"2px"},rootHovered:{backgroundColor:"#0B53CE"}},text:t,disabled:e,onClick:this.onNext.bind(this)}))},t.prototype.onBack=function(){this.props.clickButton(l.IStepperButton.BACK)},t.prototype.onNext=function(){this.props.clickButton(l.IStepperButton.NEXT)},t}(a.default.Component);t.DelphiStepperButton=C,t.default=C,t.ConnectedDelphiStepperButton=c.connect((function(e){return{backButtonState:u.getBackButtonState(e),nextButtonState:u.getNextButtonState(e),currentActiveStage:e.stepperActiveStage,isFormLocked:p.GetIsFormLocked_FromState(e)}}),(function(e){return{clickButton:function(t){f.logUsage("StepperBackNextButton","",{buttonType:t},"Click"),e(d.onButtonClickActionCreator(t))}}}))(C)},function(e,t,n){var r=n(1174);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".stepperButtonDiv {\n  flex-flow: row;\n  display: flex;\n  flex-direction: row; }\n\n.buttonDiv {\n  margin-left: 4px;\n  margin-right: 4px; }\n",""])},function(e,t,n){var r=n(1176);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".stepperContainer {\n  flex-direction: row;\n  display: flex;\n  justify-content: space-between;\n  padding-top: 24px;\n  padding-left: 24px;\n  padding-right: 24px; }\n\n.editPageApp {\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  overflow: hidden;\n  flex: 1 1 auto; }\n\n.stepperButtonFooterStyle {\n  margin-left: 20px;\n  margin-right: 20px;\n  margin-top: 40px; }\n\n.stageAndFooterContainer {\n  overflow: auto;\n  margin-bottom: 24px; }\n\n.stageContainer {\n  padding-top: 24px;\n  padding-left: 24px;\n  padding-right: 24px; }\n\n.MainAppContainer {\n  height: 100%; }\n\n.DelfiConfigApp {\n  height: 100%; }\n\n.titleContainer {\n  margin-top: 16px;\n  padding-left: 24px;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between; }\n\n.sectionDividerShadow {\n  width: 100%;\n  /* height: 1px; */\n  height: 0;\n  border-bottom: thin solid #FFFFFF;\n  box-shadow: 0px 0.3px 0.9px rgba(0, 0, 0, 0.108), 0px 1.6px 3.6px rgba(0, 0, 0, 0.132); }\n\n.stageHeaderTitle {\n  font-weight: 600;\n  font-size: 18px;\n  color: #323130; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(0)),l=n(23),c=n(108),u=n(1178);n(1182);var d=n(1184),p=n(615),_=n(1189),E=n(618),S=n(1193),f=n(620),C=n(621),m=n(7),g=n(8),T=n(226),I=n(1197),h=a(n(1205)),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editModeTriggeredAtleastOnce=!1,t}return i(t,e),t.prototype.renderExpressionBuilderFilterPanel=function(){var e=this.renderExpressionBuilderFilter();return s.createElement("div",{className:"filterControlPane"},s.createElement("span",{className:"addFilterTitle"},m.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_ADDITIONAL_FILTER_HEADING)),s.createElement("span",{className:"addFilterSubTitle"},m.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_ADDITIONAL_FILTER_SUB_HEADING)),e)},t.prototype.renderExpressionBuilderFilter=function(){return s.createElement("div",{className:"expressionBuilderControlClass"},s.createElement(I.ConnectedExpressionBuilderFilter,{crmDataAccess:this.props.crmDataAccess}))},t.prototype.componentDidUpdate=function(){var e=".overviewContainer .ribbonBtn";this.props.isInEditMode?e=".editorContainer .columnNameField input":this.props.isOptionSetEditorOpen&&(e=".editorContainer .ribbonBtn");var t=document.querySelector(e);t&&window.setTimeout((function(){t.focus()}),500)},t.prototype.renderLeftPanel=function(){var e=this.renderEditorPanel(),t=this.renderColumnsOverviewPanel(),n="";T.XrmHelper.isUserLanguageRTL()&&(n="_rtl");var r="overviewOn"+n;return this.editModeTriggeredAtleastOnce||(r=""),(this.props.isInEditMode||this.props.isOptionSetEditorOpen)&&(this.editModeTriggeredAtleastOnce=!0,r="editorOn"+n),s.createElement("div",{key:""+this.props.isInEditMode,style:{display:"flex",height:"100%"},className:r},s.createElement("div",{className:"overviewContainer",style:{flexShrink:0,width:"100%"}},t),s.createElement("div",{className:"editorContainer",style:{flexShrink:0,width:"100%",height:"100%"}},e),s.createElement("div",{className:"ForecastConfigReadAlert",role:"alert"}))},t.prototype.renderColumnsOverviewPanel=function(){var e=this.props.isInEditMode||this.props.isOptionSetEditorOpen?"none":"flex";return s.createElement("div",{style:{display:e,flexDirection:"column",width:"100%",height:"100%"}},s.createElement(C.ConnectedColumnOverviewRibbon,null),s.createElement(d.ConnectedColumnsOverview,null))},t.prototype.renderPreviewGrid=function(){return s.createElement("div",{className:"previewGrid",style:{paddingTop:10,flexGrow:1}},s.createElement("span",{className:"previewGridTitle"},m.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_PREVIEW_GRID_HEADING_STAGE2)),s.createElement(p.ConnectedPreviewGrid,null))},t.prototype.renderStageHeader=function(){return s.createElement("div",{className:"header_stage2"},s.createElement("span",{className:"stageHeaderTitle",role:"heading","aria-level":1},m.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_COLUMN_OPTION_HEADER_STAGE2)),s.createElement("br",null),s.createElement("p",{className:"colOptionDesc"},m.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_COLUMN_OPTION_SUBHEADER_STAGE2)))},t.prototype.renderEditorPanel=function(){return this.props.isOptionSetEditorOpen?this.renderOptionSetSelectorPanel():this.renderColumnEditorPanel()},t.prototype.renderOptionSetSelectorPanel=function(){return s.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},s.createElement(E.ConnectedOptionSetSelectorRibbon,null),s.createElement(_.ConnectedOptionSetSelectorChoiceList,{crmDataAccess:this.props.crmDataAccess}),s.createElement(S.ConnectedChangeConfirmationDialog,null))},t.prototype.renderColumnEditorPanel=function(){var e=this.props.isInEditMode||this.props.isOptionSetEditorOpen?"flex":"none";return s.createElement("div",{style:{height:"100%",display:e,flexDirection:"column"}},s.createElement(f.ConnectedColumnEditorRibbon,null),s.createElement(u.ConnectedColumnEditorForm,{crmDataAccess:this.props.crmDataAccess}))},t.prototype.render=function(){return s.createElement("div",{className:"stage2Form"},this.renderStageHeader(),s.createElement("div",{className:"mainPanelContainer_stage2"},s.createElement("div",{className:"leftPanel_stage2"},this.renderLeftPanel()),s.createElement("div",{className:"verticleDivider"}),s.createElement("div",{style:{display:"flex",flexDirection:"column",marginLeft:1}},this.props.showMaxHierarchyRecordsMessage&&s.createElement(h.default,null),this.renderPreviewGrid())),s.createElement("div",{className:"addtionalFilters"},this.renderExpressionBuilderFilterPanel()))},t}(s.Component);t.Stage2Form=A;t.ConnectedStage2Form=l.connect((function(e,t){return{isInEditMode:c.GetIsColumnEditorOpened_FromState(e),isOptionSetEditorOpen:c.GetIsOptionSetEditorOpened_FromState(e),showMaxHierarchyRecordsMessage:c.GetShowMaxHierarchyMessage_FromState(e)}}),(function(e,t){return{}}))(A)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(0)),c=n(23),u=n(16),d=n(108),p=n(22),_=n(110),E=s(n(616)),S=s(n(614)),f=s(n(364));n(1179);var C=n(65),m=n(617),g=n(41),T=n(7),I=n(8),h=n(105),A=n(1181),y=n(89),R=n(15),D=function(e){function t(t){var n=e.call(this,t)||this;return n.state={descriptionLength:0},n}return i(t,e),t.prototype.renderHierarchySecondaryControl=function(){var e,t,n=this,r={id:"",attributeInfo:{id:"",name:"attributeforhierarchyentity",entityName:this.props.forecastConfigInfo.hierarchyEntity?this.props.forecastConfigInfo.hierarchyEntity:""},onChange:function(e){var t={attributeName:e,relationship:{entityName:n.props.forecastConfigInfo.hierarchyEntity,linkedByAttribute:null,relationship:null}},r=n.GetHierarchyAttributeInfoType(e);n.props.updateColumnFieldValue(n.props.forecastColumnInfo.id,"dataType",d.setDatatypefromCrmDatatype(r)),n.props.updateColumnFieldValue(n.props.forecastColumnInfo.id,"hierarchyAttributeInfo",t)},value:this.props.selectedHierarchySecondaryAttribute?this.props.selectedHierarchySecondaryAttribute:"",crmDataAcces:this.props.crmDataAccess,isDisabled:this.props.isFormLocked,showNoneOption:!1,attributesTypes:[y.EDataType.Lookup,y.EDataType.String,y.EDataType.Currency,y.EDataType.Decimal,y.EDataType.WholeNumber,y.EDataType.Owner]},i=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_ATTRIBUTE_FIELD_SELECTION);return"LookupType"==(this.props.forecastColumnInfo.hierarchyAttributeInfo?this.GetHierarchyAttributeInfoType(this.props.forecastColumnInfo.hierarchyAttributeInfo.attributeName):null)?(e=l.createElement(p.Label,{htmlFor:"LoadingInput",style:{fontWeight:600}},i),t=l.createElement("div",{id:"LoadingInput",style:{height:"32px",borderWidth:"1px",borderStyle:"solid",borderColor:"rgb(165, 165, 165)"}},l.createElement(p.Spinner,{size:p.SpinnerSize.medium,style:{float:"right",margin:"6px"}}))):t=l.createElement(E.default,o({},r,{label:i})),l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{helperText:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_ATTRIBUTE_HELPER),labelText:i},e,t))},t.prototype.GetHierarchyAttributeInfoType=function(e){var t=this.props.forecastConfigInfo.hierarchyEntity;if(null!=this.props.entityMetadataList[t]){var n=this.props.entityMetadataList[t].AttributesMetadata.DependentAttributes.find((function(t){return t.LogicalName==e}));if(null!=n)return n.AttributeType}return""},t.prototype.renderTypePicker=function(){var e=this,t=this.props.forecastColumnInfo.columnType,n=g.ForecastingBusinessLogicProvider.GetColumnTypeOptionsBasedOnCurrentType(t),r=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_TYPE_SECTION),i=g.ForecastingBusinessLogicProvider.GetIsColumnTypeControlDisabledBasedOnCurrentType(this.props.forecastColumnInfo.uniqueName,t);return l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{helperText:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_TYPEFIELD_HELPER),labelText:r},l.createElement(p.Dropdown,{label:r,disabled:this.props.isFormLocked||i,selectedKey:t,onChange:function(t,n){n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"columnType",n.key)},placeholder:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_TYPE_PLACEHOLDER),options:n})))},t.prototype.renderDataType=function(){var e=this,t=this.props.forecastColumnInfo.dataType,n=this.props.forecastColumnInfo.columnType,r=g.ForecastingBusinessLogicProvider.GetColumnDataTypeOptionsBasedOnCurrentType(n),i=g.ForecastingBusinessLogicProvider.GetIsColumnDataTypeControlDisabledBasedOnCurrentType(this.props.forecastColumnInfo.uniqueName,n),o=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DATATYPE_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{helperText:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DATATYPEFIELD_HELPER),labelText:o},l.createElement(p.Dropdown,{label:o,disabled:this.props.isFormLocked||i,selectedKey:t,onChange:function(t,n){R.logUsage("ColumnInfoEditor.ColumnInfoType","",{key:n&&n.key},"Edit"),n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"dataType",n.key)},placeholder:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DATATYPE_PLACEHOLDER),options:r})))},t.prototype.renderNameControl=function(){var e=this,t=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_NAME_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{labelText:t},l.createElement("div",null,l.createElement(p.TextField,{className:"columnNameField",value:this.props.forecastColumnInfo.title,label:t,disabled:!this.props.arePostPublishUpdatableFieldsUpdatable,placeholder:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_NAME_PLACEHOLDER),ariaLabel:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_NAME_PLACEHOLDER),onChange:function(t,n){void 0!==n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"title",h.sanitizeNameString(n))}}))))},t.prototype.renderUniqueNameControl=function(){var e=this,t=this.props.forecastColumnInfo.uniqueName,n=this.props.isUniqueNameDuplicate,r=this.props.isUniqueNameProper,i=void 0;n?i=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE):r||(i=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_IMPROPER_UNIQUE_NAME_MESSAGE));var o=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement("div",{style:{marginTop:24,marginBottom:16},className:"formSectionDivider"}),l.createElement(f.default,{labelText:o},l.createElement(p.TextField,{value:t,styles:{fieldGroup:{borderWidth:"thin"}},label:o,disabled:this.props.isUniqueNameDisabled,placeholder:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER),ariaLabel:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER),onChange:function(t,n){void 0!==n&&e.props.onUniqueNameChange(e.props.forecastColumnInfo.id,n)},errorMessage:i})))},t.prototype.renderAllowAdjustmentControl=function(){var e=this,t=this.props.forecastColumnInfo.isManuallyAdjustable,n=this.props.isColumnManuallyAdjusted;return l.createElement("div",{className:"columnEditorField"},l.createElement(p.Checkbox,{label:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_ALLOW_ADJUSTMENTS_SECTION),checked:t,disabled:this.props.isFormLocked&&n,onChange:function(t,n){R.logUsage("ColumnInfoEditor.AllowAdjustment","",{checked:n},"Click"),null!=n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"isManuallyAdjustable",n)}}))},t.prototype.renderShowProgressControl=function(){var e=this,t=this.props.forecastColumnInfo.showProgressComparedToQuota,n=this.props.forecastColumnInfo.dataType==u.ForecastColumnDataType.Currency,r="quota"==this.props.forecastColumnInfo.uniqueName;return l.createElement("div",{className:"columnEditorField"},l.createElement(p.Checkbox,{label:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_SHOW_PROGRESS_SECTION),checked:t,disabled:!this.props.arePostPublishUpdatableFieldsUpdatable||!n||r,onChange:function(t,n){R.logUsage("ColumnInfoEditor.ShowProgressQuota","",{checked:n},"Click"),null!=n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"showProgressComparedToQuota",n)}}))},t.prototype.renderAmountField=function(){var e=this,t=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_AMOUNT_FIELD_SECTION),n={id:"",attributeInfo:{id:"",name:"amountAttribute",entityName:this.props.forecastConfigInfo.rollupEntity,type:_.ICrmAttributeType.AmountField},onChange:function(t){e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"amountField",t)},value:this.props.forecastColumnInfo.amountField,crmDataAcces:this.props.crmDataAccess,isDisabled:this.props.isFormLocked,label:t,showNoneOption:!1};return l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{helperText:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_AMOUNTFIELD_HELPER),labelText:t},l.createElement(E.default,o({},n))))},t.prototype.renderDateField=function(){var e=this,t=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DATE_FIELD_SECTION),n={id:"",attributeInfo:{id:"",name:"dateAttribute",entityName:this.props.forecastConfigInfo.rollupEntity,type:_.ICrmAttributeType.DateField},onChange:function(t){e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"dateField",t)},value:this.props.forecastColumnInfo.dateField,crmDataAcces:this.props.crmDataAccess,isDisabled:this.props.isFormLocked,label:t};return l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{helperText:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DATEFIELD_HELPER),labelText:t},l.createElement(E.default,o({},n))))},t.prototype.renderSelectorField=function(){var e=this,t=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_SELECTOR_SECTION),n={id:"",attributeInfo:{id:"",name:this.props.forecastConfigInfo.forecastCategoryAttributeName,entityName:this.props.forecastConfigInfo.rollupEntity,type:_.ICrmAttributeType.OptionSet},onChange:function(t){R.logUsage("ColumnInfoEditor.RollupColumnSelector","",{newVal:t},"Edit"),e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"optionSetValue",parseInt(t))},value:""+this.props.forecastColumnInfo.optionSetValue,crmDataAcces:this.props.crmDataAccess,label:t,isDisabled:this.props.isFormLocked};return l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{helperText:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_SELECTORFIELD_HELPER),labelText:t},l.createElement(S.default,o({},n))))},t.prototype.renderCalculationField=function(){var e=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{labelText:e},l.createElement(A.ConnectedCalculatedColumnWithSuggestion,null)))},t.prototype.renderDescription=function(){var e=this,t=T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DESCRIPTION_FIELD_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement(f.default,{labelText:t},l.createElement(p.TextField,{value:this.props.forecastColumnInfo.description,label:t,disabled:!this.props.arePostPublishUpdatableFieldsUpdatable,description:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DESCRIPTION_DESCRIPTION),placeholder:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_DESCRIPTION_PLACEHOLDER),onChange:function(t,n){void 0!==n&&(n.length<=100?e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"description",h.sanitizeNameString(n)):e.setState({descriptionLength:n.length}))}})))},t.prototype.render=function(){var e=void 0;return e=this.props.forecastColumnInfo.columnType==u.ForecastColumnType.Rollup?l.createElement("div",null,this.renderSelectorField(),this.renderDataType(),this.renderAmountField(),this.renderDateField(),this.renderDescription(),this.renderAllowAdjustmentControl(),this.renderShowProgressControl(),this.renderShowInTrendChart()):this.props.forecastColumnInfo.columnType==u.ForecastColumnType.Calculated?l.createElement("div",null,this.renderDataType(),this.renderCalculationField(),this.renderDescription(),this.renderShowProgressControl(),this.renderShowInTrendChart()):this.props.forecastColumnInfo.columnType==u.ForecastColumnType.HierarchySecondary?l.createElement("div",null,this.renderDataType(),this.renderHierarchySecondaryControl(),this.renderDescription(),this.renderShowProgressControl()):l.createElement("div",null,this.renderDataType(),this.renderDescription(),this.renderShowProgressControl()),l.createElement("div",{style:{paddingRight:24,paddingLeft:24,height:"100%",overflowY:"auto",paddingBottom:"24px"}},this.renderNameControl(),this.renderTypePicker(),e,this.renderUniqueNameControl())},t.prototype.renderShowInTrendChart=function(){var e=this,t=this.props.forecastColumnInfo.showInTrendChart,n=!this.props.arePostPublishUpdatableFieldsUpdatable||g.ForecastingBusinessLogicProvider.GetIsShowInChartDisabledBasedOnDataType(this.props.forecastColumnInfo.dataType);return l.createElement("div",{className:"columnEditorField"},l.createElement(p.Checkbox,{label:T.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_COLUMN_EDITOR_SHOW_IN_TREND_CHART_SECTION),checked:t,disabled:n,onChange:function(t,n){R.logUsage("ColumnInfoEditor.ShowInTrendChart","",{checked:n},"Click"),null!=n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"showInTrendChart",n)}}))},t}(l.Component);t.ColumnEditorForm=D;t.ConnectedColumnEditorForm=c.connect((function(e){return{forecastColumnInfo:d.GetActiveForecastColumnInfo_FromState(e),forecastConfigInfo:e.FormFieldData,isFormLocked:C.GetIsFormLocked_FromState(e),arePostPublishUpdatableFieldsUpdatable:C.ArePostPublishUpdatableFieldsUpdatable(e),isUniqueNameDuplicate:d.IsUniqueNameForCurrentForecastColumnDuplicateInFC(e),isUniqueNameProper:d.IsUniqueNameForCurrentForecastColumnProper(e),isUniqueNameDisabled:d.IsUniqueNameDisabled(e),isColumnManuallyAdjusted:d.IsCurrentColumnManuallyAdjusted(e),selectedHierarchySecondaryAttribute:d.GetSelectedHierarchySecondaryAttributeFromEntity(e),entityMetadataList:e.entityMetadataList}}),(function(e){return{updateColumnFieldValue:function(t,n,r){m.ColumnEditorFormOperations.UpdateColumnFieldValue(e,t,n,r)},onUniqueNameChange:function(t,n){m.ColumnEditorFormOperations.UpdateUniqueName(e,t,n)}}}))(D)},function(e,t,n){var r=n(1180);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".columnEditorField {\n  margin-top: 24px; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(7),c=n(8),u=n(108),d=n(65),p=n(617),_=n(23),E=n(15),S=function(e){function t(t){var n=e.call(this,t)||this;return n._textFieldRef=a.default.createRef(),n._textFieldHtmlRef=a.default.createRef(),n.state={isTextFieldFocused:!1,isKeyDownPress:!1},n}return i(t,e),t.prototype.renderCalculationField=function(){var e=this,t=void 0;return this.props.isCalculatedFieldExpressionErrorHidden||(t=this.props.calculatedFieldExpressionErrorMessage),a.default.createElement("div",{ref:this._textFieldHtmlRef},a.default.createElement(s.TextField,{componentRef:this._textFieldRef,value:this.props.forecastColumnInfo.calculatedFieldExpression,required:!0,label:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SECTION),disabled:this.props.isFormLocked,spellCheck:!1,multiline:!0,rows:3,placeholder:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_PLACEHOLDER),onChange:function(t,n){if(void 0!==n&&null!==e._textFieldRef.current&&null!==e._textFieldRef.current.selectionEnd){var r=e._textFieldRef.current.selectionEnd;e.props.updateCalculatedFieldExpressionValue(n,r,e.props.forecastColumnInfo,e.props.forecastConfigInfo)}},onBlur:function(t){null!=e._textFieldRef.current&&void 0!==e._textFieldRef.current.value&&e.props.onCalculatedFieldExpressionBlur(e._textFieldRef.current.value,e.props.isCalculatedFieldSuggestionsCalloutVisible,e.props.forecastColumnInfo,e.props.forecastConfigInfo)},onKeyDown:function(t){e.keyDownHandler(t)},errorMessage:t,onFocus:function(t){if(null!==e._textFieldRef.current&&void 0!==e._textFieldRef.current.value&&null!=e._textFieldRef.current.selectionEnd){var n=e._textFieldRef.current.value,r=e._textFieldRef.current.selectionEnd;e.props.onCalculatedFieldExpressionFocus(n,r,e.props.forecastColumnInfo,e.props.forecastConfigInfo)}}}))},t.prototype.renderSuggestionFlyout=function(){var e,t=this,n=this.props.calculatedFieldExpressionSuggestions;this.props.isCalculatedFieldSuggestionsCalloutVisible&&this._textFieldHtmlRef.current&&document.contains(this._textFieldHtmlRef.current)?(e=document.querySelector(".ForecastConfigReadAlert"))&&(e.textContent=l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_CALCULATED_SUGGESTION_AVAILABLE)):(e=document.querySelector(".ForecastConfigReadAlert"))&&""!==e.textContent&&(e.textContent=l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_CALCULATED_SUGGESTION_UNAVAILABLE));return a.default.createElement("div",{className:"suggestionFlyOut",key:1,"data-is-focusable":!0},this.props.isCalculatedFieldSuggestionsCalloutVisible&&this._textFieldHtmlRef.current&&document.contains(this._textFieldHtmlRef.current)&&a.default.createElement(s.ContextualMenu,{target:this._textFieldHtmlRef.current,items:this.getSuggestionItemForList(n),shouldFocusOnMount:this.state.isKeyDownPress,onDismiss:function(e){t.setState({isKeyDownPress:!1}),t.props.onSuggestionFlyOutDismiss()},calloutProps:{calloutMaxHeight:192,calloutWidth:669},styles:{header:{selectors:{".ms-ContextualMenu-itemText":{fontSize:"14px"},".ms-ContextualMenu-secondaryText":{textAlign:"left",fontSize:"14px",paddingLeft:"5px",color:"#0078D4"}}},list:{selectors:{".ms-ContextualMenu-secondaryText":{textAlign:"left",minWidth:"150px",maxWidth:"300px",paddingLeft:"5px",color:"#323130"}}}}}))},t.prototype.keyDownHandler=function(e){40==e.keyCode&&this.props.isCalculatedFieldSuggestionsCalloutVisible&&this.setState({isKeyDownPress:!0})},t.prototype.getSuggestionItemForList=function(e){var t=this,n=[];return n.push({key:"Headers",text:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER),secondaryText:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER_SECONDARY),itemType:s.ContextualMenuItemType.Header}),e.forecastColumns.forEach((function(e){var r=l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_ASSOCIATED_WITH_UNIQUENAME);r=(r=r.replace("{0}",e.title)).replace("{1}",e.uniqueName),n.push({key:e.uniqueName,text:e.title,secondaryText:e.uniqueName,ariaLabel:r,onClick:function(){t.selectColumnAndAutoPopulateCalculatedField(e.uniqueName)}})})),n},t.prototype.selectColumnAndAutoPopulateCalculatedField=function(e){if(null!==this._textFieldRef.current&&null!==this._textFieldRef.current.selectionEnd){var t=this.props.forecastColumnInfo,n=this._textFieldRef.current.selectionEnd,r=this.props.calculatedFieldExpressionSuggestions;this.props.applySuggestions(t,e,n,r)}},t.prototype.render=function(){return a.default.createElement("div",null,this.renderCalculationField(),this.renderSuggestionFlyout())},t.prototype.componentWillUnmount=function(){var e=document.querySelector(".ForecastConfigReadAlert");e&&(e.textContent="")},t}(a.default.Component);t.CalculatedColumnWithSuggestion=S;t.ConnectedCalculatedColumnWithSuggestion=_.connect((function(e){return{forecastColumnInfo:u.GetActiveForecastColumnInfo_FromState(e),forecastConfigInfo:e.FormFieldData,isFormLocked:d.GetIsFormLocked_FromState(e),isCalculatedFieldExpressionErrorHidden:u.GetIsCalculatedFieldExpressionErrorHidden_FromState(e),calculatedFieldExpressionErrorMessage:u.GetCalculatedFieldExpressionErrorMessage_FromState(e),calculatedFieldExpressionSuggestions:u.GetCalculatedFieldExpressionSuggestions_FromState(e),isCalculatedFieldSuggestionsCalloutVisible:u.IsCalculatedFieldSuggestionsCalloutVisible_FromState(e)}}),(function(e){return{updateCalculatedFieldExpressionValue:function(t,n,r,i){p.ColumnEditorFormOperations.UpdateCalculatedFieldExpressionValue(e,n,t,r,i)},onCalculatedFieldExpressionBlur:function(t,n,r,i){E.logUsage("CalculateColumn.onCalculatedFieldExpressionBlur","",{calculatedFieldExpression:t},"Click"),p.ColumnEditorFormOperations.OnCalculatedFieldExpressionBlur(e,t,n,r,i)},onCalculatedFieldExpressionFocus:function(t,n,r,i){p.ColumnEditorFormOperations.OnCalculatedFieldExpressionFocus(e,t,n,r,i)},onSuggestionFlyOutDismiss:function(){E.logUsage("CalculateColumn.onSuggestionFlyOutDismiss","",{},"Click"),p.ColumnEditorFormOperations.OnSuggestionCalloutDismiss(e)},applySuggestions:function(t,n,r,i){E.logUsage("CalculateColumn.applySuggestions","",{},"Click"),p.ColumnEditorFormOperations.ApplySuggestions(e,t,n,r,i)}}}))(S)},function(e,t,n){var r=n(1183);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,'.mainPanelContainer_stage2 {\n  display: grid;\n  grid-template-columns: 330px 1px auto;\n  grid-template-rows: 480px;\n  border: thin solid #E1DFDD;\n  margin-right: 23px; }\n\n.leftPanel_stage2 {\n  width: 100%;\n  grid-column: 1;\n  overflow: hidden;\n  padding-bottom: 24px;\n  height: 100%; }\n\n.editorContainer .ms-Label::after {\n  padding-left: 3px !important; }\n\n.verticleDivider {\n  width: 0;\n  border-right: thin solid #E1DFDD;\n  height: 100%;\n  grid-column: 2; }\n\n.addFilterTitle {\n  font-size: 18px;\n  font-weight: 600;\n  color: #323130;\n  line-height: 24px; }\n\n.addtionalFilters {\n  padding-top: 32px; }\n\n.addFilterSubTitle {\n  margin-top: 8px;\n  font-size: 14px;\n  color: #605E5C;\n  line-height: 20px; }\n\n.filterControlPane {\n  display: flex;\n  flex-direction: column;\n  font-size: 18px; }\n\n.expressionBuilderControlClass {\n  padding-top: 24px; }\n\n.previewGrid {\n  grid-column: 3;\n  width: "100%"; }\n\n.header_stage2 {\n  width: 100%; }\n\n.colOptionDesc {\n  margin-top: 8px;\n  margin-bottom: 24px; }\n\n.editorOn {\n  animation-duration: 700ms;\n  animation-name: slidein;\n  animation-fill-mode: forwards; }\n\n.overviewOn {\n  animation-duration: 500ms;\n  animation-name: slideout;\n  animation-fill-mode: forwards; }\n\n@keyframes slideout {\n  from {\n    transform: translate(-100%); }\n  to {\n    transform: translate(0); } }\n\n@keyframes slidein {\n  from { }\n  to {\n    transform: translate(-100%); } }\n\n/* RTL changes */\n.editorOn_rtl {\n  animation-duration: 700ms;\n  animation-name: slidein_rtl;\n  animation-fill-mode: forwards; }\n\n.overviewOn_rtl {\n  animation-duration: 500ms;\n  animation-name: slideout_rtl;\n  animation-fill-mode: forwards; }\n\n@keyframes slideout_rtl {\n  from {\n    transform: translate(100%); }\n  to {\n    transform: translate(0); } }\n\n@keyframes slidein_rtl {\n  from { }\n  to {\n    transform: translate(100%); } }\n\n.ms-CommandBar {\n  padding-left: 0px !important; }\n\n.previewGridTitle {\n  margin-top: 10px;\n  font-weight: 600;\n  font-size: 14px; }\n\n.ribbonBtn {\n  background: none;\n  border-width: 0; }\n\n.ribbonBtn:hover {\n  background: #F3F2F1; }\n\n.ribbonButtonDivider {\n  border-left: thin solid #E1DFDD;\n  margin-top: 6px;\n  margin-bottom: 6px; }\n',""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(45);n(1185);var c=n(23),u=n(108),d=n(44),p=n(393),_=n(228),E=n(7),S=n(8),f=n(1187),C=n(1188),m=n(65),g=n(15);l.initializeIcons();var T=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isDeleteDialogOpen:!1,deleteColumnTitle:"",deleteColumnId:""},n}return i(t,e),t.prototype.render=function(){var e=this.getDynamicColumnsFromProps();return a.default.createElement("div",{className:"columnsAndUpsellContainer"},a.default.createElement("div",{style:{paddingLeft:"8px",paddingRight:"7px",marginTop:"24px",overflowY:"auto",height:"100%"}},e,this.renderDeleteConfirmationDialog()),a.default.createElement(f.ConnectedColumnConfigAutoPopulationDialog,null),this.props.shouldShowUpsellControl&&this.renderUpsellSection())},t.prototype.renderUpsellSection=function(){return a.default.createElement("div",{className:"upsellContainer"},a.default.createElement("div",{className:"upsellIconAndHeaderContainer"},a.default.createElement(s.Icon,{iconName:"Chart",className:"upsellIcon"}),a.default.createElement("span",{className:"upsellIconHeader"},E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_FORECASTING))),a.default.createElement("div",{className:"upsellMessage"},a.default.createElement("span",null,E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION)+" ",a.default.createElement("a",{style:{textDecoration:"none"},"aria-label":E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION),href:"https://aka.ms/learnpredictiveforecasting"},E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_COLUMN_OVERVIEW_LINK)))))},t.prototype.getDynamicColumnsFromProps=function(){var e=this;return a.default.createElement("div",null,this.props.columnInfoList.map((function(t,n){return e.renderRowItemForColumn(t,n)})))},t.prototype.handleAction=function(e,t,n){switch(e){case p.ColumnSelectorActionType.CheckBoxClicked:g.logUsage("ColumnOverviewPanel.ContextMenuItem.CheckBox","",{index:n},"Click"),this.props.updateActiveState(t.id,!t.isActive);break;case p.ColumnSelectorActionType.Configure:g.logUsage("ColumnOverviewPanel.ContextMenuItem.Configure","",{index:n},"Click"),this.props.openColumnEditPage(t);break;case p.ColumnSelectorActionType.MoveUp:if(g.logUsage("ColumnOverviewPanel.ContextMenuItem.MoveUp","",{index:n},"Click"),n>0){var r=this.props.columnInfoList[n-1].id;this.props.onMoveColumn(t.id,r)}break;case p.ColumnSelectorActionType.MoveDown:if(g.logUsage("ColumnOverviewPanel.ContextMenuItem.MoveDown","",{index:n},"Click"),n<this.props.columnInfoList.length-1){r=this.props.columnInfoList[n+1].id;this.props.onMoveColumn(t.id,r)}break;case p.ColumnSelectorActionType.Delete:g.logUsage("ColumnOverviewPanel.ContextMenuItem.Delete","",{index:n},"Click"),t.dependentCalculatedColumns&&0==t.dependentCalculatedColumns.length?this.setState({isDeleteDialogOpen:!0,deleteColumnId:t.id,deleteColumnTitle:t.title}):this.props.deleteColumnFailureDialog(t.dependentCalculatedColumns)}},t.prototype.dismissDeleteDialog=function(){this.setState({isDeleteDialogOpen:!1})},t.prototype.renderDeleteConfirmationDialog=function(){var e=this;return a.default.createElement(s.Dialog,{hidden:!this.state.isDeleteDialogOpen,onDismiss:function(){e.dismissDeleteDialog()},dialogContentProps:{type:s.DialogType.normal,title:E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_COLUMN_OVERVIEW_DELETE_DIALOG_TITLE),subText:E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_COLUMN_OVERVIEW_DELETE_DIALOG_DESCRIPTION)},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450,outline:"1px solid transparent !important"}}}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{text:E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE),onClick:function(){e.props.deleteColumn(e.state.deleteColumnId),e.dismissDeleteDialog()}}),a.default.createElement(s.DefaultButton,{text:E.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),onClick:function(){e.dismissDeleteDialog()}})))},t.prototype.renderRowItemForColumn=function(e,t){var n=this;return a.default.createElement(p.ColumnSelectorRow,{onAction:function(r){n.handleAction(r,e,t)},order:t,status:e.status,title:e.title,isActive:e.isActive,columnType:e.columnType,formStatus:this.props.formStatus,columnUniqueName:e.uniqueName,arePostPublishUpdatableFieldsUpdatable:this.props.arePostPublishUpdatableFieldsUpdatable,fcPredictionStatus:this.props.fcPredictionStatus})},t}(a.default.Component);t.default=T;t.ConnectedColumnsOverview=c.connect((function(e){return{columnInfoList:u.GetForecastColumnsWithStatusList_FromState(e),formStatus:e.FormFieldData.status,arePostPublishUpdatableFieldsUpdatable:m.ArePostPublishUpdatableFieldsUpdatable(e),shouldShowUpsellControl:1!=e.crmOrgInfo.isSILicenseAvailable,fcPredictionStatus:e.predictionStatusForFC}}),(function(e){return{updateActiveState:function(t,n){e(d.UpdateColumnInfoField(t,"isActive",n))},openColumnEditPage:function(t){e(d.UpdateIsEditorOpened(!0)),e(d.UpdateHasUniqueNameBeenEdited(!0)),e(d.UpdateIsCalculatedFieldExpressionErrorHidden(!0)),e(d.UpdateActiveForecastColumn(t))},onMoveColumn:function(t,n){e(_.ReorderColumnsWithId(t,n))},deleteColumn:function(t){e(d.DeleteColumn(t))},deleteColumnFailureDialog:function(t){C.ColumnOverviewOperations.ColumnDeleteFailureDialog(e,t)}}}))(T)},function(e,t,n){var r=n(1186);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".columnRow {\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  align-items: center;\n  margin-bottom: 5px;\n  height: 36px; }\n  .columnRow .columnMoreButton {\n    visibility: visible; }\n\n.columnRow:hover {\n  background: #F3F2F1; }\n  .columnRow:hover .columnMoreButton {\n    visibility: visible; }\n\n.expandedColumnRow {\n  background: #F3F2F1; }\n\n.columnCheckbox {\n  display: flex;\n  flex-direction: column;\n  width: 80%;\n  margin-left: 10px; }\n\n.iconsWarningAndGear {\n  display: flex;\n  flex-direction: row;\n  width: 20%;\n  justify-content: flex-end;\n  align-items: center; }\n\n.columnIcon {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  cursor: pointer; }\n\n.columnsAndUpsellContainer {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  overflow-y: auto;\n  height: 100%; }\n\n.upsellContainer {\n  background-color: #faf9f8;\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  flex: 0 1 auto;\n  justify-content: space-between; }\n\n.upsellIconAndHeaderContainer {\n  line-height: 16px;\n  display: flex;\n  flex-direction: row; }\n\n.upsellIcon {\n  color: #0742AB; }\n\n.upsellIconHeader {\n  align-items: center;\n  margin: 0px 8px;\n  font-family: Segoe UI;\n  font-size: 12px;\n  line-height: 16px;\n  text-transform: uppercase;\n  color: #0742AB; }\n\n.upsellMessage {\n  font-family: Segoe UI;\n  font-size: 12px;\n  line-height: 16px;\n  background: #FAF9F8;\n  margin-top: 12px; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(23),c=n(7),u=n(8),d=n(44),p=n(15),_=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.componentDidUpdate=function(e){if(0==e.isHidden&&1==this.props.isHidden){var t=document.querySelector(".overviewContainer .ribbonBtn");t&&window.setTimeout((function(){t.focus()}),500)}},t.prototype.render=function(){var e=this;return a.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:function(){e.props.onDismiss()},dialogContentProps:{type:s.DialogType.normal,title:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_TITLE),subText:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_DESCRIPTION)},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450,outline:"1px solid transparent !important"}}}},a.createElement(s.DialogFooter,null,a.createElement(s.PrimaryButton,{text:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_PRIMARY_BUTTON),onClick:function(){e.props.onOK()}}),a.createElement(s.DefaultButton,{text:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),onClick:function(){e.props.onDismiss()}})))},t}(a.Component);t.ColumnConfigAutoPopulationDialog=_,t.default=_,t.ConnectedColumnConfigAutoPopulationDialog=l.connect((function(e){return{isHidden:!e.columnEditorState.isColumnConfigAutopopulationDialogOpen}}),(function(e){return{onDismiss:function(){p.logUsage("AutoPopulationDialog.Dismiss button","",{},"Click"),e(d.UpdateIsColumnConfigAutoPopulateDialogOpen(!1))},onOK:function(){p.logUsage("AutoPopulationDialog.OK button","",{},"Click"),e(d.UpdateIsColumnConfigAutoPopulateDialogOpen(!1)),e(d.TriggerColumnConfigAutoPopulate())}}}))(_)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(87),i=n(98),o=n(7),a=n(8),s=function(){function e(){}return e.ColumnDeleteFailureDialog=function(t,n){var s=e.getAllColumnNames(n),l=o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_DELETE_COLUMN_DEPENDENTLIST).replace("{0}",s);t(i.onErrorShowDialogActionCreator(r.IErrorDialogType.ForecastConfigColDeleteFailed,l))},e.getAllColumnNames=function(e){var t=[];return e.forEach((function(e){t.push(e.title)})),t.join(", ")},e}();t.ColumnOverviewOperations=s},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(23);n(1190);var l=n(22),c=n(82),u=n(1192),d=n(7),p=n(8),_=n(15),E=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.renderOptionInfoBox=function(e,t,n,r){var i=d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_OPTIONSET_PANEL_OPTION_SUBHEADER);return a.createElement("div",{className:"optionSetItemContainer"},a.createElement("div",{className:"optionSetRadioBox"},e),a.createElement("div",{className:"optionInfoContainer"},a.createElement("div",{className:"optionTitleBox"},n),a.createElement("div",{className:"optionsListBox"},a.createElement("span",{className:"COLUMN_LabelText"},i),": ",r)))},t.prototype.componentDidMount=function(){!this.props.categoryAttributeName&&this.props.optionSetInfoList.find((function(e){return"msdyn_forecastcategory"===e.logicalName}))&&this.props.onChange("msdyn_forecastcategory")},t.prototype.render=function(){var e=this;return a.createElement("div",{style:{overflowY:"auto",paddingLeft:16,paddingRight:16}},a.createElement("div",{className:"optionSelectorHeader"},d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_OPTIONSET_PANEL_HEADER)," ",this.renderHelperTooltip(d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_COLUMN_EDITOR_OPTIONSET_HELPER))),a.createElement(l.ChoiceGroup,{className:"defaultChoiceGroup",selectedKey:this.props.categoryAttributeName,options:this.getChoiceOptionsList(),onChange:function(t,n){n&&e.props.onChange(n.key)}}))},t.prototype.renderHelperTooltip=function(e,t,n){return void 0===t&&(t="optionSetHelper"),void 0===n&&(n="Info"),a.createElement(l.TooltipHost,{styles:{root:{display:"flex",alignItems:"center"}},content:e,id:t,directionalHint:l.DirectionalHint.rightCenter},a.createElement(l.Icon,{iconName:n,className:"ms-IconExample formLabelHelpIcon"}))},t.prototype.collectMembersString=function(e){var t="";return e.map((function(n,r){t+=n,r+1!==e.length&&(t+=", ")})),t},t.prototype.getChoiceOptionsList=function(){var e=this;return this.props.optionSetInfoList.map((function(t,n){var r=e.collectMembersString(t.members);return{key:t.logicalName,text:"",className:"optionSetItemRoot",ariaLabel:t.displayName,onRenderField:function(i,o){return e.renderOptionInfoBox(o(i),n+1,t.displayName,r)},onRenderLabel:function(){},styles:{choiceFieldWrapper:{width:"100%"}}}}))},t}(a.Component);t.OptionSetSelectorChoiceList=E;t.ConnectedOptionSetSelectorChoiceList=s.connect((function(e){return{optionSetInfoList:c.GetOptionSetAttributeInfoList_FromState(e),categoryAttributeName:c.GetSelectedOptionSetAttribute_FromState(e)}}),(function(e){return{onChange:function(t){_.logUsage("FCategoryOptionSetSelector","",{val:t},"Edit"),u.ChoiceListOperations.OnChoiceChange(e,t)}}}))(E)},function(e,t,n){var r=n(1191);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".optionSetItemContainer {\n  width: 100%;\n  border-bottom: thin solid #F3F2F1;\n  display: flex; }\n\n.optionInfoContainer {\n  height: auto;\n  width: 100%;\n  padding-bottom: 8px;\n  display: flex;\n  flex-direction: column; }\n\n.optionSetRadioBox {\n  width: 35px;\n  display: flex;\n  align-items: center; }\n\n.optionTitleBox {\n  color: #323130;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 600; }\n\n.optionsListBox {\n  font-size: 12px;\n  line-height: 16px;\n  color: #797775; }\n\n.COLUMN_LabelText {\n  font-weight: 600; }\n\n.optionSelectorHeader {\n  margin-top: 16px;\n  margin-bottom: 24px;\n  color: #323130;\n  font-size: 14px;\n  font-weight: 600;\n  display: flex; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=function(){function e(){}return e.OnChoiceChange=function(e,t){e(r.UpdateSelectedOptionSetValue(t))},e}();t.ChoiceListOperations=i},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),o=n(22),a=n(23),s=n(1194),l=n(7),c=n(8),u=n(15);t.CategoryChangeConfirmationDialog=function(e){return i.createElement(o.Dialog,{hidden:e.isHidden,onDismiss:function(){e.onDismiss()},dialogContentProps:{type:o.DialogType.normal,title:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_TITLE),subText:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_DESCRIPTION)},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450,outline:"1px solid transparent !important"}}}},i.createElement(o.DialogFooter,null,i.createElement(o.PrimaryButton,{text:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_PRIMARY_BUTTON),onClick:function(){e.onReplace()}}),i.createElement(o.DefaultButton,{text:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),onClick:function(){e.onDismiss()}})))},t.ConnectedChangeConfirmationDialog=a.connect((function(e){return{isHidden:!e.columnEditorState.isChangeConfirmationDialogOpen}}),(function(e){return{onDismiss:function(){u.logUsage("OptionChangeConfirmationDialog.Cancel","",{},"Click"),s.ChangeConfirmationDialogOperations.Dismiss(e)},onReplace:function(){u.logUsage("OptionChangeConfirmationDialog.Replace","",{},"Click"),s.ChangeConfirmationDialogOperations.Replace(e)}}}))(t.CategoryChangeConfirmationDialog)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),i=n(619),o=function(){function e(){}return e.Dismiss=function(e){e(r.UpdateIsChangeConfirmationDialogOpen(!1))},e.Replace=function(e){this.Dismiss(e),i.OptionSetRibbonOperations.SaveFieldAndClose(e)},e}();t.ChangeConfirmationDialogOperations=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(620),i=n(43),o=n(44),a=function(){function e(){}return e.OnClickHandler=function(t,n){switch(n){case r.ColumnEditorRibbonActionType.Cancel:e.onCancel(t);break;case r.ColumnEditorRibbonActionType.SaveAndClose:e.onSaveAndClose(t)}},e.onSaveAndClose=function(e){e(i.TriggerSave(!1,!0))},e.onCancel=function(e){e(i.TriggerUndoColumnFormChanges()),this.dismissPanel(e)},e.dismissPanel=function(e){e(o.UpdateIsEditorOpened(!1)),e(o.UpdateIsOptionSetSelectorOpened(!1))},e}();t.ColumnEditorRibbonOperations=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(621),i=n(95),o=n(44),a=function(){function e(){}return e.OnClickHandler=function(t,n){switch(n){case r.ColumnOverviewRibbonActionType.CreateNewColumn:e.createNewColumn(t);break;case r.ColumnOverviewRibbonActionType.ChooseOptionSet:e.openOptionSetSelector(t)}},e.openOptionSetSelector=function(e){e(o.UpdateIsOptionSetSelectorOpened(!0))},e.createNewColumn=function(e){var t=i.GetNewEmptyForecastColumnInfo();e(o.AddColumn(t)),e(o.UpdateHasUniqueNameBeenEdited(!1)),e(o.UpdateIsCalculatedFieldExpressionErrorHidden(!0)),e(o.UpdateActiveForecastColumn(t)),e(o.UpdateIsEditorOpened(!0))},e}();t.ColumnOverviewRibbonOperations=a},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(622),l=n(1199),c=n(1201),u=n(65),d=n(23),p=n(1202),_=n(8),E=n(7),S=n(22);n(1203);var f=n(15),C=n(82),m=function(e){function t(t){var n=e.call(this,t)||this;return n.state={labels:void 0,dataTypes:[],isFilterClicked:!1,hasError:!1},n.cdsResolver=new s.CDSResolver(Promise.resolve(n.props.crmDataAccess.cdsClient)),n.handleFilterClick=n.handleFilterClick.bind(n),n}return i(t,e),t.prototype.handleFilterClick=function(){this.setState({isFilterClicked:!0})},t.prototype.componentWillMount=function(){var e=this;this.cdsResolver.getLocalizedLabels().then((function(t){var n;n=c.getFilteredList(t),e.setState({labels:t,dataTypes:n})}))},t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e){f.logError("Error while rendering Add filters",e,"")},t.prototype.render=function(){if(this.state.hasError)return a.createElement("div",{className:"expressionBuilderError"},E.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE));var e,t=this.state.isFilterClicked;if(this.props.isAdditionalFilterSameAsDefault&&!t)e=a.createElement(S.ActionButton,{className:"addFilterButton",allowDisabledFocus:!1,iconProps:{iconName:"add",style:{color:"#2266e3"}},disabled:this.props.isReadOnly,text:E.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_ADD_FILTERS_TEXT),onClick:this.handleFilterClick.bind(this)});else{if(!this.state.labels)return a.createElement("div",{className:"expressionBuilderControl"},E.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_LOADING));e=a.createElement("div",{className:"expressionBuilderControl"},a.createElement(l.CDSExpressionBuilderWithResolver,{cdsResolver:this.cdsResolver,entityName:this.props.entityName,onFetchXmlChanged:this.props.onFetchXmlChanged.bind(this),onFetchXmlValidationFailed:this.props.onFetchXmlValidationFailed.bind(this),dataTypes:this.state.dataTypes,query:{fetchXml:this.props.fetchXml},labels:this.state.labels,isReadOnly:this.props.isReadOnly}))}return a.createElement("div",null,e)},t}(a.PureComponent);t.DelfiExpressionBuilderWithClient=m;t.ConnectedExpressionBuilderFilter=d.connect((function(e){return{entityName:e.FormFieldData.rollupEntity,fetchXml:e.FormFieldData.additionalFilter,isReadOnly:u.GetIsFormLocked_FromState(e),isAdditionalFilterSameAsDefault:C.Get_IsAdditionalFilterSameAsDefault(e)}}),(function(e,t){return{onFetchXmlValidationFailed:function(e){f.logError("AdditionalFiltersControl",e,"",{})},onFetchXmlChanged:function(t){f.logUsage("AdditionalFiltersControl.onFetchXmlChanged","",{fetchXml:t},"Edit"),p.ExpressionBuilderFilterOperations.onAdditionalFilterChange(e,t)}}}))(m)},,,,function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(89);function o(e){var n=e.operators.filter((function(n){return t.GlobalFilterOperators[e.name].includes(n.name)}));return r({},e,{operators:n})}t.GlobalFilterOperators={String:["ne","eq","like","not-like","begins-with","does-not-begins-with","ends-with","does-not-ends-with","not-null","null"],Memo:["like","not-like","begins-with","does-not-begins-with","ends-with","does-not-ends-with","not-null","null"],Integer_None:["ne","eq","gt","ge","lt","le","not-null","null"],DateTime:["on","on-or-after","on-or-before"],Picklist:["ne","eq","not-null","null"],MultiSelectPicklistType:["not-null","null"],Boolean:["ne","eq","not-null","null"],Lookup:["ne","eq","like","not-like","begins-with","does-not-begins-with","ends-with","does-not-ends-with","not-null","null"],Customer:["ne","eq","like","not-like","begins-with","does-not-begins-with","ends-with","does-not-ends-with","not-null","null"],Owner:["ne","eq","not-null","null"],UniqueIdentifier:["ne","eq","not-null","null"],Money:["ne","eq","gt","ge","lt","le","not-null","null"],Double:["ne","eq","gt","ge","lt","le","not-null","null"],Decimal:["ne","eq","gt","ge","lt","le","not-null","null"],Integer_Language:["ne","eq","not-null","null"],Integer_Duration:["ne","eq","gt","ge","lt","le","not-null","null"]},t.getFilteredList=function(e){return[o(i.stringType(e)),o(i.multilineStringType(e)),o(i.wholeNumberType(e)),o(i.dateType(e)),o(i.optionSet(e)),o(i.multiOptionSet(e)),o(i.twoOptions(e)),o(i.lookupType(e)),o(i.customerType(e)),o(i.ownerType(e)),o(i.uidType(e)),o(i.currencyType(e)),o(i.floatType(e)),o(i.decimalType(e)),o(i.languageType(e)),o(i.durationType(e))]},t.filterOperator=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=function(){function e(){}return e.onAdditionalFilterChange=function(e,t){var n={additionalFilter:t};e(r.UpdateFieldValue(n))},e}();t.ExpressionBuilderFilterOperations=i},function(e,t,n){var r=n(1204);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".addFilterButton {\n  margin-left: -5px; }\n\n.addFilterButton:hover {\n  margin-left: -5px;\n  color: #2266e3; }\n\n.expressionBuilderControl h1 {\n  color: #2266e3;\n  font-weight: normal;\n  font-size: 12px;\n  line-height: 16px; }\n\n.expressionBuilderError {\n  color: #a80000;\n  font-size: 16px;\n  line-height: 16px; }\n",""])},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0)),o=n(22),a=n(7),s=n(8);t.default=function(){return i.default.createElement(o.MessageBar,{messageBarType:o.MessageBarType.warning,isMultiline:!1,styles:{iconContainer:{margin:10},text:{margin:10},root:{background:"#FFF4CE"}}},a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.MF_MAX_HIERARCHY_RECORDS_MESSAGE))}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(1207),l=n(188);n(1208);var c=n(23),u=n(1210),d=n(175),p=n(7),_=n(8),E=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:"statusDiv"},this.renderStatusInfo(s.IStatusFields.Status),this.renderSplit(),this.renderStatusInfo(s.IStatusFields.Type),this.renderSplit(),this.renderStatusLink(s.IStatusFields.Owner,this.props.Owner))},t.prototype.renderStatusInfo=function(e){return a.default.createElement("div",{className:"statusInfoDiv "},a.default.createElement("div",{className:"statusInfoFieldDiv"},a.default.createElement(l.Label,{className:""==this.props[e]?"statusEmptylabel":"statusInfoField"},this.props[e])),a.default.createElement("div",{className:"statusInfoLabelDiv"},a.default.createElement(l.Label,{className:"statusInfoLabel"},this.getStatusInfoLabel(e))))},t.prototype.renderStatusLink=function(e,t){var n=this;return a.default.createElement("div",{className:"statusInfoDiv"},a.default.createElement("div",{className:"statusInfoFieldDiv"},a.default.createElement(l.Label,{className:""==t.displayName?"statusEmptylabel":"statusLinkField",onClick:function(){return n.navigateToLink(t)},"aria-label":t.displayName,role:"link","data-is-focusable":!0,tabIndex:0},t.displayName)),a.default.createElement("div",{className:"statusInfoLabelDiv"},a.default.createElement(l.Label,{className:"statusInfoLabel"},this.getStatusInfoLabel(e))))},t.prototype.getStatusInfoLabel=function(e){switch(e){case s.IStatusFields.Status:return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_STATUS_STATUS_EDITPAGE);case s.IStatusFields.Type:return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_STATUS_TYPE_EDITPAGE);case s.IStatusFields.Owner:return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_STATUS_OWNER_EDITPAGE);default:return""}},t.prototype.renderSplit=function(){return a.default.createElement("div",{className:"verticalLine"})},t.prototype.navigateToLink=function(e){""!==e.id&&""!==e.entityLogicalName&&d.CrmNavigationHelpers.navigateToEntityForm(e.entityLogicalName,e.id)},t}(a.default.Component);t.default=E,t.ConnectedEditAppStatusInfo=c.connect((function(e){return u.getappStatusInfo(e)}))(E)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Status="Status",e.Type="Type",e.Owner="Owner"}(t.IStatusFields||(t.IStatusFields={}))},function(e,t,n){var r=n(1209);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".verticalLine {\n  width: 0px;\n  height: 40px;\n  border-left: thin solid #E1DFDD;\n  display: block; }\n\n.statusDiv {\n  white-space: nowrap;\n  flex-direction: row;\n  display: flex;\n  margin-left: 24px;\n  margin-right: 24px; }\n\n.statusInfoDiv {\n  margin-left: 12px;\n  margin-right: 12px; }\n\n.statusInfoField {\n  font-size: 14px;\n  font-family: 'Segoe UI';\n  line-height: 20px;\n  color: #323130;\n  font-weight: 600;\n  padding-top: 0;\n  padding-bottom: 0; }\n\n.statusLinkField {\n  font-size: 14px;\n  font-family: 'Segoe UI';\n  line-height: 20px;\n  color: #2266E3;\n  cursor: pointer;\n  font-weight: 600;\n  padding-top: 0;\n  padding-bottom: 0; }\n\n.statusLinkField:hover {\n  color: #0B53CE;\n  text-decoration: underline; }\n\n.statusInfoLabelDiv {\n  margin-top: 4px; }\n\n.statusEmptylabel {\n  margin-bottom: 24px; }\n\n.statusInfoLabel {\n  font-size: 12px;\n  line-height: 14px;\n  color: #605E5C;\n  padding-top: 0;\n  padding-bottom: 0; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),i=n(226),o=n(503);t.getappStatusInfo=function(e){return{Status:e.ActiveForecastConfigInfo.statusDescription?e.ActiveForecastConfigInfo.statusDescription:"",Type:o.getLocalizedTemplateName(e.FormFieldData.templateType),Owner:r.ForecastingBusinessLogicProvider.FieldHasNonNullValue("id",e.ActiveForecastConfigInfo.id)&&e.ActiveForecastConfigInfo.owner?e.ActiveForecastConfigInfo.owner:i.XrmHelper.getLoggedInUserInfo()}}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(22),s=o(n(0)),l=n(1212),c=n(23),u=n(65);n(1213);var d=n(1215),p=n(8),_=n(7),E=n(15),S=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){return s.default.createElement("div",null,s.default.createElement(a.CommandBar,{items:this.getItems(),styles:{root:{backgroundColor:"white"}}}))},t.prototype.getItems=function(){var e=this;return[{key:"editAppsave",name:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_RIBBON_SAVE_EDITPAGE),iconProps:{iconName:"Save"},className:"ms-CommandBarItem",disabled:!this.props.allowSaveOperation,onClick:function(){e.props.editAppRibbonAction(l.IEditAppCommand.Save)}},{key:"editAppsaveAndClose",name:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE),iconProps:{iconName:"SaveAndClose"},className:"ms-CommandBarItem",disabled:!this.props.allowSaveOperation,onClick:function(){e.props.editAppRibbonAction(l.IEditAppCommand.SaveAndClose)}},{key:"editAppDelete",name:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_RIBBON_DELETE_EDITPAGE),iconProps:{iconName:"Cancel",style:{color:"#A80000"}},className:"ms-CommandBarItem",disabled:this.props.isForecastConfigInCreateMode,onClick:function(){e.props.editAppRibbonAction(l.IEditAppCommand.Delete)}}]},t}(s.default.Component);t.default=S;t.ConnectedEditAppRibbon=c.connect((function(e){return{isForecastConfigInCreateMode:u.GetIsFormInCreateMode_FromState(e),allowSaveOperation:u.IsFormValidForSave_FromState(e)}}),(function(e){return{editAppRibbonAction:function(t){var n=new d.EditAppRibbonOperations(e);switch(t){case l.IEditAppCommand.Save:E.logUsage("Ribbon.Save button","",{},"Click"),n.OnSave();break;case l.IEditAppCommand.SaveAndClose:E.logUsage("Ribbon.SaveAndClose button","",{},"Click"),n.OnSaveAndClose();break;case l.IEditAppCommand.Delete:E.logUsage("Ribbon.Delete button","",{},"Click"),n.OnDelete()}}}}))(S)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Save=0]="Save",e[e.SaveAndClose=1]="SaveAndClose",e[e.Delete=2]="Delete"}(t.IEditAppCommand||(t.IEditAppCommand={}))},function(e,t,n){var r=n(1214);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".ms-CommandBarItem {\n  background: none !important;\n  border-width: 0; }\n  .ms-CommandBarItem:hover {\n    background-color: #eaeaea !important; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(99),o=function(){function e(e){this.dispatch=e}return e.prototype.OnSave=function(){this.dispatch(r.TriggerSave())},e.prototype.OnSaveAndClose=function(){this.dispatch(r.TriggerSave(!0))},e.prototype.OnDelete=function(){this.dispatch(i.onGridAppDialogDeleteStateActionCreator(!1))},e}();t.EditAppRibbonOperations=o},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(86),c=n(23),u=n(43),d=n(15),p=n(8),_=n(7),E=function(e){function t(t){var n=e.call(this,t)||this;return n._closeDialog=function(){d.logUsage("UpdateHierarchySelectionConfirmationDialog.Close","",{},"Click"),n.props.onClickUpdateDialog(l.IHierarchyEntityChangeActionType.CLOSE)},n._onClickConfirm=function(){d.logUsage("UpdateHierarchySelectionConfirmationDialog.OK","",{},"Click"),n.props.onClickUpdateDialog(l.IHierarchyEntityChangeActionType.UPDATE,n.props.hierarchyEntityName)},n._onCancel=function(){d.logUsage("UpdateHierarchySelectionConfirmationDialog.Cancel","",{},"Click"),n.props.onClickUpdateDialog(l.IHierarchyEntityChangeActionType.CANCEL)},n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._closeDialog,modalProps:{styles:{main:{outline:"1px solid transparent !important"}}},dialogContentProps:{type:s.DialogType.normal,title:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_TITLE),subText:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_DESCRIPTION)}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickConfirm,text:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_PRIMARYBUTTON)}),a.default.createElement(s.DefaultButton,{onClick:this._onCancel,text:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_SELECTOR_CONFIRMATION_DIALOG_SECONDARYBUTTON)})))},t}(a.default.Component);t.UpdateHierarchySelectionConfirmationDialog=E,t.default=E,t.ConnectedUpdateHierarchySelectionConfirmationDialog=c.connect((function(e){return{isHidden:e.editAppDialogState.hierarchyEntitydialogHiddenState,hierarchyEntityName:e.editAppDialogState.selectedHierarchyEntityName}}),(function(e){return{onClickUpdateDialog:function(t,n){var r;if(l.IHierarchyEntityChangeActionType.UPDATE.toString()!==t.toString())e(u.onHierarchyEntityActionCreator(!0,""));else{var i=((r={}).hierarchyEntity=n,r);e(u.UpdateFieldValue(i)),e(u.onHierarchyEntityActionCreator(!0,""))}}}}))(E)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(61);n(1218);var l=n(149),c=n(100),u=n(23),d=n(16),p=n(505),_=n(249),E=n(60),S=n(211),f=n(1220),C=n(32),m=n(95),g=n(7),T=n(8),I=n(300),h=n(1224),A=n(15),y=n(43),R=function(e){function t(t){return e.call(this,t)||this}return i(t,e),t.prototype.componentDidMount=function(){this.props.shouldCallFetch&&this.props.fetchQuotaStatus(),this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Processing&&this.props.subscribePublish(),this.props.connectNotification()},t.prototype.componentWillUnmount=function(){var e=document.querySelector("#readAlert");e&&(e.textContent="")},t.prototype.render=function(){return a.default.createElement("div",{className:"Stage3Form"},a.default.createElement("div",{className:"Stage3FormHeading"},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_PUBLISH_HEADING)),a.default.createElement("p",{className:"Stage3FormMessage Stage3MarginTop8"},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_PUBLISH_TEXT)),this.renderFCPublishPanel(),a.default.createElement("div",{className:"Stage3FormHeading"},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_QUOTA_HEADING)),a.default.createElement("div",{className:"Stage3FormMessage Stage3MarginTop8"},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_QUOTA_TEXT_LINE1)),a.default.createElement("div",{className:"Stage3FormMessage"},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_QUOTA_TEXT_LINE2)),this.renderLoader(),this.renderDownloadTemplate(),this.renderDragDrop(),this.renderQuotaStatusMessage())},t.prototype.renderLoader=function(){return this.props.shouldCallFetch?a.default.createElement(_.ProgressIndicator,null):null},t.prototype.renderFCPublishPanel=function(){return this.props.shouldShowPublishingSpinner?a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},a.default.createElement(C.CommandButton,{className:"Stage3FormPublishButtonDisabled",disabled:!0},a.default.createElement(l.Spinner,{ariaLive:"assertive",labelPosition:"right",size:c.SpinnerSize.small,className:"Stage3FormDisabledText"}),a.default.createElement("div",{className:"Stage3FormDisabledText Stage3MarginLeft8 Stage3Font600",role:"alert"},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_PUBLISH_INPROGRESS)))):this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Published?((e=document.querySelector("#readAlert"))&&(e.textContent=g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_PUBLISH_SUCCESS)),a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},a.default.createElement(E.Icon,{iconName:"SkypeCircleCheck",className:"Stage3FormIcon Stage3VerticalMiddle Stage3SuccessColor"}),a.default.createElement("span",{role:"alert",id:"readAlert",className:"Stage3FormMessage Stage3VerticalMiddle Stage3SuccessColor"},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_PUBLISH_SUCCESS)))):this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Failed?((e=document.querySelector("#readAlert"))&&(e.textContent=this.props.publishErrorMessage),a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},this.renderPublishButton(),a.default.createElement("div",{className:"Stage3MarginTop8"},a.default.createElement(E.Icon,{iconName:"StatusErrorFull",className:"Stage3FormIcon Stage3VerticalMiddle Stage3ErrorColor",style:{float:"left"}}),a.default.createElement("div",{role:"alert",id:"readAlert",className:"Stage3FormMessage Stage3VerticalMiddle Stage3ErrorColor Stage3TextSmall",style:{float:"left"}},this.props.publishErrorMessage)))):this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Archived?((e=document.querySelector("#readAlert"))&&(e.textContent=g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_PUBLISH_ARCHIVED)),a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},a.default.createElement("div",{className:"Stage3MarginTop8"},a.default.createElement(E.Icon,{iconName:"StatusErrorFull",className:"Stage3FormIcon Stage3VerticalMiddle Stage3ErrorColor",style:{float:"left"}}),a.default.createElement("div",{role:"alert",id:"readAlert",className:"Stage3FormMessage Stage3VerticalMiddle Stage3ErrorColor Stage3TextSmall",style:{float:"left"}},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_PUBLISH_ARCHIVED))))):a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},this.renderPublishButton());var e},t.prototype.renderPublishButton=function(){return a.default.createElement(s.PrimaryButton,{className:"PublishButton",text:g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_PUBLISH_HEADING),onClick:this.onPublishClick.bind(this),styles:{root:{background:"#2266E3"}}})},t.prototype.renderDownloadTemplate=function(){var e,t,n="";if(this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Published){t=!1;var r=this.props.quotaUploadStageState&&this.props.quotaUploadStageState.downloadStatus;e=r==S.QuotaDownloadStatus.New||r==S.QuotaDownloadStatus.Success||r==S.QuotaDownloadStatus.Failed?a.default.createElement(E.Icon,{iconName:"Download",className:"Stage3FormIcon Stage3PrimaryColor"}):a.default.createElement(l.Spinner,{className:"Stage3FormIcon Stage3PrimaryColor",size:c.SpinnerSize.small,style:{float:"left"}})}else e=a.default.createElement(E.Icon,{iconName:"Download",className:"Stage3FormIcon Stage3FormDisabledText"}),n="Stage3FormDisabledText",t=!0;return a.default.createElement("div",{className:"Stage3FormDownloadLinkBox"},a.default.createElement(I.Link,{className:"Stage3FormDownloadLink",onClick:this.onDownloadClick.bind(this),disabled:t},e,a.default.createElement("span",{className:n},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_QUOTA_DOWNLOAD_TEXT))))},t.prototype.renderDragDrop=function(){return this.props.shouldRenderEnabledDragDrop?this.props.shouldRenderUploadingDragDrop?a.default.createElement(f.DelphiDragDrop,{onFileSelected:this.onFileSelected.bind(this),type:"enabled"}):this.renderProgressDragDrop():a.default.createElement(f.DelphiDragDrop,{onFileSelected:this.onFileSelected.bind(this),type:"disabled"})},t.prototype.renderProgressDragDrop=function(){var e,t,n=this.props.quotaUploadStageState.quotaStatusInfo.Status;return n==S.QuotaStatus.Uploading?(e=g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_QUOTA_UPLOADING),t=g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_QUOTA_STEP1)):n!=S.QuotaStatus.InProgress&&n!=S.QuotaStatus.Uploaded||(e=g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_QUOTA_PROCESSING),t=g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_QUOTA_STEP2)),a.default.createElement("div",{className:"DragDrop"},a.default.createElement("div",{className:"DragDropInner"},a.default.createElement(l.Spinner,{className:"Stage3ProcessingBoxText",label:e,size:c.SpinnerSize.large}),a.default.createElement("div",{className:"Stage3ProcessingBoxText"},t)))},t.prototype.renderQuotaStatusMessage=function(){if(this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Published&&null!=this.props.quotaStatusMessage.isError)return 0==this.props.quotaStatusMessage.isError?a.default.createElement("div",{className:"Stage3MarginTop8"},a.default.createElement(E.Icon,{iconName:"SkypeCircleCheck",className:"Stage3FormIcon Stage3VerticalMiddle Stage3SuccessColor"}),a.default.createElement("span",{className:"Stage3FormMessage Stage3VerticalMiddle Stage3SuccessColor Stage3TextSmall",role:"alert","aria-atomic":"true"},this.props.quotaStatusMessage.message)):a.default.createElement("div",{className:"Stage3MarginTop8"},a.default.createElement(E.Icon,{iconName:"StatusErrorFull",className:"Stage3FormIcon Stage3VerticalMiddle Stage3ErrorColor"}),a.default.createElement("span",{className:"Stage3FormMessage Stage3VerticalMiddle Stage3ErrorColor Stage3TextSmall",role:"alert","aria-atomic":"true"},this.props.quotaStatusMessage.message))},t.prototype.onFileSelected=function(e){var t=this;if(e)if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type)this.props.quotaStatusUpdate(S.QuotaStatus.Failed,"INVALID_FILE",e.name);else if(e.size>S.MAX_UPLOAD_FILESIZE_BYTES)this.props.quotaStatusUpdate(S.QuotaStatus.Failed,"INVALID_SIZE",e.name);else{var n=new FileReader;n.onload=function(){if(n.result){var r=n.result,i=r.indexOf(","),o=r.substr(i+1);t.props.uploadQuotaFileContents(e.name,o)}},n.readAsDataURL(e)}},t.prototype.onDownloadClick=function(e){e.preventDefault(),this.props.quotaDownload()},t.prototype.onPublishClick=function(){this.props.publish()},t}(a.default.Component);t.Stage3Form=R;t.ConnectedStage3Form=u.connect((function(e){return{shouldShowPublishingSpinner:h.shouldShowPublishingSpinner(e),shouldRenderUploadingDragDrop:h.shouldRenderUploadingDragDrop(e),shouldRenderEnabledDragDrop:h.shouldRenderEnabledDragDrop(e),quotaStatusMessage:h.constructQuotaUploadStatusMessage(e),shouldCallFetch:h.shouldCallFetch(e),forecastConfigurationStatus:e.ActiveForecastConfigInfo.status,quotaUploadStageState:e.quotaUploadStageState,publishErrorMessage:h.getPublishFailErrorMessageFromState(e)}}),(function(e){return{fetchQuotaStatus:function(){e(p.QuotaStatusFetch())},quotaDownload:function(){A.logUsage("Download quota template button","",{},"Click","","QuotaAndPublishForm"),e(p.QuotaDownload())},uploadQuotaFileContents:function(t,n){A.logUsage("Upload quota excel","",{},"Click","","QuotaAndPublishForm"),e(p.QuotaUploadStart(t,n))},quotaStatusUpdate:function(t,n,r){var i=m.GetEmptyQuotaStatusInfo();i.Status=t,i.ErrorCode=n,i.UploadFileName=r,e(p.QuotaUploadStatusUpdate(i))},publish:function(){A.logUsage("Publish button","",{},"Click","","QuotaAndPublishForm"),e(p.Publish()),e(y.FormsProSurveyActionCreator("AdminPage"))},connectNotification:function(){e(p.NotificationConnect())},subscribePublish:function(){e(p.PublishSubscribe())}}}))(R)},function(e,t,n){var r=n(1219);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".Stage3Form {\n  overflow: auto;\n  height: 100%;\n  display: block;\n  /* padding-bottom: 20px */ }\n\n.Stage3FormHeading {\n  width: auto;\n  height: auto;\n  /* M / 18 Semibold (600) */\n  font-family: Segoe UI;\n  font-size: 18px;\n  line-height: 24px;\n  color: #323130;\n  margin: 0px;\n  font-weight: 600; }\n\n.Stage3FormMessage {\n  width: auto;\n  height: auto;\n  /* M / 18 Semibold (600) */\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #605e5c;\n  margin: 0px; }\n\n.Stage3FormPublishButtonContainer {\n  margin: 0px;\n  margin-top: 24px;\n  margin-bottom: 8px;\n  display: block;\n  height: 56px; }\n\n.PublishButton {\n  border-radius: 2px;\n  border-width: 0; }\n\n.PublishButton:hover {\n  background-color: #0B53CE; }\n\n.Stage3FormPublishButtonDisabled {\n  background: #F3F2F1;\n  border-radius: 2px;\n  padding-left: 20px;\n  padding-right: 20px; }\n\n.Stage3FormIcon {\n  margin-right: 8px;\n  font-size: 16px; }\n\n.Stage3FormDisabledText {\n  color: #A19F9D; }\n\n.SemiBold {\n  font-weight: 600; }\n\n.Stage3FormDownloadLinkBox {\n  margin-top: 24px;\n  margin-bottom: 24px; }\n\n.Stage3FormDownloadLink {\n  text-decoration: none;\n  color: #1a1918; }\n\n.Stage3MarginTop8 {\n  margin-top: 8px; }\n\n.Stage3MarginLeft8 {\n  margin-left: 8px; }\n\n.Stage3Font600 {\n  font-weight: 600; }\n\n.Stage3VerticalMiddle {\n  vertical-align: middle; }\n\n.Stage3SuccessColor {\n  color: #107c10; }\n\n.Stage3ErrorColor {\n  color: #a80000; }\n\n.Stage3PrimaryColor {\n  color: #2266E3; }\n\n.Stage3ProcessingBoxText {\n  color: #2266E3;\n  font-size: 12px;\n  line-height: 16px;\n  width: auto;\n  height: auto;\n  /* M / 18 Semibold (600) */\n  font-family: Segoe UI;\n  margin: 0px; }\n\n.Stage3TextSmall {\n  font-size: 12px;\n  line-height: 16px; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(32),l=n(1221);n(1222);var c=n(7),u=n(8),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={Drag:l.DragStatus.Idle},n.fileInputRef=a.default.createRef(),n}return i(t,e),t.prototype.render=function(){return"disabled"==this.props.type?this.renderDisabledDragDrop():this.renderEnabledDragDrop()},t.prototype.renderEnabledDragDrop=function(){var e=this,t="DragDrop";return this.state.Drag==l.DragStatus.Idle?t="DragDrop":this.state.Drag==l.DragStatus.Dragging?t+=" DragDropHover":t="DragDrop",a.default.createElement("div",{className:t,onDragEnter:function(t){return e.handleDrag(t,l.DragStatus.Dragging)},onDragLeave:function(t){return e.handleDrag(t,l.DragStatus.Idle)},onDrop:function(t){return e.handleDrag(t,l.DragStatus.Dropped)}},a.default.createElement("input",{ref:this.fileInputRef,type:"file",className:"DragInput",tabIndex:-1,"aria-hidden":!0,onChange:function(t){return e.handleFileSelect(t,l.DragStatus.Dropped)}}),this.renderDragInternal())},t.prototype.renderDragInternal=function(){var e=this,t="",n="";return this.state.Drag==l.DragStatus.Idle?(t=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_LINE1),n=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_LINE2)):t=this.state.Drag==l.DragStatus.Dragging?c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_DRAG):this.selectedFile.name,a.default.createElement("div",{className:"DragDropInner"},a.default.createElement(s.IconButton,{className:"DragDropUploadIcon",tabIndex:0,menuIconProps:{iconName:"Upload",style:{fontSize:"32px"}},"aria-label":c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_FILE),onKeyPress:function(t){"Enter"===t.key&&e.fileInputRef.current.click()}}),a.default.createElement("div",{className:"DragDropMessage"},t),a.default.createElement("div",{className:"DragDropMessage"},n))},t.prototype.renderDisabledDragDrop=function(){var e,t;return e=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_LINE1),t=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_LINE2),a.default.createElement("div",{className:"DragDrop"},a.default.createElement("div",{className:"DragDropInner"},a.default.createElement(s.IconButton,{className:"DragDropUploadIconDisabled",disabled:!0,menuIconProps:{iconName:"Upload",style:{fontSize:"32px"}},"aria-label":c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_FILE)}),a.default.createElement("div",{className:"DragDropMessage DragDropDisabled"},e),a.default.createElement("div",{className:"DragDropMessage DragDropDisabled"},t)))},t.prototype.handleFileSelect=function(e,t){e.preventDefault(),this.setState({Drag:t}),e.target.files[0]&&(this.selectedFile=e.target.files[0],this.props.onFileSelected(this.selectedFile))},t.prototype.handleDrag=function(e,t){e.preventDefault(),this.setState({Drag:t}),t==l.DragStatus.Dropped&&e.dataTransfer.files[0]&&(this.selectedFile=e.dataTransfer.files[0],this.props.onFileSelected(this.selectedFile))},t}(a.default.Component);t.DelphiDragDrop=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Idle=0]="Idle",e[e.Dragging=1]="Dragging",e[e.Dropped=2]="Dropped"}(t.DragStatus||(t.DragStatus={}))},function(e,t,n){var r=n(1223);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".DragDrop {\n  width: 99%;\n  height: 128px;\n  background: #FAF9F8;\n  margin-top: 24px;\n  border-radius: 4px;\n  border: 1px solid #ececec;\n  text-align: center;\n  overflow: auto;\n  position: relative;\n  z-index: 0; }\n\n.DragInput {\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n  position: absolute;\n  left: 0px;\n  z-index: 1; }\n\n.DragDropHover {\n  background: #e4edfc;\n  border: 1px solid #2266e3; }\n\n.DragDropInner {\n  width: auto;\n  height: auto;\n  position: relative;\n  margin: 0 auto;\n  z-index: 0;\n  padding-top: 24px;\n  display: block; }\n\n.DragDropMessage {\n  width: auto;\n  height: auto;\n  /* M / 18 Semibold (600) */\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #2266E3;\n  margin: 0px; }\n\n.DragDropDisabled {\n  color: #A19F9D; }\n\n.DragDropUploadIcon {\n  font-size: 32px;\n  color: #2266E3; }\n\n.DragDropUploadIconDisabled {\n  font-size: 32px;\n  color: #A19F9D; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(211),o=n(7),a=n(8),s=n(178);function l(e){switch(e.quotaUploadStageState.quotaStatusInfo.ErrorCode){case i.ERROR_CODES.GUID_TAMPERED:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_GUID_TAMPERED);case i.ERROR_CODES.INVALID_ROWS:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_ROWS);case i.ERROR_CODES.INVALID_CONTENT:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_CONTENT);case i.ERROR_CODES.INVALID_FILE:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_FILE);case i.ERROR_CODES.INVALID_SIZE:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_SIZE);case i.ERROR_CODES.UPLOAD_FAILED:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_UPLOAD_FAILED);case i.ERROR_CODES.FETCH_FAILED:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_FETCH_FAILED);case i.ERROR_CODES.INVALID_FORECASTCONFIGURATION:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_FORECASTCONFIGURATION);default:return o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_UNKNOWN)}}t.shouldShowPublishingSpinner=function(e){return e.ActiveForecastConfigInfo.status==r.IForecastConfigStatus.Processing||e.quotaUploadStageState.isPublishing},t.shouldRenderUploadingDragDrop=function(e){var t=e.quotaUploadStageState.quotaStatusInfo.Status;return t==i.QuotaStatus.New||t==i.QuotaStatus.Success||t==i.QuotaStatus.Failed},t.shouldRenderEnabledDragDrop=function(e){return e.quotaUploadStageState.isFetched&&e.ActiveForecastConfigInfo.status==r.IForecastConfigStatus.Published},t.shouldCallFetch=function(e){return!e.quotaUploadStageState.isFetched&&e.ActiveForecastConfigInfo.status==r.IForecastConfigStatus.Published},t.getPublishFailErrorMessageFromState=function(e){var t=s.getlocalizedFCPublishErrorMessage(e.ActiveForecastConfigInfo.publishErrorMessage);return t||o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_PUBLISH_FAILED)},t.constructQuotaUploadStatusMessage=function(e){if(e.quotaUploadStageState.downloadStatus==i.QuotaDownloadStatus.Failed){return{message:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_DOWNLOAD_FAILED),isError:!0}}var t=e.quotaUploadStageState.quotaStatusInfo;if(t.Status==i.QuotaStatus.Success){return{message:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_SUCCESS).replace("{0}",new Date(t.UploadedOn).toLocaleString()).replace("{1}",t.UploadFileName),isError:!1}}if(t.Status==i.QuotaStatus.Failed){var n=void 0;if(t.ErrorCode==i.ERROR_CODES.FETCH_FAILED||t.ErrorCode==i.ERROR_CODES.UPLOAD_FAILED)n=l(e);else if(t.ErrorCode==i.ERROR_CODES.INVALID_SIZE){n=(n=(n=o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED)).replace("{0}",new Date(t.UploadedOn).toLocaleString())).replace("{1}",t.UploadFileName);var r=l(e);r=r.replace("{0}",i.MAX_UPLOAD_FILESIZE_MB.toString()),n=n.replace("{2}",r)}else n=(n=(n=(n=o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED)).replace("{0}",new Date(t.UploadedOn).toLocaleString())).replace("{1}",t.UploadFileName)).replace("{2}",l(e));return{message:n,isError:!0}}return{message:"",isError:null}}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(0)),c=n(23);n(1226);var u=n(7),d=n(8),p=s(n(616)),_=n(16),E=n(225),S=n(177),f=n(109),C=n(225),m=n(22),g=s(n(1228)),T=n(15),I=n(89),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){return l.createElement("div",{className:"stagePermissionsContainerDiv"},this.renderPermissionsStage(),this.renderInfoOrErrorMessage())},t.prototype.renderPermissionsStage=function(){return l.createElement("div",{className:"stagePermissionControlsContainerDiv"},this.renderPermissionsAttributeSelectionDiv(),this.renderAdditionalViewingPermissionsDiv())},t.prototype.renderPermissionsAttributeSelectionDiv=function(){var e=this.getSystemUserLookupPickerProps();return l.createElement("div",{className:"stagePermissionSubContainerDiv"},l.createElement("span",{className:"stagePermissionsHeaderLabel"},u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_TITLE)),l.createElement("span",{className:"stagePermissionsSubTitleLabel"},u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_SUBTITLE)),l.createElement("div",{className:"PermissionAttributeSelectorContainerDiv"},l.createElement("div",{className:"PermissionAttributeSelectorEntityFieldDiv"},l.createElement(m.TextField,{value:this.props.hierarchyEntityDisplayName,label:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL),readOnly:!0,disabled:!0})),l.createElement("div",{className:"PermissionAttributeSelectorEntityFieldDiv"},l.createElement(p.default,o({},e)))))},t.prototype.renderAdditionalViewingPermissionsDiv=function(){var e={isDisabled:!this.props.enableRoleSelector,itemSet:this.props.securityRolesList,onItemSelected:this.props.addRole,onItemUnselected:this.props.removeRole,selectedItems:this.props.selectedRolesList,placeholder:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PICKER_PLACEHOLDER),noItemsText:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PICKER_NO_DATA),selectedItemLimit:10,itemIconUrl:"/webresources/msdyn_/Images/IC_SecurityRole",removeButtonTooltipText:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PICKER_ITEM_REMOVE_BUTTON_TOOLTIP)};return l.createElement("div",{className:"stagePermissionSubContainerDiv"},l.createElement("span",{className:"AdditionalViewingPermissionHeaderLabel"},u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_HEADER)),l.createElement("span",{className:"AdditionalViewingPermissionSubTitleLabel"},u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_SUBITITLE)),l.createElement("div",{className:"PermissionRoleTypeComboOptionsContainerDiv"},l.createElement(m.ChoiceGroup,{className:"PermissionRoleTypeComboOptions",defaultSelectedKey:null==this.props.selectedAdditionalViewingPermissionType?C.None_Option_Key:this.props.selectedAdditionalViewingPermissionType.toString(),options:E.getAdditionalForecastViewingPermissionOptions(),onChange:this.onAdditionalViewingPermissionTypeChange.bind(this)})),l.createElement("div",{className:"SecurityRoleLookupPicker"},l.createElement(g.default,o({},e))))},t.prototype.renderInfoOrErrorMessage=function(){var e=this.props.isFormStateValid?"":"_Error";return l.createElement("div",{className:"PermissionStageMessageContainer"+e},l.createElement(m.Icon,{className:"PermissionStageMessageIcon"+e,iconName:this.props.isFormStateValid?"Info":"Blocked2"}),l.createElement("span",{className:"PermissionStageMessageText"},this.props.permissionsStageMessageText))},t.prototype.getSystemUserLookupPickerProps=function(){var e=this;return{id:"",attributeInfo:{id:"",name:"permissionsAttribute",entityName:this.props.hierarchyEntity,lookupEntityName:"systemuser",entityPrimaryIdAttribute:"systemuserid"},attributesTypes:[I.EDataType.Lookup,I.EDataType.Owner],onChange:function(t){e.props.updateAttributeValue(t)},value:this.props.selectedPermissionsAttribute,crmDataAcces:this.props.crmDataAccess,isDisabled:this.props.isAttributeDisabled,showNoneOption:!0,label:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ATTRIBUTE_FIELD_LABEL)}},t.prototype.onAdditionalViewingPermissionTypeChange=function(e,t){void 0!==t&&this.props.updateAdditionalPermissionType(t.key)},t}(l.Component);t.ConnectedStagePermissionsForm=c.connect((function(e){return{hierarchyEntity:e.FormFieldData.hierarchyEntity,isAttributeDisabled:E.getPermissionAttributeControlDisabledState(e),selectedPermissionsAttribute:E.getSelectedPermissionAttribute_FromState(e),hierarchyEntityDisplayName:f.getHierarchyEntityDisplayName(e),securityRolesList:E.getSuggestionListForRolesListFromState(e),selectedRolesList:E.getSelectedPermissionRoles_FromState(e),selectedAdditionalViewingPermissionType:E.getAdditionalViewingPermissionType_FromState(e),enableRoleSelector:E.isRoleBasedPermissionTypeOptionSelectedFromState(e),isFormStateValid:E.arePermissionsConfigured(e),permissionsStageMessageText:E.getPermissionStageInfoErrorMessage(e)}}),(function(e,t){return{updateAttributeValue:function(t){T.logUsage("PermissionsControl.updateAttributeValue","",{},"Edit","updateAttributeValue"),e(S.UpdatePermissionsAttribute(t!==C.None_Option_Key?t:null))},updateAdditionalPermissionType:function(t){switch(T.logUsage("PermissionsControl.updateAdditionalPermissionType","",{newValue:t},"Edit","updateAdditionalPermissionType"),t){case C.None_Option_Key:e(S.SetAdditionalViewingPermissionType(null));break;case _.PermissionType.All.toString():e(S.SetAdditionalViewingPermissionType(_.PermissionType.All));break;case _.PermissionType.Role.toString():e(S.SetAdditionalViewingPermissionType(_.PermissionType.Role))}},addRole:function(t){T.logUsage("PermissionsControl.addRole","",{value:t},"Edit"),e(S.AddPermissionRole(t))},removeRole:function(t){T.logUsage("PermissionsControl.removeRole","",{value:t},"Edit"),e(S.DeletePermissionRole(t))}}}))(h)},function(e,t,n){var r=n(1227);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".stagePermissionsContainerDiv {\n  display: flex;\n  flex-direction: column; }\n\n.stagePermissionControlsContainerDiv {\n  display: flex;\n  flex-direction: column;\n  align-items: start;\n  height: 580px; }\n\n.stagePermissionSubContainerDiv {\n  display: flex;\n  flex-direction: column;\n  align-items: start; }\n\n.stagePermissionsHeaderLabel {\n  font-family: Segoe UI;\n  font-size: 18px;\n  line-height: 24px;\n  color: #323130;\n  font-weight: 600; }\n\n.stagePermissionsSubTitleLabel {\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C;\n  font-weight: 600;\n  margin-top: 8px; }\n\n.PermissionAttributeSelectorContainerDiv {\n  margin-top: 24px;\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 8px; }\n\n.PermissionAttributeSelectorEntityFieldDiv {\n  margin-right: 16px;\n  display: flex;\n  flex-direction: column;\n  width: 198px; }\n\n.PermissionAttributeSelectorEntityFieldLabel {\n  margin-bottom: 5px;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 19px;\n  color: #696969; }\n\n.PermissionAttributeSelectorAttributeFieldLabel {\n  margin-bottom: 5px;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 19px;\n  color: #696969; }\n\n.PermissionHierarchyEntityValueField {\n  color: #605E5C;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  background: #F3F2F1;\n  border: #F3F2F1;\n  border-radius: 2px;\n  border-style: none;\n  height: 32px;\n  padding-left: 8px; }\n\n.PermissionAttributeSelectorValueField {\n  color: #FFFFFF;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  border-radius: 2px;\n  border: 1px solid #605E5C;\n  box-sizing: border-box;\n  height: 32px; }\n\n.AdditionalViewingPermissionHeaderLabel {\n  font-family: Segoe UI;\n  font-size: 18px;\n  line-height: 24px;\n  color: #323130;\n  font-weight: 600;\n  margin-top: 24px; }\n\n.AdditionalViewingPermissionSubTitleLabel {\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C;\n  font-weight: 600;\n  margin-top: 8px; }\n\n.PermissionRoleTypeComboOptionsContainerDiv {\n  margin-top: 16px;\n  display: flex;\n  flex-direction: row; }\n\n.PermissionRoleTypeComboOptions {\n  font-family: Segoe UI !important;\n  font-size: 14px !important;\n  line-height: 20px !important;\n  color: #323130 !important;\n  margin-left: 9px; }\n\n.SecurityRoleLookupPicker {\n  margin-top: 17px;\n  margin-left: 36px; }\n  .SecurityRoleLookupPicker .ms-BasePicker-text {\n    border-width: thin !important;\n    width: 376px;\n    margin-bottom: 16px; }\n  .SecurityRoleLookupPicker .ms-BasePicker-text:disabled {\n    background: #F3F2F1;\n    border: #F3F2F1; }\n  .SecurityRoleLookupPicker .ms-SelectionZone {\n    max-height: 120px;\n    overflow: auto;\n    margin-left: -32px; }\n  .SecurityRoleLookupPicker .ms-Button-icon {\n    font-size: 12px; }\n\n.PermissionStageMessageContainer {\n  max-width: 412px;\n  max-height: 68;\n  overflow: auto;\n  display: flex;\n  flex-direction: row;\n  background: #F3F2F1;\n  padding: 10px 0px; }\n\n.PermissionStageMessageContainer_Error {\n  max-width: 412px;\n  max-height: 68;\n  overflow: auto;\n  display: flex;\n  flex-direction: row;\n  background: #FDE7E9;\n  padding: 10px 0px; }\n\n.PermissionStageMessageIcon {\n  font-size: 16px;\n  line-height: 16px;\n  text-align: center;\n  color: #605E5C;\n  margin-left: 8px;\n  margin-right: 8px; }\n\n.PermissionStageMessageIcon_Error {\n  font-size: 16px;\n  line-height: 16px;\n  text-align: center;\n  color: #A80000;\n  margin-left: 8px;\n  margin-right: 8px; }\n\n.PermissionStageMessageText {\n  font-family: Segoe UI;\n  font-size: 12px;\n  line-height: 16px;\n  color: #323130;\n  margin-right: 32px; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22);n(1229);var l=function(e){function t(t){var n=e.call(this,t)||this;return n.picker=a.default.createRef(),n.onFilterChanged=function(e,t){return e?n.props.itemSet.filter((function(t){return 0===t.itemName.toLowerCase().indexOf(e.toLowerCase())})).map((function(e){return n.createDisplayItem(e)})).filter((function(e){return t&&-1==t.findIndex((function(t){return t.secondaryText==e.secondaryText}))})):[]},n.onItemSelected=function(e){return n.picker.current&&null!=e?n.isItemAlreadySelected(e,n.picker.current.items)?null:(n.props.onItemSelected(e.secondaryText),e):null},n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.ListPeoplePicker,{componentRef:this.picker,onResolveSuggestions:this.onFilterChanged.bind(this),onItemSelected:this.onItemSelected.bind(this),getTextFromItem:this.getTextFromItem.bind(this),pickerSuggestionsProps:{noResultsFoundText:this.props.noItemsText},itemLimit:this.props.selectedItemLimit?this.props.selectedItemLimit:void 0,disabled:this.props.isDisabled,inputProps:{placeholder:this.props.placeholder&&0==this.props.isDisabled?this.props.placeholder:void 0},onEmptyInputFocus:this.getDisplayItems.bind(this),defaultSelectedItems:this.getDefaultSelectedItems(),onRenderItem:this.renderItem.bind(this)}))},t.prototype.getDisplayItems=function(e){var t=this;return this.props.itemSet.map((function(e){return t.createDisplayItem(e)})).filter((function(t){return e&&-1==e.findIndex((function(e){return e.secondaryText==t.secondaryText}))}))},t.prototype.isItemAlreadySelected=function(e,t){return!(!t||!t.length||0===t.length)&&t.filter((function(t){return t.secondaryText===e.secondaryText})).length>0},t.prototype.getDefaultSelectedItems=function(){var e=this,t=[];return this.props.selectedItems.forEach((function(n){var r=e.props.itemSet.find((function(e){return n==e.itemValue}));r&&t.push(e.createDisplayItem(r))})),t},t.prototype.createDisplayItem=function(e){return{text:e.itemName,secondaryText:e.itemValue,showSecondaryText:!1,removeItemHandler:this.removeItemHandler}},t.prototype.removeItemHandler=function(e,t){e(),this.props.onItemUnselected(t)},t.prototype.getTextFromItem=function(e){return void 0!==e.text?e.text:""},t.prototype.renderItem=function(e){return a.default.createElement("div",{className:"selectedItemContainerDiv",role:"listitem","data-is-focusable":"true","data-is-sub-focuszone":"true","data-selection-index":"0"},a.default.createElement("div",null,a.default.createElement(s.IconButton,{className:"removeSelectedItemButton",iconProps:{iconName:"ChromeClose"},title:this.props.removeButtonTooltipText.trimEnd()+" "+e.item.text,onClick:e.item.removeItemHandler.bind(this,e.onRemoveItem,e.item.secondaryText),"data-is-focusable":"true",style:{color:"#A19F9D"}})),a.default.createElement("div",{className:"selectedItemIcon"},a.default.createElement("img",{className:"selectedItemIconImage",src:this.props.itemIconUrl,"aria-hidden":!0})),a.default.createElement("div",{className:"selectedItemText","aria-hidden":!0},e.item.text))},t}(a.default.Component);t.default=l},function(e,t,n){var r=n(1230);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,'.selectedItemContainerDiv {\n  display: flex;\n  margin-bottom: 5px; }\n\n.selectedItemIcon {\n  font-size: 16px;\n  margin-top: 5px;\n  margin-left: 16px;\n  background-color: #8764B8;\n  border-radius: 50%;\n  width: 24px;\n  height: 24px; }\n\n.selectedItemIconImage {\n  margin-top: 6px;\n  margin-left: 6px;\n  width: 12px;\n  height: 12px; }\n\n.selectedItemText {\n  font-family: "Segoe UI";\n  line-height: 20px;\n  font-size: 14px;\n  letter-spacing: 0.005em;\n  text-align: center;\n  color: #323130;\n  margin-top: 8px;\n  margin-left: 8px; }\n',""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),l=n(45),c=n(624),u=n(625),d=n(23),p=n(178),_=n(626),E=n(627),S=n(22),f=a(n(1239)),C=n(1242);n(1243);var m=n(138),g=n(7),T=n(8),I=n(623),h=n(1245),A=n(1246),y=n(1254),R=n(1255),D=n(367),O=n(16),F=a(n(628)),N=n(61),P=n(629),G=n(96),v=n(15);l.initializeIcons();var L=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this,t=G.createNewContext("fc-grid-init");this.props.gridEventsHandler.RefreshGrid(t).then((function(t){e.props.fdNotificationEventHandler.ValidateAndTriggerFDFetch(t)}))},t.prototype.render=function(){var e=this;return!1===this.props.canRenderPage?s.default.createElement("div",null):!0===this.props.showEnableManualForecastingPage?s.default.createElement("div",null,this.renderEnableManualForecastingPage(),s.default.createElement(R.ConnectedEnableManualForecastingDialog,null)):s.default.createElement("div",{className:"GridPageAppContainer"},this.renderFDNotification(),s.default.createElement("div",{className:"GridPageApp"},s.default.createElement("div",{className:"pageHeader"},s.default.createElement("span",{className:"GridPageTitle",role:"heading","aria-level":1},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FORECAST_CONFIG_HEADING_GRIDPAGE)),s.default.createElement("br",null),s.default.createElement("div",{className:"GridPageFlexContainer"},s.default.createElement("span",{className:"GridPageDescription"}," ",g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FORECAST_CONFIG_SUBHEADING_GRIDPAGE)),s.default.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=2114542",target:"_blank",style:{marginInlineStart:"5px"}}," ",g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FORECAST_CONFIG_SUBHEADINGLINK_GRIDPAGE)))),s.default.createElement("span",{className:"CreateForecastsButtonsHeaderTitle",role:"heading","aria-level":2},g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FORECAST_CONFIG_TEMPLATE_HEADING_GRIDPAGE)),s.default.createElement(S.Stack,{horizontal:!0,tokens:{childrenGap:"0 16"},className:"CreateForecastButtonsContainer"},s.default.createElement(f.default,o({},o({},C.getGridPageTemplateButtonDefinition(O.ForecastConfigTemplateType.OrgChart),{clickHandler:function(){return e.forecastConfigTemplateClickHandler(O.ForecastConfigTemplateType.OrgChart)}}))),s.default.createElement(f.default,o({},o({},C.getGridPageTemplateButtonDefinition(O.ForecastConfigTemplateType.TerritoryBased),{clickHandler:function(){return e.forecastConfigTemplateClickHandler(O.ForecastConfigTemplateType.TerritoryBased)}}))),s.default.createElement(f.default,o({},o({},C.getGridPageTemplateButtonDefinition(O.ForecastConfigTemplateType.Custom),{clickHandler:function(){return e.forecastConfigTemplateClickHandler(O.ForecastConfigTemplateType.Custom)}})))),s.default.createElement(E.ConnectedGridFilterSelector,null),this.props.showNoFcsMessage&&this.renderNoFcsMessage(),!this.props.showNoFcsMessage&&s.default.createElement(_.ForecastConfigGrid,o({},{forecastConfigs:this.props.forecastConfigList,gridEventsHandler:this.props.gridEventsHandler,navigationHandlers:this.props.navigationHandler,shouldShowCreateSnapshotButton:this.props.showSnapshot,isPredictivePage:!1,entityMetadataList:this.props.entityMetadataList})),s.default.createElement(I.ConnectedForecastConfigGridConfirmationDialog,null),s.default.createElement(y.ConnectedForecastConfigPublishConfirmationDialog,null),s.default.createElement(h.ConnectedForecastConfigArchiveConfirmationDialog,null),!this.props.isSnapshotHidden&&s.default.createElement(A.ConnectedForecastConfigGridCreateSnapshotDialog,null)))},t.prototype.renderEnableManualForecastingPage=function(){var e=this;return s.default.createElement("div",{className:"AdminSettingsContainerDiv"},s.default.createElement(F.default,{titleLabel:g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.MF_ADMIN_SETTINGS_CONTENT_TITLE),descLabel:g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.MF_ADMIN_SETTINGS_CONTENT_DESC),learnMoreLabel:g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.MF_ADMIN_SETTINGS_LEARN_MORE_BUTTON_TEXT),learnMoreLink:"https://go.microsoft.com/fwlink/?linkid=2114449"}),s.default.createElement(N.PrimaryButton,{className:"AdminSettingsEnableButton",text:g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.MF_ADMIN_SETTINGS_ENABLE_BUTTON_TEXT),onClick:function(){e.props.adminSettingsEventsHandler.EnableManualForecastingOrgSettings()}}))},t.prototype.renderNoFcsMessage=function(){return s.default.createElement("div",{style:{marginTop:32}},s.default.createElement(F.default,{titleLabel:g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.NoFcMsgTitle),learnMoreLabel:g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.NoFcMsgLearnMore),descLabel:g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.NoFcMsgDesc),learnMoreLink:"https://go.microsoft.com/fwlink/?linkid=2103790"}))},t.prototype.renderFDNotification=function(){var e=this;if(this.props.showFDNotification){var t=g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_WARNING_READ_MORE),n=g.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.FC_WARNING_FD_REMOVED_FC_ADDED);return n=n.replace(" {0}",""),s.default.createElement(D.MessageBar,{className:"fdNotification",messageBarType:D.MessageBarType.warning,onDismiss:function(){e.dismissFDNotification()}},n,s.default.createElement(S.Link,{href:"https://go.microsoft.com/fwlink/?linkid=2103790",target:"_blank"},t))}},t.prototype.dismissFDNotification=function(){this.props.fdNotificationEventHandler.HideNotifications()},t.prototype.forecastConfigTemplateClickHandler=function(e){v.logUsage("GridPageApp","forecastConfigTemplateClick",{template:e.toString()},"Click","forecastConfigTemplateClickHandler"),this.props.navigationHandler.OpenCreatePage(e)},t}(s.default.Component);t.default=L;t.ConnectedGridApp=d.connect((function(e){return{forecastConfigList:p.GetFCList_FromState(e),showFDNotification:p.shouldShowFDNotification(e),showNoFcsMessage:p.Get_ShowNoFCsMessage_FromState(e),showSnapshot:p.Get_ShowCreateSnapshot_FromState(e),showEnableManualForecastingPage:p.ShouldShowEnableForecastingPage_FromState(e),canRenderPage:p.isEnableManualForecastingFlagFetched_FromState(e),isSnapshotHidden:e.gridAppDialogState.isGridCreateSnapshotDialogHidden,entityMetadataList:e.entityMetadataList}}),(function(e,t){return{gridEventsHandler:new c.GridEventsHandler(e,t.crmDataAccess.forecastConfigAccess),navigationHandler:m.NavigationHandlerFactory.GetNavigationHandlerObject(e),fdNotificationEventHandler:new u.FDNotificationEventHandler(e,t.crmDataAccess.forecastDefintionDataAccess),adminSettingsEventsHandler:new P.AdminSettingsEventsHandler(e)}}))(L)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1233),i=n(7),o=n(8),a=n(1234),s=n(1235);function l(e){return!0===e?{iconName:"SkypeCircleCheck",id:"statusIcon",tooltip:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_SUCCESS)}:!1===e?{iconName:"StatusErrorFull",id:"statusIcon",tooltip:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_FAIL)}:{iconName:"",id:""}}function c(e){return!0===e?i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FORECAST_PREDICTIVE_STATUS_ON):i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FORECAST_PREDICTIVE_STATUS_OFF)}t.convertForecastConfigInfoToDelfiData=function(e,t,n){var u=[],d=[],p=[],_=!0,E=!function(e,t){var n=!0;if(t)for(var r=0;r<e.length;r++)null!=t[e[r][s.GridConstants.ROLLUPENTITY]]&&null!=t[e[r][s.GridConstants.HIERARCHYENTITY]]||(n=!1);return n}(e,t);n?(_=!function(e){var t=!0;return e.forEach((function(e){!0===e.isPredictive&&void 0===e.lastRunDate&&(t=!1)})),t}(e),p=(new a.PredictiveForecastConfigGridDefinition).Columns):p=(new r.ForecastConfigGridDefinition).Columns;for(var S=0;S<e.length;S++){for(var f={id:e[S].id,parentId:void 0,getDisplayFormattedValue:{},getEditValue:{},getIconUrl:{},getIconTooltip:{},getProgress:{},getStrikeValue:{},getUrlArgs:{},cellShimmerProps:{},iconButtonProps:{}},C=0;C<p.length;C++){var m=p[C].id;m==s.GridConstants.LASTRUNDATE?e[S].isPredictive&&_&&f.cellShimmerProps?f.cellShimmerProps[m]=!0:void 0===e[S].lastRunDate?f.getDisplayFormattedValue[m]="--":f.getDisplayFormattedValue[m]=""+e[S][m]:p[C].displayTextProp?f.getDisplayFormattedValue[m]=""+e[S][m][p[C].displayTextProp]:f.getDisplayFormattedValue[m]=""+e[S][m],m!=s.GridConstants.ROLLUPENTITY&&m!=s.GridConstants.HIERARCHYENTITY||(f.getDisplayFormattedValue[m]="",t&&(E?f.cellShimmerProps&&(f.cellShimmerProps[m]=!0):f.getDisplayFormattedValue[m]=t[e[S][m]].DisplayName)),null!=p[C].urlArgProperty&&(f.getUrlArgs[m]=e[S][p[C].urlArgProperty])}n&&(f.getIconUrl.isPredictive=l(e[S].isPredictive).iconName,f.getDisplayFormattedValue.isPredictive=c(e[S].isPredictive),f.getIconPosition&&(f.getIconPosition.isPredictive="left")),u.push(f)}for(S=0;S<p.length;S++){var g={id:p[S].id,header:p[S].header,dataType:1,width:p[S].width,isEditable:!1,ishierarchial:!1,isLink:null!=p[S].urlArgProperty};d.push(g)}return{rows:u,columns:d,labels:{ariaLabelForGrid:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_GRID_ARIA_LABEL),contextMenuButton:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_MORE_COMMANDS)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(7),o=function(){this.Columns=[{id:"name",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE),role:"presentation",type:"string",width:250,urlArgProperty:"id"},{id:"owner",displayTextProp:"displayName",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE),role:"presentation",type:"string",width:170},{id:"period",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE),role:"presentation",type:"string",width:120},{id:"fromDate",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FROM_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FROM_GRIDPAGE),role:"presentation",type:"string",width:120},{id:"toDate",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_TO_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_TO_GRIDPAGE),role:"presentation",type:"string",width:120},{id:"statusDescription",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE),role:"presentation",type:"string",width:120},{id:"rollupEntity",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_ROLLUPENTITY_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_ROLLUPENTITY_GRIDPAGE),role:"presentation",type:"string",width:170},{id:"hierarchyEntity",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_HIERARCHYENTITY_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_HIERARCHYENTITY_GRIDPAGE),role:"presentation",type:"string",width:170},{id:"createdon",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_CREATEDON_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_CREATEDON_GRIDPAGE),role:"presentation",type:"string",width:170}]};t.ForecastConfigGridDefinition=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(7),o=function(){this.Columns=[{id:"name",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE),role:"presentation",type:"string",width:250,urlArgProperty:"id"},{id:"period",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FREQUENCY_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FREQUENCY_GRIDPAGE),role:"presentation",type:"string",width:100},{id:"fromDate",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FROM_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FROM_GRIDPAGE),role:"presentation",type:"string",width:100},{id:"toDate",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_TO_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_TO_GRIDPAGE),role:"presentation",type:"string",width:100},{id:"owner",displayTextProp:"displayName",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE),role:"presentation",type:"string",width:120},{id:"statusDescription",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE),role:"presentation",type:"string",width:90},{id:"isPredictive",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_PREDICTION_STATUS_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_PREDICTION_STATUS_GRIDPAGE),role:"presentation",type:"bool",width:120},{id:"lastRunDate",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_PREDICTION_LASTRUNDATE_GRIDPAGE),ariaLabel:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_PREDICTION_LASTRUNDATE_GRIDPAGE),role:"presentation",type:"string",width:120}]};t.PredictiveForecastConfigGridDefinition=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GridConstants={ROLLUPENTITY:"rollupEntity",HIERARCHYENTITY:"hierarchyEntity",LASTRUNDATE:"lastRunDate"}},function(e,t,n){var r=n(1237);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,'.configGrid {\n  height: 100%; }\n  .configGrid .ms-ScrollablePane--contentContainer {\n    overflow-y: visible !important; }\n  .configGrid .ms-List-page {\n    border-bottom: none !important; }\n    .configGrid .ms-List-page .ms-List-cell {\n      background: white !important; }\n    .configGrid .ms-List-page .ms-DetailsRow-cellCheck {\n      align-items: center !important;\n      display: flex !important; }\n    .configGrid .ms-List-page .ms-DetailsRow {\n      border-bottom: thin solid #E1DFDD !important; }\n      .configGrid .ms-List-page .ms-DetailsRow:hover {\n        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1) !important;\n        z-index: 10; }\n      .configGrid .ms-List-page .ms-DetailsRow.is-selected {\n        background: #F3F2F1 !important; }\n      .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell {\n        border-left: none !important;\n        height: 60px !important;\n        padding-bottom: 0px !important; }\n        .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlCellDiv {\n          justify-content: flex-start !important;\n          font-size: 14px !important;\n          color: #323130 !important;\n          letter-spacing: 0.005em; }\n        .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .cellContextmenu {\n          margin-left: 12px !important;\n          align-items: flex-start !important;\n          font-size: 12px !important;\n          color: #605E5C !important;\n          letter-spacing: 0.02em; }\n        .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass {\n          color: #323130 !important;\n          text-decoration: none !important; }\n          .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass:hover {\n            color: #2266E3 !important; }\n          .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass:focus {\n            color: #2266E3 !important; }\n        .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell {\n          box-sizing: border-box; }\n          .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .delfiIconCell {\n            margin-left: -2px; }\n            .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .delfiIconCell .delfiIcon {\n              font-size: 16px; }\n            .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .delfiIconCell i[data-icon-name="StatusErrorFull"] {\n              color: #A19F9D; }\n            .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .delfiIconCell i[data-icon-name="SkypeCircleCheck"] {\n              color: #107C10; }\n  .configGrid .ms-DetailsHeader {\n    border: 0px !important;\n    border-bottom: thin solid #E1DFDD !important;\n    border-top: none !important;\n    padding-top: 0 !important; }\n    .configGrid .ms-DetailsHeader .ms-DetailsHeader-cell[aria-colindex="4"] {\n      background: white !important; }\n    .configGrid .ms-DetailsHeader .ms-DetailsHeader-cell {\n      border-left: none !important;\n      padding: 0px !important;\n      text-align: left !important;\n      font-size: 14px !important;\n      font-weight: 600 !important; }\n      .configGrid .ms-DetailsHeader .ms-DetailsHeader-cell:hover {\n        background-color: none !important; }\n      .configGrid .ms-DetailsHeader .ms-DetailsHeader-cell .ms-DetailsHeader-cellTitle {\n        text-align: left !important;\n        margin-top: 20px !important;\n        display: block;\n        color: #323130 !important;\n        letter-spacing: 0.02em; }\n  .configGrid .ms-CommandBar {\n    background: white !important;\n    border-bottom: thin solid #E1DFDD;\n    border-top: thin solid #E1DFDD; }\n  .configGrid .cellContextMenuIcon {\n    top: 10px !important;\n    bottom: 10px !important;\n    height: auto !important; }\n  .configGrid .cellContextMenuIcon:hover {\n    background-color: #F3F2F1; }\n  .configGrid .cellContextmenu {\n    background: #FFFFFF; }\n',""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(15),o=n(7),a=n(8),s=1,l=3,c=4;function u(e,t){var n=e&&e.filter((function(e){return e.id==t}));if(n&&n.length>0)return n[0].status}t.getForecastConfigContextMenuOptions=function(){return{name:[{id:"OnEdit",title:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE),iconToolTip:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE),handlerName:"OnEdit",iconName:"Edit"},{id:"OnCreateSnapshot",title:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_GRID_CREATE_SNAPSHOT_CONTEXTUALBUTTON_GRIDPAGE),iconToolTip:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_GRID_CREATE_SNAPSHOT_CONTEXTUALBUTTON_GRIDPAGE),handlerName:"OnCreateSnapshot",visibilityHandlerName:"ShowCreateSnapshot",iconName:"Camera"},{id:"OnDeactivate",title:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_GRID_DEACTIVATE_CONTEXTUALBUTTON_GRIDPAGE),iconToolTip:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_GRID_DEACTIVATE_CONTEXTUALBUTTON_GRIDPAGE),handlerName:"OnDeactivate",iconName:"Package",visibilityHandlerName:"canRenderDeactivate"},{id:"OnDelete",title:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE),iconToolTip:o.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE),handlerName:"OnDelete",iconName:"Delete"}]}},t.getForecastConfigContextMenuHandlers=function(e,t,n,o){return{OnEdit:function(e,n){i.logUsage("FC contextMenu edit button","",{rowId:e},"Click","OnEdit","ForecastConfigGrid"),t.OpenEditPage(e)},OnPublish:function(t,n){i.logUsage("FC contextMenu publish button","",{rowId:t},"Click","OnPublish","ForecastConfigGrid"),e.PublishForecastConfig(t)},canRenderPublish:function(e,t){var r=u(n,e);return r&&[s,c].indexOf(r)>=0},canRenderDeactivate:function(e,t){var r=u(n,e);return r&&[l].indexOf(r)>=0},OnDelete:function(t,n){i.logUsage("FC contextMenu delete button","",{rowId:t},"Click","OnDelete","ForecastConfigGrid"),e.DeleteForecastConfig(t)},OnCreateSnapshot:function(t,n){i.logUsage("FC contextMenu OnCreateSnapshot button","",{rowId:t},"Click","OnCreateSnapshot","ForecastConfigGrid"),e.CreateSnapshotOfForecastConfig(t)},ShowCreateSnapshot:function(e,t){var i=u(n,e);return o&&i&&i===r.IForecastConfigStatus.Published},OnDeactivate:function(t,n){i.logUsage("FC contextMenu deactivate button","",{rowId:t},"Click","OnDeactivate","ForecastConfigGrid"),e.DeactivateForecastConfig(t)}}}},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0));n(1240);var s=n(24),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.render=function(){var e=this;return a.default.createElement("div",{className:this.getTemplateContainerClass(),role:"button","aria-label":this.props.title.concat(this.props.description),tabIndex:this.props.isEnabled?0:-1,onClick:function(){return e.buttonClickHandler()},onKeyDown:this.onKeyboardPress()},"Add"!==this.props.iconName?a.default.createElement("span",{className:this.getIconContainerClass()},a.default.createElement(s.Icon,{iconName:this.props.iconName,className:"buttonIconClass"})):a.default.createElement("span",{className:"buttonCircleCustomContainerClass"},a.default.createElement(s.Icon,{iconName:this.props.iconName,className:"buttonIconCustomClass"})),a.default.createElement("span",{className:this.getButtonTitleClass()},this.props.title),a.default.createElement("span",{className:"buttonDescriptionClass"},this.props.description))},t.prototype.buttonClickHandler=function(){this.props.isEnabled&&this.props.clickHandler&&this.props.clickHandler()},t.prototype.onKeyboardPress=function(){var e=this;return function(t){13===t.keyCode&&e.buttonClickHandler()}},t.prototype.getTemplateContainerClass=function(){return this.props.isEnabled?"templateContainerClass":"templateContainerClass_disabled"},t.prototype.getIconContainerClass=function(){return this.props.isEnabled?"buttonIconContainerClass":"buttonIconContainerClass_disabled"},t.prototype.getButtonTitleClass=function(){return this.props.isEnabled?"buttonTitleClass":"buttonTitleClass_disabled"},t}(a.default.Component);t.ButtonTemplate=l,t.default=l},function(e,t,n){var r=n(1241);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".templateContainerClass,\n.templateContainerClass_disabled {\n  margin-top: 10px;\n  margin-bottom: 10px;\n  border-radius: 3px;\n  height: 224px;\n  box-shadow: 0px 0.3px 0.9px rgba(0, 0, 0, 0.108), 0px 1.6px 3.6px rgba(0, 0, 0, 0.132);\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n  max-width: 279px; }\n\n.templateContainerClass:hover {\n  box-shadow: 0px 1.2px 3.6px rgba(0, 0, 0, 0.108), 0px 6.4px 14.4px rgba(0, 0, 0, 0.132);\n  cursor: pointer; }\n\n.buttonCircleCustomContainerClass {\n  height: 144px;\n  background-color: #F0F5FF;\n  border-radius: 2px 2px 0px 0px; }\n\n.buttonCircleCustomContainerClass:focus {\n  outline: 1px solid #000000; }\n\n.buttonIconContainerClass {\n  height: 144px;\n  background-color: #2266E3;\n  border-radius: 2px 2px 0px 0px; }\n\n.buttonIconContainerClass:focus {\n  outline: 1px solid #000000; }\n\n.buttonIconContainerClass_disabled {\n  height: 144px;\n  background-color: #aaa6a2;\n  border-radius: 2px 2px 0px 0px; }\n\n.buttonIconClass {\n  color: #FFFFFF;\n  padding-top: 54px;\n  padding-left: calc(50% - 36px/2 + 0.12px);\n  font-size: 36px; }\n\n.buttonIconCustomClass {\n  color: #2266E3;\n  padding-left: calc(50% - 36px/2 + 0.12px);\n  font-size: 36px;\n  padding-top: 54px; }\n\n.buttonTitleClass {\n  color: #323130;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 600;\n  text-align: left;\n  padding-top: 9px;\n  padding-left: 16px;\n  padding-right: 16px;\n  height: 19px;\n  text-overflow: ellipsis; }\n\n.buttonTitleClass_disabled {\n  color: #696969;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  font-weight: 600;\n  text-align: center;\n  padding-top: 7px;\n  height: 19px;\n  text-overflow: ellipsis;\n  cursor: default; }\n\n.buttonTitleClass:hover {\n  color: #2266E3; }\n\n.buttonDescriptionClass {\n  padding-top: 3px;\n  padding-left: 16px;\n  padding-right: 16px;\n  color: #605E5C;\n  font-family: 'Segoe UI';\n  font-size: 12px;\n  text-align: left;\n  height: 16px;\n  line-height: 16px;\n  text-overflow: ellipsis;\n  height: 16px; }\n",""])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),i=n(7),o=n(8);t.getGridPageTemplateButtonDefinition=function(e){switch(e){case r.ForecastConfigTemplateType.OrgChart:return{iconName:"Org",description:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_HIERARCHY_TEMPLATE_SUBHEADING_GRIDPAGE),title:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_HIERARCHY_TEMPLATE_HEADING_GRIDPAGE),isEnabled:!0};case r.ForecastConfigTemplateType.TerritoryBased:return{iconName:"Globe",description:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_TERRITORY_TEMPLATE_SUBHEADING_GRIDPAGE),title:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_TERRITORY_TEMPLATE_HEADING_GRIDPAGE),isEnabled:!0};case r.ForecastConfigTemplateType.ProductBased:return{iconName:"Product",description:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_PRODUCT_TEMPLATE_SUBHEADING_GRIDPAGE),title:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_PRODUCT_TEMPLATE_HEADING_GRIDPAGE),isEnabled:!1};case r.ForecastConfigTemplateType.Custom:return{iconName:"Add",description:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_CUSTOM_TEMPLATE_SUBHEADING_GRIDPAGE),title:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_CUSTOM_TEMPLATE_HEADING_GRIDPAGE),isEnabled:!0};default:return{iconName:"",description:"",title:"",isEnabled:!1}}}},function(e,t,n){var r=n(1244);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".GridPageApp {\n  padding-left: 25px;\n  padding-right: 25px;\n  height: 100%;\n  display: flex;\n  flex-direction: column; }\n\n.CreateForecastButtonsContainer {\n  margin-top: 10px;\n  flex-flow: row wrap;\n  display: flex;\n  margin-bottom: 24px; }\n\n.CreateForecastsButtonsHeaderTitle {\n  font-family: 'Segoe UI';\n  font-size: 18px;\n  color: #323130;\n  line-height: 24px;\n  font-weight: 600; }\n\n.GridPageTitle {\n  font-family: 'Segoe UI';\n  font-size: 24px;\n  line-height: 28px;\n  color: #323130;\n  font-weight: 600; }\n\n.GridPageDescription {\n  font-family: 'Segoe UI';\n  font-size: 16px;\n  line-height: 22px;\n  color: #323130; }\n\n.PFGridPageSubHeader {\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #323130;\n  font-weight: 600; }\n\n.PFGridPageDescription {\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C; }\n\n.GridPageFlexContainer {\n  display: flex; }\n\n.PFGridPageFlexContainer {\n  display: flex; }\n\n.pageHeader {\n  display: flex;\n  flex-direction: row;\n  margin-top: 32px;\n  margin-bottom: 32px;\n  display: flex;\n  flex-direction: column; }\n\n.forecastConfigIcon {\n  width: 18;\n  height: 18px;\n  border: 1px; }\n\n.createFromScratchButton {\n  display: flex;\n  justify-content: center;\n  align-content: center;\n  background: #2266E3;\n  border-radius: 2px;\n  height: 32px;\n  color: #ffffff;\n  font-size: 14px;\n  line-height: 19px;\n  width: 189px; }\n\n.createFromScratchButton:hover {\n  color: #ffffff;\n  background: #0B53CE; }\n\n.createFromScratchDiv {\n  display: flex;\n  flex-direction: row-reverse;\n  top: 64px;\n  bottom: 64px; }\n\n.fdNotification {\n  background: rgba(234, 179, 0, 0.459);\n  border-radius: 2px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center; }\n  .fdNotification .ms-MessageBar-innerText {\n    font-size: 14px;\n    font-family: 'Segoe UI'; }\n  .fdNotification .ms-Link {\n    font-size: 14px;\n    font-family: 'Segoe UI';\n    color: #2266E3;\n    cursor: pointer !important; }\n    .fdNotification .ms-Link:hover {\n      color: #0B53CE; }\n\n.GridPageAppContainer {\n  display: flex;\n  flex-direction: column;\n  height: 100%; }\n\n.AdminSettingsContainerDiv {\n  padding-top: 180px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center; }\n\n.AdminSettingsEnableButton {\n  margin-top: 16px;\n  background: #2266E3;\n  border-radius: 2px;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  text-align: center;\n  color: #FFFFFF;\n  width: 188px;\n  height: 32px; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(86),c=n(23),u=n(99),d=n(7),p=n(8),_=n(15),E=function(e){function t(t){var n=e.call(this,t)||this;return n._closeDialog=function(){n.props.onClickArchiveDialog(l.IArchiveDialogActionType.CLOSE)},n._onClickConfirm=function(){n.props.onClickArchiveDialog(l.IArchiveDialogActionType.DEACTIVATE)},n._onCancel=function(){n.props.onClickArchiveDialog(l.IArchiveDialogActionType.CANCEL)},n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._closeDialog,dialogContentProps:{type:s.DialogType.normal,title:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DEACTIVATE_TITLE_GRIDPAGE),subText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DEACTIVATE_DESCRIPTION_GRIDPAGE)}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickConfirm,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DEACTIVATE_PRIMARYBUTTON_GRIDPAGE)}),a.default.createElement(s.DefaultButton,{onClick:this._onCancel,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE)}))))},t}(a.default.Component);t.ForecastConfigArchiveConfirmationDialog=E,t.default=E,t.ConnectedForecastConfigArchiveConfirmationDialog=c.connect((function(e){return{isHidden:e.gridAppDialogState.isGridArchiveDialogHidden,rowId:e.gridAppDialogState.gridActionableRow}}),(function(e){return{onClickArchiveDialog:function(t){_.logUsage("ArchiveConfirmationDialog.OK","",{},"Click"),e(u.onClickArchiveDialogActionCreator(t))}}}))(E)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),l=n(22),c=n(86),u=n(23),d=n(99),p=n(7),_=n(8),E=n(248),S=n(1247),f=n(4),C=n(2);n(1252);var m=n(53),g=n(61),T=n(15),I=function(e){function t(t){var n=e.call(this,t)||this;return n._titleId=C.getId("title"),n._subtitleId=C.getId("subText"),n._emptySnapshotId="00000000-0000-0000-0000-000000000000",n._hideMessage=function(){n.setState({renderMessage:!1,scenarioType:"",messageType:""})},n._getMessageBarType=function(){switch(n.state.messageType){case"Error":return l.MessageBarType.error;case"Info":return l.MessageBarType.info;case"Warning":return l.MessageBarType.warning;default:return l.MessageBarType.info}},n._getMessageForScenario=function(){switch(n.state.scenarioType){case"PrivilegeError":return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.CREATE_SNAPSHOT_FAILED_PRIVILEGE_MESSAGE);case"SnapshotLimitReached":return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_SNAPSHOT_LIMIT_INFO_TEXT);case"NoSnapshotCreated":return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_SNAPSHOT_STATUS_EMPTY_TEXT);case"ForecastNotStarted":return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.CREATE_SNAPSHOT_ERROR_FORECAST_NOT_STARTED);case"ForecastEnded":return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.CREATE_SNAPSHOT_ERROR_FORECAST_ENDED);default:return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.CREATE_SNAPSHOT_GENERIC_ERROR_MESSAGE)}},n._resetStateDefaults=function(){n.setState({disableSnapshotCreate:!0,snapshotName:"",deleteSnapshotId:"",showSnapshotTextField:!1,hideCreateSnapshotConfirmation:!0,hideDeleteSnapshotConfirmation:!0,showEmptyStatusInfo:!1,snapshotLimitReached:!1,snapshotStatusList:[],renderMessage:!1,allowMessageDismiss:!1,gridBottomPadding:16,snapshotNameErrorMessage:""})},n._closeDialogWithCreate=function(){T.logUsage("SnapshotDialog.CreateSnapshotDialog OK","",{},"Click"),n.setState({hideCreateSnapshotConfirmation:!0});var e=m.getCrmDataAccessInstance(),t=n.state.snapshotName,r=n.props.rowId;e.snapshotDataAccess.createForecastSnapshot(r,t).then((function(e){var t=JSON.parse(e);null!=t&&(t.hasOwnProperty("SnapshotID")?t.SnapshotID===n._emptySnapshotId?n.setState({messageType:"Error",scenarioType:"CreateSnapshotFailed",allowMessageDismiss:!0,renderMessage:!0}):(n._resetStateDefaults(),n._refreshGridData()):t.hasOwnProperty("Error")&&("CREATE_SNAPSHOT_NO_PRIVILEGE"==t.Error?n.setState({messageType:"Error",scenarioType:"PrivilegeError",allowMessageDismiss:!1,renderMessage:!0}):"FORECAST_NOT_STARTED"==t.Error?n.setState({messageType:"Error",scenarioType:"ForecastNotStarted",allowMessageDismiss:!1,renderMessage:!0}):"FORECAST_ENDED"==t.Error?n.setState({messageType:"Error",scenarioType:"ForecastEnded",allowMessageDismiss:!1,renderMessage:!0}):n.setState({messageType:"Error",scenarioType:"CreateSnapshotFailed",allowMessageDismiss:!0,renderMessage:!0})))})).catch((function(e){n.setState({messageType:"Error",scenarioType:"CreateSnapshotFailed",allowMessageDismiss:!0,renderMessage:!0})}))},n._closeDeleteDialogWithDelete=function(){T.logUsage("SnapshotDialog.DeleteSnapshotDialog OK","",{},"Click"),n.setState({hideDeleteSnapshotConfirmation:!0});var e=n.state.deleteSnapshotId,t=m.getCrmDataAccessInstance();n.setState({showGridLoading:!0}),t.snapshotDataAccess.deleteSnapshot(e).then((function(){n._resetStateDefaults(),n._refreshGridData()})).catch((function(){n._resetStateDefaults(),n._refreshGridData()}))},n._closeDialogWithCancel=function(){T.logUsage("SnapshotDialog.CreateSnapshotDialog Cancel","",{},"Click"),n.setState({hideCreateSnapshotConfirmation:!0,snapshotName:"",showSnapshotTextField:!1})},n._closeDeleteDialogWithCancel=function(){T.logUsage("SnapshotDialog.DeleteSnapshotDialog Cancel","",{},"Click"),n.setState({hideDeleteSnapshotConfirmation:!0,deleteSnapshotId:""})},n._checkValidSnapshotName=function(e){var t=/[$]/.test(e);n.setState({disableSnapshotCreate:t}),t?n.setState({snapshotNameErrorMessage:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.INVALID_SNAPSHOT_NAME)}):n.setState({snapshotNameErrorMessage:""}),n.setState({snapshotName:e})},n._closeDialog=function(){T.logUsage("SnapshotDialog.CreateSnapshotDialog Cancel","",{},"Click"),n.props.onClickCreateSnapshotDialog(c.ICreateSnapshotDialogActionType.CLOSE,""),n._resetStateDefaults()},n._onClickConfirm=function(){n.setState({hideCreateSnapshotConfirmation:!1})},n._onCancel=function(){T.logUsage("SnapshotDialog.CreateSnapshotDialog Cancel","",{},"Click"),n.props.onClickCreateSnapshotDialog(c.ICreateSnapshotDialogActionType.CANCEL,"")},n._onClickAddSnapshot=function(){T.logUsage("SnapshotDialog.AddSnapshot button","",{},"Click"),n.setState({showSnapshotTextField:!0,disableSnapshotCreate:!1})},n._refreshGridData=function(){n.setState({disableSnapshotCreateOnRender:!0,gridBottomPadding:16});var e=m.getCrmDataAccessInstance(),t=n.props.rowId,r=n.getDefaultPageInfo();n.setState({showGridLoading:!0}),e.snapshotDataAccess.getSnapshotStatus(t,r).then((function(e){n.setState({snapshotLimitReached:!e.AllowCreateSnapshot,snapshotStatusList:e.Data,showEmptyStatusInfo:0==e.Data.length,allowMessageDismiss:!1,showGridLoading:!1,disableSnapshotCreateOnRender:!1,snapshotNameErrorMessage:""}),0==e.Data.length&&n.renderEmptyStatusInfo(),e.AllowCreateSnapshot||n.renderSnapshotLimitInfo()})).catch((function(){n.setState({showGridLoading:!1,disableSnapshotCreateOnRender:!1})}))},n.provider=new E.DelfiGridProvider,n.delfActions=n.provider.getDelfiActions(),n.state={disableSnapshotCreate:!0,snapshotName:"",deleteSnapshotId:"",showSnapshotTextField:!1,hideCreateSnapshotConfirmation:!0,showEmptyStatusInfo:!1,showGridLoading:!1,snapshotLimitReached:!1,snapshotStatusList:[],hideDeleteSnapshotConfirmation:!0,disableSnapshotCreateOnRender:!0,renderMessage:!1,messageType:"",scenarioType:"",allowMessageDismiss:!1,gridBottomPadding:16,snapshotNameErrorMessage:""},n}return i(t,e),t.prototype.getDefaultPageInfo=function(e){void 0===e&&(e=0);return{PageSize:500,OrderByAsc:!1,PageOffset:e}},t.prototype.componentDidMount=function(){this._refreshGridData()},t.prototype.renderSnapshotLimitInfo=function(){this.setState({messageType:"Warning",scenarioType:"SnapshotLimitReached",allowMessageDismiss:!1,gridBottomPadding:40,renderMessage:!0})},t.prototype.renderMessage=function(){var e=this._getMessageForScenario(),t=this._getMessageBarType();return s.default.createElement(l.MessageBar,{messageBarType:t,isMultiline:!0,onDismiss:this.state.allowMessageDismiss?this._hideMessage:void 0,dismissButtonAriaLabel:this.state.allowMessageDismiss?p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_RIBBON_CLOSE_EDITPAGE):void 0},e)},t.prototype.renderEmptyStatusInfo=function(){this.setState({messageType:"Info",scenarioType:"NoSnapshotCreated",allowMessageDismiss:!1,renderMessage:!0})},t.prototype.renderCreateSnapsotButton=function(){return s.default.createElement("div",null,s.default.createElement(g.ActionButton,{onClick:this._onClickAddSnapshot,ariaLabel:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_ADD_SNAPSHOT_BUTTON_GRIDPAGE),styles:{root:{marginTop:16,backgroundColor:"#FFFFFF",height:50,fontSize:14}},text:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_ADD_SNAPSHOT_BUTTON_GRIDPAGE),iconProps:{iconName:"Add"},disabled:this.state.disableSnapshotCreateOnRender}))},t.prototype.renderSnapshotStatusGrid=function(){return s.default.createElement(S.SnapshotStatusGrid,o({},{snapshotStatusList:this.state.snapshotStatusList,activeColumnId:this.props.rowId,isFormReadonly:!1,isGridDataEmpty:!1,showGridLoading:this.state.showGridLoading,onDeleteSnapshot:this.onDeleteSnapshot.bind(this)}))},t.prototype.renderSnapshotNameTextField=function(){var e=this;return s.default.createElement("div",{style:{display:"flex",flexDirection:"row",background:"#FFFFFF",marginTop:17,boxSizing:"border-box",borderRadius:2}},s.default.createElement(l.TextField,{autoFocus:!0,styles:{root:{height:50,border:0}},name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.CREATE_SNAPSHOT_FIELD_NAME),ariaLabel:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.CREATE_SNAPSHOT_FIELD_NAME),errorMessage:this.state.snapshotNameErrorMessage,value:this.state.snapshotName,placeholder:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.CREATE_SNAPSHOT_PLACEHOLDER),onKeyPress:function(t){"Enter"!==t.key||e.state.disableSnapshotCreate||e._onClickConfirm()},onChange:function(t,n){null!=n&&e._checkValidSnapshotName(n)}}),s.default.createElement(l.IconButton,{iconProps:{iconName:"CheckMark"},ariaLabel:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOt_TITLE),styles:{root:{height:32,color:"#107C10"}},onClick:function(t){e.state.disableSnapshotCreate||e._onClickConfirm()}}),s.default.createElement(l.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_CANCEL),styles:{root:{height:32,color:"#A80000"}},onClick:function(t){e.setState({snapshotName:"",disableSnapshotCreate:!0,showSnapshotTextField:!1,snapshotNameErrorMessage:""})}}))},t.prototype.render=function(){var e=l.getTheme(),t=l.mergeStyleSets({container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch"},header:[e.fonts.xLargePlus,{flex:"1 1 auto",color:e.palette.neutralPrimary,display:"flex",fontSize:f.FontSizes.xLarge,alignItems:"center",fontWeight:l.FontWeights.semibold,justifyContent:"space-between"}],body:{flex:"4 4 auto",overflowY:"hidden",selectors:{p:{margin:"14px 0"},"p:first-child":{marginTop:0},"p:last-child":{marginBottom:0}}}}),n=l.mergeStyleSets({root:{color:e.palette.neutralPrimary,marginTop:1,margin:1},rootHovered:{color:e.palette.neutralDark}});return s.default.createElement(l.Modal,{isOpen:!this.props.isHidden,onDismiss:this._closeDialog,styles:{main:{width:600,paddingLeft:24,paddingRight:24,paddingTop:16,paddingBottom:this.state.gridBottomPadding},scrollableContent:{overflow:"hidden"}}},s.default.createElement("div",{className:t.header},s.default.createElement("span",{id:this._titleId},p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_CREATE_SNAPSHOT_TITLE_GRIDPAGE)),s.default.createElement(l.IconButton,{styles:n,iconProps:{iconName:"Cancel"},ariaLabel:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_CANCEL),onClick:this._closeDialog})),s.default.createElement("div",{style:{height:295,display:"flex",flexDirection:"column"}},this.state.renderMessage&&this.renderMessage(),!this.state.showEmptyStatusInfo&&this.renderSnapshotStatusGrid(),this.state.showSnapshotTextField&&this.renderSnapshotNameTextField(),!this.state.showSnapshotTextField&&!this.state.snapshotLimitReached&&this.renderCreateSnapsotButton(),s.default.createElement(l.Dialog,{hidden:this.state.hideCreateSnapshotConfirmation,onDismiss:this._closeDialogWithCancel,styles:{root:{zIndex:99999999}},dialogContentProps:{type:l.DialogType.normal,title:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOt_TITLE),subText:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_MESSAGE)},modalProps:{styles:{main:{maxWidth:450}},isModeless:!0,onDismissed:this._closeDialogWithCancel}},s.default.createElement(l.DialogFooter,null,s.default.createElement(l.PrimaryButton,{onClick:this._closeDialogWithCreate,text:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_CONFIRM)}),s.default.createElement(l.DefaultButton,{onClick:this._closeDialogWithCancel,text:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_CANCEL)}))),s.default.createElement(l.Dialog,{hidden:this.state.hideDeleteSnapshotConfirmation,onDismiss:this._closeDeleteDialogWithCancel,styles:{root:{zIndex:99999999}},dialogContentProps:{type:l.DialogType.normal,title:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_DELETE_SNAPSHOT_TITLE),subText:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_DELETE_SNAPSHOT_MESSAGE)},modalProps:{styles:{main:{maxWidth:450}},isModeless:!0,onDismissed:this._closeDeleteDialogWithCancel}},s.default.createElement(l.DialogFooter,null,s.default.createElement(l.PrimaryButton,{onClick:this._closeDeleteDialogWithCancel,text:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_CREATE_SNAPSHOT_CANCEL)}),s.default.createElement(l.DefaultButton,{onClick:this._closeDeleteDialogWithDelete,text:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.SNAPSHOT_STATUS_DELETE_SNAPSHOT_CONFIRM)})))))},t.prototype.onDeleteSnapshot=function(e){T.logUsage("SnapshotDialog.OnDelete","",{},"Click"),this.setState({deleteSnapshotId:e,hideDeleteSnapshotConfirmation:!1})},t}(s.default.Component);t.ForecastConfigGridCreateSnapshotDialog=I,t.default=I,t.ConnectedForecastConfigGridCreateSnapshotDialog=u.connect((function(e){return{isHidden:e.gridAppDialogState.isGridCreateSnapshotDialogHidden,rowId:e.gridAppDialogState.gridActionableRow}}),(function(e){return{onClickCreateSnapshotDialog:function(t,n){return e(d.onClickCreateSnapshotStateActionCreator(t,n))}}}))(I)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(1248),l=n(248),c=n(7),u=n(8);n(1250);var d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.provider=new l.DelfiGridProvider,n.delfActions=n.provider.getDelfiActions(),n}return i(t,e),t.prototype.render=function(){var e=s.convertSnapshotStatusInfoToDelfiData(this.props.snapshotStatusList,this.props.showGridLoading);return this.delfActions.updateGridInput(e),this.delfActions.updateStatelessGridActions({}),this.delfActions.updateContextMenuConfig(this.getSnapshotStatusContextMenuHandlers(),this.getSnapshotStatusGridContextMenuOptions()),a.default.createElement("div",{className:"snapshotGrid"},this.provider.render())},t.prototype.getSnapshotStatusContextMenuHandlers=function(){var e=this;return{OnDelete:function(t){e.props.onDeleteSnapshot(t)}}},t.prototype.getSnapshotStatusGridContextMenuOptions=function(){return{SnapshotName:[{id:"OnDelete",title:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE),iconToolTip:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE),handlerName:"OnDelete",iconName:"Delete"}]}},t}(a.default.Component);t.SnapshotStatusGrid=d,t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1249),i=n(7),o=n(8),a=n(302);function s(e,t){var n=a.DateFormatterProvider.Get(),r=e[t].CreatedAt;if(!r)return"";var i=new Date(r),o=n.converDateToUserTimezone(i);return n.formatDate(o,!0)}function l(e){switch(e){case 0:return{iconName:"SyncOccurence",id:"statusIcon",tooltip:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_IN_PROGRESS)};case 1:return{iconName:"StatusErrorFull",id:"statusIcon",tooltip:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_FAIL)};case 2:return{iconName:"SkypeCircleCheck",id:"statusIcon",tooltip:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_SUCCESS)}}return{iconName:"",id:""}}function c(e){switch(e){case 0:return i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_IN_PROGRESS);case 1:return i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_FAIL);case 2:return i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_SUCCESS);default:return""}}t.convertSnapshotStatusInfoToDelfiData=function(e,t){for(var n=[],a=[],u=(new r.SnapshotStatusGridDefinition).Columns,d=0;d<e.length;d++){var p={parentId:void 0,id:e[d].SnapshotId,getDisplayFormattedValue:{},getEditValue:{},getIconUrl:{},getIconTooltip:{},getIconPosition:{},getProgress:{},getStrikeValue:{},getUrlArgs:{}};p.getDisplayFormattedValue.SnapshotName=e[d].SnapshotName,p.getDisplayFormattedValue.CreatedAt=s(e,d),p.getDisplayFormattedValue.CreatedByName=e[d].CreatedByName,p.getDisplayFormattedValue.Status=c(e[d].Status),p.getIconUrl.Status=l(e[d].Status).iconName,p.getIconTooltip.Status=l(e[d].Status).tooltip,p.getIconPosition.Status="left",n.push(p)}for(d=0;d<u.length;d++){var _={id:u[d].id,header:u[d].header,dataType:1,width:u[d].width,isEditable:!1,ishierarchial:!1,isLink:!1};a.push(_)}return t&&(n=[{id:"$DG_GRIDLOADING_ROW",parentId:"",getDisplayFormattedValue:{},getEditValue:{},getIconUrl:{},getIconTooltip:{},getIconPosition:{},getProgress:{},getStrikeValue:{},getUrlArgs:{},hasShimmerBelow:!0}]),{rows:n,columns:a,labels:{ariaLabelForGrid:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_GRID_ARIA_LABEL),contextMenuButton:i.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.SNAPSHOT_STATUS_GRID_MORE_COMMANDS)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(7),o=function(){this.Columns=[{id:"SnapshotName",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.SNAPSHOT_STATUS_GRID_NAME_HEADER),type:"string",width:100},{id:"CreatedAt",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.SNAPSHOT_STATUS_GRID_CREATEDAT_HEADER),type:"string",width:100},{id:"CreatedByName",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.SNAPSHOT_STATUS_GRID_CREATEDBYNAME_HEADER),type:"string",width:100},{id:"Status",header:i.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.SNAPSHOT_STATUS_GRID_STATUS_HEADER),type:"string",width:100}]};t.SnapshotStatusGridDefinition=o},function(e,t,n){var r=n(1251);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,'.snapshotGrid {\n  height: 100%;\n  background: #FFFFFF; }\n  .snapshotGrid .ms-List-page {\n    border-bottom: none !important; }\n    .snapshotGrid .ms-List-page .ms-List-cell {\n      background: white !important; }\n    .snapshotGrid .ms-List-page .ms-DetailsRow-cellCheck {\n      align-items: center !important;\n      display: flex !important; }\n    .snapshotGrid .ms-List-page .ms-DetailsRow {\n      border-bottom: thin solid #E1DFDD !important;\n      min-height: 42px !important; }\n      .snapshotGrid .ms-List-page .ms-DetailsRow:hover {\n        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1) !important;\n        z-index: 10; }\n      .snapshotGrid .ms-List-page .ms-DetailsRow.is-selected {\n        background: #F3F2F1 !important; }\n      .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell {\n        border-left: none !important;\n        height: 42px !important;\n        padding-bottom: 0px !important; }\n        .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlCellDiv {\n          justify-content: flex-start !important;\n          font-size: 12px !important;\n          color: #323130 !important;\n          letter-spacing: 0.005em; }\n        .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .cellContextmenu {\n          margin-left: 12px !important;\n          align-items: flex-start !important;\n          font-size: 12px !important;\n          color: #605E5C !important;\n          letter-spacing: 0.02em; }\n        .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .cellContextMenuIcon button {\n          width: 20px !important; }\n        .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass {\n          color: #323130 !important;\n          text-decoration: none !important; }\n          .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass:hover {\n            color: #2266E3 !important; }\n        .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectedCell {\n          border-color: transparent !important; }\n        .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .delfiIconCell {\n          margin-left: -2px; }\n          .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .delfiIconCell .delfiIcon {\n            font-size: 16px; }\n          .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .delfiIconCell i[data-icon-name="StatusErrorFull"] {\n            color: #A4262C; }\n          .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .delfiIconCell i[data-icon-name="SkypeCircleCheck"] {\n            color: #107C10; }\n        .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .gridIconButton {\n          flex-direction: row-reverse;\n          justify-content: flex-end !important; }\n          .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .gridIconButton .gridIconsOnTop {\n            position: relative !important;\n            top: auto !important;\n            right: auto !important;\n            margin-right: initial !important; }\n            .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .gridIconButton .gridIconsOnTop .gridIconButtonIcon {\n              visibility: visible !important;\n              margin-left: -8px; }\n              .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .gridIconButton .gridIconsOnTop .gridIconButtonIcon i[data-icon-name="StatusErrorFull"] {\n                color: #A4262C; }\n              .snapshotGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectableCell .gridIconButton .gridIconsOnTop .gridIconButtonIcon i[data-icon-name="SkypeCircleCheck"] {\n                color: #107C10; }\n  .snapshotGrid .ms-DetailsHeader {\n    border: 0px !important;\n    border-bottom: thin solid #E1DFDD !important;\n    border-top: none !important;\n    padding-top: 0 !important; }\n    .snapshotGrid .ms-DetailsHeader .ms-DetailsHeader-cell[aria-colindex="4"] {\n      background: white !important; }\n    .snapshotGrid .ms-DetailsHeader .ms-DetailsHeader-cell {\n      border-left: none !important;\n      padding: 0px !important;\n      text-align: left !important;\n      font-size: 14px !important;\n      font-weight: 600 !important; }\n      .snapshotGrid .ms-DetailsHeader .ms-DetailsHeader-cell:hover {\n        background-color: none !important; }\n      .snapshotGrid .ms-DetailsHeader .ms-DetailsHeader-cell .ms-DetailsHeader-cellTitle {\n        text-align: left !important;\n        margin-top: 20px !important;\n        display: block;\n        color: #323130 !important;\n        letter-spacing: 0.02em; }\n  .snapshotGrid .ms-CommandBar {\n    background: white !important;\n    border-bottom: thin solid #E1DFDD;\n    border-top: thin solid #E1DFDD; }\n  .snapshotGrid .cellContextMenuIcon {\n    top: 10px !important;\n    bottom: 10px !important;\n    height: auto !important; }\n  .snapshotGrid .cellContextMenuIcon:hover {\n    background-color: #F3F2F1; }\n  .snapshotGrid .cellContextmenu {\n    background: #FFFFFF; }\n  .snapshotGrid .gridIconButton {\n    pointer-events: none; }\n',""])},function(e,t,n){var r=n(1253);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,'.infoMessage {\n  min-width: 50px;\n  font-family: "Segoe UI";\n  font-size: 14px;\n  line-height: 19px;\n  color: "#323130";\n  margin-left: 1px;\n  display: flex;\n  margin-top: 10px; }\n',""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(86),c=n(23),u=n(99),d=n(7),p=n(8),_=n(15),E=function(e){function t(t){var n=e.call(this,t)||this;return n._closeDialog=function(){n.props.onClickPublishDialog(l.IPublishDialogActionType.CLOSE)},n._onClickConfirm=function(){n.props.onClickPublishDialog(l.IPublishDialogActionType.PUBLISH)},n._onCancel=function(){n.props.onClickPublishDialog(l.IPublishDialogActionType.CANCEL)},n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._closeDialog,modalProps:{styles:{main:{outline:"1px solid transparent !important"}}},dialogContentProps:{type:s.DialogType.normal,title:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_PUBLISH_TITLE_GRIDPAGE),subText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_PUBLISH_DESCRIPTION_GRIDPAGE)}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickConfirm,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_PUBLISH_PRIMARYBUTTON_GRIDPAGE)}),a.default.createElement(s.DefaultButton,{onClick:this._onCancel,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE)}))))},t}(a.default.Component);t.ForecastConfigPublishConfirmationDialog=E,t.default=E,t.ConnectedForecastConfigPublishConfirmationDialog=c.connect((function(e){return{isHidden:e.gridAppDialogState.isGridPublishDialogHidden,rowId:e.gridAppDialogState.gridActionableRow}}),(function(e){return{onClickPublishDialog:function(t){_.logUsage("PublishConfirmationDialog.OK","",{},"Click"),e(u.onClickPublishDialogActionCreator(t))}}}))(E)},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(86),c=n(23),u=n(99),d=n(7),p=n(8),_=n(15),E=function(e){function t(t){var n=e.call(this,t)||this;return n._closeDialog=function(){_.logUsage("EnableManualForecastingDialog.Close","",{},"Click"),n.props.onDialogClick(l.IEnableManualForecastingActionType.CLOSE)},n._onClickConfirm=function(){_.logUsage("EnableManualForecastingDialog.OK","",{},"Click"),n.props.onDialogClick(l.IEnableManualForecastingActionType.ENABLE)},n._onCancel=function(){_.logUsage("EnableManualForecastingDialog.Cancel","",{},"Click"),n.props.onDialogClick(l.IEnableManualForecastingActionType.CANCEL)},n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._closeDialog,modalProps:{styles:{main:{outline:"1px solid transparent !important"}}},dialogContentProps:{type:s.DialogType.normal,title:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.MF_ADMIN_SETTINGS_DIALOG_TITLE),subText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.MF_ADMIN_SETTINGS_DIALOG_DESC)}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickConfirm,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.MF_ADMIN_SETTINGS_DIALOG_PRIMARYBUTTON)}),a.default.createElement(s.DefaultButton,{onClick:this._onCancel,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE)}))))},t}(a.default.Component);t.EnableManualForecastingDialog=E,t.default=E,t.ConnectedEnableManualForecastingDialog=c.connect((function(e){return{isHidden:e.gridAppDialogState.isEnableManualForecastingDialogHidden}}),(function(e){return{onDialogClick:function(t){e(u.onEnableManualForecastingDialogClickActionCreator(t))}}}))(E)},function(e,t,n){var r=n(1257);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".noFcMsgContainer {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  flex-direction: column;\n  align-items: center; }\n\n.noFcMsgTitle {\n  color: #323130;\n  font-size: 16px;\n  line-height: 20px;\n  letter-spacing: 0.005em;\n  font-weight: 600;\n  margin-top: 16px; }\n\n.noFcMsgDesc {\n  width: 503px;\n  font-size: 14px;\n  line-height: 20px;\n  text-align: center;\n  margin-top: 8px; }\n",""])},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(0));t.CrystallBallIcon=i.createElement("svg",{width:"140",height:"134",viewBox:"0 0 140 134",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("g",{"clip-path":"url(#clip0)"},i.createElement("circle",{cx:"69.5913",cy:"70.4607",r:"55.6164",fill:"white",stroke:"#2266E3","stroke-width":"3.83562"}),i.createElement("path",{d:"M91.6466 104.165C102.619 96.9699 109.866 84.5616 109.866 70.4607C109.866 67.4984 109.546 64.6108 108.939 61.8306",stroke:"#EDEBE9","stroke-width":"3.83562","stroke-linecap":"round"}),i.createElement("path",{d:"M21.6466 70.4621C21.6466 67.8511 21.8554 65.2887 22.257 62.7909M33.1535 39.3001C29.4309 43.6489 26.4733 48.6719 24.4891 54.1608M25.6361 89.6402C28.1172 95.319 31.6666 100.424 36.0302 104.702",stroke:"#C8C6C4","stroke-width":"3.83562","stroke-linecap":"round"}),i.createElement("path",{d:"M33.94 113.833C34.2378 113.118 34.9361 112.653 35.7103 112.653H101.742C102.468 112.653 103.132 113.063 103.457 113.713L111.128 129.055C111.766 130.33 110.838 131.831 109.413 131.831H29.3176C27.9491 131.831 27.021 130.438 27.5473 129.175L33.94 113.833Z",fill:"white",stroke:"#333333","stroke-width":"3.83562"}),i.createElement("path",{d:"M138.623 39.7234L129.488 46.7198",stroke:"#C8C6C4","stroke-width":"3.83562","stroke-linecap":"round","stroke-linejoin":"round"}),i.createElement("path",{d:"M130.559 38.6558L137.555 47.7913",stroke:"#C8C6C4","stroke-width":"3.83562","stroke-linecap":"round","stroke-linejoin":"round"}),i.createElement("path",{d:"M29.076 0L31.64 9.23991",stroke:"#C8C8C8","stroke-width":"3.83562","stroke-linecap":"round","stroke-linejoin":"round"}),i.createElement("path",{d:"M18.8727 22.2346L9.58868 19.8351",stroke:"#2266E3","stroke-width":"3.83562","stroke-linecap":"round","stroke-linejoin":"round"}),i.createElement("path",{d:"M18.3 8.23309L21.0361 10.9211",stroke:"#C8C8C8","stroke-width":"3.83562","stroke-linecap":"round","stroke-linejoin":"round"}),i.createElement("path",{d:"M123.29 26.7145L126.374 24.4341",stroke:"#2266E3","stroke-width":"3.83562","stroke-linecap":"round","stroke-linejoin":"round"})),i.createElement("defs",null,i.createElement("clipPath",{id:"clip0"},i.createElement("rect",{width:"139.743",height:"134",fill:"white"}))))},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),l=n(45),c=n(149),u=n(624),d=n(625),p=n(23),_=n(178),E=n(626),S=n(627);n(1260);var f=n(138),C=n(7),m=n(8),g=a(n(628)),T=n(629),I=n(100),h=n(60);l.initializeIcons();var A=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return i(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.gridEventsHandler.RefreshGrid().then((function(t){e.props.fdNotificationEventHandler.ValidateAndTriggerFDFetch(t),e.props.gridEventsHandler.FetchPredictionLastRunDate(t)}))},t.prototype.render=function(){return!1===this.props.canRenderPage?s.default.createElement("div",{className:"Spinner"},s.default.createElement(c.Spinner,{size:I.SpinnerSize.medium})):s.default.createElement("div",{className:"SIGridPageAppContainer"},s.default.createElement("div",{className:"SIGridPageApp"},s.default.createElement("div",{className:"SIPageHeader"},s.default.createElement("span",{className:"SIGridPageTitle",role:"heading","aria-level":1},C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIVE_HEADING_GRIDPAGE)),s.default.createElement("br",null),s.default.createElement("div",{className:"SIGridPageContainer"},s.default.createElement("span",{className:"SIGridPageSubHeader"},C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIONS_GRIDPAGE)),C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIVE_DETAILS_GRIDPAGE),s.default.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=2125209",target:"_blank",style:{textDecoration:"none"}}," ",C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIVE_LINK_FCPREDICTION_GRIDPAGE))),s.default.createElement("div",{className:"SIGridPageContainer"},s.default.createElement("span",{className:"SIGridPageSubHeader"},C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_SNAPSHOTS_GRIDPAGE)),s.default.createElement("span",{className:"SIGridPageContainer"}," ",C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_SNAPSHOTS_DETAILS_GRIDPAGE)," "),s.default.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=2124998",target:"_blank",style:{textDecoration:"none"}}," ",C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIVE_LINK_GRIDPAGE)))),s.default.createElement("div",{className:"SIGridPageSubSectionContainer"},s.default.createElement("div",{className:"SIGridPageSecondHeader"},C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIVE_FCLIST_GRIDPAGE)),s.default.createElement("div",{className:"SIGridPageDescription"},s.default.createElement("span",null,C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIVE_ENABLE_GRIDPAGE)),s.default.createElement("div",{className:"SIGridPageContainer"},s.default.createElement(h.FontIcon,{iconName:"Info",className:"SIGridPageSubSectionIcon"}),s.default.createElement("span",null,C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIVE_MINIMUM_REQ_GRIDPAGE)),s.default.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=2125341",target:"_blank",style:{textDecoration:"none"}}," ",C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.FORECAST_PREDICTIVE_LINK_GRIDPAGE))))),s.default.createElement(S.ConnectedGridFilterSelector,null),this.props.showNoFcsMessage&&this.renderNoFcsMessage(),!this.props.showNoFcsMessage&&s.default.createElement(E.ForecastConfigGrid,o({},{forecastConfigs:this.props.forecastConfigList,gridEventsHandler:this.props.gridEventsHandler,navigationHandlers:this.props.navigationHandler,shouldShowCreateSnapshotButton:!1,isPredictivePage:!0,entityMetadataList:this.props.entityMetadataList}))))},t.prototype.renderNoFcsMessage=function(){return s.default.createElement("div",{style:{marginTop:32}},s.default.createElement(g.default,{titleLabel:C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.NoFcMsgTitle),learnMoreLabel:C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.NoFcMsgLearnMore),descLabel:C.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.NoFcMsgDesc),learnMoreLink:"https://go.microsoft.com/fwlink/?linkid=2103790"}))},t}(s.default.Component);t.default=A;t.ConnectedSIGridApp=p.connect((function(e){return{forecastConfigList:_.GetFCList_FromState(e),showNoFcsMessage:_.Get_ShowNoFCsMessage_FromState(e),canRenderPage:_.isEnableManualForecastingFlagFetched_FromState(e),entityMetadataList:e.entityMetadataList}}),(function(e,t){return{gridEventsHandler:new u.GridEventsHandler(e,t.crmDataAccess.forecastConfigAccess),navigationHandler:f.NavigationHandlerFactory.GetNavigationHandlerObject(e),fdNotificationEventHandler:new d.FDNotificationEventHandler(e,t.crmDataAccess.forecastDefintionDataAccess),adminSettingsEventsHandler:new T.AdminSettingsEventsHandler(e)}}))(A)},function(e,t,n){var r=n(1261);"string"==typeof r&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(30)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(29)(!1)).push([e.i,".Spinner {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  /* bring your own prefixes */\n  transform: translate(-50%, -50%); }\n\n.SIGridPageApp {\n  padding-left: 32px;\n  padding-right: 25px;\n  padding-top: 48px;\n  height: 100%;\n  display: flex;\n  flex-direction: column; }\n\n.SIPageHeader {\n  display: flex;\n  flex-direction: column;\n  width: 776px; }\n\n.SIGridPageTitle {\n  font-size: 24px;\n  font-weight: 600; }\n\n.SIGridPageSubSectionContainer {\n  display: flex;\n  flex-direction: column;\n  margin-bottom: 36px; }\n\n.SIGridPageSubHeader {\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #323130;\n  font-weight: 600; }\n\n.SIGridPageContainer {\n  display: inline;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C; }\n\n.SIGridPageSecondHeader {\n  margin-top: 32px;\n  font-family: 'Segoe UI';\n  font-size: 18px;\n  font-weight: 600;\n  line-height: 24px;\n  color: #323130; }\n\n.SIGridPageDescription {\n  display: flex;\n  flex-direction: column;\n  margin-top: 16px;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C; }\n\n.SIGridPageSubSectionIcon {\n  vertical-align: middle;\n  font-size: 16px;\n  margin-right: 8px; }\n",""])},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),s=n(22),l=n(23),c=n(7),u=n(8),d=n(41),p=n(98),_=n(15),E=function(e){function t(t){var n=e.call(this,t)||this;return n._onClickOK=function(){n.props.onClickOk()},n.state={},n}return i(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._onClickOK,modalProps:{styles:{main:{outline:"1px solid transparent !important"}}},dialogContentProps:{type:s.DialogType.normal,title:d.ForecastingBusinessLogicProvider.getTitleForGenericErrorDialog(this.props.dialogType),subText:this.getDialogMessage()}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickOK,text:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_OK)}))))},t.prototype.getDialogMessage=function(){return this.props.message||d.ForecastingBusinessLogicProvider.getDescriptionForGenericErrorDialog(this.props.dialogType)},t}(a.default.Component);t.ForecastConfigGenericErrorDialog=E,t.default=E,t.ConnectedForecastConfigGenericErrorDialog=l.connect((function(e){return{isHidden:e.genericErrorDialogState.isDialogHidden,dialogType:e.genericErrorDialogState.dialogType,message:e.genericErrorDialogState.customMessage}}),(function(e){return{onClickOk:function(){_.logUsage("GenericErrorDialog.OK","",{},"Click"),e(p.onClickOkErrorDialogActionCreator())}}}))(E)}]);