var forecastConfig=function(e){function t(t){for(var r,a,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)a=s[d],o[a]&&p.push(o[a][0]),o[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);for(u&&u(t);p.length;)p.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var s=window.webpackJsonpforecastConfig=window.webpackJsonpforecastConfig||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;return i.push([693,1]),n()}({107:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=50;t.sanitizeNameString=function(e){return e&&e.trim&&""==e.trim()?"":e&&e.substring?e.substring(0,r):e},t.sanitizeUniqueName=function(e){return e&&e.toLowerCase&&e.substring&&(e=e.toLowerCase().substring(0,r)),e},t.filterNonValidCharactersForUniqueName=function(e){return e&&e.toLowerCase&&e.replace&&e.substring?e.replace(/\s/g,"").replace(/[^A-Za-z0-9_]/g,"").replace(/^[_0-9]+/g,"").toLowerCase().substring(0,r):e},t.isUniqueNameProper=function(e){return 0==e.length||null!==e.match(/^[a-zA-Z][a-zA-Z_0-9]*$/g)}},108:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Stage1=0]="Stage1",e[e.Stage2=1]="Stage2"}(t.FCConfigFormStage||(t.FCConfigFormStage={})),function(e){e[e.General=1]="General",e[e.Permission=2]="Permission",e[e.View=3]="View",e[e.Quota=4]="Quota"}(t.ForecastConfigStage||(t.ForecastConfigStage={}))},109:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n(64),a=n(45),s=n(456),l=n(110),c=n(89),u=n(107),d=n(330);function p(e,t){var n=d.ExpressionParserFactory.getCalculatedFieldExpressionParser(),r=[];try{r=n.getReferencingCalculatedColumns(t,e)}catch(e){}return r}function _(e){var t=S(e),n=e.FormFieldData.columns.find((function(e){return e.id==t}));return n||s.FakeColumnInfoData.Owner()}function f(e,t){return!!e.find((function(e){return e.id!=t.id&&e.uniqueName==t.uniqueName}))}function E(e){var t=e.ActiveForecastConfigInfo,n=_(e),r=t.columns.find((function(e){return e.id==n.id}));return!!(r&&r.uniqueName&&u.isUniqueNameProper(r.uniqueName))}function m(e){return e.columnEditorState.isSuggestionCalloutVisible}function S(e){return e.columnEditorState.activeForecastColumnId}t.GetForecastColumnsWithStatusList_FromState=function(e){var t=e.FormFieldData.columns;return e.FormFieldData.columns.filter((function(t){return t.columnType!=o.ForecastColumnType.Predictive||c.Get_ShouldShowPredictiveColumn_FromState(e)})).map((function(n){if(n.columnType==o.ForecastColumnType.HierarchyPrimary){var i=l.getHierarchyEntityDisplayName(e);n.title="HierarchyPrimary"==n.title?i:n.title,n.uniqueName=u.filterNonValidCharactersForUniqueName(i)}var s=f(t,n),c=a.ForecastingBusinessLogicProvider.GetColumnInfoStatus(n,s,e.FormFieldData.status),d=p(n.id,e.FormFieldData);return r({},n,{status:c,dependentCalculatedColumns:d})}))},t.GetDependentCalculatedColumnsForForecastColumnInfo=p,t.GetActiveForecastColumnInfo_FromState=_,t.AreUniqueNamesDuplicateInFC=function(e){var t=e.FormFieldData.columns,n=new Set(t.map((function(e){return e.uniqueName})));return!(t.length==n.size)},t.IsUniqueNameForCurrentForecastColumnDuplicateInFC=function(e){return f(e.FormFieldData.columns,_(e))},t.AreUniqueNamesProperInFC=function(e){var t=e.FormFieldData.columns,n=!0;return t.forEach((function(e){n=n&&u.isUniqueNameProper(e.uniqueName)})),n},t.IsUniqueNameForCurrentForecastColumnProper=function(e){var t=_(e);return u.isUniqueNameProper(t.uniqueName)},t.IsActiveColumnUniqueNameAlreadyStoredInDB=E,t.IsUniqueNameDisabled=function(e){var t=E(e);return i.GetIsFormLocked_FromState(e)||t},t.IsCalculatedFieldSuggestionsCalloutVisible_FromState=m,t.GetIsColumnEditorOpened_FromState=function(e){return e.columnEditorState.idEditorOpened},t.GetIsCalculatedFieldExpressionErrorHidden_FromState=function(e){return!!m(e)||e.columnEditorState.isCalculatedFieldExpressionErrorHidden},t.GetCalculatedFieldExpressionErrorMessage_FromState=function(e){return e.columnEditorState.calculatedFieldExpressionErrorMessage},t.GetCalculatedFieldExpressionSuggestions_FromState=function(e){return e.columnEditorState.calculatedFieldExpressionSuggestions},t.GetIsOptionSetEditorOpened_FromState=function(e){return e.columnEditorState.isOptionSetSelectorOpened},t.GetPredictiveAvailabilityState=function(e){return e.PredictiveAvailabilityState},t.GetActiveColumnId_FromState=S,t.GetDisabledColumnTypes_FromState=function(e){var t=[o.ForecastColumnType.HierarchyPrimary,o.ForecastColumnType.Quota];return i.GetIsFormLocked_FromState(e)&&t.push(o.ForecastColumnType.Rollup,o.ForecastColumnType.Calculated),t}},11:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(701),o=function(){function e(){}return e.UpdateCCFStringsProvider=function(e){this.ccfStringsProvider=e},e.GetString=function(e){return this.ccfStringsProvider?this.ccfStringsProvider.getLocalizedString(e):this.defaultProvider.getLocalizedString(e)},e.defaultProvider=new r.DefaultLocalizedStringsProvider,e}();t.GlobalLocalizedStringsProvider=o},110:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(12),i=n(45);function a(e){var t="",n=e.FormFieldData.hierarchyEntity;return null!=n&&s(e,n)&&(t=e.entityMetadataList[n].DisplayName),t}function s(e,t){return null!=e.entityMetadataList[t]}function l(e,t){return s(e,t)&&void 0!==e.entityMetadataList[t].AttributesMetadata&&void 0!==e.entityMetadataList[t].AttributesMetadata.DependentAttributes}function c(e,t){return s(e,t)&&void 0!==e.entityMetadataList[t].EntityRelationshipCollection}t.getHierarchyEntityDisplayName=a,t.IsEntityMetadataAvailable_InState=s,t.IsEntityAttributeMetadataAvailable_InState=l,t.IsEntityRelationshipMetadaAvailable_InState=c,t.getHierarchyRoute=function(e){var t="",n=e.FormFieldData.hierarchyRelationship,a=i.ForecastingBusinessLogicProvider.getRelationshipDepth(n),s=i.ForecastingBusinessLogicProvider.getHierarchyRouteDisplayStrings(n,e.entityMetadataList);return s&&s.length>0&&(1==a?t=r.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_HIERARCHY_ROUTE_TWO_LEVELS):2==a&&(t=r.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_HIERARCHY_ROUTE_THREE_LEVELS)),s.forEach((function(e,n){t=t.replace("{"+n+"}",e)}))),t},t.getAttributeDisplayName=function(e,t,n){if(l(n,e)){var r=n.entityMetadataList[e].AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName==t}));if(r)return r.DisplayName}},t.isEntityHierarchyRelationshipConfigured=function(e){var t=e.FormFieldData.hierarchyEntity;return!!c(e,t)&&void 0!==e.entityMetadataList[t].EntityRelationshipCollection.DependentRelationships.find((function(e){return 1==e.IsHierarchical}))},t.getHierarchyRelationshipNotConfiguredErrorMessage=function(e){return r.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_HIERARCHY_REL_NOT_PRESENT_MESSAGE).replace("{0}",a(e))},t.getRolesFromState=function(e){return e.orgSecurityRolesList},t.areRolesFetched_FromState=function(e){return e.orgSecurityRolesList.length>0}},12:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STRING_KEYS={FORECAST_CONFIG_HEADING_GRIDPAGE:"FORECAST_CONFIG_HEADING_GRIDPAGE",FORECAST_CONFIG_SUBHEADINGLINK_GRIDPAGE:"FORECAST_CONFIG_SUBHEADINGLINK_GRIDPAGE",FORECAST_CONFIG_SUBHEADING_GRIDPAGE:"FORECAST_CONFIG_SUBHEADING_GRIDPAGE",FORECAST_CONFIG_CREATE_BUTTON_GRIDPAGE:"FORECAST_CONFIG_CREATE_BUTTON_GRIDPAGE",FORECAST_CONFIG_TEMPLATE_HEADING_GRIDPAGE:"FORECAST_CONFIG_TEMPLATE_HEADING_GRIDPAGE",FC_HIERARCHY_TEMPLATE_HEADING_GRIDPAGE:"FC_HIERARCHY_TEMPLATE_HEADING_GRIDPAGE",FC_TERRITORY_TEMPLATE_HEADING_GRIDPAGE:"FC_TERRITORY_TEMPLATE_HEADING_GRIDPAGE",FC_PRODUCT_TEMPLATE_HEADING_GRIDPAGE:"FC_PRODUCT_TEMPLATE_HEADING_GRIDPAGE",FC_HIERARCHY_TEMPLATE_SUBHEADING_GRIDPAGE:"FC_HIERARCHY_TEMPLATE_SUBHEADING_GRIDPAGE",FC_TERRITORY_TEMPLATE_SUBHEADING_GRIDPAGE:"FC_TERRITORY_TEMPLATE_SUBHEADING_GRIDPAGE",FC_PRODUCT_TEMPLATE_SUBHEADING_GRIDPAGE:"FC_PRODUCT_TEMPLATE_SUBHEADING_GRIDPAGE",FC_MORE_COMMANDS:"FC_MORE_COMMANDS",FC_HIERARCHY_GRID_LABEL:"FC_HIERARCHY_GRID_LABEL",FC_GRID_ARIA_LABEL:"FC_GRID_ARIA_LABEL",FC_GRID_SELECTOR_ALL_GRIDPAGE:"FC_GRID_SELECTOR_ALL_GRIDPAGE",FC_GRID_SELECTOR_PUBLISHED_GRIDPAGE:"FC_GRID_SELECTOR_PUBLISHED_GRIDPAGE",FC_GRID_SELECTOR_DRAFTS_GRIDPAGE:"FC_GRID_SELECTOR_DRAFTS_GRIDPAGE",FC_GRID_SELECTOR_ARCHIVED_GRIDPAGE:"FC_GRID_SELECTOR_ARCHIVED_GRIDPAGE",FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE:"FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE",FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE:"FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE",FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE:"FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE",FC_GRID_COLUMN_NAME_FROM_GRIDPAGE:"FC_GRID_COLUMN_NAME_FROM_GRIDPAGE",FC_GRID_COLUMN_NAME_TO_GRIDPAGE:"FC_GRID_COLUMN_NAME_TO_GRIDPAGE",FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE:"FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE",FC_EDIT_RIBBON_SAVE_EDITPAGE:"FC_EDIT_RIBBON_SAVE_EDITPAGE",FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE:"FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE",FC_EDIT_RIBBON_DELETE_EDITPAGE:"FC_EDIT_RIBBON_DELETE_EDITPAGE",FC_EDIT_RIBBON_CLOSE_EDITPAGE:"FC_EDIT_RIBBON_CLOSE_EDITPAGE",FC_EDIT_STATUS_STATUS_EDITPAGE:"FC_EDIT_STATUS_STATUS_EDITPAGE",FC_EDIT_STATUS_TYPE_EDITPAGE:"FC_EDIT_STATUS_TYPE_EDITPAGE",FC_EDIT_STATUS_OWNER_EDITPAGE:"FC_EDIT_STATUS_OWNER_EDITPAGE",FC_EDIT_FORECAST_TITLE_EDITPAGE:"FC_EDIT_FORECAST_TITLE_EDITPAGE",FC_EDIT_STEPPER_STAGE1_EDITPAGE:"FC_EDIT_STEPPER_STAGE1_EDITPAGE",FC_EDIT_STEPPER_STAGE2_EDITPAGE:"FC_EDIT_STEPPER_STAGE2_EDITPAGE",FC_EDIT_STEPPER_STAGE3_EDITPAGE:"FC_EDIT_STEPPER_STAGE3_EDITPAGE",FC_EDIT_STEPPER_STAGE4_EDITPAGE:"FC_EDIT_STEPPER_STAGE4_EDITPAGE",FC_EDIT_STEPPER_BUTTON_BACK_EDITPAGE:"FC_EDIT_STEPPER_BUTTON_BACK_EDITPAGE",FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE:"FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE",FC_EDIT_STEPPER_BUTTON_FINISH_EDITPAGE:"FC_EDIT_STEPPER_BUTTON_FINISH_EDITPAGE",FC_ROLLUP_ENTITY_STAGE1:"FC_ROLLUP_ENTITY_STAGE1",FC_HIERARCHY_ENTITY_STAGE1:"FC_HIERARCHY_ENTITY_STAGE1",FC_TOP_OF_HIERARCHY_STAGE1:"FC_TOP_OF_HIERARCHY_STAGE1",FC_TOP_OF_HIERARCHY2_STAGE1:"FC_TOP_OF_HIERARCHY2_STAGE1",FC_FORECAST_PERIOD_STAGE1:"FC_FORECAST_PERIOD_STAGE1",FC_FISCAL_YEAR_STAGE1:"FC_FISCAL_YEAR_STAGE1",FC_FORECAST_START_AT_STAGE1:"FC_FORECAST_START_AT_STAGE1",FC_NUMBER_OF_PERIODS_STAGE1:"FC_NUMBER_OF_PERIODS_STAGE1",FC_VALID_FROM_STAGE1:"FC_VALID_FROM_STAGE1",FC_VALID_TO_STAGE1:"FC_VALID_TO_STAGE1",FC_PREVIEW_HIERARCHY_NO_DATA_STAGE1:"FC_PREVIEW_HIERARCHY_NO_DATA_STAGE1",FC_PREVIEW_HIERARCHY_SELECT_ENTITY_STAGE1:"FC_PREVIEW_HIERARCHY_SELECT_ENTITY_STAGE1",FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1:"FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1",FC_PREVIEW_HIERARCHY_COLUMN:"FC_PREVIEW_HIERARCHY_COLUMN",FC_LOADING:"FC_LOADING",FC_ADD_FILTERS_TEXT:"FC_ADD_FILTERS_TEXT",FC_DIALOG_DELETE_TITLE_GRIDPAGE:"FC_DIALOG_DELETE_TITLE_GRIDPAGE",FC_DIALOG_DELETE_DESCRIPTION_GRIDPAGE:"FC_DIALOG_DELETE_DESCRIPTION_GRIDPAGE",FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE:"FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE",FC_DIALOG_SECONDARYBUTTON_GRIDPAGE:"FC_DIALOG_SECONDARYBUTTON_GRIDPAGE",FC_DIALOG_PUBLISH_TITLE_GRIDPAGE:"FC_DIALOG_PUBLISH_TITLE_GRIDPAGE",FC_DIALOG_PUBLISH_DESCRIPTION_GRIDPAGE:"FC_DIALOG_PUBLISH_DESCRIPTION_GRIDPAGE",FC_DIALOG_PUBLISH_PRIMARYBUTTON_GRIDPAGE:"FC_DIALOG_PUBLISH_PRIMARYBUTTON_GRIDPAGE",FC_CONFIGURATION_SECTION_HEADER_STAGE1:"FC_CONFIGURATION_SECTION_HEADER_STAGE1",FC_CONFIGURATION_SECTION_SUBTITLE_STAGE1:"FC_CONFIGURATION_SECTION_SUBTITLE_STAGE1",FC_CONFIGURATION_SECTION_SUBTITLE2_STAGE1:"FC_CONFIGURATION_SECTION_SUBTITLE2_STAGE1",FC_CONFIGURATION_SECTION_SUBTITLE3_STAGE1:"FC_CONFIGURATION_SECTION_SUBTITLE3_STAGE1",FC_SCHEDULING_SECTION_HEADER_STAGE1:"FC_SCHEDULING_SECTION_HEADER_STAGE1",FC_SCHEDULING_SECTION_SUBTITLE_STAGE1:"FC_SCHEDULING_SECTION_SUBTITLE_STAGE1",FC_TOP_OF_HIERARCHY_WITH_PLACEHOLDER_STAGE1:"FC_TOP_OF_HIERARCHY_WITH_PLACEHOLDER_STAGE1",FC_PUBLISH_HEADING:"FC_PUBLISH_HEADING",FC_PUBLISH_TEXT:"FC_PUBLISH_TEXT",FC_PUBLISH_SUCCESS:"FC_PUBLISH_SUCCESS",FC_PUBLISH_INPROGRESS:"FC_PUBLISH_INPROGRESS",FC_PUBLISH_FAILED:"FC_PUBLISH_FAILED",FC_QUOTA_HEADING:"FC_QUOTA_HEADING",FC_QUOTA_TEXT_LINE1:"FC_QUOTA_TEXT_LINE1",FC_QUOTA_TEXT_LINE2:"FC_QUOTA_TEXT_LINE2",FC_QUOTA_DOWNLOAD_TEXT:"FC_QUOTA_DOWNLOAD_TEXT",FC_QUOTA_UPLOAD_FILE:"FC_QUOTA_UPLOAD_FILE",FC_QUOTA_UPLOAD_LINE1:"FC_QUOTA_UPLOAD_LINE1",FC_QUOTA_UPLOAD_LINE2:"FC_QUOTA_UPLOAD_LINE2",FC_QUOTA_UPLOAD_DRAG:"FC_QUOTA_UPLOAD_DRAG",FC_QUOTA_UPLOADING:"FC_QUOTA_UPLOADING",FC_QUOTA_PROCESSING:"FC_QUOTA_PROCESSING",FC_QUOTA_STEP1:"FC_QUOTA_STEP1",FC_QUOTA_STEP2:"FC_QUOTA_STEP2",FC_QUOTA_SUCCESS:"FC_QUOTA_SUCCESS",FC_QUOTA_FAILED:"FC_QUOTA_FAILED",FC_QUOTA_FAILED_UNKNOWN:"FC_QUOTA_FAILED_UNKNOWN",FC_QUOTA_FAILED_GUID_TAMPERED:"FC_QUOTA_FAILED_GUID_TAMPERED",FC_QUOTA_FAILED_INVALID_ROWS:"FC_QUOTA_FAILED_INVALID_ROWS",FC_QUOTA_FAILED_INVALID_CONTENT:"FC_QUOTA_FAILED_INVALID_CONTENT",FC_QUOTA_FAILED_INVALID_FILE:"FC_QUOTA_FAILED_INVALID_FILE",FC_QUOTA_FAILED_INVALID_SIZE:"FC_QUOTA_FAILED_INVALID_SIZE",FC_QUOTA_UPLOAD_FAILED:"FC_QUOTA_UPLOAD_FAILED",FC_QUOTA_FAILED_FETCH_FAILED:"FC_QUOTA_FAILED_FETCH_FAILED",FC_QUOTA_FAILED_INVALID_FORECASTCONFIGURATION:"FC_QUOTA_FAILED_INVALID_FORECASTCONFIGURATION",FC_COLUMN_OPTION_HEADER_STAGE2:"FC_COLUMN_OPTION_HEADER_STAGE2",FC_COLUMN_OPTION_SUBHEADER_STAGE2:"FC_COLUMN_OPTION_SUBHEADER_STAGE2",FC_OPTIONSET_PANEL_RIBBON_CHOOSE_SELECTED:"FC_OPTIONSET_PANEL_RIBBON_CHOOSE_SELECTED",FC_CHANGE_OPTIONSET_DIALOG_TITLE:"FC_CHANGE_OPTIONSET_DIALOG_TITLE",FC_CHANGE_OPTIONSET_DIALOG_DESCRIPTION:"FC_CHANGE_OPTIONSET_DIALOG_DESCRIPTION",FC_CHANGE_OPTIONSET_DIALOG_PRIMARY_BUTTON:"FC_CHANGE_OPTIONSET_DIALOG_PRIMARY_BUTTON",FC_AUTOPOPULATE_DIALOG_TITLE:"FC_AUTOPOPULATE_DIALOG_TITLE",FC_AUTOPOPULATE_DIALOG_DESCRIPTION:"FC_AUTOPOPULATE_DIALOG_DESCRIPTION",FC_AUTOPOPULATE_DIALOG_PRIMARY_BUTTON:"FC_AUTOPOPULATE_DIALOG_PRIMARY_BUTTON",FC_AUTOPOPULATE_DIALOG_NO_BUTTON:"FC_AUTOPOPULATE_DIALOG_NO_BUTTON",FC_COLUMN_EDITOR_COLUMN_TYPE_ROLLUP:"FC_COLUMN_EDITOR_COLUMN_TYPE_ROLLUP",FC_COLUMN_EDITOR_COLUMN_TYPE_CALCULATED:"FC_COLUMN_EDITOR_COLUMN_TYPE_CALCULATED",FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA:"FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA",FC_COLUMN_EDITOR_COLUMN_TYPE_PREDICTIVE:"FC_COLUMN_EDITOR_COLUMN_TYPE_PREDICTIVE",FC_COLUMN_EDITOR_COLUMN_TYPE_OWNER:"FC_COLUMN_EDITOR_COLUMN_TYPE_OWNER",FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY:"FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY",FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY:"FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY",FC_COLUMN_EDITOR_NAME_SECTION:"FC_COLUMN_EDITOR_NAME_SECTION",FC_COLUMN_EDITOR_CALCULATION_SECTION:"FC_COLUMN_EDITOR_CALCULATION_SECTION",FC_COLUMN_EDITOR_TYPE_SECTION:"FC_COLUMN_EDITOR_TYPE_SECTION",FC_COLUMN_EDITOR_AMOUNT_FIELD_SECTION:"FC_COLUMN_EDITOR_AMOUNT_FIELD_SECTION",FC_COLUMN_EDITOR_DATE_FIELD_SECTION:"FC_COLUMN_EDITOR_DATE_FIELD_SECTION",FC_COLUMN_EDITOR_SELECTOR_SECTION:"FC_COLUMN_EDITOR_SELECTOR_SECTION",FC_COLUMN_EDITOR_ALLOW_ADJUSTMENTS_SECTION:"FC_COLUMN_EDITOR_ALLOW_ADJUSTMENTS_SECTION",FC_COLUMN_EDITOR_SHOW_PROGRESS_SECTION:"FC_COLUMN_EDITOR_SHOW_PROGRESS_SECTION",FC_COLUMN_EDITOR_UNIQUE_NAME_SECTION:"FC_COLUMN_EDITOR_UNIQUE_NAME_SECTION",FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE:"FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE",FC_COLUMN_EDITOR_IMPROPER_UNIQUE_NAME_MESSAGE:"FC_COLUMN_EDITOR_IMPROPER_UNIQUE_NAME_MESSAGE",FC_COLUMN_EDITOR_NAME_PLACEHOLDER:"FC_COLUMN_EDITOR_NAME_PLACEHOLDER",FC_COLUMN_EDITOR_CALCULATION_PLACEHOLDER:"FC_COLUMN_EDITOR_CALCULATION_PLACEHOLDER",FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER:"FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER",FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER_SECONDARY:"FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER_SECONDARY",FC_COLUMN_EDITOR_TYPE_PLACEHOLDER:"FC_COLUMN_EDITOR_TYPE_PLACEHOLDER",FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER:"FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER",FC_COLUMN_OVERVIEW_PREDECTIVE_FORECASTING:"FC_COLUMN_OVERVIEW_PREDECTIVE_FORECASTING",FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION:"FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION",FC_COLUMN_OVERVIEW_LINK:"FC_COLUMN_OVERVIEW_LINK",FC_COLUMN_OVERVIEW_DELETE_DIALOG_TITLE:"FC_COLUMN_OVERVIEW_DELETE_DIALOG_TITLE",FC_COLUMN_OVERVIEW_DELETE_DIALOG_DESCRIPTION:"FC_COLUMN_OVERVIEW_DELETE_DIALOG_DESCRIPTION",FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE:"FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE",FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE:"FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE",FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP:"FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP",FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN:"FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN",FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN:"FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN",FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET:"FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET",FC_PREVIEW_GRID_HEADING_STAGE2:"FC_PREVIEW_GRID_HEADING_STAGE2",FC_ADDITIONAL_FILTER_HEADING:"FC_ADDITIONAL_FILTER_HEADING",FC_ADDITIONAL_FILTER_SUB_HEADING:"FC_ADDITIONAL_FILTER_SUB_HEADING",FC_OPTIONSET_PANEL_HEADER:"FC_OPTIONSET_PANEL_HEADER",FC_OPTIONSET_PANEL_OPTION_SUBHEADER:"FC_OPTIONSET_PANEL_OPTION_SUBHEADER",FC_COLUMN_OVERVIEW_RIBBON_ADD_FROM_OPTION_SET:"FC_COLUMN_OVERVIEW_RIBBON_ADD_FROM_OPTION_SET",FC_COLUMN_SELECTOR_ROW_TOOLTIP_STATUS:"FC_COLUMN_SELECTOR_ROW_TOOLTIP_STATUS",FC_COLUMN_SELECTOR_ROW_TOOLTIP_LOCK:"FC_COLUMN_SELECTOR_ROW_TOOLTIP_LOCK",FC_COLUMN_SELECTOR_QUOTA_ROW_TOOLTIP:"FC_COLUMN_SELECTOR_QUOTA_ROW_TOOLTIP",FC_COLUMN_EDITOR_DATEFIELD_HELPER:"FC_COLUMN_EDITOR_DATEFIELD_HELPER",FC_COLUMN_EDITOR_OPTIONSET_HELPER:"FC_COLUMN_EDITOR_OPTIONSET_HELPER",FC_COLUMN_EDITOR_AMOUNTFIELD_HELPER:"FC_COLUMN_EDITOR_AMOUNTFIELD_HELPER",FC_COLUMN_EDITOR_TYPEFIELD_HELPER:"FC_COLUMN_EDITOR_TYPEFIELD_HELPER",FC_COLUMN_EDITOR_SELECTORFIELD_HELPER:"FC_COLUMN_EDITOR_SELECTORFIELD_HELPER",FC_CRM_DELETING_CALLS:"FC_CRM_DELETING_CALLS",FC_CRM_PUBLISHING_CALLS:"FC_CRM_PUBLISHING_CALLS",FC_CRM_SAVING_CALLS:"FC_CRM_SAVING_CALLS",FC_CRM_PROCESSING_CALLS:"FC_CRM_PROCESSING_CALLS",FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE",FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE",FC_GRID_PUBLISH_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_PUBLISH_CONTEXTUALBUTTON_GRIDPAGE",FC_EDIT_FIELD_MANDATORY_MESSAGE:"FC_EDIT_FIELD_MANDATORY_MESSAGE",FC_STAGE1_ROLLUP_ENTITY_HELPTEXT:"FC_STAGE1_ROLLUP_ENTITY_HELPTEXT",FC_STAGE1_HIERARCHY_ENTITY_HELPTEXT:"FC_STAGE1_HIERARCHY_ENTITY_HELPTEXT",FD_NOTIFICATION_MESSAGE:"FD_NOTIFICATION_MESSAGE",FORECAST_CONFIG_GENERIC_PUBLISH_FAILURE:"FORECAST_CONFIG_GENERIC_PUBLISH_FAILURE",FORECAST_CONFIG_GENERIC_DELETE_FAILURE:"FORECAST_CONFIG_GENERIC_DELETE_FAILURE",FORECAST_CONFIG_GENERIC_UPDATE_FAILURE:"FORECAST_CONFIG_GENERIC_UPDATE_FAILURE",FORECAST_CONFIG_GENERIC_RETREIVE_HIERARCHY_FAILURE:"FORECAST_CONFIG_GENERIC_RETREIVE_HIERARCHY_FAILURE",FORECAST_CONFIG_GENERIC_RETREIVE_METADATA_FAILURE:"FORECAST_CONFIG_GENERIC_RETREIVE_METADATA_FAILURE",FORECAST_CONFIG_GENERIC_RETREIVE_ORGANIZATION_INFO_FAILURE:"FORECAST_CONFIG_GENERIC_RETREIVE_ORGANIZATION_INFO_FAILURE",FC_GRID_DEACTIVATE_CONTEXTUALBUTTON_GRIDPAGE:"FC_GRID_DEACTIVATE_CONTEXTUALBUTTON_GRIDPAGE",FC_WARNING_FD_REMOVED_FC_ADDED:"FC_WARNING_FD_REMOVED_FC_ADDED",FC_WARNING_READ_MORE:"FC_WARNING_READ_MORE",FC_DELETE_FAILURE_TITLE:"FC_DELETE_FAILURE_TITLE",FC_PUBLISH_FAILED_MORE_THAN_SIX:"FC_PUBLISH_FAILED_MORE_THAN_SIX",FC_PUBLISH_FAILURE_TITLE:"FC_PUBLISH_FAILURE_TITLE",FC_CREATE_FAILURE_TITLE:"FC_CREATE_FAILURE_TITLE",FC_UPDATE_FAILURE_TITLE:"FC_UPDATE_FAILURE_TITLE",FC_FETCHING_ORG_FAILURE_TITLE:"FC_FETCHING_ORG_FAILURE_TITLE",FC_ERROR_SOMETHING_WENT_WRONG_TITLE:"FC_ERROR_SOMETHING_WENT_WRONG_TITLE",FC_ERROR_DELETE_COLUMN_HEADER:"FC_ERROR_DELETE_COLUMN_HEADER",FC_ERROR_DELETE_COLUMN_DEPENDENTLIST:"FC_ERROR_DELETE_COLUMN_DEPENDENTLIST",FC_FETCHING_FAILURE_TITLE:"FC_FETCHING_FAILURE_TITLE",FC_ERROR_TRY_AGAIN_DESC:"FC_ERROR_TRY_AGAIN_DESC",FC_HIERARCHY_FAILURE_DESC:"FC_HIERARCHY_FAILURE_DESC",FC_ORG_DETAILS_DESC:"FC_ORG_DETAILS_DESC",FC_FETCHING_FAILURE_DESC:"FC_FETCHING_FAILURE_DESC",FC_OK:"FC_OK",FC_TEMPLATE_TYPE_ORG_CHART:"FC_TEMPLATE_TYPE_ORG_CHART",FC_Title:"FC_Title",FC_Date:"FC_Date",FC_Number:"FC_Number",FC_Increase:"FC_Increase",FC_Decrease:"FC_Decrease",FC_TEMPLATE_TYPE_TERRITORY_BASED:"FC_TEMPLATE_TYPE_TERRITORY_BASED",FC_TERRITORY_ENTITY_DISPLAYNAME:"FC_TERRITORY_ENTITY_DISPLAYNAME",FC_FORM_LOAD_ERROR_INVALID_TEMPLATE_TYPE:"FC_FORM_LOAD_ERROR_INVALID_TEMPLATE_TYPE",FC_FORM_LOAD_ERROR_MISSING_TEMPLATE_TYPE:"FC_FORM_LOAD_ERROR_MISSING_TEMPLATE_TYPE",FC_FORM_LOAD_ERROR_MISSING_FCID:"FC_FORM_LOAD_ERROR_MISSING_FCID",FC_HIERARCHY_ROUTE_TWO_LEVELS:"FC_HIERARCHY_ROUTE_TWO_LEVELS",FC_HIERARCHY_ROUTE_THREE_LEVELS:"FC_HIERARCHY_ROUTE_THREE_LEVELS",FC_HIERARCHY_ROUTE_FIELD_LABEL:"FC_HIERARCHY_ROUTE_FIELD_LABEL",FC_PERMISSIONS_ATTRIBUTE_NONE:"FC_PERMISSIONS_ATTRIBUTE_NONE",FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_TITLE:"FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_TITLE",FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_SUBTITLE:"FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_SUBTITLE",FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL:"FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL",FC_PERMISSIONS_STAGE_HIERARCHY_ATTRIBUTE_FIELD_LABEL:"FC_PERMISSIONS_STAGE_HIERARCHY_ATTRIBUTE_FIELD_LABEL",FC_HIERARCHY_REL_NOT_PRESENT_MESSAGE:"FC_HIERARCHY_REL_NOT_PRESENT_MESSAGE",FC_HIERARCHY_REL_NOT_PRESENT_DIALOG_HEADER:"FC_HIERARCHY_REL_NOT_PRESENT_DIALOG_HEADER",FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_HEADER:"FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_HEADER",FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_SUBITITLE:"FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_SUBITITLE",FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_NONE:"FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_NONE",FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_ALLOWALL:"FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_ALLOWALL",FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_SPECIFIC_ROLES:"FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_SPECIFIC_ROLES",FC_PERMISSIONS_STAGE_ROLE_PICKER_PLACEHOLDER:"FC_PERMISSIONS_STAGE_ROLE_PICKER_PLACEHOLDER",FC_PERMISSIONS_STAGE_ROLE_PICKER_NO_DATA:"FC_PERMISSIONS_STAGE_ROLE_PICKER_NO_DATA",FC_PERMISSIONS_STAGE_ROLE_PICKER_ITEM_REMOVE_BUTTON_TOOLTIP:"FC_PERMISSIONS_STAGE_ROLE_PICKER_ITEM_REMOVE_BUTTON_TOOLTIP",FC_PERMISSIONS_MESSAGE_USER_ONLY:"FC_PERMISSIONS_MESSAGE_USER_ONLY",FC_PERMISSIONS_MESSAGE_ROLE_ONLY:"FC_PERMISSIONS_MESSAGE_ROLE_ONLY",FC_PERMISSIONS_MESSAGE_ALLOW_ALL_ONLY:"FC_PERMISSIONS_MESSAGE_ALLOW_ALL_ONLY",FC_PERMISSIONS_MESSAGE_USER_AND_ROLE:"FC_PERMISSIONS_MESSAGE_USER_AND_ROLE",FC_PERMISSIONS_MESSAGE_USER_AND_ALLOW_ALL:"FC_PERMISSIONS_MESSAGE_USER_AND_ALLOW_ALL",FC_PERMISSIONS_MANDATORY_ERROR_MESSAGE:"FC_PERMISSIONS_MANDATORY_ERROR_MESSAGE"}},1258:function(e,t,n){var r=n(1259);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1259:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".ms-BasePicker-text {\n  border-width: thin !important;\n  width: 412px; }\n\n.ms-Suggestions-container,\n.ms-Persona-primaryText {\n  width: 370px !important; }\n\n.ms-TooltipHost {\n  display: hidden !important; }\n",""])},1260:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(53),l=n(25);s.initializeIcons();var c=function(e){function t(t){var n=e.call(this,t)||this;return n._onChange=function(e,t){n.props.onChange(t.key)},n.state={options:[]},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.crmDataAcces.organizationDataAccess.getOrgEntities().then((function(t){var n=t.map((function(e){return{key:e.LogicalName,text:e.DisplayName.UserLocalizedLabel&&e.DisplayName.UserLocalizedLabel.Label}}));e.setState({options:n})}))},t.prototype.render=function(){var e=this,t=this.getDropDownOptions(),n=this.getDropDownStyles();return a.default.createElement("div",{className:"CrmEntityPickerControl"},a.default.createElement(l.Dropdown,{label:this.props.label,onChange:this._onChange.bind(this),selectedKey:this.props.value?this.props.value:void 0,options:t,disabled:this.props.isDisabled,styles:n,onRenderPlaceHolder:function(){var t=a.default.createElement("div",{style:{marginTop:5}},a.default.createElement(l.Spinner,null));return e.state.options.length>0&&(t=""),t}}))},t.prototype.getDropDownStyles=function(){return{dropdown:{width:412}}},t.prototype.getDropDownOptions=function(){return this.state.options.sort((function(e,t){return e.text.localeCompare(t.text)}))},t}(a.default.Component);t.default=c},1261:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(53),l=n(25),c=n(11),u=n(12);s.initializeIcons();var d=function(e){function t(t){var n=e.call(this,t)||this;return n._onChange=function(e,t){t&&parseInt(e)<n.props.maxValue&&n.props.onChange(parseInt(e)+1),!t&&parseInt(e)>n.props.minValue&&n.props.onChange(parseInt(e)-1)},n._handleBlur=function(e){var t=parseInt(e);isNaN(t)?t=n.props.minValue:t<n.props.minValue?t=n.props.minValue:t>n.props.maxValue&&(t=n.props.maxValue),n.props.onChange(t)},n.state={},n}return o(t,e),t.prototype.render=function(){var e=this;return a.default.createElement("div",{className:"CrmNumberPickerControl"},a.default.createElement(l.SpinButton,{label:this.props.label,labelPosition:0,value:""+this.props.value,min:this.props.minValue,max:this.props.maxValue,step:1,disabled:this.props.isDisabled,ariaLabel:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Number),incrementButtonAriaLabel:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Increase),decrementButtonAriaLabel:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Decrease),onIncrement:function(t){e._onChange(t,!0)},onDecrement:function(t){e._onChange(t,!1)},onBlur:function(t){e._handleBlur(t.target.value)},styles:{spinButtonWrapper:{borderWidth:"thin"}}}))},t}(a.default.Component);t.default=d},1262:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(53),l=n(25),c=n(11),u=n(12);s.initializeIcons();var d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:"CrmDatePickerControl"},a.default.createElement(l.DatePicker,{label:this.props.label,value:new Date(this.props.value),placeholder:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Date),ariaLabel:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_Date),disabled:this.props.isDisabled}))},t}(a.default.Component);t.default=d},1263:function(e,t,n){var r=n(1264);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1264:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".schedulingWrapper {\n  margin-top: 24px;\n  display: grid;\n  grid-template-columns: 198px 198px auto;\n  grid-template-rows: 60px 60px 60px;\n  grid-column-gap: 16px;\n  grid-row-gap: 24px;\n  margin-top: 23px; }\n\n.periodSelector {\n  grid-column-start: 1;\n  grid-row-start: 1; }\n\n.yearSelector {\n  grid-column-start: 2;\n  grid-row-start: 1; }\n\n.startAt {\n  grid-column-start: 1;\n  grid-row-start: 2; }\n\n.numRec {\n  grid-column-start: 2;\n  grid-row-start: 2; }\n\n.validFrom {\n  grid-column-start: 1;\n  grid-row-start: 3; }\n\n.validTo {\n  grid-column-start: 2;\n  grid-row-start: 3; }\n\n.formSectionDivider {\n  width: 100%;\n  /* height: 1px; */\n  height: 0;\n  border-bottom: thin solid #E1DFDD;\n  /* Neutral/Grey 40 */\n  /* background: #E1DFDD; */ }\n\n.configurationWrapper {\n  margin-top: 24px;\n  display: grid;\n  grid-template-columns: 412px 24px auto;\n  grid-template-rows: auto;\n  grid-column-gap: 0px;\n  grid-row-gap: 24px;\n  margin-top: 23px; }\n\n.configurationSecEntitySelection {\n  grid-column-start: 1;\n  grid-row-start: 1; }\n\n.verticalDivider {\n  width: 0;\n  border-right: thin solid #E1DFDD;\n  height: 100%;\n  grid-column: 2; }\n\n.hierarchyPreviewSection {\n  width: 100%;\n  height: 100%;\n  grid-column: 3;\n  min-width: 412px;\n  margin-right: 32px;\n  display: flex;\n  flex-direction: column; }\n\n.hierarchyPreview {\n  border: thin solid #E1DFDD;\n  width: 100%;\n  height: 100%;\n  margin-top: 4px; }\n\n.hierarchyPreviewTitle {\n  font-size: 14px;\n  line-height: 20px;\n  font-family: 'Segoe UI';\n  color: #323130;\n  font-weight: 600; }\n\n.sectionSubtitle {\n  color: #605E5C;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  font-family: 'Segoe UI';\n  margin-top: 8px; }\n\n.sectionHeader {\n  font-family: Segoe UI;\n  font-size: 18px;\n  line-height: 24px;\n  color: #323130;\n  font-weight: 600; }\n",""])},1265:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(26),l=n(409),c=n(25),u=n(101);n(1272);var d=n(45),p=n(12),_=n(11),f=n(110),E=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.render=function(){if(d.ForecastingBusinessLogicProvider.FieldHasNonNullValue("",this.props.hierarchyEntity)&&d.ForecastingBusinessLogicProvider.FieldHasNonNullValue("",this.props.topOfHierarchy)){if(this.props.isFetchingHierarchy)return a.default.createElement("div",{className:"hierarchyPreviewMessageWrapper"},a.default.createElement(c.Spinner,{label:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1),size:u.SpinnerSize.large}));var e=new l.DelfiGridProvider,t=e.getDelfiActions(),n=function(e,t){for(var n=[],r=0;r<e.length;r++){var o={id:e[r].id,parentId:0==r?void 0:e[r].parentId,getDisplayFormattedValue:{},getEditValue:{},getIconUrl:{},getIconTooltip:{},getProgress:{},getStrikeValue:{},getUrlArgs:{},mayHaveChildren:e[r].hasChildren};o.getDisplayFormattedValue.hierarchyColumn=e[r].displayName,n.push(o)}return{rows:n,columns:[{id:"hierarchyColumn",header:t,dataType:1,width:150,isEditable:!1,ishierarchial:!0}],labels:{ariaLabelForGrid:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_HIERARCHY_GRID_LABEL)}}}(this.props.hierarchyData,this.props.previewHeaderText);if(t.updateGridInput(n),n.rows.length>0){var r=n.rows[0];t.expandRow(r.id,!0)}return a.default.createElement("div",{className:"hierarchyPreviewGrid",style:{height:"100%"}},e.render())}return a.default.createElement("div",{className:"hierarchyPreviewMessageWrapper"},a.default.createElement("p",{className:"selectEntityPreviewMessage"},_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_PREVIEW_HIERARCHY_SELECT_ENTITY_STAGE1)))},t}(a.default.Component);t.HierarchyPreview=E;t.ConnectedHierarchyPreview=s.connect((function(e){return{hierarchyEntity:e.FormFieldData.hierarchyEntity,topOfHierarchy:e.FormFieldData.topOfHierarchy,isFetchingHierarchy:e.isFetchingHierarchyData,hierarchyData:e.ForecastHierarchyList,previewHeaderText:f.getHierarchyEntityDisplayName(e)}}))(E)},1272:function(e,t,n){var r=n(1273);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1273:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".hierarchyPreviewMessageWrapper {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center; }\n\n.selectEntityPreviewMessage {\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C; }\n\n.generatingPreviewMessage {\n  font-family: 'Segoe UI';\n  font-size: 12px;\n  line-height: 16px;\n  height: 16px;\n  color: #0078D4; }\n\n.hierarchyPreviewGrid {\n  padding-left: 16px; }\n  .hierarchyPreviewGrid .ms-List-page {\n    border-bottom: none !important; }\n    .hierarchyPreviewGrid .ms-List-page .ms-List-cell {\n      background: white !important;\n      height: 42px !important; }\n    .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow-cellCheck {\n      align-items: center !important;\n      display: flex !important; }\n    .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow {\n      border-bottom: thin solid #E1DFDD !important;\n      min-height: 42px !important; }\n      .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell {\n        border-left: none !important;\n        height: 42px !important;\n        padding-bottom: 0px !important; }\n        .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectedCell {\n          border-color: transparent !important; }\n        .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .delfiIcon {\n          margin-right: 9px; }\n        .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .readOnlyCell {\n          height: 12px;\n          width: 48px;\n          background: #E1DFDD;\n          margin-top: -2px;\n          text-align: start; }\n        .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .hierarchy-cell {\n          margin-left: -50px; }\n          .hierarchyPreviewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .hierarchy-cell .readOnlyCell {\n            height: auto;\n            width: auto;\n            background: none !important; }\n  .hierarchyPreviewGrid .ms-DetailsHeader {\n    border: 0px !important;\n    border-bottom: thin solid #E1DFDD !important;\n    border-top: none !important;\n    height: auto !important; }\n    .hierarchyPreviewGrid .ms-DetailsHeader .ms-DetailsHeader-cell {\n      border-left: none !important;\n      padding: 0px !important;\n      text-align: left !important;\n      font-size: 14px !important;\n      height: 30px !important;\n      font-weight: 600 !important; }\n      .hierarchyPreviewGrid .ms-DetailsHeader .ms-DetailsHeader-cell:hover {\n        background-color: none; }\n      .hierarchyPreviewGrid .ms-DetailsHeader .ms-DetailsHeader-cell .ms-DetailsHeader-cellTitle {\n        text-align: left !important;\n        margin-top: 0px !important;\n        display: block;\n        color: #323130 !important;\n        letter-spacing: 0.02em;\n        text-overflow: ellipsis;\n        line-height: 20px !important; }\n  .hierarchyPreviewGrid .activeColumn {\n    background: #F3F2F1; }\n  .hierarchyPreviewGrid .delfiGridContainer {\n    height: 100% !important; }\n",""])},1274:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0));n(1275);var s=n(25),l=n(53),c=n(355),u=n(45),d=n(11),p=n(12),_=n(107);l.initializeIcons();var f=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=function(e,t){null!=t&&n.props.onChange(_.sanitizeNameString(t))},n.state={},n}return o(t,e),t.prototype.render=function(){var e=void 0;this.props.showEmptyWarning&&(e=a.default.createElement("p",{style:{display:"inline",color:"rgb(164, 38, 44)"}},d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_FIELD_MANDATORY_MESSAGE)));var t="/webresources/Forecasting/Images/msdyn_ForecastInstanceEntityIcon.svg";this.props.orgUrl&&(t=""+this.props.orgUrl+t);var n=""==this.props.title?" ":"",r=d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_FORECAST_TITLE_EDITPAGE);return a.default.createElement("div",{className:"titleHeader"},a.default.createElement("div",{className:"titleWithInput"},a.default.createElement(s.TextField,{autoFocus:!0,ariaLabel:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_Title),"aria-required":"true","aria-invalid":"false",styles:{field:{fontSize:16},fieldGroup:{},subComponentStyles:{label:{root:{fontSize:12,marginLeft:8}}}},value:this.props.title,disabled:this.props.isDisabled,onChange:this.onChange.bind(this),errorMessage:n,placeholder:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE)}),e),a.default.createElement("div",{className:"forecastConfigurationLabeldiv"},a.default.createElement("span",null,r)))},t}(a.default.Component);t.default=f,t.TitleEditorFormWarpper=function(e){var t=e.formState.showEmptyWarnings&&!u.ForecastingBusinessLogicProvider.FieldHasNonNullValue("name",e.formData.name);return a.default.createElement(f,{orgUrl:e.orgUrl,title:""+e.formData.name,isDisabled:!e.arePostPublishUpdatableFieldsUpdatable,onChange:function(t){e.formEventsHandler.OnValueChange({name:t})},showEmptyWarning:t})},t.ConnectedTitleEditor=c.ConnectedFormGenerator(t.TitleEditorFormWarpper)},1275:function(e,t,n){var r=n(1276);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1276:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".titleHeader {\n  display: flex;\n  flex-direction: column; }\n\n.imageClass {\n  width: 56px;\n  height: 56px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: #EDEBE9;\n  border-radius: 50%; }\n\n.titleWithInput {\n  font-family: Segoe UI;\n  font-size: 12px;\n  line-height: 16px;\n  width: 341px;\n  height: 32px; }\n\n.ms-Label::after {\n  color: #333333 !important; }\n\n.forecastConfigurationLabeldiv {\n  margin-top: 11px;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 600; }\n",""])},1277:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0));n(1278);var s=n(25),l=n(53),c=n(457),u=n(26),d=n(242),p=n(227);l.initializeIcons();var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderStepperDiv=function(){var e=a.createElement(s.Icon,{iconName:"Accept",className:"ms-IconExample"}),n=0,r=[];return t.props.delphiStepItems.forEach((function(o){if(n++,o.state!=c.IDelphiState.Disabled)var i=a.createElement("div",{className:"delphiStepperStepCircleLabel",onClick:function(){t.onStepClick(o)}},a.createElement("div",{tabIndex:0,title:o.description},a.createElement("div",{className:"delphiStepper"+c.IDelphiState[o.state]},t.getStepCicleContents(o,e))),a.createElement("div",{style:{width:"120px",textAlign:"center"},className:"delphiStepperLabel"+c.IDelphiState[o.state]},o.description));else i=a.createElement("div",{className:"delphiStepperStepCircleLabel",onClick:function(){t.onStepClick(o)}},a.createElement("div",{className:"delphiStepper"+c.IDelphiState[o.state]},t.getStepCicleContents(o,e)),a.createElement("div",{style:{width:"120px",textAlign:"center"},className:"delphiStepperLabel"+c.IDelphiState[o.state]},o.description));if(r.push(i),!t.lastStageStepperControl(n)){var s=a.createElement("div",{className:"delphiStepperlineDiv"});r.push(s)}})),a.createElement("div",{className:"delphiStepperListContainer"},r)},t}return o(t,e),t.prototype.onStepClick=function(e){e.state!=c.IDelphiState.Disabled&&this.props.onStepClick(e.stepId)},t.prototype.render=function(){return this.renderStepperDiv()},t.prototype.getStepCicleContents=function(e,t){return e.state==c.IDelphiState.Completed||e.state==c.IDelphiState.CurrentCompleted?t:e.title},t.prototype.lastStageStepperControl=function(e){return e==this.props.delphiStepItems.length},t}(a.Component);t.DelphiStepperControl=_,t.default=_,t.ConnectedDelphiStepperControl=u.connect((function(e){return{delphiStepItems:p.getStageStateProps(e)}}),(function(e){return{onStepClick:function(t){return e(d.onStepClickActionCreator(t))}}}))(_)},1278:function(e,t,n){var r=n(1279);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1279:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".delphiStepperListContainer {\n  display: flex;\n  flex-direction: row;\n  align-items: start;\n  margin-left: 10px;\n  margin-right: 10px;\n  min-width: 412px; }\n\n.delphiStepperLabelDisabled {\n  color: #696969; }\n\n.delphiStepperLabelCurrent {\n  font-family: Segoe UI semibold; }\n\n.delphiStepperLabelCurrentCompleted {\n  font-family: Segoe UI semibold; }\n\n.delphiStepperStepCircleLabel {\n  width: 2rem;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  overflow: visible; }\n\n.delphiStepperCurrent {\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #0742AB;\n  border: 1px solid #0742AB;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white; }\n\n.delphiStepperCurrent:hover {\n  background: #0B53CE;\n  cursor: pointer; }\n\n.delphiStepperCompleted {\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #2266E3;\n  border: 1px solid #2266E3;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white; }\n\n.delphiStepperCompleted:hover {\n  background: #0B53CE;\n  cursor: pointer; }\n\n.delphiStepperCurrentCompleted {\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #0742AB;\n  border: 1px solid #0742AB;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: white; }\n\n.delphiStepperCurrentCompleted:hover {\n  background: #0B53CE;\n  cursor: pointer; }\n\n.delphiStepperDisabled {\n  pointer-events: none;\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #FFFFFF;\n  border: 1px solid #E1DFDD;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #A19F9D; }\n\n.delphiStepperEnabled {\n  width: 2em;\n  height: 2em;\n  border-radius: 1em;\n  background: #FFFFFF;\n  border: 1px solid #A19F9D;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #323130; }\n\n.delphiStepperEnabled:hover {\n  cursor: pointer;\n  background: #F3F2F1; }\n\n.delphiStepperlineDiv {\n  width: 86px;\n  height: 3px;\n  margin-top: 1rem;\n  margin-left: 1px;\n  margin-right: 1px;\n  border: 1px solid transparent;\n  background: #A19F9D; }\n\n@media screen and (-ms-high-contrast: active) {\n  .delphiStepperlineDiv {\n    border: 1px solid transparent; } }\n",""])},1280:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(83),l=n(329);n(1281);var c=n(26),u=n(227),d=n(242),p=n(64),_=n(108),f=n(11),E=n(12),m=function(e){function t(t){var n=e.call(this,t)||this;return n.renderButtonDiv=function(){var e,t,r;if(n.props.backButtonState==l.IStepperButtonState.Hide)return e=n.props.nextButtonState==l.IStepperButtonState.Disabled,t=!0,r=!0,a.default.createElement("div",{className:"stepperButtonDiv"},n.getStepperNextButton(e,f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE)));var o;return e=n.props.nextButtonState==l.IStepperButtonState.Disabled,t=n.props.backButtonState==l.IStepperButtonState.Disabled,r=!1,o=n.props.currentActiveStage==_.ForecastConfigStage.Quota?f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_FINISH_EDITPAGE):f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE),a.default.createElement("div",{className:"stepperButtonDiv"},n.getStepperPrevButton(t,r),n.getStepperNextButton(e,o))},n.state={hideDialog:!0},n}return o(t,e),t.prototype.render=function(){return this.renderButtonDiv()},t.prototype.getStepperPrevButton=function(e,t){return a.default.createElement("div",{className:"buttonDiv"},a.default.createElement(s.DefaultButton,{text:f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_BACK_EDITPAGE),disabled:e,hidden:t,onClick:this.onBack.bind(this)}))},t.prototype.getStepperNextButton=function(e,t){return a.default.createElement("div",{className:"buttonDiv"},a.default.createElement(s.PrimaryButton,{styles:{root:{backgroundColor:"#2266E3",color:"#ffffff",borderRadius:"2px"},rootHovered:{backgroundColor:"#0B53CE"}},text:t,disabled:e,onClick:this.onNext.bind(this)}))},t.prototype.onBack=function(){this.props.clickButton(l.IStepperButton.BACK)},t.prototype.onNext=function(){this.props.clickButton(l.IStepperButton.NEXT)},t}(a.default.Component);t.DelphiStepperButton=m,t.default=m,t.ConnectedDelphiStepperButton=c.connect((function(e){return{backButtonState:u.getBackButtonState(e),nextButtonState:u.getNextButtonState(e),currentActiveStage:e.stepperActiveStage,isFormLocked:p.GetIsFormLocked_FromState(e)}}),(function(e){return{clickButton:function(t){return e(d.onButtonClickActionCreator(t))}}}))(m)},1281:function(e,t,n){var r=n(1282);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1282:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".stepperButtonDiv {\n  flex-flow: row;\n  display: flex;\n  flex-direction: row; }\n  .stepperButtonDiv button {\n    border-width: 0; }\n\n.buttonDiv {\n  margin-left: 4px;\n  margin-right: 4px; }\n",""])},1283:function(e,t,n){var r=n(1284);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1284:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".stepperContainer {\n  flex-direction: row;\n  display: flex;\n  justify-content: space-between;\n  padding-top: 24px;\n  padding-left: 24px;\n  padding-right: 24px; }\n\n.editPageApp {\n  display: flex;\n  height: 100%;\n  flex-direction: column;\n  overflow: hidden;\n  flex: 1 1 auto; }\n\n.stepperButtonFooterStyle {\n  margin-left: 20px;\n  margin-right: 20px;\n  margin-top: 40px; }\n\n.stageAndFooterContainer {\n  overflow: auto;\n  margin-bottom: 24px; }\n\n.stageContainer {\n  padding-top: 24px;\n  padding-left: 24px;\n  padding-right: 24px; }\n\n.MainAppContainer {\n  height: 100%; }\n\n.DelfiConfigApp {\n  height: 100%; }\n\n.titleContainer {\n  margin-top: 16px;\n  padding-left: 24px;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between; }\n\n.sectionDividerShadow {\n  width: 100%;\n  /* height: 1px; */\n  height: 0;\n  border-bottom: thin solid #FFFFFF;\n  box-shadow: 0px 0.3px 0.9px rgba(0, 0, 0, 0.108), 0px 1.6px 3.6px rgba(0, 0, 0, 0.132); }\n\n.stageHeaderTitle {\n  font-weight: 600;\n  font-size: 18px;\n  color: #323130; }\n",""])},1285:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(26),l=n(109),c=n(1286);n(1290);var u=n(1292),d=n(1297),p=n(1301),_=n(677),f=n(1305),E=n(679),m=n(680),S=n(11),g=n(12),C=n(352),I=n(1309),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editModeTriggeredAtleastOnce=!1,t}return o(t,e),t.prototype.renderExpressionBuilderFilterPanel=function(){var e=this.renderExpressionBuilderFilter();return a.createElement("div",{className:"filterControlPane"},a.createElement("span",{className:"addFilterTitle"},S.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_ADDITIONAL_FILTER_HEADING)),a.createElement("span",{className:"addFilterSubTitle"},S.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_ADDITIONAL_FILTER_SUB_HEADING)),e)},t.prototype.renderExpressionBuilderFilter=function(){return a.createElement("div",{className:"expressionBuilderControlClass"},a.createElement(I.ConnectedExpressionBuilderFilter,{crmDataAccess:this.props.crmDataAccess}))},t.prototype.renderLeftPanel=function(){var e=this.renderEditorPanel(),t=this.renderColumnsOverviewPanel(),n="";C.XrmHelper.isUserLanguageRTL()&&(n="_rtl");var r="overviewOn"+n;return this.editModeTriggeredAtleastOnce||(r=""),(this.props.isInEditMode||this.props.isOptionSetEditorOpen)&&(this.editModeTriggeredAtleastOnce=!0,r="editorOn"+n),a.createElement("div",{key:""+this.props.isInEditMode,style:{display:"flex",height:"100%"},className:r},a.createElement("div",{style:{flexShrink:0,width:"100%"}},t),a.createElement("div",{style:{flexShrink:0,width:"100%",height:"100%"}},e))},t.prototype.renderColumnsOverviewPanel=function(){return a.createElement("div",{style:{display:"flex",flexDirection:"column",width:"100%",height:"100%"}},a.createElement(m.ConnectedColumnOverviewRibbon,null),a.createElement(u.ConnectedColumnsOverview,null))},t.prototype.renderPreviewGrid=function(){return a.createElement("div",{className:"previewGrid",style:{paddingTop:10}},a.createElement("span",{className:"previewGridTitle"},S.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_PREVIEW_GRID_HEADING_STAGE2)),a.createElement(d.ConnectedPreviewGrid,null))},t.prototype.renderStageHeader=function(){return a.createElement("div",{className:"header_stage2"},a.createElement("span",{className:"stageHeaderTitle"},S.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_COLUMN_OPTION_HEADER_STAGE2)),a.createElement("br",null),a.createElement("p",{className:"colOptionDesc"},S.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.FC_COLUMN_OPTION_SUBHEADER_STAGE2)))},t.prototype.renderEditorPanel=function(){return this.props.isOptionSetEditorOpen?this.renderOptionSetSelectorPanel():this.renderColumnEditorPanel()},t.prototype.renderOptionSetSelectorPanel=function(){return a.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},a.createElement(_.ConnectedOptionSetSelectorRibbon,null),a.createElement(p.ConnectedOptionSetSelectorChoiceList,{crmDataAccess:this.props.crmDataAccess}),a.createElement(f.ConnectedChangeConfirmationDialog,null))},t.prototype.renderColumnEditorPanel=function(){return a.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},a.createElement(E.ConnectedColumnEditorRibbon,null),a.createElement(c.ConnectedColumnEditorForm,{crmDataAccess:this.props.crmDataAccess}))},t.prototype.render=function(){return a.createElement("div",{className:"stage2Form"},this.renderStageHeader(),a.createElement("div",{className:"mainPanelContainer_stage2"},a.createElement("div",{className:"leftPanel_stage2"},this.renderLeftPanel()),a.createElement("div",{className:"verticleDivider"}),this.renderPreviewGrid()),a.createElement("div",{className:"addtionalFilters"},this.renderExpressionBuilderFilterPanel()))},t}(a.Component);t.Stage2Form=h;t.ConnectedStage2Form=s.connect((function(e,t){return{isInEditMode:l.GetIsColumnEditorOpened_FromState(e),isOptionSetEditorOpen:l.GetIsOptionSetEditorOpened_FromState(e)}}),(function(e,t){return{}}))(h)},1286:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(0)),c=n(26),u=n(17),d=n(109),p=n(25),_=n(99),f=s(n(675)),E=s(n(674)),m=s(n(356));n(1287);var S=n(64),g=n(676),C=n(45),I=n(11),h=n(12),T=n(107),y=n(1289),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.renderTypePicker=function(){var e=this,t=this.props.forecastColumnInfo.columnType,n=C.ForecastingBusinessLogicProvider.GetColumnTypeOptionsBasedOnCurrentType(t),r=C.ForecastingBusinessLogicProvider.GetIsColumnTypeControlDisabledBasedOnCurrentType(t),o=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_TYPE_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement(m.default,{helperText:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_TYPEFIELD_HELPER),labelText:o},l.createElement(p.Dropdown,{label:o,disabled:this.props.isFormLocked||r,selectedKey:t,onChange:function(t,n){n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"columnType",n.key)},placeholder:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_TYPE_PLACEHOLDER),options:n})))},t.prototype.renderNameControl=function(){var e=this,t=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_NAME_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement(m.default,{labelText:t},l.createElement("div",{tabIndex:0},l.createElement(p.TextField,{value:this.props.forecastColumnInfo.title,label:t,disabled:!this.props.arePostPublishUpdatableFieldsUpdatable,placeholder:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_NAME_PLACEHOLDER),ariaLabel:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_NAME_PLACEHOLDER),onChange:function(t,n){void 0!==n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"title",T.sanitizeNameString(n))}}))))},t.prototype.renderUniqueNameControl=function(){var e=this,t=this.props.forecastColumnInfo.uniqueName,n=this.props.isUniqueNameDuplicate,r=this.props.isUniqueNameProper,o=void 0;n?o=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE):r||(o=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_IMPROPER_UNIQUE_NAME_MESSAGE));var i=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement("div",{style:{marginTop:24,marginBottom:16},className:"formSectionDivider"}),l.createElement(m.default,{labelText:i},l.createElement(p.TextField,{value:t,styles:{fieldGroup:{borderWidth:"thin"}},label:i,disabled:this.props.isUniqueNameDisabled,placeholder:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER),ariaLabel:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER),onChange:function(t,n){void 0!==n&&e.props.onUniqueNameChange(e.props.forecastColumnInfo.id,n)},errorMessage:o})))},t.prototype.renderAllowAdjustmentControl=function(){var e=this,t=this.props.forecastColumnInfo.isManuallyAdjustable;return l.createElement("div",{className:"columnEditorField"},l.createElement(p.Checkbox,{label:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_ALLOW_ADJUSTMENTS_SECTION),checked:t,disabled:this.props.isFormLocked,onChange:function(t,n){null!=n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"isManuallyAdjustable",n)}}))},t.prototype.renderShowProgressControl=function(){var e=this,t=this.props.forecastColumnInfo.showProgressComparedToQuota;return l.createElement("div",{className:"columnEditorField"},l.createElement(p.Checkbox,{label:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_SHOW_PROGRESS_SECTION),checked:t,disabled:this.props.isFormLocked,onChange:function(t,n){null!=n&&e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"showProgressComparedToQuota",n)}}))},t.prototype.renderAmountField=function(){var e=this,t=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_AMOUNT_FIELD_SECTION),n={id:"",attributeInfo:{id:"",name:"amountAttribute",entityName:this.props.forecastConfigInfo.rollupEntity,type:_.ICrmAttributeType.AmountField},onChange:function(t){e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"amountField",t)},value:this.props.forecastColumnInfo.amountField,crmDataAcces:this.props.crmDataAccess,isDisabled:this.props.isFormLocked,label:t};return l.createElement("div",{className:"columnEditorField"},l.createElement(m.default,{helperText:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_AMOUNTFIELD_HELPER),labelText:t},l.createElement(f.default,i({},n))))},t.prototype.renderDateField=function(){var e=this,t=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_DATE_FIELD_SECTION),n={id:"",attributeInfo:{id:"",name:"dateAttribute",entityName:this.props.forecastConfigInfo.rollupEntity,type:_.ICrmAttributeType.DateField},onChange:function(t){e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"dateField",t)},value:this.props.forecastColumnInfo.dateField,crmDataAcces:this.props.crmDataAccess,isDisabled:this.props.isFormLocked,label:t};return l.createElement("div",{className:"columnEditorField"},l.createElement(m.default,{helperText:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_DATEFIELD_HELPER),labelText:t},l.createElement(f.default,i({},n))))},t.prototype.renderSelectorField=function(){var e=this,t=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_SELECTOR_SECTION),n={id:"",attributeInfo:{id:"",name:this.props.forecastConfigInfo.forecastCategoryAttributeName,entityName:this.props.forecastConfigInfo.rollupEntity,type:_.ICrmAttributeType.OptionSet},onChange:function(t){e.props.updateColumnFieldValue(e.props.forecastColumnInfo.id,"optionSetValue",parseInt(t))},value:""+this.props.forecastColumnInfo.optionSetValue,crmDataAcces:this.props.crmDataAccess,label:t,isDisabled:this.props.isFormLocked};return l.createElement("div",{className:"columnEditorField"},l.createElement(m.default,{helperText:I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_SELECTORFIELD_HELPER),labelText:t},l.createElement(E.default,i({},n))))},t.prototype.renderCalculationField=function(){var e=I.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SECTION);return l.createElement("div",{className:"columnEditorField"},l.createElement(m.default,{labelText:e},l.createElement(y.ConnectedCalculatedColumnWithSuggestion,null)))},t.prototype.render=function(){var e=void 0,t=void 0;return this.props.forecastColumnInfo.columnType==u.ForecastColumnType.Rollup?e=l.createElement("div",null,this.renderAmountField(),this.renderDateField(),this.renderSelectorField(),this.renderAllowAdjustmentControl(),this.renderShowProgressControl()):this.props.forecastColumnInfo.columnType==u.ForecastColumnType.Calculated&&(t=l.createElement("div",null,this.renderCalculationField(),this.renderShowProgressControl())),l.createElement("div",{style:{paddingRight:24,paddingLeft:24,height:"100%",overflowY:"auto",paddingBottom:"24px"}},this.renderNameControl(),this.renderTypePicker(),e,t,this.renderUniqueNameControl())},t}(l.Component);t.ColumnEditorForm=F;t.ConnectedColumnEditorForm=c.connect((function(e){return{forecastColumnInfo:d.GetActiveForecastColumnInfo_FromState(e),forecastConfigInfo:e.FormFieldData,isFormLocked:S.GetIsFormLocked_FromState(e),arePostPublishUpdatableFieldsUpdatable:S.ArePostPublishUpdatableFieldsUpdatable(e),isUniqueNameDuplicate:d.IsUniqueNameForCurrentForecastColumnDuplicateInFC(e),isUniqueNameProper:d.IsUniqueNameForCurrentForecastColumnProper(e),isUniqueNameDisabled:d.IsUniqueNameDisabled(e)}}),(function(e,t){return{updateColumnFieldValue:function(t,n,r){g.ColumnEditorFormOperations.UpdateColumnFieldValue(e,t,n,r)},onUniqueNameChange:function(t,n){g.ColumnEditorFormOperations.UpdateUniqueName(e,t,n)}}}))(F)},1287:function(e,t,n){var r=n(1288);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1288:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".columnEditorField {\n  margin-top: 24px; }\n",""])},1289:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(25),l=n(11),c=n(12),u=n(109),d=n(64),p=n(676),_=n(26),f=function(e){function t(t){var n=e.call(this,t)||this;return n._textFieldRef=a.default.createRef(),n._textFieldHtmlRef=a.default.createRef(),n.state={isTextFieldFocused:!1,isKeyDownPress:!1},n}return o(t,e),t.prototype.renderCalculationField=function(){var e=this,t=void 0;return this.props.isCalculatedFieldExpressionErrorHidden||(t=this.props.calculatedFieldExpressionErrorMessage),a.default.createElement("div",{ref:this._textFieldHtmlRef},a.default.createElement(s.TextField,{componentRef:this._textFieldRef,value:this.props.forecastColumnInfo.calculatedFieldExpression,label:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SECTION),disabled:this.props.isFormLocked,spellCheck:!1,multiline:!0,rows:3,placeholder:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_PLACEHOLDER),onChange:function(t,n){if(void 0!==n&&null!==e._textFieldRef.current&&null!==e._textFieldRef.current.selectionEnd){var r=e._textFieldRef.current.selectionEnd;e.props.updateCalculatedFieldExpressionValue(n,r,e.props.forecastColumnInfo,e.props.forecastConfigInfo)}},onBlur:function(t){null!=e._textFieldRef.current&&void 0!==e._textFieldRef.current.value&&e.props.onCalculatedFieldExpressionBlur(e._textFieldRef.current.value,e.props.isCalculatedFieldSuggestionsCalloutVisible,e.props.forecastColumnInfo,e.props.forecastConfigInfo)},onKeyDown:function(t){e.keyDownHandler(t)},errorMessage:t,onFocus:function(t){if(null!==e._textFieldRef.current&&void 0!==e._textFieldRef.current.value&&null!=e._textFieldRef.current.selectionEnd){var n=e._textFieldRef.current.value,r=e._textFieldRef.current.selectionEnd;e.props.onCalculatedFieldExpressionFocus(n,r,e.props.forecastColumnInfo,e.props.forecastConfigInfo)}}}))},t.prototype.renderSuggestionFlyout=function(){var e=this,t=this.props.calculatedFieldExpressionSuggestions;return a.default.createElement("div",{className:"suggestionFlyOut",key:1,"data-is-focusable":!0},this.props.isCalculatedFieldSuggestionsCalloutVisible&&this._textFieldHtmlRef.current&&this._textFieldHtmlRef.current.isConnected&&a.default.createElement(s.ContextualMenu,{target:this._textFieldHtmlRef.current,items:this.getSuggestionItemForList(t),shouldFocusOnMount:this.state.isKeyDownPress,onDismiss:function(t){e.setState({isKeyDownPress:!1}),e.props.onSuggestionFlyOutDismiss()},calloutProps:{calloutMaxHeight:192,calloutWidth:669},styles:{header:{selectors:{".ms-ContextualMenu-itemText":{fontSize:"14px"},".ms-ContextualMenu-secondaryText":{textAlign:"left",fontSize:"14px",paddingLeft:"5px",color:"#0078D4"}}},list:{selectors:{".ms-ContextualMenu-secondaryText":{textAlign:"left",minWidth:"150px",maxWidth:"300px",paddingLeft:"5px",color:"#323130"}}}}}))},t.prototype.keyDownHandler=function(e){40==e.keyCode&&this.props.isCalculatedFieldSuggestionsCalloutVisible&&this.setState({isKeyDownPress:!0})},t.prototype.getSuggestionItemForList=function(e){var t=this,n=[];return n.push({key:"Headers",text:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER),secondaryText:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER_SECONDARY),itemType:s.ContextualMenuItemType.Header}),e.forecastColumns.forEach((function(e){n.push({key:e.uniqueName,text:e.title,secondaryText:e.uniqueName,onClick:function(){t.selectColumnAndAutoPopulateCalculatedField(e.uniqueName)}})})),n},t.prototype.selectColumnAndAutoPopulateCalculatedField=function(e){if(null!==this._textFieldRef.current&&null!==this._textFieldRef.current.selectionEnd){var t=this.props.forecastColumnInfo,n=this._textFieldRef.current.selectionEnd,r=this.props.calculatedFieldExpressionSuggestions;this.props.applySuggestions(t,e,n,r)}},t.prototype.render=function(){return a.default.createElement("div",null,this.renderCalculationField(),this.renderSuggestionFlyout())},t}(a.default.Component);t.CalculatedColumnWithSuggestion=f;t.ConnectedCalculatedColumnWithSuggestion=_.connect((function(e){return{forecastColumnInfo:u.GetActiveForecastColumnInfo_FromState(e),forecastConfigInfo:e.FormFieldData,isFormLocked:d.GetIsFormLocked_FromState(e),isCalculatedFieldExpressionErrorHidden:u.GetIsCalculatedFieldExpressionErrorHidden_FromState(e),calculatedFieldExpressionErrorMessage:u.GetCalculatedFieldExpressionErrorMessage_FromState(e),calculatedFieldExpressionSuggestions:u.GetCalculatedFieldExpressionSuggestions_FromState(e),isCalculatedFieldSuggestionsCalloutVisible:u.IsCalculatedFieldSuggestionsCalloutVisible_FromState(e)}}),(function(e){return{updateCalculatedFieldExpressionValue:function(t,n,r,o){p.ColumnEditorFormOperations.UpdateCalculatedFieldExpressionValue(e,n,t,r,o)},onCalculatedFieldExpressionBlur:function(t,n,r,o){p.ColumnEditorFormOperations.OnCalculatedFieldExpressionBlur(e,t,n,r,o)},onCalculatedFieldExpressionFocus:function(t,n,r,o){p.ColumnEditorFormOperations.OnCalculatedFieldExpressionFocus(e,t,n,r,o)},onSuggestionFlyOutDismiss:function(){p.ColumnEditorFormOperations.OnSuggestionCalloutDismiss(e)},applySuggestions:function(t,n,r,o){p.ColumnEditorFormOperations.ApplySuggestions(e,t,n,r,o)}}}))(f)},1290:function(e,t,n){var r=n(1291);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1291:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,'.mainPanelContainer_stage2 {\n  display: grid;\n  grid-template-columns: 330px 1px auto;\n  grid-template-rows: 480px;\n  border: thin solid #E1DFDD;\n  margin-right: 23px; }\n\n.leftPanel_stage2 {\n  width: 100%;\n  grid-column: 1;\n  overflow: hidden;\n  padding-bottom: 24px;\n  height: 100%; }\n\n.verticleDivider {\n  width: 0;\n  border-right: thin solid #E1DFDD;\n  height: 100%;\n  grid-column: 2; }\n\n.addFilterTitle {\n  font-size: 18px;\n  font-weight: 600;\n  color: #323130;\n  line-height: 24px; }\n\n.addtionalFilters {\n  padding-top: 32px; }\n\n.addFilterSubTitle {\n  margin-top: 8px;\n  font-size: 14px;\n  color: #605E5C;\n  line-height: 20px; }\n\n.filterControlPane {\n  display: flex;\n  flex-direction: column;\n  font-size: 18px; }\n\n.expressionBuilderControlClass {\n  padding-top: 24px; }\n\n.previewGrid {\n  grid-column: 3;\n  width: "100%"; }\n\n.header_stage2 {\n  width: 100%; }\n\n.colOptionDesc {\n  margin-top: 8px;\n  margin-bottom: 24px; }\n\n.editorOn {\n  animation-duration: 700ms;\n  animation-name: slidein;\n  animation-fill-mode: forwards; }\n\n.overviewOn {\n  animation-duration: 500ms;\n  animation-name: slideout;\n  animation-fill-mode: forwards; }\n\n@keyframes slideout {\n  from {\n    transform: translate(-100%); }\n  to {\n    transform: translate(0); } }\n\n@keyframes slidein {\n  from { }\n  to {\n    transform: translate(-100%); } }\n\n/* RTL changes */\n.editorOn_rtl {\n  animation-duration: 700ms;\n  animation-name: slidein_rtl;\n  animation-fill-mode: forwards; }\n\n.overviewOn_rtl {\n  animation-duration: 500ms;\n  animation-name: slideout_rtl;\n  animation-fill-mode: forwards; }\n\n@keyframes slideout_rtl {\n  from {\n    transform: translate(100%); }\n  to {\n    transform: translate(0); } }\n\n@keyframes slidein_rtl {\n  from { }\n  to {\n    transform: translate(100%); } }\n\n.ms-CommandBar {\n  padding-left: 0px !important; }\n\n.previewGridTitle {\n  margin-top: 10px;\n  font-weight: 600;\n  font-size: 14px; }\n\n.ribbonBtn {\n  background: none;\n  border-width: 0; }\n\n.ribbonBtn:hover {\n  background: #F3F2F1; }\n\n.ribbonButtonDivider {\n  border-left: thin solid #E1DFDD;\n  margin-top: 6px;\n  margin-bottom: 6px; }\n',""])},1292:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(25),l=n(53);n(1293);var c=n(26),u=n(109),d=n(49),p=n(436),_=n(245),f=n(11),E=n(12),m=n(1295),S=n(1296),g=n(64);l.initializeIcons();var C=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isDeleteDialogOpen:!1,deleteColumnTitle:"",deleteColumnId:""},n}return o(t,e),t.prototype.render=function(){var e=this.getDynamicColumnsFromProps();return a.default.createElement("div",{className:"columnsAndUpsellContainer"},a.default.createElement("div",{style:{paddingLeft:"8px",paddingRight:"7px",marginTop:"24px",overflowY:"auto",height:"100%"}},e,this.renderDeleteConfirmationDialog()),a.default.createElement(m.ConnectedColumnConfigAutoPopulationDialog,null))},t.prototype.renderUpsellSection=function(){return a.default.createElement("div",{className:"upsellContainer"},a.default.createElement("div",{className:"upsellIconContainer"},a.default.createElement(s.Icon,{iconName:"Chart",className:"upsellIcon"}),a.default.createElement("span",{className:"upsellIconMessage"},f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_FORECASTING))),a.default.createElement("div",{className:"upsellMessage"},a.default.createElement("div",null,f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION)," "),a.default.createElement("a",{href:"https://fwdurl"},f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_LINK))))},t.prototype.getDynamicColumnsFromProps=function(){var e=this;return a.default.createElement("div",null,this.props.columnInfoList.map((function(t,n){return e.renderRowItemForColumn(t,n)})))},t.prototype.handleAction=function(e,t,n){switch(e){case p.ColumnSelectorActionType.CheckBoxClicked:this.props.updateActiveState(t.id,!t.isActive);break;case p.ColumnSelectorActionType.Configure:this.props.openColumnEditPage(t);break;case p.ColumnSelectorActionType.MoveUp:if(n>0){var r=this.props.columnInfoList[n-1].id;this.props.onMoveColumn(t.id,r)}break;case p.ColumnSelectorActionType.MoveDown:if(n<this.props.columnInfoList.length-1){r=this.props.columnInfoList[n+1].id;this.props.onMoveColumn(t.id,r)}break;case p.ColumnSelectorActionType.Delete:t.dependentCalculatedColumns&&0==t.dependentCalculatedColumns.length?this.setState({isDeleteDialogOpen:!0,deleteColumnId:t.id,deleteColumnTitle:t.title}):this.props.deleteColumnFailureDialog(t.dependentCalculatedColumns)}},t.prototype.dismissDeleteDialog=function(){this.setState({isDeleteDialogOpen:!1})},t.prototype.renderDeleteConfirmationDialog=function(){var e=this;return a.default.createElement(s.Dialog,{hidden:!this.state.isDeleteDialogOpen,onDismiss:function(){e.dismissDeleteDialog()},dialogContentProps:{type:s.DialogType.normal,title:f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_DELETE_DIALOG_TITLE),subText:f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_COLUMN_OVERVIEW_DELETE_DIALOG_DESCRIPTION)},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450,outline:"1px solid transparent !important"}}}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{text:f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE),onClick:function(){e.props.deleteColumn(e.state.deleteColumnId),e.dismissDeleteDialog()}}),a.default.createElement(s.DefaultButton,{text:f.GlobalLocalizedStringsProvider.GetString(E.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),onClick:function(){e.dismissDeleteDialog()}})))},t.prototype.renderRowItemForColumn=function(e,t){var n=this;return a.default.createElement(p.ColumnSelectorRow,{onAction:function(r){n.handleAction(r,e,t)},status:e.status,title:e.title,isActive:e.isActive,columnType:e.columnType,formStatus:this.props.formStatus,arePostPublishUpdatableFieldsUpdatable:this.props.arePostPublishUpdatableFieldsUpdatable})},t}(a.default.Component);t.default=C;t.ConnectedColumnsOverview=c.connect((function(e){return{columnInfoList:u.GetForecastColumnsWithStatusList_FromState(e),formStatus:e.FormFieldData.status,arePostPublishUpdatableFieldsUpdatable:g.ArePostPublishUpdatableFieldsUpdatable(e)}}),(function(e){return{updateActiveState:function(t,n){e(d.UpdateColumnInfoField(t,"isActive",n))},openColumnEditPage:function(t){e(d.UpdateIsEditorOpened(!0)),e(d.UpdateHasUniqueNameBeenEdited(!0)),e(d.UpdateIsCalculatedFieldExpressionErrorHidden(!0)),e(d.UpdateActiveForecastColumn(t))},onMoveColumn:function(t,n){e(_.ReorderColumnsWithId(t,n))},deleteColumn:function(t){e(d.DeleteColumn(t))},deleteColumnFailureDialog:function(t){S.ColumnOverviewOperations.ColumnDeleteFailureDialog(e,t)}}}))(C)},1293:function(e,t,n){var r=n(1294);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1294:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".columnRow {\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  align-items: center;\n  margin-bottom: 5px;\n  height: 36px; }\n  .columnRow .columnMoreButton {\n    visibility: visible; }\n  .columnRow .ms-Checkbox .ms-Checkbox is-checked is-disabled columnCheckbox .ms-Checkbox-label {\n    color: #696969; }\n\n.columnRow:hover {\n  background: #F3F2F1; }\n  .columnRow:hover .columnMoreButton {\n    visibility: visible; }\n\n.expandedColumnRow {\n  background: #F3F2F1; }\n\n.columnCheckbox {\n  display: flex;\n  flex-direction: column;\n  width: 80%;\n  margin-left: 10px; }\n\n.iconsWarningAndGear {\n  display: flex;\n  flex-direction: row;\n  width: 20%;\n  justify-content: flex-end;\n  align-items: center; }\n\n.columnIcon {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n  cursor: pointer; }\n\n.upsellMessage {\n  font-family: Segoe UI;\n  font-size: 12px;\n  line-height: 16px;\n  background: #FAF9F8;\n  margin-top: 5px; }\n\n.upsellIcon {\n  color: #0742AB; }\n\n.upsellIconMessage {\n  align-items: center;\n  margin-left: 5px;\n  font-family: Segoe UI;\n  font-size: 12px;\n  line-height: 16px;\n  text-transform: uppercase;\n  color: #0742AB; }\n\n.upsellIconContainer {\n  display: flex;\n  flex-direction: row;\n  justify-content: left; }\n\n.columnsAndUpsellContainer {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100%; }\n\n.upsellContainer {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between; }\n",""])},1295:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0)),i=n(25),a=n(26),s=n(11),l=n(12),c=n(49);t.ColumnConfigAutoPopulationDialog=function(e){return o.createElement(i.Dialog,{hidden:e.isHidden,onDismiss:function(){e.onDismiss()},dialogContentProps:{type:i.DialogType.normal,title:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_TITLE),subText:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_DESCRIPTION)},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450,outline:"1px solid transparent !important"}}}},o.createElement(i.DialogFooter,null,o.createElement(i.PrimaryButton,{text:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_PRIMARY_BUTTON),onClick:function(){e.onOK()}}),o.createElement(i.DefaultButton,{text:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),onClick:function(){e.onDismiss()}})))},t.ConnectedColumnConfigAutoPopulationDialog=a.connect((function(e){return{isHidden:!e.columnEditorState.isColumnConfigAutopopulationDialogOpen}}),(function(e){return{onDismiss:function(){e(c.UpdateIsColumnConfigAutoPopulateDialogOpen(!1))},onOK:function(){e(c.UpdateIsColumnConfigAutoPopulateDialogOpen(!1)),e(c.TriggerColumnConfigAutoPopulate())}}}))(t.ColumnConfigAutoPopulationDialog)},1296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),o=n(98),i=n(11),a=n(12),s=function(){function e(){}return e.ColumnDeleteFailureDialog=function(t,n){var s=e.getAllColumnNames(n),l=i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_DELETE_COLUMN_DEPENDENTLIST).replace("{0}",s);t(o.onErrorShowDialogActionCreator(r.IErrorDialogType.ForecastConfigColDeleteFailed,l))},e.getAllColumnNames=function(e){var t=[];return e.forEach((function(e){t.push(e.title)})),t.join(", ")},e}();t.ColumnOverviewOperations=s},1297:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(1298),l=n(409),c=n(26),u=n(109);n(1299);var d=n(245),p=n(64),_=function(e){function t(t){var n=e.call(this,t)||this;return n.handleColumnReorder=function(e,t){n.props.arePostPublishUpdatableFieldsUpdatable&&n.props.onColumnReorder(e,t)},n.state={},n.provider=new l.DelfiGridProvider,n.delfActions=n.provider.getDelfiActions(),n}return o(t,e),t.prototype.render=function(){var e=s.convertColumnConfigInfoToDelfiData(this.props.columnInfoList,this.props.hierarchyEnitityPreviewRecords,this.props.activeColumnId);if(this.delfActions.updateColumnReorderConfig(this.handleColumnReorder.bind(this)),this.delfActions.updateGridInput(e),e.rows.length>0){var t=e.rows[0];this.delfActions.expandRow(t.id,!0)}return a.default.createElement("div",{className:"previewGrid",style:{height:"calc(100% - 50px)"}},this.provider.render())},t}(a.default.Component);t.PreviewGrid=_,t.default=_;t.ConnectedPreviewGrid=c.connect((function(e){return{hierarchyEnitityPreviewRecords:e.ForecastHierarchyList,columnInfoList:u.GetForecastColumnsWithStatusList_FromState(e),activeColumnId:e.columnEditorState.idEditorOpened?u.GetActiveColumnId_FromState(e):"",isFormReadonly:p.GetIsFormLocked_FromState(e),arePostPublishUpdatableFieldsUpdatable:p.ArePostPublishUpdatableFieldsUpdatable(e)}}),(function(e){return{onColumnReorder:function(t,n){return e(d.ReorderColumn(t,n))}}}))(_)},1298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17);function o(e){var t=[];return e.forEach((function(n){n.isActive&&(n.columnType==r.ForecastColumnType.HierarchyPrimary?t.push(i(e)):t.push({id:n.id,header:n.title,type:"string",width:100,isEditable:n.isManuallyAdjustable,shouldShowProgress:n.showProgressComparedToQuota}))})),t}function i(e){var t=e.find((function(e){return e.columnType==r.ForecastColumnType.HierarchyPrimary}));if(null==t)throw new Error("Owner column missing from configuration");return{id:t.id,header:t.title,type:"string",width:150,isHierarchy:!0,isEditable:!1}}function a(e,t){for(var n=[],r={},o=0;o<t.length;o++)r=s(e,t[o]),0==o&&(r.parentId=void 0),n.push(r);return n}function s(e,t){for(var n={},o=0;o<e.length;o++)n.id=t.id,n.mayHaveChildren=t.hasChildren,e[o].columnType==r.ForecastColumnType.HierarchyPrimary?n[e[o].id]=t.displayName:e[o].isActive&&(n[e[o].id]=""),n.parentId=t.parentId;return n}t.convertColumnConfigInfoToDelfiData=function(e,t,n){for(var r=[],i=[],s=o(e),l=a(e,t),c=0;c<l.length;c++){for(var u={id:l[c].id,parentId:l[c].parentId,mayHaveChildren:l[c].mayHaveChildren,getDisplayFormattedValue:{},getEditValue:{},getIconUrl:{},getIconTooltip:{},getProgress:{},getStrikeValue:{},getUrlArgs:{}},d=0;d<s.length;d++){var p=s[d].id;u.getDisplayFormattedValue[p]=l[c][p],s[d].isEditable&&(u.getIconUrl[p]="Edit"),s[d].shouldShowProgress&&(u.getProgress[p]=.75)}r.push(u)}for(c=0;c<s.length;c++){var _={id:s[c].id,header:s[c].header,dataType:1,width:s[c].width,isEditable:!1,ishierarchial:"undefined"!=s[c].isHierarchy&&s[c].isHierarchy,columnHeaderClass:s[c].id==n?"activeColumn":void 0};i.push(_)}return{rows:r,columns:i}},t.getColumnMetaData=o,t.getHierarchyColumnMetaData=i,t.getSamplePreviewGridData=a,t.getSampleRowDataFromColumnInfo=s,t.create_UUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)}))}},1299:function(e,t,n){var r=n(1300);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1300:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".previewGrid {\n  padding-left: 24px;\n  padding-right: 24px; }\n  .previewGrid .ms-List-page {\n    border-bottom: none !important; }\n    .previewGrid .ms-List-page .ms-List-cell {\n      background: white !important;\n      height: 44px !important; }\n    .previewGrid .ms-List-page .ms-DetailsRow-cellCheck {\n      align-items: center !important;\n      display: flex !important; }\n    .previewGrid .ms-List-page .ms-DetailsRow {\n      border-bottom: thin solid #E1DFDD !important;\n      min-height: 44px !important; }\n      .previewGrid .ms-List-page .ms-DetailsRow:hover {\n        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1) !important;\n        z-index: 10; }\n      .previewGrid .ms-List-page .ms-DetailsRow.is-selected {\n        background: #F3F2F1 !important; }\n      .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell {\n        border-left: none !important;\n        height: 44px !important;\n        padding-bottom: 0px !important; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlCellDiv {\n          justify-content: flex-start !important;\n          font-size: 14px !important;\n          color: #323130 !important;\n          letter-spacing: 0.005em; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .cellContextmenu {\n          margin-left: 12px !important;\n          align-items: flex-start !important;\n          font-size: 12px !important;\n          color: #605E5C !important;\n          letter-spacing: 0.02em; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass {\n          color: #323130 !important;\n          text-decoration: none !important; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass:hover {\n            color: #2266E3 !important; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectedCell {\n          border-color: transparent !important; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .delfiIcon {\n          margin-right: 9px; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv {\n          margin-top: 7px;\n          width: 100%; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv .ms-ProgressIndicator-itemProgress {\n            width: 100% !important;\n            max-width: 55px !important; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv .ms-ProgressIndicator {\n            margin-top: -2px !important; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv .ms-ProgressIndicator-progressBar {\n            background: #2266E3 !important; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .progressdiv .readOnlyCell {\n            height: 12px;\n            width: 48px;\n            background: #E1DFDD;\n            border: 1px solid transparent; }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .readOnlyCell {\n          height: 12px;\n          width: 48px;\n          background: #E1DFDD;\n          margin-top: -2px;\n          text-align: start; }\n        @media screen and (-ms-high-contrast: active) {\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .readOnlyCell {\n            border: 1px solid transparent; } }\n        .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .hierarchy-cell {\n          margin-left: -46px; }\n          .previewGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .hierarchy-cell .readOnlyCell {\n            height: auto;\n            width: auto;\n            background: none !important;\n            color: #323130 !important; }\n  .previewGrid .ms-DetailsHeader {\n    border: 0px !important;\n    border-bottom: thin solid #E1DFDD !important;\n    border-top: none !important;\n    height: auto !important; }\n    .previewGrid .ms-DetailsHeader .ms-DetailsHeader-cell {\n      border-left: none !important;\n      padding: 0px !important;\n      text-align: left !important;\n      font-size: 12px !important;\n      font-weight: 600 !important;\n      height: 30px !important; }\n      .previewGrid .ms-DetailsHeader .ms-DetailsHeader-cell:hover {\n        background-color: none; }\n      .previewGrid .ms-DetailsHeader .ms-DetailsHeader-cell .ms-DetailsHeader-cellTitle {\n        text-align: left !important;\n        margin-top: 0px !important;\n        display: block;\n        color: #323130 !important;\n        letter-spacing: 0.02em;\n        text-overflow: ellipsis; }\n  .previewGrid .activeColumn {\n    background: #F3F2F1; }\n",""])},1301:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(26);n(1302);var l=n(25),c=n(89),u=n(1304),d=n(11),p=n(12),_=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.renderOptionInfoBox=function(e,t,n,r){var o=d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_OPTIONSET_PANEL_OPTION_SUBHEADER);return a.createElement("div",{className:"optionSetItemContainer"},a.createElement("div",{className:"optionSetRadioBox"},e),a.createElement("div",{className:"optionInfoContainer"},a.createElement("div",{className:"optionTitleBox"},n),a.createElement("div",{className:"optionsListBox"},a.createElement("span",{className:"COLUMN_LabelText"},o),": ",r)))},t.prototype.render=function(){var e=this;return a.createElement("div",{style:{overflowY:"auto",paddingLeft:16,paddingRight:16}},a.createElement("div",{className:"optionSelectorHeader"},d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_OPTIONSET_PANEL_HEADER)," ",this.renderHelperTooltip(d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_COLUMN_EDITOR_OPTIONSET_HELPER))),a.createElement(l.ChoiceGroup,{className:"defaultChoiceGroup",selectedKey:this.props.categoryAttributeName,options:this.getChoiceOptionsList(),onChange:function(t,n){n&&e.props.onChange(n.key)}}))},t.prototype.renderHelperTooltip=function(e,t,n){return void 0===t&&(t="optionSetHelper"),void 0===n&&(n="Info"),a.createElement(l.TooltipHost,{styles:{root:{display:"flex",alignItems:"center"}},content:e,id:t,directionalHint:l.DirectionalHint.rightCenter},a.createElement(l.Icon,{iconName:n,className:"ms-IconExample formLabelHelpIcon"}))},t.prototype.collectMembersString=function(e){var t="";return e.map((function(n,r){t+=n,r+1!==e.length&&(t+=", ")})),t},t.prototype.getChoiceOptionsList=function(){var e=this;return this.props.optionSetInfoList.map((function(t,n){var r=e.collectMembersString(t.members);return{key:t.logicalName,text:"",className:"optionSetItemRoot",ariaLabel:t.displayName,onRenderField:function(o,i){return e.renderOptionInfoBox(i(o),n+1,t.displayName,r)},onRenderLabel:function(){},styles:{choiceFieldWrapper:{width:"100%"}}}}))},t}(a.Component);t.OptionSetSelectorChoiceList=_;t.ConnectedOptionSetSelectorChoiceList=s.connect((function(e){return{optionSetInfoList:c.GetOptionSetAttributeInfoList_FromState(e),categoryAttributeName:c.GetSelectedOptionSetAttribute_FromState(e)}}),(function(e){return{onChange:function(t){u.ChoiceListOperations.OnChoiceChange(e,t)}}}))(_)},1302:function(e,t,n){var r=n(1303);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1303:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".optionSetItemContainer {\n  width: 100%;\n  border-bottom: thin solid #F3F2F1;\n  display: flex; }\n\n.optionInfoContainer {\n  height: auto;\n  width: 100%;\n  padding-bottom: 8px;\n  display: flex;\n  flex-direction: column; }\n\n.optionSetRadioBox {\n  width: 35px;\n  display: flex;\n  align-items: center; }\n\n.optionTitleBox {\n  color: #323130;\n  font-size: 14px;\n  line-height: 20px;\n  font-weight: 600; }\n\n.optionsListBox {\n  font-size: 12px;\n  line-height: 16px;\n  color: #797775; }\n\n.COLUMN_LabelText {\n  font-weight: 600; }\n\n.optionSelectorHeader {\n  margin-top: 16px;\n  margin-bottom: 24px;\n  color: #323130;\n  font-size: 14px;\n  font-weight: 600;\n  display: flex; }\n",""])},1304:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=function(){function e(){}return e.OnChoiceChange=function(e,t){e(r.UpdateSelectedOptionSetValue(t))},e}();t.ChoiceListOperations=o},1305:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0)),i=n(25),a=n(26),s=n(1306),l=n(11),c=n(12);t.CategoryChangeConfirmationDialog=function(e){return o.createElement(i.Dialog,{hidden:e.isHidden,onDismiss:function(){e.onDismiss()},dialogContentProps:{type:i.DialogType.normal,title:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_TITLE),subText:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_DESCRIPTION)},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450,outline:"1px solid transparent !important"}}}},o.createElement(i.DialogFooter,null,o.createElement(i.PrimaryButton,{text:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_PRIMARY_BUTTON),onClick:function(){e.onReplace()}}),o.createElement(i.DefaultButton,{text:l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),onClick:function(){e.onDismiss()}})))},t.ConnectedChangeConfirmationDialog=a.connect((function(e){return{isHidden:!e.columnEditorState.isChangeConfirmationDialogOpen}}),(function(e){return{onDismiss:function(){s.ChangeConfirmationDialogOperations.Dismiss(e)},onReplace:function(){s.ChangeConfirmationDialogOperations.Replace(e)}}}))(t.CategoryChangeConfirmationDialog)},1306:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(678),i=function(){function e(){}return e.Dismiss=function(e){e(r.UpdateIsChangeConfirmationDialogOpen(!1))},e.Replace=function(e){this.Dismiss(e),o.OptionSetRibbonOperations.SaveFieldAndClose(e)},e}();t.ChangeConfirmationDialogOperations=i},1307:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(679),o=n(82),i=n(49),a=function(){function e(){}return e.OnClickHandler=function(t,n){switch(n){case r.ColumnEditorRibbonActionType.Cancel:e.onCancel(t);break;case r.ColumnEditorRibbonActionType.SaveAndClose:e.onSaveAndClose(t)}},e.onSaveAndClose=function(e){e(o.TriggerSave(!1,!0))},e.onCancel=function(e){e(o.TriggerUndoColumnFormChanges()),this.dismissPanel(e)},e.dismissPanel=function(e){e(i.UpdateIsEditorOpened(!1)),e(i.UpdateIsOptionSetSelectorOpened(!1))},e}();t.ColumnEditorRibbonOperations=a},1308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(680),o=n(97),i=n(49),a=function(){function e(){}return e.OnClickHandler=function(t,n){switch(n){case r.ColumnOverviewRibbonActionType.CreateNewColumn:e.createNewColumn(t);break;case r.ColumnOverviewRibbonActionType.ChooseOptionSet:e.openOptionSetSelector(t)}},e.openOptionSetSelector=function(e){e(i.UpdateIsOptionSetSelectorOpened(!0))},e.createNewColumn=function(e){var t=o.GetNewEmptyForecastColumnInfo();e(i.AddColumn(t)),e(i.UpdateHasUniqueNameBeenEdited(!1)),e(i.UpdateIsCalculatedFieldExpressionErrorHidden(!0)),e(i.UpdateActiveForecastColumn(t)),e(i.UpdateIsEditorOpened(!0))},e}();t.ColumnOverviewRibbonOperations=a},1309:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(681),l=n(1311),c=n(1313),u=n(64),d=n(26),p=n(1314),_=n(12),f=n(11),E=n(25);n(1315);var m=n(51),S=n(89),g=function(e){function t(t){var n=e.call(this,t)||this;return n.state={labels:void 0,dataTypes:[],isFilterClicked:!1,hasError:!1},n.cdsResolver=new s.CDSResolver(Promise.resolve(n.props.crmDataAccess.cdsClient)),n.handleFilterClick=n.handleFilterClick.bind(n),n}return o(t,e),t.prototype.handleFilterClick=function(){this.setState({isFilterClicked:!0})},t.prototype.componentWillMount=function(){var e=this;this.cdsResolver.getLocalizedLabels().then((function(t){var n;n=c.getFilteredList(t),e.setState({labels:t,dataTypes:n})}))},t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e){m.logError("Error while rendering Add filters",e,"")},t.prototype.render=function(){if(this.state.hasError)return a.createElement("div",{className:"expressionBuilderError"},f.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE));var e,t=this.state.isFilterClicked;if(this.props.isAdditionalFilterSameAsDefault&&!t)e=a.createElement(E.ActionButton,{className:"addFilterButton",allowDisabledFocus:!1,iconProps:{iconName:"add",style:{color:"#2266e3"}},disabled:this.props.isReadOnly,text:f.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_ADD_FILTERS_TEXT),onClick:this.handleFilterClick.bind(this)});else{if(!this.state.labels)return a.createElement("div",{className:"expressionBuilderControl"},f.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_LOADING));e=a.createElement("div",{className:"expressionBuilderControl"},a.createElement(l.CDSExpressionBuilderWithResolver,{cdsResolver:this.cdsResolver,entityName:this.props.entityName,onFetchXmlChanged:this.props.onFetchXmlChanged.bind(this),onFetchXmlValidationFailed:this.props.onFetchXmlValidationFailed.bind(this),dataTypes:this.state.dataTypes,query:{fetchXml:this.props.fetchXml},labels:this.state.labels,isReadOnly:this.props.isReadOnly}))}return a.createElement("div",null,e)},t}(a.PureComponent);t.DelfiExpressionBuilderWithClient=g;t.ConnectedExpressionBuilderFilter=d.connect((function(e){return{entityName:e.FormFieldData.rollupEntity,fetchXml:e.FormFieldData.additionalFilter,isReadOnly:u.GetIsFormLocked_FromState(e),isAdditionalFilterSameAsDefault:S.Get_IsAdditionalFilterSameAsDefault(e)}}),(function(e,t){return{onFetchXmlValidationFailed:function(e){},onFetchXmlChanged:function(t){p.ExpressionBuilderFilterOperations.onAdditionalFilterChange(e,t)}}}))(g)},1313:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(122);function i(e){var n=e.operators.filter((function(n){return t.GlobalFilterOperators[e.name].includes(n.name)}));return r({},e,{operators:n})}t.GlobalFilterOperators={String:["ne","eq","like","not-like","begins-with","does-not-begins-with","ends-with","does-not-ends-with","not-null","null"],Memo:["like","not-like","begins-with","does-not-begins-with","ends-with","does-not-ends-with","not-null","null"],Integer_None:["ne","eq","gt","ge","lt","le","not-null","null"],DateTime:["on","on-or-after","on-or-before"],Picklist:["ne","eq","not-null","null"],MultiSelectPicklistType:["not-null","null"],Boolean:["ne","eq","not-null","null"],Lookup:["ne","eq","like","not-like","begins-with","does-not-begins-with","ends-with","does-not-ends-with","not-null","null"],Customer:["ne","eq","like","not-like","begins-with","does-not-begins-with","ends-with","does-not-ends-with","not-null","null"],Owner:["ne","eq","not-null","null"],UniqueIdentifier:["ne","eq","not-null","null"],Money:["ne","eq","gt","ge","lt","le","not-null","null"],Double:["ne","eq","gt","ge","lt","le","not-null","null"],Decimal:["ne","eq","gt","ge","lt","le","not-null","null"],Integer_Language:["ne","eq","not-null","null"],Integer_Duration:["ne","eq","gt","ge","lt","le","not-null","null"]},t.getFilteredList=function(e){return[i(o.stringType(e)),i(o.multilineStringType(e)),i(o.wholeNumberType(e)),i(o.dateType(e)),i(o.optionSet(e)),i(o.multiOptionSet(e)),i(o.twoOptions(e)),i(o.lookupType(e)),i(o.customerType(e)),i(o.ownerType(e)),i(o.uidType(e)),i(o.currencyType(e)),i(o.floatType(e)),i(o.decimalType(e)),i(o.languageType(e)),i(o.durationType(e))]},t.filterOperator=i},1314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(82),o=function(){function e(){}return e.onAdditionalFilterChange=function(e,t){var n={additionalFilter:t};e(r.UpdateFieldValue(n))},e}();t.ExpressionBuilderFilterOperations=o},1315:function(e,t,n){var r=n(1316);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1316:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".addFilterButton {\n  margin-left: -5px; }\n\n.addFilterButton:hover {\n  margin-left: -5px;\n  color: #2266e3; }\n\n.expressionBuilderControl h1 {\n  color: #2266e3;\n  font-weight: normal;\n  font-size: 12px;\n  line-height: 16px; }\n\n.expressionBuilderError {\n  color: #a80000;\n  font-size: 16px;\n  line-height: 16px; }\n",""])},1317:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(1318),l=n(195);n(1319);var c=n(26),u=n(1321),d=n(241),p=n(11),_=n(12),f=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.render=function(){return a.default.createElement("div",{className:"statusDiv"},this.renderStatusInfo(s.IStatusFields.Status),this.renderSplit(),this.renderStatusInfo(s.IStatusFields.Type),this.renderSplit(),this.renderStatusLink(s.IStatusFields.Owner,this.props.Owner))},t.prototype.renderStatusInfo=function(e){return a.default.createElement("div",{className:"statusInfoDiv "},a.default.createElement("div",{className:"statusInfoFieldDiv"},a.default.createElement(l.Label,{className:""==this.props[e]?"statusEmptylabel":"statusInfoField"},this.props[e])),a.default.createElement("div",{className:"statusInfoLabelDiv"},a.default.createElement(l.Label,{className:"statusInfoLabel"},this.getStatusInfoLabel(e))))},t.prototype.renderStatusLink=function(e,t){var n=this;return a.default.createElement("div",{className:"statusInfoDiv"},a.default.createElement("div",{className:"statusInfoFieldDiv"},a.default.createElement("div",{tabIndex:0},a.default.createElement(l.Label,{className:""==t.displayName?"statusEmptylabel":"statusLinkField",onClick:function(){return n.navigateToLink(t)}},t.displayName))),a.default.createElement("div",{className:"statusInfoLabelDiv"},a.default.createElement(l.Label,{className:"statusInfoLabel"},this.getStatusInfoLabel(e))))},t.prototype.getStatusInfoLabel=function(e){switch(e){case s.IStatusFields.Status:return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_STATUS_STATUS_EDITPAGE);case s.IStatusFields.Type:return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_STATUS_TYPE_EDITPAGE);case s.IStatusFields.Owner:return p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_STATUS_OWNER_EDITPAGE);default:return""}},t.prototype.renderSplit=function(){return a.default.createElement("div",{className:"verticalLine"})},t.prototype.navigateToLink=function(e){""!==e.id&&""!==e.entityLogicalName&&d.CrmNavigationHelpers.navigateToEntityForm(e.entityLogicalName,e.id)},t}(a.default.Component);t.default=f,t.ConnectedEditAppStatusInfo=c.connect((function(e){return u.getappStatusInfo(e)}))(f)},1318:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Status="Status",e.Type="Type",e.Owner="Owner"}(t.IStatusFields||(t.IStatusFields={}))},1319:function(e,t,n){var r=n(1320);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1320:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".verticalLine {\n  width: 0px;\n  height: 40px;\n  border: 1px solid #E1DFDD;\n  display: block; }\n\n.statusDiv {\n  white-space: nowrap;\n  flex-direction: row;\n  display: flex;\n  margin-left: 24px;\n  margin-right: 24px; }\n\n.statusInfoDiv {\n  margin-left: 12px;\n  margin-right: 12px;\n  margin-top: -8px; }\n\n.statusInfoField {\n  font-size: 14px;\n  font-family: 'Segoe UI';\n  line-height: 20px;\n  color: #323130;\n  font-weight: 600; }\n\n.statusLinkField {\n  font-size: 14px;\n  font-family: 'Segoe UI';\n  line-height: 20px;\n  color: #2266E3;\n  cursor: pointer;\n  font-weight: 600; }\n\n.statusLinkField:hover {\n  color: #0B53CE;\n  text-decoration: underline; }\n\n.statusInfoLabelDiv {\n  margin-top: 4px; }\n\n.statusEmptylabel {\n  margin-bottom: 24px; }\n\n.statusInfoLabel {\n  font-size: 12px;\n  line-height: 14px;\n  color: #605E5C; }\n",""])},1321:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=n(352),i=n(542);t.getappStatusInfo=function(e){return{Status:e.ActiveForecastConfigInfo.statusDescription?e.ActiveForecastConfigInfo.statusDescription:"",Type:i.getLocalizedTemplateName(e.FormFieldData.templateType),Owner:r.ForecastingBusinessLogicProvider.FieldHasNonNullValue("id",e.ActiveForecastConfigInfo.id)&&e.ActiveForecastConfigInfo.owner?e.ActiveForecastConfigInfo.owner:o.XrmHelper.getLoggedInUserInfo()}}},1322:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(25),s=i(n(0)),l=n(1323),c=n(26),u=n(64);n(1324);var d=n(1326),p=n(12),_=n(11),f=n(51),E=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.render=function(){return s.default.createElement("div",null,s.default.createElement(a.CommandBar,{items:this.getItems(),styles:{root:{backgroundColor:"white"}}}))},t.prototype.getItems=function(){var e=this;return[{key:"editAppsave",name:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_RIBBON_SAVE_EDITPAGE),iconProps:{iconName:"Save"},className:"ms-CommandBarItem",disabled:!this.props.allowSaveOperation,onClick:function(){f.logUsage("DelfiConfigEditApp.Ribbon","Edit_App_Ribbon_Button_Clicked",{ButtonName:"Save"}),e.props.editAppRibbonAction(l.IEditAppCommand.Save)}},{key:"editAppsaveAndClose",name:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE),iconProps:{iconName:"SaveAndClose"},className:"ms-CommandBarItem",disabled:!this.props.allowSaveOperation,onClick:function(){f.logUsage("DelfiConfigEditApp.Ribbon","Edit_App_Ribbon_Button_Clicked",{ButtonName:"SaveAndClose"}),e.props.editAppRibbonAction(l.IEditAppCommand.SaveAndClose)}},{key:"editAppDelete",name:_.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_EDIT_RIBBON_DELETE_EDITPAGE),iconProps:{iconName:"Cancel",style:{color:"#A80000"}},className:"ms-CommandBarItem",disabled:this.props.isForecastConfigInCreateMode,onClick:function(){e.props.editAppRibbonAction(l.IEditAppCommand.Delete)}}]},t}(s.default.Component);t.default=E;t.ConnectedEditAppRibbon=c.connect((function(e){return{isForecastConfigInCreateMode:u.GetIsFormInCreateMode_FromState(e),allowSaveOperation:u.IsFormValidForSave_FromState(e)}}),(function(e){return{editAppRibbonAction:function(t){var n=new d.EditAppRibbonOperations(e);switch(t){case l.IEditAppCommand.Save:n.OnSave();break;case l.IEditAppCommand.SaveAndClose:n.OnSaveAndClose();break;case l.IEditAppCommand.Delete:n.OnDelete()}}}}))(E)},1323:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Save=0]="Save",e[e.SaveAndClose=1]="SaveAndClose",e[e.Delete=2]="Delete"}(t.IEditAppCommand||(t.IEditAppCommand={}))},1324:function(e,t,n){var r=n(1325);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1325:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".ms-CommandBarItem {\n  background: none !important;\n  border-width: 0; }\n  .ms-CommandBarItem:hover {\n    background-color: #eaeaea !important; }\n",""])},1326:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(82),o=n(185),i=function(){function e(e){this.dispatch=e}return e.prototype.OnSave=function(){this.dispatch(r.TriggerSave())},e.prototype.OnSaveAndClose=function(){this.dispatch(r.TriggerSave(!0))},e.prototype.OnDelete=function(){this.dispatch(o.onGridAppDialogDeleteStateActionCreator(!1))},e}();t.EditAppRibbonOperations=i},1327:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(83);n(1328);var l=n(208),c=n(101),u=n(26),d=n(17),p=n(543),_=n(273),f=n(77),E=n(223),m=n(1330),S=n(27),g=n(97),C=n(11),I=n(12),h=n(327),T=n(1334),y=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t.prototype.componentDidMount=function(){this.props.shouldCallFetch&&this.props.fetchQuotaStatus(),this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Processing&&this.props.subscribePublish(),this.props.connectNotification()},t.prototype.render=function(){return a.default.createElement("div",{className:"Stage3Form"},a.default.createElement("div",{className:"Stage3FormHeading"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_PUBLISH_HEADING)),a.default.createElement("p",{className:"Stage3FormMessage Stage3MarginTop8"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_PUBLISH_TEXT)),this.renderFCPublishPanel(),a.default.createElement("div",{className:"Stage3FormHeading"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_QUOTA_HEADING)),a.default.createElement("div",{className:"Stage3FormMessage Stage3MarginTop8"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_QUOTA_TEXT_LINE1)),a.default.createElement("div",{className:"Stage3FormMessage"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_QUOTA_TEXT_LINE2)),this.renderLoader(),this.renderDownloadTemplate(),this.renderDragDrop(),this.renderQuotaStatusMessage())},t.prototype.renderLoader=function(){return this.props.shouldCallFetch?a.default.createElement(_.ProgressIndicator,null):null},t.prototype.renderFCPublishPanel=function(){return this.props.shouldShowPublishingSpinner?a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},a.default.createElement(S.CommandButton,{className:"Stage3FormPublishButtonDisabled",disabled:!0},a.default.createElement(l.Spinner,{ariaLive:"assertive",labelPosition:"right",size:c.SpinnerSize.small,className:"Stage3FormDisabledText"}),a.default.createElement("div",{className:"Stage3FormDisabledText Stage3MarginLeft8 Stage3Font600"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_PUBLISH_INPROGRESS)))):this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Published?a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},a.default.createElement(f.Icon,{iconName:"SkypeCircleCheck",className:"Stage3FormIcon Stage3VerticalMiddle Stage3SuccessColor"}),a.default.createElement("span",{className:"Stage3FormMessage Stage3VerticalMiddle Stage3SuccessColor"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_PUBLISH_SUCCESS))):this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Failed?a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},this.renderPublishButton(),a.default.createElement("div",{className:"Stage3MarginTop8"},a.default.createElement(f.Icon,{iconName:"StatusErrorFull",className:"Stage3FormIcon Stage3VerticalMiddle Stage3ErrorColor",style:{float:"left"}}),a.default.createElement("div",{className:"Stage3FormMessage Stage3VerticalMiddle Stage3ErrorColor Stage3TextSmall",style:{float:"left"}},this.props.publishErrorMessage))):a.default.createElement("div",{className:"Stage3FormPublishButtonContainer"},this.renderPublishButton())},t.prototype.renderPublishButton=function(){return a.default.createElement(s.PrimaryButton,{className:"PublishButton",text:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_PUBLISH_HEADING),onClick:this.onPublishClick.bind(this)})},t.prototype.renderDownloadTemplate=function(){var e,t,n="";return this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Published?(t=!1,e=this.props.quotaUploadStageState.isDownload?a.default.createElement(l.Spinner,{className:"Stage3FormIcon Stage3PrimaryColor",size:c.SpinnerSize.small,style:{float:"left"}}):a.default.createElement(f.Icon,{iconName:"Download",className:"Stage3FormIcon Stage3PrimaryColor"})):(e=a.default.createElement(f.Icon,{iconName:"Download",className:"Stage3FormIcon Stage3FormDisabledText"}),n="Stage3FormDisabledText",t=!0),a.default.createElement("div",{className:"Stage3FormDownloadLinkBox"},a.default.createElement(h.Link,{className:"Stage3FormDownloadLink",onClick:this.onDownloadClick.bind(this),disabled:t},e,a.default.createElement("span",{className:n},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_QUOTA_DOWNLOAD_TEXT))))},t.prototype.renderDragDrop=function(){return this.props.shouldRenderEnabledDragDrop?this.props.shouldRenderUploadingDragDrop?a.default.createElement(m.DelphiDragDrop,{onFileSelected:this.onFileSelected.bind(this),type:"enabled"}):this.renderProgressDragDrop():a.default.createElement(m.DelphiDragDrop,{onFileSelected:this.onFileSelected.bind(this),type:"disabled"})},t.prototype.renderProgressDragDrop=function(){var e,t,n=this.props.quotaUploadStageState.quotaStatusInfo.Status;return n==E.QuotaStatus.Uploading?(e=C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_QUOTA_UPLOADING),t=C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_QUOTA_STEP1)):n!=E.QuotaStatus.InProgress&&n!=E.QuotaStatus.Uploaded||(e=C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_QUOTA_PROCESSING),t=C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_QUOTA_STEP2)),a.default.createElement("div",{className:"DragDrop"},a.default.createElement("div",{className:"DragDropInner"},a.default.createElement(l.Spinner,{className:"Stage3ProcessingBoxText",label:e,size:c.SpinnerSize.large}),a.default.createElement("div",{className:"Stage3ProcessingBoxText"},t)))},t.prototype.renderQuotaStatusMessage=function(){if(this.props.forecastConfigurationStatus==d.IForecastConfigStatus.Published&&null!=this.props.quotaStatusMessage.isError)return 0==this.props.quotaStatusMessage.isError?a.default.createElement("div",{className:"Stage3MarginTop8"},a.default.createElement(f.Icon,{iconName:"SkypeCircleCheck",className:"Stage3FormIcon Stage3VerticalMiddle Stage3SuccessColor"}),a.default.createElement("span",{className:"Stage3FormMessage Stage3VerticalMiddle Stage3SuccessColor Stage3TextSmall"},this.props.quotaStatusMessage.message)):a.default.createElement("div",{className:"Stage3MarginTop8"},a.default.createElement(f.Icon,{iconName:"StatusErrorFull",className:"Stage3FormIcon Stage3VerticalMiddle Stage3ErrorColor"}),a.default.createElement("span",{className:"Stage3FormMessage Stage3VerticalMiddle Stage3ErrorColor Stage3TextSmall"},this.props.quotaStatusMessage.message))},t.prototype.onFileSelected=function(e){var t=this;if(e)if("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!=e.type)this.props.quotaStatusUpdate(E.QuotaStatus.Failed,"INVALID_FILE",e.name);else if(e.size>E.MAX_UPLOAD_FILESIZE_BYTES)this.props.quotaStatusUpdate(E.QuotaStatus.Failed,"INVALID_SIZE",e.name);else{var n=new FileReader;n.onload=function(){if(n.result){var r=n.result,o=r.indexOf(","),i=r.substr(o+1);t.props.uploadQuotaFileContents(e.name,i)}},n.readAsDataURL(e)}},t.prototype.onDownloadClick=function(e){e.preventDefault(),this.props.quotaDownload()},t.prototype.onPublishClick=function(){this.props.publish()},t}(a.default.Component);t.Stage3Form=y;t.ConnectedStage3Form=u.connect((function(e){return{shouldShowPublishingSpinner:T.shouldShowPublishingSpinner(e),shouldRenderUploadingDragDrop:T.shouldRenderUploadingDragDrop(e),shouldRenderEnabledDragDrop:T.shouldRenderEnabledDragDrop(e),quotaStatusMessage:T.constructQuotaUploadStatusMessage(e),shouldCallFetch:T.shouldCallFetch(e),forecastConfigurationStatus:e.ActiveForecastConfigInfo.status,quotaUploadStageState:e.quotaUploadStageState,publishErrorMessage:T.getPublishFailErrorMessageFromState(e)}}),(function(e){return{fetchQuotaStatus:function(){e(p.QuotaStatusFetch())},quotaDownload:function(){e(p.QuotaDownload())},uploadQuotaFileContents:function(t,n){e(p.QuotaUploadStart(t,n))},quotaStatusUpdate:function(t,n,r){var o=g.GetEmptyQuotaStatusInfo();o.Status=t,o.ErrorCode=n,o.UploadFileName=r,e(p.QuotaUploadStatusUpdate(o))},publish:function(){e(p.Publish())},connectNotification:function(){e(p.NotificationConnect())},subscribePublish:function(){e(p.PublishSubscribe())}}}))(y)},1328:function(e,t,n){var r=n(1329);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1329:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".Stage3Form {\n  overflow: auto;\n  height: 100%;\n  display: block;\n  /* padding-bottom: 20px */ }\n\n.Stage3FormHeading {\n  width: auto;\n  height: auto;\n  /* M / 18 Semibold (600) */\n  font-family: Segoe UI;\n  font-size: 18px;\n  line-height: 24px;\n  color: #323130;\n  margin: 0px;\n  font-weight: 600; }\n\n.Stage3FormMessage {\n  width: auto;\n  height: auto;\n  /* M / 18 Semibold (600) */\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #605e5c;\n  margin: 0px; }\n\n.Stage3FormPublishButtonContainer {\n  margin: 0px;\n  margin-top: 24px;\n  margin-bottom: 8px;\n  display: block;\n  height: 56px; }\n\n.PublishButton {\n  background-color: #2266E3;\n  border-radius: 2px;\n  border-width: 0; }\n\n.PublishButton:hover {\n  background-color: #0B53CE; }\n\n.Stage3FormPublishButtonDisabled {\n  background: #F3F2F1;\n  border-radius: 2px;\n  padding-left: 20px;\n  padding-right: 20px; }\n\n.Stage3FormIcon {\n  margin-right: 8px;\n  font-size: 16px; }\n\n.Stage3FormDisabledText {\n  color: #A19F9D; }\n\n.SemiBold {\n  font-weight: 600; }\n\n.Stage3FormDownloadLinkBox {\n  margin-top: 24px;\n  margin-bottom: 24px; }\n\n.Stage3FormDownloadLink {\n  text-decoration: none;\n  color: #1a1918; }\n\n.Stage3MarginTop8 {\n  margin-top: 8px; }\n\n.Stage3MarginLeft8 {\n  margin-left: 8px; }\n\n.Stage3Font600 {\n  font-weight: 600; }\n\n.Stage3VerticalMiddle {\n  vertical-align: middle; }\n\n.Stage3SuccessColor {\n  color: #107c10; }\n\n.Stage3ErrorColor {\n  color: #a80000; }\n\n.Stage3PrimaryColor {\n  color: #2266E3; }\n\n.Stage3ProcessingBoxText {\n  color: #2266E3;\n  font-size: 12px;\n  line-height: 16px;\n  width: auto;\n  height: auto;\n  /* M / 18 Semibold (600) */\n  font-family: Segoe UI;\n  margin: 0px; }\n\n.Stage3TextSmall {\n  font-size: 12px;\n  line-height: 16px; }\n\n@media screen and (-ms-high-contrast: active) {\n  .PublishButton {\n    background-color: #ffd800; } }\n",""])},1330:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(27),l=n(1331);n(1332);var c=n(11),u=n(12),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={Drag:l.DragStatus.Idle},n}return o(t,e),t.prototype.render=function(){return"disabled"==this.props.type?this.renderDisabledDragDrop():this.renderEnabledDragDrop()},t.prototype.renderEnabledDragDrop=function(){var e=this,t="DragDrop";return this.state.Drag==l.DragStatus.Idle?t="DragDrop":this.state.Drag==l.DragStatus.Dragging?t+=" DragDropHover":t="DragDrop",a.default.createElement("div",{className:t,onDragEnter:function(t){return e.handleDrag(t,l.DragStatus.Dragging)},onDragLeave:function(t){return e.handleDrag(t,l.DragStatus.Idle)},onDrop:function(t){return e.handleDrag(t,l.DragStatus.Dropped)}},a.default.createElement("input",{type:"file",className:"DragInput",tabIndex:-1,onChange:function(t){return e.handleFileSelect(t,l.DragStatus.Dropped)}}),this.renderDragInternal())},t.prototype.renderDragInternal=function(){var e="",t="";return this.state.Drag==l.DragStatus.Idle?(e=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_LINE1),t=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_LINE2)):e=this.state.Drag==l.DragStatus.Dragging?c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_DRAG):this.selectedFile.name,a.default.createElement("div",{className:"DragDropInner"},a.default.createElement(s.IconButton,{className:"DragDropUploadIcon",tabIndex:0,menuIconProps:{iconName:"Upload",style:{fontSize:"32px"}},"aria-label":c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_FILE)}),a.default.createElement("div",{className:"DragDropMessage"},e),a.default.createElement("div",{className:"DragDropMessage"},t))},t.prototype.renderDisabledDragDrop=function(){var e,t;return e=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_LINE1),t=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_LINE2),a.default.createElement("div",{className:"DragDrop"},a.default.createElement("div",{className:"DragDropInner"},a.default.createElement(s.IconButton,{className:"DragDropUploadIconDisabled",disabled:!0,menuIconProps:{iconName:"Upload",style:{fontSize:"32px"}},"aria-label":c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_QUOTA_UPLOAD_FILE)}),a.default.createElement("div",{className:"DragDropMessage DragDropDisabled"},e),a.default.createElement("div",{className:"DragDropMessage DragDropDisabled"},t)))},t.prototype.handleFileSelect=function(e,t){e.preventDefault(),this.setState({Drag:t}),e.target.files[0]&&(this.selectedFile=e.target.files[0],this.props.onFileSelected(this.selectedFile))},t.prototype.handleDrag=function(e,t){e.preventDefault(),this.setState({Drag:t}),t==l.DragStatus.Dropped&&e.dataTransfer.files[0]&&(this.selectedFile=e.dataTransfer.files[0],this.props.onFileSelected(this.selectedFile))},t}(a.default.Component);t.DelphiDragDrop=d},1331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Idle=0]="Idle",e[e.Dragging=1]="Dragging",e[e.Dropped=2]="Dropped"}(t.DragStatus||(t.DragStatus={}))},1332:function(e,t,n){var r=n(1333);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1333:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".DragDrop {\n  width: 99%;\n  height: 128px;\n  background: #FAF9F8;\n  margin-top: 24px;\n  border-radius: 4px;\n  border: 1px solid #ececec;\n  text-align: center;\n  overflow: auto;\n  position: relative;\n  z-index: 0; }\n\n.DragInput {\n  width: 100%;\n  height: 100%;\n  opacity: 0;\n  position: absolute;\n  left: 0px;\n  z-index: 1; }\n\n.DragDropHover {\n  background: #e4edfc;\n  border: 1px solid #2266e3; }\n\n.DragDropInner {\n  width: auto;\n  height: auto;\n  position: relative;\n  margin: 0 auto;\n  z-index: 0;\n  padding-top: 24px;\n  display: block; }\n\n.DragDropMessage {\n  width: auto;\n  height: auto;\n  /* M / 18 Semibold (600) */\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #2266E3;\n  margin: 0px; }\n\n.DragDropDisabled {\n  color: #A19F9D; }\n\n.DragDropUploadIcon {\n  font-size: 32px;\n  color: #2266E3; }\n\n.DragDropUploadIconDisabled {\n  font-size: 32px;\n  color: #A19F9D; }\n",""])},1334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(223),i=n(11),a=n(12),s=n(354);function l(e){switch(e.quotaUploadStageState.quotaStatusInfo.ErrorCode){case o.ERROR_CODES.GUID_TAMPERED:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_GUID_TAMPERED);case o.ERROR_CODES.INVALID_ROWS:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_ROWS);case o.ERROR_CODES.INVALID_CONTENT:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_CONTENT);case o.ERROR_CODES.INVALID_FILE:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_FILE);case o.ERROR_CODES.INVALID_SIZE:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_SIZE);case o.ERROR_CODES.UPLOAD_FAILED:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_UPLOAD_FAILED);case o.ERROR_CODES.FETCH_FAILED:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_FETCH_FAILED);case o.ERROR_CODES.INVALID_FORECASTCONFIGURATION:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_INVALID_FORECASTCONFIGURATION);default:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED_UNKNOWN)}}t.shouldShowPublishingSpinner=function(e){return e.ActiveForecastConfigInfo.status==r.IForecastConfigStatus.Processing||e.quotaUploadStageState.isPublishing},t.shouldRenderUploadingDragDrop=function(e){var t=e.quotaUploadStageState.quotaStatusInfo.Status;return t==o.QuotaStatus.New||t==o.QuotaStatus.Success||t==o.QuotaStatus.Failed},t.shouldRenderEnabledDragDrop=function(e){return e.quotaUploadStageState.isFetched&&e.ActiveForecastConfigInfo.status==r.IForecastConfigStatus.Published},t.shouldCallFetch=function(e){return!e.quotaUploadStageState.isFetched&&e.ActiveForecastConfigInfo.status==r.IForecastConfigStatus.Published},t.getPublishFailErrorMessageFromState=function(e){var t=s.getlocalizedFCPublishErrorMessage(e.ActiveForecastConfigInfo.publishErrorMessage);return t||i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_PUBLISH_FAILED)},t.constructQuotaUploadStatusMessage=function(e){var t=e.quotaUploadStageState.quotaStatusInfo;if(t.Status==o.QuotaStatus.Success){return{message:i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_SUCCESS).replace("{0}",new Date(t.UploadedOn).toLocaleString()).replace("{1}",t.UploadFileName),isError:!1}}if(t.Status==o.QuotaStatus.Failed){var n=void 0;if(t.ErrorCode==o.ERROR_CODES.FETCH_FAILED||t.ErrorCode==o.ERROR_CODES.UPLOAD_FAILED)n=l(e);else if(t.ErrorCode==o.ERROR_CODES.INVALID_SIZE){n=(n=(n=i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED)).replace("{0}",new Date(t.UploadedOn).toLocaleString())).replace("{1}",t.UploadFileName);var r=l(e);r=r.replace("{0}",o.MAX_UPLOAD_FILESIZE_MB.toString()),n=n.replace("{2}",r)}else n=(n=(n=(n=i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_QUOTA_FAILED)).replace("{0}",new Date(t.UploadedOn).toLocaleString())).replace("{1}",t.UploadFileName)).replace("{2}",l(e));return{message:n,isError:!0}}return{message:"",isError:null}}},1335:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(0)),c=n(26);n(1336);var u=n(11),d=n(12),p=s(n(675)),_=n(17),f=n(99),E=n(231),m=n(244),S=n(110),g=n(231),C=n(25),I=s(n(1338)),h=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.render=function(){return l.createElement("div",{className:"stagePermissionsContainerDiv"},this.renderPermissionsStage(),this.renderInfoOrErrorMessage())},t.prototype.renderPermissionsStage=function(){return l.createElement("div",{className:"stagePermissionControlsContainerDiv"},this.renderPermissionsAttributeSelectionDiv(),this.renderAdditionalViewingPermissionsDiv())},t.prototype.renderPermissionsAttributeSelectionDiv=function(){var e=this.getSystemUserLookupPickerProps();return l.createElement("div",{className:"stagePermissionSubContainerDiv"},l.createElement("span",{className:"stagePermissionsHeaderLabel"},u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_TITLE)),l.createElement("span",{className:"stagePermissionsSubTitleLabel"},u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_SUBTITLE)),l.createElement("div",{className:"PermissionAttributeSelectorContainerDiv"},l.createElement("div",{className:"PermissionAttributeSelectorEntityFieldDiv"},l.createElement(C.TextField,{value:this.props.hierarchyEntityDisplayName,label:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL),readOnly:!0,disabled:!0})),l.createElement("div",{className:"PermissionAttributeSelectorEntityFieldDiv"},l.createElement(p.default,i({},e)))))},t.prototype.renderAdditionalViewingPermissionsDiv=function(){var e={isDisabled:!this.props.enableRoleSelector,itemSet:this.props.securityRolesList,onItemSelected:this.props.addRole,onItemUnselected:this.props.removeRole,selectedItems:this.props.selectedRolesList,placeholder:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PICKER_PLACEHOLDER),noItemsText:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PICKER_NO_DATA),selectedItemLimit:10,itemIconUrl:"/webresources/msdyn_/Images/IC_SecurityRole",removeButtonTooltipText:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PICKER_ITEM_REMOVE_BUTTON_TOOLTIP)};return l.createElement("div",{className:"stagePermissionSubContainerDiv"},l.createElement("span",{className:"AdditionalViewingPermissionHeaderLabel"},u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_HEADER)),l.createElement("span",{className:"AdditionalViewingPermissionSubTitleLabel"},u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_ADDITIONAL_PERMISSIONS_SUBITITLE)),l.createElement("div",{className:"PermissionRoleTypeComboOptionsContainerDiv"},l.createElement(C.ChoiceGroup,{className:"PermissionRoleTypeComboOptions",defaultSelectedKey:null==this.props.selectedAdditionalViewingPermissionType?g.None_Option_Key:this.props.selectedAdditionalViewingPermissionType.toString(),options:E.getAdditionalForecastViewingPermissionOptions(),onChange:this.onAdditionalViewingPermissionTypeChange.bind(this)})),l.createElement("div",{className:"SecurityRoleLookupPicker"},l.createElement(I.default,i({},e))))},t.prototype.renderInfoOrErrorMessage=function(){var e=this.props.isFormStateValid?"":"_Error";return l.createElement("div",{className:"PermissionStageMessageContainer"+e},l.createElement(C.Icon,{className:"PermissionStageMessageIcon"+e,iconName:this.props.isFormStateValid?"Info":"Blocked2"}),l.createElement("span",{className:"PermissionStageMessageText"},this.props.permissionsStageMessageText))},t.prototype.getSystemUserLookupPickerProps=function(){var e=this;return{id:"",attributeInfo:{id:"",name:"permissionsAttribute",entityName:this.props.hierarchyEntity,type:f.ICrmAttributeType.Lookup,lookupEntityName:"systemuser",entityPrimaryIdAttribute:"systemuserid"},onChange:function(t){e.props.updateAttributeValue(t)},value:this.props.selectedPermissionsAttribute,crmDataAcces:this.props.crmDataAccess,isDisabled:this.props.isAttributeDisabled,showNoneOption:!0,label:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ATTRIBUTE_FIELD_LABEL)}},t.prototype.onAdditionalViewingPermissionTypeChange=function(e,t){void 0!==t&&this.props.updateAdditionalPermissionType(t.key)},t}(l.Component);t.ConnectedStagePermissionsForm=c.connect((function(e){return{hierarchyEntity:e.FormFieldData.hierarchyEntity,isAttributeDisabled:E.getPermissionAttributeControlDisabledState(e),selectedPermissionsAttribute:E.getSelectedPermissionAttribute_FromState(e),hierarchyEntityDisplayName:S.getHierarchyEntityDisplayName(e),securityRolesList:E.getSuggestionListForRolesListFromState(e),selectedRolesList:E.getSelectedPermissionRoles_FromState(e),selectedAdditionalViewingPermissionType:E.getAdditionalViewingPermissionType_FromState(e),enableRoleSelector:E.isRoleBasedPermissionTypeOptionSelectedFromState(e),isFormStateValid:E.arePermissionsConfigured(e),permissionsStageMessageText:E.getPermissionStageInfoErrorMessage(e)}}),(function(e,t){return{updateAttributeValue:function(t){e(m.UpdatePermissionsAttribute(t!==g.None_Option_Key?t:null))},updateAdditionalPermissionType:function(t){switch(t){case g.None_Option_Key:e(m.SetAdditionalViewingPermissionType(null));break;case _.PermissionType.All.toString():e(m.SetAdditionalViewingPermissionType(_.PermissionType.All));break;case _.PermissionType.Role.toString():e(m.SetAdditionalViewingPermissionType(_.PermissionType.Role))}},addRole:function(t){e(m.AddPermissionRole(t))},removeRole:function(t){e(m.DeletePermissionRole(t))}}}))(h)},1336:function(e,t,n){var r=n(1337);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1337:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".stagePermissionsContainerDiv {\n  display: flex;\n  flex-direction: column; }\n\n.stagePermissionControlsContainerDiv {\n  display: flex;\n  flex-direction: column;\n  align-items: start;\n  height: 580px; }\n\n.stagePermissionSubContainerDiv {\n  display: flex;\n  flex-direction: column;\n  align-items: start; }\n\n.stagePermissionsHeaderLabel {\n  font-family: Segoe UI;\n  font-size: 18px;\n  line-height: 24px;\n  color: #323130;\n  font-weight: 600; }\n\n.stagePermissionsSubTitleLabel {\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C;\n  font-weight: 600;\n  margin-top: 8px; }\n\n.PermissionAttributeSelectorContainerDiv {\n  margin-top: 24px;\n  display: flex;\n  flex-direction: row;\n  margin-bottom: 8px; }\n\n.PermissionAttributeSelectorEntityFieldDiv {\n  margin-right: 16px;\n  display: flex;\n  flex-direction: column;\n  width: 198px; }\n\n.PermissionAttributeSelectorEntityFieldLabel {\n  margin-bottom: 5px;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 19px;\n  color: #696969; }\n\n.PermissionAttributeSelectorAttributeFieldLabel {\n  margin-bottom: 5px;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 19px;\n  color: #696969; }\n\n.PermissionHierarchyEntityValueField {\n  color: #605E5C;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  background: #F3F2F1;\n  border: #F3F2F1;\n  border-radius: 2px;\n  border-style: none;\n  height: 32px;\n  padding-left: 8px; }\n\n.PermissionAttributeSelectorValueField {\n  color: #FFFFFF;\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  border-radius: 2px;\n  border: 1px solid #605E5C;\n  box-sizing: border-box;\n  height: 32px; }\n\n.AdditionalViewingPermissionHeaderLabel {\n  font-family: Segoe UI;\n  font-size: 18px;\n  line-height: 24px;\n  color: #323130;\n  font-weight: 600;\n  margin-top: 24px; }\n\n.AdditionalViewingPermissionSubTitleLabel {\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C;\n  font-weight: 600;\n  margin-top: 8px; }\n\n.PermissionRoleTypeComboOptionsContainerDiv {\n  margin-top: 16px;\n  display: flex;\n  flex-direction: row; }\n\n.PermissionRoleTypeComboOptions {\n  font-family: Segoe UI !important;\n  font-size: 14px !important;\n  line-height: 20px !important;\n  color: #323130 !important;\n  margin-left: 9px; }\n\n.SecurityRoleLookupPicker {\n  margin-top: 17px;\n  margin-left: 36px; }\n  .SecurityRoleLookupPicker .ms-BasePicker-text {\n    border-width: thin !important;\n    width: 376px;\n    margin-bottom: 16px; }\n  .SecurityRoleLookupPicker .ms-BasePicker-text:disabled {\n    background: #F3F2F1;\n    border: #F3F2F1; }\n  .SecurityRoleLookupPicker .ms-SelectionZone {\n    max-height: 120px;\n    overflow: auto;\n    margin-left: -32px; }\n  .SecurityRoleLookupPicker .ms-Button-icon {\n    font-size: 12px; }\n\n.PermissionStageMessageContainer {\n  max-width: 412px;\n  max-height: 68;\n  overflow: auto;\n  display: flex;\n  flex-direction: row;\n  background: #F3F2F1;\n  padding: 10px 0px; }\n\n.PermissionStageMessageContainer_Error {\n  max-width: 412px;\n  max-height: 68;\n  overflow: auto;\n  display: flex;\n  flex-direction: row;\n  background: #FDE7E9;\n  padding: 10px 0px; }\n\n.PermissionStageMessageIcon {\n  font-size: 16px;\n  line-height: 16px;\n  text-align: center;\n  color: #605E5C;\n  margin-left: 8px;\n  margin-right: 8px; }\n\n.PermissionStageMessageIcon_Error {\n  font-size: 16px;\n  line-height: 16px;\n  text-align: center;\n  color: #A80000;\n  margin-left: 8px;\n  margin-right: 8px; }\n\n.PermissionStageMessageText {\n  font-family: Segoe UI;\n  font-size: 12px;\n  line-height: 16px;\n  color: #323130;\n  margin-right: 32px; }\n",""])},1338:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(25);n(1339);var l=function(e){function t(t){var n=e.call(this,t)||this;return n.picker=a.default.createRef(),n.onFilterChanged=function(e,t){return e?n.props.itemSet.filter((function(t){return 0===t.itemName.toLowerCase().indexOf(e.toLowerCase())})).map((function(e){return n.createDisplayItem(e)})).filter((function(e){return t&&-1==t.findIndex((function(t){return t.secondaryText==e.secondaryText}))})):[]},n.onItemSelected=function(e){return n.picker.current&&null!=e?n.isItemAlreadySelected(e,n.picker.current.items)?null:(n.props.onItemSelected(e.secondaryText),e):null},n.state={},n}return o(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.ListPeoplePicker,{componentRef:this.picker,onResolveSuggestions:this.onFilterChanged.bind(this),onItemSelected:this.onItemSelected.bind(this),getTextFromItem:this.getTextFromItem.bind(this),pickerSuggestionsProps:{noResultsFoundText:this.props.noItemsText},itemLimit:this.props.selectedItemLimit?this.props.selectedItemLimit:void 0,disabled:this.props.isDisabled,inputProps:{placeholder:this.props.placeholder&&0==this.props.isDisabled?this.props.placeholder:void 0},onEmptyInputFocus:this.getDisplayItems.bind(this),defaultSelectedItems:this.getDefaultSelectedItems(),onRenderItem:this.renderItem.bind(this)}))},t.prototype.getDisplayItems=function(e){var t=this;return this.props.itemSet.map((function(e){return t.createDisplayItem(e)})).filter((function(t){return e&&-1==e.findIndex((function(e){return e.secondaryText==t.secondaryText}))}))},t.prototype.isItemAlreadySelected=function(e,t){return!(!t||!t.length||0===t.length)&&t.filter((function(t){return t.secondaryText===e.secondaryText})).length>0},t.prototype.getDefaultSelectedItems=function(){var e=this,t=[];return this.props.selectedItems.forEach((function(n){var r=e.props.itemSet.find((function(e){return n==e.itemValue}));r&&t.push(e.createDisplayItem(r))})),t},t.prototype.createDisplayItem=function(e){return{text:e.itemName,secondaryText:e.itemValue,showSecondaryText:!1,removeItemHandler:this.removeItemHandler}},t.prototype.removeItemHandler=function(e,t){e(),this.props.onItemUnselected(t)},t.prototype.getTextFromItem=function(e){return void 0!==e.text?e.text:""},t.prototype.renderItem=function(e){return a.default.createElement("div",{className:"selectedItemContainerDiv",role:"listitem","data-is-focusable":"true","data-is-sub-focuszone":"true","data-selection-index":"0"},a.default.createElement("div",null,a.default.createElement(s.IconButton,{className:"removeSelectedItemButton",iconProps:{iconName:"ChromeClose"},title:this.props.removeButtonTooltipText.trimEnd()+" "+e.item.text,onClick:e.item.removeItemHandler.bind(this,e.onRemoveItem,e.item.secondaryText),"data-is-focusable":"true",style:{color:"#A19F9D"}})),a.default.createElement("div",{className:"selectedItemIcon"},a.default.createElement("img",{className:"selectedItemIconImage",src:this.props.itemIconUrl,"aria-hidden":!0})),a.default.createElement("div",{className:"selectedItemText","aria-hidden":!0},e.item.text))},t}(a.default.Component);t.default=l},1339:function(e,t,n){var r=n(1340);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1340:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,'.selectedItemContainerDiv {\n  display: flex;\n  margin-bottom: 5px; }\n\n.selectedItemIcon {\n  font-size: 16px;\n  margin-top: 5px;\n  margin-left: 16px;\n  background-color: #8764B8;\n  border-radius: 50%;\n  width: 24px;\n  height: 24px; }\n\n.selectedItemIconImage {\n  margin-top: 6px;\n  margin-left: 6px;\n  width: 12px;\n  height: 12px; }\n\n.selectedItemText {\n  font-family: "Segoe UI";\n  line-height: 20px;\n  font-size: 14px;\n  letter-spacing: 0.005em;\n  text-align: center;\n  color: #323130;\n  margin-top: 8px;\n  margin-left: 8px; }\n',""])},1341:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),l=n(53),c=n(1342),u=n(1343),d=n(26),p=n(354),_=n(1344),f=n(1350),E=n(25),m=a(n(1351)),S=n(1354);n(1355);var g=n(184),C=n(11),I=n(12),h=n(682),T=n(1357),y=n(412),F=n(17);l.initializeIcons();var O=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.gridEventsHandler.RefreshGrid().then((function(t){e.props.fdNotificationEventHandler.ValidateAndTriggerFDFetch(t)}))},t.prototype.render=function(){var e=this;return s.default.createElement("div",{className:"GridPageAppContainer"},this.renderFDNotification(),s.default.createElement("div",{className:"GridPageApp"},s.default.createElement("div",{className:"pageHeader"},s.default.createElement("span",{className:"GridPageTitle",role:"heading"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FORECAST_CONFIG_HEADING_GRIDPAGE)),s.default.createElement("br",null),s.default.createElement("span",{className:"GridPageDescription"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FORECAST_CONFIG_SUBHEADING_GRIDPAGE))),s.default.createElement("span",{className:"CreateForecastsButtonsHeaderTitle"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FORECAST_CONFIG_TEMPLATE_HEADING_GRIDPAGE)),s.default.createElement(E.Stack,{horizontal:!0,tokens:{childrenGap:"0 16"},className:"CreateForecastButtonsContainer"},s.default.createElement(m.default,i({},i({},S.getGridPageTemplateButtonDefinition(F.ForecastConfigTemplateType.OrgChart),{clickHandler:function(){return e.forecastConfigTemplateClickHandler(F.ForecastConfigTemplateType.OrgChart)}}))),s.default.createElement(m.default,i({},i({},S.getGridPageTemplateButtonDefinition(F.ForecastConfigTemplateType.TerritoryBased),{clickHandler:function(){return e.forecastConfigTemplateClickHandler(F.ForecastConfigTemplateType.TerritoryBased)}}))),s.default.createElement(m.default,i({},S.getGridPageTemplateButtonDefinition(F.ForecastConfigTemplateType.ProductBased)))),s.default.createElement(f.ConnectedGridFilterSelector,null),s.default.createElement(_.ForecastConfigGrid,i({},{forecastConfigs:this.props.forecastConfigList,gridEventsHandler:this.props.gridEventsHandler,navigationHandlers:this.props.navigationHandler})),s.default.createElement(h.ConnectedForecastConfigGridConfirmationDialog,null),s.default.createElement(T.ConnectedForecastConfigPublishConfirmationDialog,null)))},t.prototype.renderFDNotification=function(){var e=this;if(this.props.showFDNotification){var t=C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_WARNING_READ_MORE),n=C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.FC_WARNING_FD_REMOVED_FC_ADDED);return n=n.replace(" {0}",""),s.default.createElement(y.MessageBar,{className:"fdNotification",messageBarType:y.MessageBarType.warning,onDismiss:function(){e.dismissFDNotification()}},n,s.default.createElement(E.Link,{href:"https://go.microsoft.com/fwlink/?linkid=2103790",target:"_blank"},t))}},t.prototype.dismissFDNotification=function(){this.props.fdNotificationEventHandler.HideNotifications()},t.prototype.forecastConfigTemplateClickHandler=function(e){this.props.navigationHandler.OpenCreatePage(e)},t}(s.default.Component);t.default=O;t.ConnectedGridApp=d.connect((function(e){return{forecastConfigList:p.GetFCList_FromState(e),showFDNotification:p.shouldShowFDNotification(e)}}),(function(e,t){return{gridEventsHandler:new c.GridEventsHandler(e,t.crmDataAccess.forecastConfigAccess),navigationHandler:g.NavigationHandlerFactory.GetNavigationHandlerObject(e),fdNotificationEventHandler:new u.FDNotificationEventHandler(e,t.crmDataAccess.forecastDefintionDataAccess)}}))(O)},1342:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(82),o=n(185),i=n(98),a=n(88),s=function(){function e(e,t){this.dispatch=e,this.dataAccess=t}return e.prototype.RefreshGrid=function(){var e=this;return new Promise((function(t){e.dataAccess.fetchForecastConfigList().then((function(n){e.dispatch(r.UpdateForecastConfigList(n)),t(n)})).catch((function(){e.dispatch(i.onErrorShowDialogActionCreator(a.IErrorDialogType.ForecastConfigFetchingFailed))}))}))},e.prototype.DeleteForecastConfig=function(e){this.dispatch(o.onRowSelectedActionCreator(e)),this.dispatch(o.onGridAppDialogDeleteStateActionCreator(!1))},e.prototype.PublishForecastConfig=function(e){this.dispatch(o.onRowSelectedActionCreator(e)),this.dispatch(o.onGridAppDialogPublishStateActionCreator(!1))},e}();t.GridEventsHandler=s},1343:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(243),o=n(243),i=n(17),a=function(){function e(e,t){this.dispatch=e,this.dataAccess=t}return e.prototype.HideNotifications=function(){this.dispatch(r.dismissFDNotification(!0))},e.prototype.ValidateAndTriggerFDFetch=function(e){var t=this,n=0;null!=e&&void 0!==e&&(n=e.filter((function(e){return e.status==i.IForecastConfigStatus.Published})).length),0==n&&this.dataAccess.getPublishedForecastDefinitionCount().then((function(e){t.dispatch(o.updateFDPresent(e>0))}),(function(){}))},e}();t.FDNotificationEventHandler=a},1344:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(409),l=n(1345);n(1347);var c=n(1349),u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.render=function(){var e=new s.DelfiGridProvider,t=e.getDelfiActions(),n=l.convertForecastConfigInfoToDelfiData(this.props.forecastConfigs),r=this.getForecastConfigLinkClickConfig();return t.updateGridInput(n),t.updateLinkConfig(r),t.updateContextMenuConfig(c.getForecastConfigContextMenuHandlers(this.props.gridEventsHandler,this.props.navigationHandlers,this.props.forecastConfigs),c.getForecastConfigContextMenuOptions()),a.default.createElement("div",{className:"configGrid"},e.render())},t.prototype.getForecastConfigLinkClickConfig=function(){var e=this;return{onClick:function(t){e.props.navigationHandlers.OpenEditPage(t)}}},t}(a.default.Component);t.ForecastConfigGrid=u,t.default=u},1345:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1346),o=n(11),i=n(12);t.convertForecastConfigInfoToDelfiData=function(e){for(var t=[],n=[],a=(new r.ForecastConfigGridDefinition).Columns,s=0;s<e.length;s++){for(var l={id:e[s].id,parentId:void 0,getDisplayFormattedValue:{},getEditValue:{},getIconUrl:{},getIconTooltip:{},getProgress:{},getStrikeValue:{},getUrlArgs:{}},c=0;c<a.length;c++){var u=a[c].id;a[c].displayTextProp?l.getDisplayFormattedValue[u]=""+e[s][u][a[c].displayTextProp]:l.getDisplayFormattedValue[u]=""+e[s][u],null!=a[c].urlArgProperty&&(l.getUrlArgs[u]=e[s][a[c].urlArgProperty])}t.push(l)}for(s=0;s<a.length;s++){var d={id:a[s].id,header:a[s].header,dataType:1,width:a[s].width,isEditable:!1,ishierarchial:!1,isLink:null!=a[s].urlArgProperty};n.push(d)}return{rows:t,columns:n,labels:{ariaLabelForGrid:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_GRID_ARIA_LABEL),contextMenuButton:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_MORE_COMMANDS)}}}},1346:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(11),i=function(){this.Columns=[{id:"name",header:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE),ariaLabel:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE),role:"presentation",type:"string",width:250,urlArgProperty:"id"},{id:"owner",displayTextProp:"displayName",header:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE),ariaLabel:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE),role:"presentation",type:"string",width:170},{id:"period",header:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE),ariaLabel:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE),role:"presentation",type:"string",width:170},{id:"fromDate",header:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FROM_GRIDPAGE),ariaLabel:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_FROM_GRIDPAGE),role:"presentation",type:"string",width:170},{id:"toDate",header:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_TO_GRIDPAGE),ariaLabel:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_TO_GRIDPAGE),role:"presentation",type:"string",width:170},{id:"statusDescription",header:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE),ariaLabel:o.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE),role:"presentation",type:"string",width:170}]};t.ForecastConfigGridDefinition=i},1347:function(e,t,n){var r=n(1348);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1348:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,'.configGrid {\n  height: 100%; }\n  .configGrid .ms-ScrollablePane--contentContainer {\n    overflow-y: visible !important; }\n  .configGrid .ms-List-page {\n    border-bottom: none !important; }\n    .configGrid .ms-List-page .ms-List-cell {\n      background: white !important; }\n    .configGrid .ms-List-page .ms-DetailsRow-cellCheck {\n      align-items: center !important;\n      display: flex !important; }\n    .configGrid .ms-List-page .ms-DetailsRow {\n      border-bottom: thin solid #E1DFDD !important; }\n      .configGrid .ms-List-page .ms-DetailsRow:hover {\n        box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1) !important;\n        z-index: 10; }\n      .configGrid .ms-List-page .ms-DetailsRow.is-selected {\n        background: #F3F2F1 !important; }\n      .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell {\n        border-left: none !important;\n        height: 60px !important;\n        padding-bottom: 0px !important; }\n        .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlCellDiv {\n          justify-content: flex-start !important;\n          font-size: 12px !important;\n          color: #323130 !important;\n          letter-spacing: 0.005em; }\n        .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .cellContextmenu {\n          margin-left: 12px !important;\n          align-items: flex-start !important;\n          font-size: 12px !important;\n          color: #605E5C !important;\n          letter-spacing: 0.02em; }\n        .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass {\n          color: #323130 !important;\n          text-decoration: none !important; }\n          .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .urlLinkClass:hover {\n            color: #2266E3 !important; }\n        .configGrid .ms-List-page .ms-DetailsRow .ms-DetailsRow-cell .selectedCell {\n          border-color: transparent !important; }\n  .configGrid .ms-DetailsHeader {\n    border: 0px !important;\n    border-bottom: thin solid #E1DFDD !important;\n    border-top: none !important;\n    padding-top: 0 !important; }\n    .configGrid .ms-DetailsHeader .ms-DetailsHeader-cell[aria-colindex="4"] {\n      background: white !important; }\n    .configGrid .ms-DetailsHeader .ms-DetailsHeader-cell {\n      border-left: none !important;\n      padding: 0px !important;\n      text-align: left !important;\n      font-size: 14px !important;\n      font-weight: 600 !important; }\n      .configGrid .ms-DetailsHeader .ms-DetailsHeader-cell:hover {\n        background-color: none !important; }\n      .configGrid .ms-DetailsHeader .ms-DetailsHeader-cell .ms-DetailsHeader-cellTitle {\n        text-align: left !important;\n        margin-top: 20px !important;\n        display: block;\n        color: #323130 !important;\n        letter-spacing: 0.02em; }\n  .configGrid .ms-CommandBar {\n    background: white !important;\n    border-bottom: thin solid #E1DFDD;\n    border-top: thin solid #E1DFDD; }\n  .configGrid .cellContextMenuIcon {\n    top: 10px !important;\n    bottom: 10px !important;\n    height: auto !important; }\n  .configGrid .cellContextMenuIcon:hover {\n    background-color: #F3F2F1; }\n  .configGrid .cellContextmenu {\n    background: #FFFFFF; }\n',""])},1349:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),o=n(11),i=n(12),a=1,s=4;t.getForecastConfigContextMenuOptions=function(){return{name:[{id:"OnEdit",title:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE),iconToolTip:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE),handlerName:"OnEdit",iconName:"Edit"},{id:"OnDelete",title:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE),iconToolTip:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE),handlerName:"OnDelete",iconName:"Delete"}]}},t.getForecastConfigContextMenuHandlers=function(e,t,n){return{OnEdit:function(e,n){r.logUsage("DelfiConfigGridApp.ContextMenu","Grid_App_ContextMenu_Button_Clicked",{ButtonName:"Edit",rowselected:e}),t.OpenEditPage(e)},OnPublish:function(t,n){e.PublishForecastConfig(t)},canRenderPublish:function(e,t){var r=function(e,t){var n=e&&e.filter((function(e){return e.id==t}));if(n&&n.length>0)return n[0].status}(n,e);return r&&[a,s].indexOf(r)>=0},OnDelete:function(t,n){e.DeleteForecastConfig(t)}}}},135:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.All=0]="All",e[e.Published=1]="Published",e[e.Drafts=2]="Drafts",e[e.Archived=3]="Archived"}(t.IForecastConfigFilterOptions||(t.IForecastConfigFilterOptions={})),function(e){e[e.CANCEL=0]="CANCEL",e[e.CLOSE=1]="CLOSE",e[e.DELETE=2]="DELETE"}(t.IDeleteDialogActionType||(t.IDeleteDialogActionType={})),function(e){e[e.CANCEL=0]="CANCEL",e[e.CLOSE=1]="CLOSE",e[e.PUBLISH=2]="PUBLISH"}(t.IPublishDialogActionType||(t.IPublishDialogActionType={})),t.GetInitialForecastConfigGridAppDialogState=function(){return{isGridDeleteDialogHidden:!0,isGridPublishDialogHidden:!0,gridActionableRow:""}}},1350:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(411),l=n(135),c=n(243),u=n(26),d=n(11),p=n(12),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return a.createElement("div",null,a.createElement(s.Pivot,{selectedKey:this.props.activeOptionKey.toString(),onLinkClick:this.onLinkClick.bind(this)},a.createElement(s.PivotItem,{headerText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_SELECTOR_ALL_GRIDPAGE),id:l.IForecastConfigFilterOptions.All.toString()}),a.createElement(s.PivotItem,{headerText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_SELECTOR_PUBLISHED_GRIDPAGE),id:l.IForecastConfigFilterOptions.Published.toString()}),a.createElement(s.PivotItem,{headerText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_GRID_SELECTOR_DRAFTS_GRIDPAGE),id:l.IForecastConfigFilterOptions.Drafts.toString()})))},t.prototype.onLinkClick=function(e){e&&e.props&&e.props.id&&this.props.onSelectorChangeEvent&&this.props.onSelectorChangeEvent(this.getForecastConfigFilterOption(e.props.id))},t.prototype.getForecastConfigFilterOption=function(e){switch(e){case"0":return l.IForecastConfigFilterOptions.All;case"1":return l.IForecastConfigFilterOptions.Published;case"2":return l.IForecastConfigFilterOptions.Drafts;default:return l.IForecastConfigFilterOptions.All}},t}(a.Component);t.GridFilterSelector=_,t.default=_,t.ConnectedGridFilterSelector=u.connect((function(e){return{activeOptionKey:e.gridFilterOption}}),(function(e){return{onSelectorChangeEvent:function(t){return e(c.onGridSelectorChangeActionCreator(t))}}}))(_)},1351:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0));n(1352);var s=n(22),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n.divRef=a.default.createRef(),n}return o(t,e),t.prototype.componentDidMount=function(){"Org"==this.props.iconName&&this.divRef.current.focus()},t.prototype.render=function(){var e=this;return a.default.createElement("div",{className:this.getTemplateContainerClass(),tabIndex:this.props.isEnabled?0:-1,onClick:function(){return e.buttonClickHandler()}},a.default.createElement("span",{className:this.getIconContainerClass(),ref:this.divRef},a.default.createElement(s.Icon,{iconName:this.props.iconName,className:"buttonIconClass"})),a.default.createElement("span",{className:this.getButtonTitleClass()},this.props.title),a.default.createElement("span",{className:"buttonDescriptionClass"},this.props.description))},t.prototype.buttonClickHandler=function(){this.props.isEnabled&&this.props.clickHandler&&this.props.clickHandler()},t.prototype.getTemplateContainerClass=function(){return this.props.isEnabled?"templateContainerClass":"templateContainerClass_disabled"},t.prototype.getIconContainerClass=function(){return this.props.isEnabled?"buttonIconContainerClass":"buttonIconContainerClass_disabled"},t.prototype.getButtonTitleClass=function(){return this.props.isEnabled?"buttonTitleClass":"buttonTitleClass_disabled"},t}(a.default.Component);t.ButtonTemplate=l,t.default=l},1352:function(e,t,n){var r=n(1353);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1353:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".templateContainerClass,\n.templateContainerClass_disabled {\n  margin-top: 10px;\n  margin-bottom: 10px;\n  border-radius: 3px;\n  height: 160px;\n  box-shadow: 0px 0.3px 0.9px rgba(0, 0, 0, 0.108), 0px 1.6px 3.6px rgba(0, 0, 0, 0.132);\n  display: flex;\n  flex-grow: 1;\n  flex-direction: column;\n  max-width: 400px; }\n\n.templateContainerClass:hover {\n  box-shadow: 0px 1.2px 3.6px rgba(0, 0, 0, 0.108), 0px 6.4px 14.4px rgba(0, 0, 0, 0.132);\n  cursor: pointer; }\n\n.buttonIconContainerClass {\n  height: 80px;\n  background-color: #4F6BED;\n  border-radius: 2px 2px 0px 0px; }\n\n.buttonIconContainerClass:focus {\n  outline: 1px solid #000000; }\n\n.buttonIconContainerClass_disabled {\n  height: 80px;\n  background-color: #aaa6a2;\n  border-radius: 2px 2px 0px 0px; }\n\n.buttonIconClass {\n  color: #FFFFFF;\n  padding-top: 25px;\n  padding-left: calc(50% - 30px/2 + 0.12px);\n  font-size: 30px; }\n\n.buttonTitleClass {\n  color: #323130;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  font-weight: 600;\n  text-align: center;\n  padding-top: 7px;\n  height: 19px;\n  text-overflow: ellipsis; }\n\n.buttonTitleClass_disabled {\n  color: #696969;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  font-weight: 600;\n  text-align: center;\n  padding-top: 7px;\n  height: 19px;\n  text-overflow: ellipsis;\n  cursor: default; }\n\n.buttonTitleClass:hover {\n  color: #2266E3; }\n\n.buttonDescriptionClass {\n  padding-top: 8px;\n  color: #605E5C;\n  font-family: 'Segoe UI';\n  font-size: 12px;\n  text-align: center;\n  height: 16px;\n  line-height: 14px;\n  text-overflow: ellipsis;\n  height: 16px; }\n",""])},1354:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(11),i=n(12);t.getGridPageTemplateButtonDefinition=function(e){switch(e){case r.ForecastConfigTemplateType.OrgChart:return{iconName:"Org",description:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_HIERARCHY_TEMPLATE_SUBHEADING_GRIDPAGE),title:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_HIERARCHY_TEMPLATE_HEADING_GRIDPAGE),isEnabled:!0};case r.ForecastConfigTemplateType.TerritoryBased:return{iconName:"Globe",description:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_TERRITORY_TEMPLATE_SUBHEADING_GRIDPAGE),title:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_TERRITORY_TEMPLATE_HEADING_GRIDPAGE),isEnabled:!0};case r.ForecastConfigTemplateType.ProductBased:return{iconName:"Product",description:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_PRODUCT_TEMPLATE_SUBHEADING_GRIDPAGE),title:o.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.FC_PRODUCT_TEMPLATE_HEADING_GRIDPAGE),isEnabled:!1};default:return{iconName:"",description:"",title:"",isEnabled:!1}}}},1355:function(e,t,n){var r=n(1356);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},1356:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".GridPageApp {\n  padding-left: 25px;\n  padding-right: 25px;\n  height: 100%;\n  display: flex;\n  flex-direction: column; }\n\n.CreateForecastButtonsContainer {\n  margin-top: 10px;\n  flex-flow: row wrap;\n  display: flex;\n  margin-bottom: 24px; }\n\n.CreateForecastsButtonsHeaderTitle {\n  font-family: 'Segoe UI';\n  font-size: 18px;\n  color: #323130;\n  line-height: 24px;\n  font-weight: 600; }\n\n.GridPageTitle {\n  font-family: 'Segoe UI';\n  font-size: 24px;\n  line-height: 28px;\n  color: #323130;\n  font-weight: 600; }\n\n.GridPageDescription {\n  font-family: 'Segoe UI';\n  font-size: 16px;\n  line-height: 22px;\n  color: #323130; }\n\n.pageHeader {\n  display: flex;\n  flex-direction: row;\n  margin-top: 32px;\n  margin-bottom: 32px;\n  display: flex;\n  flex-direction: column; }\n\n.forecastConfigIcon {\n  width: 18;\n  height: 18px;\n  border: 1px; }\n\n.createFromScratchButton {\n  display: flex;\n  justify-content: center;\n  align-content: center;\n  background: #2266E3;\n  border-radius: 2px;\n  height: 32px;\n  color: #ffffff;\n  font-size: 14px;\n  line-height: 19px;\n  width: 189px; }\n\n.createFromScratchButton:hover {\n  color: #ffffff;\n  background: #0B53CE; }\n\n.createFromScratchDiv {\n  display: flex;\n  flex-direction: row-reverse;\n  top: 64px;\n  bottom: 64px; }\n\n.fdNotification {\n  background: rgba(234, 179, 0, 0.459);\n  border-radius: 2px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center; }\n  .fdNotification .ms-MessageBar-innerText {\n    font-size: 14px;\n    font-family: 'Segoe UI'; }\n  .fdNotification .ms-Link {\n    font-size: 14px;\n    font-family: 'Segoe UI';\n    color: #2266E3;\n    cursor: pointer !important; }\n    .fdNotification .ms-Link:hover {\n      color: #0B53CE; }\n\n.GridPageAppContainer {\n  display: flex;\n  flex-direction: column;\n  height: 100%; }\n",""])},1357:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(25),l=n(135),c=n(26),u=n(185),d=n(11),p=n(12),_=function(e){function t(t){var n=e.call(this,t)||this;return n._closeDialog=function(){n.props.onClickPublishDialog(l.IPublishDialogActionType.CLOSE)},n._onClickConfirm=function(){n.props.onClickPublishDialog(l.IPublishDialogActionType.PUBLISH)},n._onCancel=function(){n.props.onClickPublishDialog(l.IPublishDialogActionType.CANCEL)},n.state={},n}return o(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._closeDialog,modalProps:{styles:{main:{outline:"1px solid transparent !important"}}},dialogContentProps:{type:s.DialogType.normal,title:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_PUBLISH_TITLE_GRIDPAGE),subText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_PUBLISH_DESCRIPTION_GRIDPAGE)}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickConfirm,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_PUBLISH_PRIMARYBUTTON_GRIDPAGE)}),a.default.createElement(s.DefaultButton,{onClick:this._onCancel,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE)}))))},t}(a.default.Component);t.ForecastConfigPublishConfirmationDialog=_,t.default=_,t.ConnectedForecastConfigPublishConfirmationDialog=c.connect((function(e){return{isHidden:e.gridAppDialogState.isGridPublishDialogHidden,rowId:e.gridAppDialogState.gridActionableRow}}),(function(e){return{onClickPublishDialog:function(t){return e(u.onClickPublishDialogActionCreator(t))}}}))(_)},1358:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(25),l=n(26),c=n(11),u=n(12),d=n(45),p=n(98),_=function(e){function t(t){var n=e.call(this,t)||this;return n._onClickOK=function(){n.props.onClickOk()},n.state={},n}return o(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._onClickOK,modalProps:{styles:{main:{outline:"1px solid transparent !important"}}},dialogContentProps:{type:s.DialogType.normal,title:d.ForecastingBusinessLogicProvider.getTitleForGenericErrorDialog(this.props.dialogType),subText:this.getDialogMessage()}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickOK,text:c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_OK)}))))},t.prototype.getDialogMessage=function(){return this.props.message||d.ForecastingBusinessLogicProvider.getDescriptionForGenericErrorDialog(this.props.dialogType)},t}(a.default.Component);t.ForecastConfigGenericErrorDialog=_,t.default=_,t.ConnectedForecastConfigGenericErrorDialog=l.connect((function(e){return{isHidden:e.genericErrorDialogState.isDialogHidden,dialogType:e.genericErrorDialogState.dialogType,message:e.genericErrorDialogState.customMessage}}),(function(e){return{onClickOk:function(){return e(p.onClickOkErrorDialogActionCreator())}}}))(_)},1359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=function(){function e(e){this.logLevel=e}return e.prototype.logCategory=function(e,t,n,o){switch(e){case r.ILogLevel.Info:return void console.info("DelfiLogger: "+t+" - "+n+" - "+JSON.stringify(o,null,2));case r.ILogLevel.Error:return void console.error("DelfiLogger: "+t+" - "+n+" - "+JSON.stringify(o,null,2));case r.ILogLevel.Warning:return void console.warn("DelfiLogger: "+t+" - "+n+" - "+JSON.stringify(o,null,2));default:return void console.log("DelfiLogger: "+t+" - "+n+" - "+JSON.stringify(o,null,2))}},e.prototype.logError=function(e,t,n,r){},e}();t.ConsoleLogger=o},136:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Unknown=0]="Unknown",e[e.Identifier=1]="Identifier",e[e.Number=2]="Number",e[e.Plus=3]="Plus",e[e.Minus=4]="Minus",e[e.Multiple=5]="Multiple",e[e.Divide=6]="Divide",e[e.LeftParenthesis=7]="LeftParenthesis",e[e.RightParenthesis=8]="RightParenthesis"}(t.TokenType||(t.TokenType={}))},144:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateCrmClientUrlAndOrgId=function(e,t){return{type:"@@CrmOrgInfo/UpdateClientUrlAndOrgId",payload:{url:e,orgId:t}}},t.UpdateOrgFiscalCalenderStartDate=function(e){return{type:"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate",payload:{fiscalStartDate:e}}},t.TriggerFetchOrgFiscalCalenderStart=function(){return{type:"@@CrmOrgInfo/TriggerFetchOrgFiscalCalenderStartDate",payload:{}}},t.TriggerUpdateSIPackageStatus=function(){return{type:"@@CrmOrgInfo/TriggerUpdateSIPackageStatus",payload:{}}},t.UpdateSIPackageStatus=function(e){return{type:"@@CrmOrgInfo/UpdateSIPackageStatus",payload:{isInstalled:e}}},t.SetEntityMetadata=function(e,t){var n;return{type:"@@Metadata/SetEntityMetadata",payload:{value:(n={},n[e]=t,n)}}}},17:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Enabled=0]="Enabled",e[e.Disabled=1]="Disabled",e[e.Locked=2]="Locked",e[e.Incomplete=3]="Incomplete",e[e.DuplicateUniqueName=4]="DuplicateUniqueName"}(t.ForecastColumnStatus||(t.ForecastColumnStatus={})),function(e){e[e.Rollup=0]="Rollup",e[e.Calculated=1]="Calculated",e[e.Quota=2]="Quota",e[e.Predictive=3]="Predictive",e[e.HierarchyPrimary=4]="HierarchyPrimary",e[e.HierarchySecondary=5]="HierarchySecondary"}(t.ForecastColumnType||(t.ForecastColumnType={})),function(e){e[e.FcbOff=0]="FcbOff",e[e.FcbOn=1]="FcbOn",e[e.LicenseActive=2]="LicenseActive",e[e.LicenceInGracePeriod=3]="LicenceInGracePeriod",e[e.LicesnseExpired=4]="LicesnseExpired"}(t.PredictiveAvailabilityStateType||(t.PredictiveAvailabilityStateType={})),function(e){e[e.Draft=1]="Draft",e[e.Processing=2]="Processing",e[e.Published=3]="Published",e[e.Failed=4]="Failed",e[e.Archived=5]="Archived"}(t.IForecastConfigStatus||(t.IForecastConfigStatus={})),function(e){e[e.OrgChart=1]="OrgChart",e[e.TerritoryBased=2]="TerritoryBased",e[e.ProductBased=3]="ProductBased"}(t.ForecastConfigTemplateType||(t.ForecastConfigTemplateType={})),function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Usage=3]="Usage",e[e.Error=4]="Error"}(t.ILogLevel||(t.ILogLevel={})),function(e){e[e.NOTIFY_RECOMPUTE_STATUS_EVENTS=0]="NOTIFY_RECOMPUTE_STATUS_EVENTS",e[e.NOTIFY_FC_PUBLISH_EVENTS=1]="NOTIFY_FC_PUBLISH_EVENTS",e[e.NOTIFY_QUOTA_UPLOAD_EVENTS=2]="NOTIFY_QUOTA_UPLOAD_EVENTS",e[e.NOTIFY_MANUAL_ADJUSTMENT_EVENTS=3]="NOTIFY_MANUAL_ADJUSTMENT_EVENTS"}(t.NotificationEventType||(t.NotificationEventType={})),function(e){e[e.INFORMATION=0]="INFORMATION",e[e.WARNING=1]="WARNING",e[e.ERROR=2]="ERROR"}(t.NotificationMessageType||(t.NotificationMessageType={})),function(e){e[e.All=1]="All",e[e.User=2]="User",e[e.Role=3]="Role"}(t.PermissionType||(t.PermissionType={}))},174:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.GridPage=0]="GridPage",e[e.EditPage=1]="EditPage"}(t.IMainPageType||(t.IMainPageType={}))},184:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(241),o=n(899),i=n(541),a=function(){function e(){}return e.GetNavigationHandlerObject=function(e){return r.CrmNavigationHelpers.isCrmUrlNavigationEnabled()?new o.CrmNavigationHandler:new i.ReduxNavigationHandler(e)},e}();t.NavigationHandlerFactory=a},185:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onRowSelectedActionCreator=function(e){return{type:"@@GridApp/ROW_SELECTED",payload:{rowSelected:e}}},t.onGridAppDialogDeleteStateActionCreator=function(e){return{type:"@@GridApp/ON_UPDATE_DIALOG_DELETE_STATE",payload:{gridAppDeletedialogHiddenState:e}}},t.onGridAppDialogPublishStateActionCreator=function(e){return{type:"@@GridApp/ON_UPDATE_DIALOG_PUBLISH_STATE",payload:{gridAppPublishedialogHiddenState:e}}},t.onClickDeleteDialogActionCreator=function(e){return{type:"@@GridApp/ON_DELETE_CONFIRM_DIALOG_CLICK",payload:{dialogActionClicked:e}}},t.onClickPublishDialogActionCreator=function(e){return{type:"@@GridApp/ON_PUBLISH_CONFIRM_DIALOG_CLICK",payload:{dialogActionClicked:e}}}},223:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Uploaded=1]="Uploaded",e[e.InProgress=2]="InProgress",e[e.Success=3]="Success",e[e.Failed=4]="Failed",e[e.New=5]="New",e[e.Uploading=6]="Uploading"}(t.QuotaStatus||(t.QuotaStatus={})),t.ERROR_CODES={FETCH_FAILED:"FETCH_FAILED",UPLOAD_FAILED:"UPLOAD_FAILED",GUID_TAMPERED:"GUID_TAMPERED",INVALID_ROWS:"INVALID_ROWS",INVALID_CONTENT:"INVALID_CONTENT",INVALID_FILE:"INVALID_FILE",INVALID_SIZE:"INVALID_SIZE",INVALID_FORECASTCONFIGURATION:"INVALID_FORECASTCONFIGURATION"},t.MAX_UPLOAD_FILESIZE_MB=20,t.MAX_UPLOAD_FILESIZE_BYTES=20971520},227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(457),o=n(329),i=n(45),a=n(108),s=n(109),l=n(231);function c(e){return e.stepperActiveStage}function u(e,t){var n=i.ForecastingBusinessLogicProvider.getForecastConfigFieldsForStage(t),r=p(e.FormFieldData,n);return t==a.ForecastConfigStage.View?r=r&&d(e)&&!s.AreUniqueNamesDuplicateInFC(e)&&s.AreUniqueNamesProperInFC(e):t==a.ForecastConfigStage.Permission&&(r=r&&l.arePermissionsConfigured(e)),r}function d(e){var t=!0;return e.FormFieldData.columns.map((function(e){t=t&&i.ForecastingBusinessLogicProvider.AreRequiredFieldsFilledForColumnInfo(e)})),t}function p(e,t){var n=!0;return Object.keys(e).map((function(r){var o=e[r];i.ForecastingBusinessLogicProvider.IsFieldPresentInStageForm(r,t)&&i.ForecastingBusinessLogicProvider.IsRequiredField(r)&&!i.ForecastingBusinessLogicProvider.FieldHasNonNullValue(r,o)&&(n=!1)})),n}function _(e,t){return{state:t,stepId:i.ForecastingBusinessLogicProvider.GetStageStepId(e),title:i.ForecastingBusinessLogicProvider.GetStageTitleText(e),description:i.ForecastingBusinessLogicProvider.GetStageDecriptionText(e)}}t.getStageStateProps=function(e){var t=[],n=e.stepperActiveStage,o=u(e,n),s=r.IDelphiState.Current;n!=a.ForecastConfigStage.Quota&&(s=o?r.IDelphiState.CurrentCompleted:r.IDelphiState.Current);var l=_(n,s);return t[i.ForecastingBusinessLogicProvider.getIndexOfStage(n)]=l,function(e,t){var n=i.ForecastingBusinessLogicProvider.isFirstStageofOrderedStepperStages(t)?t:i.ForecastingBusinessLogicProvider.getPreviousStage(t);for(;n!=t;){var o=_(n,r.IDelphiState.Completed);e[i.ForecastingBusinessLogicProvider.getIndexOfStage(n)]=o,t=n,n=i.ForecastingBusinessLogicProvider.isFirstStageofOrderedStepperStages(t)?t:i.ForecastingBusinessLogicProvider.getPreviousStage(t)}}(t,n),function(e,t,n,o){var s=i.ForecastingBusinessLogicProvider.isLastStageofOrderedStepperStages(n)?n:i.ForecastingBusinessLogicProvider.getNextStage(n);for(;s!=n;){var l=void 0,c=u(e,s);l=c&&s!=a.ForecastConfigStage.Quota?r.IDelphiState.Completed:o==r.IDelphiState.Completed||o==r.IDelphiState.CurrentCompleted?r.IDelphiState.Enabled:r.IDelphiState.Disabled;var d=_(s,l);t[i.ForecastingBusinessLogicProvider.getIndexOfStage(s)]=d,n=s,o=l,s=i.ForecastingBusinessLogicProvider.isLastStageofOrderedStepperStages(n)?n:i.ForecastingBusinessLogicProvider.getNextStage(n)}}(e,t,n,s),t},t.getActiveStepperStage=c,t.AreRequiredFieldsForCurrentStageFilled=function(e){return u(e,c(e))},t.GetHasRequiredFieldsFilled_ForStage_FromState=u,t.AreRequiredFieldsForAllColumnsFilled=d,t.GetHasRequiredFieldsFilled_ForStage=p,t.getStageInfo=_,t.getBackButtonState=function(e){var t=e.stepperActiveStage;return(i.ForecastingBusinessLogicProvider.isFirstStageofOrderedStepperStages(t)?t:i.ForecastingBusinessLogicProvider.getPreviousStage(t))!=t?o.IStepperButtonState.Enabled:o.IStepperButtonState.Hide},t.getNextButtonState=function(e){return u(e,e.stepperActiveStage)?o.IStepperButtonState.Enabled:o.IStepperButtonState.Disabled}},228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(229),o=n(230),i=function(){function e(){}return e.validateNullArgument=function(e,t){if(null==e)throw new Error(r.StringFormatter.formatString(o.ValidationErrors.NullOrUndefinedArgument,t))},e}();t.Validations=i},229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.formatString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))},e}();t.StringFormatter=r},230:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.InvalidCharacter="Invalid character '{0}' at position '{1}'.",e.InvalidColumnRef="The formula contains invalid column reference - '{0}' at position '{1}'.",e.InvalidColumnType="The column reference - '{0}' at position '{1}' of type '{2}' can't be used in the formula.",e.MissingOperand="The formula is invalid. You are possibly missing an operand.",e.MissingRightParenthesis="Missing matching right parenthesis.",e.UnexpectedTokens="The formula contains '{0}' at position '{1}', which is unexpected.",e.SelfReference="The formula is invalid. It contains column reference to the current column.",e.CircularDependency="The formula is invalid. The column reference - {0} results in a circular dependency.",e}();t.ExpressionParseErrors=r;var o=function(){function e(){}return e.NullOrUndefinedArgument="The argument '{0}' can't be null or undefined.",e.NullOrEmptyArgument="The argument '{0}' can't be null or empty.",e}();t.ValidationErrors=o},231:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(325),i=n(45),a=n(110),s=n(11),l=n(12);function c(e,t){var n=!1;if(null!=t.FormFieldData.permissionsData&&t.FormFieldData.permissionsData.permissionTypes.indexOf(e)>=0)switch(e){case r.PermissionType.Role:null!=t.FormFieldData.permissionsData.permissionRoles&&t.FormFieldData.permissionsData.permissionRoles.length>0&&(n=!0);break;case r.PermissionType.User:null!=t.FormFieldData.permissionsData.permissionAttribueInfo&&(n=!0);break;case r.PermissionType.All:n=!0}return n}function u(e){return c(r.PermissionType.User,e)||c(r.PermissionType.Role,e)||c(r.PermissionType.All,e)}function d(e){return e&&null!=e.find((function(e){return e.isPermissionsColumn&&1==e.isPermissionsColumn}))}t.None_Option_Key="-1",t.getSelectedPermissionAttribute_FromState=function(e){return c(r.PermissionType.User,e)?e.FormFieldData.permissionsData.permissionAttribueInfo.attributeName:t.None_Option_Key},t.getSelectedPermissionRoles_FromState=function(e){var t=[];return null!=e.FormFieldData.permissionsData&&null!=e.FormFieldData.permissionsData.permissionRoles&&(t=e.FormFieldData.permissionsData.permissionRoles.map((function(e){return e.roleId}))),t},t.IsPermissionTypeConfigured_FromState=c,t.isRoleBasedPermissionTypeOptionSelectedFromState=function(e){return null!=e.FormFieldData.permissionsData&&e.FormFieldData.permissionsData.permissionTypes.indexOf(r.PermissionType.Role)>=0},t.getPermissionAttributeByTemplateType=function(e){return null!=o.forecastConfigTemplates[e]&&null!=o.forecastConfigTemplates[e].permissionsData.permissionAttribueInfo?o.forecastConfigTemplates[e].permissionsData.permissionAttribueInfo.attributeName:""},t.getPermissionAttributeControlDisabledState=function(e){return e.FormFieldData.id.length>0&&i.ForecastingBusinessLogicProvider.IsFormStatusReadOnly(e.FormFieldData.status)},t.getSuggestionListForRolesListFromState=function(e){return a.getRolesFromState(e).map((function(e){return{itemValue:e.roleId,itemName:e.roleName}})).sort((function(e,t){return e.itemName.localeCompare(t.itemName)}))},t.getAdditionalForecastViewingPermissionOptions=function(){return[{key:t.None_Option_Key,text:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_NONE)},{key:r.PermissionType.All.toString(),text:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_ALLOWALL)},{key:r.PermissionType.Role.toString(),text:s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PERMISSIONS_SPECIFIC_ROLES)}]},t.getAdditionalViewingPermissionType_FromState=function(e){return c(r.PermissionType.All,e)?r.PermissionType.All:c(r.PermissionType.Role,e)?r.PermissionType.Role:null},t.arePermissionsConfigured=u,t.getPermissionStageInfoErrorMessage=function(e){if(!u(e))return s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MANDATORY_ERROR_MESSAGE);var t=c(r.PermissionType.User,e),n=c(r.PermissionType.Role,e),o=c(r.PermissionType.All,e);return t?o?s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_AND_ALLOW_ALL):n?s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_AND_ROLE):s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_ONLY):o?s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_ALLOW_ALL_ONLY):n?s.GlobalLocalizedStringsProvider.GetString(l.STRING_KEYS.FC_PERMISSIONS_MESSAGE_ROLE_ONLY):""},t.doesPermissionColumnExist=d,t.getPermissionsColumnId=function(e){return d(e.FormFieldData.columns)?e.FormFieldData.columns.find((function(e){return 1==e.isPermissionsColumn})).id:null}},240:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(12);function i(e){var t=window.Xrm;t&&t.Utility.showProgressIndicator(e)}function a(){var e=window.Xrm;e&&e.Utility.closeProgressIndicator()}t.showOrHideCrmLoaading=function(e,t){void 0===t&&(t=r.GlobalLocalizedStringsProvider.GetString(o.STRING_KEYS.FC_CRM_PROCESSING_CALLS)),e?i(t):a()},t.showCrmLoading=i,t.hideCrmLoading=a},241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.isCrmUrlNavigationEnabled=function(){return null!=window.Xrm},e.navigateWithParams=function(e){var t={pageType:"control",controlName:"ForecastingControls.FieldControls.CCFForecastConfig",data:e};window.Xrm.Navigation.navigateTo(t)},e.navigateToEntityForm=function(t,n){if(e.isCrmUrlNavigationEnabled){var r={pageType:"entityrecord",entityName:t,entityId:n};window.Xrm.Navigation.navigateTo(r)}},e}();t.CrmNavigationHelpers=r},242:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45);t.onStepClickActionCreator=function(e){return{type:"@@EditApp/ON_STEP_CLICK",payload:{activeStage:r.ForecastingBusinessLogicProvider.getStageFromStepId(e)}}},t.onButtonClickActionCreator=function(e){return{type:"@@EditApp/ON_STEPPER_BUTTON_CLICK",payload:{buttonTypeClicked:e}}}},243:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onGridSelectorChangeActionCreator=function(e){return{type:"@@GridApp/ON_GRID_SELECTOR_CHANGE",payload:{selectedvalue:e}}},t.changeMainPageType=function(e){return{type:"@@mainPage/ChangeType",payload:{newType:e}}},t.updateFDPresent=function(e){return{type:"@@delfiConfig/UpdateFDPresent",payload:{fdPresent:e}}},t.dismissFDNotification=function(e){return{type:"@@delfiConfig/DismissFDNotification",payload:{dismiss:e}}}},244:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdatePermissionsData=function(e){return{type:"@@PermissionsData/UpdatePermissionData",payload:{permissionsData:e}}},t.UpdatePermissionsAttribute=function(e){return{type:"@@PermissionsData/UpdatePermissionsAttribute",payload:{attributeName:e}}},t.AddPermissionRole=function(e){return{type:"@@PermissionsData/AddPermissionsRoleAction",payload:{roleId:e}}},t.DeletePermissionRole=function(e){return{type:"@@PermissionsData/DeletePermissionsRoleAction",payload:{roleId:e}}},t.SetAdditionalViewingPermissionType=function(e){return{type:"@@PermissionsData/SetAdditionalViewingPermissionTypeAction",payload:{type:e}}},t.TriggerFetchSecurityRolesList=function(){return{type:"@@OrgSecurityRoles/TriggerFetchSecurityRoles",payload:{}}},t.SetSecurityRolesListInState=function(e){return{type:"@@OrgSecurityRoles/SetSecurityRolesInState",payload:{roles:e}}}},245:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClearPreviewGridHierarchyData=function(){return{type:"@@PreviewGrid/ClearGridHierarchyData",payload:{}}},t.AddPreviewGridHierarchyData=function(e){return{type:"@@PreviewGrid/AddGridHierarchyData",payload:{forecastHierarchyList:e}}},t.ReorderColumn=function(e,t,n){return void 0===n&&(n=!1),{type:"@@PreviewGrid/Reorder",payload:{dragIndex:e,targetIndex:t,areIndicesActual:n}}},t.ReorderColumnsWithId=function(e,t){return{type:"@@PreviewGrid/ReorderColumnsWithId",payload:{dragColId:e,targetColId:t}}}},324:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateNewGuid=function(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}},325:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17);t.forecastConfigTemplates={1:{templateType:r.ForecastConfigTemplateType.OrgChart,rollupEntity:"opportunity",hierarchyEntity:"systemuser",hierarchyRelationship:{entityName:"opportunity",linkedByAttribute:null,relationship:{entityName:"systemuser",linkedByAttribute:"ownerid",relationship:null}},permissionsData:{permissionTypes:[r.PermissionType.User],permissionAttribueInfo:{attributeName:"systemuserid",relationship:{entityName:"systemuser",linkedByAttribute:null,relationship:null}},permissionRoles:null}},2:{templateType:r.ForecastConfigTemplateType.TerritoryBased,rollupEntity:"opportunity",hierarchyEntity:"territory",hierarchyRelationship:{entityName:"opportunity",linkedByAttribute:null,relationship:{entityName:"account",linkedByAttribute:"parentaccountid",relationship:{entityName:"territory",linkedByAttribute:"territoryid",relationship:null}}},permissionsData:{permissionTypes:[r.PermissionType.User],permissionAttribueInfo:{attributeName:"managerid",relationship:{entityName:"territory",linkedByAttribute:null,relationship:null}},permissionRoles:null}}}},329:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Hide=0]="Hide",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(t.IStepperButtonState||(t.IStepperButtonState={})),function(e){e[e.BACK=0]="BACK",e[e.NEXT=1]="NEXT"}(t.IStepperButton||(t.IStepperButton={}))},330:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(721),o=n(725),i=function(){function e(){}return e.getCalculatedFieldExpressionParser=function(){return new r.ExpressionParser},e}();t.ExpressionParserFactory=i;var a=function(){function e(){}return e.getSuggestionProvier=function(){return new o.SuggestionsProvider},e}();t.SuggestionProviderFactory=a},331:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){var r=e.call(this,t)||this;return r.errorPosition=n,r}return o(t,e),t}(Error);t.ParseError=i},351:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i,a,s=n(137),l=n(47),c=n(888);!function(e){e.OneToMany="OneToManyRelationship",e.ManyToOne="ManyToOneRelationship"}(i=t.RelationshipType||(t.RelationshipType={})),function(e){e.String="String",e.MultilineText="Memo",e.WholeNumber="Integer_None",e.Date="DateTime",e.OptionSet="Picklist",e.MultiOptionSet="MultiSelectPicklistType",e.TwoOptions="Boolean",e.Lookup="Lookup",e.Customer="Customer",e.Owner="Owner",e.Currency="Money",e.Float="Double",e.Decimal="Decimal",e.Language="Integer_Language",e.UniqueIdentifier="UniqueIdentifier",e.Duration="Integer_Duration"}(a=t.EDataType||(t.EDataType={})),t.getCDSResolver=function(e,t,n){return void 0===n&&(n="9.0"),new u(s.createCDSClient(e,void 0))};var u=function(){function e(e){this.cdsClient=e,this.dependentEntities={},this.orgLanguages=void 0,this.resolvedFields={},this.resolvedFieldsMetadata={},this.resolvedRelatedEntities={},this.resolvedOptionSetMembers={},this.resolvedEntityViews={},this.rawdependentEntities={}}return e.prototype.fetchDependentEntityMetadata=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return void 0===this.dependentEntities[e]&&(this.dependentEntities[e]=this.cdsClient.then((function(t){return t.fetchEntityAndRelatedEntityMetadata({entityName:e})}))),[2,this.dependentEntities[e]]}))}))},e.prototype.resolveFields=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return void 0===this.resolvedFields[e.name]&&(this.resolvedFields[e.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var t=[];e&&(e.AttributesMetadata.DependentAttributes.forEach((function(e){var n={name:e.LogicalName,displayName:e.DisplayName,metadataId:e.AttributeId,format:e.AttributeFormatType,maxValue:e.MaxValue,minValue:e.MinValue,precision:e.Precision,targets:e.Targets,maxLength:e.MaxLength,dataType:d(e)};t.push(n)})),t=t.sort((function(e,t){return e.displayName.localeCompare(t.displayName)})));return t}))),[2,this.resolvedFields[e.name]]}))}))},e.prototype.resolveRelatedEntities=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return void 0===this.resolvedRelatedEntities[e.name]&&(this.resolvedRelatedEntities[e.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var t=[];if(e){var n=e.EntityRelationshipCollection.DependentRelationships,r=e.DependantEntitiesCollection.DependantEntities;n.filter((function(e){return e.EntityRelationshipType!==l.RelationshipTypeExt.ManyToManyRelationship})).forEach((function(n){var o=r.find((function(e){return e.LogicalName===n.RelationshipEntity}));if(o){var a={name:o.LogicalName,displayName:o.DisplayName,metadataId:o.EntityId,primaryIdField:o.PrimaryIdAttribute,primaryNameField:o.PrimaryNameAttribute},s=n.EntityRelationshipType===l.RelationshipTypeExt.ManyToOneRelationship?e.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName===n.ReferencingAttribute})):o.Attributes.DependentAttributes.find((function(e){return e.LogicalName===n.ReferencingAttribute})),c={referencedFieldName:n.ReferencedAttribute,referencingFieldName:n.ReferencingAttribute,displayName:s?s.DisplayName:n.ReferencingAttribute,isHierarchical:n.IsHierarchical,relationshipType:n.EntityRelationshipType===l.RelationshipTypeExt.OneToManyRelationship?i.OneToMany:i.ManyToOne};t.push([a,c])}})),t=t.sort((function(e,t){return e[0].displayName.localeCompare(t[0].displayName)}))}return t}))),[2,this.resolvedRelatedEntities[e.name]]}))}))},e.prototype.resolveOptionSetMembers=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){return void 0===this.resolvedOptionSetMembers[e.name+"-"+t.name]&&(this.resolvedOptionSetMembers[e.name+"-"+t.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var n=[];if(e){var r=e.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName===t.name}));r&&r.OptionSet&&(("Picklist"===r.OptionSet.Type||"State"===r.OptionSet.Type||"Status"===r.OptionSet.Type)&&r.OptionSet.Options&&r.OptionSet.Options.OptionList?r.OptionSet.Options.OptionList.forEach((function(e){n.push({displayName:e.Label,value:e.Value})})):"Boolean"===r.OptionSet.Type&&(r.OptionSet.TrueOption&&n.push({displayName:r.OptionSet.TrueOption.Label,value:r.OptionSet.TrueOption.Value}),r.OptionSet.FalseOption&&n.push({displayName:r.OptionSet.FalseOption.Label,value:r.OptionSet.FalseOption.Value}))),n=n.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))}return n}))),[2,this.resolvedOptionSetMembers[e.name+"-"+t.name]]}))}))},e.prototype.resolveLookupRecords=function(e,t,n){return r(this,void 0,void 0,(function(){return o(this,(function(e){throw new Error("working on it")}))}))},e.prototype.resolveLookupRecordsSimple=function(e,t,n){return r(this,void 0,void 0,(function(){var r,i,a,s,l,c,u;return o(this,(function(d){switch(d.label){case 0:return[4,this.fetchDependentEntityMetadata(e.name)];case 1:return r=d.sent(),i=[],[4,this.cdsClient];case 2:if(a=d.sent(),!(r&&t&&t.length>0))return[3,6];s=function(t){var s,l,c;return o(this,(function(o){switch(o.label){case 0:if(!(s=t===e.name?r:r.DependantEntitiesCollection.DependantEntities.find((function(e){return e.LogicalName===t}))))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),l=s.EntitySetName+"?$select="+s.PrimaryNameAttribute+","+s.PrimaryIdAttribute+"&$orderby="+s.PrimaryNameAttribute+" asc&$top=100",n&&n.searchString&&(l+="&$filter=contains("+s.PrimaryNameAttribute+",'"+n.searchString+"')"),[4,a.executeOperation(l,"GET",{},void 0,{scenarioName:"CDSResolver.ResolveLookupRecordsSimple"})];case 2:return(c=o.sent())&&c.value&&c.value.forEach((function(e){i.push({entityLogicalName:s.LogicalName,id:e[s.PrimaryIdAttribute],displayName:e[s.PrimaryNameAttribute]})})),[3,4];case 3:return o.sent(),[3,4];case 4:return[2]}}))},l=0,c=t,d.label=3;case 3:return l<c.length?(u=c[l],[5,s(u)]):[3,6];case 4:d.sent(),d.label=5;case 5:return l++,[3,3];case 6:return[2,i]}}))}))},e.prototype.resolveLookupRecordsById=function(e,t,n){return r(this,void 0,void 0,(function(){var r,i,a,s,l,c,u;return o(this,(function(d){switch(d.label){case 0:return[4,this.fetchDependentEntityMetadata(e.name)];case 1:return r=d.sent(),i=[],[4,this.cdsClient];case 2:if(a=d.sent(),!(r&&t&&t.length>0&&n&&n.length>0))return[3,6];s=function(t){var s,l,c,u;return o(this,(function(o){switch(o.label){case 0:if(!(s=t===e.name?r:r.DependantEntitiesCollection.DependantEntities.find((function(e){return e.LogicalName===t}))))return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),l="",n.forEach((function(e){l&&(l+=" or "),l+=s.PrimaryIdAttribute+" eq "+e})),c=s.EntitySetName+"?$select="+s.PrimaryNameAttribute+","+s.PrimaryIdAttribute+"&$filter=("+l+")",[4,a.executeOperation(c,"GET",{},void 0,{scenarioName:"CDSResolver.ResolveLookupRecordsById"})];case 2:return(u=o.sent())&&u.value&&u.value.forEach((function(e){i.push({entityLogicalName:s.LogicalName,entityDisplayName:s.DisplayName,id:e[s.PrimaryIdAttribute],displayName:e[s.PrimaryNameAttribute]})})),[3,4];case 3:return o.sent(),[3,4];case 4:return[2]}}))},l=0,c=t,d.label=3;case 3:return l<c.length?(u=c[l],[5,s(u)]):[3,6];case 4:d.sent(),d.label=5;case 5:return l++,[3,3];case 6:return[2,i]}}))}))},e.prototype.resolveEntityViews=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){if(void 0===this.resolvedEntityViews[e.name])try{this.resolvedEntityViews[e.name]=this.cdsClient.then((function(t){return t.fetchList("View",{entityId:e.metadataId,entityName:e.name,solutionName:""},void 0,{scenarioName:"CDSResolver.ResolveEntityViews"}).then((function(e){var t=[],n=e.data;return n.length>0&&(n.forEach((function(e){var n={name:e.name,isDefault:e.isdefault,savedQueryId:e.savedqueryid,queryType:e.querytype,columns:[]};t.push(n)})),t=t.sort((function(e,t){return e.name.localeCompare(t.name)}))),t}))}))}catch(e){}return[2,this.resolvedEntityViews[e.name]]}))}))},e.prototype.resolveOrganizationEnabledLanguages=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){if(void 0===this.orgLanguages)try{this.orgLanguages=this.cdsClient.then((function(e){return e.fetchOrganizationEnabledLanguages().then((function(e){var t=e;return t=t.sort((function(e,t){return e.label.localeCompare(t.label)}))}))}))}catch(e){}return[2,this.orgLanguages]}))}))},e.prototype.getLocalizedLabels=function(){return r(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:e={},t=[],Object.keys(c.AllLabelsMap).forEach((function(n){var r=n;c.AllLabelsMap[r].resourceIdentifier&&t.push(c.AllLabelsMap[r].resourceIdentifier),e[r]=c.AllLabelsMap[r].local})),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,this.cdsClient];case 2:return[4,(n=r.sent()).localizationService.fetchResourceStrings(t)];case 3:return r.sent(),Object.keys(c.AllLabelsMap).forEach((function(t){var r=t;c.AllLabelsMap[r].resourceIdentifier&&(e[r]=n.localizationService.getResourceString(c.AllLabelsMap[r].resourceIdentifier)||e[r])})),[3,5];case 4:return r.sent(),[3,5];case 5:return[2,e]}}))}))},e.prototype.resolveFieldsMetadata=function(e){return void 0===this.resolvedFieldsMetadata[e.name]&&(this.resolvedFieldsMetadata[e.name]=this.fetchRawEntityMetadata(e.name).then((function(e){var t=e.Attributes,n=[];return t.forEach((function(e){e.AttributeType=e.AttributeType+"Type";var t={name:e.LogicalName,displayName:e&&e.DisplayName&&e.DisplayName.UserLocalizedLabel&&e.DisplayName.UserLocalizedLabel.Label||e.LogicalName,metadataId:e.MetadataId,format:e.AttributeFormatType,maxValue:e.MaxValue,minValue:e.MinValue,precision:e.Precision,targets:e.Targets,maxLength:e.MaxLength,dataType:d(e),CalculationOf:e.CalculationOf};n.push(t)})),n=n.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))}))),this.resolvedFieldsMetadata[e.name]},e.prototype.fetchRawEntityMetadata=function(e){return void 0===this.rawdependentEntities[e]&&(this.rawdependentEntities[e]=this.cdsClient.then((function(t){var n="EntityDefinitions(LogicalName%20%3D%20'"+e+"')?%24select=MetadataId%2CIsCustomEntity%2CLogicalName%2CLogicalCollectionName%2CObjectTypeCode%2CDisplayName%2CPrimaryNameAttribute%2CPrimaryIdAttribute&%24expand=Attributes%2COneToManyRelationships(%24select%3DMetadataId%2CIsHierarchical%2CReferencedAttribute%2CReferencingAttribute)";return t.executeOperation(n,"GET",{}).then((function(e){return new Promise((function(t){t(e)}))}))}))),this.rawdependentEntities[e]},e}();function d(e){switch(e.AttributeType){case l.AttributeTypeCode.Memo+"Type":return a.MultilineText;case l.AttributeTypeCode.Integer+"Type":if(e.AttributeFormatType){if("Language"===e.AttributeFormatType)return a.Language;if("Duration"===e.AttributeFormatType)return a.Duration}return a.WholeNumber;case l.AttributeTypeCode.DateTime+"Type":return a.Date;case l.AttributeTypeCode.Picklist+"Type":case l.AttributeTypeCode.State+"Type":case l.AttributeTypeCode.Status+"Type":case l.AttributeTypeCode.EntityName+"Type":return a.OptionSet;case"MultiSelectPicklistType":return a.MultiOptionSet;case l.AttributeTypeCode.Boolean+"Type":return a.TwoOptions;case l.AttributeTypeCode.Lookup+"Type":return a.Lookup;case l.AttributeTypeCode.Customer+"Type":return a.Customer;case l.AttributeTypeCode.Owner+"Type":return a.Owner;case l.AttributeTypeCode.Money+"Type":return a.Currency;case l.AttributeTypeCode.Double+"Type":return a.Float;case l.AttributeTypeCode.Decimal+"Type":return a.Decimal;case l.AttributeTypeCode.Uniqueidentifier+"Type":return a.UniqueIdentifier;default:return a.String}}t.CDSResolver=u},352:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),o=function(){function e(){}return e.isXrmEnabled=function(){return null!=window.Xrm},e.getLoggedInUserInfo=function(){if(e.isXrmEnabled()){var t=window.Xrm.Utility.getGlobalContext().userSettings;return{entityLogicalName:"systemuser",displayName:t.userName,id:t.userId}}return r.getEmptyDataRecord()},e.isUserLanguageRTL=function(){return!!e.isXrmEnabled()&&window.Xrm.Utility.getGlobalContext().userSettings.isRTL},e}();t.XrmHelper=o},353:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(99),o=n(82),i=n(97),a=n(240),s=n(241),l=n(242),c=n(11),u=n(12),d=n(98),p=n(88),_=function(){function e(e,t){this.dispatch=e,this.dataAccess=t}return e.prototype.OnValueChange=function(e){this.dispatch(o.UpdateFieldValue(e))},e.prototype.RefreshForm=function(e){var t=this;return new Promise((function(n){if(t.dispatch(o.UpdateShowWarningsFlag(!1)),e.formType==r.FormType.EditForm&&e.formInput.fcId){var a=e.formInput.fcId;t.dataAccess.fetchForecastConfig(a).then((function(e){t.dispatch(o.UpdateActiveForecastConfig(e)),t.dispatch(o.UpdateFieldValue(e)),n(e),t.dispatch(o.TriggerFormRefreshed())})).catch((function(){t.dispatch(d.onErrorShowDialogActionCreator(p.IErrorDialogType.ForecastConfigFetchingFailed))}))}else if(e.formType==r.FormType.CreateForm){var s=e.formInput.templateType,l=i.GetEmptyForecastConfigInfo(s);t.dispatch(o.UpdateActiveForecastConfig(l)),t.dispatch(o.UpdateFieldValue(l)),n(l),t.dispatch(o.TriggerFormRefreshed())}else n(i.GetEmptyForecastConfigInfo()),t.dispatch(o.TriggerFormRefreshed())}))},e.prototype.UpdateStepperStage=function(e){this.dispatch(l.onStepClickActionCreator(e))},e.prototype.UpdateData=function(e,t,n,o){var i=this;if(a.showOrHideCrmLoaading(!0,c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_CRM_SAVING_CALLS)),e){var s=this.getDiff(t,n);this.dataAccess.updateForecastConfig(e,s).then((function(t){var n={formType:r.FormType.EditForm,formInput:{fcId:e}};i.RefreshForm(n).then((function(){a.showOrHideCrmLoaading(!1)}))})).catch((function(){a.showOrHideCrmLoaading(!1),i.dispatch(d.onErrorShowDialogActionCreator(p.IErrorDialogType.ForecastConfigUpdateFailed))}))}else this.dataAccess.createForecastConfig(t).then((function(e){var t={formType:r.FormType.EditForm,formInput:{fcId:e}};i.RefreshForm(t).then((function(){a.showOrHideCrmLoaading(!1),o||i.navigateCrmToEditPagePostCreation(e)}))})).catch((function(){i.dispatch(d.onErrorShowDialogActionCreator(p.IErrorDialogType.ForecastConfigCreateFailed))}))},e.prototype.navigateCrmToEditPagePostCreation=function(e){if(s.CrmNavigationHelpers.isCrmUrlNavigationEnabled()){var t={isEditMode:"true",id:e,isNew:"true"};s.CrmNavigationHelpers.navigateWithParams(t)}},e.prototype.getDiff=function(e,t){var n={};return Object.keys(e).map((function(r){e[r]!=t[r]&&(n[r]=e[r])})),n},e}();t.FormEventsHandler=_},354:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(135),i=n(11),a=n(12);function s(e,t){var n=e.filter((function(e){return e.status==t}));return n&&n.length>0?n:[]}t.GetFCList_FromState=function(e){switch(e.gridFilterOption){case o.IForecastConfigFilterOptions.All:return e.ForecastConfigList;case o.IForecastConfigFilterOptions.Drafts:return s(e.ForecastConfigList,r.IForecastConfigStatus.Draft);case o.IForecastConfigFilterOptions.Published:return s(e.ForecastConfigList,r.IForecastConfigStatus.Published);case o.IForecastConfigFilterOptions.Archived:return s(e.ForecastConfigList,r.IForecastConfigStatus.Archived);default:return e.ForecastConfigList}},t.shouldShowFDNotification=function(e){return!e.fdNotificationState.isDismissed&&0==e.ForecastConfigList.filter((function(e){return e.status==r.IForecastConfigStatus.Published})).length&&e.fdNotificationState.arePublishedFDsPresent},t.getlocalizedFCPublishErrorMessage=function(e){return"FCLimitExceeded"==e?i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_PUBLISH_FAILED_MORE_THAN_SIX):""}},355:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),l=a(n(356)),c=n(99),u=n(26),d=n(353),p=a(n(924)),_=n(64),f=a(n(1260)),E=a(n(1261)),m=a(n(1262)),S=a(n(674)),g=n(45),C=n(110),I=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.renderFormControl=function(e,t,n,r,o,a,u,d){void 0===a&&(a=!0),void 0===u&&(u=!1),u=u||this.props.isFormLocked;var _,C=this.generateCommonFormControlProps(e,t,n,r,a,u,o);switch(r){case c.ICrmAttributeType.OptionSet:_=s.default.createElement(S.default,i({},i({},C,d)));break;case c.ICrmAttributeType.EntityPicker:_=s.default.createElement(f.default,i({},C));break;case c.ICrmAttributeType.DatePicker:_=s.default.createElement(m.default,i({},C));break;case c.ICrmAttributeType.Lookup:var I=i({},C,{targetEntity:n});_=s.default.createElement(p.default,i({},I));break;case c.ICrmAttributeType.NumberPicker:var h=i({},C,{minValue:1,maxValue:d&&d.maxValue?d.maxValue:4});_=s.default.createElement(E.default,i({},h))}var T=!g.ForecastingBusinessLogicProvider.FieldHasNonNullValue(e,C.value)&&this.props.formState.showEmptyWarnings;return s.default.createElement(l.default,i({},i({},C,{labelText:o,isEmpty:T})),_)},t.prototype.generateCommonFormControlProps=function(e,t,n,r,o,i,a){var s=this;return a=o?a+" *":a,{id:e,attributeInfo:{id:e,name:t,entityName:n,type:r},onChange:function(t){var n,r=((n={})[e]=t,n);s.props.formEventsHandler.OnValueChange(r)},value:""+this.props.formData[e],crmDataAcces:this.props.crmDataAccess,label:a,childrenType:r,isMandatory:o,isDisabled:i}},t}(s.default.Component);function h(e){return{formData:_.GetFormData_fromState(e),isFormDirty:_.GetIsFormDirty_FromState(e),formState:_.GetFormState_FromState(e),activeStage:e.stepperActiveStage,isFormLocked:_.GetIsFormLocked_FromState(e),arePostPublishUpdatableFieldsUpdatable:_.ArePostPublishUpdatableFieldsUpdatable(e),orgUrl:e.crmOrgInfo.clientUrl,hierarchyEntityDisplayName:C.getHierarchyEntityDisplayName(e),hierarchyRoute:C.getHierarchyRoute(e)}}t.default=I;var T=function(e,t){return{formEventsHandler:new d.FormEventsHandler(e,t.crmDataAccess.forecastConfigAccess)}};t.ConnectedFormGenerator=function(e){return u.connect(h,T)(e)}},356:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(99);n(922);var l=n(25),c=n(11),u=n(12),d=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.valueIsEmpty=function(){return 1==this.props.isEmpty},t.prototype.renderIconWithTooltip=function(e,t,n){return a.default.createElement(l.TooltipHost,{hostClassName:"formLabelHelpContainer",content:e,id:t,directionalHint:l.DirectionalHint.rightCenter},a.default.createElement(l.Icon,{iconName:n,className:"ms-IconExample formLabelHelpIcon"}))},t.prototype.render=function(){var e=this.props.isMandatory?this.props.labelText+" *":this.props.labelText,t=void 0,n=void 0,r="FormControlDecorator";if(this.valueIsEmpty()){var o=c.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.FC_EDIT_FIELD_MANDATORY_MESSAGE);n=a.default.createElement("span",{className:"formWarningText"},o),r+=" delfiFormFieldError"}this.props.childrenType===s.ICrmAttributeType.Lookup&&(t=a.default.createElement("div",{className:"formLabel"},a.default.createElement("span",{className:"formLabelText"},e)));var i=void 0;return this.props.helperText&&(i=this.renderIconWithTooltip(this.props.helperText,"formId","Info")),a.default.createElement("div",{className:r},t,i,this.props.children,n)},t}(a.default.Component);t.default=d},410:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0)),i=n(25);t.RibbonBase=function(e){return o.createElement("div",null,o.createElement(i.CommandBar,{items:e.items,styles:{root:{height:"44px",background:"none",borderBottom:"thin solid #E1DFDD"}}}))}},433:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(211),i=n(699),a=n(71),s=n(712),l=n(896),c=n(897),u=n(898),d=n(900),p=n(901),_=n(903),f=n(904),E=n(905),m=n(906),S=n(907),g=n(540),C=n(908),I=n(909),h=n(910),T=n(911),y=n(912);function F(e){var t=[],n=window.__REDUX_DEVTOOLS_EXTENSION__;n&&t.push(n());var r=[s.scheduleCalculationMiddleware,T.securityRolesFetcherMiddleware,c.categoryValuesFetcherMiddleware,I.columnInfoEditsMiddleware,u.saveEventsMiddleware,y.permissionDataMiddleware,d.dialogRendererMiddleware,p.hierarchyFetcherTriggerMiddleware,S.previewGridColumnReorderMiddleware,g.colconfigautopopulationMiddleware,m.amountBaseFieldFetcherMiddleware,_.optionSetInfoListFetcherMiddleware,l.loggerMiddleware,f.quotaStatusFetcherMiddleware,E.forecastConfigActionsMiddleware,C.siAvailabilityMiddleware,h.hierarchyEntitiesMetadataFetcherMiddleware],a=o.compose.apply(void 0,[o.applyMiddleware.apply(void 0,r)].concat(t));return o.createStore(i.rootReducer,e,a)}t.default=F,t.store=F(a.initialAppState),t.resetStore=function(){t.store=F(r({},r({},a.initialAppState,{crmOrgInfo:r({},a.initialAppState.crmOrgInfo,{calenderStartDate:t.store.getState().crmOrgInfo.calenderStartDate})})))}},434:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17);!function(e){e[e.Overview=0]="Overview",e[e.ColumnEditor=1]="ColumnEditor",e[e.OptionSetSelector=2]="OptionSetSelector"}(t.ColumnEditorPanelType||(t.ColumnEditorPanelType={})),t.initialForecastColumnEditorState={idEditorOpened:!1,hasUniqueNameBeenEdited:!0,isOptionSetSelectorOpened:!1,activeForecastColumnId:"",uneditedColumnInfo:{id:"",title:"",columnType:r.ForecastColumnType.HierarchyPrimary,isActive:!0,uniqueName:""},isCalculatedFieldExpressionErrorHidden:!0,calculatedFieldExpressionErrorMessage:"",calculatedFieldExpressionSuggestions:{forecastColumns:[]},isSuggestionCalloutVisible:!1,optionSetAttributeInfoDict:{},isChangeConfirmationDialogOpen:!1,isColumnConfigAutopopulationDialogOpen:!1,selectedAttributeVal:""}},435:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(434),i=n(17);t.columnEditorStateReducer=function(e,t){var n;switch(void 0===e&&(e=o.initialForecastColumnEditorState),t.type){case"@@ColumnEditorState/UpdateIsEditorOpened":return r({},e,{idEditorOpened:t.payload.isEditorOpened});case"@@ColumnEditorState/UpdateHasUniqueNameBeenEdited":return r({},e,{hasUniqueNameBeenEdited:t.payload.hasUniqueNameBeenEdited});case"@@ColumnEditorState/UpdateIsOptionSetSelectorOpened":return r({},e,{isOptionSetSelectorOpened:t.payload.isOpen});case"@@ColumnEditorState/UpdateIsChangeConfirmationDialogOpen":return r({},e,{isChangeConfirmationDialogOpen:t.payload.isOpen});case"@@ColumnOverview/UpdateIsColumnConfigAutoPopulateDialogOpen":return r({},e,{isColumnConfigAutopopulationDialogOpen:t.payload.isOpen});case"@@ColumnEditorState/UpdateActiveForecastColumn":return r({},e,{activeForecastColumnId:t.payload.column.id,uneditedColumnInfo:r({},t.payload.column)});case"@@ColumnEditorState/UpdateIsCalculatedFieldExpressionErrorHidden":return r({},e,{isCalculatedFieldExpressionErrorHidden:t.payload.isCalculatedFieldExpressionErrorHidden});case"@@ColumnEditorState/UpdateCalculatedFieldExpressionErrorMessage":return r({},e,{calculatedFieldExpressionErrorMessage:t.payload.calculatedFieldExpressionErrorMessage});case"@@ColumnEditorState/UpdateCalculatedFieldExpressionSuggestions":return r({},e,{calculatedFieldExpressionSuggestions:t.payload.calculatedFieldExpressionSuggestions});case"@@ColumnEditorState/UpdateIsSuggestionCalloutVisible":return r({},e,{isSuggestionCalloutVisible:t.payload.isSuggestionCalloutVisible});case"@@ColumnEditor/UpdateOptionSetInfoList":return r({},e,{optionSetAttributeInfoDict:r({},e.optionSetAttributeInfoDict,(n={},n[t.payload.rollupEntity]=t.payload.list,n))});case"@@OptionSetChoiceList/UpdateSelectedValue":return r({},e,{selectedAttributeVal:t.payload.value});default:return e}},t.PredictiveAvailabilityStateReducer=function(e,t){switch(void 0===e&&(e=i.PredictiveAvailabilityStateType.FcbOff),t.type){case"@@PredictiveFeature/UpdateAvailabilityState":return t.payload.value;default:return e}}},436:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a,s=i(n(0)),l=n(17),c=n(25),u=n(11),d=n(12),p=n(45);!function(e){e.Configure="configure",e.CheckBoxClicked="checkBox",e.Delete="delete",e.MoveUp="moveUp",e.MoveDown="moveDown"}(a=t.ColumnSelectorActionType||(t.ColumnSelectorActionType={}));var _=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderItem=function(e){return s.default.createElement("div",null)},n._onRenderOverflowButton=function(e){return s.default.createElement(c.IconButton,{tabIndex:0,ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_MORE_COMMANDS),className:n.state.isContextOpen?"":"columnMoreButton",styles:{root:{minWidth:0,alignSelf:"stretch",height:"auto",width:25,paddingTop:5,paddingBottom:5},rootHovered:{},rootExpanded:{color:"#2266E3 !important"},menuIcon:{height:"auto",lineHeight:"normal"},menuIconHovered:{color:"#2266E3"},menuIconExpanded:{color:"#2266E3"}},menuIconProps:{iconName:"MoreVertical"},menuProps:{items:e,onMenuOpened:function(){n.setState({isContextOpen:!0})},onMenuDismissed:function(){n.setState({isContextOpen:!1})}}})},n.state={isContextOpen:!1},n}return o(t,e),t.prototype.renderOverflow=function(){var e=this;return s.default.createElement(c.OverflowSet,{styles:{root:{marginLeft:5}},items:[],overflowItems:[{key:"configure",name:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE),disabled:p.ForecastingBusinessLogicProvider.IsColumnOverviewContextButtonDisabled(a.Configure,this.props.columnType,this.props.formStatus,this.props.arePostPublishUpdatableFieldsUpdatable),iconProps:{iconName:"Settings"},onClick:function(){e.props.onAction(a.Configure)}},{key:"delete",name:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE),disabled:p.ForecastingBusinessLogicProvider.IsColumnOverviewContextButtonDisabled(a.Delete,this.props.columnType,this.props.formStatus,this.props.arePostPublishUpdatableFieldsUpdatable),onClick:function(){e.props.onAction(a.Delete)},iconProps:{iconName:"Delete"}},{key:"moveUp",name:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP),disabled:p.ForecastingBusinessLogicProvider.IsColumnOverviewContextButtonDisabled(a.MoveUp,this.props.columnType,this.props.formStatus,this.props.arePostPublishUpdatableFieldsUpdatable),onClick:function(){e.props.onAction(a.MoveUp)},iconProps:{iconName:"Up"}},{key:"moveDown",name:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN),ariaLabel:u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN),disabled:p.ForecastingBusinessLogicProvider.IsColumnOverviewContextButtonDisabled(a.MoveDown,this.props.columnType,this.props.formStatus,this.props.arePostPublishUpdatableFieldsUpdatable),onClick:function(){e.props.onAction(a.MoveDown)},iconProps:{iconName:"Down"}}],onRenderOverflowButton:this._onRenderOverflowButton,onRenderItem:this._onRenderItem})},t.prototype.renderStatusIcon=function(e){var t;switch(e){case l.ForecastColumnStatus.Incomplete:var n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_SELECTOR_ROW_TOOLTIP_STATUS);t=this.renderWarningIconWithTooltip(n);break;case l.ForecastColumnStatus.DuplicateUniqueName:n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE);t=this.renderWarningIconWithTooltip(n)}if(this.props.columnType==l.ForecastColumnType.Quota){n=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_SELECTOR_QUOTA_ROW_TOOLTIP);t=this.renderIconWithTooltip(n,"quotaColumn","Info")}return t},t.prototype.renderWarningIconWithTooltip=function(e){return this.renderIconWithTooltip(e,"status","WarningSolid",{root:{color:"#A80000"}})},t.prototype.renderLockIcon=function(){var e;switch(this.props.columnType){case l.ForecastColumnType.Predictive:var t=u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_SELECTOR_ROW_TOOLTIP_LOCK);e=this.renderIconWithTooltip(t,"predictiveLock","Lock")}return e},t.prototype.renderIconWithTooltip=function(e,t,n,r){return s.default.createElement(c.TooltipHost,{content:e,id:t,directionalHint:c.DirectionalHint.rightCenter},s.default.createElement(c.Icon,{iconName:n,className:"ms-IconExample columnIcon",styles:r}))},t.prototype.render=function(){var e=this,t=this.props.status==l.ForecastColumnStatus.Disabled,n="columnRow";return this.state.isContextOpen&&(n+=" expandedColumnRow"),s.default.createElement("div",{className:n},s.default.createElement(c.Checkbox,{className:"columnCheckbox",label:this.props.title,checked:this.props.isActive,disabled:t,onChange:function(t,n){e.props.onAction(a.CheckBoxClicked)}}),s.default.createElement("div",{className:"iconsWarningAndGear"},this.renderStatusIcon(this.props.status),this.renderOverflow()))},t}(s.default.Component);t.ColumnSelectorRow=_},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(108),i=n(11),a=n(12),s=n(436),l=n(88),c=n(107),u=n(324);t.NON_REQ_FIELDS=["statusDescription","id","owner","columns","startAtQuater","startAtMonth","additionalFilter"],t.ForecastConfig_Fields_Stage1=["name","rollupEntity","hierarchyEntity","topOfHierarchy","period","fiscalyear","fromDate","toDate","numberOfRecurrences","startAtQuater","startAtMonth"],t.ForecastConfig_Fields_Stage2=["forecastCategoryAttributeName"],t.ForecastConfig_Fields_Stage3=["forecastCategoryAttributeName"],t.ForecastConfig_Fields_Stage4=["permissionsData"],t.OrderedFormStages=[o.ForecastConfigStage.General,o.ForecastConfigStage.Permission,o.ForecastConfigStage.View,o.ForecastConfigStage.Quota];var d=function(){function e(){}return e.getForecastConfigFieldsForStage=function(e){switch(e){case o.ForecastConfigStage.General:return t.ForecastConfig_Fields_Stage1;case o.ForecastConfigStage.View:return t.ForecastConfig_Fields_Stage2;case o.ForecastConfigStage.Quota:return t.ForecastConfig_Fields_Stage3;case o.ForecastConfigStage.Permission:return t.ForecastConfig_Fields_Stage4;default:return[]}},e.GetStageStepId=function(e){switch(e){case o.ForecastConfigStage.General:return"1";case o.ForecastConfigStage.Permission:return"2";case o.ForecastConfigStage.View:return"3";case o.ForecastConfigStage.Quota:return"4";default:return""}},e.GetStageTitleText=function(e){switch(e){case o.ForecastConfigStage.General:return"1";case o.ForecastConfigStage.Permission:return"2";case o.ForecastConfigStage.View:return"3";case o.ForecastConfigStage.Quota:return"4";default:return""}},e.GetStageDecriptionText=function(e){switch(e){case o.ForecastConfigStage.General:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_EDIT_STEPPER_STAGE1_EDITPAGE);case o.ForecastConfigStage.View:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_EDIT_STEPPER_STAGE2_EDITPAGE);case o.ForecastConfigStage.Quota:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_EDIT_STEPPER_STAGE3_EDITPAGE);case o.ForecastConfigStage.Permission:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_EDIT_STEPPER_STAGE4_EDITPAGE);default:return""}},e.getIndexOfStage=function(e){return t.OrderedFormStages.indexOf(e)},e.GetLengthofOrderedStepperStages=function(){return t.OrderedFormStages.length},e.getDelphiStepViaIndex=function(e){return t.OrderedFormStages[e]},e.getStageFromStepId=function(e){switch(e){case"1":return o.ForecastConfigStage.General;case"2":return o.ForecastConfigStage.Permission;case"3":return o.ForecastConfigStage.View;case"4":return o.ForecastConfigStage.Quota;default:return-1}},e.getPreviousStage=function(t){var n=e.getIndexOfStage(t);return e.getDelphiStepViaIndex(n-1)},e.getNextStage=function(t){var n=e.getIndexOfStage(t);return e.getDelphiStepViaIndex(n+1)},e.isFirstStageofOrderedStepperStages=function(t){return 0==e.getIndexOfStage(t)},e.isLastStageofOrderedStepperStages=function(t){return e.getIndexOfStage(t)==e.GetLengthofOrderedStepperStages()-1},e.IsRequiredField=function(e){return-1==t.NON_REQ_FIELDS.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},e.FieldHasNonNullValue=function(e,t){if(null==t)return!1;var n=""!==t;return n&&t&&0==t.length&&(n=!1),n},e.IsFieldPresentInStageForm=function(e,t){return-1!=t.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},e.GetColumnInfoStatus=function(e,t,n){return this.IsColumnInfoLocked(e)?r.ForecastColumnStatus.Disabled:this.IsFormStatusReadOnly(n)?r.ForecastColumnStatus.Disabled:this.AreRequiredFieldsFilledForColumnInfo(e)?t?r.ForecastColumnStatus.DuplicateUniqueName:r.ForecastColumnStatus.Enabled:r.ForecastColumnStatus.Incomplete},e.AreRequiredFieldsFilledForColumnInfo=function(e){var t=this.FieldHasNonNullValue("title",e.title);return t=(t=t&&this.FieldHasNonNullValue("columnType",e.columnType))&&this.FieldHasNonNullValue("uniqueName",e.uniqueName),e.columnType==r.ForecastColumnType.Rollup?t=t&&this.FieldHasNonNullValue("dateField",e.dateField)&&this.FieldHasNonNullValue("amountField",e.amountField):e.columnType==r.ForecastColumnType.Calculated&&(t=t&&this.FieldHasNonNullValue("calculatedFieldExpression",e.calculatedFieldExpression)),t},e.IsColumnInfoLocked=function(e){return e.columnType==r.ForecastColumnType.HierarchyPrimary},e.GetColumnTypeOptionsBasedOnCurrentType=function(e){var t=[{key:r.ForecastColumnType.Rollup,text:i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_ROLLUP)},{key:r.ForecastColumnType.Calculated,text:i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_CALCULATED)},{key:r.ForecastColumnType.Quota,text:i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA)},{key:r.ForecastColumnType.HierarchyPrimary,text:i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY)},{key:r.ForecastColumnType.HierarchySecondary,text:i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY)}],n=t.filter((function(e){return e.key==r.ForecastColumnType.Rollup||e.key==r.ForecastColumnType.Calculated}));switch(e){case r.ForecastColumnType.Rollup:case r.ForecastColumnType.Calculated:case void 0:return n}return t},e.GetIsColumnTypeControlDisabledBasedOnCurrentType=function(e){switch(e){case r.ForecastColumnType.HierarchyPrimary:case r.ForecastColumnType.HierarchySecondary:case r.ForecastColumnType.Quota:return!0}return!1},e.IsColumnOverviewContextButtonDisabled=function(e,t,n,o){switch(e){case s.ColumnSelectorActionType.Delete:if(this.IsFormStatusReadOnly(n))return!0;if(t==r.ForecastColumnType.Quota||t==r.ForecastColumnType.HierarchyPrimary||t==r.ForecastColumnType.Predictive||t==r.ForecastColumnType.HierarchySecondary)return!0;break;case s.ColumnSelectorActionType.MoveUp:case s.ColumnSelectorActionType.MoveDown:if(!o)return!0;break;case s.ColumnSelectorActionType.Configure:if(t==r.ForecastColumnType.Predictive)return!0}return!1},e.IsFormStatusReadOnly=function(e){return e==r.IForecastConfigStatus.Published||e==r.IForecastConfigStatus.Archived||e==r.IForecastConfigStatus.Processing},e.getTitleForGenericErrorDialog=function(e){switch(e){case l.IErrorDialogType.GenericFailure:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE);case l.IErrorDialogType.ForecastConfigDeleteFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_DELETE_FAILURE_TITLE);case l.IErrorDialogType.ForecastConfigPublishFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_PUBLISH_FAILURE_TITLE);case l.IErrorDialogType.FetchingHierarchyDataFailed:case l.IErrorDialogType.RetreivingMetadataFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE);case l.IErrorDialogType.FetchingOrgDetailsFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_FETCHING_ORG_FAILURE_TITLE);case l.IErrorDialogType.ForecastConfigUpdateFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_UPDATE_FAILURE_TITLE);case l.IErrorDialogType.ForecastConfigFetchingFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE);case l.IErrorDialogType.ForecastConfigCreateFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_CREATE_FAILURE_TITLE);case l.IErrorDialogType.ForecastConfigFormLoadError:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE);case l.IErrorDialogType.ForecastConfigColDeleteFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_DELETE_COLUMN_HEADER);case l.IErrorDialogType.HierarchyRelationsDoesntExistDialog:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_HIERARCHY_REL_NOT_PRESENT_DIALOG_HEADER)}return""},e.getDescriptionForGenericErrorDialog=function(e){switch(e){case l.IErrorDialogType.GenericFailure:case l.IErrorDialogType.ForecastConfigDeleteFailed:case l.IErrorDialogType.ForecastConfigPublishFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_TRY_AGAIN_DESC);case l.IErrorDialogType.FetchingHierarchyDataFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_HIERARCHY_FAILURE_DESC);case l.IErrorDialogType.RetreivingMetadataFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ORG_DETAILS_DESC);case l.IErrorDialogType.FetchingOrgDetailsFailed:case l.IErrorDialogType.ForecastConfigUpdateFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_TRY_AGAIN_DESC);case l.IErrorDialogType.ForecastConfigFetchingFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_FETCHING_FAILURE_DESC);case l.IErrorDialogType.ForecastConfigCreateFailed:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_ERROR_TRY_AGAIN_DESC)}return""},e.getRelationshipDepth=function(e){for(var t=0,n=JSON.parse(JSON.stringify(e));null!=n&&null!=n.relationship;)t+=1,n=n.relationship;return t},e.getHierarchyRouteDisplayStrings=function(e,t){var n=[],r=JSON.parse(JSON.stringify(e));if(null!=t[r.entityName]){n.push(t[r.entityName].DisplayName);for(var o=r.entityName,i=r.relationship;null!=i&&null!=i.linkedByAttribute;){if(null==t[o]||null==t[o].AttributesMetadata||null==t[o].AttributesMetadata.DependentAttributes)return[];var a=t[o].AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName==i.linkedByAttribute}));a&&n.push(a.DisplayName),o=i.entityName,i=i.relationship}}return n},e.getColumnForPermissionsAttribute=function(t){if(t&&null!=t.permissionAttribueInfo&&"systemuserid"!=t.permissionAttribueInfo.attributeName)return{id:u.generateNewGuid(),title:t.permissionAttribueInfo.attributeName,columnType:r.ForecastColumnType.HierarchySecondary,isActive:!0,uniqueName:c.filterNonValidCharactersForUniqueName(t.permissionAttribueInfo.attributeName),hierarchyAttributeInfo:e.getLookupNameAttributeInfo(t.permissionAttribueInfo),isPermissionsColumn:!0}},e.sortBasedOnDisplayName=function(e,t){var n=e.title.toLowerCase(),r=t.title.toLowerCase();return n<r?-1:n>r?1:e.uniqueName<t.uniqueName?-1:1},e.getLookupNameAttributeInfo=function(t){for(var n=JSON.parse(JSON.stringify(t)),r=n.attributeName,o=n.relationship;null!=o.relationship;)o=o.relationship;var i=e.getLookupEntityInfo(r,o.entityName),a=i.lookupEntityName,s=i.primaryNameAttribute;return o.relationship={entityName:a,linkedByAttribute:r,relationship:null},n.attributeName=s,n},e.getLookupEntityInfo=function(e,t){return{lookupEntityName:"systemuser",primaryNameAttribute:"fullname"}},e}();t.ForecastingBusinessLogicProvider=d},456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=function(){function e(){}return e.Rollup_Bestcase=function(){return{id:"bestcase_col",title:"Bestcase",columnType:r.ForecastColumnType.Rollup,isActive:!0,amountField:"estimated_revenue",amountBaseField:"estimated_revenue_base",dateField:"estimated_closedate",optionSetValue:100000001,uniqueName:"BESTCASE",showProgressComparedToQuota:!0,isManuallyAdjustable:!0}},e.Rollup_Committed=function(){return{id:"commited_col",title:"Commited",columnType:r.ForecastColumnType.Rollup,isActive:!0,amountField:"estimated_revenue",amountBaseField:"estimated_revenue_base",dateField:"estimated_closedate",optionSetValue:100000002,uniqueName:"COMITTED",calculatedFieldExpression:"",showProgressComparedToQuota:!0,isManuallyAdjustable:!0}},e.Owner=function(){return{id:"owner",title:"Owner",columnType:r.ForecastColumnType.HierarchyPrimary,isActive:!0,uniqueName:"Owner"}},e.Predictive=function(){return{id:"predictive",title:"Predictive",columnType:r.ForecastColumnType.Predictive,isActive:!0,uniqueName:"Predictive"}},e}();t.FakeColumnInfoData=o},457:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Current=0]="Current",e[e.Completed=1]="Completed",e[e.CurrentCompleted=2]="CurrentCompleted",e[e.Enabled=3]="Enabled",e[e.Disabled=4]="Disabled"}(t.IDelphiState||(t.IDelphiState={}))},458:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(722),o=n(136),i=n(228),a=n(331),s=n(229),l=n(230),c=function(){function e(){}return e.prototype.parseExpressionToTokens=function(e,t){i.Validations.validateNullArgument(e,"expression");for(var n=[],r=e,o=0;r.length>0;){var c=this.getWhiteSpaceLength(r);if(c>0)o+=c,r=r.slice(c);else{var u=null;if(null===u&&(u=this.parseIdentifier(r,o)),null===u&&(u=this.parseNumber(r,o)),null===u&&(u=this.parseOperator(r,o)),null===u&&(u=this.parseParenthesis(r,o)),null===u){if(!t)throw new a.ParseError(s.StringFormatter.formatString(l.ExpressionParseErrors.InvalidCharacter,r[0],(o+1).toString()),o);u=this.buildUnknownToken(r,o)}n.push(u),o+=u.length,r=r.slice(u.length)}}return n},e.prototype.parseIdentifier=function(t,n){var r=null,i=t.match(e.identifierRegex);return i&&i.length>0&&(r=this.buildToken(o.TokenType.Identifier,i[0],n)),r},e.prototype.parseNumber=function(t,n){var r=null,i=t.match(e.numberRegex);return i&&i.length>0&&(r=this.buildToken(o.TokenType.Number,i[0],n)),r},e.prototype.parseOperator=function(e,t){var n=null,r=o.TokenType.Unknown;return"+"===e[0]?r=o.TokenType.Plus:"-"===e[0]?r=o.TokenType.Minus:"*"===e[0]?r=o.TokenType.Multiple:"/"===e[0]&&(r=o.TokenType.Divide),r!==o.TokenType.Unknown&&(n=this.buildToken(r,e[0],t)),n},e.prototype.parseParenthesis=function(e,t){var n=null,r=o.TokenType.Unknown;return"("===e[0]?r=o.TokenType.LeftParenthesis:")"===e[0]&&(r=o.TokenType.RightParenthesis),r!==o.TokenType.Unknown&&(n=this.buildToken(r,e[0],t)),n},e.prototype.buildUnknownToken=function(e,t){return this.buildToken(o.TokenType.Unknown,e[0],t)},e.prototype.getWhiteSpaceLength=function(t){var n=-1,r=t.match(e.whiteSpaceRegex);return r&&r.length>0&&(n=r[0].length),n},e.prototype.buildToken=function(e,t,n){var o=null!=t?t.length:0;return new r.Token(e,t,n,o)},e.identifierRegex=/^[A-Z][0-9A-Z_]*/i,e.numberRegex=/^\d+\.?\d*|^\.\d+/,e.whiteSpaceRegex=/^\s+/,e}();t.LexicalAnalyzer=c},459:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(136),o=n(17),i=function(){function e(){}return e.isOperator=function(e){return e===r.TokenType.Plus||e===r.TokenType.Minus||e===r.TokenType.Multiple||e===r.TokenType.Divide},e.isValidDependencyType=function(e){return e===o.ForecastColumnType.Rollup||e===o.ForecastColumnType.Calculated||e===o.ForecastColumnType.Quota||e===o.ForecastColumnType.Predictive},e}();t.ExpressionParserUtils=i},49:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateIsEditorOpened=function(e){return{type:"@@ColumnEditorState/UpdateIsEditorOpened",payload:{isEditorOpened:e}}},t.UpdateHasUniqueNameBeenEdited=function(e){return{type:"@@ColumnEditorState/UpdateHasUniqueNameBeenEdited",payload:{hasUniqueNameBeenEdited:e}}},t.UpdateActiveForecastColumn=function(e){return{type:"@@ColumnEditorState/UpdateActiveForecastColumn",payload:{column:e}}},t.UpdateIsCalculatedFieldExpressionErrorHidden=function(e){return{type:"@@ColumnEditorState/UpdateIsCalculatedFieldExpressionErrorHidden",payload:{isCalculatedFieldExpressionErrorHidden:e}}},t.UpdateCalculatedFieldExpressionErrorMessage=function(e){return{type:"@@ColumnEditorState/UpdateCalculatedFieldExpressionErrorMessage",payload:{calculatedFieldExpressionErrorMessage:e}}},t.UpdateCalculatedFieldExpressionSuggestions=function(e){return{type:"@@ColumnEditorState/UpdateCalculatedFieldExpressionSuggestions",payload:{calculatedFieldExpressionSuggestions:e}}},t.UpdateIsSuggestionCalloutVisible=function(e){return{type:"@@ColumnEditorState/UpdateIsSuggestionCalloutVisible",payload:{isSuggestionCalloutVisible:e}}},t.UpdateColumnInfoField=function(e,t,n){return{type:"@@FormData/UpdateColumnInfoField",payload:{colId:e,fieldName:t,value:n}}},t.ClearRollupAndCalculatedColumns=function(){return{type:"@@FormData/ClearRollupAndCalculatedColumns",payload:{}}},t.AddColumn=function(e){return{type:"@@FormData/AddColumn",payload:{column:e}}},t.DeleteColumn=function(e){return{type:"@@FormData/DeleteColumn",payload:{id:e}}},t.ReplaceColumn=function(e,t){return{type:"@@FormData/ReplaceColumn",payload:{id:e,column:t}}},t.UpdateOptionSetList=function(e,t){return{type:"@@ColumnEditor/UpdateOptionSetInfoList",payload:{rollupEntity:e,list:t}}},t.UpdateIsChangeConfirmationDialogOpen=function(e){return{type:"@@ColumnEditorState/UpdateIsChangeConfirmationDialogOpen",payload:{isOpen:e}}},t.UpdateIsColumnConfigAutoPopulateDialogOpen=function(e){return{type:"@@ColumnOverview/UpdateIsColumnConfigAutoPopulateDialogOpen",payload:{isOpen:e}}},t.UpdateIsOptionSetSelectorOpened=function(e){return{type:"@@ColumnEditorState/UpdateIsOptionSetSelectorOpened",payload:{isOpen:e}}},t.TriggerCategoryValuesFetch=function(){return{type:"@@ColumnEditor/TriggerCategoryValuesFetch",payload:{}}},t.TriggerColumnConfigAutoPopulate=function(){return{type:"@@ColumnEditor/TriggerColumnConfigAutoPopulate",payload:{}}},t.UpdateSelectedOptionSetValue=function(e){return{type:"@@OptionSetChoiceList/UpdateSelectedValue",payload:{value:e}}},t.UpdatePredictiveAvailabilityState=function(e){return{type:"@@PredictiveFeature/UpdateAvailabilityState",payload:{value:e}}}},51:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=[];function i(e,t,n,r){void 0===r&&(r={}),o.map((function(o){o.logLevel<=e&&o.logCategory(e,t,n,r)}))}t.logInfo=function(e,t,n){void 0===n&&(n={}),i(r.ILogLevel.Info,e,t,n)},t.logError=function(e,t,n,r){void 0===r&&(r={}),o.map((function(o){o.logError(e,t,n,r)}))},t.logWarning=function(e,t,n){void 0===n&&(n={}),i(r.ILogLevel.Warning,e,t,n)},t.logUsage=function(e,t,n){void 0===n&&(n={}),i(r.ILogLevel.Usage,e,t,n)},t.addLogger=function(e){o.push(e)}},540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(17),i=n(89);t.ORG_TEMPLATE_DATE_FIELD="estimatedclosedate",t.ORG_TEMPLATE_AMOUNT_FIELD="estimatedvalue",t.ORG_TEMPLATE_ACTUAL_DATE_FIELD="actualclosedate",t.ORG_TEMPLATE_ACTUAL_AMOUNT_FIELD="actualvalue",t.ORG_TEMPLATE_AMOUNT_BASE_FIELD="estimatedvalue_base",t.ORG_TEMPLATE_ACTULAMOUNT_BASE_FIELD="actualvalue_base",t.colconfigautopopulationMiddleware=function(e){var n=e.getState;return function(e){return function(a){if("@@ColumnEditor/TriggerColumnConfigAutoPopulate"==a.type){var s=n();if("msdyn_forecastcategory"==i.GetSelectedOptionSetAttribute_FromState(s)){var l=!0;s.FormFieldData.columns.map((function(e){e.columnType==o.ForecastColumnType.Rollup&&(e.amountField||e.dateField)&&(l=!1)})),l&&s.FormFieldData.columns.map((function(n){var o=n.optionSetValue<=100000004,i=o?t.ORG_TEMPLATE_DATE_FIELD:t.ORG_TEMPLATE_ACTUAL_DATE_FIELD,a=o?t.ORG_TEMPLATE_AMOUNT_FIELD:t.ORG_TEMPLATE_ACTUAL_AMOUNT_FIELD,s=o?t.ORG_TEMPLATE_AMOUNT_BASE_FIELD:t.ORG_TEMPLATE_ACTULAMOUNT_BASE_FIELD;e(r.UpdateColumnInfoField(n.id,"dateField",i)),e(r.UpdateColumnInfoField(n.id,"amountField",a)),e(r.UpdateColumnInfoField(n.id,"amountBaseField",s)),o&&e(r.UpdateColumnInfoField(n.id,"isManuallyAdjustable",!0)),function(e){return 100000005==e.optionSetValue}(n)&&e(r.UpdateColumnInfoField(n.id,"showProgressComparedToQuota",!0))}))}}return e(a)}}}},541:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(82),o=n(97),i=n(243),a=n(174),s=n(17),l=function(){function e(e){this.dispatch=e}return e.prototype.OpenCreatePage=function(e){if(!(e&&e in s.ForecastConfigTemplateType))throw new Error("Invalid template type received for forecast configuration create page.");o.GetEmptyForecastConfigInfo(e);this.dispatch(r.UpdateFieldValue({templateType:e})),this.dispatch(i.changeMainPageType(a.IMainPageType.EditPage))},e.prototype.OpenEditPage=function(e){var t={id:e};this.dispatch(r.UpdateFieldValue(t)),this.dispatch(i.changeMainPageType(a.IMainPageType.EditPage))},e.prototype.OpenGridPage=function(){this.dispatch(i.changeMainPageType(a.IMainPageType.GridPage))},e}();t.ReduxNavigationHandler=l},542:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(325),i=n(11),a=n(12);t.getLocalizedTemplateName=function(e){switch(e){case r.ForecastConfigTemplateType.OrgChart:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_TEMPLATE_TYPE_ORG_CHART);case r.ForecastConfigTemplateType.TerritoryBased:return i.GlobalLocalizedStringsProvider.GetString(a.STRING_KEYS.FC_TEMPLATE_TYPE_TERRITORY_BASED);default:return""}},t.setDefaultTemplateBasedValuesForExistingRecords=function(e){var t=r.ForecastConfigTemplateType.OrgChart;e.templateType=t,e.hierarchyRelationship=o.forecastConfigTemplates[t].hierarchyRelationship},t.getDefaultPermissionDataByTemplate=function(e){return void 0!==o.forecastConfigTemplates[e]?o.forecastConfigTemplates[e].permissionsData:null}},543:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Publish=function(){return{type:"@@EditApp/PublishAction",payload:{}}},t.QuotaStatusFetch=function(){return{type:"@@EditApp/QuotaStatusFetchAction",payload:{}}},t.QuotaUploadStart=function(e,t){return{type:"@@EditApp/QuotaUploadStartAction",payload:{fileName:e,fileContent:t}}},t.QuotaDownload=function(){return{type:"@@EditApp/QuotaDownloadAction",payload:{}}},t.QuotaUploadStatusUpdate=function(e){return{type:"@@EditApp/QuotaUploadStatusUpdateAction",payload:{quotaUploadStatus:e}}},t.QuotaUploadFetchUpdate=function(e){return{type:"@@EditApp/QuotaUploadFetchUpdateAction",payload:{isFetched:e}}},t.QuotaUploadDownloadUpdate=function(e){return{type:"@@EditApp/QuotaUploadDownloadUpdateAction",payload:{isDownload:e}}},t.QuotaUploadPublishUpdate=function(e){return{type:"@@EditApp/QuotaUploadPublishUpdateAction",payload:{isPublishing:e}}},t.NotificationConnect=function(){return{type:"@@EditApp/NotificationConnectAction",payload:{}}},t.PublishSubscribe=function(){return{type:"@@EditApp/PublishSubscribeAction",payload:{}}}},544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.Get=function(){return this.signalRNotificationProvider},e.Set=function(e){this.signalRNotificationProvider=e},e}();t.NotificationProvider=r},64:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=n(456),i=n(174),a=n(108),s=n(227);function l(e){return c(e.FormFieldData)}function c(e){var t=!0;return Object.keys(e).map((function(n){var o=e[n];r.ForecastingBusinessLogicProvider.IsRequiredField(n)&&!r.ForecastingBusinessLogicProvider.FieldHasNonNullValue(n,o)&&(t=!1)})),t}function u(e){return f(e.FormFieldData,e.ActiveForecastConfigInfo)}function d(e){return _(e.ActiveForecastConfigInfo)}function p(e){return e.mainPageType==i.IMainPageType.EditPage&&""==e.FormFieldData.id}t.GetFormData_fromState=function(e){return e.FormFieldData},t.GetFormState_FromState=function(e){return{showEmptyWarnings:e.formUIState.showEmptyFieldWarnings,hasAllRequiredFieldsFilled:l(e)}},t.GetHasRequiredFieldsFilled_FromState=l,t.GetHasRequiredFieldsFilled=c,t.IsFormValidForSave_FromState=function(e){return 0==r.ForecastingBusinessLogicProvider.IsFormStatusReadOnly(e.FormFieldData.status)?u(e):u(e)&&s.GetHasRequiredFieldsFilled_ForStage_FromState(e,a.ForecastConfigStage.General)&&s.GetHasRequiredFieldsFilled_ForStage_FromState(e,a.ForecastConfigStage.Permission)&&s.GetHasRequiredFieldsFilled_ForStage_FromState(e,a.ForecastConfigStage.View)&&s.GetHasRequiredFieldsFilled_ForStage_FromState(e,a.ForecastConfigStage.Quota)},t.GetIsFormDirty_FromState=u,t.GetIsFormLocked_FromState=d,t.ArePostPublishUpdatableFieldsUpdatable=function(e){return!(d(e)&&!p(e))||!function(e){return!!e.FormFieldData.columns.find((function(e){return"quota"===e.id}))}(e)},t.GetIsFormInCreateMode_FromState=p;function _(e){return r.ForecastingBusinessLogicProvider.IsFormStatusReadOnly(e.status)}function f(e,t){var n=!1,r=["fromDate","toDate","columns","owner","hierarchyRelationship","permissionsData"],o=["hierarchyRelationship","permissionsData"];return Object.keys(e).map((function(i){(r.indexOf(i)<0&&e[i]!=t[i]||o.indexOf(i)>=0&&JSON.stringify(e[i])!=JSON.stringify(t[i]))&&(n=!0)})),!!n||function(e,t){var n=!1;return e.columns.length!=t.columns.length||(e.columns.map((function(e,r){E(e,t.columns[r])&&(n=!0)})),n)}(e,t)}function E(e,t){var n=!1,r=o.FakeColumnInfoData.Rollup_Committed();return Object.keys(r).map((function(r){e[r]!=t[r]&&(n=!0)})),n}t.IsFormLocked=_,t.IsFormDirty=f,t.AreColumnsDifferent=E},674:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(122),l=n(53),c=n(25);l.initializeIcons();var u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={cachedResults:void 0},n}return o(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.generateMakerXControlProps(this.props);t.resolver.resolveOptionSetMembers(t.entityContext,t.fieldContext).then((function(t){e.props.sortByDisplayName?e.props.sortByDisplayName&&(t=t.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))):t=t.sort((function(e,t){return e.value-t.value})),e.setState({cachedResults:t})}))},t.prototype.componentDidUpdate=function(e){var t=this.generateMakerXControlProps(this.props),n=this.generateMakerXControlProps(e);t.fieldContext!==n.fieldContext&&(void 0===n.fieldContext||n.fieldContext&&t.fieldContext&&t.fieldContext.name!==n.fieldContext.name)&&(this.setState({cachedResults:void 0}),this.componentDidMount())},t.prototype.render=function(){var e=this,t=this.getDropDownStyles(),n=this.getDropDownOptions();return a.default.createElement("div",{className:"crmFabricOptionsetControl"},a.default.createElement(c.Dropdown,{label:this.props.label,ariaLabel:this.props.label,title:this.props.label,onChange:function(t,n){n&&e.props.onChange(n.key.toString())},selectedKey:""!=this.props.value?parseInt(this.props.value):void 0,options:n,disabled:this.props.isDisabled,styles:t,onRenderPlaceHolder:function(){var t=a.default.createElement("div",null,a.default.createElement(c.Spinner,null));return e.state.cachedResults&&(t=""),t}}))},t.prototype.getDropDownOptions=function(){return this.state.cachedResults?this.state.cachedResults.map((function(e){return{key:e.value,text:e.displayName}})):[]},t.prototype.generateMakerXControlProps=function(e){var t={name:e.attributeInfo.entityName,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},n={metadataId:e.attributeInfo.id,name:e.attributeInfo.name,displayName:e.attributeInfo.name,dataType:s.EDataType.UniqueIdentifier};return{resolver:e.crmDataAcces.cdsResolver,entityContext:t,fieldContext:n}},t.prototype.getDropDownStyles=function(){var e={title:{display:"flex",alignItems:"center",justifyContent:"center"}};return this.state.cachedResults&&(e.title={}),e},t}(a.default.Component);t.default=u},675:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(122),l=n(53),c=n(25),u=n(99),d=n(11),p=n(12);l.initializeIcons(),t.CrnAttributePicker_None_Option_Key="-1";var _=function(e){function n(t){var n=e.call(this,t)||this;return n.onRenderItem=function(e,t){return"disabled"!==e.key&&t(e)},n.onRenderTitle=function(e,t){return"disabled"!==(Array.isArray(e)?e[0]:e).key&&t(e)},n.state={cachedResults:void 0},n}return o(n,e),n.prototype.componentDidMount=function(){var e=this,t=this.generateMakerXControlProps(this.props);this.props.crmDataAcces.cdsResolver.resolveFieldsMetadata(t.entityContext).then((function(t){e.setState({cachedResults:t})}))},n.prototype.componentDidUpdate=function(e){var t=this.generateMakerXControlProps(this.props),n=this.generateMakerXControlProps(e);t.entityContext!==n.entityContext&&(void 0===n.entityContext||n.entityContext&&t.entityContext&&t.entityContext.name!==n.entityContext.name)&&(this.setState({cachedResults:void 0}),this.componentDidMount())},n.prototype.render=function(){var e=this,t=this.getDropDownStyles(),n=this.getDropDownOptions();return a.default.createElement("div",{className:"crmAttributePickerControl"},a.default.createElement(c.Dropdown,{label:this.props.label,onChange:function(t,n){n&&"disabled"!==n.key&&e.props.onChange(n.key.toString())},selectedKey:""!=this.props.value?this.props.value:void 0,options:n,disabled:this.props.isDisabled,styles:t,placeHolder:this.props.placeHolder,onRenderTitle:this.onRenderTitle,onRenderItem:this.onRenderItem,onRenderPlaceHolder:function(){var t=a.default.createElement("div",null,a.default.createElement(c.Spinner,null));return e.state.cachedResults&&(t=e.props.placeHolder),t}}))},n.prototype.getDropDownOptions=function(){var e=this;if(!this.state.cachedResults)return[];var n=this.state.cachedResults.filter((function(t){return e.props.attributeInfo.type==u.ICrmAttributeType.OptionSet?-1!=[s.EDataType.OptionSet].indexOf(t.dataType):e.props.attributeInfo.type==u.ICrmAttributeType.DateField?-1!=[s.EDataType.Date].indexOf(t.dataType):e.props.attributeInfo.type==u.ICrmAttributeType.AmountField?-1!=[s.EDataType.Currency].indexOf(t.dataType)&&!t.CalculationOf:e.props.attributeInfo.type==u.ICrmAttributeType.Lookup&&(void 0!==e.props.attributeInfo.lookupEntityName?-1!=[s.EDataType.Lookup].indexOf(t.dataType)&&t.targets&&-1!=t.targets.indexOf(e.props.attributeInfo.lookupEntityName)||void 0!==e.props.attributeInfo.entityPrimaryIdAttribute&&-1!=[s.EDataType.UniqueIdentifier].indexOf(t.dataType)&&e.props.attributeInfo.entityName===e.props.attributeInfo.lookupEntityName&&t.name===e.props.attributeInfo.entityPrimaryIdAttribute:-1!=[s.EDataType.Lookup].indexOf(t.dataType))})).map((function(e){return{key:e.name,text:e.displayName}}));return void 0!==this.props.showNoneOption&&1==this.props.showNoneOption&&n.push({key:t.CrnAttributePicker_None_Option_Key,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_PERMISSIONS_ATTRIBUTE_NONE)}),[{key:"disabled",text:""}].concat(n)},n.prototype.generateMakerXControlProps=function(e){var t={name:e.attributeInfo.entityName,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},n={metadataId:e.attributeInfo.id,name:e.attributeInfo.name,displayName:e.attributeInfo.name,dataType:s.EDataType.UniqueIdentifier};return{resolver:e.crmDataAcces.cdsResolver,entityContext:t,fieldContext:n}},n.prototype.getDropDownStyles=function(){var e={title:{display:"flex",alignItems:"center",justifyContent:"center"}};return this.state.cachedResults&&(e.title={}),e},n}(a.default.Component);t.default=_},676:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(107),i=n(330),a=function(){function e(){}return e.UpdateColumnFieldValue=function(e,t,n,o){e(r.UpdateColumnInfoField(t,n,o))},e.UpdateCalculatedFieldExpressionValue=function(t,n,o,i,a){t(r.UpdateIsCalculatedFieldExpressionErrorHidden(!0)),t(r.UpdateColumnInfoField(i.id,"calculatedFieldExpression",o)),e.ShowSuggestionsForCalculatedFieldExpression(t,o,n,i,a)},e.OnCalculatedFieldExpressionBlur=function(t,n,r,o,i){e.ValidateCalculatedFieldExpression(n,i,o,t)},e.UpdateUniqueName=function(e,t,n){this.UpdateColumnFieldValue(e,t,"uniqueName",o.sanitizeUniqueName(n)),e(r.UpdateHasUniqueNameBeenEdited(!0))},e.ApplySuggestions=function(t,n,o,a,s){var l=i.SuggestionProviderFactory.getSuggestionProvier().applySuggestion(n.calculatedFieldExpression,o,a,s.targetToken);e.UpdateColumnFieldValue(t,n.id,"calculatedFieldExpression",l),t(r.UpdateIsCalculatedFieldExpressionErrorHidden(!0))},e.OnCalculatedFieldExpressionFocus=function(t,n,o,i,a){0==n.length&&null!==o&&(t(r.UpdateIsCalculatedFieldExpressionErrorHidden(!0)),e.ShowSuggestionsForCalculatedFieldExpression(t,n,o,i,a))},e.OnSuggestionCalloutDismiss=function(e){e(r.UpdateIsSuggestionCalloutVisible(!1))},e.ValidateCalculatedFieldExpression=function(e,t,n,o){var a=i.ExpressionParserFactory.getCalculatedFieldExpressionParser();try{a.parseExpression(e,t,n.uniqueName,n.id),o(r.UpdateIsCalculatedFieldExpressionErrorHidden(!0))}catch(e){o(r.UpdateIsCalculatedFieldExpressionErrorHidden(!1)),o(r.UpdateCalculatedFieldExpressionErrorMessage(e.message))}},e.ShowSuggestionsForCalculatedFieldExpression=function(e,t,n,o,a){var s=i.SuggestionProviderFactory.getSuggestionProvier().getSuggestions(t,a,n,o.id);e(r.UpdateCalculatedFieldExpressionSuggestions(s)),s.forecastColumns.length>0?e(r.UpdateIsSuggestionCalloutVisible(!0)):e(r.UpdateIsSuggestionCalloutVisible(!1))},e}();t.ColumnEditorFormOperations=a},677:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a,s=i(n(0)),l=n(26),c=n(410),u=n(89),d=n(678),p=n(11),_=n(12);!function(e){e[e.ChooseSelected=0]="ChooseSelected",e[e.Cancel=1]="Cancel"}(a=t.OptionSetSelectorRibbonActionType||(t.OptionSetSelectorRibbonActionType={}));var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return s.createElement(c.RibbonBase,{items:this.getRibbonItems()})},t.prototype.getRibbonItems=function(){return[this.chooseSelectedButton(),this.verticleDivider(),this.cancelButton()]},t.prototype.verticleDivider=function(){return{key:"verticalDivider",onRender:function(){return s.createElement("div",{className:"ribbonButtonDivider"})}}},t.prototype.chooseSelectedButton=function(){var e=this;return{key:"chooseSelected",className:"ribbonBtn",name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_OPTIONSET_PANEL_RIBBON_CHOOSE_SELECTED),disabled:this.props.isSaveCloseDisabled,iconProps:{iconName:"CheckMark",style:{color:"#107C10"}},onClick:function(){e.props.onClick(a.ChooseSelected,e.props.isOptionSetChangeDescructive)}}},t.prototype.cancelButton=function(){var e=this;return{key:"cancel",className:"ribbonBtn",name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),iconProps:{iconName:"Cancel",style:{color:"#A80000"}},onClick:function(){e.props.onClick(a.Cancel,e.props.isOptionSetChangeDescructive)}}},t}(s.Component);t.ConnectedOptionSetSelectorRibbon=l.connect((function(e){return{isSaveCloseDisabled:u.Get_IsChooseSelectedOptionSetButtonDisabled_FromState(e),isOptionSetChangeDescructive:u.Get_IsOptionSetChangeDescructive_FromState(e)}}),(function(e){return{onClick:function(t,n){d.OptionSetRibbonOperations.OnClickHandler(e,t,n)}}}))(f)},678:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(677),o=n(49),i=function(){function e(){}return e.OnClickHandler=function(e,t,n){switch(t){case r.OptionSetSelectorRibbonActionType.ChooseSelected:this.ChooseSelected(e,n);break;case r.OptionSetSelectorRibbonActionType.Cancel:this.CloseWithoutSave(e)}},e.ChooseSelected=function(e,t){t?e(o.UpdateIsChangeConfirmationDialogOpen(!0)):this.SaveFieldAndClose(e)},e.SaveFieldAndClose=function(e){this.dismissPanel(e),e(o.TriggerCategoryValuesFetch())},e.CloseWithoutSave=function(e){this.dismissPanel(e)},e.dismissPanel=function(e){e(o.UpdateIsEditorOpened(!1)),e(o.UpdateIsOptionSetSelectorOpened(!1))},e}();t.OptionSetRibbonOperations=i},679:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a,s=i(n(0)),l=n(26),c=n(410),u=n(89),d=n(1307),p=n(11),_=n(12);!function(e){e[e.SaveAndClose=0]="SaveAndClose",e[e.Cancel=1]="Cancel"}(a=t.ColumnEditorRibbonActionType||(t.ColumnEditorRibbonActionType={}));var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return s.createElement(c.RibbonBase,{items:this.getRibbonItems()})},t.prototype.getRibbonItems=function(){return[this.chooseSelectedButton(),this.verticleDivider(),this.cancelButton()]},t.prototype.verticleDivider=function(){return{key:"verticalDivider",onRender:function(){return s.createElement("div",{className:"ribbonButtonDivider"})}}},t.prototype.chooseSelectedButton=function(){var e=this;return{key:"saveAndClose",className:"ribbonBtn",name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE),disabled:this.props.isSaveCloseDisabled,iconProps:{iconName:"CheckMark",style:{color:"#107C10"}},onClick:function(){e.props.onClick(a.SaveAndClose)}}},t.prototype.cancelButton=function(){var e=this;return{key:"cancel",className:"ribbonBtn",name:p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE),iconProps:{iconName:"Cancel",style:{color:"#A80000"}},onClick:function(){e.props.onClick(a.Cancel)}}},t}(s.Component);t.ConnectedColumnEditorRibbon=l.connect((function(e){return{isSaveCloseDisabled:u.Get_IsColumnEditorRibbonSaveCloseDisabled_FromState(e)}}),(function(e){return{onClick:function(t){d.ColumnEditorRibbonOperations.OnClickHandler(e,t)}}}))(f)},680:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a,s=i(n(0)),l=n(26),c=n(410),u=n(1308),d=n(64),p=n(89),_=n(11),f=n(12);!function(e){e[e.CreateNewColumn=0]="CreateNewColumn",e[e.ChooseOptionSet=1]="ChooseOptionSet"}(a=t.ColumnOverviewRibbonActionType||(t.ColumnOverviewRibbonActionType={}));var E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){return s.createElement(c.RibbonBase,{items:this.getRibbonItems()})},t.prototype.getRibbonItems=function(){var e=void 0;return[e=this.props.isAddColumnHidden?this.addOptionSetButton(e):this.addColumnAndChooseOptionSetSplitButton(e)]},t.prototype.addOptionSetButton=function(e){var t=this;return{key:"createNew",disabled:this.props.isFormLocked,name:_.GlobalLocalizedStringsProvider.GetString(f.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_FROM_OPTION_SET),onClick:function(){t.props.onClick(a.ChooseOptionSet)},className:"ribbonBtn",iconProps:{iconName:"Add"},buttonStyles:{root:{}}}},t.prototype.addColumnAndChooseOptionSetSplitButton=function(e){var t=this;return{key:"createNew",name:_.GlobalLocalizedStringsProvider.GetString(f.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN),ariaLabel:_.GlobalLocalizedStringsProvider.GetString(f.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN),disabled:this.props.isFormLocked,className:"ribbonBtn",iconProps:{iconName:"Add"},split:!0,buttonStyles:{root:{},splitButtonMenuButton:{background:"none"}},subMenuProps:{items:[{key:"addOptionSet",name:_.GlobalLocalizedStringsProvider.GetString(f.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET),ariaLabel:_.GlobalLocalizedStringsProvider.GetString(f.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET),onClick:function(){t.props.onClick(a.ChooseOptionSet)}}]},onClick:function(){t.props.onClick(a.CreateNewColumn)}}},t}(s.Component);t.ConnectedColumnOverviewRibbon=l.connect((function(e){return{isAddColumnHidden:p.Get_IsAddColumnButtonHidden_FromState(e),isFormLocked:d.GetIsFormLocked_FromState(e)}}),(function(e){return{onClick:function(t){u.ColumnOverviewRibbonOperations.OnClickHandler(e,t)}}}))(E)},682:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(25),l=n(135),c=n(26),u=n(185),d=n(11),p=n(12),_=function(e){function t(t){var n=e.call(this,t)||this;return n._closeDialog=function(){n.props.onClickDeleteDialog(l.IDeleteDialogActionType.CLOSE)},n._onClickConfirm=function(){n.props.onClickDeleteDialog(l.IDeleteDialogActionType.DELETE)},n._onCancel=function(){n.props.onClickDeleteDialog(l.IDeleteDialogActionType.CANCEL)},n.state={},n}return o(t,e),t.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement(s.Dialog,{hidden:this.props.isHidden,onDismiss:this._closeDialog,modalProps:{styles:{main:{outline:"1px solid transparent !important"}}},dialogContentProps:{type:s.DialogType.normal,title:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DELETE_TITLE_GRIDPAGE),subText:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DELETE_DESCRIPTION_GRIDPAGE)}},a.default.createElement(s.DialogFooter,null,a.default.createElement(s.PrimaryButton,{onClick:this._onClickConfirm,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE)}),a.default.createElement(s.DefaultButton,{onClick:this._onCancel,text:d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE)}))))},t}(a.default.Component);t.ForecastConfigGridConfirmationDialog=_,t.default=_,t.ConnectedForecastConfigGridConfirmationDialog=c.connect((function(e){return{isHidden:e.gridAppDialogState.isGridDeleteDialogHidden,rowId:e.gridAppDialogState.gridActionableRow}}),(function(e){return{onClickDeleteDialog:function(t){return e(u.onClickDeleteDialogActionCreator(t))}}}))(_)},693:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(696)),i=n(697);o.unregister();var a=(new i.DelfiBootManager).boot;t.delfiConfigBoot=a},696:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function r(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}t.register=function(t){if("serviceWorker"in navigator){if(new URL(e.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var o=e.env.PUBLIC_URL+"/service-worker.js";n?(!function(e,t){fetch(e).then((function(n){var o=n.headers.get("content-type");404===n.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):r(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(o,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):r(o,t)}))}},t.unregister=function(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}}).call(this,n(87))},697:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n(433),a=n(913),s=r(n(0)),l=r(n(57)),c=r(n(914)),u=n(144),d=n(11),p=n(51),_=n(1359),f=n(544),E=function(){function e(){}return e.prototype.boot=function(e,t,n,r,o,_){void 0===n&&(n=""),m(_),-1!=window.location.href.indexOf("isNew")||i.resetStore(),d.GlobalLocalizedStringsProvider.UpdateCCFStringsProvider(r),f.NotificationProvider.Set(o);var E=new a.DelfiConfigActions(i.store.dispatch,i.store.getState);return i.store.dispatch(u.UpdateCrmClientUrlAndOrgId(t,n)),l.default.render(s.default.createElement(c.default,null),e),p.logInfo("DelfConfig.BootManager","Boot Completed",{}),E},e}();function m(e){p.addLogger(e);var t=o.ILogLevel.Debug,n=new _.ConsoleLogger(t);p.addLogger(n)}t.DelfiBootManager=E,t.InitLoggers=m},699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(211),o=n(700),i=n(702),a=n(703),s=n(704),l=n(705),c=n(435),u=n(706),d=n(707),p=n(708),_=n(709),f=n(435),E=n(710),m=n(711);t.rootReducer=r.combineReducers({gridFilterOption:i.gridAppActionsReducer,FormFieldData:o.formDataReducer,ActiveForecastConfigInfo:a.ActiveFCDataReducer,ForecastConfigList:a.FCListReducer,mainPageType:i.mainPageTypeReducer,crmOrgInfo:s.crmOrgInfoReducer,formUIState:o.formUIStateReducer,columnEditorState:c.columnEditorStateReducer,stepperActiveStage:l.editAppStepperActionsReducer,ForecastHierarchyList:u.HierarchyListReducer,isSavingDialogHidden:l.editAppStepperDialogActionsReducer,quotaUploadStageState:d.quotaUploadReducer,isFetchingHierarchyData:p.HierarchyPreviewReducer,gridAppDialogState:_.configGridDialogStateActionsReducer,PredictiveAvailabilityState:f.PredictiveAvailabilityStateReducer,genericErrorDialogState:E.utilityActionReducer,fdNotificationState:i.fdInformationStateReducer,entityMetadataList:s.entityMetadataReducer,orgSecurityRolesList:m.orgSecurityRolesListReducer})},700:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n(71);t.formDataReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.FormFieldData),t.type){case"@@FormData/UpdateFieldValue":return r({},e,t.payload.data);case"@@FormData/UpdateColumnInfoField":var n=e.columns.map((function(e){var n;return e.id==t.payload.colId?r({},e,((n={})[t.payload.fieldName]=t.payload.value,n)):e}));return r({},e,{columns:n});case"@@FormData/ClearRollupAndCalculatedColumns":n=e.columns.filter((function(e){return e.columnType!=o.ForecastColumnType.Rollup&&e.columnType!=o.ForecastColumnType.Calculated}));return r({},e,{columns:n});case"@@FormData/AddColumn":n=e.columns.concat([t.payload.column]);return r({},e,{columns:n});case"@@FormData/ReplaceColumn":n=e.columns.map((function(e){return e.id==t.payload.id?r({},t.payload.column):e}));return r({},e,{columns:n});case"@@FormData/DeleteColumn":return r({},e,{columns:e.columns.filter((function(e){return e.id!=t.payload.id}))});case"@@PreviewGrid/ReorderColumnsWithId":var a=e.columns.findIndex((function(e){return e.id==t.payload.dragColId})),s=e.columns.findIndex((function(e){return e.id==t.payload.targetColId})),l=e.columns[a],c=e.columns.slice();return c.splice(a,1),c.splice(s,0,l),r({},e,{columns:c});default:return e}},t.formUIStateReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.formUIState),t.type){case"@@FormUI/UpdateShowWarningsFlag":return r({},e,{showEmptyFieldWarnings:t.payload.showWarnings});default:return e}}},701:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=function(){function e(){var e;this.stringDict=((e={})[r.STRING_KEYS.FORECAST_CONFIG_TEMPLATE_HEADING_GRIDPAGE]="Recommended templates",e[r.STRING_KEYS.FORECAST_CONFIG_SUBHEADINGLINK_GRIDPAGE]="Learn more about forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_SUBHEADING_GRIDPAGE]="Seeing what’s next can mean smarter choices now. Choose a template below to get started, or configure one from scratch.",e[r.STRING_KEYS.FORECAST_CONFIG_HEADING_GRIDPAGE]="Fast-track your forecast",e[r.STRING_KEYS.FORECAST_CONFIG_CREATE_BUTTON_GRIDPAGE]="Start from scratch",e[r.STRING_KEYS.FC_TERRITORY_TEMPLATE_SUBHEADING_GRIDPAGE]="Structure your org’s data and predictions by sales regions",e[r.STRING_KEYS.FC_TERRITORY_TEMPLATE_HEADING_GRIDPAGE]="Territory forecast",e[r.STRING_KEYS.FC_PRODUCT_TEMPLATE_SUBHEADING_GRIDPAGE]="See rollups and projections based on product and product category hierarchies",e[r.STRING_KEYS.FC_PRODUCT_TEMPLATE_HEADING_GRIDPAGE]="Product-based forecast  (coming soon)",e[r.STRING_KEYS.FC_HIERARCHY_TEMPLATE_SUBHEADING_GRIDPAGE]="See rollups and projections based on your org’s reporting structure",e[r.STRING_KEYS.FC_HIERARCHY_TEMPLATE_HEADING_GRIDPAGE]="Org chart forecast",e[r.STRING_KEYS.FC_MORE_COMMANDS]="More actions",e[r.STRING_KEYS.FC_HIERARCHY_GRID_LABEL]="Hierarchy preview table",e[r.STRING_KEYS.FC_GRID_ARIA_LABEL]="Forecast config table",e[r.STRING_KEYS.FC_GRID_SELECTOR_PUBLISHED_GRIDPAGE]="Published",e[r.STRING_KEYS.FC_GRID_SELECTOR_DRAFTS_GRIDPAGE]="Drafts",e[r.STRING_KEYS.FC_GRID_SELECTOR_ARCHIVED_GRIDPAGE]="Inactive",e[r.STRING_KEYS.FC_GRID_SELECTOR_ALL_GRIDPAGE]="All",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_TO_GRIDPAGE]="To",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_STATUS_GRIDPAGE]="Status",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_PERIOD_GRIDPAGE]="Period",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_OWNER_GRIDPAGE]="Owner",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_FROM_GRIDPAGE]="From",e[r.STRING_KEYS.FC_GRID_COLUMN_NAME_FORECAST_GRIDPAGE]="Forecast name",e[r.STRING_KEYS.FC_EDIT_RIBBON_SAVE_EDITPAGE]="Save",e[r.STRING_KEYS.FC_EDIT_RIBBON_SAVE_AND_CLOSE_EDITPAGE]="Save & close",e[r.STRING_KEYS.FC_EDIT_RIBBON_DELETE_EDITPAGE]="Delete",e[r.STRING_KEYS.FC_EDIT_RIBBON_CLOSE_EDITPAGE]="Close",e[r.STRING_KEYS.FC_EDIT_STATUS_STATUS_EDITPAGE]="Status",e[r.STRING_KEYS.FC_EDIT_STATUS_TYPE_EDITPAGE]="Type",e[r.STRING_KEYS.FC_EDIT_STATUS_OWNER_EDITPAGE]="Owner",e[r.STRING_KEYS.FC_EDIT_FORECAST_TITLE_EDITPAGE]="Forecast configuration",e[r.STRING_KEYS.FC_EDIT_STEPPER_STAGE1_EDITPAGE]="General",e[r.STRING_KEYS.FC_EDIT_STEPPER_STAGE2_EDITPAGE]="Layout",e[r.STRING_KEYS.FC_EDIT_STEPPER_STAGE3_EDITPAGE]="Publish & Quota",e[r.STRING_KEYS.FC_EDIT_STEPPER_STAGE4_EDITPAGE]="Permissions",e[r.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_BACK_EDITPAGE]="Back",e[r.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_NEXT_EDITPAGE]="Next",e[r.STRING_KEYS.FC_EDIT_STEPPER_BUTTON_FINISH_EDITPAGE]="Finish",e[r.STRING_KEYS.FC_ROLLUP_ENTITY_STAGE1]="Rollup entity",e[r.STRING_KEYS.FC_HIERARCHY_ENTITY_STAGE1]="This hierarchy is made up of",e[r.STRING_KEYS.FC_TOP_OF_HIERARCHY_STAGE1]="Top user in hierarchy",e[r.STRING_KEYS.FC_TOP_OF_HIERARCHY2_STAGE1]="Top of hierarchy",e[r.STRING_KEYS.FC_FORECAST_PERIOD_STAGE1]="Forecast period",e[r.STRING_KEYS.FC_FISCAL_YEAR_STAGE1]="Fiscal year",e[r.STRING_KEYS.FC_FORECAST_START_AT_STAGE1]="Forecast starts at",e[r.STRING_KEYS.FC_NUMBER_OF_PERIODS_STAGE1]="Number of periods",e[r.STRING_KEYS.FC_VALID_FROM_STAGE1]="Valid from",e[r.STRING_KEYS.FC_VALID_TO_STAGE1]="Valid to",e[r.STRING_KEYS.FC_PREVIEW_HIERARCHY_NO_DATA_STAGE1]="No data to show",e[r.STRING_KEYS.FC_PREVIEW_HIERARCHY_SELECT_ENTITY_STAGE1]="Tell us your hierarchy type–and who’s on top–to see a preview here",e[r.STRING_KEYS.FC_PREVIEW_HIERARCHY_GENERATING_DATA_STAGE1]="Creating preview",e[r.STRING_KEYS.FC_PREVIEW_HIERARCHY_COLUMN]="User",e[r.STRING_KEYS.FC_LOADING]="Loading",e[r.STRING_KEYS.FC_ADD_FILTERS_TEXT]="Add filters",e[r.STRING_KEYS.FC_DIALOG_DELETE_TITLE_GRIDPAGE]="Confirm Delete",e[r.STRING_KEYS.FC_DIALOG_DELETE_DESCRIPTION_GRIDPAGE]="Are you sure you want to delete the Forecast Configuration?",e[r.STRING_KEYS.FC_DIALOG_DELETE_PRIMARYBUTTON_GRIDPAGE]="Delete",e[r.STRING_KEYS.FC_DIALOG_SECONDARYBUTTON_GRIDPAGE]="Cancel",e[r.STRING_KEYS.FC_DIALOG_PUBLISH_TITLE_GRIDPAGE]="Confirm Publish",e[r.STRING_KEYS.FC_DIALOG_PUBLISH_DESCRIPTION_GRIDPAGE]="Are you sure you want to publish the Forecast Configuration",e[r.STRING_KEYS.FC_DIALOG_PUBLISH_PRIMARYBUTTON_GRIDPAGE]="Publish",e[r.STRING_KEYS.FC_SCHEDULING_SECTION_HEADER_STAGE1]="Scheduling",e[r.STRING_KEYS.FC_SCHEDULING_SECTION_SUBTITLE_STAGE1]="Set the time period for your forecast",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_HEADER_STAGE1]="General properties",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_SUBTITLE_STAGE1]="Set your forecast type and rollup hierarchy",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_SUBTITLE2_STAGE1]="Choose your forecast model, select a hierarchy, and define a time span and frequency for calculating results.",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_SUBTITLE3_STAGE1]="Set your forecast type and rollup hierarchy",e[r.STRING_KEYS.FC_CONFIGURATION_SECTION_HEADER_STAGE1]="Configuration",e[r.STRING_KEYS.FC_COLUMN_OPTION_HEADER_STAGE2]="Layout and columns",e[r.STRING_KEYS.FC_COLUMN_OPTION_SUBHEADER_STAGE2]="Add and remove columns for your chosen template, and change order using drag-and-drop.",e[r.STRING_KEYS.FC_PUBLISH_HEADING]="Publish forecast",e[r.STRING_KEYS.FC_PUBLISH_TEXT]="Publishes forecast and begins auto-calculations. Forecast will be available to all users with access.",e[r.STRING_KEYS.FC_PUBLISH_SUCCESS]="Forecast successfully published",e[r.STRING_KEYS.FC_PUBLISH_INPROGRESS]="Publishing...",e[r.STRING_KEYS.FC_PUBLISH_FAILED]="Publish failed. Try again later.",e[r.STRING_KEYS.FC_QUOTA_HEADING]="Upload a quota for this forecast",e[r.STRING_KEYS.FC_QUOTA_TEXT_LINE1]="A quota can be uploaded anytime after the configuration is publihed.",e[r.STRING_KEYS.FC_QUOTA_TEXT_LINE2]="If a quota column was selected in the view step, but a quota file wasn’t uploaded it will not show in the forecast grid view.",e[r.STRING_KEYS.FC_QUOTA_DOWNLOAD_TEXT]="Download quota template",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_FILE]="Browse a file",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_LINE1]="Click to upload new quota",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_LINE2]="or drag & drop your quota file here",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_DRAG]="Drop your file here",e[r.STRING_KEYS.FC_QUOTA_UPLOADING]="Uploading",e[r.STRING_KEYS.FC_QUOTA_PROCESSING]="Processing",e[r.STRING_KEYS.FC_QUOTA_STEP1]="step 1/2",e[r.STRING_KEYS.FC_QUOTA_STEP2]="step 2/2",e[r.STRING_KEYS.FC_QUOTA_SUCCESS]="{0}, {1} processing succeeded",e[r.STRING_KEYS.FC_QUOTA_FAILED]="{0}, {1} processing failed ({2})",e[r.STRING_KEYS.FC_QUOTA_FAILED_UNKNOWN]="Unknown error occurred",e[r.STRING_KEYS.FC_QUOTA_FAILED_GUID_TAMPERED]="Mandatory guids have been tampered",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_ROWS]="Rows contain invalid data",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_CONTENT]="File contains invalid content",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_FILE]="Only excel files are allowed",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_SIZE]="File size should be less than {0}",e[r.STRING_KEYS.FC_COLUMN_EDITOR_IMPROPER_UNIQUE_NAME_MESSAGE]="The name must start with a letter. From there, use numbers, letters, or underscores. No spaces or special characters.",e[r.STRING_KEYS.FC_ERROR_DELETE_COLUMN_HEADER]="Cannot delete dependent column.",e[r.STRING_KEYS.FC_ERROR_DELETE_COLUMN_DEPENDENTLIST]="This column is being used by : {0}",e[r.STRING_KEYS.FC_QUOTA_FAILED_INVALID_FORECASTCONFIGURATION]="Excel contains invalid forecast configuration",e[r.STRING_KEYS.FC_QUOTA_UPLOAD_FAILED]="Upload Failed.Please try again later",e[r.STRING_KEYS.FC_QUOTA_FAILED_FETCH_FAILED]="Last quota upload fetch failed. Please try again later",e[r.STRING_KEYS.FC_COLUMN_OPTION_HEADER_STAGE2]="Column Options",e[r.STRING_KEYS.FC_COLUMN_OPTION_SUBHEADER_STAGE2]="Add or remove columns. To change the column order, drag and drop a field",e[r.STRING_KEYS.FC_OPTIONSET_PANEL_RIBBON_CHOOSE_SELECTED]="Choose selected",e[r.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_TITLE]="Overwrite current grid layout?",e[r.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_DESCRIPTION]="This replaces your current column configuration with that of the new template.",e[r.STRING_KEYS.FC_CHANGE_OPTIONSET_DIALOG_PRIMARY_BUTTON]="Replace",e[r.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_TITLE]="Auto-configure columns",e[r.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_DESCRIPTION]="Automatically populate forecast columns with standard configurations–or Cancel to manually configure each one.",e[r.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_PRIMARY_BUTTON]="Auto-configure",e[r.STRING_KEYS.FC_AUTOPOPULATE_DIALOG_NO_BUTTON]="Cancel",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_ROLLUP]="Rollup",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_CALCULATED]="Calculated",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA]="Quota",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_OWNER]="User",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_PRIMARY]="Hierarchy pivot",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_HIERARCHY_SECONDARY]="Hierarchy related",e[r.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_PREDICTIVE]="Predictive",e[r.STRING_KEYS.FC_COLUMN_EDITOR_NAME_SECTION]="Name",e[r.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SECTION]="Calculation",e[r.STRING_KEYS.FC_COLUMN_EDITOR_TYPE_SECTION]="Type",e[r.STRING_KEYS.FC_COLUMN_EDITOR_AMOUNT_FIELD_SECTION]="Amount field",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DATE_FIELD_SECTION]="Date field",e[r.STRING_KEYS.FC_COLUMN_EDITOR_SELECTOR_SECTION]="Selector",e[r.STRING_KEYS.FC_COLUMN_EDITOR_ALLOW_ADJUSTMENTS_SECTION]="Allow adjustments",e[r.STRING_KEYS.FC_COLUMN_EDITOR_SHOW_PROGRESS_SECTION]="Show progress compared to quota",e[r.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_SECTION]="Unique name",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DUPLICATE_UNIQUE_NAME_MESSAGE]="Unique name already exists.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_NAME_PLACEHOLDER]="Name this forecast column",e[r.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_PLACEHOLDER]="Enter Value",e[r.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER]="Name",e[r.STRING_KEYS.FC_COLUMN_EDITOR_CALCULATION_SUGGESTION_HEADER_SECONDARY]="Unique Name",e[r.STRING_KEYS.FC_COLUMN_EDITOR_TYPE_PLACEHOLDER]="Select a type",e[r.STRING_KEYS.FC_COLUMN_EDITOR_UNIQUE_NAME_PLACEHOLDER]="Unique Name for this forecast column",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_FORECASTING]="PREDICTIVE FORECASTING",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_PREDECTIVE_DESCRIPTION]="Harness the Power of AI to Predict your sales revenue.",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_LINK]="Learn more",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_DELETE_DIALOG_TITLE]="Delete the Column",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_DELETE_DIALOG_DESCRIPTION]="Deleting this column will also delete all its configuration",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_CONFIGURE]="Configure",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_DELETE]="Delete",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEUP]="Move up",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_CONTEXT_MENU_MOVEDOWN]="Move down",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_COLUMN]="Add column",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_CHANGE_OPTION_SET]="Change option set",e[r.STRING_KEYS.FC_PREVIEW_GRID_HEADING_STAGE2]="Preview",e[r.STRING_KEYS.FC_ADDITIONAL_FILTER_HEADING]="Additional filters",e[r.STRING_KEYS.FC_ADDITIONAL_FILTER_SUB_HEADING]="Apply additional filters to the forecast",e[r.STRING_KEYS.FC_OPTIONSET_PANEL_HEADER]="Select an option set from the list",e[r.STRING_KEYS.FC_OPTIONSET_PANEL_OPTION_SUBHEADER]="Columns",e[r.STRING_KEYS.FC_COLUMN_OVERVIEW_RIBBON_ADD_FROM_OPTION_SET]="Add from option set",e[r.STRING_KEYS.FC_COLUMN_SELECTOR_ROW_TOOLTIP_STATUS]="Required fields have not been filled",e[r.STRING_KEYS.FC_COLUMN_SELECTOR_ROW_TOOLTIP_LOCK]="The organization does not have active AI for Sales license",e[r.STRING_KEYS.FC_COLUMN_SELECTOR_QUOTA_ROW_TOOLTIP]="Be sure to upload quota data",e[r.STRING_KEYS.FC_COLUMN_EDITOR_DATEFIELD_HELPER]="Select a date field for the selected record type, such as Actual Closed Date for the Opportunity record type. A record participates in the goal rollup, if the selected date falls between the start date and the end date for the goal.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_OPTIONSET_HELPER]="Select the option set attribute of rollup entity which would be used to populate forecast categories.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_SELECTORFIELD_HELPER]="[ Option set ] value (from Power Apps) Select the state of the records you want to use as the source of the rollup data for the metric.",e[r.STRING_KEYS.FC_COLUMN_EDITOR_TYPEFIELD_HELPER]="Rollup Fields: Used to get an aggregate value calculated over the records related to a specific record, similar to using sum, min, max and count in Microsoft Excel",e[r.STRING_KEYS.FC_COLUMN_EDITOR_AMOUNTFIELD_HELPER]="Type the name of the field that the data for the goal rolls up from.",e[r.STRING_KEYS.FC_CRM_DELETING_CALLS]="Deleting",e[r.STRING_KEYS.FC_CRM_PUBLISHING_CALLS]="Publishing",e[r.STRING_KEYS.FC_CRM_SAVING_CALLS]="Saving",e[r.STRING_KEYS.FC_CRM_PROCESSING_CALLS]="Processing",e[r.STRING_KEYS.FC_GRID_PUBLISH_CONTEXTUALBUTTON_GRIDPAGE]="Publish",e[r.STRING_KEYS.FC_GRID_EDIT_CONTEXTUALBUTTON_GRIDPAGE]="Edit",e[r.STRING_KEYS.FC_GRID_DELETE_CONTEXTUALBUTTON_GRIDPAGE]="Delete",e[r.STRING_KEYS.FC_EDIT_FIELD_MANDATORY_MESSAGE]="Field cannot be empty",e[r.STRING_KEYS.FC_STAGE1_ROLLUP_ENTITY_HELPTEXT]="Rollup entity is set by your template choice. To change it, use a different template.",e[r.STRING_KEYS.FC_STAGE1_HIERARCHY_ENTITY_HELPTEXT]="Hierarchy type is set by your template choice. To change it, use a different template.",e[r.STRING_KEYS.FD_NOTIFICATION_MESSAGE]="Please use forecast configuration to configure your forecasts instead of forecast definition.",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_PUBLISH_FAILURE]="Failure has occurred, while publishing Forecast configuration. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_DELETE_FAILURE]="Failure has occurred, while deleting Forecast configuration. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_UPDATE_FAILURE]="Failure has occurred, while updating Forecast configuration. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_RETREIVE_HIERARCHY_FAILURE]="Failure has occurred, while retrieving hierarchy data. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_RETREIVE_METADATA_FAILURE]="Failure has occurred, while retrieving metadata. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FORECAST_CONFIG_GENERIC_RETREIVE_ORGANIZATION_INFO_FAILURE]="Failure has occured, while retrieving organization information. Please retry or contact Dynamic Sales Forecasting",e[r.STRING_KEYS.FC_GRID_DEACTIVATE_CONTEXTUALBUTTON_GRIDPAGE]="Deactivate",e[r.STRING_KEYS.FC_WARNING_FD_REMOVED_FC_ADDED]="Warning: Forecast definitions have been removed and replaced by Forecast configurations.",e[r.STRING_KEYS.FC_WARNING_READ_MORE]="Please read more.",e[r.STRING_KEYS.FC_DELETE_FAILURE_TITLE]="Forecast couldn't be deleted",e[r.STRING_KEYS.FC_PUBLISH_FAILED_MORE_THAN_SIX]="Maximum limit of 6 published forecast configurations reached. Please remove any existing forecast configuration to continue.",e[r.STRING_KEYS.FC_PUBLISH_FAILURE_TITLE]="Forecast wasn't published",e[r.STRING_KEYS.FC_CREATE_FAILURE_TITLE]="Forecast couldn't be created",e[r.STRING_KEYS.FC_UPDATE_FAILURE_TITLE]="Problem updating forecast",e[r.STRING_KEYS.FC_FETCHING_ORG_FAILURE_TITLE]="Problem loading org info",e[r.STRING_KEYS.FC_ERROR_SOMETHING_WENT_WRONG_TITLE]="Something went wrong",e[r.STRING_KEYS.FC_FETCHING_FAILURE_TITLE]="Problem loading forecast",e[r.STRING_KEYS.FC_ERROR_TRY_AGAIN_DESC]="Try again, or contact Dynamics Sales Forecasting if the problem persists.",e[r.STRING_KEYS.FC_HIERARCHY_FAILURE_DESC]="Hierarchy data didn't come through. Try again, or contact Dynamics Sales Forecasting if the problem persists.",e[r.STRING_KEYS.FC_ORG_DETAILS_DESC]="Some metadata didn't load. Try again, or contact Dynamics Sales Forecasting if the problem persists.",e[r.STRING_KEYS.FC_FETCHING_FAILURE_DESC]="Forecast data didn't come through. Try again, or contact Dynamics Sales Forecasting if the problem persists.",e[r.STRING_KEYS.FC_OK]="OK",e[r.STRING_KEYS.FC_TEMPLATE_TYPE_ORG_CHART]="Org Chart",e[r.STRING_KEYS.FC_Title]="forecast configuration title",e[r.STRING_KEYS.FC_Date]="Select a date..",e[r.STRING_KEYS.FC_Number]="Select a number",e[r.STRING_KEYS.FC_Increase]="Increase value by 1",e[r.STRING_KEYS.FC_Decrease]="Decrease value by 1",e[r.STRING_KEYS.FC_TEMPLATE_TYPE_TERRITORY_BASED]="Territory forecast",e[r.STRING_KEYS.FC_TERRITORY_ENTITY_DISPLAYNAME]="Territory",e[r.STRING_KEYS.FC_TOP_OF_HIERARCHY_WITH_PLACEHOLDER_STAGE1]="Top {0} in hierarchy",e[r.STRING_KEYS.FC_FORM_LOAD_ERROR_INVALID_TEMPLATE_TYPE]="Invalid template type received for forecast configuration create page.",e[r.STRING_KEYS.FC_FORM_LOAD_ERROR_MISSING_TEMPLATE_TYPE]="Template type is required for forecast configuration create page.",e[r.STRING_KEYS.FC_FORM_LOAD_ERROR_MISSING_FCID]="Forecast configuration id is required for edit page.",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_TWO_LEVELS]="{0} > {1}",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_THREE_LEVELS]="{0} > {1} > {2}",e[r.STRING_KEYS.FC_HIERARCHY_ROUTE_FIELD_LABEL]="Hierarchy route",e[r.STRING_KEYS.FC_PERMISSIONS_ATTRIBUTE_NONE]="None",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_TITLE]="Select user verification field",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_PERMISSIONATTRIBUTE_HEADER_SUBTITLE]="Select the field on which security to be applied",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ENTITY_FIELD_LABEL]="Hierarchy entity",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_HIERARCHY_ATTRIBUTE_FIELD_LABEL]="Field",e[r.STRING_KEYS.FC_HIERARCHY_REL_NOT_PRESENT_MESSAGE]="Hierarchy relationship is not enabled for {0} entity. Please contact your system administrator.",e[r.STRING_KEYS.FC_HIERARCHY_REL_NOT_PRESENT_DIALOG_HEADER]="Configuration error",e[r.STRING_KEYS.FC_PERMISSIONS_STAGE_ROLE_PICKER_ITEM_REMOVE_BUTTON_TOOLTIP]="Remove role",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_ONLY]="The permission user only can view and adjust their forecasts. ",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_ROLE_ONLY]="All forecasts for this forecast configuration can be viewed only by the users with selected roles but no one can adjust them.",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_ALLOW_ALL_ONLY]="All forecasts for this forecast configuration can be viewed by all users and no one can adjust them.",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_AND_ROLE]="All forecasts for this forecast configuration can be viewed by users with the selected roles. The permission user only can adjust their forecasts.",e[r.STRING_KEYS.FC_PERMISSIONS_MESSAGE_USER_AND_ALLOW_ALL]="All forecasts for this forecast configuration can be viewed by all users. The permission user only can adjust their forecasts.",e[r.STRING_KEYS.FC_PERMISSIONS_MANDATORY_ERROR_MESSAGE]="You must choose a user or a role in one of the fields above.",e)}return e.prototype.getLocalizedString=function(e){return this.stringDict[e]},e}();t.DefaultLocalizedStringsProvider=o},702:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(71);t.gridAppActionsReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.gridFilterOption),t.type){case"@@GridApp/ON_GRID_SELECTOR_CHANGE":return t.payload.selectedvalue;default:return e}return e},t.mainPageTypeReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.mainPageType),t.type){case"@@mainPage/ChangeType":return t.payload.newType;default:return e}return e},t.fdInformationStateReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.fdNotificationState),t.type){case"@@delfiConfig/UpdateFDPresent":return r({},e,{arePublishedFDsPresent:t.payload.fdPresent});case"@@delfiConfig/DismissFDNotification":return r({},e,{isDismissed:t.payload.dismiss});default:return e}return e}},703:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(71);t.ActiveFCDataReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.ActiveForecastConfigInfo),t.type){case"@@ActiveForecastConfig/Update":return r({},t.payload.forecastConfig);default:return e}},t.FCListReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.ForecastConfigList),t.type){case"@@FCList/Update":return t.payload.forecastConfigList.slice();default:return e}}},704:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(71);t.crmOrgInfoReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.crmOrgInfo),t.type){case"@@CrmOrgInfo/UpdateClientUrlAndOrgId":return r({},e,{clientUrl:t.payload.url,orgId:t.payload.orgId});case"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate":return r({},e,{calenderStartDate:t.payload.fiscalStartDate});case"@@CrmOrgInfo/UpdateSIPackageStatus":return r({},e,{isSIPackageInstalled:t.payload.isInstalled});default:return e}return e},t.entityMetadataReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.entityMetadataList),t.type){case"@@Metadata/SetEntityMetadata":return r({},e,t.payload.value)}return e}},705:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.editAppStepperActionsReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.stepperActiveStage),t.type){case"@@EditApp/ON_STEP_CLICK":return t.payload.activeStage;default:return e}return e},t.editAppStepperDialogActionsReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.isSavingDialogHidden),t.type){case"@@EditApp/ON_UPDATE_DIALOG_STATE":return t.payload.dialogHiddenState;default:return e}return e}},706:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.HierarchyListReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.ForecastHierarchyList),t.type){case"@@PreviewGrid/AddGridHierarchyData":return t.payload.forecastHierarchyList.slice();case"@@PreviewGrid/ClearGridHierarchyData":return[];default:return e}}},707:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(71);t.quotaUploadReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.quotaUploadStageState),t.type){case"@@EditApp/QuotaUploadStatusUpdateAction":return r({},e,{quotaStatusInfo:t.payload.quotaUploadStatus});case"@@EditApp/QuotaUploadFetchUpdateAction":return r({},e,{isFetched:t.payload.isFetched});case"@@EditApp/QuotaUploadDownloadUpdateAction":return r({},e,{isDownload:t.payload.isDownload});case"@@EditApp/QuotaUploadPublishUpdateAction":return r({},e,{isPublishing:t.payload.isPublishing});default:return e}}},708:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.HierarchyPreviewReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.isFetchingHierarchyData),t.type){case"@@HierarchyPreview/FetchHierarchyStarted":return!0;case"@@HierarchyPreview/FetchHierarchyCompleted":return!1;default:return e}}},709:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(71);t.configGridDialogStateActionsReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.gridAppDialogState),t.type){case"@@GridApp/ON_UPDATE_DIALOG_DELETE_STATE":return r({},e,{isGridDeleteDialogHidden:t.payload.gridAppDeletedialogHiddenState});case"@@GridApp/ON_UPDATE_DIALOG_PUBLISH_STATE":return r({},e,{isGridPublishDialogHidden:t.payload.gridAppPublishedialogHiddenState});case"@@GridApp/ROW_SELECTED":return r({},e,{gridActionableRow:t.payload.rowSelected});default:return e}return e}},71:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(174),o=n(97),i=n(135),a=n(434),s=n(108),l=n(17),c=n(88);t.initialAppState={mainPageType:r.IMainPageType.GridPage,ForecastConfigList:[],ForecastHierarchyList:[],ActiveForecastConfigInfo:o.GetEmptyForecastConfigInfo(),FormFieldData:o.GetEmptyForecastConfigInfo(),stepperActiveStage:s.ForecastConfigStage.General,isSavingDialogHidden:!0,gridFilterOption:i.IForecastConfigFilterOptions.All,crmOrgInfo:{calenderStartDate:"",clientUrl:"",orgId:"",isSIPackageInstalled:!1},formUIState:{showEmptyFieldWarnings:!1},columnEditorState:a.initialForecastColumnEditorState,quotaUploadStageState:o.GetEmptyQuotaStageStatus(),isFetchingHierarchyData:!1,gridAppDialogState:i.GetInitialForecastConfigGridAppDialogState(),PredictiveAvailabilityState:l.PredictiveAvailabilityStateType.FcbOff,genericErrorDialogState:c.GetDefaultErrorDialogState(),fdNotificationState:{arePublishedFDsPresent:!1,isDismissed:!1},entityMetadataList:{},orgSecurityRolesList:[]}},710:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(71);t.utilityActionReducer=function(e,t){switch(void 0===e&&(e=o.initialAppState.genericErrorDialogState),t.type){case"@@Utility/OnOkErrorDialogClick":return r({},e,{isDialogHidden:t.payload.isErrorDialogHidden});case"@@Utility/OnErrorShowDialog":return{dialogType:t.payload.errorDialogType,isDialogHidden:t.payload.isErrorDialogHidden,customMessage:t.payload.message};default:return e}}},711:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(71);t.orgSecurityRolesListReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.orgSecurityRolesList),t.type){case"@@OrgSecurityRoles/SetSecurityRolesInState":return t.payload.roles}return e}},712:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(713),i=n(82),a=n(714),s=n(64),l=n(72),c=n(144),u=n(98),d=n(88);function p(e,t){var n=r({},e().FormFieldData);return{periodType:E(_("period",t.payload.data,n)),startMonth:parseInt(_("startAtMonth",t.payload.data,n)),startQuarter:parseInt(_("startAtQuater",t.payload.data,n)),numRecurrences:_("numberOfRecurrences",t.payload.data,n),year:o.YEAR_OFFSET+parseInt(_("fiscalyear",t.payload.data,n)),calenderStart:m(e)}}function _(e,t,n){return Object.keys(t).indexOf(e)>0?t[e]:n[e]}function f(e,t,n){var r=function(e){return new o.DefaultScheduleFieldsProvider(new Date,m(e))}(t);n(i.UpdateFieldValue({fiscalyear:(r.GetYear(e==a.ForecastPeriodType.Quarterly)-o.YEAR_OFFSET).toString(),startAtQuater:r.GetStartQuarter().toString(),startAtMonth:r.GetStartMonth().toString()}))}function E(e){return"0"==e?a.ForecastPeriodType.Monthly:a.ForecastPeriodType.Quarterly}function m(e){return e().crmOrgInfo.calenderStartDate}t.scheduleCalculationMiddleware=function(e){var t=e.getState,n=e.dispatch;return function(e){return function(r){if("@@CrmOrgInfo/TriggerFetchOrgFiscalCalenderStartDate"==r.type&&""===m(t))!function(e,t){e.getOrgFiscalCalendarStartDate().then((function(e){t(c.UpdateOrgFiscalCalenderStartDate(e))})).catch((function(){t(u.onErrorShowDialogActionCreator(d.IErrorDialogType.FetchingOrgDetailsFailed))}))}(l.getCrmDataAccessInstance().organizationDataAccess,n);else{if("@@mainPage/ChangeType"==r.type||"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate"==r.type){var o=e(r);return s.GetIsFormInCreateMode_FromState(t())&&""!==m(t)&&function(e){var t=e().FormFieldData;return["numberOfRecurrences","startAtMonth","startAtQuater","period","fiscalyear"].some((function(e){return void 0===t[e]||""===t[e]}))}(t)&&f(a.ForecastPeriodType.Quarterly,t,n),o}if("@@FormData/UpdateFieldValue"==r.type){if(function(e,t){var n=e().FormFieldData.period;return void 0!==t.payload.data.period&&null!==t.payload.data.period&&1==Object.keys(t.payload.data).length&&n!==t.payload.data.period}(t,r)){!function(e){e.payload.data.fiscalyear=void 0,e.payload.data.startAtMonth=void 0,e.payload.data.startAtQuater=void 0,e.payload.data.numberOfRecurrences=1}(r);o=e(r);return f(E(r.payload.data.period),t,n),o}if(function(e){var t=["numberOfRecurrences","startAtMonth","startAtQuater","period","fiscalyear"];return Object.keys(e.payload.data).every((function(e){return t.indexOf(e)>-1}))}(r))return function(e,t,n){var r=e(t);return function(e,t){var n=new a.ScheduleCalculator(e),r={fromDate:n.startDate().toDateString(),toDate:n.endDate().toDateString()};t(i.UpdateFieldValue(r))}(p(n,t),e),r}(e,r,t)}}return e(r)}}}},713:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.YEAR_OFFSET=2018;var r=function(){function e(e,t){this.curDate=e,this.calStart=new Date(t)}return e.prototype.GetYear=function(e){return void 0===e&&(e=!0),e&&this.curDate.getMonth()-this.calStart.getMonth()<0?this.curDate.getFullYear()-1:this.curDate.getFullYear()},e.prototype.GetStartQuarter=function(){return Math.floor((12+this.curDate.getMonth()-this.calStart.getMonth())/3)%4},e.prototype.GetStartMonth=function(){return this.curDate.getMonth()},e}();t.DefaultScheduleFieldsProvider=r},714:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.input=e}return e.prototype.startDate=function(){return this.input.periodType==o.Quarterly?new i(this.input).startDate():new Date(this.input.year,this.input.startMonth,1)},e.prototype.endDate=function(){return this.input.periodType==o.Quarterly?new i(this.input).endDate():new Date(this.input.year,this.input.startMonth+this.input.numRecurrences,0)},e}();t.ScheduleCalculator=r;var o,i=function(){function e(e){this.input=e}return e.prototype.startDate=function(){if(!this.input.calenderStart)throw new Error("Please provide calenderStart");var e=new Date(this.input.calenderStart);return e.setFullYear(this.input.year),e.setMonth(e.getMonth()+3*this.input.startQuarter),e.setDate(1),e},e.prototype.endDate=function(){if(!this.input.calenderStart)throw new Error("Please provide calenderStart");var e=new Date(this.input.calenderStart);return e.setFullYear(this.input.year),e.setMonth(e.getMonth()+3*(this.input.startQuarter+this.input.numRecurrences)),e.setDate(0),e},e}();!function(e){e[e.Quarterly=0]="Quarterly",e[e.Monthly=1]="Monthly"}(o=t.ForecastPeriodType||(t.ForecastPeriodType={}))},72:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(137),i=n(351),a=n(889),s=n(890),l=n(891),c=n(892),u=n(893),d=n(894),p=n(895),_=n(500);t.createCrmDataAccessFromCrmUrl=function(e,t){var n=_.create({baseURL:e}),r=o.createCDSClientWithHttpClient(n),f=new i.CDSResolver(r);return{cdsResolver:f,cdsClient:r,forecastConfigAccess:new a.ForecastConfigDataAccess(n),hierarchyDataAccess:new s.HierarchyDataAccess(n,f),quotaDataAccess:new l.QuotaDataAccess(n),organizationDataAccess:new c.OrganizationDataAccess(n,t),forecastDefintionDataAccess:new u.ForecastDefinitionDataAccess(n),siDataAccess:new d.SIDataAccess(n),roleDataAccess:new p.RoleDataAccess(n)}},t.getCrmDataAccessInstance=function(){return r},t.setCrmDataAccessInstsance=function(e){console.log("Setting Global CrmDataAccess instance"),r=e}},721:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(458),o=n(723),i=n(17),a=n(228),s=n(724),l=n(136),c=function(){function e(){this.lexAnalyzer=new r.LexicalAnalyzer,this.syntaxAnalyzer=new o.SyntaxAnalyzer,this.columnReferencesValidator=new s.ColumnReferencesValidator(this.lexAnalyzer)}return e.prototype.parseExpression=function(e,t,n,r){a.Validations.validateNullArgument(e,"expression"),a.Validations.validateNullArgument(t,"config");var o=this.lexAnalyzer.parseExpressionToTokens(e),i=this.syntaxAnalyzer.parseTokensToAST(o);return this.columnReferencesValidator.validateColumnReferences(o,t,n,r),JSON.stringify(i)},e.prototype.getReferencingCalculatedColumns=function(e,t){var n=this;a.Validations.validateNullArgument(e,"forecastConfig"),a.Validations.validateNullArgument(t,"columnId");var r=[],o=e.columns&&e.columns.find((function(e){return e.id===t}));if(o){var i=o.uniqueName,s=this.getAllCalculatedColumns(e);s&&s.forEach((function(e){if(e.calculatedFieldExpression){var t=n.lexAnalyzer.parseExpressionToTokens(e.calculatedFieldExpression);n.doesColumnIdentifierTokenExist(t,i)&&r.push(e)}}))}return r},e.prototype.getAllCalculatedColumns=function(e){return e.columns.filter((function(e){return e.columnType===i.ForecastColumnType.Calculated}))},e.prototype.doesColumnIdentifierTokenExist=function(e,t){return e&&e.some((function(e){return e.tokenType===l.TokenType.Identifier&&e.value===t}))},e}();t.ExpressionParser=c},722:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n,r){this.tokenType=e,this.value=t,this.index=n,this.length=r};t.Token=r},723:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(136),o=n(228),i=n(331),a=n(230),s=n(229),l=function(){function e(){}return e.prototype.parseTokensToAST=function(e){o.Validations.validateNullArgument(e,"tokens");var t=this.getExpression(e,0),n=t[0],r=t[1];return n<e.length&&this.throwInvalidTokenError(e[n]),{root:r}},e.prototype.getExpression=function(e,t){if(t>=e.length)throw new i.ParseError(a.ExpressionParseErrors.MissingOperand);var n="",o=0,s=[r.TokenType.Number,r.TokenType.Identifier,r.TokenType.LeftParenthesis],l=e[t];if(s.includes(l.tokenType)){var c=this.getTerm(e,t),u=c[0],d=c[1],p=this.getExpressionSuffix(e,t+u),_=p[0],f=p[1],E=p[2];o=u+_,n=null!==f&&null!==E?{left:d,operator:f,right:E}:d}else this.throwInvalidTokenError(l);return[o,n]},e.prototype.getTerm=function(e,t){if(t>=e.length)throw new i.ParseError(a.ExpressionParseErrors.MissingOperand);var n="",o=0,s=[r.TokenType.Number,r.TokenType.Identifier,r.TokenType.LeftParenthesis],l=e[t];if(s.includes(l.tokenType)){var c=this.getFactor(e,t),u=c[0],d=c[1],p=this.getTermSuffix(e,t+u),_=p[0],f=p[1],E=p[2];o=u+_,n=null!==f&&null!==E?{left:d,operator:f,right:E}:d}else this.throwInvalidTokenError(l);return[o,n]},e.prototype.getExpressionSuffix=function(e,t){var n=0,o=null,i=null;if(t<e.length){var a=e[t];if(a.tokenType===r.TokenType.Plus||a.tokenType===r.TokenType.Minus){n+=1,o=a.value;var s=this.getExpression(e,t+n);n+=s[0],i=s[1]}else a.tokenType!==r.TokenType.Divide&&a.tokenType!==r.TokenType.Multiple&&a.tokenType!==r.TokenType.RightParenthesis&&this.throwInvalidTokenError(a)}return[n,o,i]},e.prototype.getFactor=function(e,t){if(t>=e.length)throw new i.ParseError(a.ExpressionParseErrors.MissingOperand);var n="",o=0,s=(r.TokenType.Number,r.TokenType.Identifier,r.TokenType.LeftParenthesis,e[t]);if(s.tokenType===r.TokenType.Number)o=1,n=Number(s.value);else if(s.tokenType===r.TokenType.Identifier)o=1,n=s.value;else if(s.tokenType===r.TokenType.LeftParenthesis){o+=1;var l=this.getExpression(e,t+o),c=l[0];n=l[1];var u=t+(o+=c);if(!(u<e.length&&e[u].tokenType===r.TokenType.RightParenthesis))throw new i.ParseError(a.ExpressionParseErrors.MissingRightParenthesis);o+=1}else this.throwInvalidTokenError(s);return[o,n]},e.prototype.getTermSuffix=function(e,t){var n=0,o=null,i=null;if(t<e.length){var a=e[t];if(a.tokenType===r.TokenType.Multiple||a.tokenType===r.TokenType.Divide){n+=1,o=a.value;var s=this.getTerm(e,t+n);n+=s[0],i=s[1]}else a.tokenType!==r.TokenType.Plus&&a.tokenType!==r.TokenType.Minus&&a.tokenType!==r.TokenType.RightParenthesis&&this.throwInvalidTokenError(a)}return[n,o,i]},e.prototype.throwInvalidTokenError=function(e){throw new i.ParseError(s.StringFormatter.formatString(a.ExpressionParseErrors.UnexpectedTokens,this.tokenTypeToMsg(e.tokenType),(e.index+1).toString()),e.index)},e.prototype.tokenTypeToMsg=function(e){var t="";return e===r.TokenType.LeftParenthesis?t="(":e===r.TokenType.RightParenthesis?t=")":e===r.TokenType.Plus||e===r.TokenType.Minus||e===r.TokenType.Multiple||e===r.TokenType.Divide?t="operator":e===r.TokenType.Identifier?t="column reference":e===r.TokenType.Number&&(t="number"),t},e}();t.SyntaxAnalyzer=l},724:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(136),o=n(17),i=n(229),a=n(331),s=n(230),l=n(459),c=function(){function e(e){this.lexicalAnalyzer=e}return e.prototype.validateColumnReferences=function(e,t,n,c){e.forEach((function(e){if(e.tokenType===r.TokenType.Identifier){var n=e.value,c=void 0;if(t.columns&&t.columns.length>0&&(c=t.columns.find((function(e){return e.uniqueName===n}))),void 0===c)throw new a.ParseError(i.StringFormatter.formatString(s.ExpressionParseErrors.InvalidColumnRef,n,(e.index+1).toString()),e.index);if(!l.ExpressionParserUtils.isValidDependencyType(c.columnType))throw new a.ParseError(i.StringFormatter.formatString(s.ExpressionParseErrors.InvalidColumnType,n,(e.index+1).toString(),c.columnType?o.ForecastColumnType[c.columnType]:""),e.index)}})),n=n||"_root",this.detectCircularDependency(e,t,n,c)},e.prototype.detectCircularDependency=function(e,t,n,r){var o=this,l=this.createDependencyGraph(e,t,n,r),c=new Map;c.set(n,!0);var u=l.get(n);u&&u.forEach((function(e){if(e===n)throw new a.ParseError(s.ExpressionParseErrors.SelfReference);if(o.detectCycleRecursive(n,e,l,c))throw new a.ParseError(i.StringFormatter.formatString(s.ExpressionParseErrors.CircularDependency,e))}))},e.prototype.detectCycleRecursive=function(e,t,n,r){var o=!1;r.set(t,!0);var i=n.get(t);if(i)for(var a=0;a<i.length;a++){var s=i[a];if(s===e||!r.get(s)&&this.detectCycleRecursive(e,s,n,r)){o=!0;break}}return o},e.prototype.createDependencyGraph=function(e,t,n,r){var i=this,a=new Map;return a.set(n,this.findCalculatedColumns(e,t,n)),t&&t.columns&&t.columns.forEach((function(e){if(e&&e.columnType===o.ForecastColumnType.Calculated&&e.calculatedFieldExpression&&(void 0===r||e.id!==r)){var s=i.lexicalAnalyzer.parseExpressionToTokens(e.calculatedFieldExpression);a.set(e.uniqueName,i.findCalculatedColumns(s,t,n))}})),a},e.prototype.findCalculatedColumns=function(e,t,n){var i=[];return e.forEach((function(e){if(e.tokenType===r.TokenType.Identifier){var a=e.value;if(a===n)i.push(n);else{var s=void 0;t.columns&&t.columns.length>0&&(s=t.columns.find((function(e){return e.uniqueName===a}))),s&&s.columnType===o.ForecastColumnType.Calculated&&i.push(s.uniqueName)}}})),i},e}();t.ColumnReferencesValidator=c},725:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(458),o=n(228),i=n(726),a=n(136),s=n(459),l=n(45),c=function(){function e(){this.lexAnalyzer=new r.LexicalAnalyzer}return e.prototype.getSuggestions=function(e,t,n,r){o.Validations.validateNullArgument(e,"expression"),o.Validations.validateNullArgument(t,"config"),n<0&&(n=0);var l=this.lexAnalyzer.parseExpressionToTokens(e,!0),c=this.getNearestLeftToken(l,n),u=[];return void 0===c||s.ExpressionParserUtils.isOperator(c.tokenType)||c.tokenType===a.TokenType.LeftParenthesis?u=this.getForecastColumnSuggestions(t,"",r):c.tokenType===a.TokenType.Identifier&&(u=this.getForecastColumnSuggestions(t,c.value,r)),new i.Suggestions(u,c&&c.tokenType===a.TokenType.Identifier?c:void 0)},e.prototype.applySuggestion=function(e,t,n,r){o.Validations.validateNullArgument(e,"expression"),o.Validations.validateNullArgument(t,"columnUniqueName"),n<0&&(n=0);var i=void 0===r?n:r.index,a=void 0===r?0:r.length;return e.substring(0,i)+t+e.substring(i+a)},e.prototype.getNearestLeftToken=function(e,t){var n;if(e&&e.length>0)for(var r=0;r<e.length;r++){var o=e[r];if(o.tokenType===a.TokenType.Identifier&&o.index<=t)n=o;else{if(!(o.index<t))break;n=o}}return n},e.prototype.getForecastColumnSuggestions=function(e,t,n){var r=[];return e.columns&&e.columns.forEach((function(e){e.id!==n&&s.ExpressionParserUtils.isValidDependencyType(e.columnType)&&(void 0===t||e.uniqueName.toLowerCase().startsWith(t.toLowerCase())||e.title.toLowerCase().startsWith(t.toLowerCase()))&&r.push(e)})),r.sort(l.ForecastingBusinessLogicProvider.sortBasedOnDisplayName)},e}();t.SuggestionsProvider=c},726:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.forecastColumns=e,this.targetToken=t};t.Suggestions=r},732:function(e,t){},734:function(e,t){},768:function(e,t){},769:function(e,t){},82:function(e,t,n){"use strict";function r(){return{type:"@@FormEvents/FormRefreshed",payload:{}}}Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateFieldValue=function(e){return{type:"@@FormData/UpdateFieldValue",payload:{data:e}}},t.TriggerEditFormDiscard=function(e,t){return{type:"@@FormData/DiscardValue",payload:{shouldDiscardSelectedFields:e,fields:t}}},t.UpdateActiveForecastConfig=function(e){return{type:"@@ActiveForecastConfig/Update",payload:{forecastConfig:e}}},t.UpdateForecastConfigList=function(e){return{type:"@@FCList/Update",payload:{forecastConfigList:e}}},t.UpdateShowWarningsFlag=function(e){return{type:"@@FormUI/UpdateShowWarningsFlag",payload:{showWarnings:e}}},t.TriggerUndoColumnFormChanges=function(){return{type:"@@SaveEvents/TriggerUndoColumnFormChanges",payload:{}}},t.TriggerSave=function(e,t){return{type:"@@SaveEvents/TriggerSave",payload:{shouldClose:e,shouldCloseColumnEditorForm:t}}},t.TriggerFormRefreshed=r},88:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.GenericFailure=0]="GenericFailure",e[e.ForecastConfigDeleteFailed=1]="ForecastConfigDeleteFailed",e[e.ForecastConfigPublishFailed=2]="ForecastConfigPublishFailed",e[e.FetchingHierarchyDataFailed=3]="FetchingHierarchyDataFailed",e[e.RetreivingMetadataFailed=4]="RetreivingMetadataFailed",e[e.FetchingOrgDetailsFailed=5]="FetchingOrgDetailsFailed",e[e.ForecastConfigUpdateFailed=6]="ForecastConfigUpdateFailed",e[e.ForecastConfigFetchingFailed=7]="ForecastConfigFetchingFailed",e[e.ForecastConfigCreateFailed=8]="ForecastConfigCreateFailed",e[e.ForecastConfigFormLoadError=9]="ForecastConfigFormLoadError",e[e.ForecastConfigColDeleteFailed=10]="ForecastConfigColDeleteFailed",e[e.HierarchyRelationsDoesntExistDialog=11]="HierarchyRelationsDoesntExistDialog"}(r=t.IErrorDialogType||(t.IErrorDialogType={})),t.GetDefaultErrorDialogState=function(){return{dialogType:r.GenericFailure,isDialogHidden:!0,customMessage:""}}},888:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllLabelsMap={contains:{local:"Contains",resourceIdentifier:"Web._tools.search.search.js_12_2"},doesNotContain:{local:"Does not contain",resourceIdentifier:"Web._tools.search.search.js_12_3_SentenceCase"},beginsWith:{local:"Begins with",resourceIdentifier:"Web._tools.search.search.js_12_4_SentenceCase"},doesNotBeginWith:{local:"Does not begin with",resourceIdentifier:"Web._tools.search.search.js_12_5_SentenceCase"},endsWith:{local:"Ends with",resourceIdentifier:"Web._tools.search.search.js_12_6_SentenceCase"},doesNotEndWith:{local:"Does not end with",resourceIdentifier:"Web._tools.search.search.js_12_7_SentenceCase"},containsData:{local:"Contains data",resourceIdentifier:"Web._tools.search.search.js_12_8_SentenceCase"},doesNotContainData:{local:"Does not contain data",resourceIdentifier:"Web._tools.search.search.js_12_9_SentenceCase"},equals:{local:"Equals",resourceIdentifier:"Web._tools.search.search.js_12_0"},doesNotEqual:{local:"Does not equal",resourceIdentifier:"Web._tools.search.search.js_12_1_SentenceCase"},greaterThan:{local:"Is greater than",resourceIdentifier:"Web._tools.search.search.js_15_0_SentenceCase"},greaterThanOrEqualTo:{local:"Is greater than or equal to",resourceIdentifier:"Web._tools.search.search.js_15_1_SentenceCase"},lessThan:{local:"Is less than",resourceIdentifier:"Web._tools.search.search.js_15_2_SentenceCase"},lessThanOrEqualTo:{local:"Is less than or equal to",resourceIdentifier:"Web._tools.search.search.js_15_3_SentenceCase"},dateQuarter:{local:"Quarter {0}",resourceIdentifier:"ViewDesigner.RecordFilter.quarter"},dateFiscalYear:{local:"FY{0}",resourceIdentifier:"FiscalYear_Format_String_NoSpace"},on:{local:"On",resourceIdentifier:"Web._tools.search.search.js_16_0"},onOrAfter:{local:"On or after",resourceIdentifier:"Web._tools.search.search.js_16_1_SentenceCase"},onOrBefore:{local:"On or before",resourceIdentifier:"Web._tools.search.search.js_16_2_SentenceCase"},yesterday:{local:"Yesterday",resourceIdentifier:"Web._tools.search.search.js_16_3"},today:{local:"Today",resourceIdentifier:"Web._tools.search.search.js_16_4"},tomorrow:{local:"Tomorrow",resourceIdentifier:"Web._tools.search.search.js_16_5"},nextSevenDays:{local:"Next 7 days",resourceIdentifier:"Web._tools.search.search.js_16_6_SentenceCase"},lastSevenDays:{local:"Last 7 days",resourceIdentifier:"Web._tools.search.search.js_16_7_SentenceCase"},nextWeek:{local:"Next week",resourceIdentifier:"Web._tools.search.search.js_16_8_SentenceCase"},lastWeek:{local:"Last week",resourceIdentifier:"Web._tools.search.search.js_16_9_SentenceCase"},thisWeek:{local:"This week",resourceIdentifier:"Web._tools.search.search.js_16_10_SentenceCase"},nextMonth:{local:"Next month",resourceIdentifier:"Web._tools.search.search.js_16_11_SentenceCase"},lastMonth:{local:"Last month",resourceIdentifier:"Web._tools.search.search.js_16_12_SentenceCase"},thisMonth:{local:"This month",resourceIdentifier:"Web._tools.search.search.js_16_13_SentenceCase"},nextYear:{local:"Next year",resourceIdentifier:"Web._tools.search.search.js_16_14_SentenceCase"},lastYear:{local:"Last year",resourceIdentifier:"Web._tools.search.search.js_16_15_SentenceCase"},thisYear:{local:"This year",resourceIdentifier:"Web._tools.search.search.js_16_16_SentenceCase"},lastXHours:{local:"Last x hours",resourceIdentifier:"AF_Option_LastXHours_SentenceCase"},nextXHours:{local:"Next x hours",resourceIdentifier:"AF_Option_NextXHours_SentenceCase"},lastXDays:{local:"Last x days",resourceIdentifier:"AF_Option_LastXDays_SentenceCase"},nextXDays:{local:"Next x days",resourceIdentifier:"AF_Option_NextXDays_SentenceCase"},lastXWeeks:{local:"Last x weeks",resourceIdentifier:"AF_Option_LastXWeeks_SentenceCase"},nextXWeeks:{local:"Next x weeks",resourceIdentifier:"AF_Option_NextXWeeks_SentenceCase"},lastXMonths:{local:"Last x months",resourceIdentifier:"AF_Option_LastXMonths_SentenceCase"},nextXMonths:{local:"Next x months",resourceIdentifier:"AF_Option_NextXMonths_SentenceCase"},lastXYears:{local:"Last x years",resourceIdentifier:"AF_Option_LastXYears_SentenceCase"},nextXYears:{local:"Next x years",resourceIdentifier:"AF_Option_NextXYears_SentenceCase"},anyTime:{local:"Any time",resourceIdentifier:"Web._tools.search.search.js_16_17_SentenceCase"},olderThanXMinutes:{local:"Older than a minutes",resourceIdentifier:"AF_Option_OlderThanXMinutes_SentenceCase"},olderThanXHours:{local:"Older than x hours",resourceIdentifier:"AF_Option_OlderThanXHours_SentenceCase"},olderThanXDays:{local:"Older than x days",resourceIdentifier:"AF_Option_OlderThanXDays_SentenceCase"},olderThanXWeeks:{local:"Older than x weeks",resourceIdentifier:"AF_Option_OlderThanXWeeks_SentenceCase"},olderThanXMonths:{local:"Older than x months",resourceIdentifier:"AF_Option_OlderThanXMonths_SentenceCase"},olderThanXYears:{local:"Older than x years",resourceIdentifier:"AF_Option_OlderThanXYears_SentenceCase"},inFiscalYear:{local:"In fiscal year",resourceIdentifier:"AF_Option_InFiscalYear_SentenceCase"},lastFiscalYear:{local:"Last fiscal year",resourceIdentifier:"AF_Option_LastFiscalYear_SentenceCase"},thisFiscalYear:{local:"This fiscal year",resourceIdentifier:"AF_Option_ThisFiscalYear_SentenceCase"},nextFiscalYear:{local:"Next fiscal year",resourceIdentifier:"AF_Option_NextFiscalYear_SentenceCase"},lastXFiscalYears:{local:"Last x fiscal years",resourceIdentifier:"AF_Option_LastXFiscalYears_SentenceCase"},nextXFiscalYears:{local:"Next x fiscal years",resourceIdentifier:"AF_Option_NextXFiscalYears_SentenceCase"},inFiscalPeriod:{local:"In fiscal period",resourceIdentifier:"AF_Option_InFiscalPeriod_SentenceCase"},lastFiscalPeriod:{local:"Last fiscal period",resourceIdentifier:"AF_Option_LastFiscalPeriod_SentenceCase"},thisFiscalPeriod:{local:"This fiscal period",resourceIdentifier:"AF_Option_ThisFiscalPeriod_SentenceCase"},nextFiscalPeriod:{local:"Next fiscal period",resourceIdentifier:"AF_Option_NextFiscalPeriod_SentenceCase"},lastXFiscalPeriods:{local:"Last x fiscal periods",resourceIdentifier:"AF_Option_LastXFiscalPeriods_SentenceCase"},nextXFiscalPeriods:{local:"Next x fiscal periods",resourceIdentifier:"AF_Option_NextXFiscalPeriods_SentenceCase"},inFiscalPeriodAndYear:{local:"In fiscal period and year",resourceIdentifier:"AF_Option_InFiscalPeriodAndYear_SentenceCase"},inOrAfterFiscalPeriodAndYear:{local:"In or after fiscal period",resourceIdentifier:"AF_Option_InOrAfterFiscalPeriod_SentenceCase"},inOrBeforeFiscalPeriodAndYear:{local:"In or before fiscal period",resourceIdentifier:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase"},containValues:{local:"Contain values",resourceIdentifier:"Web._tools.search.search.js_17_4_SentenceCase"},doesNotContainValues:{local:"Does not contain values",resourceIdentifier:"Web._tools.search.search.js_17_5_SentenceCase"},equalsCurrentUserLanguage:{local:"Equals current user language",resourceIdentifier:"AF_Option_EqUserLanguage_SentenceCase"},isCurrentUser:{local:"Equals current user",resourceIdentifier:"Web._tools.search.search.js_17_0_SentenceCase"},notCurrentUser:{local:"Does not equal current user",resourceIdentifier:"Web._tools.search.search.js_17_1_SentenceCase"},isCurrentBusinessUnit:{local:"Equals current business unit",resourceIdentifier:"Web._tools.search.search.js_19_1_SentenceCase"},notCurrentBusinessUnit:{local:"Does not equal current business unit",resourceIdentifier:"Web._tools.search.search.js_19_2_SentenceCase"},under:{local:"Under",resourceIdentifier:"Web._tools.search.search.js_12_18"},notUnder:{local:"Not under",resourceIdentifier:"Web._tools.search.search.js_12_19_SentenceCase"},above:{local:"Above",resourceIdentifier:"ViewDesigner.RecordFilter.above"},aboveOrEqual:{local:"Equals or above",resourceIdentifier:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase"},underOrEqual:{local:"Equals or under",resourceIdentifier:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase"},isCurrentUserOrReportingHierarchy:{local:"Equals current user or his reporting hierarchy",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase"},isCurrentUserAndTeamsOrReportingHierarchyAndTeams:{local:"Equals current user and his teams or his reporting hierarchy and their teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase"},isCurrentUserTeams:{local:"Equals current user's teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase"},isCurrentUserOrTeams:{local:"Equals current user or user's teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase"},addButton:{local:"Add",resourceIdentifier:"Workflow.DynamicExpressions.Add"},addRow:{local:"Add row",resourceIdentifier:"MenuItem_Label_AddRow_SentenceCase"},addGroup:{local:"Add group",resourceIdentifier:"MenuItem_Label_AddGroup_SentenceCase"},addRelatedEntity:{local:"Add related entity",resourceIdentifier:"MenuItem_Label_AddRelatedEntity_SentenceCase"},deleteExpression:{local:"Delete",resourceIdentifier:"Web._controls.listedit.buttons.Delete"},moveUpExpression:{local:"Move up",resourceIdentifier:"Web._controls.listedit.buttons.MoveUp_SentenceCase"},moveDownExpression:{local:"Move down",resourceIdentifier:"Web._controls.listedit.buttons.MoveDown_SentenceCase"},makeGroup:{local:"Group",resourceIdentifier:"CC_Timeline_Group"},ungroup:{local:"Ungroup",resourceIdentifier:"AF_MenuItem_UnGroup"},errorQuickFind:{local:"View belongs to a quick find, expression editing is not available",resourceIdentifier:"AF_Error_QuickFindView"},errorMalformed:{local:"Malformed expression, could not render",resourceIdentifier:"AF_Error_MalformedExpression"},andGroup:{local:"And",resourceIdentifier:"AF_Text_And_SentenceCase"},orGroup:{local:"Or",resourceIdentifier:"AF_Text_Or_SentenceCase"},relatedEntityPlaceholder:{local:"Choose a related entity",resourceIdentifier:"AF_Message_ChooseRelatedEntity"},doesNotContainDataWarning:{local:"Conditions cannot be added under relationships with no related data",resourceIdentifier:"AF_Error_DoesnNotContainData"},inputControlLabel:{local:"Value",resourceIdentifier:"ViewDesigner.ConditionFilter.Value.Label"},fieldSelectorControlLabel:{local:"Field selector",resourceIdentifier:"AF_Aria_FieldSelector"},operatorSelectorControlLabel:{local:"Operator",resourceIdentifier:"SystemCustomization.BusinessRules.Expression.Operator"},fieldPlaceholder:{local:"Select a field",resourceIdentifier:"Audit.Incontext.Filters.AttributesGroup"},durationUnit:{local:"minutes",resourceIdentifier:"CC_Duration_Minutes"},noValue:{local:"Provide a value for the condition",resourceIdentifier:"AF_Message_NoValue"},loadingResults:{local:"Loading..",resourceIdentifier:"RelatedInformation.DataLoading"},noResults:{local:"No results found.",resourceIdentifier:"RelatedInformation.NoResults"},maxLength:{local:"Input text has more characters than the maximum allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxLength"},minValue:{local:"Input value is lower than the minimum value allowed for this field ({0})",resourceIdentifier:"AF_Error_MinValue"},maxValue:{local:"Input value is greater than the maximum value allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxValue"},maxPrecision:{local:"Input value has a greater precision than the maximum allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxPrecision"},errorNoValues:{local:"Provide at least one value for the condition",resourceIdentifier:"AF_Error_NoValues"},viewAll:{local:"View all options",resourceIdentifier:"AF_Message_ViewAllOptions"},incorrectDataType:{local:"Incorrect data type",resourceIdentifier:"AF_Error_IncorrectDataType"},invalidField:{local:"{0} has been removed from the system or is no longer available for filtering",resourceIdentifier:"AF_Error_InvalidField"},moreCommandsAriaLabel:{local:"More commands",resourceIdentifier:"AF_Aria_MoreCommands"},rowSelectorAriaLabel:{local:"Row selector",resourceIdentifier:"AF_Aria_RowSelector"},groupSelectorAriaLabel:{local:"Group selector",resourceIdentifier:"AF_Aria_GroupSelector"},groupExpandAriaLabel:{local:"Expand",resourceIdentifier:"AF_MenuItem_Expand"},groupCollapseAriaLabel:{local:"Collapse",resourceIdentifier:"AF_MenuItem_Collapse"},groupExpandAriaDescription:{local:"Expand this group",resourceIdentifier:"AF_Aria_GroupExpand"},groupCollapseAriaDescription:{local:"Collapse this group",resourceIdentifier:"AF_Aria_GroupCollapse"}}},889:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),o=n(240),i=n(51),a=n(11),s=n(12),l="msdyn_forecastconfigurationid,msdyn_name,msdyn_hierarchyentity,msdyn_rollupentity,msdyn_rootentityrecordid,msdyn_forecastcategoryattribute,msdyn_startingfiscalyear,msdyn_periodtype,msdyn_numberofrecurrences,msdyn_startingfiscalquarter,msdyn_startingfiscalmonth,msdyn_startdate,msdyn_enddate,statuscode,_ownerid_value,msdyn_columns,msdyn_errormessage,msdyn_templatetype,msdyn_hierarchyrelationship,msdyn_additionalfilter,msdyn_permissionsdata",c=function(){function e(e){this.axiosInstance=e}return e.prototype.fetchForecastConfigList=function(){var e=this;return new Promise((function(t,n){var r={method:"GET",url:"api/data/v9.0/msdyn_forecastconfigurations?$select="+l+"&$orderby=createdon desc",headers:{Prefer:'odata.include-annotations="*"'}};o.showOrHideCrmLoaading(!0,a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_LOADING)),e.axiosInstance.request(r).then((function(n){var r=n.data.value.map((function(t){return e.convertForecastConfigJSONtoDisplayObject(t)}));t(r),o.showOrHideCrmLoaading(!1)})).catch((function(e){i.logError("Delphi-Config Fetch ForecastConfiguration",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),n(e)}))}))},e.prototype.fetchForecastConfig=function(e){var t=this;return new Promise((function(n,r){var o={method:"GET",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")?$select="+l,headers:{Prefer:'odata.include-annotations="*"'}};t.axiosInstance.request(o).then((function(e){var r=t.convertForecastConfigJSONtoDomainObject(e.data);n(r)})).catch((function(e){i.logError("Delphi-Config Fetch ForecastConfiguration",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e)}))}))},e.prototype.updateForecastConfig=function(e,t){var n=this;return new Promise((function(r,a){var s=n.convertDomainObjectToForecastConfigJSON(t),l={method:"PATCH",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")",data:s};n.axiosInstance.request(l).then((function(e){r("")})).catch((function(e){i.logError("Delphi-Config update ForecastConfiguration",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),a(e),o.showOrHideCrmLoaading(!1)}))}))},e.prototype.deleteForecastConfig=function(e){var t=this;return new Promise((function(n,r){var l={method:"DELETE",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")"};o.showOrHideCrmLoaading(!0,a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_CRM_DELETING_CALLS)),t.axiosInstance.request(l).then((function(e){n(""),o.showOrHideCrmLoaading(!1)})).catch((function(e){i.logError("Delphi-Config Delete",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e),o.showOrHideCrmLoaading(!1)}))}))},e.prototype.publishForecastConfig=function(e){var t=this;return new Promise((function(n,r){var o={method:"PATCH",url:"api/data/v9.0/msdyn_forecastconfigurations("+e+")",data:{statuscode:2}};t.axiosInstance.request(o).then((function(e){n("")})).catch((function(e){i.logError("Delphi-Config Publish",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e)}))}))},e.prototype.createForecastConfig=function(e){var t=this;return new Promise((function(n,r){var a={method:"POST",url:"api/data/v9.0/msdyn_forecastconfigurations",data:t.convertDomainObjectToForecastConfigJSON(e)};t.axiosInstance.request(a).then((function(e){var t,r=e.headers["odata-entityid"],o=(t=/\(([^)]+)\)/.exec(""+r))?t[1]:"";n(o)})).catch((function(e){i.logError("Delphi-Config Create",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),r(e),o.showOrHideCrmLoaading(!1)}))}))},e.prototype.convertDomainObjectToForecastConfigJSON=function(e){var t={};return null!=e.name&&(t.msdyn_name=e.name),null!=e.hierarchyEntity&&(t.msdyn_hierarchyentity=e.hierarchyEntity),null!=e.rollupEntity&&(t.msdyn_rollupentity=e.rollupEntity),null!=e.topOfHierarchy&&(t.msdyn_rootentityrecordid=e.topOfHierarchy),null!=e.fiscalyear&&(t.msdyn_startingfiscalyear=parseInt(e.fiscalyear)),null!=e.period&&(t.msdyn_periodtype=parseInt(e.period)),null!=e.numberOfRecurrences&&(t.msdyn_numberofrecurrences=e.numberOfRecurrences),null!=e.startAtQuater&&(t.msdyn_startingfiscalquarter=parseInt(e.startAtQuater)),null!=e.startAtMonth&&(t.msdyn_startingfiscalmonth=parseInt(e.startAtMonth)),null!=e.fromDate&&(t.msdyn_startdate=e.fromDate),null!=e.toDate&&(t.msdyn_enddate=e.toDate),null!=e.forecastCategoryAttributeName&&(t.msdyn_forecastcategoryattribute=e.forecastCategoryAttributeName),null!=e.columns&&(t.msdyn_columns=JSON.stringify(e.columns)),null!=e.templateType&&(t.msdyn_templatetype=e.templateType.toString()),null!=e.hierarchyRelationship&&(t.msdyn_hierarchyrelationship=JSON.stringify(e.hierarchyRelationship)),null!=e.permissionsData&&(t.msdyn_permissionsdata=JSON.stringify(e.permissionsData)),null!=e.additionalFilter&&null!=e.additionalFilter&&(t.msdyn_additionalfilter=e.additionalFilter.toString()),t},e.prototype.convertForecastConfigJSONtoDisplayObject=function(e){var t={id:e._ownerid_value,displayName:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],entityLogicalName:"systemuser"},n=r.GetEmptyForecastConfigInfo();return n.id=e.msdyn_forecastconfigurationid,n.name=e.msdyn_name,n.period=e["msdyn_periodtype@OData.Community.Display.V1.FormattedValue"]||n.period,n.fromDate=e["msdyn_startdate@OData.Community.Display.V1.FormattedValue"]||n.fromDate,n.toDate=e["msdyn_enddate@OData.Community.Display.V1.FormattedValue"]||n.toDate,n.status=e.statuscode||n.status,n.statusDescription=e["statuscode@OData.Community.Display.V1.FormattedValue"]||n.status,n.owner=t||n.owner,n},e.prototype.convertForecastConfigJSONtoDomainObject=function(e){var t={id:e._ownerid_value,displayName:e["_ownerid_value@OData.Community.Display.V1.FormattedValue"],entityLogicalName:"systemuser"},n=r.GetEmptyForecastConfigInfo();return n.id=e.msdyn_forecastconfigurationid,n.name=e.msdyn_name,n.hierarchyEntity=e.msdyn_hierarchyentity||n.hierarchyEntity,n.rollupEntity=e.msdyn_rollupentity||n.rollupEntity,n.topOfHierarchy=e.msdyn_rootentityrecordid||n.topOfHierarchy,n.forecastCategoryAttributeName=e.msdyn_forecastcategoryattribute||n.forecastCategoryAttributeName,n.fiscalyear=e.msdyn_startingfiscalyear,n.period=e.msdyn_periodtype,n.numberOfRecurrences=e.msdyn_numberofrecurrences,n.startAtQuater=e.msdyn_startingfiscalquarter,n.startAtMonth=e.msdyn_startingfiscalmonth,n.fromDate=e.msdyn_startdate||n.fromDate,n.toDate=e.msdyn_enddate||n.toDate,n.status=e.statuscode||n.status,n.owner=t||n.owner,n.statusDescription=e["statuscode@OData.Community.Display.V1.FormattedValue"]||n.statusDescription,n.publishErrorMessage=e.msdyn_errormessage||n.publishErrorMessage,n.templateType=null!=e.msdyn_templatetype?Number(e.msdyn_templatetype):n.templateType,n.additionalFilter=e.msdyn_additionalfilter||n.additionalFilter,null!=e.msdyn_hierarchyrelationship&&(n.hierarchyRelationship=u(e.msdyn_hierarchyrelationship,"Received error parsing permissions data json")||n.hierarchyRelationship),null!=e.msdyn_permissionsdata&&(n.permissionsData=u(e.msdyn_permissionsdata,"Received error parsing permissions data json")||n.permissionsData),n.columns=e.msdyn_columns?JSON.parse(e.msdyn_columns):r.GetInitialColumns(n.templateType),n},e}();function u(e,t){if(null!=e){var n=function(e){try{return{jsonObject:JSON.parse(e),error:void 0}}catch(e){return{jsonObject:void 0,error:e}}}(e),r=n.jsonObject,o=n.error;if(r)return r;o&&t&&i.logError(t,o,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",e)}}t.ForecastConfigDataAccess=c},89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(64),o=n(109),i=n(45),a=n(17),s=n(51);function l(e){return r.AreColumnsDifferent(e.columnEditorState.uneditedColumnInfo,o.GetActiveForecastColumnInfo_FromState(e))}t.GetOptionSetAttributeInfoList_FromState=function(e){var t=e.FormFieldData.rollupEntity;if(t){var n=e.columnEditorState.optionSetAttributeInfoDict[t];if(n)return n}return[]},t.GetIsCurrentlyEditingColumnNew_FromState=function(e){return void 0===e.columnEditorState.uneditedColumnInfo.columnType},t.GetForecastCategoryAttribute_FromState=function(e){return e.FormFieldData.forecastCategoryAttributeName},t.GetSelectedOptionSetAttribute_FromState=function(e){return e.columnEditorState.selectedAttributeVal},t.Get_IsChooseSelectedOptionSetButtonDisabled_FromState=function(e){return e.FormFieldData.forecastCategoryAttributeName===e.columnEditorState.selectedAttributeVal},t.Get_IsOptionSetChangeDescructive_FromState=function(e){return e.FormFieldData.forecastCategoryAttributeName!==e.columnEditorState.selectedAttributeVal&&""!=e.FormFieldData.forecastCategoryAttributeName},t.Get_IsColumnEditorRibbonSaveCloseDisabled_FromState=function(e){var t=o.GetActiveForecastColumnInfo_FromState(e);return!l(e)||!i.ForecastingBusinessLogicProvider.AreRequiredFieldsFilledForColumnInfo(t)||o.IsUniqueNameForCurrentForecastColumnDuplicateInFC(e)||!o.IsUniqueNameForCurrentForecastColumnProper(e)},t.Get_IsColumnEditorFormDirty=l,t.Get_IsAddColumnButtonHidden_FromState=function(e){return""==e.FormFieldData.forecastCategoryAttributeName},t.GetPreviewGridColumnList_FromState=function(e){return o.GetForecastColumnsWithStatusList_FromState(e).filter((function(e){return 1==e.isActive}))},t.Get_ShouldShowPredictiveColumn_FromState=function(e){return e.PredictiveAvailabilityState==a.PredictiveAvailabilityStateType.FcbOn&&1==e.crmOrgInfo.isSIPackageInstalled},t.Get_IsAdditionalFilterSameAsDefault=function(e){var t=!1;if(null==e.FormFieldData.additionalFilter)return!0;try{var n=(new DOMParser).parseFromString(e.FormFieldData.additionalFilter,"text/xml");n.getElementsByTagName("entity")&&n.getElementsByTagName("entity").length>0&&0==n.getElementsByTagName("entity")[0].childElementCount&&(t=!0)}catch(e){s.logError("Error while parsing Add filters",e,"")}return t}},890:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),o=n(51),i=function(){function e(e,t){this.axiosInstance=e,this.cdsResolver=t}return e.prototype.fetchForecastHierarchy=function(e,t){var n=this;return new Promise((function(r,i){n.cdsResolver.cdsClient.then((function(o){o.fetchEntityAndRelatedEntityMetadata({entityName:e}).then((function(o){n.getforecastHierarchy(o,e,t).then((function(e){r(e)}))}))})).catch((function(e){o.logError("Delphi-Config Fetch Forecast HierarchyData",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),i(e)}))}))},e.prototype.getforecastHierarchy=function(e,t,n){var r=this,i=e.PrimaryNameAttribute,a=e.PrimaryIdAttribute,s=e.EntityRelationshipCollection,l="",c=e.EntitySetName;s.DependentRelationships.forEach((function(e){1==e.IsHierarchical&&(console.log(JSON.stringify(e)),l=e.ReferencingAttribute)}));var u=this.getActiveRecordsFilter(t,e),d="\n        <fetch version='1.0' output-format='xml-platform' mapping='logical' distinct='false' count='50'>\n            <entity name= '"+t+"'>\n            <attribute name= '"+a+"' />\n            <attribute name= '"+i+"' />\n            <attribute name= '"+a+"' rowaggregate='CountChildren' alias='childCount'/>\n            <attribute name='"+l+"' />\n            <filter type='and'>\n                <condition attribute='"+a+"' operator='eq-or-under' value='"+n+"' />\n                "+u+"\n            </filter>\n          </entity>\n        </fetch>\n        ";return new Promise((function(e,t){var s={method:"GET",url:"api/data/v9.0/"+c+"?fetchXml="+encodeURIComponent(d),headers:{Prefer:'odata.include-annotations="*"'}};r.axiosInstance.request(s).then((function(t){var o=t.data.value.map((function(e){return r.convertForecastHierarchyJSONtoDisplayObject(e,i,a,l,n)})),s=r.removeNodesBeyondOneLevel(o,n),c=r.sortChildNodesByName(s,n);e(c)})).catch((function(e){o.logError("Delfi-Config Fetch HierarchyData",e,"Please contact Dynamics Sales Forecasting - Delphi Grid team",{}),t(e)}))}))},e.prototype.removeNodesBeyondOneLevel=function(e,t){var n=e;return null!=e&&e.length>1&&null!=t&&(n=[],e.forEach((function(e){e.id!==t&&e.parentId!==t||n.push(e)}))),n},e.prototype.sortChildNodesByName=function(e,t){var n=e;if(null!=e&&e.length>1&&null!=t){var r=(n=e.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))).findIndex((function(e){return e.id==t}));if(0!=r){var o=n.splice(r,1)[0];n.unshift(o)}}return n},e.prototype.convertForecastHierarchyJSONtoDisplayObject=function(e,t,n,o,i){var a=r.GetEmptyForecastHierarchyDisplayInfo();return a.id=e[n],a.displayName=e[t],a.parentId=e["_"+o+"_value"]?e["_"+o+"_value"]:null,a.hasChildren=void 0!==e.childCount&&parseInt(e.childCount)>0,a},e.prototype.getActiveRecordsFilter=function(e,t){return this.isUserHierarchy(e)?"<condition attribute='isdisabled' operator='eq' value='0' />":t.AttributesMetadata.DependentAttributes.findIndex((function(e){return"statecode"==e.LogicalName}))>-1?"<condition attribute='statecode' operator='eq' value='0' />":""},e.prototype.isUserHierarchy=function(e){return"systemuser"===e.toLowerCase().trim()},e}();t.HierarchyDataAccess=i},891:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),o=function(){function e(e){this.axiosInstance=e}return e.prototype.downloadQuotaTemplate=function(e){var t=this;return new Promise((function(n,o){var i={ForecastConfigurationId:e};t.CallCustomAction("quota-download",i).then((function(e){var t=e.data.response,r=JSON.parse(t);200==r.Code?n(r.Body):o(r.Message)})).catch((function(e){r.logError("Delphi-Config downloadQuotaTemplate",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{}),o(e)}))}))},e.prototype.uploadQuotaExcel=function(e,t,n){var o=this;return new Promise((function(i,a){var s={ForecastConfigurationId:e,Filename:t,FileContent:n};o.CallCustomAction("quota-upload",s).then((function(e){var t=e.data.response,n=JSON.parse(t);200==n.Code?i(n.Body):a(n.Message)})).catch((function(e){a(e),r.logError("Delphi-Config uploadQuotaTemplate",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{})}))}))},e.prototype.fetchQuotaUploadStatus=function(e){var t=this;return new Promise((function(n,o){var i={ForecastConfigurationId:e};t.CallCustomAction("fetch-quota",i).then((function(e){var t=e.data.response,r=JSON.parse(t);200==r.Code&&r.Body?n(r.Body[0]):o(r.Message)})).catch((function(e){o(e),r.logError("Delphi-Config fetchQuotaUploadStatus",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{})}))}))},e.prototype.CallCustomAction=function(e,t){return this.axiosInstance.post("api/data/v9.0/msdyn_ForecastInstanceActions",{WebApiName:e,RequestJson:JSON.stringify(t),ServiceName:"mf-services"})},e}();t.QuotaDataAccess=o},892:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(51),a=function(){function e(e,t){this.axiosInstance=e,this.orgId=t,this.cachedEntityResponse=[]}return e.prototype.getOrgEntities=function(){var e=this;return new Promise((function(t,n){e.cachedEntityResponse.length>0?t(e.cachedEntityResponse):e.axiosInstance.request({method:"GET",url:"/api/data/v9.0/EntityDefinitions?$select=MetadataId,LogicalName,DisplayName,PrimaryIdAttribute,ObjectTypeCode,IsCustomizable,OwnershipType,CanCreateAttributes&$filter=IsValidForAdvancedFind%20eq%20true"}).then((function(n){var r=n.data.value;e.cachedEntityResponse=r,t(e.cachedEntityResponse)}),(function(e){n(e)}))}))},e.prototype.getOrgFiscalCalendarStartDate=function(){return r(this,void 0,void 0,(function(){var e=this;return o(this,(function(t){return[2,new Promise((function(t){var n={method:"GET",url:"api/data/v9.0/organizations("+e.orgId+")?$select=fiscalcalendarstart"};e.axiosInstance.request(n).then((function(e){var n=new Date(e.data.fiscalcalendarstart).toLocaleDateString();t(n)}),(function(e){i.logError("Delphi-Config Fiscal Year Fetch",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{});var n=(new Date).getFullYear();t(new Date(n,1,1).toLocaleDateString())}))}))]}))}))},e}();t.OrganizationDataAccess=a},893:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.axiosInstance=e}return e.prototype.getPublishedForecastDefinitionCount=function(){var e=this;return new Promise((function(t,n){var r=0;e.axiosInstance.request({method:"GET",url:"api/data/v9.0/msdyn_forecastdefinitions?$filter=statuscode eq 3&$count=true"}).then((function(e){null==e||isNaN(e.data["@odata.count"])||(r=e.data["@odata.count"]),t(r)}),(function(e){console.log("Error occurred while fetching published forecast definition count. Details: "+e),n(e)}))}))},e}();t.ForecastDefinitionDataAccess=r},894:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),o=function(){function e(e){this.axiosInstance=e}return e.prototype.isSIPackageInstalled=function(){var t=this;return new Promise((function(n){t.axiosInstance.request({method:"GET",url:"api/data/v9.0/EntityDefinitions(LogicalName='opportunity')/Attributes"}).then((function(r){r&&200==r.status?r&&JSON.stringify(r.data).includes(e.OPP_SCORE_ATTRIBUTE)?n(!0):n(!1):n(t.isMsdyn_opportunityScorePresentInOpportunityEntity())})).catch((function(e){r.logError("Error while determining SI package status using entity metadata",e,"")}))}))},e.prototype.isMsdyn_opportunityScorePresentInOpportunityEntity=function(){var t=this;return new Promise((function(n){var o={method:"GET",url:"api/data/v9.0/opportunities?$select="+e.OPP_SCORE_ATTRIBUTE+"&$top=1"};t.axiosInstance.request(o).then((function(e){e&&200==e.status?n(!0):n(!1)})).catch((function(e){r.logError("Error while determining SI package status using GET opportunity",e,"")}))}))},e.OPP_SCORE_ATTRIBUTE="msdyn_opportunityscore",e}();t.SIDataAccess=o},895:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),o=n(352),i=function(){function e(e){this.axiosInstance=e,this.cachedRoles=[]}return e.prototype.getRoles=function(){var e=this;return new Promise((function(t,n){e.cachedRoles.length>0?t(e.cachedRoles):e.axiosInstance.request({method:"GET",url:"/api/data/v9.0/roles?$select=_parentrootroleid_value,name"}).then((function(n){n.data.value.forEach((function(t){-1==e.cachedRoles.findIndex((function(e){return e.roleId==t._parentrootroleid_value}))&&e.cachedRoles.push({roleId:t._parentrootroleid_value,roleName:t.name})})),t(e.cachedRoles)}),(function(e){r.logError("Delfi-config fetch org roles",e,"",{userId:o.XrmHelper.getLoggedInUserInfo().id}),n(e)}))}))},e}();t.RoleDataAccess=i},896:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.loggerMiddleware=function(e){return function(e){return function(t){var n=function(e){var t={};e.type,null!=e.payload&&(t=r({},e.payload));return t}(t);return function(e,t,n){console.log(e+" - "+t+" Args: "+JSON.stringify(n,null,2))}("DelfiConfig.Redux.Dispatch",t.type,n),e(t)}}}},897:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(72),i=n(351),a=n(17),s=n(82),l=n(540),c=n(107),u=n(324);t.categoryValuesFetcherMiddleware=function(e){var t=e.getState;return function(e){return function(n){return"@@ColumnEditor/TriggerCategoryValuesFetch"==n.type&&(e(s.UpdateFieldValue({forecastCategoryAttributeName:t().columnEditorState.selectedAttributeVal})),e(r.ClearRollupAndCalculatedColumns()),function(e,t){var n=o.getCrmDataAccessInstance();if(!n)return void console.warn("CrmDataAccess object is null. Unable to fetch category option members");var s=e().FormFieldData.rollupEntity,d=e().FormFieldData.forecastCategoryAttributeName,p=function(e,t){var n={name:e,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},r={metadataId:"",name:t,displayName:"",dataType:i.EDataType.MultiOptionSet};return{entityContext:n,fieldContext:r}}(s,d),_=p.entityContext,f=p.fieldContext;n.cdsResolver.resolveOptionSetMembers(_,f).then((function(n){console.log(JSON.stringify(n,null,2)),d==e().FormFieldData.forecastCategoryAttributeName&&(n.map((function(e){var n=function(e,t){return{id:u.generateNewGuid(),title:e.displayName,columnType:a.ForecastColumnType.Rollup,isActive:!0,uniqueName:c.filterNonValidCharactersForUniqueName(e.displayName),optionSetValue:e.value,isManuallyAdjustable:!1,showProgressComparedToQuota:!1}}(e);t(r.AddColumn(n))})),"msdyn_forecastcategory"==d&&new Promise((function(e){var t=o.getCrmDataAccessInstance();t||(console.warn("CrmDataAccess object is null. Unable to validate column config autopopulation"),e(!0)),t.cdsResolver.resolveFields({name:"opportunity",displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""}).then((function(t){var n=0;t.map((function(e){e.name==l.ORG_TEMPLATE_AMOUNT_FIELD&&n++,e.name==l.ORG_TEMPLATE_DATE_FIELD&&n++,e.name==l.ORG_TEMPLATE_ACTUAL_DATE_FIELD&&n++,e.name==l.ORG_TEMPLATE_ACTUAL_AMOUNT_FIELD&&n++})),e(4==n)})).catch((function(){e(!1)}))})).then((function(e){e&&t(r.UpdateIsColumnConfigAutoPopulateDialogOpen(!0))})))}))}(t,e)),"@@ColumnEditorState/UpdateIsOptionSetSelectorOpened"==n.type&&1==n.payload.isOpen&&e(r.UpdateSelectedOptionSetValue(t().FormFieldData.forecastCategoryAttributeName)),e(n)}}}},898:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(82),o=n(353),i=n(72),a=n(64),s=n(49),l=n(89),c=n(227),u=n(184),d=n(108),p=n(109),_=n(330),f=n(542),E=n(244);function m(e,t,n,l){var p=e();if(a.GetIsFormDirty_FromState(p)){if(function(e){return c.getActiveStepperStage(e)==d.ForecastConfigStage.General&&!c.AreRequiredFieldsForCurrentStageFilled(e)}(p))return void t(r.UpdateShowWarningsFlag(!0));if(S(e)){var _=i.getCrmDataAccessInstance();if(_)new o.FormEventsHandler(t,_.forecastConfigAccess).UpdateData(p.FormFieldData.id,p.FormFieldData,p.ActiveForecastConfigInfo,n),n&&function(e){u.NavigationHandlerFactory.GetNavigationHandlerObject(e).OpenGridPage()}(t),l&&(t(s.UpdateIsEditorOpened(!1)),t(s.UpdateIsOptionSetSelectorOpened(!1)));else console.warn("Saving attempted when crmDataAccess was NULL")}}else S(e)&&l&&(t(s.UpdateIsEditorOpened(!1)),t(s.UpdateIsOptionSetSelectorOpened(!1)))}function S(e){var t=e(),n=p.GetActiveForecastColumnInfo_FromState(t),r=t.FormFieldData,o=!0;if(n.calculatedFieldExpression){var i=_.ExpressionParserFactory.getCalculatedFieldExpressionParser();try{i.parseExpression(n.calculatedFieldExpression,r,n.uniqueName,n.id)}catch(e){o=!1}}return o}t.saveEventsMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@SaveEvents/TriggerUndoColumnFormChanges"==n.type){var o=t();if(l.GetIsCurrentlyEditingColumnNew_FromState(o))e(s.DeleteColumn(o.columnEditorState.activeForecastColumnId));else{var i=JSON.parse(JSON.stringify(o.columnEditorState.uneditedColumnInfo));e(s.ReplaceColumn(i.id,i))}}if("@@FormData/DiscardValue"==n.type){o=t();var a=JSON.parse(JSON.stringify(o.ActiveForecastConfigInfo));if(n.payload.shouldDiscardSelectedFields){var c={};n.payload.fields.map((function(e){c[e]=a[e]})),e(r.UpdateFieldValue(c))}else e(r.UpdateFieldValue(a))}return"@@SaveEvents/TriggerSave"==n.type&&m(t,e,n.payload.shouldClose,n.payload.shouldCloseColumnEditorForm),"@@EditApp/ON_STEPPER_BUTTON_CLICK"!=n.type&&"@@EditApp/ON_STEP_CLICK"!=n.type||m(t,e),"@@FormEvents/FormRefreshed"==n.type&&function(e,t){var n=e();if(null==n.FormFieldData.permissionsData&&n.stepperActiveStage==d.ForecastConfigStage.Permission){var r=f.getDefaultPermissionDataByTemplate(n.FormFieldData.templateType);null!==r&&(t(E.UpdatePermissionsData(r)),m(e,t))}}(t,e),e(n)}}}},899:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(241),o=function(){function e(){}return e.prototype.OpenCreatePage=function(e){var t={isEditMode:"true",id:""};e&&(t.templateType=e.toString()),r.CrmNavigationHelpers.navigateWithParams(t)},e.prototype.OpenEditPage=function(e){var t={isEditMode:"true",id:e};r.CrmNavigationHelpers.navigateWithParams(t)},e.prototype.OpenGridPage=function(){r.CrmNavigationHelpers.navigateWithParams({isEditMode:"false",id:""})},e}();t.CrmNavigationHandler=o},900:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(329),o=n(242),i=n(108),a=n(45),s=n(184);t.dialogRendererMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@EditApp/ON_STEPPER_BUTTON_CLICK"==n.type&&n.payload.buttonTypeClicked==r.IStepperButton.NEXT){var l=void 0;if((u=t().stepperActiveStage)==i.ForecastConfigStage.Quota)!function(e){s.NavigationHandlerFactory.GetNavigationHandlerObject(e).OpenGridPage()}(e);else{l=a.ForecastingBusinessLogicProvider.isLastStageofOrderedStepperStages(u)?u:a.ForecastingBusinessLogicProvider.getNextStage(u);var c=a.ForecastingBusinessLogicProvider.GetStageStepId(l);l!=u&&e(o.onStepClickActionCreator(c))}}if("@@EditApp/ON_STEPPER_BUTTON_CLICK"==n.type&&n.payload.buttonTypeClicked==r.IStepperButton.BACK){var u=t().stepperActiveStage,d=a.ForecastingBusinessLogicProvider.isFirstStageofOrderedStepperStages(u)?u:a.ForecastingBusinessLogicProvider.getPreviousStage(u);c=a.ForecastingBusinessLogicProvider.GetStageStepId(d);e(o.onStepClickActionCreator(c))}return e(n)}}}},901:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(245),o=n(72),i=n(902),a=n(98),s=n(88),l=n(144),c=n(51);t.hierarchyFetcherTriggerMiddleware=function(e){var t=e.getState;return function(e){return function(n){return("@@FormData/UpdateFieldValue"==n.type&&n.payload.data.hierarchyEntity||"@@FormData/UpdateFieldValue"==n.type&&n.payload.data.topOfHierarchy)&&(function(e,t,n){if(void 0!==t.payload.data.hierarchyEntity&&null!==t.payload.data.hierarchyEntity&&t.payload.data.hierarchyEntity.length>0){var r=t.payload.data.hierarchyEntity;if(null==e().entityMetadataList[r]){var i=o.getCrmDataAccessInstance();if(!i)return void console.warn("CrmDataAccess object is null. Unable to fetch entity metadata");i.cdsResolver.cdsClient.then((function(e){e.fetchEntityAndRelatedEntityMetadata({entityName:r}).then((function(e){n(l.SetEntityMetadata(r,e))}))})).catch((function(e){c.logError("Delphi-Config Fetch Hierarchy metadata",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",{})}))}}}(t,n,e),function(e,t,n){var l=o.getCrmDataAccessInstance();if(!l)return void console.warn("CrmDataAccess object is null. Unable to fetch category option members");var c=void 0!==t.payload.data.hierarchyEntity?t.payload.data.hierarchyEntity:e().FormFieldData.hierarchyEntity,u=void 0!==t.payload.data.topOfHierarchy?t.payload.data.topOfHierarchy:e().FormFieldData.topOfHierarchy;if(c&&u){var d=e().FormFieldData;if(c==d.hierarchyEntity&&u==d.topOfHierarchy)return;n(i.FetchHierarchyStartedDataActionCreator()),l.hierarchyDataAccess.fetchForecastHierarchy(c,u).then((function(e){n(r.ClearPreviewGridHierarchyData()),n(r.AddPreviewGridHierarchyData(e)),n(i.FetchHierarchyCompletedDataActionCreator())}),(function(e){console.error("An error occurred while fetching the hierarchy: "+e),n(a.onErrorShowDialogActionCreator(s.IErrorDialogType.FetchingHierarchyDataFailed)),n(i.FetchHierarchyCompletedDataActionCreator())}))}}(t,n,e)),e(n)}}}},902:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchHierarchyStartedDataActionCreator=function(){return{type:"@@HierarchyPreview/FetchHierarchyStarted",payload:{}}},t.FetchHierarchyCompletedDataActionCreator=function(){return{type:"@@HierarchyPreview/FetchHierarchyCompleted",payload:{}}}},903:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(89),a=n(72),s=n(49),l=n(351);t.optionSetInfoListFetcherMiddleware=function(e){var t=this,n=e.getState;return function(e){return function(c){return r(t,void 0,void 0,(function(){var t,u,d,p,_,f=this;return o(this,(function(E){if("@@FormData/UpdateFieldValue"==c.type&&c.payload.data.rollupEntity){if(t=e(c),u=n(),d=c.payload.data.rollupEntity,0==i.GetOptionSetAttributeInfoList_FromState(u).length){if(!(p=a.getCrmDataAccessInstance()))return console.warn("CrmDataAccess object is null. Unable to fetch optionset attributes"),[2];_={name:d,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},p.cdsResolver.resolveFields(_).then((function(t){return r(f,void 0,void 0,(function(){var n,r,i,a,c,u,_,f,E,m;return o(this,(function(o){switch(o.label){case 0:n=[],r=0,o.label=1;case 1:return r<t.length?(i=t[r]).dataType!=l.EDataType.OptionSet?[3,3]:(a=i.name,c=function(e,t){var n={name:e,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},r={metadataId:"",name:t,displayName:"",dataType:l.EDataType.MultiOptionSet};return{entityContext:n,fieldContext:r}}(d,a),u=c.entityContext,_=c.fieldContext,[4,p.cdsResolver.resolveOptionSetMembers(u,_)]):[3,4];case 2:f=o.sent(),E=f.map((function(e){return e.displayName})),m={displayName:i.displayName,logicalName:i.name,members:E},n.push(m),o.label=3;case 3:return r++,[3,1];case 4:return e(s.UpdateOptionSetList(d,n)),[2]}}))}))}))}return[2,t]}return[2,e(c)]}))}))}}}},904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(543),o=n(72),i=n(223),a=n(97),s=n(544),l=n(17),c=n(353),u=n(11),d=n(12),p=n(99);t.quotaStatusFetcherMiddleware=function(e){var t=e.getState;return function(e){return function(E){if("@@EditApp/QuotaStatusFetchAction"==E.type&&function(e){var s=o.getCrmDataAccessInstance();if(!s)return void console.warn("CrmDataAccess object is null. Unable to fetch quota");var c=t().ActiveForecastConfigInfo.id;s.quotaDataAccess.fetchQuotaUploadStatus(t().ActiveForecastConfigInfo.id).then((function(t){t&&(t.Status==i.QuotaStatus.InProgress&&n(c,e),e(r.QuotaUploadStatusUpdate(t))),e(r.QuotaUploadFetchUpdate(!0))})).catch((function(){var t=a.GetEmptyQuotaStatusInfo();t.Status=i.QuotaStatus.Failed,t.ErrorCode="FETCH_FAILED",e(r.QuotaUploadStatusUpdate(t)),e(r.QuotaUploadFetchUpdate(!0)),_(c,l.NotificationEventType.NOTIFY_QUOTA_UPLOAD_EVENTS)}))}(e),"@@EditApp/QuotaUploadStartAction"==E.type){var m=a.GetEmptyQuotaStatusInfo();m.Status=i.QuotaStatus.Uploading,e(r.QuotaUploadStatusUpdate(m)),function(e,s){var l=o.getCrmDataAccessInstance();if(!l)return void console.warn("CrmDataAccess object is null. Unalbe to upload quota");var c=t().ActiveForecastConfigInfo.id;n(c,s),l.quotaDataAccess.uploadQuotaExcel(t().ActiveForecastConfigInfo.id,e.payload.fileName,e.payload.fileContent).then((function(e){s(r.QuotaUploadStatusUpdate(e))})).catch((function(){var t=a.GetEmptyQuotaStatusInfo();t.Status=i.QuotaStatus.Failed,t.ErrorCode="UPLOAD_FAILED",t.UploadFileName=e.payload.fileName,s(r.QuotaUploadStatusUpdate(t)),_(c,s)}))}(E,e)}if("@@EditApp/QuotaDownloadAction"==E.type&&(t().quotaUploadStageState.isDownload||(e(r.QuotaUploadDownloadUpdate(!0)),function(e){var n=o.getCrmDataAccessInstance();if(!n)return void console.warn("CrmDataAccess object is null. Unable to download quota");n.quotaDataAccess.downloadQuotaTemplate(t().ActiveForecastConfigInfo.id).then((function(n){!function(e,t){var n="data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"+e,r=(t||u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_EDIT_FORECAST_TITLE_EDITPAGE))+"_"+u.GlobalLocalizedStringsProvider.GetString(d.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA)+".xlsx";if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(function(e){var t=e.split(/[:;,]/),n=t[1],r=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),o=r.length,i=0,a=new Uint8Array(o);for(;i<o;++i)a[i]=r.charCodeAt(i);return new Blob([a],{type:n})}(n),r);else{var o=document.createElement("a");document.body.appendChild(o),o.href=n,o.download=r,o.style.display="none",o.click(),document.body.removeChild(o)}}(n,t().ActiveForecastConfigInfo.name),e(r.QuotaUploadDownloadUpdate(!1))})).catch((function(){e(r.QuotaUploadDownloadUpdate(!1))}))}(e))),"@@EditApp/PublishAction"==E.type&&(e(r.QuotaUploadPublishUpdate(!0)),function(e,t){f(e().ActiveForecastConfigInfo.id,t);var n=e().ActiveForecastConfigInfo,i=o.getCrmDataAccessInstance();if(i){var a=n.id;i.forecastConfigAccess.publishForecastConfig(a).finally((function(){var e={formType:p.FormType.EditForm,formInput:{fcId:n.id}};new c.FormEventsHandler(t,i.forecastConfigAccess).RefreshForm(e).then((function(){t(r.QuotaUploadPublishUpdate(!1))}))}))}}(t,e)),"@@EditApp/NotificationConnectAction"==E.type){var S=s.NotificationProvider.Get();S&&S.connect()}return"@@EditApp/PublishSubscribeAction"==E.type&&f(t().ActiveForecastConfigInfo.id,e),e(E)}};function n(e,n){s.NotificationProvider.Get().subscribe({groupId:e,eventName:l.NotificationEventType.NOTIFY_QUOTA_UPLOAD_EVENTS},(function(o){var i=t().quotaUploadStageState.quotaStatusInfo;i.Status=o.Properties.QuotaUploadStatus,i.ErrorCode=o.Properties.ErrorCode,n(r.QuotaUploadStatusUpdate(i)),_(e,l.NotificationEventType.NOTIFY_QUOTA_UPLOAD_EVENTS)}))}function _(e,t){s.NotificationProvider.Get().unsubscribe({groupId:e,eventName:t})}function f(e,n){var i=o.getCrmDataAccessInstance();s.NotificationProvider.Get().subscribe({groupId:e,eventName:l.NotificationEventType.NOTIFY_FC_PUBLISH_EVENTS},(function(o){var a=t().ActiveForecastConfigInfo,s={formType:p.FormType.EditForm,formInput:{fcId:a.id}};new c.FormEventsHandler(n,i.forecastConfigAccess).RefreshForm(s).then((function(){n(r.QuotaUploadFetchUpdate(!0)),_(e,l.NotificationEventType.NOTIFY_FC_PUBLISH_EVENTS)}))}))}}},905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(72),o=n(135),i=n(185),a=n(82),s=n(174),l=n(184),c=n(51),u=n(240),d=n(11),p=n(12),_=n(98),f=n(88),E=n(17),m=n(354);function S(e,t){var n=e(),o=r.getCrmDataAccessInstance(),i=n.mainPageType;o?i==s.IMainPageType.GridPage?o.forecastConfigAccess.fetchForecastConfigList().then((function(e){t(a.UpdateForecastConfigList(e))})).catch((function(){t(_.onErrorShowDialogActionCreator(f.IErrorDialogType.ForecastConfigFetchingFailed))})):console.log("No Refresh Needed for edit app"):console.warn("Refresh attempted when crmDataAccess was NULL ")}t.forecastConfigActionsMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@GridApp/ON_DELETE_CONFIRM_DIALOG_CLICK"==n.type&&n.payload.dialogActionClicked==o.IDeleteDialogActionType.DELETE){var a=t(),g=a.mainPageType,C="";g==s.IMainPageType.EditPage?C=a.ActiveForecastConfigInfo.id:g==s.IMainPageType.GridPage&&(C=a.gridAppDialogState.gridActionableRow),c.logUsage("DelfiConfigApp.Delete","Grid_App_Delete_Confirmed_Button_Clicked",{ButtonName:"Delete",rowselected:C}),function(e,t,n){var o=e().mainPageType,i=r.getCrmDataAccessInstance();i?""!=n&&i.forecastConfigAccess.deleteForecastConfig(n).then((function(n){o==s.IMainPageType.EditPage?function(e){l.NavigationHandlerFactory.GetNavigationHandlerObject(e).OpenGridPage()}(t):S(e,t)})).catch((function(){t(_.onErrorShowDialogActionCreator(f.IErrorDialogType.ForecastConfigDeleteFailed))})):console.warn("Delete attempted when crmDataAccess was NULL")}(t,e,C),e(i.onGridAppDialogDeleteStateActionCreator(!0))}return"@@GridApp/ON_DELETE_CONFIRM_DIALOG_CLICK"!=n.type||n.payload.dialogActionClicked!=o.IDeleteDialogActionType.CANCEL&&n.payload.dialogActionClicked!=o.IDeleteDialogActionType.CLOSE||(e(i.onRowSelectedActionCreator("")),e(i.onGridAppDialogDeleteStateActionCreator(!0))),"@@GridApp/ON_PUBLISH_CONFIRM_DIALOG_CLICK"==n.type&&n.payload.dialogActionClicked==o.IPublishDialogActionType.PUBLISH&&(!function(e,t){var n=e(),o=r.getCrmDataAccessInstance();o?""!=n.gridAppDialogState.gridActionableRow&&(c.logUsage("DelfiConfigApp.Publish","Grid_App_Publish_Confirmed_Button_Clicked",{ButtonName:"Publish",rowselected:n.gridAppDialogState.gridActionableRow}),u.showOrHideCrmLoaading(!0,d.GlobalLocalizedStringsProvider.GetString(p.STRING_KEYS.FC_CRM_PUBLISHING_CALLS)),o.forecastConfigAccess.publishForecastConfig(n.gridAppDialogState.gridActionableRow).then((function(r){o.forecastConfigAccess.fetchForecastConfig(n.gridAppDialogState.gridActionableRow).then((function(e){if(e.status==E.IForecastConfigStatus.Failed&&e.publishErrorMessage){var n=m.getlocalizedFCPublishErrorMessage(e.publishErrorMessage);n&&t(_.onErrorShowDialogActionCreator(f.IErrorDialogType.ForecastConfigPublishFailed,n))}u.showOrHideCrmLoaading(!1)})),S(e,t)})).catch((function(){t(_.onErrorShowDialogActionCreator(f.IErrorDialogType.ForecastConfigPublishFailed)),u.showOrHideCrmLoaading(!1)}))):console.warn("Publish attempted when crmDataAccess was NULL")}(t,e),e(i.onGridAppDialogPublishStateActionCreator(!0))),"@@GridApp/ON_PUBLISH_CONFIRM_DIALOG_CLICK"!=n.type||n.payload.dialogActionClicked!=o.IPublishDialogActionType.CANCEL&&n.payload.dialogActionClicked!=o.IPublishDialogActionType.CLOSE||(e(i.onRowSelectedActionCreator("")),e(i.onGridAppDialogPublishStateActionCreator(!0))),e(n)}}}},906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(72);t.amountBaseFieldFetcherMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@FormData/UpdateColumnInfoField"==n.type&&"amountField"==n.payload.fieldName&&n.payload.value){var i=t().FormFieldData.rollupEntity;(function(e,t){return new Promise((function(n,r){var i=o.getCrmDataAccessInstance();if(i)if(t){var a={name:t,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""};i.cdsResolver.resolveFieldsMetadata(a).then((function(t){var r=t.find((function(t){return t.CalculationOf==e}));r?n(r.name):(n(e),console.warn("Couldnt find base amount field for the selected field"))}))}else r("EntityName not defined");else r("CRMDataAccess not defined")}))})(n.payload.value,i).then((function(t){e(r.UpdateColumnInfoField(n.payload.colId,"amountBaseField",t))})).catch((function(e){console.warn("Error while fetching amount base field - "+e)}))}return e(n)}}}},907:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(89),o=n(245);t.previewGridColumnReorderMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@PreviewGrid/Reorder"==n.type){var i=r.GetPreviewGridColumnList_FromState(t()),a=i[n.payload.dragIndex].id,s=i[n.payload.targetIndex].id;e(o.ReorderColumnsWithId(a,s))}return e(n)}}}},908:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(72),o=n(144),i=n(51);t.siAvailabilityMiddleware=function(e){return e.getState,function(e){return function(t){return"@@CrmOrgInfo/TriggerUpdateSIPackageStatus"==t.type&&function(e,t){var n=r.getCrmDataAccessInstance();if(!n)return void console.warn("CrmDataAccess object is null. Unable to fetch SI Package Status");n.siDataAccess.isSIPackageInstalled().then((function(e){t(o.UpdateSIPackageStatus(e))}),(function(e){i.logError("An error occurred while fetching the SI Package status: ",e,"")}))}(0,e),e(t)}}}},909:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=n(17),i=n(107);t.columnInfoEditsMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@FormData/UpdateColumnInfoField"==n.type&&"title"==n.payload.fieldName&&!t().columnEditorState.hasUniqueNameBeenEdited){var a=i.filterNonValidCharactersForUniqueName(n.payload.value);e(r.UpdateColumnInfoField(n.payload.colId,"uniqueName",a))}return"@@FormData/UpdateColumnInfoField"==n.type&&"columnType"==n.payload.fieldName&&n.payload.value==o.ForecastColumnType.Calculated&&e(r.UpdateColumnInfoField(n.payload.colId,"calculatedFieldExpression","")),e(n)}}}},910:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(110),o=n(72),i=n(144),a=n(51),s=n(98),l=n(88),c=n(184);t.hierarchyEntitiesMetadataFetcherMiddleware=function(e){var t=e.getState;return function(e){return function(o){if("@@FormData/UpdateFieldValue"==o.type&&o.payload.data.hierarchyRelationship)for(var i=t(),a=JSON.parse(JSON.stringify(o.payload.data.hierarchyRelationship));null!=a;)r.IsEntityMetadataAvailable_InState(i,a.entityName)?a.entityName==i.FormFieldData.hierarchyEntity&&u(i,e):n(i,a.entityName,e),a=a.relationship;if("@@Metadata/SetEntityMetadata"==o.type&&void 0!==o.payload.value[t().FormFieldData.hierarchyEntity]){var s=e(o);return u(i=t(),e),s}return"@@Utility/OnOkErrorDialogClick"==o.type&&t().genericErrorDialogState.dialogType==l.IErrorDialogType.HierarchyRelationsDoesntExistDialog&&function(e){c.NavigationHandlerFactory.GetNavigationHandlerObject(e).OpenGridPage()}(e),e(o)}};function n(e,t,n){return new Promise((function(e,r){var s=o.getCrmDataAccessInstance();if(!s){var l="CrmDataAccess object is null. Unable to fetch entity metadata: "+t;console.warn(l),r(l)}s.cdsResolver.cdsClient.then((function(r){r.fetchEntityAndRelatedEntityMetadata({entityName:t}).then((function(r){n(i.SetEntityMetadata(t,r)),e(!0)}))})).catch((function(e){a.logError("Delphi-Config entity metadata",e,"Please contact Dynamics Sales Forecasting - Delphi Config Forecast team",t),r(e)}))}))}function u(e,t){0==r.isEntityHierarchyRelationshipConfigured(e)&&t(s.onErrorShowDialogActionCreator(l.IErrorDialogType.HierarchyRelationsDoesntExistDialog,r.getHierarchyRelationshipNotConfiguredErrorMessage(e)))}}},911:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(72),o=n(110),i=n(244);t.securityRolesFetcherMiddleware=function(e){var t=e.getState,n=e.dispatch;return function(e){return function(a){return"@@OrgSecurityRoles/TriggerFetchSecurityRoles"!=a.type||o.areRolesFetched_FromState(t())||function(e,t){var n=[];e.getRoles().then((function(e){n=e.map((function(e){return{roleId:e.roleId,roleName:e.roleName}}))})).catch((function(){})).finally((function(){t(i.SetSecurityRolesListInState(n))}))}(r.getCrmDataAccessInstance().roleDataAccess,n),e(a)}}}},912:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n(82),a=n(45),s=n(110),l=n(49),c=n(231);function u(e){if(null!=e.FormFieldData.permissionsData){var t=c.IsPermissionTypeConfigured_FromState(o.PermissionType.User,e);return r({},e.FormFieldData.permissionsData,{permissionTypes:t?[o.PermissionType.User]:[]})}return null}function d(e,t){return null==e.FormFieldData.permissionsData?{permissionTypes:[t],permissionAttribueInfo:null,permissionRoles:null}:r({},e.FormFieldData.permissionsData,{permissionTypes:f(t,e)})}function p(e,t){return null==t.FormFieldData.permissionsData.permissionRoles?[{roleId:e,roleName:""}]:-1==t.FormFieldData.permissionsData.permissionRoles.findIndex((function(t){return t.roleId==e}))?t.FormFieldData.permissionsData.permissionRoles.concat([{roleId:e,roleName:""}]):t.FormFieldData.permissionsData.permissionRoles}function _(e,t){if(null!=t.FormFieldData.permissionsData.permissionRoles){var n=[];return t.FormFieldData.permissionsData.permissionRoles.forEach((function(t){t.roleId!=e&&n.push(r({},t))})),n}return null}function f(e,t){var n=c.IsPermissionTypeConfigured_FromState(o.PermissionType.User,t),r=t.FormFieldData.permissionsData.permissionTypes.slice();switch(e){case o.PermissionType.User:n||(r=r.concat([e]));break;case o.PermissionType.Role:case o.PermissionType.All:r=n?[o.PermissionType.User,e]:[e]}return r}function E(e,t){if(c.IsPermissionTypeConfigured_FromState(e,t)){var n=[];return t.FormFieldData.permissionsData.permissionTypes.forEach((function(t){t!=e&&n.push(t)})),n}return t.FormFieldData.permissionsData.permissionTypes}function m(e,t,n){n(i.UpdateFieldValue({permissionsData:e})),function(e,t,n){var r=a.ForecastingBusinessLogicProvider.getColumnForPermissionsAttribute(e),o=c.doesPermissionColumnExist(t.FormFieldData.columns);if(r){var i=e.permissionAttribueInfo,u=s.getAttributeDisplayName(i.relationship.entityName,i.attributeName,t);if(u&&(r.title=u||r.title),o){var d=c.getPermissionsColumnId(t);n(l.ReplaceColumn(d,r))}else n(l.AddColumn(r))}else o&&n(l.DeleteColumn(c.getPermissionsColumnId(t)))}(e,t,n)}function S(e,t){return{attributeName:e,relationship:{entityName:t.FormFieldData.hierarchyEntity,linkedByAttribute:null,relationship:null}}}t.permissionDataMiddleware=function(e){var t=e.getState;return function(e){return function(n){if("@@PermissionsData/UpdatePermissionData"==n.type){var a=t();m(n.payload.permissionsData,a,e)}else if("@@PermissionsData/UpdatePermissionsAttribute"==n.type){a=t();m(s=function(e,t){var n;n=null!=e?null==t.FormFieldData.permissionsData?{permissionTypes:[o.PermissionType.User],permissionAttribueInfo:S(e,t),permissionRoles:null}:r({},t.FormFieldData.permissionsData,{permissionTypes:f(o.PermissionType.User,t),permissionAttribueInfo:S(e,t)}):r({},t.FormFieldData.permissionsData,{permissionTypes:E(o.PermissionType.User,t),permissionAttribueInfo:null});return n}(n.payload.attributeName,a),a,e)}else if("@@PermissionsData/AddPermissionsRoleAction"==n.type){a=t();var s=function(e,t){var n;n=null==t.FormFieldData.permissionsData?{permissionTypes:[o.PermissionType.Role],permissionAttribueInfo:null,permissionRoles:[{roleId:e,roleName:""}]}:r({},t.FormFieldData.permissionsData,{permissionTypes:f(o.PermissionType.Role,t),permissionRoles:p(e,t)});return n}(n.payload.roleId,a);e(i.UpdateFieldValue({permissionsData:s}))}else if("@@PermissionsData/DeletePermissionsRoleAction"==n.type){if(null!=(a=t()).FormFieldData.permissionsData){s=function(e,t){return r({},t.FormFieldData.permissionsData,{permissionRoles:_(e,t)})}(n.payload.roleId,a);e(i.UpdateFieldValue({permissionsData:s}))}}else if("@@PermissionsData/SetAdditionalViewingPermissionTypeAction"==n.type){a=t();null==n.payload.type?e(i.UpdateFieldValue({permissionsData:u(a)})):n.payload.type!=o.PermissionType.All&&n.payload.type!=o.PermissionType.Role||e(i.UpdateFieldValue({permissionsData:d(a,n.payload.type)}))}return e(n)}}}},913:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(541),i=n(49),a=n(98),s=n(88),l=n(11),c=n(12),u=function(){function e(e,t){void 0===t&&(t=void 0),this.dispatch=e,this.getState=t,this.navigationHandlers=new o.ReduxNavigationHandler(e)}return e.prototype.showGridPage=function(){this.navigationHandlers.OpenGridPage()},e.prototype.showEditPage=function(e){e?this.navigationHandlers.OpenEditPage(e):this.dispatch(a.onErrorShowDialogActionCreator(s.IErrorDialogType.ForecastConfigFormLoadError,l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_FORM_LOAD_ERROR_MISSING_FCID)))},e.prototype.showCreatePage=function(e){if(e){var t=Number(e);t!=r.ForecastConfigTemplateType.OrgChart&&t!=r.ForecastConfigTemplateType.TerritoryBased&&this.dispatch(a.onErrorShowDialogActionCreator(s.IErrorDialogType.ForecastConfigFormLoadError,l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_FORM_LOAD_ERROR_INVALID_TEMPLATE_TYPE))),this.navigationHandlers.OpenCreatePage(t)}else this.dispatch(a.onErrorShowDialogActionCreator(s.IErrorDialogType.ForecastConfigFormLoadError,l.GlobalLocalizedStringsProvider.GetString(c.STRING_KEYS.FC_FORM_LOAD_ERROR_MISSING_TEMPLATE_TYPE)))},e.prototype.SetPredictiveAvailabilityState=function(e){this.dispatch(i.UpdatePredictiveAvailabilityState(e))},e.prototype.updateCrmDataAccess=function(e){},e.prototype.updateUCIActionsObject=function(e){},e}();t.DelfiConfigActions=u},914:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0));n(915);var i=n(433),a=n(26),s=n(919),l=n(72),c={};t.default=function(){var e=i.store.getState().crmOrgInfo.clientUrl,t=i.store.getState().crmOrgInfo.orgId;null==c[e]&&(c[e]=l.createCrmDataAccessFromCrmUrl(e,t));var n=c[e];return l.setCrmDataAccessInstsance(n),o.default.createElement("div",{className:"DelfiConfigApp"},o.default.createElement(a.Provider,{store:i.store},o.default.createElement(s.ConnectedMainAppContainer,{crmDataAccess:n})))}},915:function(e,t,n){var r=n(916);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},916:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".DelfiConfigApp {\n  /* padding: 20px; */\n  background-color: white;\n  color: #323130 !important;\n  overflow-y: auto; }\n",""])},919:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(53),l=n(26),c=n(174),u=n(920),d=n(1341),p=n(144),_=n(1358),f=n(244);s.initializeIcons();var E=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.componentDidMount=function(){this.props.triggerFetchOrgSettings()},t.prototype.render=function(){var e=void 0;return e=this.props.isEditPageOpened?a.default.createElement(u.ConnectedEditApp,{crmDataAccess:this.props.crmDataAccess}):a.default.createElement(d.ConnectedGridApp,{crmDataAccess:this.props.crmDataAccess}),a.default.createElement("div",{className:"MainAppContainer"},e,a.default.createElement(_.ConnectedForecastConfigGenericErrorDialog,null))},t}(a.default.Component);t.default=E;t.ConnectedMainAppContainer=l.connect((function(e){return{isEditPageOpened:e.mainPageType==c.IMainPageType.EditPage}}),(function(e){return{triggerFetchOrgSettings:function(){e(p.TriggerFetchOrgFiscalCalenderStart()),e(f.TriggerFetchSecurityRolesList()),e(p.TriggerUpdateSIPackageStatus())}}}))(E)},920:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),s=n(921),l=n(17),c=n(1274),u=n(355),d=n(53),p=n(1277),_=n(1280);n(1283);var f=n(1285),E=n(108),m=n(1317),S=n(1322),g=n(682),C=n(1327),I=n(45),h=n(240),T=n(11),y=n(12),F=n(99),O=n(1335);d.initializeIcons();var D=function(e){function t(t){var n=e.call(this,t)||this;return n.renderStageForm=function(){return n.props.activeStage==E.ForecastConfigStage.Quota?a.default.createElement(C.ConnectedStage3Form,{key:"stage3"}):n.props.activeStage==E.ForecastConfigStage.General?a.default.createElement(s.ConnectedStage1Form,{crmDataAccess:n.props.crmDataAccess}):n.props.activeStage==E.ForecastConfigStage.Permission?a.default.createElement(O.ConnectedStagePermissionsForm,{crmDataAccess:n.props.crmDataAccess}):a.default.createElement(f.ConnectedStage2Form,{crmDataAccess:n.props.crmDataAccess})},n.state={},n.stageContainerDivRef=void 0,n}return o(t,e),t.prototype.componentDidUpdate=function(e){this.props.activeStage!==e.activeStage&&void 0!==this.stageContainerDivRef&&null!==this.stageContainerDivRef&&void 0!==this.stageContainerDivRef.scrollTop&&(this.stageContainerDivRef.scrollTop=0)},t.prototype.componentDidMount=function(){var e=this;h.showOrHideCrmLoaading(!0,T.GlobalLocalizedStringsProvider.GetString(y.STRING_KEYS.FC_LOADING));var t=this.getFormLoadInput();this.props.formEventsHandler.RefreshForm(t).then((function(t){t.status!=l.IForecastConfigStatus.Draft&&e.props.formEventsHandler.UpdateStepperStage(I.ForecastingBusinessLogicProvider.GetStageStepId(E.ForecastConfigStage.Quota)),h.showOrHideCrmLoaading(!1)}))},t.prototype.getFormLoadInput=function(){return this.props.formData.id.length>0?{formType:F.FormType.EditForm,formInput:{fcId:this.props.formData.id}}:{formType:F.FormType.CreateForm,formInput:{templateType:this.props.formData.templateType}}},t.prototype.setStageContainerRef=function(e){this.stageContainerDivRef=e},t.prototype.render=function(){return a.default.createElement("div",{className:"editPageApp"},a.default.createElement("div",null,a.default.createElement(S.ConnectedEditAppRibbon,null)),a.default.createElement("div",{className:"formSectionDivider"}),a.default.createElement("div",{className:"titleContainer"},a.default.createElement(c.ConnectedTitleEditor,{crmDataAccess:this.props.crmDataAccess}),a.default.createElement("div",null,a.default.createElement(m.ConnectedEditAppStatusInfo,null))),a.default.createElement("div",{className:"stepperContainer"},a.default.createElement(p.ConnectedDelphiStepperControl,null)),a.default.createElement("div",{style:{marginTop:16},className:"sectionDividerShadow"}),a.default.createElement("div",{ref:this.setStageContainerRef.bind(this),className:"stageAndFooterContainer"},a.default.createElement("div",{className:"stageContainer"},this.renderStageForm()),a.default.createElement("div",{className:"stepperButtonFooterStyle"},a.default.createElement(_.ConnectedDelphiStepperButton,null))),a.default.createElement(g.ConnectedForecastConfigGridConfirmationDialog,null))},t}(a.default.Component);t.default=D,t.ConnectedEditApp=u.ConnectedFormGenerator(D)},921:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(0)),c=n(99),u=s(n(355));n(1263);var d=n(1265),p=n(11),_=n(12),f=n(25),E=a(n(356)),m=n(261),S=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return o(t,e),t.prototype.render=function(){return l.default.createElement("div",null,this.renderStage1())},t.prototype.renderStage1=function(){return l.default.createElement("div",null,l.default.createElement("div",{className:"sectionHeader"},p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_CONFIGURATION_SECTION_HEADER_STAGE1)),l.default.createElement("div",{className:"sectionSubtitle"},p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_CONFIGURATION_SECTION_SUBTITLE_STAGE1)),l.default.createElement("div",{className:"configurationWrapper"},l.default.createElement("div",{className:"configurationSecEntitySelection"},l.default.createElement("div",null,this.renderRollupEntity()),l.default.createElement("div",{style:{marginTop:24}},this.renderHierarchyRoute()),l.default.createElement("div",{style:{marginTop:24}},this.renderTopOfHierarchy())),this.renderHierarchyPreview()),l.default.createElement("div",{style:{marginTop:32}}),l.default.createElement("div",{className:"sectionHeader"},p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_SCHEDULING_SECTION_HEADER_STAGE1)),l.default.createElement("div",{className:"sectionSubtitle"},p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_SCHEDULING_SECTION_SUBTITLE_STAGE1)),l.default.createElement("div",{className:"schedulingWrapper"},l.default.createElement("div",{className:"periodSelector"},this.renderForecastPeriodSelector()),l.default.createElement("div",{className:"yearSelector"},this.renderYearSelector()),l.default.createElement("div",{className:"startAt"},this.renderStartsAt()),l.default.createElement("div",{className:"numRec"},this.renderNumRecurrences()),l.default.createElement("div",{className:"validFrom"},this.renderValidFrom()),l.default.createElement("div",{className:"validTo"},this.renderValidTo())))},t.prototype.renderSubtitle=function(e){return l.default.createElement("div",{className:"sectionSubtitle"},e)},t.prototype.renderHierarchyEntity=function(){var e=c.ICrmAttributeType.EntityPicker,t=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_HIERARCHY_ENTITY_STAGE1);return this.renderFormControl("hierarchyEntity","hierarchyEntity","forecastconfiguration",e,t,!1,!0)},t.prototype.renderHierarchyRoute=function(){var e=this,t=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_HIERARCHY_ROUTE_FIELD_LABEL);return l.default.createElement("div",null,l.default.createElement(E.default,i({},{labelText:t,isDisabled:!0}),l.default.createElement(m.Dropdown,{label:t,options:[],disabled:!0,onRenderPlaceHolder:function(){var t=l.default.createElement("div",{style:{marginTop:5}},l.default.createElement(f.Spinner,null));return e.props.hierarchyRoute.length>0&&(t=e.props.hierarchyRoute),t}})))},t.prototype.renderRollupEntity=function(){var e=c.ICrmAttributeType.EntityPicker,t=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_ROLLUP_ENTITY_STAGE1);return this.renderFormControl("rollupEntity","rollupEntity","forecastconfiguration",e,t,!1,!0)},t.prototype.renderTopOfHierarchy=function(){var e=this.props.formData.hierarchyEntity,t=c.ICrmAttributeType.Lookup,n=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_TOP_OF_HIERARCHY2_STAGE1);return this.renderFormControl("topOfHierarchy","",e,t,n,!1)},t.prototype.renderHierarchyPreview=function(){return l.default.createElement("div",{className:"hierarchyPreviewSection"},l.default.createElement("span",{className:"hierarchyPreviewTitle"},p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_PREVIEW_GRID_HEADING_STAGE2)),l.default.createElement("div",{className:"hierarchyPreview"},l.default.createElement(d.ConnectedHierarchyPreview,null)))},t.prototype.renderForecastPeriodSelector=function(){var e=c.ICrmAttributeType.OptionSet,t=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_FORECAST_PERIOD_STAGE1);return this.renderFormControl("period","msdyn_periodtype","msdyn_forecastconfiguration",e,t,!1)},t.prototype.renderYearSelector=function(){var e=c.ICrmAttributeType.OptionSet,t=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_FISCAL_YEAR_STAGE1);return this.renderFormControl("fiscalyear","msdyn_startingfiscalyear","msdyn_forecastconfiguration",e,t,!1)},t.prototype.renderNumRecurrences=function(){var e,t,n=c.ICrmAttributeType.NumberPicker,r=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_NUMBER_OF_PERIODS_STAGE1),o=((e={}).maxValue=4,e);return""+this.props.formData.period=="0"&&((t={}).maxValue=12,o=t),this.renderFormControl("numberOfRecurrences","numberOfRecurrences","forecastconfiguration",n,r,!1,!1,o)},t.prototype.renderStartsAt=function(){return""+this.props.formData.period=="0"?this.renderStartsAtMonth():this.renderStartsAtQuater()},t.prototype.renderStartsAtMonth=function(){var e,t=c.ICrmAttributeType.OptionSet,n=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_FORECAST_START_AT_STAGE1),r=((e={}).sortByDisplayName=!1,e);return this.renderFormControl("startAtMonth","msdyn_startingfiscalmonth","msdyn_forecastconfiguration",t,n,!1,!1,r)},t.prototype.renderStartsAtQuater=function(){var e=c.ICrmAttributeType.OptionSet,t=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_FORECAST_START_AT_STAGE1);return this.renderFormControl("startAtQuater","msdyn_startingfiscalquarter","msdyn_forecastconfiguration",e,t,!1)},t.prototype.renderValidFrom=function(){var e=c.ICrmAttributeType.DatePicker,t=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_VALID_FROM_STAGE1);return this.renderFormControl("fromDate","msdyn_startdate","msdyn_forecastconfiguration",e,t,!1,!0)},t.prototype.renderValidTo=function(){var e=c.ICrmAttributeType.DatePicker,t=p.GlobalLocalizedStringsProvider.GetString(_.STRING_KEYS.FC_VALID_TO_STAGE1);return this.renderFormControl("toDate","msdyn_validto","msdyn_forecastconfiguration",e,t,!1,!0)},t}(u.default);t.default=S,t.ConnectedStage1Form=u.ConnectedFormGenerator(S)},922:function(e,t,n){var r=n(923);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(31)(r,o);r.locals&&(e.exports=r.locals)},923:function(e,t,n){(e.exports=n(30)(!1)).push([e.i,".formLabel,\n.FormControlDecorator .ms-Dropdown-label,\n.CrmNumberPickerControl .ms-Label,\n.ms-TextField-wrapper .ms-Label,\n.crmAttributePickerControl .ms-Label {\n  font-weight: 600;\n  padding: 5px 0;\n  display: flex;\n  color: #333333; }\n\n.delfiFormFieldError .ms-BasePicker-text {\n  border-color: #a4262c; }\n\n.delfiFormFieldError .formWarningText {\n  color: #a4262c;\n  font-size: 12px;\n  line-height: 16px; }\n\n.formLabelHelpContainer {\n  clear: both;\n  float: right;\n  margin-top: 8px; }\n\n.formLabelHelpIcon {\n  margin-left: 5px;\n  font-size: 14px; }\n\n.CrmNumberPickerControl div:first-child {\n  margin-bottom: 0px; }\n",""])},924:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(n(0)),l=n(122),c=n(53);n(1258),c.initializeIcons();var u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={displayName:""},n}return o(t,e),t.prototype.shouldComponentUpdate=function(e,t){return this.props.value!==e.value||this.props.targetEntity!==e.targetEntity},t.prototype.onChanged=function(e,t){e.length>0?(this.props.onChange(e[0].id),this.setState({displayName:e[0].displayName})):this.props.onChange(e)},t.prototype.render=function(){var e=this.generateMakerXControlProps(),t=""==this.props.value?" delfiFormFieldError":"";return s.default.createElement("div",{className:"crmLookupControl"+t,"aria-required":"true"},s.default.createElement(l.LookupPicker,i({},e)))},t.prototype.generateMakerXControlProps=function(){var e={name:this.props.targetEntity,displayName:"",metadataId:"",primaryNameField:"",primaryIdField:""},t={metadataId:this.props.attributeInfo.id,name:this.props.attributeInfo.name,displayName:this.props.attributeInfo.name,dataType:l.EDataType.UniqueIdentifier},n="";return this.props.value&&(n=[{entityLogicalName:this.props.targetEntity,id:this.props.value,displayName:this.state.displayName}]),{resolver:this.props.crmDataAcces.cdsResolver,value:n,onChanged:this.onChanged.bind(this),entityContext:e,fieldContext:t,labels:{inputControlLabel:this.props.label,loadingResults:"Loading",noResults:"No Results"},singleSelect:!0,disabled:this.props.isDisabled}},t}(s.default.Component);t.default=u},97:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(324),i=n(223),a=n(11),s=n(12),l=n(325),c=n(107);function u(){return{displayName:"",entityLogicalName:"",id:""}}function d(e){return[{id:o.generateNewGuid(),title:"HierarchyPrimary",columnType:r.ForecastColumnType.HierarchyPrimary,isActive:!0,uniqueName:"owner"},{id:o.generateNewGuid(),title:a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_QUOTA),columnType:r.ForecastColumnType.Quota,isActive:!0,uniqueName:c.filterNonValidCharactersForUniqueName("quota")},{id:o.generateNewGuid(),title:a.GlobalLocalizedStringsProvider.GetString(s.STRING_KEYS.FC_COLUMN_EDITOR_COLUMN_TYPE_PREDICTIVE),columnType:r.ForecastColumnType.Predictive,isActive:!1,uniqueName:c.filterNonValidCharactersForUniqueName("predictive"),amountField:"actualvalue",dateField:"actualclosedate",selector:"<fetch version = '1.0' output-format='xml-platform' mapping='logical' distinct='false'><entity name = 'opportunity' ><attribute name='opportunityid' /><order attribute = 'name' descending='false' /><filter type = 'and' ><condition attribute='statecode' operator='eq' value='1' /><condition attribute = 'statuscode' operator='eq' value='3' /></filter></entity></fetch>",showProgressComparedToQuota:!1,isManuallyAdjustable:!1}]}function p(){return{Id:"",ForecastConfigutaionId:"",OrgId:"",Status:i.QuotaStatus.New,UniqueFileName:"",UploadFileName:"",UploadedOn:new Date,ErrorCode:""}}t.GetEmptyForecastConfigInfo=function(e){var t=e&&l.forecastConfigTemplates[e]?e:r.ForecastConfigTemplateType.OrgChart,n=l.forecastConfigTemplates[t];return{id:"",name:"",rollupEntity:n.rollupEntity,hierarchyEntity:n.hierarchyEntity,topOfHierarchy:"",period:"1",fiscalyear:"",fromDate:(new Date).toDateString(),toDate:(new Date).toDateString(),status:r.IForecastConfigStatus.Draft,statusDescription:"Draft",forecastCategoryAttributeName:"",owner:{displayName:"",entityLogicalName:"",id:""},numberOfRecurrences:1,startAtQuater:"",startAtMonth:"",columns:d(t),additionalFilter:'<fetch version="1.0" mapping="logical"><entity name="'+n.rollupEntity+'"></entity></fetch>',templateType:t,hierarchyRelationship:n.hierarchyRelationship,permissionsData:null}},t.GetEmptyHierarchyRelationship=function(){return{entityName:"",linkedByAttribute:null,relationship:null}},t.GetEmptyForecastHierarchyDisplayInfo=function(){return{id:"",displayName:"",parentId:""}},t.getEmptyDataRecord=u,t.GetInitialColumns=d,t.GetSampleForecastQuotaColumnInfo=function(){return{id:"quota",title:"Quota",columnType:r.ForecastColumnType.Quota,isActive:!0,uniqueName:"quota"}},t.GetNewEmptyForecastColumnInfo=function(){return{id:o.generateNewGuid(),title:"",isActive:!0,uniqueName:""}},t.GetEmptyQuotaStageStatus=function(){return{isFetched:!1,isDownload:!1,isPublishing:!1,quotaStatusInfo:p()}},t.GetEmptyQuotaStatusInfo=p},98:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onClickOkErrorDialogActionCreator=function(){return{type:"@@Utility/OnOkErrorDialogClick",payload:{isErrorDialogHidden:!0}}},t.onErrorShowDialogActionCreator=function(e,t){return void 0===t&&(t=""),{type:"@@Utility/OnErrorShowDialog",payload:{errorDialogType:e,isErrorDialogHidden:!1,message:t}}}},99:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Lookup=0]="Lookup",e[e.OptionSet=1]="OptionSet",e[e.EntityPicker=2]="EntityPicker",e[e.NumberPicker=3]="NumberPicker",e[e.DatePicker=4]="DatePicker",e[e.AmountField=5]="AmountField",e[e.DateField=6]="DateField"}(t.ICrmAttributeType||(t.ICrmAttributeType={})),function(e){e[e.CreateForm=0]="CreateForm",e[e.EditForm=1]="EditForm"}(t.FormType||(t.FormType={}))}});