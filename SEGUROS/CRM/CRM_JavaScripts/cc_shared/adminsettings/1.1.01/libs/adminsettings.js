var adminsettings=function(e){function t(t){for(var a,s,o=t[0],l=t[1],c=t[2],u=0,g=[];u<o.length;u++)s=o[u],i[s]&&g.push(i[s][0]),i[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(d&&d(t);g.length;)g.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},i={0:0},r=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window.webpackJsonpadminsettings=window.webpackJsonpadminsettings||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=l;return r.push([409,1]),n()}({146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(208),i=n(417);t.initialAppState={mainPageType:a.IMainPageType.MainPage,crmOrgInfo:{calenderStartDate:"",clientUrl:"",orgId:""},viewId:"",isManage:"",salesSettings:i.GetDefaultSalesSettings()}},208:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.MainPage=0]="MainPage",e[e.SettingPage=1]="SettingPage"}(t.IMainPageType||(t.IMainPageType={}))},218:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.getCCFProvider=function(){return this.defaultProvider},e.setCCFProvider=function(e){this.defaultProvider=e},e}();t.CCFContextProvider=a},258:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(423),i=n(208),r=function(){function e(e){this.dispatch=e}return e.prototype.OpenPage=function(e){console.log("OpenPage <>");this.dispatch(a.changeMainPageType(i.IMainPageType.SettingPage))},e}();t.ReduxNavigationHandler=r},285:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}};Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(41),o=n(46),l=n(450),c=n(451),d=n(452),u=n(31),g=n(32),p=n(42),S=n(453);!function(e){e[e.GetStatus=0]="GetStatus",e[e.Enable=1]="Enable",e[e.Disable=2]="Disable"}(r||(r={}));var f=function(){function e(){}return e.SendPhotoFetchMetadataUpdateBatchRequest=function(t){return a(this,void 0,void 0,(function(){var n,a,r,s,o,l,c,d,f,m;return i(this,(function(i){switch(i.label){case 0:for(n=["38b4fb08-255a-4d93-8463-b7a3a130aeae","c78749af-157e-e911-8196-000d3a6e2f8d","ce226554-7c33-4210-8a09-a7e16441337f"],a=[],window.Xrm.Utility.showProgressIndicator(u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_Processing)),r=0;r<n.length;r++)s={statecode:t?0:1},o=new S.ODataUpdateRequest("sdkmessageprocessingstep",n[r],s),a.push(o);l=a,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Xrm.WebApi.online.executeMultiple(l)];case 2:return c=i.sent(),d=e.PhotoFetchBatchRequestSuccessHandler(c,t),window.Xrm.Utility.closeProgressIndicator(),d?window.Xrm.UI.addGlobalNotification(1,1,u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_ToastMessage_Success),"",null):window.Xrm.UI.addGlobalNotification(1,2,u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_ToastMessage_Failure),"",null),[3,4];case 3:return f=i.sent(),window.Xrm.Utility.closeProgressIndicator(),window.Xrm.UI.addGlobalNotification(1,2,u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_ToastMessage_Failure),"",null),(m=new Map).set("requestName","PhotoFetchSettingUpdate_SDKStepsActivation_"+t),m.set("requestExecutionStatus","Failed"),p.logError("SalesAdminSettings.LinkedInPhotoRefresh",f,"Photo refresh setting: Partial success",m),[3,4];case 4:return[2]}}))}))},e.enableLinkedInUpdates=function(){return a(this,void 0,void 0,(function(){var e;return i(this,(function(t){return o.XrmHelper.isXrmEnabled()?(e=new c.EnableLinkedInDataValidationRequest,[2,window.Xrm.WebApi.online.execute(e)]):[2]}))}))},e.disableLinkedInUpdates=function(){return a(this,void 0,void 0,(function(){var e;return i(this,(function(t){return o.XrmHelper.isXrmEnabled()?(e=new d.DisableLinkedInDataValidationRequest(r.Disable),[2,Xrm.WebApi.online.execute(e)]):[2]}))}))},e.FetchLinkedInUpdatesStatus=function(){return a(this,void 0,void 0,(function(){var e,t,n,a,r,o,c,d,S,f,m,_;return i(this,(function(i){switch(i.label){case 0:e=new l.IsLinkedInDataValidationEnabledRequest,i.label=1;case 1:return i.trys.push([1,7,,8]),[4,Xrm.WebApi.online.execute(e)];case 2:if(null==(t=i.sent()))return[3,6];console.log(t),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,t.json()];case 4:return null!=(n=i.sent()).Result&&(a=JSON.parse(n.Result),console.log(a),null==(r={orchestrationInstanceId:a?a.orchestrationInstanceId:null,dataValidationSetting:!!a&&a.isDataValidationEnabled,status:a&&a.customStatus&&a.customStatus.status?a.customStatus.status.result:null,errorMsg:a&&a.customStatus&&a.customStatus.status?a.customStatus.status.errorCode:null,lastRefreshTime:a&&a.customStatus?a.customStatus.lastRefreshTime:null,nextRefreshTime:a&&a.customStatus?a.customStatus.nextRefreshTime:null}).errorMsg||40004!=r.errorMsg&&40003!=r.errorMsg?r.errorMsg="UNEXPECTED_ERROR":r.errorMsg="CRM_SYNC_UNAVAILABLE",s.store.getState().salesSettings.sales_enable_linkedin_updates=r.dataValidationSetting,r.dataValidationSetting?(o="",c="",d="",null!=a&&null!=a.customStatus&&null!=a.customStatus.status&&0==a.customStatus.status.result.localeCompare("Queued")?(o="On (pending)",S=new Date(r.nextRefreshTime),c=S.toString(),d=u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_LI_Status)+" "+o+u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_LI_Status_NextRefresh)+" "+c):null!=a&&null!=a.customStatus&&null!=a.customStatus.status&&0==a.customStatus.status.result.localeCompare("Terminated")?(o="Disabled",S=new Date(r.lastRefreshTime),c=S.toString(),d=u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_LI_Status)+" "+o+u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_LI_Status_LastRefresh)+" "+c):null!=a&&null!=a.customStatus&&null!=a.customStatus.status&&0==a.customStatus.status.result.localeCompare("Success")?(o="On",d=u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_LI_Status)+" "+o):null!=a&&null!=a.customStatus&&null!=a.customStatus.status&&0==a.customStatus.status.result.localeCompare("Failed")?(o="On",d=u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_LI_Status)+" "+o):null!=a&&null!=a.customStatus&&null!=a.customStatus.status&&(console.log("Neither Queued/Terminated"),console.log(a.customStatus.status.result),console.log(r.status)),console.log(d),s.store.getState().salesSettings.sales_enable_linkedin_updates_status=d):s.store.getState().salesSettings.sales_enable_linkedin_updates_status=""),[3,6];case 5:return f=i.sent(),console.log(f),s.store.getState().salesSettings.sales_enable_linkedin_updates_status="",[3,6];case 6:return[3,8];case 7:return m=i.sent(),console.log(m),(_=new Map).set("requestName","FetchLinkedInUpdatesStatus"),_.set("requestExecutionStatus","Failed"),p.logError("SalesAdminSettings.LinkedInFetchLinkedInUpdatesStatus",m,"",_),[3,8];case 8:return[2]}}))}))},e.PhotoFetchBatchRequestSuccessHandler=function(t,n){for(var a=!0,i=0;i<t.length;i++)if(!t[i].ok){a=!1;break}if(a){var r={};return r.sales_linkedin_profile_feature=n,n&&(r.sales_linkedin_profileFetch_Status=null),e.UpdateSettings(s.store.getState().salesSettings.sales_linkedin_configurationid,r),!0}var o=new Map;return o.set("requestName","PhotoFetchSettingUpdate_SDKStepsActivation_"+n),o.set("requestExecutionStatus","PartialSuccess"),o.set("responseDetails",JSON.stringify(t)),p.logInfo("SalesAdminSettings.LinkedInPhotoRefresh","Photo refresh setting: Partial success",o),!1},e.UpdateSettings=function(e,t){return a(this,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return"sales_linkedin_configuration",[4,Xrm.WebApi.updateRecord("sales_linkedin_configuration",e,t)];case 1:return n.sent(),[2]}}))}))},e}();t.LinkedInSettingsHelper=f},286:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(56),d=n(53),u=n(44),g=l(n(0)),p=n(38),S=n(41),f=n(37);n(49);var m=n(54),_=n(46),h=n(31),b=n(32),v=n(48),y=n(42),C=n(91),I=n(92),E=n(81);p.initializeIcons();var P=function(e){function t(t){var n=e.call(this,t)||this;return n._root=g.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return g.default.createElement(c.GroupHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handle_bc=n.handle_bc.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={bcSettingStatus:{isChanged:!1,currentValue:!1}},n._items=[],n._items.push({key:"bc",name:"Save business card images",description:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_BusinessCardManage),featurekey:"bc",onchangehandler:n.handle_bc}),n._groups=[{key:"g1",name:"Improve Productivity",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,_.XrmHelper.LoadSalesSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({bcSettingStatus:{isChanged:!1,currentValue:S.store.getState().salesSettings.store_business_card_image}}),this.pageHeader.focus(),(e=new Map).set("Page","business_card_scan"),e.set("Status","Loaded"),y.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",e),[2]}}))}))},t.prototype.handle_bc=function(e,t){console.log("handle_bc >>"),console.log(t),this.state.bcSettingStatus.isChanged=!this.state.bcSettingStatus.isChanged,this.state.bcSettingStatus.currentValue=t,this.setState({bcSettingStatus:{isChanged:this.state.bcSettingStatus.isChanged,currentValue:t}}),S.store.getState().salesSettings.store_business_card_image=t,console.log("handle_bc <<")},t.GetCurrentState=function(e){return console.log("BCSettingsApp::GetCurrentState() >>"),0==e.localeCompare("bc")&&S.store.getState().salesSettings.store_business_card_image},t.SetCurrentState=function(e,t){console.log("EESettingsApp::SetCurrentState() >>"),0==e.localeCompare("bc")&&(S.store.getState().salesSettings.is_contextual_email_enabled=t),console.log("EESettingsApp::SetCurrentState() <<")},t.prototype.render=function(){var e=this,t=this.state.bcSettingStatus.isChanged;return g.default.createElement("div",{className:"menuRowDIVStyle"},g.default.createElement(E.ConnectedNavigationSettingsApp,{crmDataAccess:this.props.crmDataAccess,currentSelectedId:"business_card_scan",tabItems:this.props.tabItems}),g.default.createElement("div",{className:"ManagePageAppContainer"},g.default.createElement("div",null,C.SalesPremiumNotification(h.GlobalLocalizedStringsProvider.getStringProvider(),!1,new I.NotificationLogger)),g.default.createElement("div",{className:"SettingsApp"},g.default.createElement("div",{className:"pageHeader"},g.default.createElement("span",{ref:function(t){return e.pageHeader=t},className:"SettingsAppTitle",tabIndex:0,title:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_BusinessCard)},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_BusinessCard))),g.default.createElement("div",{className:"ManageDetailsListStyle DetailsListHeight"},g.default.createElement(u.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:d.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),g.default.createElement(u.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:20}},g.default.createElement(u.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}))))))},t.prototype._onSaveAction=function(){this.state.bcSettingStatus.isChanged&&(_.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.BusinessCardScan"),_.XrmHelper.SetBusinessCardOptions(this.state.bcSettingStatus.currentValue),this.state.bcSettingStatus.isChanged=!1,this.setState({bcSettingStatus:{isChanged:!1,currentValue:this.state.bcSettingStatus.currentValue}}))},t.prototype._onCancelAction=function(){v.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.IsSettingEnabled=function(e){return S.store.getState().salesSettings.is_pai_enabled},t.prototype._setCurrentValue=function(e,t){switch(e){case"bc":this.state.bcSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var i=e.key,r=t.GetCurrentState(i),s=t.IsSettingEnabled(i),o=e.description;return this._setCurrentValue(i,r),g.default.createElement("div",{className:"TableItems"},g.default.createElement("div",{className:"ManagePageDescription"},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Manage_Setting_BusCard_Title)),g.default.createElement("div",{className:"GroupItemDescTable"},g.default.createElement("span",{className:"GroupItemDescription"},o),s?g.default.createElement(u.Toggle,{className:"ToggleButton",id:i,inlineLabel:!0,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:r,onChange:e.onchangehandler}):g.default.createElement(u.Toggle,{className:"ToggleButton",id:i,inlineLabel:!0,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:r,onChange:e.onchangehandler,disabled:!0})))},t.prototype._onRenderRow=function(e){return g.default.createElement(u.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return g.default.createElement(u.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(g.default.Component);t.default=P;t.ConnectedBCSettingsApp=f.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:m.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(P)},287:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(95),d=n(2),u=n(56),g=n(53),p=n(44),S=l(n(0)),f=n(38),m=n(41),_=n(37);n(49);var h=n(54),b=n(46),v=n(285),y=n(458),C=n(31),I=n(32),E=n(48),P=n(42);f.initializeIcons();var w=function(e){function t(t){var n=e.call(this,t)||this;n._root=S.default.createRef(),n._items=[],n._groups=[],n._labelId=d.getId("dialogLabel"),n._subTextId=d.getId("subTextLabel"),n._dragOptions={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:c.ContextualMenu},n._onRenderGroupHeader=function(e){return S.default.createElement(u.GroupHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"},expand:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handle_enable_linkedin_updates=n.handle_enable_linkedin_updates.bind(n),n.handle_enable_sales_navigator_integration=n.handle_enable_sales_navigator_integration.bind(n),n.handle_photo_refresh=n.handle_photo_refresh.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.handle_photo_refresh=n.handle_photo_refresh.bind(n),n.state={hideDialog:!0,isDraggable:!1,salesNavigatorStatus:{isChanged:!1,currentValue:!1},profilePhotosStatus:{isChanged:!1,currentValue:!1},profileChangesStatus:{isChanged:!1,currentValue:!1}};var a="https://www.linkedin.com/help/sales-navigator/answer/83284";return n._items=[],n._items.push({key:"sales_nav_int",name:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_Title_LI_SalesNav),description:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_Label_LI_SalesNav),featurekey:"sales_nav_int",learnmorelink:"",onchangehandler:n.handle_enable_sales_navigator_integration}),n._items.push({key:"photo_refresh",name:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_Title_LI_ProfilePic),description:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_Label_LI_ProfilePicture),learnmorelink:a,featurekey:"photo_refresh",onchangehandler:n.handle_photo_refresh}),n._items.push({key:"enable_linkedin_updates",name:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_Title_LI_Changes),description:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_Label_LI_Changes),learnmorelink:a,featurekey:"enable_linkedin_updates",onchangehandler:n.handle_enable_linkedin_updates}),n._groups=[{key:"g1",name:"",startIndex:0,count:3}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,b.XrmHelper.LoadSalesSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({salesNavigatorStatus:{isChanged:!1,currentValue:m.store.getState().salesSettings.sales_linkedin_enable_feature},profileChangesStatus:{isChanged:!1,currentValue:m.store.getState().salesSettings.sales_enable_linkedin_updates},profilePhotosStatus:{isChanged:!1,currentValue:m.store.getState().salesSettings.sales_linkedin_profile_feature}}),this.pageHeader.focus(),(e=new Map).set("Page","linkedin_int"),e.set("Status","Loaded"),P.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",e),[2]}}))}))},t.prototype.handle_enable_sales_navigator_integration=function(e,t){console.log("handle_enable_sales_navigator_integration >>"),this.state.salesNavigatorStatus.isChanged=!this.state.salesNavigatorStatus.isChanged,this.state.salesNavigatorStatus.currentValue=t,this.setState({salesNavigatorStatus:{isChanged:this.state.salesNavigatorStatus.isChanged,currentValue:t}}),m.store.getState().salesSettings.sales_linkedin_enable_feature=t,console.log("handle_enable_sales_navigator_integration <<")},t.prototype.handle_photo_refresh=function(e,t){console.log("handle_photo_refresh >>"),this.state.profilePhotosStatus.isChanged=!this.state.profilePhotosStatus.isChanged,this.state.profilePhotosStatus.currentValue=t,this.setState({profilePhotosStatus:{isChanged:this.state.profilePhotosStatus.isChanged,currentValue:t}}),m.store.getState().salesSettings.sales_linkedin_profile_feature=t,console.log("handle_photo_refresh <<")},t.prototype.handle_enable_linkedin_updates=function(e,t){this.state.profileChangesStatus.isChanged=!this.state.profileChangesStatus.isChanged,this.state.profileChangesStatus.currentValue=t,this.setState({profileChangesStatus:{isChanged:this.state.profileChangesStatus.isChanged,currentValue:t}}),m.store.getState().salesSettings.sales_enable_linkedin_updates=t},t.AllowLIInstallation=function(){return b.XrmHelper.IsFCBEnabled("LinkedInIntegration")&&b.XrmHelper.IsSystemAdministrator()&&!b.XrmHelper.IsRestrictedEnvironment()?m.store.getState().salesSettings.is_linkedin_installed?(console.log("AllowLIInstallation 2"),!1):(console.log("AllowLIInstallation 3"),!0):(console.log("AllowLIInstallation 1"),!1)},t.IsSettingEnabled=function(e){return console.log("LinkedInIntSettingsApp.IsSettingEnabled >>"),console.log(b.XrmHelper.IsFCBEnabled("LinkedInIntegration")),console.log(b.XrmHelper.IsSystemAdministrator()),console.log(b.XrmHelper.IsRestrictedEnvironment()),console.log(m.store.getState().salesSettings.is_linkedin_installed),!(!b.XrmHelper.IsFCBEnabled("LinkedInIntegration")||!b.XrmHelper.IsSystemAdministrator()||b.XrmHelper.IsRestrictedEnvironment())&&(!!m.store.getState().salesSettings.is_linkedin_installed&&(0==e.localeCompare("sales_nav_int")||0==e.localeCompare("photo_refresh")||!(!b.XrmHelper.IsFCBEnabled("NoLongerInOrg")||0!=e.localeCompare("enable_linkedin_updates"))))},t.GetCurrentState=function(e){return console.log("LinkedInIntSettingsApp::GetCurrentState() >>"),0==e.localeCompare("sales_nav_int")?m.store.getState().salesSettings.sales_linkedin_enable_feature:0==e.localeCompare("photo_refresh")?m.store.getState().salesSettings.sales_linkedin_profile_feature:0==e.localeCompare("enable_linkedin_updates")&&m.store.getState().salesSettings.sales_enable_linkedin_updates},t.prototype._installLinkedIn=function(){var e=new Map;e.set("URL",b.XrmHelper.GetRISPAUrl()),P.logInfo("SalesAdminSettings","LinkedIn:EnableLinkedInButtonClicked",e),window.open(b.XrmHelper.GetRISPAUrl(),"_blank")},t.prototype._learnMoreLI=function(){window.open("https://go.microsoft.com/fwlink/p/?linkid=2119727","_blank")},t.prototype._launchMoreDetails=function(){window.open("https://go.microsoft.com/fwlink/?LinkId=521839","_blank")},t.prototype._launchMSPrivacyPolicy=function(){window.open("https://go.microsoft.com/fwlink/?LinkId=521839","_blank")},t.prototype.render=function(){var e=this;console.log("LinkedInIntSettings render >>");var n=this.state,a=(n.hideDialog,n.isDraggable,t.AllowLIInstallation(),this.state.salesNavigatorStatus.isChanged||this.state.profilePhotosStatus.isChanged||this.state.profileChangesStatus.isChanged);return S.default.createElement("div",{className:"LinkedInManagePageAppContainer"},S.default.createElement(p.MessageBar,{messageBarType:p.MessageBarType.warning,style:{fontSize:"14px",fontFamily:"Segoe UI"}},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.MessageBar_Text_LI)),S.default.createElement("div",{className:"SettingsApp"},S.default.createElement("div",{className:"pageHeader"},S.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0,title:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.GroupHeader_LinkedInManage)},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.GroupHeader_LinkedInManage)),S.default.createElement("br",null),S.default.createElement("div",{className:"SettingsAppDescription"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.GroupHeader_LinkedInManage_Sub),S.default.createElement(p.Link,{style:{whiteSpace:"nowrap"},href:"https://go.microsoft.com/fwlink/p/?linkid=2119727",target:"_blank"},"Â ",C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Learn_More))),S.default.createElement("br",null)),S.default.createElement(y.PrimaryButton,{text:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Btn_LinkedIn_Enable),disabled:!1,onClick:this._installLinkedIn}),S.default.createElement("div",{className:"ManageDetailsListStyle LinkedInDetailsListHeight"},S.default.createElement(p.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:g.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),S.default.createElement(p.Stack,{style:{paddingTop:"5px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},S.default.createElement(p.Link,{href:"https://go.microsoft.com/fwlink/?LinkId=521839",target:"_blank"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Policy))),S.default.createElement(p.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},S.default.createElement(y.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!a})))))},t.prototype._onSaveAction=function(){if(m.store.getState().salesSettings.sales_linkedin_configurationid.length<=0)Xrm.Navigation.openAlertDialog({text:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.LinkedIn_ConfigurationId_Missing)});else if(b.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.LinkedInSettings"),this.state.salesNavigatorStatus.isChanged&&(b.XrmHelper.SetProperty("sales_linkedin_configuration",m.store.getState().salesSettings.sales_linkedin_configurationid,"sales_linkedin_enable_feature",this.state.salesNavigatorStatus.currentValue),this.setState({salesNavigatorStatus:{isChanged:!1,currentValue:this.state.salesNavigatorStatus.currentValue}})),this.state.profilePhotosStatus.isChanged&&(v.LinkedInSettingsHelper.SendPhotoFetchMetadataUpdateBatchRequest(this.state.profilePhotosStatus.currentValue),this.setState({profilePhotosStatus:{isChanged:!1,currentValue:this.state.profilePhotosStatus.currentValue}})),this.state.profileChangesStatus.isChanged){if(this.state.profileChangesStatus.currentValue){(t=new Map).set("Setting","LinkedIn:ProfileChanges"),window.Xrm.Utility.showProgressIndicator("Processing");var e=v.LinkedInSettingsHelper.enableLinkedInUpdates();e.then((function(e){null!=e&&e.json().then((function(e){window.Xrm.Utility.closeProgressIndicator();null!=e.Result?(v.LinkedInSettingsHelper.FetchLinkedInUpdatesStatus(),t.set("LinkedIn:ProfileChanges Status","successful")):t.set("LinkedIn:ProfileChanges Status","failed")}))})),e.catch((function(e){console.log("enableLinkedInUpdates failed"),window.Xrm.Utility.closeProgressIndicator(),t.set("LinkedIn:ProfileChanges Status","failed"),t.set("Error",e)})),P.logInfo("SalesAdminSettings","SalesAdminSettings.LinkedInSettings",t)}else{var t;(t=new Map).set("Setting","LinkedIn:DisableLinkedUpdates");var n=v.LinkedInSettingsHelper.disableLinkedInUpdates();window.Xrm.Utility.showProgressIndicator("Processing"),n.then((function(e){null!=e&&e.json().then((function(e){window.Xrm.Utility.closeProgressIndicator(),null!=e.Result?t.set("disableLinkedInUpdatesstatus","successful"):t.set("disableLinkedInUpdatesstatus","failed")}))})),n.catch((function(e){window.Xrm.Utility.closeProgressIndicator(),t.set("disableLinkedInUpdatesstatus","failed"),t.set("Error",e)}))}this.setState({profileChangesStatus:{isChanged:!1,currentValue:this.state.profileChangesStatus.currentValue}})}},t.prototype._onCancelAction=function(){E.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"sales_nav_int":this.state.salesNavigatorStatus.currentValue=t;break;case"photo_refresh":this.state.profilePhotosStatus.currentValue=t;break;case"enable_linkedin_updates":this.state.profileChangesStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var i=e.key,r=t.GetCurrentState(i);this._setCurrentValue(i,r);var s=t.IsSettingEnabled(i),o=e.description,l="",c=C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_Label_LI_Condition);console.log(i),0==i.localeCompare("enable_linkedin_updates")&&(l=m.store.getState().salesSettings.sales_enable_linkedin_updates_status),console.log(o);e.description;return S.default.createElement("div",{className:"TableItems"},S.default.createElement("div",{className:"ManagePageDescription"},e.name),S.default.createElement("div",{className:"GroupItemDescTable"},S.default.createElement("span",{className:"GroupItemDescription"},o,""!==e.learnmorelink?S.default.createElement(S.default.Fragment,null,""!==l?S.default.createElement("pre",{style:{fontFamily:"Segoe UI"}},S.default.createElement("br",null),S.default.createElement("span",null,l)):"",S.default.createElement("pre",null,S.default.createElement("span",{style:{fontFamily:"Segoe UI"}},"("),S.default.createElement(p.Link,{style:{whiteSpace:"nowrap"},href:e.learnmorelink,target:"_blank"},S.default.createElement("span",null,"CRM "),S.default.createElement("span",{style:{fontStyle:"italic"}},"Sync")),S.default.createElement("span",{style:{fontFamily:"Segoe UI"}}," "+c+").")," ")):S.default.createElement("span",null)),s?S.default.createElement(p.Toggle,{className:"ToggleButton",id:i,onText:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Yes),offText:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_No),defaultChecked:r,onChange:e.onchangehandler}):S.default.createElement(p.Toggle,{className:"ToggleButton",id:i,onText:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Yes),offText:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_No),defaultChecked:r,disabled:!0,onChange:e.onchangehandler})))},t.prototype._onRenderRow=function(e){return S.default.createElement(p.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return S.default.createElement(p.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(S.default.Component);t.default=w;t.ConnectedLinkedInIntSettingsApp=_.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:h.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(w)},31:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(437),i=function(){function e(){}return e.UpdateCCFStringsProvider=function(e){this.ccfStringsProvider=e},e.GetString=function(e){return this.ccfStringsProvider?this.ccfStringsProvider.getLocalizedString(e):this.defaultProvider.getLocalizedString(e)},e.getStringProvider=function(){return this.ccfStringsProvider},e.defaultProvider=new a.DefaultLocalizedStringsProvider,e}();t.GlobalLocalizedStringsProvider=i},311:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateCrmClientUrlAndOrgId=function(e,t){return{type:"@@CrmOrgInfo/UpdateClientUrlAndOrgId",payload:{url:e,orgId:t}}},t.UpdateOrgFiscalCalenderStartDate=function(e){return{type:"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate",payload:{fiscalStartDate:e}}},t.TriggerFetchOrgFiscalCalenderStart=function(){return{type:"@@CrmOrgInfo/TriggerFetchOrgFiscalCalenderStartDate",payload:{}}}},32:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STRING_KEYS={SAS_OK:"SAS_OK",SAS_CANCEL:"SAS_CANCEL",SAS_CRM_PROCESSING_CALLS:"SAS_CRM_PROCESSING_CALLS",SAS_Overview:"SAS_Overview",Label_Learn_More:"Label_Learn_More",Label_Opportunity_AddProducts_View:"Label_Opportunity_AddProducts_View",Label_Quote_AddProducts_View:"Label_Quote_AddProducts_View",Label_Invoice_AddProducts_View:"Label_Invoice_AddProducts_View",Label_Order_AddProducts_View:"Label_Order_AddProducts_View",Label_Customize_Product_Lookup_View:"Label_Customize_Product_Lookup_View",Label_Line_Item:"Label_Line_Item",Label_Per_Unit:"Label_Per_Unit",Label_Save_And_Continue:"Label_Save_And_Continue",Label_Discard_Changes:"Label_Discard_Changes",Label_Manage:"Label_Manage",Label_Yes:"Label_Yes",Label_No:"Label_No",Label_Disabled:"Label_Disabled",Label_Disable_Preview:"Label_Disable_Preview",Label_Enabled:"Label_Enabled",Label_Save:"Label_Save",Label_Cancel:"Label_Cancel",Label_difference:"Label_difference",Label_Policy:"Label_Policy",Label_ToastMessage_Success:"Label_ToastMessage_Success",Label_ToastMessage_Failure:"Label_ToastMessage_Failure",Label_ToastMessage_Information:"Label_ToastMessage_Information",Label_Processing:"Label_Processing",MessageBar_Text_LI:"MessageBar_Text_LI",Label_LI_Status:"Label_LI_Status",Label_LI_Status_NextRefresh:"Label_LI_Status_NextRefresh",Label_LI_Status_LastRefresh:"Label_LI_Status_LastRefresh",Setting_Title_LinkedIn:"Setting_Title_LinkedIn",Setting_Title_TeamsCalls:"Setting_Title_TeamsCalls",Overview_Title:"Overview_Title",Overview_Desc:"Overview_Desc",GroupHeader_Lead_Opty:"GroupHeader_Lead_Opty",Setting_Title_QualifiedLeads:"Setting_Title_QualifiedLeads",Setting_Label_QualifiedLeads:"Setting_Label_QualifiedLeads",Setting_Title_CustomFields:"Setting_Title_CustomFields",Setting_Label_CustomFields:"Setting_Label_CustomFields",GroupHeader_Productivity_Tools:"GroupHeader_Productivity_Tools",Setting_Title_EnhancedEmail:"Setting_Title_EnhancedEmail",Setting_Label_EnhancedEmail:"Setting_Label_EnhancedEmail",Setting_Label_Info_EnhancedEmail:"Setting_Label_Info_EnhancedEmail",Setting_Title_BusinessCard:"Setting_Title_BusinessCard",Setting_Label_BusinessCard:"Setting_Label_BusinessCard",Setting_Label_BusinessCardManage:"Setting_Label_BusinessCardManage",Setting_Title_ConvertPDF:"Setting_Title_ConvertPDF",Setting_Label_ConvertPDF:"Setting_Label_ConvertPDF",Settings_Label_Column_EntityName:"Settings_Label_Column_EntityName",Setting_Label_FilterByEntityName:"Setting_Label_FilterByEntityName",Setting_Label_ShowOnlyEnabledEntitiesToggle:"Setting_Label_ShowOnlyEnabledEntitiesToggle",Setting_Label_SelectAllCheckbox:"Setting_Label_SelectAllCheckbox",Setting_Label_Checkbox:"Setting_Label_Checkbox",Setting_Label_SelectionColumn:"Setting_Label_SelectionColumn",Setting_Label_CheckButton:"Setting_Label_CheckButton",Setting_Label_SortAscending:"Setting_Label_SortAscending",Setting_Label_SortDescending:"Setting_Label_SortDescending",Setting_Label_ConvertPDFManage:"Setting_Label_ConvertPDFManage",GroupHeader_Chat_Collab:"GroupHeader_Chat_Collab",Setting_Title_TeamsInteg:"Setting_Title_TeamsInteg",Setting_Label_TeamsInteg:"Setting_Label_TeamsInteg",Setting_Label_TeamsIntegManage:"Setting_Label_TeamsIntegManage",GroupHeader_LinkedIn:"GroupHeader_LinkedIn",Setting_Label_LinkedIn:"Setting_Label_LinkedIn",Setting_Label_TeamsCalls:"Setting_Label_TeamsCalls",GroupHeader_TeamsCalls:"GroupHeader_TeamsCalls",Manage_Setting_BusCard_Title:"Manage_Setting_BusCard_Title",Manage_Setting_BusCard_Label:"Manage_Setting_BusCard_Label",Manage_Setting_TeamsInteg_Enhanced:"Manage_Setting_TeamsInteg_Enhanced",Manage_Btn_LinkedIn_Enable:"Manage_Btn_LinkedIn_Enable",Manage_Setting_Title_LI_SalesNav:"Manage_Setting_Title_LI_SalesNav",Manage_Setting_Label_LI_SalesNav:"Manage_Setting_Label_LI_SalesNav",Manage_Setting_Title_LI_ProfilePic:"Manage_Setting_Title_LI_ProfilePic",Manage_Setting_Label_LI_ProfilePic:"Manage_Setting_Label_LI_ProfilePic",Manage_Setting_Label_LI_Condition:"Manage_Setting_Label_LI_Condition",Manage_Setting_Title_LI_Changes:"Manage_Setting_Title_LI_Changes",Manage_Setting_Label_LI_Changes:"Manage_Setting_Label_LI_Changes",Manage_Setting_Label_LI_ProfilePicture:"Manage_Setting_Label_LI_ProfilePicture",GroupHeader_LinkedInManage:"GroupHeader_LinkedInManage",GroupHeader_LinkedInManage_Sub:"GroupHeader_LinkedInManage_Sub",Setting_Label_SopInteg:"Setting_Label_SopInteg",GroupHeader_SopInteg:"GroupHeader_SopInteg",SettingName_SopInteg:"SettingName_SopInteg",Setting_Title_SopInteg:"Setting_Title_SopInteg",SopInteg_TurnOff:"SopInteg_TurnOff",SopInteg_TurnOff_Note:"SopInteg_TurnOff_Note",LinkedIn_ConfigurationId_Missing:"LinkedIn_ConfigurationId_Missing",GroupHeader_Chat_Collab_Sub:"GroupHeader_Chat_Collab_Sub",MessageBar_Text_EmbedCollab:"MessageBar_Text_EmbedCollab",Setting_Title_EmbedCollabTeamsInteg:"Setting_Title_EmbedCollabTeamsInteg",Setting_Title_BasicTeamsInteg:"Setting_Title_BasicTeamsInteg",Setting_Label_EmbedCollabTeamsInteg:"Setting_Label_EmbedCollabTeamsInteg",Setting_Label_BasicTeamsInteg:"Setting_Label_BasicTeamsInteg",EmbedCollabTeamsInteg_EnableBasicSettingToViewChannelMessage:"EmbedCollabTeamsInteg_EnableBasicSettingToViewChannelMessage",EmbedCollabTeamsInteg_Consent_Denied:"EmbedCollabTeamsInteg_Consent_Denied",EmbedCollabTeamsInteg_Consent_Canceled:"EmbedCollabTeamsInteg_Consent_Canceled",EmbedCollabTeamsInteg_Consent_Error:"EmbedCollabTeamsInteg_Consent_Error",EmbedCollabTeamsInteg_SolutionIsMissingErrorMessage:"EmbedCollabTeamsInteg_SolutionIsMissingErrorMessage",EmbedCollabTeamsInteg_GenericErrorMessage:"EmbedCollabTeamsInteg_GenericErrorMessage",Setting_Title_ProductCatalog:"Setting_Title_ProductCatalog",Setting_Label_ProductCatalog:"Setting_Label_ProductCatalog",Setting_Title_AddProducts:"Setting_Title_AddProducts",Setting_Label_AddProducts:"Setting_Label_AddProducts",Setting_Label_Terms_And_Condition:"Setting_Label_Terms_And_Condition",AddProducts_TurnOff:"AddProducts_TurnOff",AddProducts_TurnOn:"AddProducts_TurnOn",AddProducts_Title_Customization_Options:"AddProducts_Title_Customization_Options",AddProducts_Label_Customization_Options:"AddProducts_Label_Customization_Options",AddProducts_Title_Customization_Columns:"AddProducts_Title_Customization_Columns",AddProducts_Label_Customization_Columns:"AddProducts_Label_Customization_Columns",AddProducts_Title_Product_Cell:"AddProducts_Title_Product_Cell",AddProducts_Label_Product_Cell:"AddProducts_Label_Product_Cell",Setting_Title_General_Settings:"Setting_Title_General_Settings",Setting_Label_General_Settings:"Setting_Label_General_Settings",GroupHeader_Product_ActiveState:"GroupHeader_Product_ActiveState",GroupLabel_Product_ActiveState:"GroupLabel_Product_ActiveState",GroupHeader_Default_PriceList:"GroupHeader_Default_PriceList",GroupLabel_Default_PriceList:"GroupLabel_Default_PriceList",GroupHeader_System_Price_Calculation:"GroupHeader_System_Price_Calculation",GroupLabel_System_Price_Calculation:"GroupLabel_System_Price_Calculation",GroupHeader_LineItem_Creation_Without_Associated_PriceList:"GroupHeader_LineItem_Creation_Without_Associated_PriceList",GroupLabel_LineItem_Creation_Without_Associated_PriceList:"GroupLabel_LineItem_Creation_Without_Associated_PriceList",GroupHeader_Max_Products_Number:"GroupHeader_Max_Products_Number",GroupLabel_Max_Products_Number:"GroupLabel_Max_Products_Number",GroupHeader_Max_Properties_Allowed:"GroupHeader_Max_Properties_Allowed",GroupLabel_Max_Properties_Allowed:"GroupLabel_Max_Properties_Allowed",GroupHeader_Discount_Calculation_Method:"GroupHeader_Discount_Calculation_Method",GroupLabel_Discount_Calculation_Method:"GroupLabel_Discount_Calculation_Method",Title_Disable_Dialog:"Title_Disable_Dialog",Text_Disable_Dialog:"Text_Disable_Dialog",Title_Unsaved_Changes:"Title_Unsaved_Changes",Text_Unsaved_Changes:"Text_Unsaved_Changes",Label_OpportunityClosing:"Label_OpportunityClosing",Label_LeadQualification:"Label_LeadQualification",RI_overview_ADC_title:"RI_overview_ADC_title",RI_overview_EE_title:"RI_overview_EE_title",RI_overview_ADC_description:"RI_overview_ADC_description",RI_overview_EE_description:"RI_overview_EE_description",Setting_Label_ADC:"Setting_Label_ADC",Setting_Label_EmailEngagement:"Setting_Label_EmailEngagement",Label_ADC:"Label_ADC",Label_EmailEngagement:"Label_EmailEngagement",AddProducts_LearnMore_AriaLabel:"AddProducts_LearnMore_AriaLabel",AddProducts_Terms_And_Conditions_AriaLabel:"AddProducts_Terms_And_Conditions_AriaLabel",ProductCatalog_LearnMore_AriaLabel:"ProductCatalog_LearnMore_AriaLabel",GeneralSettings_LearnMore_AriaLabel:"GeneralSettings_LearnMore_AriaLabel",AddProducts_Customization_Options_LearnMore_AriaLabel:"AddProducts_Customization_Options_LearnMore_AriaLabel",AdvancedTeamsInteg_Consent_Denied:"AdvancedTeamsInteg_Consent_Denied",SensitivityTeamsInteg_Consent_Denied:"SensitivityTeamsInteg_Consent_Denied",Manage_Setting_TeamsInteg_Sensitivity:"Manage_Setting_TeamsInteg_Sensitivity",Setting_Label_DefaultChatTitle:"Setting_Label_DefaultChatTitle",EmbedCollabTeamsInteg_ClosedByAnotherPopUp:"EmbedCollabTeamsInteg_ClosedByAnotherPopUp",Setting_Title_DefaultChatTitle:"Setting_Title_DefaultChatTitle",Setting_Title_AdvTeamsInteg:"Setting_Title_AdvTeamsInteg",Setting_Title_SensitivityTeamsInteg:"Setting_Title_SensitivityTeamsInteg"}},409:function(e,t,n){"use strict";var a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(412)),r=n(413);i.unregister();var s=(new r.SalesAdminBootManager).boot;t.salesAdminBoot=s},41:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(166),r=n(415),s=n(146),o=n(421);function l(e){var t=[],n=window.__REDUX_DEVTOOLS_EXTENSION__;n&&t.push(n());var a=[o.loggerMiddleware],s=i.compose.apply(void 0,[i.applyMiddleware.apply(void 0,a)].concat(t));return i.createStore(r.rootReducer,e,s)}t.default=l,t.store=l(s.initialAppState),t.resetStore=function(){t.store=l(a({},a({},s.initialAppState,{crmOrgInfo:a({},s.initialAppState.crmOrgInfo,{calenderStartDate:t.store.getState().crmOrgInfo.calenderStartDate})})))}},412:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function a(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}t.register=function(t){if("serviceWorker"in navigator){if(new URL(e.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var i=e.env.PUBLIC_URL+"/service-worker.js";n?(!function(e,t){fetch(e).then((function(n){var i=n.headers.get("content-type");404===n.status||null!=i&&-1===i.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):a(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(i,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):a(i,t)}))}},t.unregister=function(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}}).call(this,n(61))},413:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(41),r=n(422),s=a(n(0)),o=a(n(57)),l=a(n(428)),c=n(311),d=n(42),u=n(31),g=n(218),p=function(){function e(){}return e.prototype.boot=function(e,t,n,a,p,f,m){void 0===n&&(n=""),u.GlobalLocalizedStringsProvider.UpdateCCFStringsProvider(a),S(f),g.CCFContextProvider.setCCFProvider(m);var _=new r.SalesAdminActions(i.store.dispatch,i.store.getState);return i.store.dispatch(c.UpdateCrmClientUrlAndOrgId(t,n)),i.store.getState().viewId=p.viewid,i.store.getState().isManage=p.ismanage,i.store.getState(),o.default.render(s.default.createElement(l.default,null),e),d.logInfo("SalesAdminSettings.BootManager","Boot Completed",{}),_},e}();function S(e){d.addLogger(e)}t.SalesAdminBootManager=p,t.InitLoggers=S},415:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(166),i=n(416),r=n(418),s=n(419),o=n(420);t.rootReducer=a.combineReducers({mainPageType:i.mainPageTypeReducer,crmOrgInfo:r.crmOrgInfoReducer,viewId:s.viewIdReducer,isManage:s.viewIdReducer,salesSettings:o.salesSettingsReducer})},416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(146);t.mainPageTypeReducer=function(e,t){switch(void 0===e&&(e=a.initialAppState.mainPageType),t.type){case"@@mainPage/ChangeType":return t.payload.newType;default:return e}return e}},417:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetDefaultSalesSettings=function(){return{qualify_lead_experience:!1,is_quick_create_enabled_for_opportunity_close:!1,customize_close_opportunity_form:!1,is_contextual_email_enabled:!1,is_pai_enabled:!1,store_business_card_image:!1,pdf_settings:new Map,pdf_entities:new Map,pdf_entityDisplayNames:new Map,is_msteams_basic_enabled:!1,is_msteams_advanced_enabled:!1,is_msteams_embedcollab_enabled:!1,is_msteams_sensitivityCollab_enabled:!1,is_default_chat_title_record_name:!1,is_linkedin_installed:!1,is_sopintegration_enabled:!1,sales_linkedin_configurationid:"",sales_linkedin_enable_feature:!1,sales_linkedin_profile_feature:!1,sales_enable_linkedin_updates:!1,sales_enable_linkedin_updates_status:"",sales_linkedin_updates_status:"",is_tenant_admin:!1,is_system_admin:!1,entityList:[]}}},418:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(146);t.crmOrgInfoReducer=function(e,t){switch(void 0===e&&(e=i.initialAppState.crmOrgInfo),t.type){case"@@CrmOrgInfo/UpdateClientUrlAndOrgId":return a({},e,{clientUrl:t.payload.url,orgId:t.payload.orgId});case"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate":return a({},e,{calenderStartDate:t.payload.fiscalStartDate});default:return e}return e}},419:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.viewIdReducer=function(e,t){return void 0===e&&(e=""),e}},42:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(447),i=[];function r(e,t,n,a){void 0===a&&(a={}),i.map((function(i){i.logLevel<=e&&i.logCategory(e,t,n,a)}))}t.logInfo=function(e,t,n){void 0===n&&(n={}),r(a.ILogLevel.Info,e,t,n)},t.logError=function(e,t,n,a){void 0===a&&(a={}),i.map((function(i){i.logError(e,t,n,a)}))},t.logWarning=function(e,t,n){void 0===n&&(n={}),r(a.ILogLevel.Warning,e,t,n)},t.logUsage=function(e,t,n){void 0===n&&(n={}),r(a.ILogLevel.Usage,e,t,n)},t.addLogger=function(e){i.length<=0&&i.push(e)}},420:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(146);t.salesSettingsReducer=function(e,t){return void 0===e&&(e=a.initialAppState.salesSettings),e}},421:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.loggerMiddleware=function(e){return function(e){return function(t){!function(e){var t={};e.type,null!=e.payload&&(t=a({},e.payload))}(t);return e(t)}}}},422:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(41),i=n(258),r=function(){function e(e,t){void 0===t&&(t=void 0),this.dispatch=e,this.getState=t,this.navigationHandlers=new i.ReduxNavigationHandler(e)}return e.prototype.showPage=function(e,t){a.store.getState().viewId=e,a.store.getState().isManage=t,this.navigationHandlers.OpenPage(e)},e}();t.SalesAdminActions=r},423:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeMainPageType=function(e){return{type:"@@mainPage/ChangeType",payload:{newType:e}}}},428:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(0));n(429);var r=n(41),s=n(37),o=n(435),l=n(533),c={};t.default=function(){var e=r.store.getState().crmOrgInfo.clientUrl,t=r.store.getState().crmOrgInfo.orgId;null==c[e]&&(c[e]=l.createCrmDataAccessFromCrmUrl(e,t));var n=c[e];return l.setCrmDataAccessInstsance(n),i.default.createElement("div",{className:"SAConfigApp"},i.default.createElement(s.Provider,{store:r.store},i.default.createElement(o.ConnectedMainAppContainer,{crmDataAccess:n})))}},429:function(e,t,n){var a=n(430);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(210)(a,i);a.locals&&(e.exports=a.locals)},430:function(e,t,n){(e.exports=n(209)(!1)).push([e.i,".SAConfigApp {\n  /* padding: 20px; */\n  background-color: white;\n  color: #323130 !important; }\n",""])},435:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(0)),o=n(38),l=n(37),c=n(41),d=n(208),u=n(436),g=n(438),p=n(455),S=n(524),f=n(525),m=n(526),_=n(286),h=n(527),b=n(287),v=n(528),y=n(529),C=n(530),I=n(311),E=n(46),P=n(531),w=n(532),L=n(31),T=n(32);o.initializeIcons();var G=function(e){function t(t){var n=e.call(this,t)||this;n._tabitems=[],n.pdfViewId=null,n.isEnabledFCBForADC=!1,n.isEnabledFCBForEmailEngagement=!1,n._leadOppManagementtabitems=[],E.XrmHelper.LoadSalesSettings(),n.state={},n.pdfViewId="pdf_generation";try{E.XrmHelper.IsFCBEnabled("October2020Update")&&E.XrmHelper.IsFCBEnabled("EnhancedPDFAdminSettings")&&(n.pdfViewId="enhance_pdf_generation")}catch(e){n.pdfViewId="pdf_generation"}return E.XrmHelper.IsFCBEnabled("AutoDataCapture")&&(n.isEnabledFCBForADC=!0),E.XrmHelper.IsFCBEnabled("EmailEngagementFCB")&&(n.isEnabledFCBForEmailEngagement=!0),n._tabitems.push({key:"enhanced_email",localizedString:L.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.Setting_Title_EnhancedEmail)},{key:"business_card_scan",localizedString:L.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.Setting_Title_BusinessCard)},{key:n.pdfViewId,localizedString:L.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.Setting_Title_ConvertPDF)}),n._leadOppManagementtabitems=[{key:"l_and_m",localizedString:L.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.Label_LeadQualification)},{key:"opp_custom_fields",localizedString:L.GlobalLocalizedStringsProvider.GetString(T.STRING_KEYS.Label_OpportunityClosing)}],n}return i(t,e),t.prototype.componentDidMount=function(){this.props.triggerFetchOrgSettings()},t.prototype.render=function(){var e=void 0;return console.log("mainAppContainer::render() >>"),console.log(c.store.getState().viewId),e="product_catalog"==c.store.getState().viewId?s.default.createElement(g.ConnectedProductCatalogSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"l_and_m"==c.store.getState().viewId?s.default.createElement(v.ConnectedLandMSettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._leadOppManagementtabitems}):"opp_custom_fields"==c.store.getState().viewId?s.default.createElement(y.ConnectedOppCustomFieldsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._leadOppManagementtabitems}):"pdf_generation"==c.store.getState().viewId?s.default.createElement(S.ConnectedPDFSettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._tabitems}):"enhance_pdf_generation"==c.store.getState().viewId?s.default.createElement(f.ConnectedEnhancePDFSettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._tabitems}):"enhanced_email"==c.store.getState().viewId?s.default.createElement(m.ConnectedEESettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._tabitems}):"adc"==c.store.getState().viewId?s.default.createElement(w.ConnectedADCSettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._tabitems}):"email_engagement"==c.store.getState().viewId?s.default.createElement(P.ConnectedEmailEngagementSettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._tabitems}):"business_card_scan"==c.store.getState().viewId?s.default.createElement(_.ConnectedBCSettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._tabitems}):"teams_int"==c.store.getState().viewId?s.default.createElement(h.ConnectedTeamsIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"linkedin_int"==c.store.getState().viewId?s.default.createElement(b.ConnectedLinkedInIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"teams_calls_int"==c.store.getState().viewId?s.default.createElement(u.ConnectedTeamsCallsSettingsApp,null):"sop_int"==c.store.getState().viewId?s.default.createElement(C.ConnectedSopIntegrationApp,{crmDataAccess:this.props.crmDataAccess}):"pt"==c.store.getState().isManage?s.default.createElement(m.ConnectedEESettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._tabitems}):"lno"==c.store.getState().isManage?s.default.createElement(v.ConnectedLandMSettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._leadOppManagementtabitems}):"li"==c.store.getState().isManage?s.default.createElement(b.ConnectedLinkedInIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"tc"==c.store.getState().isManage?s.default.createElement(h.ConnectedTeamsIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"cnc"==c.store.getState().isManage?s.default.createElement(h.ConnectedTeamsIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}):s.default.createElement(p.ConnectedOverviewApp,{crmDataAccess:this.props.crmDataAccess}),s.default.createElement("div",{className:"MainAppContainer"},e)},t}(s.default.Component);t.default=G;t.ConnectedMainAppContainer=l.connect((function(e){return{isSettingPageOpened:e.mainPageType==d.IMainPageType.SettingPage}}),(function(e){return{triggerFetchOrgSettings:function(){e(I.TriggerFetchOrgFiscalCalenderStart())}}}))(G)},436:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(0)),c=n(37),d=n(31),u=n(32),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.componentDidMount=function(){return r(this,void 0,void 0,(function(){return s(this,(function(e){return this._navigateToTeamsCallsSettingsControl(),[2]}))}))},t.prototype.render=function(){return l.default.createElement("div",null)},t.prototype._navigateToTeamsCallsSettingsControl=function(){window.Xrm.Utility.showProgressIndicator(d.GlobalLocalizedStringsProvider.GetString(u.STRING_KEYS.Label_Processing)),window.Xrm.Navigation.navigateTo({pageType:"control",controlName:"MscrmControls.TeamsDialerSettings.DialerSettingsHostControl"},{target:1}).then((function(){window.Xrm.Utility.closeProgressIndicator()}),(function(){window.Xrm.Utility.closeProgressIndicator()}))},t}(l.default.Component);t.default=g,t.ConnectedTeamsCallsSettingsApp=c.connect()(g)},437:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(32),i=function(){function e(){var e;this.stringDict=((e={})[a.STRING_KEYS.SAS_OK]="OK",e[a.STRING_KEYS.SAS_CANCEL]="Cancel",e[a.STRING_KEYS.SAS_CRM_PROCESSING_CALLS]="Loading...",e)}return e.prototype.getLocalizedString=function(e){return this.stringDict[e]},e}();t.DefaultLocalizedStringsProvider=i},438:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(44),c=n(44),d=n(22),u=o(n(0));n(439);var g=n(37),p=n(48);n(49);var S,f=n(31),m=n(32),_=n(46),h=n(42),b=n(239),v=n(454);!function(e){e[e.Text=1]="Text",e[e.Boolean=2]="Boolean",e[e.Radio=3]="Radio"}(S||(S={}));var y=function(e){function t(t){var n=e.call(this,t)||this;return n.propNames=[],n._root=u.default.createRef(),n.discountCalculationMethodRadioOptions=[],n.toggleHideAddProductDisableConfirmationDialog=n.toggleHideAddProductDisableConfirmationDialog.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n._onCancelAction=n._onCancelAction.bind(n),n.disableAddProductsPreview=n.disableAddProductsPreview.bind(n),n.isAnythingChanged=n.isAnythingChanged.bind(n),n.allIsChangedFalse=n.allIsChangedFalse.bind(n),n.renderFeatureControl=n.renderFeatureControl.bind(n),n.renderConfimDisableAddProductsPreviewDialog=n.renderConfimDisableAddProductsPreviewDialog.bind(n),n.onFeatureChange=n.onFeatureChange.bind(n),n.renderAddProductsControl=n.renderAddProductsControl.bind(n),n.onAddProductsFeatureChange=n.onAddProductsFeatureChange.bind(n),n.getFeatureValue=n.getFeatureValue.bind(n),n.getFeatureIsChangedValue=n.getFeatureIsChangedValue.bind(n),n.renderPriceOptionalControl=n.renderPriceOptionalControl.bind(n),n.renderAddProductsGroupItem=n.renderAddProductsGroupItem.bind(n),n.renderAddProductsView=n.renderAddProductsView.bind(n),n.renderAddProductsGroup=n.renderAddProductsGroup.bind(n),n.renderAddProductsAdditional=n.renderAddProductsAdditional.bind(n),n.renderGeneralSettingsGroup=n.renderGeneralSettingsGroup.bind(n),n.getTextAndLearnMoreLabel=n.getTextAndLearnMoreLabel.bind(n),n.renderLookupView=n.renderLookupView.bind(n),n.getMakerBaseUrls=n.getMakerBaseUrls.bind(n),n.renderChoiceGroup=n.renderChoiceGroup.bind(n),n.state={stateValues:new Map([[v.Constants.isNewAddProductExperienceEnabled,{isChanged:!1,currentValue:!1}],[v.Constants.createProductsWithoutParentInActiveState,{isChanged:!1,currentValue:!1}],[v.Constants.useInbuiltRulefOrDefaultPricelistSelection,{isChanged:!1,currentValue:!1}],[v.Constants.oobPriceCalculationEnabled,{isChanged:!1,currentValue:!1}],[v.Constants.isPricelistMandatory,{isChanged:!1,currentValue:!1}],[v.Constants.maxProductsInBundle,{isChanged:!1,currentValue:v.Constants.DEFAULT_MAX_PRODUCTS_IN_BUNDLE}],[v.Constants.maximumDynamicPropertiesAllowed,{isChanged:!1,currentValue:v.Constants.DEFAULT_MAX_PROPERTIES_ALLOWED}],[v.Constants.discountCalculationMethod,{isChanged:!1,currentValue:v.Constants.DEFAULT_DISCOUNT_CALCULATION_METHOD}]]),hideAddProductDisableConfirmationDialog:!0},n.discountCalculationMethodRadioOptions.push({key:0,title:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Line_Item)}),n.discountCalculationMethodRadioOptions.push({key:1,title:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Per_Unit)}),n.propNames.push(v.Constants.isNewAddProductExperienceEnabled),n.propNames.push(v.Constants.isPricelistMandatory),n.propNames.push(v.Constants.createProductsWithoutParentInActiveState),n.propNames.push(v.Constants.oobPriceCalculationEnabled),n.propNames.push(v.Constants.useInbuiltRulefOrDefaultPricelistSelection),n.propNames.push(v.Constants.maxProductsInBundle),n.propNames.push(v.Constants.maximumDynamicPropertiesAllowed),n.propNames.push(v.Constants.discountCalculationMethod),n}return i(t,e),t.prototype.componentDidMount=function(){return r(this,void 0,void 0,(function(){var e,t,n;return s(this,(function(a){switch(a.label){case 0:window.Xrm.Utility.showProgressIndicator(f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Processing)),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,_.XrmHelper.LoadSalesSettings()];case 2:return a.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return a.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return e=this,[4,_.XrmHelper.GetEnvironmentDetails()];case 5:return e.environmentDetails=a.sent(),[4,_.XrmHelper.GetOrganizationProperties(this.propNames)];case 6:return t=a.sent(),this.setState({stateValues:new Map([[v.Constants.isNewAddProductExperienceEnabled,{isChanged:!1,currentValue:t.isnewaddproductexperienceenabled}],[v.Constants.createProductsWithoutParentInActiveState,{isChanged:!1,currentValue:t.createproductswithoutparentinactivestate}],[v.Constants.useInbuiltRulefOrDefaultPricelistSelection,{isChanged:!1,currentValue:t.useinbuiltrulefordefaultpricelistselection}],[v.Constants.oobPriceCalculationEnabled,{isChanged:!1,currentValue:t.oobpricecalculationenabled}],[v.Constants.isPricelistMandatory,{isChanged:!1,currentValue:t.ispricelistmandatory}],[v.Constants.maxProductsInBundle,{isChanged:!1,currentValue:t.maxproductsinbundle}],[v.Constants.maximumDynamicPropertiesAllowed,{isChanged:!1,currentValue:t.maximumdynamicpropertiesallowed}],[v.Constants.discountCalculationMethod,{isChanged:!1,currentValue:t.discountcalculationmethod}]]),hideAddProductDisableConfirmationDialog:!0}),this.pageHeader.focus(),_.XrmHelper.parseStateMapAndLog(this.state.stateValues,"SalesAdminSettings.ProductCatalogSettings"),(n=new Map).set("Page","product_catalog"),n.set("Status","Loaded"),h.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",n),[2]}}))}))},t.prototype.renderFeatureControl=function(e,t,n,a,i){var r=this;return a==S.Text?u.default.createElement(u.default.Fragment,null,u.default.createElement("div",null,u.default.createElement("label",{htmlFor:e},t)),u.default.createElement("div",null,u.default.createElement("label",{htmlFor:e,style:{marginTop:"4px",fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"16px",color:"#605E5C"}},n)),u.default.createElement("label",null,u.default.createElement("input",{id:e,className:"pcs-inputTextField",value:this.getFeatureValue(e),onChange:function(t){return r.onFeatureChange(e,t.target.value.replace(/\D/,""),S.Text)}}))):a==S.Boolean?u.default.createElement(u.default.Fragment,null,u.default.createElement("span",null,u.default.createElement(c.Toggle,{className:"ToggleButton",id:e,inlineLabel:!0,onText:t,offText:t,checked:this.getFeatureValue(e),onChange:function(t){return r.onFeatureChange(e,!r.getFeatureValue(e),S.Boolean)}})),u.default.createElement("div",{style:{marginTop:"12px",color:"#605E5C",fontSize:"12px"}},n)):a==S.Radio&&i&&i.length>0?u.default.createElement(u.default.Fragment,null,u.default.createElement("label",{id:e+"_radioGrouping"},u.default.createElement("span",null,t),u.default.createElement("div",{style:{marginTop:"4px",fontFamily:"Segoe UI",fontSize:"12px",lineHeight:"16px",color:"#605E5C"}},n)),u.default.createElement("div",{style:{marginTop:"12px"}},this.renderChoiceGroup(e,i))):u.default.createElement(u.default.Fragment,null)},t.prototype.renderChoiceGroup=function(e,t){var n=this,a=[];t.forEach((function(e){null!==e.key&&void 0!==e.key&&a.push({key:e.key.toString(),text:e.title})}));var i=void 0;return null!==this.getFeatureValue(e)&&void 0!==this.getFeatureValue(e)&&(i=this.getFeatureValue(e).toString()),u.default.createElement(c.ChoiceGroup,{selectedKey:i,options:a,onChange:function(t,a){a&&n.onFeatureChange(e,a.key,S.Boolean)},ariaLabelledBy:e+"_radioGrouping"})},t.prototype.renderPriceOptionalControl=function(e,t,n){var a=this;return u.default.createElement(c.Toggle,{className:"ToggleButton",id:e,inlineLabel:!0,onText:t,offText:t,checked:!this.getFeatureValue(e),onChange:function(t){return a.onFeatureChange(e,!a.getFeatureValue(e),S.Boolean)}})},t.prototype.onFeatureChange=function(e,t,n){var a=new Map(this.state.stateValues);if(n==S.Boolean||n==S.Radio){var i=!this.getFeatureIsChangedValue(e);a.set(e,{isChanged:i,currentValue:t})}else a.set(e,{isChanged:!0,currentValue:t});this.setState({stateValues:a})},t.prototype.getFeatureValue=function(e){var t=this.state.stateValues.get(e);if(null!=t)return t.currentValue},t.prototype.getFeatureIsChangedValue=function(e){var t=this.state.stateValues.get(e);if(null!=t)return t.isChanged},t.prototype.isAnythingChanged=function(){var e=!1;return this.state.stateValues.forEach((function(t,n){t.isChanged&&(e=!0)})),e},t.prototype.allIsChangedFalse=function(){var e=new Map(this.state.stateValues);this.state.stateValues.forEach((function(t,n){e.set(n,{isChanged:!1,currentValue:t.currentValue})})),this.setState({stateValues:e})},t.prototype.toggleHideAddProductDisableConfirmationDialog=function(){this.setState({hideAddProductDisableConfirmationDialog:!this.state.hideAddProductDisableConfirmationDialog})},t.prototype.getMakerBaseUrls=function(){switch(this.environmentDetails.Geo){case"TIP":return v.Constants.PowerAppsShellTestUrl;case"GCC":return v.Constants.PowerAppsShellGCCModUrl;case"USG":return v.Constants.PowerAppsShellGCCHighUrl;default:return v.Constants.PowerAppsShellProdUrl}},t.prototype.utilityViewUrl=function(e,t,n){var a=Xrm.Utility.getGlobalContext().getClientUrl();return n?a+e:this.getMakerBaseUrls()+this.environmentDetails.EnvironmentId+t},t.prototype.onAddProductsFeatureChange=function(e,t){if(t){var n=new Map(this.state.stateValues),a=!this.getFeatureIsChangedValue(e);n.set(e,{isChanged:a,currentValue:t}),this.setState({stateValues:n})}else this.toggleHideAddProductDisableConfirmationDialog()},t.prototype.renderAddProductsControl=function(e,t,n){var a=this;return u.default.createElement(c.Toggle,{className:"ToggleButton",id:n,inlineLabel:!0,onText:e,offText:t,checked:this.getFeatureValue(n),onChange:function(e){return a.onAddProductsFeatureChange(n,!a.getFeatureValue(n))}})},t.prototype.renderAddProductsGroup=function(){var e=this.getTextAndLearnMoreLabel(f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_Label_Customization_Options));return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"pcs-AddProductsHeader",style:{marginTop:"24px",marginBottom:"8px"},role:"heading","aria-level":3},u.default.createElement("span",null,u.default.createElement(l.FontIcon,{style:{color:"#000000"},iconName:"Settings"}),"Â "),f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_Title_Customization_Options)),u.default.createElement("div",{className:"pcs-AddProductsGroupItemDescription"},u.default.createElement(l.Link,{style:{color:"#2266E3",textDecoration:"underline"},"aria-label":f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_Customization_Options_LearnMore_AriaLabel),target:"_blank",href:v.Constants.customizationsOptionsLearnMore},e.learnMoreText),e.normalText),u.default.createElement("div",{className:"pcs-AddProductsHeader",style:{marginTop:"32px"},role:"heading","aria-level":3},f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_Title_Customization_Columns)),u.default.createElement("span",{className:"pcs-AddProductsGroupItemDescription"},f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_Label_Customization_Columns)))},t.prototype.renderAddProductsGroupItem=function(e,t,n){var a=this.getTextAndLearnMoreLabel(e);return u.default.createElement("div",{className:"GroupItemDescTable"},u.default.createElement("span",{className:"GroupItemDescription",style:{marginTop:"6px"}},a.normalText,u.default.createElement(l.Link,{style:{color:"#2266E3",textDecoration:"underline"},"aria-label":n,target:"_blank",href:t},a.learnMoreText)))},t.prototype.getTextAndLearnMoreLabel=function(e){var t=(e=e.replace("{0}","@").replace("{1}","#")).substring(e.lastIndexOf("@")+1,e.lastIndexOf("#")),n=e.substring(0,e.lastIndexOf("@")),a=e.substring(e.lastIndexOf("#")+1,e.length);return{normalText:n.concat(a.toString()),learnMoreText:t}},t.prototype.renderGeneralSettingsGroup=function(){var e=this.getTextAndLearnMoreLabel(f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_General_Settings));return u.default.createElement("div",{style:{flex:"1"}},u.default.createElement("div",{className:"GroupItemName",role:"heading","aria-level":2,style:{fontSize:"16px"}},f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_General_Settings)),u.default.createElement("div",{className:"GroupItemDescription"},e.normalText,u.default.createElement(l.Link,{style:{color:"#2266E3",textDecoration:"underline"},"aria-label":f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GeneralSettings_LearnMore_AriaLabel),target:"_blank",href:v.Constants.generalSettingsLearnMore},e.learnMoreText)),u.default.createElement("div",{className:"pcs-GeneralSettingsFirstGroupItem"},this.renderFeatureControl(v.Constants.createProductsWithoutParentInActiveState,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_Product_ActiveState),f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupLabel_Product_ActiveState),S.Boolean)),u.default.createElement("div",{className:"pcs-GeneralSettingsGroupItem"},this.renderFeatureControl(v.Constants.useInbuiltRulefOrDefaultPricelistSelection,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_Default_PriceList),f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupLabel_Default_PriceList),S.Boolean)),u.default.createElement("div",{className:"pcs-GeneralSettingsGroupItem"},this.renderFeatureControl(v.Constants.oobPriceCalculationEnabled,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_System_Price_Calculation),f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupLabel_System_Price_Calculation),S.Boolean)),u.default.createElement("div",{className:"pcs-GeneralSettingsGroupItem"},u.default.createElement("span",null,this.renderPriceOptionalControl(v.Constants.isPricelistMandatory,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_LineItem_Creation_Without_Associated_PriceList),S.Boolean)),u.default.createElement("span",{style:{marginTop:"12px",color:"#605E5C",fontSize:"12px"}},f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupLabel_LineItem_Creation_Without_Associated_PriceList))),u.default.createElement("div",{className:"pcs-TextField"},this.renderFeatureControl(v.Constants.maxProductsInBundle,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_Max_Products_Number),f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupLabel_Max_Products_Number),S.Text)),u.default.createElement("div",{className:"pcs-TextField"},this.renderFeatureControl(v.Constants.maximumDynamicPropertiesAllowed,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_Max_Properties_Allowed),f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupLabel_Max_Properties_Allowed),S.Text)),u.default.createElement("div",{className:"pcs-RadioField"},this.renderFeatureControl(v.Constants.discountCalculationMethod,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_Discount_Calculation_Method),f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupLabel_Discount_Calculation_Method),S.Radio,this.discountCalculationMethodRadioOptions)),u.default.createElement("div",null,this.renderConfimDisableAddProductsPreviewDialog()))},t.prototype.renderAddProductsAdditional=function(){var e=Xrm.Utility.getGlobalContext(),t=this.utilityViewUrl(v.Constants.opportunityAddProductsViewEndPartUrlLegacy,v.Constants.opportunityAddProductsViewEndPartUrlModernDesigner,e.isOnPremises()),n=this.utilityViewUrl(v.Constants.orderAddProductsViewEndPartUrlLegacy,v.Constants.orderAddProductsViewEndPartUrlModernDesigner,e.isOnPremises()),a=this.utilityViewUrl(v.Constants.quoteAddProductsViewEndPartUrlLegacy,v.Constants.quoteAddProductsViewEndPartUrlModernDesigner,e.isOnPremises()),i=this.utilityViewUrl(v.Constants.invoiceAddProductsViewEndPartUrlLegacy,v.Constants.invoiceAddProductsViewEndPartUrlModernDesigner,e.isOnPremises()),r=this.utilityViewUrl(v.Constants.productLookupViewEndPartUrlLegacy,v.Constants.productLookupViewEndPartUrlModernDesigner,e.isOnPremises());return u.default.createElement(u.default.Fragment,null,this.renderAddProductsGroup(),this.renderAddProductsView(t,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Opportunity_AddProducts_View)),this.renderAddProductsView(a,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Quote_AddProducts_View)),this.renderAddProductsView(n,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Order_AddProducts_View)),this.renderAddProductsView(i,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Invoice_AddProducts_View)),u.default.createElement("div",{className:"pcs-AddProductsHeader",style:{marginTop:"24px"},role:"heading","aria-level":3},f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_Title_Product_Cell)),u.default.createElement("div",{style:{marginTop:"4px",display:"block",width:"calc(50vw)",color:"#323130",maxWidth:"625px"}},f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_Label_Product_Cell)),this.renderLookupView(r,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Customize_Product_Lookup_View)))},t.prototype.renderConfimDisableAddProductsPreviewDialog=function(){var e={type:b.DialogType.normal,title:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Title_Disable_Dialog),closeButtonAriaLabel:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Cancel),subText:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Text_Disable_Dialog),subTextId:"pcs-subTextId"},t=this.state.hideAddProductDisableConfirmationDialog;return u.default.createElement(b.Dialog,{hidden:t,styles:{main:{display:"flex",flexDirection:"column",alignItems:"flex-start",position:"relative",marginTop:"50px",marginLeft:"50px",maxWidth:"420px !important"}},onDismiss:this.toggleHideAddProductDisableConfirmationDialog,dialogContentProps:e},u.default.createElement(b.DialogFooter,null,u.default.createElement(d.PrimaryButton,{style:{backgroundColor:"#2266E3",border:"none"},onClick:this.disableAddProductsPreview,text:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Disable_Preview)}),u.default.createElement(c.DefaultButton,{onClick:this.toggleHideAddProductDisableConfirmationDialog,text:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Cancel)})))},t.prototype.renderLookupView=function(e,t){var n=t.substr(0,t.indexOf(" ")),a=t.substr(t.indexOf(" "));return u.default.createElement("div",{style:{marginTop:"8px",marginBottom:"32px"}},u.default.createElement(l.Link,{style:{color:"#2266E3",textDecoration:"underline"},target:"_blank",href:e},n,u.default.createElement("span",{className:"pcs-ViewCustomization"},a)))},t.prototype.renderAddProductsView=function(e,t){var n=t.substr(0,t.indexOf(" ")),a=t.substr(t.indexOf(" "));return u.default.createElement("div",{style:{marginTop:"8px"}},u.default.createElement(l.Link,{style:{color:"#2266E3",textDecoration:"underline"},target:"_blank",href:e},u.default.createElement("span",{className:"pcs-ViewCustomization"},n),a))},t.prototype.render=function(){var e=this,t=this.getTextAndLearnMoreLabel(f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_ProductCatalog)),n=1==this.getFeatureValue(v.Constants.isNewAddProductExperienceEnabled)?"pcs-pageGroupWithBorder":"pcs-pageGroupWithoutBorder",a=1==this.isAnythingChanged()?"pcs-CancelButton":"pcs-SaveButton";return u.default.createElement("div",{className:"pcs-ProductSettingsAppContainer",style:{height:"calc(100vh - 144px)"}},u.default.createElement("div",null,u.default.createElement("div",{className:"pageHeader"},u.default.createElement("div",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},title:"Product Catalog Settings",role:"heading","aria-level":1},f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_ProductCatalog)),u.default.createElement("div",{style:{fontSize:"14px",color:"#201F1E"}},t.normalText,u.default.createElement(l.Link,{style:{color:"#2266E3",textDecoration:"underline"},"aria-label":f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.ProductCatalog_LearnMore_AriaLabel),target:"_blank",href:v.Constants.productCatalogSettingsLearnMore},t.learnMoreText))),u.default.createElement("div",null,u.default.createElement(c.Stack,{className:"pcs-pageGroup1",style:{borderBottom:"1px solid #EDEBE9"}},u.default.createElement("div",{className:n},u.default.createElement("div",{style:{maxWidth:"525px"}},u.default.createElement("div",{className:"GroupItemName",role:"heading","aria-level":2,style:{fontSize:"16px",color:"#201F1E"}},f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_AddProducts)),this.renderAddProductsGroupItem(f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_AddProducts),v.Constants.addProductsPreviewLearnMore,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_LearnMore_AriaLabel)),this.renderAddProductsGroupItem(f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_Terms_And_Condition),v.Constants.termsAndConditionsUrl,f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_Terms_And_Conditions_AriaLabel)),u.default.createElement("div",{style:{marginTop:"24px",paddingBottom:"5px"}},this.renderAddProductsControl(f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_TurnOn),f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.AddProducts_TurnOff),v.Constants.isNewAddProductExperienceEnabled))),u.default.createElement("div",{className:"pcs-illustration",style:{height:"172px"}},u.default.createElement("img",{role:"none",src:v.Constants.addProductsIllustration,height:"172px",width:"312px"}))),u.default.createElement("div",null,this.getFeatureValue(v.Constants.isNewAddProductExperienceEnabled)&&u.default.createElement("div",null,this.renderAddProductsAdditional()))),u.default.createElement(c.Stack,{style:{marginTop:"40px",marginBottom:"37px"}},u.default.createElement("div",{style:{flex:"2",flexDirection:"row",justifyContent:"space-between"}},this.renderGeneralSettingsGroup())))),u.default.createElement("div",null,u.default.createElement(c.Stack,{className:"pcs-Footer",horizontal:!0,tokens:{childrenGap:8}},u.default.createElement(d.PrimaryButton,{className:"pcs-SaveButton",text:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!this.isAnythingChanged()}),u.default.createElement(c.DefaultButton,{className:a,text:f.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction,disabled:!this.isAnythingChanged()}))))},t.prototype.disableAddProductsPreview=function(){var e=new Map(this.state.stateValues),t=!this.getFeatureIsChangedValue(v.Constants.isNewAddProductExperienceEnabled);e.set(v.Constants.isNewAddProductExperienceEnabled,{isChanged:t,currentValue:!1}),this.setState({stateValues:e}),this.toggleHideAddProductDisableConfirmationDialog()},t.prototype._onSaveAction=function(){var e=new Map;this.state.stateValues.forEach((function(t,n){t.isChanged&&e.set(n,t.currentValue)})),_.XrmHelper.parseStateMapAndLog(this.state.stateValues,"SalesAdminSettings.ProductCatalogSettings"),_.XrmHelper.SetProperties("organization",_.XrmHelper.getOrganizationId(),e),this.allIsChangedFalse()},t.prototype._onCancelAction=function(){p.CrmNavigationHelpers.navigateWithParams({id:"product_catalog"})},t}(u.default.Component);t.default=y,t.ConnectedProductCatalogSettingsApp=g.connect(null)(y)},439:function(e,t,n){var a=n(440);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(210)(a,i);a.locals&&(e.exports=a.locals)},440:function(e,t,n){(e.exports=n(209)(!1)).push([e.i,".pcs-pageGroup1 {\n  background-color: #FAF9F8;\n  padding-top: 21px;\n  padding-left: 24px;\n  padding-right: 24px;\n  margin-top: 40px;\n  max-width: 1084px;\n  width: calc(77vw); }\n\n.pcs-ProductSettingsAppContainer {\n  font-family: Segoe UI;\n  margin-left: 32px;\n  margin-top: 32px;\n  overflow: auto;\n  overflow-y: auto;\n  overflow-x: hidden;\n  width: inherit; }\n\n.pcs-GeneralSettingsFirstGroupItem {\n  border-bottom: 1px solid #EDEBE9;\n  margin-top: 24px;\n  padding-bottom: 12px;\n  width: calc(46vw);\n  max-width: 584px; }\n\n.pcs-GeneralSettingsGroupItem {\n  border-bottom: 1px solid #EDEBE9;\n  padding-top: 16px;\n  padding-bottom: 12px;\n  width: calc(46vw);\n  max-width: 584px; }\n\n.pcs-TextField {\n  border-bottom: 1px solid #EDEBE9;\n  padding-top: 21px;\n  padding-bottom: 13px;\n  width: calc(46vw);\n  max-width: 584px; }\n\n.pcs-RadioField {\n  border-bottom: 1px solid #EDEBE9;\n  margin-top: 21px;\n  padding-bottom: 16px;\n  width: calc(46vw);\n  max-width: 584px; }\n\n.pcs-inputTextField {\n  height: 20px;\n  width: 48px;\n  padding-left: 8px;\n  padding-right: 8px;\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-top: 12px;\n  border: 1px solid #605E5C;\n  border-radius: 2px; }\n\n.pcs-AddProductsHeader {\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  color: #201F1E;\n  font-weight: 600; }\n\n.pcs-ViewCustomization {\n  font-weight: 600; }\n\n.pcs-Footer {\n  position: fixed;\n  bottom: 0px;\n  border-top: 1px solid #EDEBE9;\n  padding-top: 16px;\n  padding-bottom: 16px;\n  width: 100%; }\n\n.pcs-SaveButton {\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  border-radius: 2px;\n  border: none; }\n\n.pcs-CancelButton {\n  font-family: Segoe UI;\n  font-size: 14px;\n  line-height: 20px;\n  border-radius: 2px; }\n\n.pcs-AddProductsGroupItemDescription {\n  margin-top: 4px;\n  color: #323130;\n  display: block;\n  width: calc(50vw);\n  max-width: 625px; }\n\n#pcs-subTextId {\n  font-size: 14px !important; }\n\n.pcs-pageGroupWithBorder {\n  display: flex;\n  flex-direction: row;\n  border-bottom: 1px solid #EDEBE9; }\n\n.pcs-pageGroupWithoutBorder {\n  display: flex;\n  flex-direction: row; }\n\n.pcs-illustration {\n  margin-left: 100px; }\n\n@media only screen and (max-width: 1152px) {\n  .pcs-pageGroupWithBorder {\n    flex-direction: column; }\n  .pcs-pageGroupWithoutBorder {\n    flex-direction: column; }\n  .pcs-illustration {\n    margin-left: auto; }\n  .pcs-pageGroup1 {\n    width: 95%; } }\n",""])},441:function(e,t,n){(e.exports=n(209)(!1)).push([e.i,".SettingsApp {\n  padding-top: 40px;\n  width: inherit;\n  padding-left: 50px;\n  padding-right: 25px; }\n\n.pageHeader {\n  width: inherit;\n  overflow: hidden; }\n\n.SettingsAppTitle {\n  font-family: 'Segoe UI';\n  padding-bottom: 20px;\n  font-size: 24px;\n  line-height: 32px;\n  color: #323130;\n  width: calc(90vw);\n  white-space: pre-wrap;\n  font-weight: 600; }\n\n.DetailListSetting {\n  padding-top: 15px;\n  padding-bottom: 20px; }\n\n.DetailsListStyle {\n  height: calc(70vh);\n  width: calc(90vw);\n  overflow-y: scroll;\n  overflow-x: hidden;\n  overflow-wrap: break-word; }\n\n.ManageDetailsListStyle {\n  padding-top: 15px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  overflow-wrap: break-word; }\n\n.DetailsListHeight {\n  height: calc(90vh);\n  max-height: calc(100vh); }\n\n.LinkedInDetailsListHeight {\n  height: calc(47vh);\n  max-height: calc(82vh); }\n\n.LIDetailsListStyle {\n  padding-top: 10px;\n  height: calc(55vh - 3.43rem);\n  width: calc(90vw);\n  max-height: 280px;\n  overflow-x: hidden;\n  overflow-wrap: break-word; }\n\n.SettingsAppDescription {\n  padding-top: 5px;\n  font-family: 'Segoe UI';\n  width: calc(38vw);\n  white-space: pre-wrap;\n  font-size: 16px;\n  line-height: 16px;\n  color: #323130; }\n\n.SettingsAppContainer {\n  font-family: 'Segoe UI';\n  max-height: calc(93vh);\n  overflow-y: auto;\n  overflow-x: hidden;\n  width: inherit; }\n\n.ManagePageAppContainer {\n  font-family: 'Segoe UI';\n  max-height: calc(70vh);\n  overflow-y: auto;\n  overflow-x: hidden;\n  width: inherit;\n  flex-grow: 1; }\n\n.PdfManagePageAppContainer {\n  font-family: 'Segoe UI';\n  max-height: calc(80vh);\n  overflow-y: auto;\n  overflow-x: hidden;\n  width: inherit; }\n\n.LinkedInManagePageAppContainer {\n  font-family: 'Segoe UI';\n  max-height: calc(78vh);\n  overflow-y: auto;\n  overflow-x: hidden;\n  width: inherit; }\n\n.TeamsIntegrationManagePageAppContainer {\n  font-family: 'Segoe UI';\n  max-height: calc(95vh);\n  overflow-y: auto;\n  overflow-x: hidden;\n  width: inherit; }\n\n.GroupHeader {\n  padding-top: 30px;\n  font-family: 'Segoe UI';\n  font-size: 15px;\n  line-height: 19px;\n  color: #323130; }\n\n.TableItems {\n  width: inherit;\n  white-space: pre-wrap;\n  border-bottom: 1px transparent; }\n\n.GroupItemName {\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 16px;\n  width: calc(35vw);\n  white-space: pre-wrap;\n  color: #323130; }\n\n.GroupItemDescription {\n  padding-top: 2px;\n  padding-right: 30px;\n  height: auto;\n  width: calc(35vw);\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C;\n  white-space: pre-wrap; }\n\n.TeamsIntGroupItemDescription {\n  padding-bottom: calc(0.5vh);\n  padding-top: 2px;\n  padding-right: 71px;\n  height: auto;\n  width: calc(35vw);\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C;\n  white-space: pre-wrap; }\n\n.SubGroupItemDescription {\n  padding-bottom: calc(1vh);\n  padding-top: calc(0.5vh);\n  padding-right: 38px;\n  padding-left: 33px;\n  height: auto;\n  width: calc(35vw);\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C;\n  white-space: pre-wrap; }\n\n.PDFGroupItemDescription {\n  height: auto;\n  width: calc(35vw);\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  white-space: pre-wrap; }\n\n.LandMSettingsAppDescription {\n  padding-top: 10px;\n  height: 20px;\n  width: calc(90vw);\n  display: block;\n  word-wrap: break-word;\n  white-space: unset;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  color: #605E5C;\n  justify-content: space-between; }\n\n.GroupItemManageLinkItem {\n  vertical-align: bottom;\n  font-family: 'Segoe UI';\n  width: 30%;\n  color: #2266E3; }\n\n.ToggleButton {\n  vertical-align: bottom;\n  font-family: 'Segoe UI';\n  color: #2266E3;\n  white-space: nowrap; }\n\n.GroupItemDescTable {\n  display: flex;\n  justify-content: left; }\n\n.LinkedInTable {\n  padding-top: 0px; }\n\n.LinkedInLearnMoreButton {\n  padding-left: 20px; }\n\n.LinkedInManageFooter {\n  width: 30%;\n  padding-top: 30px;\n  padding-left: 10px;\n  display: flex;\n  justify-content: space-between; }\n\n.LinkedInManageDetailsList {\n  padding-top: 20px; }\n\n.ManagePageTitle {\n  display: block;\n  padding-top: 20px;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 16px;\n  width: calc(90vw);\n  white-space: pre-wrap;\n  color: #323130; }\n\n.ManagePageDescription {\n  display: block;\n  padding-top: 0px;\n  font-family: 'Segoe UI';\n  font-size: 16px;\n  font-weight: 600;\n  line-height: 16px;\n  white-space: pre-wrap;\n  color: #323130; }\n\n.SubGroupItemName {\n  display: block;\n  font-family: 'Segoe UI';\n  font-size: 16px;\n  font-weight: 600;\n  line-height: 16px;\n  white-space: pre-wrap;\n  color: #323130;\n  padding-left: 33px; }\n\n.ManagePageExplain {\n  padding-top: 5px;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  width: calc(38vw);\n  white-space: pre-wrap;\n  color: #605E5C; }\n\n.PdfSettingsTable {\n  padding-top: 20px;\n  display: flex;\n  justify-content: space-evenly; }\n\n.ManagePdfFlexControl {\n  display: flex;\n  flex-wrap: wrap;\n  margin-top: 10px; }\n\n.ToggleAndFilterControl {\n  margin: 0 30px 0px 0;\n  max-width: 300px; }\n\n.headerClass span {\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  padding-left: initial;\n  /* semi bold font */\n  font-weight: 600;\n  color: #323130; }\n\n.ManagePdfDetaillistScrollablePane {\n  margin-top: 5px;\n  overflow-y: scroll;\n  overflow-x: hidden;\n  max-height: calc(42vh);\n  height: calc(42vh);\n  max-width: calc(53vw);\n  width: calc(53vw); }\n\n.HideCancelButton {\n  display: none; }\n\n.menuRowDIVStyle {\n  display: flex;\n  flex-direction: row; }\n\n.menuColumnDIVStyle {\n  display: flex;\n  flex-direction: column;\n  background: #EFEFEF;\n  width: 240px;\n  height: 1057px;\n  padding-top: 35px; }\n\n.tablinkSelectected {\n  background-color: #FFFFFF;\n  position: static;\n  height: 35px;\n  left: 0px;\n  right: 0px;\n  top: 0px;\n  flex: none;\n  flex-grow: 0;\n  margin: 0px 0px;\n  padding-left: 16px;\n  padding-right: 46px; }\n\n.tablink {\n  white-space: nowrap;\n  font-size: 14px;\n  border: none;\n  background: #EFEFEF;\n  position: static;\n  height: 35px;\n  left: 0px;\n  right: 0px;\n  top: 0px;\n  flex: none;\n  flex-grow: 0;\n  margin: 0px 0px;\n  padding-left: 16px;\n  padding-right: 46px; }\n\n.tablink:hover {\n  background-color: #FFFFFF;\n  position: static;\n  height: 35px;\n  left: 0px;\n  right: 0px;\n  top: 0px;\n  flex: none;\n  flex-grow: 0;\n  margin: 0px 0px;\n  padding-left: 16px;\n  padding-right: 46px;\n  box-shadow: 1px 1px 1px 1px #FFFFFF;\n  cursor: pointer; }\n\n.lblStyle {\n  letter-spacing: 0.005em;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  display: flex;\n  line-height: 20px;\n  height: 35px;\n  align-items: center;\n  color: #323130;\n  cursor: pointer;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap; }\n",""])},442:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{},operationName:"msdyn_EnableSharePoint",operationType:0}},e}();t.EnableSharePointRequest=a},443:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this.Enable=e,this.LogicalEntityNames=t}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{Enable:{typeName:"Edm.Boolean",structuralProperty:1},LogicalEntityNames:{typeName:"Edm.String",structuralProperty:1}},operationName:"msdyn_SetTeamsDocumentStatus",operationType:0}},e}();t.EnableMSTeamsDocumentManagementRequest=a},444:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{},operationName:"IsPaiEnabled",operationType:0}},e}();t.IsPAIEnabledRequest=a},445:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{},operationName:"RetrieveTenantAdminPermissions",operationType:1}},e}();t.RetrieveTenantAdminPermissionsRequest=a},446:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this.filter=e,this.columns=t}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"EntityDefinitions",operationType:2}},e}();t.RetrieveEntityDefinitions=a},447:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Usage=3]="Usage",e[e.Error=4]="Error"}(t.ILogLevel||(t.ILogLevel={}))},450:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{},operationName:"msdyn_IsLinkedInDataValidationEnabled",operationType:0}},e}();t.IsLinkedInDataValidationEnabledRequest=a},451:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{},operationName:"msdyn_EnableLinkedInDataValidation",operationType:0}},e}();t.EnableLinkedInDataValidationRequest=a},452:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this.ApiType=e,this.ApiPayLoad=null!=t?t:""}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{ApiType:{typeName:"Edm.Int32",structuralProperty:1},ApiPayLoad:{typeName:"Edm.String",structuralProperty:1}},operationName:"msdyn_DataValidationApi",operationType:0}},e}();t.DisableLinkedInDataValidationRequest=a},453:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t,n){this.etn=e,this.id=t,this.payload=n}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"Update",operationType:2}},e}();t.ODataUpdateRequest=a},454:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.isNewAddProductExperienceEnabled="isnewaddproductexperienceenabled",e.createProductsWithoutParentInActiveState="createproductswithoutparentinactivestate",e.useInbuiltRulefOrDefaultPricelistSelection="useinbuiltrulefordefaultpricelistselection",e.oobPriceCalculationEnabled="oobpricecalculationenabled",e.isPricelistMandatory="ispricelistmandatory",e.maxProductsInBundle="maxproductsinbundle",e.maximumDynamicPropertiesAllowed="maximumdynamicpropertiesallowed",e.discountCalculationMethod="discountcalculationmethod",e.opportunityAddProductsViewEndPartUrlLegacy="/tools/vieweditor/viewManager.aspx?id=%7bF2469229-1A70-EA11-A81E-000D3AAC76E1%7d&entityId=%7b8A4283A8-EEF3-4915-9E20-055DC136663D%7d&appSolutionId=%7bFD140AAF-4DF4-11DD-BD17-0019B9312238%7d",e.orderAddProductsViewEndPartUrlLegacy="/tools/vieweditor/viewManager.aspx?id=%7bD0673E84-38BA-4671-9D9F-D888FD26B487%7d&entityId=%7bCFE9FCA6-0F11-4466-A639-33EA27370100%7d&appSolutionId=%7bFD140AAF-4DF4-11DD-BD17-0019B9312238%7d",e.quoteAddProductsViewEndPartUrlLegacy="/tools/vieweditor/viewManager.aspx?id=%7bBA69E166-3C07-496C-9401-6C0A788D0D23%7d&entityId=%7b68B92C2B-4BFD-43F2-B183-0F0E8B49639C%7d&appSolutionId=%7bFD140AAF-4DF4-11DD-BD17-0019B9312238%7d",e.invoiceAddProductsViewEndPartUrlLegacy="/tools/vieweditor/viewManager.aspx?id=%7b18A4D4A8-8127-438A-8DF7-3811B8BF28C4%7d&entityId=%7b8D899EC1-C0E4-4F24-82E2-3AFF96A1F0ED%7d&appSolutionId=%7bFD140AAF-4DF4-11DD-BD17-0019B9312238%7d",e.productLookupViewEndPartUrlLegacy="/tools/vieweditor/viewManager.aspx?id=%7b8BA625B2-6A2A-4735-BAB2-0C74AE8442A4%7d&entityId=%7bAAF9BE65-10C2-415D-8C19-FB1489021330%7d&appSolutionId=%7bFD140AAF-4DF4-11DD-BD17-0019B9312238%7d",e.opportunityAddProductsViewEndPartUrlModernDesigner="/s/fd140aaf-4df4-11dd-bd17-0019b9312238/view/f2469229-1a70-ea11-a81e-000d3aac76e1?source=app-view-designer",e.orderAddProductsViewEndPartUrlModernDesigner="/s/fd140aaf-4df4-11dd-bd17-0019b9312238/view/d0673e84-38ba-4671-9d9f-d888fd26b487?source=app-view-designer",e.quoteAddProductsViewEndPartUrlModernDesigner="/s/fd140aaf-4df4-11dd-bd17-0019b9312238/view/ba69e166-3c07-496c-9401-6c0a788d0d23?source=app-view-designer",e.invoiceAddProductsViewEndPartUrlModernDesigner="/s/fd140aaf-4df4-11dd-bd17-0019b9312238/view/18a4d4a8-8127-438a-8df7-3811b8bf28c4?source=app-view-designer",e.productLookupViewEndPartUrlModernDesigner="/s/fd140aaf-4df4-11dd-bd17-0019b9312238/view/8ba625b2-6a2a-4735-bab2-0c74ae8442a4?source=app-view-designer",e.PowerAppsShellProdUrl="https://make.powerapps.com/e/",e.PowerAppsShellTestUrl="https://make.test.powerapps.com/e/",e.PowerAppsShellGCCModUrl="https://make.gov.powerapps.us/e/",e.PowerAppsShellGCCHighUrl="https://make.high.powerapps.us/e/",e.DEFAULT_MAX_PRODUCTS_IN_BUNDLE=15,e.DEFAULT_MAX_PROPERTIES_ALLOWED=15,e.DEFAULT_DISCOUNT_CALCULATION_METHOD=0,e.productCatalogSettingsLabelid="productCatalogSettingsLabelid",e.addProductsPreviewLabelid="addProductsPreviewLabelid",e.termsAndConditionsid="termsAndConditionsid",e.customizationsOptionsid="customizationsOptionsid",e.productCellid="productCellid",e.defaultPricelistSelectionid="defaultPricelistSelectionid",e.oobPriceCalculationEnabledid="oobPriceCalculationEnabledid",e.generalSettingsGroupid="generalSettingsGroupid",e.productCatalogSettingsLearnMore="https://go.microsoft.com/fwlink/?linkid=2157210",e.addProductsPreviewLearnMore="https://go.microsoft.com/fwlink/?linkid=2156929",e.termsAndConditionsUrl="https://go.microsoft.com/fwlink/?linkid=2156925",e.customizationsOptionsLearnMore="https://go.microsoft.com/fwlink/?linkid=2156644",e.generalSettingsLearnMore="https://go.microsoft.com/fwlink/p/?linkid=2155358",e.addProductsIllustration="/webresources/cc_MscrmControls.FieldControls.CCFadminsettings/img/AddProducts_Illustration.png",e}();t.Constants=a},455:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(44),d=n(56),u=n(53),g=n(44),p=l(n(0)),S=n(38),f=n(41),m=n(37),_=n(48);n(49);var h=n(54),b=n(31),v=n(32),y=n(286),C=n(287),I=n(46),E=n(42),P=n(91),w=n(92);S.initializeIcons();var L=function(e){function t(t){var n=e.call(this,t)||this;n._root=p.default.createRef(),n._items=[],n._groups=[],n.isSopEnabled=!1,n._tabitems=[],n.isEnabledFCBForADC=!1,n.isEnabledFCBForEmailEngagement=!1,n._onRenderGroupHeader=function(e){return p.default.createElement(d.GroupHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"},title:{fontFamily:"Segoe UI",fontSize:"16px",fontWeight:600,lineHeight:"19px",color:"#323130"}}}))},n._initializeGrpExpand=function(){var e=n._groups,t=n._collapseOnStartCheck;e.forEach((function(e){e.isCollapsed=!t(e.key)}))},n._collapseOnStartCheck=function(e){var t=!1;f.store.getState().viewId;switch(f.store.getState().isManage){case"lno":t="g1"===e;break;case"pt":t="g2"===e;break;case"cnc":t="g3"===e;break;case"li":t="g4"===e;break;case"sop":t="g5"===e;break;case"tc":t="g6"===e;break;default:t=!0}return t},n.state={overviewState:{isSopEnabled:!1}};var a="pdf_generation";try{I.XrmHelper.IsFCBEnabled("October2020Update")&&I.XrmHelper.IsFCBEnabled("EnhancedPDFAdminSettings")&&(a="enhance_pdf_generation")}catch(e){a="pdf_generation"}return n._items=[{key:"1",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Title_QualifiedLeads),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_QualifiedLeads),learnmorelink:"",viewid:"l_and_m",shouldDisplay:!0},{key:"2",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Title_CustomFields),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_CustomFields),learnmorelink:"",viewid:"opp_custom_fields",shouldDisplay:!0},{key:"3",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Title_EnhancedEmail),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_EnhancedEmail),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2119725",viewid:"enhanced_email",shouldDisplay:!0},{key:"4",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Title_BusinessCard),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_BusinessCard),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2120016",viewid:"business_card_scan",shouldDisplay:!0},{key:"5",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Title_ConvertPDF),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_ConvertPDF),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2119726",viewid:a,shouldDisplay:!0},{key:"6",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.RI_overview_ADC_title),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.RI_overview_ADC_description),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2014071",viewid:"adc",shouldDisplay:!!n.isEnabledFCBForADC},{key:"7",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.RI_overview_EE_title),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.RI_overview_EE_description),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2014068",viewid:"email_engagement",shouldDisplay:!!n.isEnabledFCBForEmailEngagement},{key:"8",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Title_TeamsInteg),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_TeamsInteg),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2120017",viewid:"teams_int",shouldDisplay:!0},{key:"9",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Title_LinkedIn),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_LinkedIn),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2119727",viewid:"linkedin_int",shouldDisplay:!0}],n._groups=[{key:"g1",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.GroupHeader_Lead_Opty),startIndex:0,count:2},{key:"g2",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.GroupHeader_Productivity_Tools),startIndex:2,count:3},{key:"g3",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.GroupHeader_Chat_Collab),startIndex:7,count:1},{key:"g4",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.GroupHeader_LinkedIn),startIndex:8,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],I.XrmHelper.IsFCBEnabled("TeamsDialerSettings")&&n._addTeamsCallsSettingsGroupItems(),n}return i(t,e),t.prototype.componentWillMount=function(){},t.prototype._addSopGroupItems=function(){this._items.push({key:"10",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.SettingName_SopInteg),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_SopInteg),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2119728",viewid:"sop_int"}),this._groups.push({key:"g5",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.GroupHeader_SopInteg),startIndex:10,count:1})},t.prototype._addTeamsCallsSettingsGroupItems=function(){var e=this._items.length;this._items.push({key:(e+1).toString(),name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Title_TeamsCalls),description:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Setting_Label_TeamsCalls),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2139179",viewid:"teams_calls_int"}),this._groups.push({key:"g6",name:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.GroupHeader_TeamsCalls),startIndex:e,count:1})},t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:window.Xrm.Utility.showProgressIndicator(b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Label_Processing)),n.label=1;case 1:return n.trys.push([1,3,,4]),e=this,[4,I.XrmHelper.GetOrganizationProperty("issopintegrationenabled")];case 2:return e.isSopEnabled=n.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return n.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({overviewState:{isSopEnabled:this.isSopEnabled}}),this.pageHeader.focus(),(t=new Map).set("Page","Overview"),t.set("Status","Loaded"),E.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",t),[2]}}))}))},t.prototype.componentWillUnmount=function(){},t._LaunchLeadandConfig=function(e){var t={id:e};_.CrmNavigationHelpers.navigateWithParams(t);var n=new Map;n.set("Page",e),n.set("Status","Requested"),E.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",n)},t.prototype.render=function(){var e=this;this._initializeGrpExpand();var t=new u.Selection({canSelectItem:function(){return!1}});if(this.isSopEnabled&&this._addSopGroupItems(),"true"===f.store.getState().isManage)p.default.createElement("div",{className:"MainAppContainer"},p.default.createElement(C.ConnectedLinkedInIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}));else{if("false"!==f.store.getState().isManage)return p.default.createElement("div",{className:"SettingsAppContainer"},p.default.createElement("div",null,P.SalesPremiumNotification(b.GlobalLocalizedStringsProvider.getStringProvider(),!1,new w.NotificationLogger)),p.default.createElement("div",{className:"SettingsApp"},p.default.createElement("div",{className:"pageHeader"},p.default.createElement("div",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0,title:b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Overview_Title)},b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Overview_Title)),p.default.createElement("div",{className:"SettingsAppDescription"},b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Overview_Desc))),p.default.createElement("div",{className:"DetailListSetting"},p.default.createElement(g.DetailsList,{className:"DetailsListStyle",key:Date.now(),componentRef:this._root,items:this._items,groups:this._groups,isHeaderVisible:!1,columns:this._columns,onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:u.SelectionMode.none,selection:t,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader,groupProps:{onRenderHeader:this._onRenderGroupHeader}}))));p.default.createElement(y.ConnectedBCSettingsApp,{crmDataAccess:this.props.crmDataAccess,tabItems:this._tabitems})}},t.prototype._onRenderCell=function(){},t.prototype._onRenderColumn=function(e,n,a){var i=e.description,r=b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Label_Learn_More);return p.default.createElement("div",{className:"TableItems"},p.default.createElement("div",{className:"GroupItemName"},e.name),p.default.createElement("div",{className:"GroupItemDescTable"},p.default.createElement("span",{className:"GroupItemDescription"},i,""!==e.learnmorelink?p.default.createElement(c.Link,{target:"_blank",href:e.learnmorelink},"Â ",r):p.default.createElement("span",null)),p.default.createElement(c.Link,{style:{whiteSpace:"nowrap",fontSize:"14px"},onClick:function(){return t._LaunchLeadandConfig(e.viewid)}},b.GlobalLocalizedStringsProvider.GetString(v.STRING_KEYS.Label_Manage))))},t.prototype._onRenderRow=function(e){return p.default.createElement(g.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t.prototype._onRenderDetailsHeader=function(e){return p.default.createElement(g.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(p.default.Component);t.default=L;t.ConnectedOverviewApp=m.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:h.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(L)},456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(48),i=function(){function e(){}return e.prototype.OpenPage=function(e){console.log("CrmNavigationHandler.OpenPage >");var t={id:e};a.CrmNavigationHelpers.navigateWithParams(t),console.log("CrmNavigationHandler.OpenPage <")},e}();t.CrmNavigationHandler=i},46:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),s=n(442),o=n(443),l=n(444),c=n(445),d=n(446),u=n(31),g=n(32),p=n(42),S=n(284),f=n(285),m="3e5d32bb-3fd3-424e-81f0-7d4faf5aee94",_=function(){function e(){}return e.IsRestrictedEnvironment=function(){return!1},e.GetRISPAUrl=function(){var e=window.Xrm.Utility.getGlobalContext().getClientUrl(),t=this.getOrganizationId(),n=window.Xrm.Page.context.getUserLcid();return this.GetServiceEndPointBasedOnOrgUrl(e)+"/LinkedInProvisioning/index?orgId="+t+"&lcid="+n},e.GetServiceEndPointBasedOnOrgUrl=function(e){var t,n=e&&e.split(".");switch(n&&n.length>0&&n[n.length-3]){case"crm":t="https://nam.sales.ai.dynamics.com";break;case"crm2":t="https://ssam.sales.ai.dynamics.com";break;case"crm3":t="https://ccan.sales.ai.dynamics.com";break;case"crm4":t="https://weur.sales.ai.dynamics.com";break;case"crm5":t="https://seapj.sales.ai.dynamics.com";break;case"crm6":t="https://eoce.sales.ai.dynamics.com";break;case"crm7":t="https://ejpn.sales.ai.dynamics.com";break;case"crm8":t="https://cind.sales.ai.dynamics.com";break;case"crm10":t="https://tip1.sales.ai.dynamics.com";break;case"crm11":t="https://gbr.sales.ai.dynamics.com";break;case"crm12":t="https://cfra.sales.ai.dynamics.com";break;default:throw new Error("ServiceEndPoint Not Found For this Org Url '"+e+"'")}return t},e.GetSharePointDeploymentType=function(){return 0},e.isXrmEnabled=function(){return null!=window.Xrm},e.getOrganizationId=function(){return window.Xrm.Utility.getGlobalContext().organizationSettings.organizationId},e.IsTenantAdmin=function(){window.Xrm.Utility.getGlobalContext().organizationSettings;return r.store.getState().salesSettings.is_tenant_admin},e.GetIsSystemAdministrator=function(){var e=window.Xrm.Utility.getGlobalContext().userSettings.securityRoles,t=window.Xrm.WebApi.online.retrieveMultipleRecords("role","?$select=roleid&$filter=_roletemplateid_value eq 627090ff-40a3-4053-8790-584edc5be201");t.then((function(t){if(null!=t&&null!=t.entities)for(var n=0;n<t.entities.length;n++)for(var a=0;a<e.length;a++)e[a].toLowerCase()==t.entities[n].roleid.toLowerCase()&&(console.log("Current user is admin."),r.store.getState().salesSettings.is_system_admin=!0);0==r.store.getState().salesSettings.is_system_admin&&console.log("Current user is not a admin")})),t.catch((function(e){console.log(e)}))},e.IsSystemAdministrator=function(){return r.store.getState().salesSettings.is_system_admin},e.getLoggedInUserInfo=function(){var e=window.Xrm.Utility.getGlobalContext().userSettings;return{entityLogicalName:"systemuser",displayName:e.userName,id:e.userId}},e.isUserLanguageRTL=function(){return!!e.isXrmEnabled()&&window.Xrm.Utility.getGlobalContext().userSettings.isRTL},e.LoadSalesSettings=function(){return a(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return e.isXrmEnabled()?[4,e.LoadLandMSettings()]:[3,7];case 1:return t.sent(),[4,e.LoadPDFSettings()];case 2:return t.sent(),[4,e.LoadBusinessCardSettings()];case 3:return t.sent(),[4,e.LoadImproveProductivitySettings()];case 4:return t.sent(),[4,e.LoadCandI()];case 5:return t.sent(),[4,e.LoadLinkedInSettings()];case 6:t.sent(),t.label=7;case 7:return[2]}}))}))},e.LoadLandMSettings=function(){return a(this,void 0,void 0,(function(){var e,t,n,a,s,o,l,c,d;return i(this,(function(i){switch(i.label){case 0:e=window.Xrm.Utility.getGlobalContext().organizationSettings,t="?$select=qualifyleadadditionaloptions",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,t)];case 2:return n=i.sent(),c=JSON.parse(n.qualifyleadadditionaloptions),0==n.qualifyleadadditionaloptions.localeCompare("{}")?r.store.getState().salesSettings.qualify_lead_experience=!0:(a=c.DefaultQualifyFlow,r.store.getState().salesSettings.qualify_lead_experience="true"===a),[3,4];case 3:return s=i.sent(),console.log("qualifyleadadditionaloptions <failed>"),console.error(s),[3,4];case 4:o="?$select=isquickcreateenabledforopportunityclose",i.label=5;case 5:return i.trys.push([5,7,,8]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,o)];case 6:return l=i.sent(),c=JSON.parse(l.isquickcreateenabledforopportunityclose),r.store.getState().salesSettings.is_quick_create_enabled_for_opportunity_close=c,[3,8];case 7:return d=i.sent(),console.error(d),[3,8];case 8:return[2]}}))}))},e.LoadBusinessCardSettings=function(){return a(this,void 0,void 0,(function(){var t,n,a,s;return i(this,(function(i){switch(i.label){case 0:t=new l.IsPAIEnabledRequest,i.label=1;case 1:return i.trys.push([1,6,,7]),[4,window.Xrm.WebApi.online.execute(t)];case 2:return(n=i.sent())?[4,n.json()]:[3,4];case 3:a=i.sent();try{a.ispaienabled&&e.IsFCBEnabled("October2019Update")?r.store.getState().salesSettings.is_pai_enabled=!0:r.store.getState().salesSettings.is_pai_enabled=!1}catch(e){r.store.getState().salesSettings.is_pai_enabled=!1,console.log("Error while geting ispaienabled"+e)}return[3,5];case 4:console.log("pai enabled response check failed: "+n),i.label=5;case 5:return[3,7];case 6:return s=i.sent(),console.log("Retreiving EnablePAI FCB value failed: "+s),[3,7];case 7:return[2]}}))}))},e.LoadLinkedInSettings=function(){return a(this,void 0,void 0,(function(){var t,n,a,s,o,l,d;return i(this,(function(i){switch(i.label){case 0:e.GetIsSystemAdministrator(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveMultipleRecords("sales_linkedin_configuration","")];case 2:return t=i.sent(),n=window.Xrm.Utility.getGlobalContext().organizationSettings,console.log(n.OrgType),console.log(n.attributes),t.entities.length>0?(r.store.getState().salesSettings.sales_linkedin_configurationid=t.entities[0].sales_linkedin_configurationid,r.store.getState().salesSettings.sales_linkedin_enable_feature=t.entities[0].sales_linkedin_enable_feature,r.store.getState().salesSettings.sales_linkedin_profile_feature=t.entities[0].sales_linkedin_profile_feature,r.store.getState().salesSettings.is_linkedin_installed=!0):(r.store.getState().salesSettings.sales_linkedin_configurationid="",r.store.getState().salesSettings.sales_linkedin_enable_feature=!1,r.store.getState().salesSettings.sales_linkedin_profile_feature=!1,r.store.getState().salesSettings.is_linkedin_installed=!1),[3,4];case 3:return a=i.sent(),console.log(a),2147868684==a.errorCode&&(r.store.getState().salesSettings.is_linkedin_installed=!1),console.error("LoadLinkedInSettings: "+a.message),[3,4];case 4:s=new c.RetrieveTenantAdminPermissionsRequest,i.label=5;case 5:return i.trys.push([5,9,,10]),[4,window.Xrm.WebApi.online.execute(s)];case 6:return(o=i.sent())?[4,o.json()]:[3,8];case 7:l=i.sent();try{"true"==JSON.parse(l.AdminPermissions).isCurrentUserTenantAdmin.toLowerCase()&&(console.log("current user is Tenant admin"),r.store.getState().salesSettings.is_tenant_admin=!0)}catch(e){console.log(e)}i.label=8;case 8:return[3,10];case 9:return d=i.sent(),console.log(d),[3,10];case 10:return[4,f.LinkedInSettingsHelper.FetchLinkedInUpdatesStatus()];case 11:return i.sent(),[2]}}))}))},e.LoadPDFSettings=function(){return a(this,void 0,void 0,(function(){var e,t,n,s,o,l,c=this;return i(this,(function(d){switch(d.label){case 0:e=["account","contact","lead","opportunity","quote","salesorder","invoice"],t=window.Xrm.Utility.getGlobalContext().organizationSettings,n="?$select=ispdfgenerationenabled",d.label=1;case 1:return d.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",t.organizationId,n)];case 2:return s=d.sent(),o=JSON.parse(s.ispdfgenerationenabled),e.forEach((function(e){r.store.getState().salesSettings.pdf_settings.set(e,o[e])})),[3,4];case 3:return l=d.sent(),console.log("ispdfgenerationenabled <failed>"),console.error(l),[3,4];case 4:return e.forEach((function(e){return a(c,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,window.Xrm.Utility.getEntityMetadata(e,["DisplayName"])];case 1:return t=n.sent(),r.store.getState().salesSettings.pdf_entityDisplayNames.set(e,t.DisplayName),[3,3];case 2:return n.sent(),r.store.getState().salesSettings.pdf_entityDisplayNames.set(e,e),[3,3];case 3:return[2]}}))}))})),[2]}}))}))},e.LoadEnhancePDFSettings=function(){return a(this,void 0,void 0,(function(){var e,t,n,a,s,o,l,c,u,g,f,_,h,b;return i(this,(function(i){switch(i.label){case 0:(e=new Map).set("Operation","Retrive EntityMetadata"),t=["LogicalName","DisplayName"],"$filter=(IsCustomEntity eq true and IsValidForAdvancedFind eq true and ObjectTypeCode gt 10000) or LogicalName eq 'account' or LogicalName eq 'contact' or LogicalName eq 'lead' or LogicalName eq 'opportunity' or LogicalName eq 'quote' or LogicalName eq 'salesorder' or LogicalName eq 'invoice'",n=new d.RetrieveEntityDefinitions("$filter=(IsCustomEntity eq true and IsValidForAdvancedFind eq true and ObjectTypeCode gt 10000) or LogicalName eq 'account' or LogicalName eq 'contact' or LogicalName eq 'lead' or LogicalName eq 'opportunity' or LogicalName eq 'quote' or LogicalName eq 'salesorder' or LogicalName eq 'invoice'",t),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,window.Xrm.WebApi.online.execute(n)];case 2:return(a=i.sent())?(e.set("Success","Retrived entity metadata successfully with response: "+a),[4,a.json()]):[3,4];case 3:s=i.sent();try{for(r.store.getState().salesSettings.entityList=[],o=s.value,l=0;l<o.length;l++)c=o[l].LogicalName,u=null!=o[l].DisplayName.UserLocalizedLabel?o[l].DisplayName.UserLocalizedLabel.Label:c,r.store.getState().salesSettings.pdf_entities.set(c,{displayName:u,isEnabled:!1,currentValue:!1}),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.RetrieveMetadata",e)}catch(t){e.set("Error","Adding entity metadata response to a Map data structure is failing with: "+t),p.logError("SalesAdminSettings.PDF2020Wave2Updates",t,"SalesAdminSettings.EnhancePDFSetting.AddingEntityMetadaResponseToMap",e)}i.label=4;case 4:return[3,6];case 5:return g=i.sent(),e.set("Error","Retrieving entity metadata is failing with: "+g),p.logError("SalesAdminSettings.PDF2020Wave2Updates",g,"SalesAdminSettings.EnhancePDFSetting.RetrieveMetadata",e),console.log("Retrieving PDFSetting entity is failing with: ",g),[3,6];case 6:(e=new Map).set("Operation","Retrive PDFSetting entity"),f="?$select=pdfsettingsjson",i.label=7;case 7:return i.trys.push([7,9,,10]),[4,window.Xrm.WebApi.retrieveRecord("pdfsetting",m,f)];case 8:return _=i.sent(),S.isNullOrUndefined(_)?(e.set("Info","PDFSetting has no record with "+m+": "+_),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.RetrievePDFSettingEntity",e)):(h=JSON.parse(_.pdfsettingsjson),r.store.getState().salesSettings.pdf_entities.forEach((function(e,t){!0===h[t]?(e.isEnabled=!0,e.currentValue=!0):(e.isEnabled=!1,e.currentValue=!1),r.store.getState().salesSettings.pdf_entities.set(t,e)})),e.set("Success","Retrived PDFSetting entity successfully with response: "+_),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.RetrievePDFSettingEntity",e)),[3,10];case 9:return b=i.sent(),e.set("Error","Retrieving PDFSetting entity is failing with: "+b),p.logError("SalesAdminSettings.PDF2020Wave2Updates",b,"SalesAdminSettings.EnhancePDFSetting.RetrievePDFSettingEntity",e),[3,10];case 10:return[2]}}))}))},e.LoadCandI=function(){return a(this,void 0,void 0,(function(){var t,n,a,s,o,l,c,u,g,p,S;return i(this,(function(i){switch(i.label){case 0:e.GetIsSystemAdministrator(),t=window.Xrm.Utility.getGlobalContext().organizationSettings,n="?$select=ismsteamsenabled,ismsteamscollaborationenabled,isembedteamscollabenabled,enablesensitivitylabelsforteamscollab,defaultteamschattitlerecordname",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",t.organizationId,n)];case 2:return a=i.sent(),r.store.getState().salesSettings.is_msteams_basic_enabled=a.ismsteamsenabled,r.store.getState().salesSettings.is_msteams_advanced_enabled=a.ismsteamscollaborationenabled,r.store.getState().salesSettings.is_msteams_embedcollab_enabled=a.isembedteamscollabenabled,r.store.getState().salesSettings.is_msteams_sensitivityCollab_enabled=a.enablesensitivitylabelsforteamscollab,r.store.getState().salesSettings.is_default_chat_title_record_name=a.defaultteamschattitlerecordname,[3,4];case 3:return s=i.sent(),console.log("Retrieve column data <failed>"),console.error(s),[3,4];case 4:o=["LogicalName"],l=new d.RetrieveEntityDefinitions("",o),i.label=5;case 5:return i.trys.push([5,9,,10]),[4,window.Xrm.WebApi.online.execute(l)];case 6:return(c=i.sent())?[4,c.json()]:[3,8];case 7:u=i.sent();try{for(r.store.getState().salesSettings.entityList=[],g=u.value,p=0;p<g.length;p++)r.store.getState().salesSettings.entityList.push(g[p].LogicalName)}catch(e){console.log(e)}i.label=8;case 8:return[3,10];case 9:return S=i.sent(),console.log(S),[3,10];case 10:return[2]}}))}))},e.LoadImproveProductivitySettings=function(){return a(this,void 0,void 0,(function(){var e,t,n,a,s,o,l,c,d;return i(this,(function(i){switch(i.label){case 0:e=window.Xrm.Utility.getGlobalContext().organizationSettings,t="?$select=iscontextualemailenabled",i.label=1;case 1:return i.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,t)];case 2:return n=i.sent(),l=JSON.parse(n.iscontextualemailenabled),r.store.getState().salesSettings.is_contextual_email_enabled=l,[3,4];case 3:return a=i.sent(),console.log("iscontextualemailenabled <failed>"),console.error(a),[3,4];case 4:s="?$select=businesscardoptions",i.label=5;case 5:return i.trys.push([5,7,,8]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,s)];case 6:return o=i.sent(),l=JSON.parse(o.businesscardoptions),c=l.StoreBusinessCardImage,r.store.getState().salesSettings.store_business_card_image="true"===c,[3,8];case 7:return d=i.sent(),console.log("businesscardoptions <failed>"),console.error(d),[3,8];case 8:return console.log("LoadImproveProductivitySettings <<"),[2]}}))}))},e.LoadSopSettings=function(){return a(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:return[4,e.GetOrganizationProperty("issopintegrationenabled")];case 1:return t=n.sent(),r.store.getState().salesSettings.is_sopintegration_enabled=t,[2]}}))}))},e.SetProperty=function(t,n,a,i){if(e.isXrmEnabled()){var r={};r[a]=i,e.updateRecordWithSpinner(t,n,r)}},e.SetProperties=function(t,n,a){if(e.isXrmEnabled()){var i={};a.forEach((function(e,t){i[t]=e})),e.updateRecordWithSpinner(t,n,i)}},e.MigrateExistingPDFSettingsToNewPDFSettingEntity=function(){return a(this,void 0,void 0,(function(){var t,n,a,r,s;return i(this,(function(i){switch(i.label){case 0:t=new Map,i.label=1;case 1:return i.trys.push([1,7,,8]),n={},a=window.Xrm.Utility.getGlobalContext().organizationSettings,"?$select=ispdfgenerationenabled",e.IsFCBEnabled("October2020Update")?[3,5]:[4,window.Xrm.WebApi.retrieveRecord("organization",a.organizationId,"?$select=ispdfgenerationenabled")];case 2:return null==(r=i.sent())?[3,4]:(n.pdfsettingsjson=r.ispdfgenerationenabled,[4,e.updateRecord("pdfsetting",m,n,!1)]);case 3:i.sent(),t.set("MigratePDFSettingStatus","successful"),t.set("SuccessMessage","PDF setting attribute pdfsettingsjson for pdfsetting recordId"+m+"successfully updated with ispdfgenerationenabled settings data from organization table"),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.MigratePDFSettingStatus",t),i.label=4;case 4:return[3,6];case 5:t.set("MigratePDFSettingStatus","already migrated"),t.set("SuccessMessage","PDF setting key enabledpdfentities already updated with ispdfgenerationenabled settings data"),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.MigratePDFSettingStatus",t),i.label=6;case 6:return[3,8];case 7:return s=i.sent(),t.set("MigrateStatus","Failed"),t.set("ErrorMessage",s.message),p.logError("SalesAdminSettings.PDF2020Wave2Updates",s,"SalesAdminSettings.MigratePDFSettingUpdateStatus",t),[3,8];case 8:return[2]}}))}))},e.GetOrganizationProperty=function(e){return a(this,void 0,void 0,(function(){var t,n,a,r;return i(this,(function(i){switch(i.label){case 0:t=window.Xrm.Utility.getGlobalContext().organizationSettings,n="?$select="+e,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",t.organizationId,n)];case 2:return a=i.sent(),[2,JSON.parse(a[e])];case 3:return r=i.sent(),console.log("iscontextualemailenabled <failed>"),console.error(r),[2,!1];case 4:return[2]}}))}))},e.GetEnvironmentDetails=function(){return a(this,void 0,void 0,(function(){var e,t,n,a;return i(this,(function(i){switch(i.label){case 0:return e=window.Xrm.Utility.getGlobalContext(),t=e.getClientUrl(),n=t+"/api/data/v9.1/RetrieveCurrentOrganization(AccessType=Microsoft.Dynamics.CRM.EndpointAccessType'Internet')",[4,this.getJSON(n).then((function(e){a=e.Detail}),(function(e){return console.log(e)}))];case 1:return i.sent(),[2,a]}}))}))},e.getJSON=function(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("GET",e),a.onload=function(){4!=a.readyState||200!=a.status&&204!=a.status?n(a.status):t(JSON.parse(a.response))},a.send()}))},e.GetOrganizationProperties=function(e){return a(this,void 0,void 0,(function(){var t,n,a,r;return i(this,(function(i){switch(i.label){case 0:t="",e.forEach((function(e){t+=e+","})),n=window.Xrm.Utility.getGlobalContext().organizationSettings,a="?$select="+t,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",n.organizationId,a)];case 2:return[2,i.sent()];case 3:return r=i.sent(),console.error(r),[2,!1];case 4:return[2]}}))}))},e.updateRecordWithSpinner=function(e,t,n){var a=new Map;a.set("EnityName",e),a.set("Id",t),a.set("data",n),window.Xrm.Utility.showProgressIndicator(u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_Processing)),window.Xrm.WebApi.updateRecord(e,t,n).then((function(){window.Xrm.Utility.closeProgressIndicator(),window.Xrm.UI.addGlobalNotification(1,1,u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_ToastMessage_Success),"",null),a.set("UpdateStatus","successful"),p.logInfo("SalesAdminSettings","SalesAdminSettings.EntityUpdateStatus",a)}),(function(e){window.Xrm.Utility.closeProgressIndicator(),window.Xrm.UI.addGlobalNotification(1,2,u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_ToastMessage_Failure),"",null),a.set("UpdateStatus","Failed"),a.set("ErrorMessage",e),p.logError("SalesAdminSettings",e,"SalesAdminSettings.EntityUpdateStatus",a)}))},e.updateRecord=function(e,t,n,r){return a(this,void 0,void 0,(function(){var a,s,o;return i(this,(function(i){switch(i.label){case 0:if((a=new Map).set("EnityName",e),a.set("Id",t),a.set("data",n),!r)return[3,5];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,window.Xrm.WebApi.updateRecord(e,t,n)];case 2:return i.sent(),window.Xrm.Utility.closeProgressIndicator(),window.Xrm.UI.addGlobalNotification(1,1,u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_ToastMessage_Success),"",null),a.set("UpdateStatus","successful"),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EntityUpdateStatus",a),[3,4];case 3:return s=i.sent(),window.Xrm.Utility.closeProgressIndicator(),window.Xrm.UI.addGlobalNotification(1,2,u.GlobalLocalizedStringsProvider.GetString(g.STRING_KEYS.Label_ToastMessage_Failure),"",null),a.set("UpdateStatus","Failed"),a.set("ErrorMessage",s.message),p.logError("SalesAdminSettings.PDF2020Wave2Updates",s,"SalesAdminSettings.EntityUpdateStatus",a),[3,4];case 4:return[3,8];case 5:return i.trys.push([5,7,,8]),[4,window.Xrm.WebApi.updateRecord(e,t,n)];case 6:return i.sent(),a.set("UpdateStatus","successful"),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EntityUpdateStatus",a),[3,8];case 7:return o=i.sent(),a.set("UpdateStatus","Failed"),a.set("ErrorMessage",o),p.logError("SalesAdminSettings.PDF2020Wave2Updates",o,"SalesAdminSettings.EntityUpdateStatus",a),[3,8];case 8:return[2]}}))}))},e.SetQualifyLeadExperience=function(t){var n=new Map;if(n.set("Setting","QualifyLeadExperience"),n.set("NewStatus",t),p.logInfo("SalesAdminSettings","SalesAdminSettings.SettingRequest",n),e.isXrmEnabled()){var a={},i='{"DefaultQualifyFlow":"'+String(t)+'"}';a.qualifyleadadditionaloptions=i;var r=window.Xrm.Utility.getGlobalContext().organizationSettings;e.updateRecordWithSpinner("organization",r.organizationId,a)}},e.SetBusinessCardOptions=function(t){if(e.isXrmEnabled()){var n={},a='{"StoreBusinessCardImage":"'+String(t)+'"}';n.businesscardoptions=a;var i=window.Xrm.Utility.getGlobalContext().organizationSettings;e.updateRecordWithSpinner("organization",i.organizationId,n)}},e.SetPDFSettings=function(){return a(this,void 0,void 0,(function(){var t,n,a;return i(this,(function(i){switch(i.label){case 0:return e.isXrmEnabled()?(t={},r.store.getState().salesSettings.pdf_settings.forEach((function(e,n){t[n]=e})),n=window.Xrm.Utility.getGlobalContext().organizationSettings,[4,e.updateRecord("organization",n.organizationId,(a={},a.ispdfgenerationenabled=JSON.stringify(t),a),!0)]):[3,3];case 1:return i.sent(),[4,e.MigrateExistingPDFSettingsToNewPDFSettingEntity()];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},e.SetEnhancePDFSettings=function(){return a(this,void 0,void 0,(function(){var t,n;return i(this,(function(a){switch(a.label){case 0:return e.isXrmEnabled()?(t={},r.store.getState().salesSettings.pdf_entities.forEach((function(e,n){!0===e.currentValue&&(t[n]=e.currentValue)})),[4,e.updateRecord("pdfsetting",m,(n={},n.pdfsettingsjson=JSON.stringify(t),n),!0)]):[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},e.IsFCBEnabled=function(e){return window.Xrm.Internal.isFeatureEnabled(e)},e.EnableSharePoint=function(){return a(this,void 0,void 0,(function(){var t,n;return i(this,(function(a){switch(a.label){case 0:return e.isXrmEnabled()?(t=new s.EnableSharePointRequest,[4,window.Xrm.WebApi.online.execute(t)]):[3,2];case 1:return n=a.sent(),[2,n.OperationResult];case 2:return[2,!1]}}))}))},e.EnableMSTeamsDocumentManagement=function(t){return a(this,void 0,void 0,(function(){var n,a,s,l,c,d;return i(this,(function(i){switch(i.label){case 0:if(!e.isXrmEnabled())return[3,2];for(n=[],a=0,s=t;a<s.length;a++)l=s[a],r.store.getState().salesSettings.entityList.indexOf(l)>-1&&n.push(l);return c=new o.EnableMSTeamsDocumentManagementRequest(!0,JSON.stringify(n)),[4,window.Xrm.WebApi.online.execute(c)];case 1:return d=i.sent(),[2,d.OperationResult];case 2:return[2,!1]}}))}))},e.isUCI=function(){var e=window.Xrm;return e&&e.Internal&&e.Internal.isUci()},e.parseStateAndLogForEnhancePDFAdminSettings=function(t,n){var a=new Map;if(e.IsFCBEnabled("October2020Update")&&e.IsFCBEnabled("EnhancedPDFAdminSettings")){var i=0,r=0;t.info.forEach((function(e,t){r++,e.isEnabled!==e.currentValue&&(i++,a.set("settingName",t),a.set("settingValue",e.currentValue),a.set("ChangeTracking","true"),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates",n,a))})),(a=new Map).set("UpdatedCount",i),a.set("TotalCount",r),p.logInfo("SalesAdminSettings.PDF2020Wave2Updates","No. of pdfsetting entities updated out of total number of entities available on Enhance PDFSetting page",a)}},e.parseStateAndLog=function(e,t){for(var n in e){var a="";if(e[n].isChanged){a=e[n].currentValue;var i=new Map;i.set("settingName",n),i.set("settingValue",a),i.set("ChangeTracking","true"),p.logInfo("SalesAdminSettings",t,i)}}},e.parseStateMapAndLog=function(e,t){for(var n in e){var a="";if(e.get(n).isChanged){a=e.get(n).currentValue;var i=new Map;i.set("settingName",n),i.set("settingValue",a),i.set("ChangeTracking","true"),p.logInfo("SalesAdminSettings",t,i)}}},e.isSolutionInstalled=function(e){return a(this,void 0,void 0,(function(){var t,n,a;return i(this,(function(i){switch(i.label){case 0:t=new Map,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Xrm.WebApi.online.retrieveMultipleRecords("solution","?$select=uniquename&$filter=uniquename eq '"+e+"'")];case 2:return n=i.sent(),t.set("RetrieveIsSolutionInstalledInfo","successful"),p.logInfo("SalesAdminSettings","SalesAdminSettings.isSolutionInstalled",t),null!=n&&null!=n.entities&&n.entities.length>0?[2,!0]:[3,4];case 3:return a=i.sent(),t.set("RetrieveIsSolutionInstalledInfo","Failed"),t.set("ErrorMessage",a),p.logError("SalesAdminSettings",a,"Exception occurred trying to retrieve solution '"+e+"' installed on CRM org",t),[2,!1];case 4:return[2,!1]}}))}))},e.GetCurrentUserDomainName=function(){return a(this,void 0,void 0,(function(){var e,t,n,a,r;return i(this,(function(i){switch(i.label){case 0:e=window.Xrm.Utility.getGlobalContext().userSettings,t="",n=e.userId,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Xrm.WebApi.online.retrieveMultipleRecords("systemuser","?$select=domainname&$filter=systemuserid eq '"+n+"'")];case 2:return null!=(a=i.sent())&&null!=a.entities&&(t=a.entities[0].domainname),[3,4];case 3:return r=i.sent(),p.logError("GetCurrentUserDomainName",r,"Exception occurred while trying to retrieve domainName of logged-in user."),[3,4];case 4:return[2,t]}}))}))},e}();t.XrmHelper=_},48:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(31),i=n(32),r=function(){function e(){}return e.isCrmUrlNavigationEnabled=function(){return null!=window.Xrm},e.navigateWithParams=function(e){var t={pageType:"control",controlName:"MscrmControls.FieldControls.CCFadminsettings",data:e};window.Xrm.Utility.showProgressIndicator(a.GlobalLocalizedStringsProvider.GetString(i.STRING_KEYS.Label_Processing)),window.Xrm.Navigation.navigateTo(t,{target:1}).then((function(){window.Xrm.Utility.closeProgressIndicator()}),(function(){window.Xrm.Utility.closeProgressIndicator()}))},e}();t.CrmNavigationHelpers=r},49:function(e,t,n){var a=n(441);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(210)(a,i);a.locals&&(e.exports=a.locals)},524:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(44),d=l(n(0)),u=n(38),g=n(41),p=n(37);n(49);var S=n(54),f=n(46),m=n(44),_=n(53),h=n(31),b=n(32),v=n(48),y=n(42),C=n(81);u.initializeIcons();var I=function(e){function t(t){var n=e.call(this,t)||this;return n._root=d.default.createRef(),n._items=[],n._groups=[],n.handle_basic_pdfsettings=function(e,t){console.log("handle_basic_pdfsettings >>")},n._onRenderColumn=n._onRenderColumn.bind(n),n.handle_pdf=n.handle_pdf.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.addItems=n.addItems.bind(n),n.state={accountPdfSetting:{isChanged:!1,currentValue:!1},contactPdfSetting:{isChanged:!1,currentValue:!1},leadPdfSetting:{isChanged:!1,currentValue:!1},opportunityPdfSetting:{isChanged:!1,currentValue:!1},quotePdfSetting:{isChanged:!1,currentValue:!1},salesorderPdfSetting:{isChanged:!1,currentValue:!1},invoicePdfSetting:{isChanged:!1,currentValue:!1}},n.addItems(),n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return i(t,e),t.prototype.addItems=function(){this._items=[],this._items.push({key:"account",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("account"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"contact",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("contact"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"lead",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("lead"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"opportunity",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("opportunity"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"quote",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("quote"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"salesorder",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("salesorder"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"invoice",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("invoice"),description:"",featurekey:"",onchangehandler:this.handle_pdf})},t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,f.XrmHelper.LoadSalesSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.addItems(),this.setState({accountPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("account")},contactPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("contact")},leadPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("lead")},opportunityPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("opportunity")},quotePdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("quote")},salesorderPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("order")},invoicePdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("invoice")}}),this.pageHeader.focus(),(e=new Map).set("Page","pdf_generation"),e.set("Status","Loaded"),y.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",e),[2]}}))}))},t.prototype.handle_pdf=function(e,n){var a=e.currentTarget.id;switch(a){case"account":this.state.accountPdfSetting.isChanged=!this.state.accountPdfSetting.isChanged,this.state.accountPdfSetting.currentValue=n,t.SetCurrentState(a,n),this.setState({accountPdfSetting:{isChanged:this.state.accountPdfSetting.isChanged,currentValue:this.state.accountPdfSetting.currentValue}});break;case"contact":this.state.contactPdfSetting.isChanged=!this.state.contactPdfSetting.isChanged,this.state.contactPdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({contactPdfSetting:{isChanged:this.state.contactPdfSetting.isChanged,currentValue:this.state.contactPdfSetting.currentValue}});break;case"lead":this.state.leadPdfSetting.isChanged=!this.state.leadPdfSetting.isChanged,this.state.leadPdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({leadPdfSetting:{isChanged:this.state.leadPdfSetting.isChanged,currentValue:this.state.leadPdfSetting.currentValue}});break;case"opportunity":this.state.opportunityPdfSetting.isChanged=!this.state.opportunityPdfSetting.isChanged,this.state.opportunityPdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({opportunityPdfSetting:{isChanged:this.state.opportunityPdfSetting.isChanged,currentValue:this.state.opportunityPdfSetting.currentValue}});break;case"quote":this.state.quotePdfSetting.isChanged=!this.state.quotePdfSetting.isChanged,this.state.quotePdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({opportunityPdfSetting:{isChanged:this.state.opportunityPdfSetting.isChanged,currentValue:this.state.opportunityPdfSetting.currentValue}});break;case"salesorder":this.state.salesorderPdfSetting.isChanged=!this.state.salesorderPdfSetting.isChanged,this.state.salesorderPdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({salesorderPdfSetting:{isChanged:this.state.salesorderPdfSetting.isChanged,currentValue:this.state.salesorderPdfSetting.currentValue}});break;case"invoice":this.state.invoicePdfSetting.isChanged=!this.state.invoicePdfSetting.isChanged,this.state.invoicePdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({invoicePdfSetting:{isChanged:this.state.invoicePdfSetting.isChanged,currentValue:this.state.invoicePdfSetting.currentValue}})}console.log("handle_pdf >>"),console.log("handle_pdf <<")},t.GetCurrentState=function(e){if(console.log("PDFSettingsApp::GetCurrentState() >>"),g.store.getState().salesSettings.pdf_settings.has(e)){var t=g.store.getState().salesSettings.pdf_settings.get(e);return null!=t&&t}return!1},t.SetCurrentState=function(e,t){console.log("PDFSettingsApp::SetCurrentState() >>"),g.store.getState().salesSettings.pdf_settings.set(e,t)},t.prototype.render=function(){var e=this,t=this.state.accountPdfSetting.isChanged||this.state.contactPdfSetting.isChanged||this.state.invoicePdfSetting.isChanged||this.state.leadPdfSetting.isChanged||this.state.opportunityPdfSetting.isChanged||this.state.quotePdfSetting.isChanged||this.state.salesorderPdfSetting.isChanged;return d.default.createElement("div",{className:"menuRowDIVStyle"},d.default.createElement(C.ConnectedNavigationSettingsApp,{crmDataAccess:this.props.crmDataAccess,currentSelectedId:"pdf_generation",tabItems:this.props.tabItems}),d.default.createElement("div",{className:"PdfManagePageAppContainer"},d.default.createElement("div",{className:"SettingsApp"},d.default.createElement("div",{className:"pageHeader"},d.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0,title:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_ConvertPDF)},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_ConvertPDF))),d.default.createElement("div",{className:"ManagePageTitle"}),d.default.createElement("div",{className:"ManagePageExplain"},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_ConvertPDFManage)),d.default.createElement("div",{className:"ManageDetailsListStyle DetailsListHeight"},d.default.createElement(m.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:_.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),d.default.createElement(c.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},d.default.createElement(c.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}))))))},t.prototype._onSaveAction=function(){(this.state.accountPdfSetting.isChanged||this.state.contactPdfSetting.isChanged||this.state.leadPdfSetting.isChanged||this.state.opportunityPdfSetting.isChanged||this.state.quotePdfSetting.isChanged||this.state.salesorderPdfSetting.isChanged||this.state.invoicePdfSetting.isChanged)&&(f.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.PDFGeneration"),f.XrmHelper.SetPDFSettings(),this.state.accountPdfSetting.isChanged=!1,this.state.contactPdfSetting.isChanged=!1,this.state.leadPdfSetting.isChanged=!1,this.state.opportunityPdfSetting.isChanged=!1,this.state.salesorderPdfSetting.isChanged=!1,this.state.invoicePdfSetting.isChanged=!1,this.setState({accountPdfSetting:{isChanged:!1,currentValue:this.state.accountPdfSetting.currentValue}}),this.setState({contactPdfSetting:{isChanged:!1,currentValue:this.state.contactPdfSetting.currentValue}}),this.setState({leadPdfSetting:{isChanged:!1,currentValue:this.state.leadPdfSetting.currentValue}}),this.setState({opportunityPdfSetting:{isChanged:!1,currentValue:this.state.opportunityPdfSetting.currentValue}}),this.setState({salesorderPdfSetting:{isChanged:!1,currentValue:this.state.salesorderPdfSetting.currentValue}}),this.setState({invoicePdfSetting:{isChanged:!1,currentValue:this.state.invoicePdfSetting.currentValue}}))},t.prototype._onCancelAction=function(){v.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._onRenderColumn=function(e,n,a){return console.log("_onRenderColumn >>"),d.default.createElement("div",{className:"TableItems"},d.default.createElement("div",{className:"GroupItemDescTable"},d.default.createElement("span",{className:"PDFGroupItemDescription"},e.name),d.default.createElement(c.Toggle,{id:e.key,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Enabled),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Disabled),defaultChecked:t.GetCurrentState(e.key),onChange:e.onchangehandler})))},t.prototype._onRenderRow=function(e){return d.default.createElement(m.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return d.default.createElement(m.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(d.default.Component);t.default=I;t.ConnectedPDFSettingsApp=p.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:S.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(I)},525:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(44),d=l(n(0)),u=n(38),g=n(41),p=n(37);n(49);var S=n(54),f=n(46),m=n(44),_=n(53),h=n(31),b=n(32),v=n(48),y=n(42),C=n(284),I=n(91),E=n(92),P=n(81);u.initializeIcons();var w={label:{fontWeight:"600"}},L={root:{selectors:{"& .ms-Label":{fontWeight:"600"}}}},T=function(e){function t(t){var n=e.call(this,t)||this;n._detailsList=d.default.createRef(),n._entities=[],n._filteredEntities=[],n.showOnlyEnabledHandler=function(e,t){var a=new Map;a.set("Page","enhance_pdf_generation"),a.set("ToggleSwitchToShowOnlyEnabledEntities","Show Only Enabled Entities");try{n._showOnlyEnabledEntities=!0===t,n.populateDetailsList(),a.set("Success","Successfully rendered list of enabled entities on Toggle On and rendered full list on toggle off"),y.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.ToggleSwitchToShowOnlyEnabledEntities",a)}catch(e){a.set("Error","ShowOnlyEnabledEntities toggle click is failing with "+e),y.logError("SalesAdminSettings.PDF2020Wave2Updates",e,"SalesAdminSettings.EnhancePDFSetting.ToggleSwitchToShowOnlyEnabledEntities",a)}},n.handleFilter=function(e,t){void 0===t&&(t=""),n._filterText=t,n.populateDetailsList()},n._onColumnClick=function(e,t){var a=new Map;a.set("Page","enhance_pdf_generation"),a.set("Sort","Sort 'Entity Name' in Descending & Ascending on column click");try{var i=n._columns.slice(),r=i.filter((function(e){return t.key===e.key}))[0];i.forEach((function(e){e===r?(r.isSortedDescending=!r.isSortedDescending,r.isSorted=!0):(e.isSorted=!1,e.isSortedDescending=!0)})),n._isSortedAscending=!n._isSortedAscending,n.populateDetailsList(),a.set("Success","Successfully sorted PDF Setting entity list in Descending & Acsending order on 'Entity Name' column click"),y.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.SortEntityName",a)}catch(e){a.set("Error","Sorting PDF Setting entities on 'Entity Name' column click is failing with "+e),y.logError("SalesAdminSettings.PDF2020Wave2Updates",e,"SalesAdminSettings.EnhancePDFSetting.SortEntityName",a)}},n._onRenderColumn=n._onRenderColumn.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.addEntities=n.addEntities.bind(n),n.state={info:new Map},n._selection=new m.Selection({selectionMode:_.SelectionMode.multiple,onSelectionChanged:function(){n.selectionHandler()}}),n._hideCancel=!1;var a=n;return n.IsSalesProApp().then((function(e){a._hideCancel=e}),(function(e){a._hideCancel=!1})),n._setSelectionHelper=!1,n._showOnlyEnabledEntities=!1,n._filterText="",n._isSortedAscending=!0,n.addEntities(),n._columns=[{key:"name",name:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Settings_Label_Column_EntityName),fieldName:"name",minWidth:100,maxWidth:200,isResizable:!1,headerClassName:"headerClass",isSorted:!0,isSortedDescending:!1,sortAscendingAriaLabel:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_SortAscending),sortDescendingAriaLabel:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_SortDescending),onColumnClick:n._onColumnClick,data:"string",isPadded:!0}],n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e;return o(this,(function(t){return this.initializePdfDataForControl(),this.pageHeader.focus(),(e=new Map).set("Page","enhance_pdf_generation"),e.set("Status","Loaded"),y.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.PageLoadStatus",e),[2]}))}))},t.prototype.render=function(){var e=this;d.default.createElement(m.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction});return this._hideCancel&&d.default.createElement(m.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction,className:"HideCancelButton"}),d.default.createElement("div",{className:"menuRowDIVStyle"},d.default.createElement(P.ConnectedNavigationSettingsApp,{crmDataAccess:this.props.crmDataAccess,currentSelectedId:"enhance_pdf_generation",tabItems:this.props.tabItems}),d.default.createElement("div",{className:"SettingsAppContainer"},d.default.createElement("div",null,I.SalesPremiumNotification(h.GlobalLocalizedStringsProvider.getStringProvider(),!1,new E.NotificationLogger)),d.default.createElement("div",{className:"SettingsApp"},d.default.createElement("div",{className:"pageHeader"},d.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0,title:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_ConvertPDF)},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_ConvertPDF))),d.default.createElement("div",{className:"ManagePageTitle"}),d.default.createElement("div",{className:"ManagePageExplain"},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_ConvertPDFManage)),d.default.createElement("div",{className:"ManagePdfFlexControl"},d.default.createElement(c.Toggle,{className:"ToggleAndFilterControl",label:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_ShowOnlyEnabledEntitiesToggle),ariaLabel:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_ShowOnlyEnabledEntitiesToggle),defaultChecked:!1,onChange:this.showOnlyEnabledHandler,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),styles:w}),d.default.createElement(c.TextField,{className:"ToggleAndFilterControl",label:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_FilterByEntityName),ariaLabel:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_FilterByEntityName),onChange:this.handleFilter,styles:L})),d.default.createElement("div",{className:"ManagePdfDetaillistScrollablePane","data-is-scrollable":"true"},d.default.createElement(m.DetailsList,{key:Date.now(),componentRef:this._detailsList,items:this._filteredEntities,columns:this._columns,isHeaderVisible:!0,selection:this._selection,setKey:"set",selectionMode:_.SelectionMode.multiple,selectionPreservedOnEmptyClick:!0,selectionZoneProps:{selection:this._selection,isSelectedOnFocus:!1},onRenderCheckbox:this._onRenderCheckbox,checkboxVisibility:c.CheckboxVisibility.always,layoutMode:c.DetailsListLayoutMode.justified,ariaLabelForSelectAllCheckbox:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_SelectAllCheckbox),ariaLabelForSelectionColumn:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_SelectionColumn),checkButtonAriaLabel:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_CheckButton),onRenderItemColumn:this._onRenderColumn,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader})),d.default.createElement("div",null,d.default.createElement(c.Sticky,{stickyPosition:c.StickyPositionType.Footer},d.default.createElement(c.Stack,{style:{paddingTop:"16px",paddingLeft:"0px",height:"32px",borderRadius:"2px",marginBottom:"96px"},horizontal:!0,tokens:{childrenGap:30}},d.default.createElement(c.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction})))))))},t.prototype.initializePdfDataForControl=function(){return s(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,f.XrmHelper.LoadEnhancePDFSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.addEntities(),e=this.getStateProps(),this.state={info:e},this.populateDetailsList(),this._setSelectionHelper=!1,this._showOnlyEnabledEntities=!1,this._filterText="",this._isSortedAscending=!0,[2]}}))}))},t.prototype.addEntities=function(){var e=this;this._entities=[],g.store.getState().salesSettings.pdf_entities.forEach((function(t,n){e._entities.push({key:n,name:t.displayName}),e._filteredEntities.push({key:n,name:t.displayName})}))},t.prototype.getStateProps=function(){var e=new Map;return g.store.getState().salesSettings.pdf_entities.forEach((function(t,n){e.set(n,r({},t,{isChanged:!1,currentValue:t.isEnabled}))})),e},t.prototype.populateDetailsList=function(){var e=this,t=new Map;t.set("Page","enhance_pdf_generation"),t.set("Module","Detaillist control"),t.set("Status","Rendered");try{var n=new m.Selection({selectionMode:_.SelectionMode.multiple,onSelectionChanged:function(){e.selectionHandler()}}),a=[];if(!0===this._showOnlyEnabledEntities){var i=[];g.store.getState().salesSettings.pdf_entities.forEach((function(e,t){!0===e.currentValue&&i.push({key:t,name:e.displayName})})),a=i}else a=this._entities;this._filteredEntities=this._filterText?a.filter((function(t){return t.name.toLowerCase().indexOf(e._filterText.toLocaleLowerCase())>-1})):a,this._filteredEntities=this._sortEntities(this._filteredEntities,"name",this._isSortedAscending),n.setItems(this._filteredEntities),this._setSelectionHelper=!0,n.getItems().forEach((function(e){g.store.getState().salesSettings.pdf_entities.has(e.key)&&n.setKeySelected(e.key,g.store.getState().salesSettings.pdf_entities.get(e.key).currentValue,!1)})),this._setSelectionHelper=!1,this._selection=n,this.setState(this.state),y.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.RenderDetaillistStatus",t)}catch(e){t.set("Error","Rendering detaillist control is failing with "+e),y.logError("SalesAdminSettings.PDF2020Wave2Updates",e,"SalesAdminSettings.EnhancePDFSetting.RenderDetaillist",t)}},t.prototype.selectionHandler=function(){var e=this;!this._setSelectionHelper&&this._selection.getItems().length>0&&this._selection.getItems().forEach((function(t){e.state.info.has(t.key)&&(e._selection.isKeySelected(t.key)?(e.state.info.get(t.key).currentValue=!0,g.store.getState().salesSettings.pdf_entities.get(t.key).currentValue=!0):(e.state.info.get(t.key).currentValue=!1,g.store.getState().salesSettings.pdf_entities.get(t.key).currentValue=!1))}))},t.GetCurrentState=function(e){return console.log("EnhancePDFSettingsApp::GetCurrentState() >>"),g.store.getState().salesSettings.pdf_entities.get(e).currentValue},t.SetCurrentState=function(e,t){console.log("EnhancePDFSettingsApp::SetCurrentState() >>"),g.store.getState().salesSettings.pdf_entities.get(e).currentValue=t},t.prototype.shouldEnableSave=function(){var e=!1;return g.store.getState().salesSettings.pdf_entities.forEach((function(t,n){if(t.isEnabled!==t.currentValue)return e=!0})),e},t.prototype.IsSalesProApp=function(){return s(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(a){switch(a.label){case 0:e=new Map,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Xrm.Utility.getGlobalContext().getCurrentAppProperties()];case 2:return t=a.sent(),C.isNullOrUndefined(t)?[2,!1]:C.isNullOrUndefined(t.uniqueName)||"msdynce_salespro"!=t.uniqueName.toLowerCase()?[2,!1]:[2,!0];case 3:return n=a.sent(),e.set("Method Name","EnhancePDFSettingsApp.IsSalesProApp"),e.set("Error","Unable to fetch app properties"+n.message),y.logError("SalesAdminSettings.PDF2020Wave2Updates",n,"SalesAdminSettings.EnhancePDFSetting.IsSalesProApp",e),[2,!1];case 4:return[2]}}))}))},t.prototype._onSaveAction=function(){return s(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:(e=new Map).set("Page","enhance_pdf_generation"),e.set("Save","Save PDF Settings"),n.label=1;case 1:return n.trys.push([1,5,,6]),this.shouldEnableSave()?(f.XrmHelper.parseStateAndLogForEnhancePDFAdminSettings(this.state,"SalesAdminSettings.EnhancePDFSetting"),[4,f.XrmHelper.SetEnhancePDFSettings()]):[3,3];case 2:return n.sent(),this.initializePdfDataForControl(),e.set("Success","Successfully saved PDF Settings"),y.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.Save",e),[3,4];case 3:window.Xrm.UI.addGlobalNotification(1,4,h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_ToastMessage_Information),"",null),y.logInfo("SalesAdminSettings.PDF2020Wave2Updates","Found no changes to save",e),n.label=4;case 4:return[3,6];case 5:return t=n.sent(),e.set("Error","Save PDF Setting chnages are failing with "+t),y.logError("SalesAdminSettings.PDF2020Wave2Updates",t,"SalesAdminSettings.EnhancePDFSetting.Save",e),[3,6];case 6:return[2]}}))}))},t.prototype._onCancelAction=function(){var e=new Map;e.set("Page","enhance_pdf_generation"),e.set("Cancel","Navigated to Overview");try{v.CrmNavigationHelpers.navigateWithParams({id:"overview"}),e.set("Success","Successfully Navigated to Overview page on Calcel button click"),y.logInfo("SalesAdminSettings.PDF2020Wave2Updates","SalesAdminSettings.EnhancePDFSetting.Cancel",e)}catch(t){e.set("Error","Navigate to overview page on Cancel button click is failing with "+t),y.logError("SalesAdminSettings.PDF2020Wave2Updates",t,"SalesAdminSettings.EnhancePDFSetting.Cancel",e)}},t.prototype._onRenderCheckbox=function(e){return d.default.createElement("div",{style:{pointerEvents:"none"}},d.default.createElement(c.Checkbox,{ariaLabel:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_Checkbox),checked:e.checked,defaultChecked:e.checked}))},t.prototype._onRenderColumn=function(e,t,n){return console.log("_onRenderColumn >>"),d.default.createElement("div",{className:"TableItems"},d.default.createElement("div",{className:"GroupItemDescTable"},d.default.createElement("span",{className:"PDFGroupItemDescription"},e.name)))},t.prototype._onRenderRow=function(e){return d.default.createElement(m.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"#F2F2F2;"},":focus":{background:"#F2F2F2;"},": focus: hover":{background:"#F2F2F2;"}}},cell:{paddingLeft:"0px"}},"data-selection-toggle":"true"}))},t.prototype._onRenderDetailsHeader=function(e){return d.default.createElement(m.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t.prototype._sortEntities=function(e,t,n){var a=t;return e.sort((function(e,t){return(n?e[a]>t[a]:e[a]<t[a])?1:-1}))},t}(d.default.Component);t.default=T;t.ConnectedEnhancePDFSettingsApp=p.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:S.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(T)},526:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(56),d=n(44),u=l(n(0)),g=n(38),p=n(41),S=n(37);n(49);var f=n(54),m=n(46),_=n(31),h=n(32),b=n(48),v=n(42),y=n(91),C=n(92),I=n(81);g.initializeIcons();var E=function(e){function t(t){var n=e.call(this,t)||this;return n._root=u.default.createRef(),n._items=[],n._groups=[],n._toggle=u.default.createRef(),n._onRenderGroupHeader=function(e){return u.default.createElement(c.GroupHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n.handle_ee=n.handle_ee.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={eeSettingStatus:{isChanged:!1,currentValue:!1,isFocused:!1}},n._items=[],n._items.push({key:"ee",name:"Enhanced Email",description:_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Setting_Label_EnhancedEmail),featurekey:"ee",onchangehandler:n.handle_ee}),n._groups=[{key:"g1",name:"Improve Productivity",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,m.XrmHelper.LoadSalesSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({eeSettingStatus:{isChanged:!1,currentValue:p.store.getState().salesSettings.is_contextual_email_enabled,isFocused:!1}}),this.pageHeader.focus(),(e=new Map).set("Page","enhanced_email"),e.set("Status","Loaded"),v.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",e),[2]}}))}))},t.prototype.componentDidUpdate=function(e,t,n){null!=this._toggle.current&&this._toggle.current.focus()},t.prototype.handle_ee=function(e,t){console.log("handle_ee >>"),console.log(t),this.state.eeSettingStatus.isChanged=!this.state.eeSettingStatus.isChanged,this.state.eeSettingStatus.currentValue=t,console.log("isChanged: "+this.state.eeSettingStatus.isChanged),console.log("currentValue: "+this.state.eeSettingStatus.currentValue),p.store.getState().salesSettings.is_contextual_email_enabled=t,this.setState({eeSettingStatus:{isChanged:this.state.eeSettingStatus.isChanged,currentValue:t,isFocused:!1}}),console.log("handle_ee <<")},t.GetCurrentState=function(e){return console.log("EESettingsApp::GetCurrentState() >>"),0==e.localeCompare("ee")&&p.store.getState().salesSettings.is_contextual_email_enabled},t.SetCurrentState=function(e,t){console.log("EESettingsApp::SetCurrentState() >>"),0==e.localeCompare("ee")&&(p.store.getState().salesSettings.is_contextual_email_enabled=t),console.log("EESettingsApp::SetCurrentState() <<")},t.prototype.render=function(){var e=this,t=this.state.eeSettingStatus.isChanged,n=p.store.getState().salesSettings;return u.default.createElement("div",{className:"menuRowDIVStyle"},u.default.createElement(I.ConnectedNavigationSettingsApp,{crmDataAccess:this.props.crmDataAccess,currentSelectedId:"enhanced_email",tabItems:this.props.tabItems}),u.default.createElement("div",{className:"ManagePageAppContainer"},u.default.createElement("div",null,y.SalesPremiumNotification(_.GlobalLocalizedStringsProvider.getStringProvider(),!1,new C.NotificationLogger)),u.default.createElement("div",{className:"SettingsApp"},u.default.createElement("div",{className:"pageHeader"},u.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},title:_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Setting_Title_EnhancedEmail)},_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Setting_Title_EnhancedEmail))),u.default.createElement("div",{className:"ManageDetailsListStyle DetailsListHeight"},u.default.createElement(d.Stack,{verticalAlign:"start"},u.default.createElement(d.Stack,{horizontal:!0},u.default.createElement(d.Stack,{style:{width:"48%"}},u.default.createElement("span",{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"20px",paddingTop:"2px",paddingRight:"30px",whiteSpace:"pre-wrap"}},_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Setting_Label_EnhancedEmail)),u.default.createElement("span",{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"20px",paddingTop:"2px",paddingRight:"30px",whiteSpace:"pre-wrap"}},_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Setting_Label_Info_EnhancedEmail))),u.default.createElement(d.Toggle,{className:"ToggleButton",inlineLabel:!0,onText:_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_Yes),checked:null!=n&&n.is_contextual_email_enabled,componentRef:this._toggle,onChange:function(t,n){null==n&&(n=!0),e.handle_ee(t,n)},ariaLabel:_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Setting_Title_EnhancedEmail)})),u.default.createElement(d.Stack,{styles:{root:{paddingTop:"5%",height:"32px",borderRadius:"2px"}},horizontal:!0,tokens:{childrenGap:20}},u.default.createElement(d.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t})))))))},t.prototype._onSaveAction=function(){this.state.eeSettingStatus.isChanged&&(m.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.EnhancedEmail"),m.XrmHelper.SetProperty("organization",m.XrmHelper.getOrganizationId(),"iscontextualemailenabled",this.state.eeSettingStatus.currentValue),this.state.eeSettingStatus.isChanged=!1,this.setState({eeSettingStatus:{isChanged:!1,currentValue:this.state.eeSettingStatus.currentValue,isFocused:!0}}))},t.prototype._onCancelAction=function(){b.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"ee":this.state.eeSettingStatus.currentValue=t}},t.prototype._onRenderRow=function(e){return u.default.createElement(d.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return u.default.createElement(d.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(u.default.Component);t.default=E;t.ConnectedEESettingsApp=S.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:f.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(E)},527:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(22),d=n(95),u=n(2),g=n(56),p=n(53),S=n(44),f=l(n(0)),m=n(38),_=n(41),h=n(37);n(49);var b,v=n(54),y=n(46),C=n(31),I=n(32),E=n(48),P=n(42),w=n(91),L=n(92);m.initializeIcons(),function(e){e[e.Denied=1]="Denied",e[e.Canceled=2]="Canceled",e[e.Error=3]="Error",e[e.SolutionIsMissingErrorMessage=4]="SolutionIsMissingErrorMessage",e[e.EnableBasicSettingToViewChannelMessage=5]="EnableBasicSettingToViewChannelMessage",e[e.ClosedByAnotherPopUp=6]="ClosedByAnotherPopUp"}(b||(b={}));var T="msdyn_msteamssettingsv2",G="msdyn_embedcollabserviceurl",A="msdyn_tabserviceurl",x={hostUrl:"https://collabvnextweeklyservice.azurewebsites.net",servicePath:"Home/CollabConsentStart?ConsentType=CollabV2AdminGraphConsent"},N={hostUrl:"https://msteamstabintegration.crm.dynamics.com",servicePath:"Home/CollabConsentStart?ConsentType=CollabGraphConsent"},D={hostUrl:"https://msteamstabintegration.crm.dynamics.com",servicePath:"Home/CollabConsentStart?ConsentType=CollabSensitivityAdminGraphConsent"},k="basic_teams_int",R="adv_teams_int",M="sensitivity_teams_int",F="embedcollab_teams_int",O="teams_embed_default_chat_title",z="EnhancedTeamsIntegration",U="SensitivityTeamsIntegration",V="EmbedCollabTeamsIntegration",H=function(e){function t(t){var n=e.call(this,t)||this;return n._root=f.default.createRef(),n._items=[],n._groups=[],n._labelId=u.getId("dialogLabel"),n._subTextId=u.getId("subTextLabel"),n._dragOptions={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:d.ContextualMenu},n.clientUrl=window.Xrm.Utility.getGlobalContext().getClientUrl(),n.userDomainName="",n.SetConsentServiceUrl=function(){return s(n,void 0,void 0,(function(){var e,t,n;return o(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.msteamsSettingsEntities];case 1:return null!=(e=a.sent())&&null!=e.entities&&e.entities.length>0&&(e.entities[0].msdyn_embedcollabserviceurl&&(x.hostUrl=e.entities[0].msdyn_embedcollabserviceurl),e.entities[0].msdyn_tabserviceurl&&((N.hostUrl=e.entities[0].msdyn_tabserviceurl)&&(D.hostUrl=e.entities[0].msdyn_tabserviceurl))),[3,3];case 2:return t=a.sent(),(n=new Map).set("GetConsentServiceUrl","Failed"),n.set("ErrorMessage",t),P.logError("SalesAdminSettings",t,"Unable to fetch service URL from server, Using default hardcoded serviceURL value",n),[3,3];case 3:return[2]}}))}))},n.handle_parent_child_depedency_onChange=function(e,t){!e.currentValue&&t.currentValue?(t.isDisabledByParentSetting=!0,t.isChanged=t.currentValue?!t.isChanged:t.isChanged,t.currentValue=!1):t.isDisabledByParentSetting&&e.currentValue&&(t.isDisabledByParentSetting=!1,t.currentValue||(t.isChanged=!t.isChanged),t.currentValue=!t.currentValue),n.setCurrentSettingStatus(t)},n.handleBasicTeamsInt=function(e,t){var a={isChanged:!n.state.basicTeamsSettingStatus.isChanged,currentValue:t};n.setState({basicTeamsSettingStatus:r({},a)}),_.store.getState().salesSettings.is_msteams_basic_enabled=t,n.handle_parent_child_depedency_onChange(a,n.state.advTeamsSettingStatus),n.handle_parent_child_depedency_onChange(n.state.advTeamsSettingStatus,n.state.sensitivityTeamsSettingStatus)},n.handleEmbedcollabTeamsInt=function(e,t){n.onChangeOfSettingsWithConsent(n.state.embedcollabTeamsSettingStatus,t)},n._closeDialogCancel=function(){n.setState({hideDialog:!0}),n.forceUpdate()},n._onRenderGroupHeader=function(e){return f.default.createElement(g.GroupHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"},expand:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.handleBasicTeamsInt=n.handleBasicTeamsInt.bind(n),n.handleAdvTeamsInt=n.handleAdvTeamsInt.bind(n),n.handleEmbedcollabTeamsInt=n.handleEmbedcollabTeamsInt.bind(n),n.handleSensitivityTeamsInt=n.handleSensitivityTeamsInt.bind(n),n.handleDefaultChatTitle=n.handleDefaultChatTitle.bind(n),n.sendConsentRequest=n.sendConsentRequest.bind(n),n.sendClearIntervalRequest=n.sendClearIntervalRequest.bind(n),n.listenConsentResponse=n.listenConsentResponse.bind(n),n.setTeamsIntSettingsProperty=n.setTeamsIntSettingsProperty.bind(n),n.setTeamsIntSettingsAppState=n.setTeamsIntSettingsAppState.bind(n),n.state={hideDialog:!0,isDraggable:!1,basicTeamsSettingStatus:{isChanged:!1,currentValue:!1},advTeamsSettingStatus:{settingName:z,isChanged:!1,currentValue:!1,isConsentGiven:!1,isConsentPopUpEnabled:!1,consentUrl:N},embedcollabTeamsSettingStatus:{settingName:V,isChanged:!1,currentValue:!1,isConsentGiven:!1,isConsentPopUpEnabled:!1,consentUrl:x},sensitivityTeamsSettingStatus:{settingName:U,isChanged:!1,currentValue:!1,isConsentGiven:!1,isConsentPopUpEnabled:!1,consentUrl:D},defaultChatTitleSettingStatus:{isChanged:!1,currentValue:!1}},n.msteamsSettingsEntities=window.Xrm.WebApi.retrieveMultipleRecords(T,"?$select="+G+","+A),n.msForwardLink="http://go.microsoft.com/fwlink/?linkid=",n._items=[],n._items.push({key:k,name:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Setting_Title_BasicTeamsInteg),description:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Setting_Label_BasicTeamsInteg),featurekey:k,learnmorelink:"2095632",onchangehandler:n.handleBasicTeamsInt}),n._items.push({key:R,name:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Setting_Title_AdvTeamsInteg),description:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_TeamsInteg_Enhanced),featurekey:R,learnmorelink:"2018009",onchangehandler:n.handleAdvTeamsInt}),n._items.push({key:M,name:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Setting_Title_SensitivityTeamsInteg),description:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Manage_Setting_TeamsInteg_Sensitivity),featurekey:M,learnmorelink:"",onchangehandler:n.handleSensitivityTeamsInt}),y.XrmHelper.IsFCBEnabled("EmbeddedCollaboration")&&(n._items.push({key:F,name:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Setting_Title_EmbedCollabTeamsInteg),description:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Setting_Label_EmbedCollabTeamsInteg),featurekey:F,learnmorelink:"",onchangehandler:n.handleEmbedcollabTeamsInt}),n._items.push({key:O,name:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Setting_Title_DefaultChatTitle),description:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Setting_Label_DefaultChatTitle),featurekey:O,learnmorelink:"",onchangehandler:n.handleDefaultChatTitle})),n._groups=[{key:"g1",name:"",startIndex:0,count:n._items.length}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e,n=this;return o(this,(function(a){switch(a.label){case 0:window.Xrm.Utility.showProgressIndicator(C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Processing)),a.label=1;case 1:return a.trys.push([1,4,,5]),y.XrmHelper.isXrmEnabled()?[4,y.XrmHelper.LoadCandI()]:[3,3];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:return a.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,5];case 5:return[4,Promise.all([y.XrmHelper.GetCurrentUserDomainName(),y.XrmHelper.isSolutionInstalled("msdyn_Collaboration"),this.SetConsentServiceUrl()]).then((function(e){n.userDomainName=e[0],t.isCollabSolutionInstalled=e[1]}))];case 6:return a.sent(),this.setState({basicTeamsSettingStatus:{isChanged:!1,currentValue:_.store.getState().salesSettings.is_msteams_basic_enabled},advTeamsSettingStatus:{settingName:z,isChanged:!1,currentValue:_.store.getState().salesSettings.is_msteams_advanced_enabled,isConsentGiven:this.state.advTeamsSettingStatus.isConsentGiven,isConsentPopUpEnabled:this.state.advTeamsSettingStatus.isConsentPopUpEnabled,consentUrl:N},embedcollabTeamsSettingStatus:{settingName:V,isChanged:!1,currentValue:_.store.getState().salesSettings.is_msteams_embedcollab_enabled,showMessage:this.GetMessage(),isConsentGiven:this.state.embedcollabTeamsSettingStatus.isConsentGiven,isConsentPopUpEnabled:this.state.embedcollabTeamsSettingStatus.isConsentPopUpEnabled,consentUrl:x},sensitivityTeamsSettingStatus:{settingName:U,isChanged:!1,currentValue:_.store.getState().salesSettings.is_msteams_sensitivityCollab_enabled,isConsentGiven:this.state.sensitivityTeamsSettingStatus.isConsentGiven,isConsentPopUpEnabled:this.state.sensitivityTeamsSettingStatus.isConsentPopUpEnabled,consentUrl:D},defaultChatTitleSettingStatus:{isChanged:!1,currentValue:_.store.getState().salesSettings.is_default_chat_title_record_name}}),this.pageHeader.focus(),y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.TeamsIntegration"),(e=new Map).set("Page","teams_int"),e.set("Status","Loaded"),P.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",e),window.Xrm.Utility.closeProgressIndicator(),[2]}}))}))},t.prototype.getConsentUrl=function(e){var t=e.hostUrl+"/"+e.servicePath;return this.userDomainName?t+"&LoginHint="+this.userDomainName:t},t.prototype.GetMessage=function(){return!t.isCollabSolutionInstalled&&y.XrmHelper.IsSystemAdministrator()?b.SolutionIsMissingErrorMessage:_.store.getState().salesSettings.is_msteams_basic_enabled||!_.store.getState().salesSettings.is_msteams_embedcollab_enabled||this.state.embedcollabTeamsSettingStatus.isChanged?void 0:b.EnableBasicSettingToViewChannelMessage},t.GetCurrentState=function(e){return 0==e.localeCompare(k)?_.store.getState().salesSettings.is_msteams_basic_enabled:0==e.localeCompare(R)?_.store.getState().salesSettings.is_msteams_advanced_enabled:0==e.localeCompare(F)?_.store.getState().salesSettings.is_msteams_embedcollab_enabled:0==e.localeCompare(M)?_.store.getState().salesSettings.is_msteams_sensitivityCollab_enabled:0==e.localeCompare(O)&&_.store.getState().salesSettings.is_default_chat_title_record_name},t.prototype.getCurrentSettingStatus=function(e){switch(e.settingName){case z:return this.state.advTeamsSettingStatus;case V:return this.state.embedcollabTeamsSettingStatus;case U:return this.state.sensitivityTeamsSettingStatus;default:return e}},t.prototype.setCurrentSettingStatus=function(e){switch(e.settingName){case z:_.store.getState().salesSettings.is_msteams_advanced_enabled=e.currentValue,this.setState({advTeamsSettingStatus:r({},e)});break;case V:_.store.getState().salesSettings.is_msteams_embedcollab_enabled=e.currentValue,this.setState({embedcollabTeamsSettingStatus:r({},e)});break;case U:_.store.getState().salesSettings.is_msteams_sensitivityCollab_enabled=e.currentValue,this.setState({sensitivityTeamsSettingStatus:r({},e)})}},t.prototype.disableOtherConsentPopups=function(e){var t;switch(e.settingName){case z:case U:!this.state.embedcollabTeamsSettingStatus.isConsentGiven&&this.state.embedcollabTeamsSettingStatus.isConsentPopUpEnabled&&(t=this.state.embedcollabTeamsSettingStatus);break;case V:!this.state.advTeamsSettingStatus.isConsentGiven&&this.state.advTeamsSettingStatus.isConsentPopUpEnabled&&(t=this.state.advTeamsSettingStatus),!this.state.sensitivityTeamsSettingStatus.isConsentGiven&&this.state.sensitivityTeamsSettingStatus.isConsentPopUpEnabled&&(t=this.state.sensitivityTeamsSettingStatus)}t&&(t.isConsentPopUpEnabled=!1,t.currentValue=!1,t.isChanged=!1,t.showMessage=b.ClosedByAnotherPopUp,this.setCurrentSettingStatus(t),this.sendClearIntervalRequest(t.settingName,t.consentUrl.hostUrl))},t.prototype.onChangeOfSettingsWithConsent=function(e,t){if(e.isChanged=!e.isChanged,e.currentValue=t,e.currentValue&&e.isChanged&&!e.isConsentGiven)e.isConsentPopUpEnabled=!0,this.setCurrentSettingStatus(e),this.disableOtherConsentPopups(e),this.sendConsentRequest(e.settingName,this.getConsentUrl(e.consentUrl),e.consentUrl.hostUrl),this.listenConsentResponse(e);else{this.setCurrentSettingStatus(e),this.sendClearIntervalRequest(e.settingName,e.consentUrl.hostUrl),y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings."+e.settingName);var n=new Map;n.set("Setting",e.settingName+" toggle change"),e.isDisabledByParentSetting&&n.set(e.settingName,e.settingName+"-setting set to OFF by user"),P.logInfo("SalesAdminSettings",e.settingName+" toggle-off",n)}},t.prototype.handleDefaultChatTitle=function(e,t){this.setState({defaultChatTitleSettingStatus:{isChanged:!this.state.defaultChatTitleSettingStatus.isChanged,currentValue:t}}),_.store.getState().salesSettings.is_default_chat_title_record_name=t},t.prototype.handleAdvTeamsInt=function(e,t){this.onChangeOfSettingsWithConsent(this.state.advTeamsSettingStatus,t),this.handle_parent_child_depedency_onChange(this.state.advTeamsSettingStatus,this.state.sensitivityTeamsSettingStatus)},t.prototype.handleSensitivityTeamsInt=function(e,t){this.onChangeOfSettingsWithConsent(this.state.sensitivityTeamsSettingStatus,t)},t.prototype.sendClearIntervalRequest=function(e,t){var n={messageType:"ClearIntervalRequest",targetOrigin:t},a=document.getElementById("consentIframe");y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings."+e);var i=new Map;i.set("ClearIntervalRequest","Sent"),P.logInfo("SalesAdminSettings","SalesAdminSettings."+e+"ClearInterval",i),a.contentWindow.postMessage(n)},t.prototype.sendConsentRequest=function(e,t,n){var a={messageType:"ConsentRequest",targetUrl:t,targetOrigin:n},i=document.getElementById("consentIframe");y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings."+e);var r=new Map;r.set("ConsentRequest","Sent"),P.logInfo("SalesAdminSettings","SalesAdminSettings."+e,r),i.contentWindow.postMessage(a,this.clientUrl)},t.prototype.listenConsentResponse=function(e){var t=this,n=function(a){if("ConsentResponse"==a.data.messageType&&a.data.message){var i=a.data.message;if(window.removeEventListener("message",n),e=t.getCurrentSettingStatus(e),"Accepted"==i)e.currentValue&&e.isConsentPopUpEnabled&&(e.isConsentGiven=!0,e.isConsentPopUpEnabled=!1,e.isChanged=!0,e.showMessage=void 0,t.setCurrentSettingStatus(e));else if(e.isChanged&&e.isConsentPopUpEnabled){var r="Denied"==i?b.Denied:"Canceled"==i?b.Canceled:b.Error;e.isChanged=!1,e.currentValue=!1,e.isDisabledByParentSetting=!1,e.showMessage=r,e.isConsentPopUpEnabled=!1,t.setCurrentSettingStatus(e)}y.XrmHelper.parseStateAndLog(t.state,"SalesAdminSettings."+e.settingName);var s=new Map;s.set("Setting",e.settingName+" setting toggle-ON"),s.set("ConsentResponse",i),P.logInfo("SalesAdminSettings",e.settingName+" ConsentResponse",s)}};window.addEventListener("message",n)},t.prototype.render=function(){var e=this,n=this.state,a=(n.hideDialog,n.isDraggable,this.state.basicTeamsSettingStatus.isChanged||this.state.advTeamsSettingStatus.isChanged||this.state.embedcollabTeamsSettingStatus.isChanged||this.state.sensitivityTeamsSettingStatus.isChanged||this.state.defaultChatTitleSettingStatus.isChanged);return(this.state.advTeamsSettingStatus.currentValue&&this.state.advTeamsSettingStatus.isConsentPopUpEnabled||this.state.embedcollabTeamsSettingStatus.currentValue&&this.state.embedcollabTeamsSettingStatus.isConsentPopUpEnabled||this.state.sensitivityTeamsSettingStatus.currentValue&&this.state.sensitivityTeamsSettingStatus.isConsentPopUpEnabled)&&(a=!1),f.default.createElement("div",{className:"TeamsIntegrationManagePageAppContainer"},f.default.createElement("div",null,w.SalesPremiumNotification(C.GlobalLocalizedStringsProvider.getStringProvider(),!1,new L.NotificationLogger)),f.default.createElement("div",{className:"SettingsApp"},f.default.createElement("div",{className:"pageHeader"},f.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0,title:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.GroupHeader_Chat_Collab)},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.GroupHeader_Chat_Collab)),f.default.createElement("div",null,f.default.createElement("div",{className:"SettingsAppDescription"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.GroupHeader_Chat_Collab_Sub))),f.default.createElement(S.Stack,{style:{paddingTop:"calc(3.5vh)"}})),f.default.createElement("div",{className:"ManageDetailsListStyle DetailsListHeight"},f.default.createElement(S.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!0,selectionMode:p.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),t.IsSettingEnabled("embedcollab_teams_int")||t.IsSettingEnabled("basic_teams_int")?f.default.createElement("iframe",{id:"consentIframe",height:"0%",width:"0%",src:this.clientUrl+"/WebResources/Sales/ControlWR/ConsentHandler/AADConsentHandler.htm",hidden:!0}):"",f.default.createElement(S.Stack,{style:{marginTop:"calc(1.2vh)",paddingTop:"calc(3.22vh)",height:"32px",borderRadius:"2px",borderTop:"1px solid #F4F4F4"},horizontal:!0,tokens:{childrenGap:20}},f.default.createElement(c.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!a}),f.default.createElement(S.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Cancel),onClick:this._onCancelActionT})))))},t.prototype._onSaveAction=function(){return s(this,void 0,void 0,(function(){var e,t,n,a,i;return o(this,(function(r){switch(r.label){case 0:if(e=[],t=!1,n=new Map,window.Xrm.Utility.showProgressIndicator(C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Processing)),!this.state.basicTeamsSettingStatus.isChanged)return[3,6];if(y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.TeamsIntegrationSettings"),this.setState({hideDialog:!0}),a=["account","annotation","appointment","businessunit","campaign","category","competitor","contact","email","incident","kbarticle","knowledgearticle","lead","opportunity","opportunityproduct","product","quote","salesorder","task","team","invoice","salesliterature","msdyn_agreement","msdyn_expense","msdyn_timegroup","msdyn_inventoryadjustment","msdyn_inventorytransfer","msdyn_project","msdyn_purchaseorder","msdyn_purchaseorderreceipt","msdyn_resourcerequest","msdyn_rma","msdyn_rmareceipt","msdyn_rtv","msdyn_workorder"],n.clear(),n.set("Setting","BasicTeamsIntegration OnSave action"),y.XrmHelper.IsFCBEnabled("SharePointS2S"))return[3,5];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,y.XrmHelper.EnableSharePoint()];case 2:return r.sent(),n.set("EnableSharepointStatus","successful"),[4,y.XrmHelper.EnableMSTeamsDocumentManagement(a)];case 3:return r.sent(),n.set("MSTeamsDocManagementStatus","successful"),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"ismsteamsenabled",val:this.state.basicTeamsSettingStatus.currentValue,telemetryParam:n}),[3,5];case 4:return i=r.sent(),window.Xrm.Utility.closeProgressIndicator(),n.set("EnableSharePointStatus OR MSTeamsDocManagementStatus","failed"),n.set("Error",i),P.logError("SalesAdminSettings",i,"SalesAdminSettings.TeamsIntegrationSetting",n),[3,5];case 5:!this.state.basicTeamsSettingStatus.currentValue&&this.state.advTeamsSettingStatus.currentValue&&(this.sendClearIntervalRequest(z,this.state.advTeamsSettingStatus.consentUrl.servicePath),n.set("Setting ","BasicTeamsIntegration toggle change"),n.set(z,"Enhanced teams setting set to OFF as basic-setting is toggled off by user"),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"ismsteamscollaborationenabled",val:!1,telemetryParam:n})),!this.state.basicTeamsSettingStatus.currentValue&&this.state.sensitivityTeamsSettingStatus.currentValue&&(this.sendClearIntervalRequest(this.state.sensitivityTeamsSettingStatus.settingName,D.servicePath),n.set("Setting ","BasicTeamsIntegration toggle change"),n.set(U,"Sensitivity teams setting set to OFF as basic-setting is toggled off by user"),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"enablesensitivitylabelsforteamscollab",val:!1,telemetryParam:n})),!this.state.basicTeamsSettingStatus.currentValue&&_.store.getState().salesSettings.is_msteams_embedcollab_enabled&&(this.state.embedcollabTeamsSettingStatus.showMessage=b.EnableBasicSettingToViewChannelMessage),t=!0,e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"ismsteamsenabled",val:this.state.basicTeamsSettingStatus.currentValue,telemetryParam:n}),r.label=6;case 6:return this.state.advTeamsSettingStatus.isChanged&&(y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings "+z),n.clear(),n.set("Setting",z+" OnSave action"),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"ismsteamscollaborationenabled",val:this.state.advTeamsSettingStatus.currentValue,telemetryParam:n}),!this.state.advTeamsSettingStatus.currentValue&&this.state.sensitivityTeamsSettingStatus.currentValue&&(this.sendClearIntervalRequest(this.state.sensitivityTeamsSettingStatus.settingName,D.servicePath),n.set("Setting ",z+" toggle change"),n.set(U,"Sensitivity teams setting set to OFF as Advance teams integration-setting is toggled off by user"),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"enablesensitivitylabelsforteamscollab",val:!1,telemetryParam:n}))),this.state.embedcollabTeamsSettingStatus.isChanged&&(y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings "+V),n.clear(),n.set("Setting",V+" OnSave action"),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"isembedteamscollabenabled",val:this.state.embedcollabTeamsSettingStatus.currentValue,telemetryParam:n}),t=!0),this.state.sensitivityTeamsSettingStatus.isChanged&&(y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings "+U),n.clear(),n.set("Setting",U+" OnSave action"),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"enablesensitivitylabelsforteamscollab",val:this.state.sensitivityTeamsSettingStatus.currentValue,telemetryParam:n})),this.state.defaultChatTitleSettingStatus.isChanged&&(y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings DefaultChatTitleSetting"),n.clear(),n.set("Setting","DefaultChatTitleSetting OnSave action"),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"defaultteamschattitlerecordname",val:this.state.defaultChatTitleSettingStatus.currentValue,telemetryParam:n}),e.push({entity:"organization",entityId:y.XrmHelper.getOrganizationId(),propertyName:"isembedteamscollabenabled",val:this.state.embedcollabTeamsSettingStatus.currentValue,telemetryParam:n})),[4,this.setTeamsIntSettingsProperty(e)];case 7:return r.sent(),window.Xrm.Utility.closeProgressIndicator(),t&&window&&window.location.reload(),[2]}}))}))},t.prototype.setProperty=function(e,t,n,a){return s(this,void 0,void 0,(function(){var i;return o(this,(function(r){switch(r.label){case 0:return y.XrmHelper.isXrmEnabled()?((i={})[n]=a,[4,y.XrmHelper.updateRecord(e,t,i,!1)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.setTeamsIntSettingsAppState=function(e,t,n){switch(e){case"ismsteamsenabled":this.setState({basicTeamsSettingStatus:{isChanged:!1,currentValue:t}}),_.store.getState().salesSettings.is_msteams_basic_enabled=t,_.store.getState().salesSettings.is_msteams_basic_enabled?n.set("Status","Basic-setting set to ON, saved successfully"):n.set("Status","Basic-setting set to OFF, saved successfully"),P.logInfo("SalesAdminSettings","BasicTeamsIntegration",n);break;case"isembedteamscollabenabled":this.setState({embedcollabTeamsSettingStatus:r({},this.state.embedcollabTeamsSettingStatus,{isChanged:!1,currentValue:t,isConsentGiven:!1,isConsentPopUpEnabled:!1})}),_.store.getState().salesSettings.is_msteams_embedcollab_enabled=t,_.store.getState().salesSettings.is_msteams_embedcollab_enabled?n.set("Status","Embed-setting set to ON, saved successfully"):n.set("Status","Embed-setting set to OFF, saved successfully"),P.logInfo("SalesAdminSettings",V,n);break;case"ismsteamscollaborationenabled":this.setState({advTeamsSettingStatus:r({},this.state.advTeamsSettingStatus,{isChanged:!1,currentValue:t,isDisabledByParentSetting:!1,isConsentGiven:!1,isConsentPopUpEnabled:!1})}),_.store.getState().salesSettings.is_msteams_advanced_enabled=t,_.store.getState().salesSettings.is_msteams_basic_enabled?n.set("Info","Basic-setting is ON"):n.set("Info","Basic-setting is OFF"),_.store.getState().salesSettings.is_msteams_advanced_enabled?n.set("Status","EnhancedTeamsIntegration-setting set to ON, saved successfully"):n.set("Status","EnhancedTeamsIntegration-setting set to OFF, saved successfully"),P.logInfo("SalesAdminSettings",z,n);break;case"enablesensitivitylabelsforteamscollab":this.setState({sensitivityTeamsSettingStatus:r({},this.state.sensitivityTeamsSettingStatus,{isChanged:!1,currentValue:t,isDisabledByParentSetting:!1,isConsentGiven:!1,isConsentPopUpEnabled:!1})}),_.store.getState().salesSettings.is_msteams_sensitivityCollab_enabled=t,_.store.getState().salesSettings.is_msteams_basic_enabled?n.set("Info","Basic-setting is ON"):n.set("Info","Basic-setting is OFF"),_.store.getState().salesSettings.is_msteams_advanced_enabled?n.set("Info","EnhancedTeamsIntegration-setting is ON"):n.set("Info","EnhancedTeamsIntegration-setting is OFF"),_.store.getState().salesSettings.is_msteams_sensitivityCollab_enabled?n.set("Status",U+"-setting set to ON, saved successfully"):n.set("Status",U+"-setting set to OFF, saved successfully"),P.logInfo("SalesAdminSettings",U,n);break;case"defaultteamschattitlerecordname":this.setState({defaultChatTitleSettingStatus:{isChanged:!1,currentValue:t}}),_.store.getState().salesSettings.is_default_chat_title_record_name=t,_.store.getState().salesSettings.is_default_chat_title_record_name?n.set("Status","DefaultChatTitle-setting set to ON, saved successfully"):n.set("Status","DefaultChatTitle-setting set to OFF, saved successfully"),P.logInfo("SalesAdminSettings","DefaultChatTitleSetting",n)}},t.prototype.setTeamsIntSettingsProperty=function(e){return s(this,void 0,void 0,(function(){var t,n,a,i,r;return o(this,(function(s){switch(s.label){case 0:y.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.TeamsIntegrationSettings"),(t=new Map).set("Setting","AdminSetting's SetProperty action"),s.label=1;case 1:s.trys.push([1,6,,7]),n=0,a=e,s.label=2;case 2:return n<a.length?(i=a[n],[4,this.setProperty(i.entity,i.entityId,i.propertyName,i.val)]):[3,5];case 3:s.sent(),this.setTeamsIntSettingsAppState(i.propertyName,i.val,i.telemetryParam),s.label=4;case 4:return n++,[3,2];case 5:return t.set("Status","Settings saved successfully"),P.logInfo("SalesAdminSettings.executeSetProperty","Save integration's settings in server.",t),[3,7];case 6:return r=s.sent(),t.set("Status","Unable to save settings."),P.logError("SalesAdminSettings.executeSetProperty",r,"Save integration's settings in server.",t),[3,7];case 7:return[2]}}))}))},t.prototype._onCancelActionT=function(){E.CrmNavigationHelpers.navigateWithParams({id:"overview"}),this.setState({advTeamsSettingStatus:r({},this.state.advTeamsSettingStatus,{isConsentGiven:!1}),embedcollabTeamsSettingStatus:r({},this.state.embedcollabTeamsSettingStatus,{isConsentGiven:!1}),sensitivityTeamsSettingStatus:r({},this.state.sensitivityTeamsSettingStatus,{isConsentGiven:!1})})},t.prototype._setCurrentValue=function(e,t){switch(e){case"basic_teams_int":this.state.basicTeamsSettingStatus.currentValue=t;break;case"adv_teams_int":this.state.advTeamsSettingStatus.currentValue=t;break;case"embedcollab_teams_int":this.state.embedcollabTeamsSettingStatus.currentValue=t;break;case"sensitivity_teams_int":this.state.sensitivityTeamsSettingStatus.currentValue=t}},t.GetErrorMessage=function(e,t){switch(t){case"Denied":return e==z?C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.AdvancedTeamsInteg_Consent_Denied):e==U?C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.SensitivityTeamsInteg_Consent_Denied):C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.EmbedCollabTeamsInteg_Consent_Denied);case"Canceled":return C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.EmbedCollabTeamsInteg_Consent_Canceled);case"Error":return C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.EmbedCollabTeamsInteg_Consent_Error);case"SolutionIsMissingErrorMessage":return C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.EmbedCollabTeamsInteg_SolutionIsMissingErrorMessage);case"EnableBasicSettingToViewChannelMessage":return C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.EmbedCollabTeamsInteg_EnableBasicSettingToViewChannelMessage);case"ClosedByAnotherPopUp":return C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.EmbedCollabTeamsInteg_ClosedByAnotherPopUp);default:return C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.EmbedCollabTeamsInteg_GenericErrorMessage)}},t.prototype._onRenderColumn=function(e,n,a){var i=this,s=e.key,o=t.GetCurrentState(s),l=t.IsSettingEnabled(s),c=e.description,d=[R,M,O].includes(s)?"SubGroupItemDescription":"TeamsIntGroupItemDescription",u=[R,M,O].includes(s)?"SubGroupItemName":"ManagePageDescription",g=function(e){switch(s){case"adv_teams_int":i.setState({advTeamsSettingStatus:r({},i.state.advTeamsSettingStatus,{showMessage:void 0})});break;case"sensitivity_teams_int":i.setState({sensitivityTeamsSettingStatus:r({},i.state.sensitivityTeamsSettingStatus,{showMessage:void 0})});break;case"embedcollab_teams_int":i.setState({embedcollabTeamsSettingStatus:r({},i.state.embedcollabTeamsSettingStatus,{showMessage:void 0})})}};if(0==s.localeCompare("embedcollab_teams_int")&&this.state.embedcollabTeamsSettingStatus.showMessage&&(e.message=t.GetErrorMessage(s,b[this.state.embedcollabTeamsSettingStatus.showMessage])),0==s.localeCompare("adv_teams_int")&&this.state.advTeamsSettingStatus.showMessage&&(e.message=t.GetErrorMessage(s,b[this.state.advTeamsSettingStatus.showMessage])),0==s.localeCompare("sensitivity_teams_int")){if(!1===t.IsSensitivityToggleOptionVisible(s))return;!0===this.state.advTeamsSettingStatus.isConsentPopUpEnabled&&(l=!1),this.state.sensitivityTeamsSettingStatus.showMessage&&(e.message=t.GetErrorMessage(s,b[this.state.sensitivityTeamsSettingStatus.showMessage]))}return 0===s.localeCompare("teams_embed_default_chat_title")&&!0===this.state.embedcollabTeamsSettingStatus.isConsentPopUpEnabled&&(l=!1),this._setCurrentValue(s,o),f.default.createElement("div",{className:"TableItems"},e.name&&f.default.createElement("div",{className:u},e.name,0==s.localeCompare("embedcollab_teams_int")&&this.state.embedcollabTeamsSettingStatus.showMessage&&f.default.createElement(S.MessageBar,{id:"messageBar","aria-live":"polite",role:"alert",messageBarType:S.MessageBarType.info,onDismiss:g,styles:t.messageBarDiv("SubGroupItemDescription"==d)},e.message),0==s.localeCompare("adv_teams_int")&&this.state.advTeamsSettingStatus.showMessage&&f.default.createElement(S.MessageBar,{id:"messageBar","aria-live":"polite",role:"alert",messageBarType:S.MessageBarType.info,onDismiss:g,styles:t.messageBarDiv("SubGroupItemDescription"==d)},e.message),0==s.localeCompare("sensitivity_teams_int")&&this.state.sensitivityTeamsSettingStatus.showMessage&&f.default.createElement(S.MessageBar,{id:"messageBar","aria-live":"polite",role:"alert",messageBarType:S.MessageBarType.info,onDismiss:g,styles:t.messageBarDiv("SubGroupItemDescription"==d)},e.message)),f.default.createElement("div",{className:"GroupItemDescTable"},f.default.createElement("span",{className:d},c,e.learnmorelink?f.default.createElement(S.Link,{style:{whiteSpace:"nowrap"},href:""+this.msForwardLink+e.learnmorelink,target:"_blank"},C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Learn_More)):f.default.createElement("span",null)),l?f.default.createElement(S.Toggle,{className:"ToggleButton",id:s,inlineLabel:!0,onText:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Yes),offText:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_No),defaultChecked:o,onChange:e.onchangehandler}):f.default.createElement(S.Toggle,{className:"ToggleButton",id:s,inlineLabel:!0,onText:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_Yes),offText:C.GlobalLocalizedStringsProvider.GetString(I.STRING_KEYS.Label_No),defaultChecked:o,disabled:!0,onChange:e.onchangehandler})))},t.IsSettingEnabled=function(e){return!(!y.XrmHelper.IsFCBEnabled("MSTeamsIntegration")||!y.XrmHelper.IsFCBEnabled("MSTeamsIntegrationSetting"))&&(!(0!=e.localeCompare(k)||!y.XrmHelper.IsSystemAdministrator())||(!!(0==e.localeCompare(R)&&y.XrmHelper.IsSystemAdministrator()&&y.XrmHelper.IsFCBEnabled("MSTeamsCollaborationPreview")&&y.XrmHelper.IsFCBEnabled("October2019Update")&&_.store.getState().salesSettings.is_msteams_basic_enabled)||(!!(0==e.localeCompare(M)&&y.XrmHelper.IsSystemAdministrator()&&y.XrmHelper.IsFCBEnabled("MSTeamsPrivateTeam")&&y.XrmHelper.IsFCBEnabled("October2019Update")&&_.store.getState().salesSettings.is_msteams_advanced_enabled)||(!!(0==e.localeCompare(F)&&y.XrmHelper.IsSystemAdministrator()&&y.XrmHelper.IsFCBEnabled("EmbeddedCollaboration")&&t.isCollabSolutionInstalled)||!(0!=e.localeCompare(O)||!t.isCollabSolutionInstalled||!_.store.getState().salesSettings.is_msteams_embedcollab_enabled)))))},t.prototype._onRenderRow=function(e){return f.default.createElement(S.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return f.default.createElement(S.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.IsSensitivityToggleOptionVisible=function(e){return!!y.XrmHelper.IsFCBEnabled("MSTeamsPrivateTeam")},t.messageBarDiv=function(e){return e?{root:{backgroundColor:"transparent"},innerText:{width:"calc(40vw + 38px)",color:"#A80000",fontSize:"12px",fontFamily:"Segoe UI"},icon:{color:"#A80000"},dismissal:{position:"fixed",right:0}}:{root:{backgroundColor:"transparent"},innerText:{width:"calc(40vw)",color:"#A80000",fontSize:"12px",fontFamily:"Segoe UI"},icon:{color:"#A80000"},dismissal:{position:"fixed",right:0}}},t.isCollabSolutionInstalled=!1,t}(f.default.Component);t.default=H;t.ConnectedTeamsIntSettingsApp=h.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:v.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(H)},528:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(56),d=n(53),u=n(44),g=l(n(0)),p=n(38),S=n(41),f=n(37);n(49);var m=n(54),_=n(46),h=n(31),b=n(32),v=n(48),y=n(42),C=n(91),I=n(92),E=n(81);p.initializeIcons();var P=function(e){function t(t){var n=e.call(this,t)||this;n._root=g.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return g.default.createElement(c.GroupHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handleQLE=n.handleQLE.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={lmSettingStatus:{isChanged:!1,currentValue:!1}};return n._items=[],n._items.push({key:"qle",name:"Qualify lead experience",description:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_QualifiedLeads),featurekey:"qle",learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2119729",onchangehandler:n.handleQLE}),n._groups=[{key:"g1",name:"Lead and Opportunity Management",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,_.XrmHelper.LoadSalesSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),console.log("**************success*****",S.store.getState().salesSettings.qualify_lead_experience),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),console.log("***********Failure********",S.store.getState().salesSettings.qualify_lead_experience),[3,4];case 4:return this.setState({lmSettingStatus:{isChanged:!1,currentValue:S.store.getState().salesSettings.qualify_lead_experience}}),this.pageHeader.focus(),(e=new Map).set("Page","l_and_m"),e.set("Status","Loaded"),y.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",e),[2]}}))}))},t.prototype.handleQLE=function(e,t){console.log("handleQLE >>"),console.log(t),this.state.lmSettingStatus.isChanged=!this.state.lmSettingStatus.isChanged,this.state.lmSettingStatus.currentValue=t,this.setState({lmSettingStatus:{isChanged:this.state.lmSettingStatus.isChanged,currentValue:t}}),S.store.getState().salesSettings.qualify_lead_experience=t,console.log("handleQLE <<")},t.GetCurrentState=function(e){return console.log("LandMSettingsApp::GetCurrentState() >>"),0==e.localeCompare("qle")?S.store.getState().salesSettings.qualify_lead_experience:(console.log("LandMSettingsApp::GetCurrentState() <<"),!1)},t.prototype.render=function(){var e=this,t=this.state.lmSettingStatus.isChanged;return g.default.createElement("div",{className:"menuRowDIVStyle"},g.default.createElement(E.ConnectedNavigationSettingsApp,{crmDataAccess:this.props.crmDataAccess,currentSelectedId:"l_and_m",tabItems:this.props.tabItems}),g.default.createElement("div",{className:"ManagePageAppContainer"},g.default.createElement("div",null,C.SalesPremiumNotification(h.GlobalLocalizedStringsProvider.getStringProvider(),!1,new I.NotificationLogger)),g.default.createElement("div",{className:"SettingsApp"},g.default.createElement("div",{className:"pageHeader"},g.default.createElement("span",{ref:function(t){return e.pageHeader=t},className:"SettingsAppTitle",tabIndex:0,title:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_LeadQualification)},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_LeadQualification))),g.default.createElement("div",{className:"ManageDetailsListStyle DetailsListHeight"},g.default.createElement(u.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:d.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),g.default.createElement(u.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},g.default.createElement(u.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}))))))},t.prototype._onSaveAction=function(){this.state.lmSettingStatus.isChanged&&(_.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.QualifyLead"),_.XrmHelper.SetQualifyLeadExperience(this.state.lmSettingStatus.currentValue),this.state.lmSettingStatus.isChanged=!1,this.setState({lmSettingStatus:{isChanged:!1,currentValue:this.state.lmSettingStatus.currentValue}}))},t.prototype._onCancelAction=function(){v.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"qle":this.state.lmSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var i=e.key,r=t.GetCurrentState(i),s=t.IsSettingEnabled(i),o=e.description;this._setCurrentValue(i,r);var l=h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Learn_More);return g.default.createElement("div",{className:"TableItems"},g.default.createElement("div",{className:"ManagePageDescription"},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_QualifiedLeads)),g.default.createElement("div",{className:"GroupItemDescTable"},g.default.createElement("span",{className:"GroupItemDescription"},o,""!==e.learnmorelink?g.default.createElement(u.Link,{style:{whiteSpace:"nowrap"},href:e.learnmorelink,target:"_blank"},"Â ",l):g.default.createElement("span",null)),s?g.default.createElement(u.Toggle,{className:"ToggleButton",id:i,inlineLabel:!0,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:r,onChange:e.onchangehandler}):g.default.createElement(u.Toggle,{className:"ToggleButton",id:i,inlineLabel:!0,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:r,disabled:!0,onChange:e.onchangehandler})))},t.IsSettingEnabled=function(e){return console.log("IsSettingEnabled >>"),console.log(e),0==e.localeCompare("qle")&&(console.log("A"),_.XrmHelper.IsFCBEnabled("October2019Update")?(console.log("B"),!0):(console.log("B2"),!1))},t.prototype._onRenderRow=function(e){return g.default.createElement(u.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return g.default.createElement(u.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(g.default.Component);t.default=P;t.ConnectedLandMSettingsApp=f.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:m.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(P)},529:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(56),d=n(53),u=n(44),g=l(n(0)),p=n(38),S=n(41),f=n(37);n(49);var m=n(54),_=n(46),h=n(31),b=n(32),v=n(48),y=n(42),C=n(91),I=n(92),E=n(81);p.initializeIcons();var P=function(e){function t(t){var n=e.call(this,t)||this;n._root=g.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return g.default.createElement(c.GroupHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handleIsQuickCreateEnabledForOpportunityClose=n.handleIsQuickCreateEnabledForOpportunityClose.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={cfSettingStatus:{isChanged:!1,currentValue:!1}};h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Learn_More);return n._items=[],n._items.push({key:"ccof",name:"Customize close opportunity form",description:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_CustomFields),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2119730",featurekey:"ccof",onchangehandler:n.handleIsQuickCreateEnabledForOpportunityClose}),n._groups=[{key:"g1",name:"Lead and Opportunity Management",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,_.XrmHelper.LoadSalesSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({cfSettingStatus:{isChanged:!1,currentValue:S.store.getState().salesSettings.customize_close_opportunity_form}}),this.pageHeader.focus(),(e=new Map).set("Page","opp_custom_fields"),e.set("Status","Loaded"),y.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",e),[2]}}))}))},t.prototype.handleIsQuickCreateEnabledForOpportunityClose=function(e,t){console.log("handleIsQuickCreateEnabledForOpportunityClose >>"),console.log(t),this.state.cfSettingStatus.isChanged=!this.state.cfSettingStatus.isChanged,this.state.cfSettingStatus.currentValue=t,this.setState({cfSettingStatus:{isChanged:this.state.cfSettingStatus.isChanged,currentValue:t}}),S.store.getState().salesSettings.is_quick_create_enabled_for_opportunity_close=t,console.log("handleIsQuickCreateEnabledForOpportunityClose <<")},t.GetCurrentState=function(e){return console.log("OppCustomFieldsApp::GetCurrentState() >>"),0==e.localeCompare("ccof")&&S.store.getState().salesSettings.is_quick_create_enabled_for_opportunity_close},t.prototype.render=function(){var e=this,t=this.state.cfSettingStatus.isChanged;return g.default.createElement("div",{className:"menuRowDIVStyle"},g.default.createElement(E.ConnectedNavigationSettingsApp,{crmDataAccess:this.props.crmDataAccess,currentSelectedId:"opp_custom_fields",tabItems:this.props.tabItems}),g.default.createElement("div",{className:"ManagePageAppContainer"},g.default.createElement("div",null,C.SalesPremiumNotification(h.GlobalLocalizedStringsProvider.getStringProvider(),!1,new I.NotificationLogger)),g.default.createElement("div",{className:"SettingsApp"},g.default.createElement("div",{className:"pageHeader"},g.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0,title:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_OpportunityClosing)},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_OpportunityClosing))),g.default.createElement("div",{className:"ManageDetailsListStyle DetailsListHeight"},g.default.createElement(u.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:d.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),g.default.createElement(u.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:20}},g.default.createElement(u.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}))))))},t.prototype._onSaveAction=function(){this.state.cfSettingStatus.isChanged&&(_.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.OptyCustomFields"),_.XrmHelper.SetProperty("organization",_.XrmHelper.getOrganizationId(),"isquickcreateenabledforopportunityclose",this.state.cfSettingStatus.currentValue),this.state.cfSettingStatus.isChanged=!1,this.setState({cfSettingStatus:{isChanged:!1,currentValue:this.state.cfSettingStatus.currentValue}}))},t.prototype._onCancelAction=function(){v.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"ccof":this.state.cfSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var i=e.key,r=t.GetCurrentState(i),s=t.IsSettingEnabled(i),o=e.description;this._setCurrentValue(i,r);var l=h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Learn_More);return g.default.createElement("div",{className:"TableItems"},g.default.createElement("div",{className:"ManagePageDescription"},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_CustomFields)),g.default.createElement("div",{className:"GroupItemDescTable"},g.default.createElement("span",{className:"GroupItemDescription"},o,""!==e.learnmorelink?g.default.createElement(u.Link,{style:{whiteSpace:"nowrap"},href:e.learnmorelink,target:"_blank"},"Â ",l):g.default.createElement("span",null)),s?g.default.createElement(u.Toggle,{className:"ToggleButton",id:i,inlineLabel:!0,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:r,onChange:e.onchangehandler}):g.default.createElement(u.Toggle,{className:"ToggleButton",id:i,inlineLabel:!0,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:r,disabled:!0,onChange:e.onchangehandler})))},t.IsSettingEnabled=function(e){return console.log("IsSettingEnabled >>"),console.log(e),0==e.localeCompare("ccof")&&(console.log("C"),_.XrmHelper.IsFCBEnabled("EnableQuickCreateForOpportunityClose")&&_.XrmHelper.IsFCBEnabled("October2019Update")?(console.log("D"),!0):(console.log("E"),!1))},t.prototype._onRenderRow=function(e){return g.default.createElement(u.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return g.default.createElement(u.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(g.default.Component);t.default=P;t.ConnectedOppCustomFieldsApp=f.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:m.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(P)},530:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(56),d=n(53),u=n(44),g=l(n(0)),p=n(38),S=n(41),f=n(37);n(49);var m=n(54),_=n(46),h=n(31),b=n(32),v=n(48),y=n(42);p.initializeIcons();var C=function(e){function t(t){var n=e.call(this,t)||this;n._root=g.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return g.default.createElement(c.GroupHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handleIsSopIntegrationEnabled=n.handleIsSopIntegrationEnabled.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={sopSettingStatus:{isChanged:!1,currentValue:!1}};h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Learn_More);return n._items=[],n._items.push({key:"sop",name:"Sales Order Processing",description:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.SopInteg_TurnOff),learnmorelink:"https://go.microsoft.com/fwlink/p/?linkid=2119728",featurekey:"sop",onchangehandler:n.handleIsSopIntegrationEnabled}),n._groups=[{key:"g1",name:"Sales Order Processing",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return i(t,e),t.prototype.componentDidMount=function(){return s(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:window.Xrm.Utility.showProgressIndicator(h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,_.XrmHelper.LoadSopSettings()];case 2:return n.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return n.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return[4,_.XrmHelper.GetOrganizationProperty("issopintegrationenabled")];case 5:return e=n.sent(),this.setState({sopSettingStatus:{isChanged:!1,currentValue:e}}),this.pageHeader.focus(),(t=new Map).set("Page","sop"),t.set("Status","Loaded"),y.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",t),[2]}}))}))},t.prototype.handleIsSopIntegrationEnabled=function(e,t){this.state.sopSettingStatus.isChanged=!this.state.sopSettingStatus.isChanged,this.state.sopSettingStatus.currentValue=t,this.setState({sopSettingStatus:{isChanged:this.state.sopSettingStatus.isChanged,currentValue:t}}),S.store.getState().salesSettings.is_sopintegration_enabled=t},t.GetCurrentState=function(e){return 0==e.localeCompare("sop")&&S.store.getState().salesSettings.is_sopintegration_enabled},t.prototype.render=function(){var e=this,t=this.state.sopSettingStatus.isChanged;return g.default.createElement("div",{className:"ManagePageAppContainer"},g.default.createElement("div",{className:"SettingsApp"},g.default.createElement("div",{className:"pageHeader"},g.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},title:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.GroupHeader_SopInteg),tabIndex:0},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.GroupHeader_SopInteg))),g.default.createElement("div",{className:"ManageDetailsListStyle DetailsListHeight"},g.default.createElement(u.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:d.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),g.default.createElement(u.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:20}},g.default.createElement(u.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}),g.default.createElement(u.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction})))))},t.prototype._onSaveAction=function(){this.state.sopSettingStatus.isChanged&&(_.XrmHelper.parseStateAndLog(this.state,"SalesAdminSettings.SopIntegration"),_.XrmHelper.SetProperty("organization",_.XrmHelper.getOrganizationId(),"issopintegrationenabled",this.state.sopSettingStatus.currentValue),this.state.sopSettingStatus.isChanged=!1,this.setState({sopSettingStatus:{isChanged:!1,currentValue:this.state.sopSettingStatus.currentValue}}))},t.prototype._onCancelAction=function(){v.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"sop":this.state.sopSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){var i=e.key,r=t.GetCurrentState(i),s=t.IsSettingEnabled(i),o=e.description;this._setCurrentValue(i,r);var l=h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.SopInteg_TurnOff_Note),c=h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Learn_More);return g.default.createElement("div",{className:"TableItems"},g.default.createElement("div",{className:"ManagePageDescription"},h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_SopInteg)),g.default.createElement("div",{className:"GroupItemDescTable"},g.default.createElement("span",{className:"GroupItemDescription"},o,g.default.createElement("br",null),l,""!==e.learnmorelink?g.default.createElement(u.Link,{style:{whiteSpace:"nowrap"},href:e.learnmorelink,target:"_blank"},"Â ",c):g.default.createElement("span",null)),s?g.default.createElement(u.Toggle,{className:"ToggleButton",id:i,inlineLabel:!0,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:r,onChange:e.onchangehandler}):g.default.createElement(u.Toggle,{className:"ToggleButton",id:i,inlineLabel:!0,onText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:h.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:r,disabled:!0,onChange:e.onchangehandler})))},t.IsSettingEnabled=function(e){return 0==e.localeCompare("sop")},t.prototype._onRenderRow=function(e){return g.default.createElement(u.DetailsRow,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return g.default.createElement(u.DetailsHeader,r({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(g.default.Component);t.ConnectedSopIntegrationApp=f.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:m.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(C)},531:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(0)),c=n(38),d=n(37);n(49);var u=n(54),g=n(46),p=n(31),S=n(32),f=n(218),m=n(81);c.initializeIcons();var _=function(e){function t(t){var n=e.call(this,t)||this;return n.state={rerender:new Date},n}return i(t,e),t.prototype.callbackMethod=function(){this.setState({rerender:new Date})},t.prototype.componentDidUpdate=function(){if(document.getElementById("EE_ConWrapper")){var e=f.CCFContextProvider.getCCFProvider().factory.createComponent("MscrmControls.UnifiedConfigCustomControl.UnifiedConfigCustomControl","EETabContent_Tab1",{});f.CCFContextProvider.getCCFProvider().utils.bindDOMElement(e,document.getElementById("EE_ConWrapper"))}},t.prototype.componentDidMount=function(){return r(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(p.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,g.XrmHelper.LoadSalesSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return document.getElementById("EE_ConWrapper")&&(e=f.CCFContextProvider.getCCFProvider().factory.createComponent("MscrmControls.UnifiedConfigCustomControl.UnifiedConfigCustomControl","EETabContent_Tab1",{}),f.CCFContextProvider.getCCFProvider().utils.bindDOMElement(e,document.getElementById("EE_ConWrapper"))),[2]}}))}))},t.prototype.render=function(){var e=this;return l.default.createElement("div",{className:"menuRowDIVStyle"},l.default.createElement(m.ConnectedNavigationSettingsApp,{crmDataAccess:this.props.crmDataAccess,currentSelectedId:"email_engagement",tabItems:this.props.tabItems}),l.default.createElement(h,{method:function(){return e.callbackMethod()}}))},t}(l.default.Component),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){return l.default.createElement("div",{id:"EE_ConWrapper"})},t.prototype.componentDidMount=function(){var e=this;setTimeout((function(){e.props.method()}),500),this.props.method()},t}(l.default.Component);t.EmailEngagementControlWrapper=h,t.default=_;t.ConnectedEmailEngagementSettingsApp=d.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:u.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(_)},532:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(0)),c=n(38),d=n(37);n(49);var u=n(54),g=n(46),p=n(31),S=n(32),f=n(218),m=n(81);c.initializeIcons();var _=function(e){function t(t){var n=e.call(this,t)||this;return n.state={rerender:new Date},n}return i(t,e),t.prototype.callbackMethod=function(){this.setState({rerender:new Date})},t.prototype.componentDidUpdate=function(){if(document.getElementById("ADC_ConWrapper")){var e=f.CCFContextProvider.getCCFProvider().factory.createComponent("MscrmControls.UnifiedConfigCustomControl.UnifiedConfigCustomControl","ADCTabContent_Tab1",{});f.CCFContextProvider.getCCFProvider().utils.bindDOMElement(e,document.getElementById("ADC_ConWrapper"))}},t.prototype.componentDidMount=function(){return r(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:window.Xrm.Utility.showProgressIndicator(p.GlobalLocalizedStringsProvider.GetString(S.STRING_KEYS.Label_Processing)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,g.XrmHelper.LoadSalesSettings()];case 2:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return t.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return document.getElementById("ADC_ConWrapper")&&(e=f.CCFContextProvider.getCCFProvider().factory.createComponent("MscrmControls.UnifiedConfigCustomControl.UnifiedConfigCustomControl","ADCTabContent_Tab1",{}),f.CCFContextProvider.getCCFProvider().utils.bindDOMElement(e,document.getElementById("ADC_ConWrapper"))),[2]}}))}))},t.prototype.render=function(){var e=this;return l.default.createElement("div",{className:"menuRowDIVStyle"},l.default.createElement(m.ConnectedNavigationSettingsApp,{crmDataAccess:this.props.crmDataAccess,currentSelectedId:"adc",tabItems:this.props.tabItems}),l.default.createElement(h,{method:function(){return e.callbackMethod()}}))},t}(l.default.Component),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){return l.default.createElement("div",{id:"ADC_ConWrapper"})},t.prototype.componentDidMount=function(){var e=this;setTimeout((function(){e.props.method()}),500),this.props.method()},t}(l.default.Component);t.ADCComponentControlWrapper=h,t.default=_;t.ConnectedADCSettingsApp=d.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:u.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(_)},533:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(155),r=n(697),s=n(699),o=n(700);t.createCrmDataAccessFromCrmUrl=function(e,t){var n=o.create({baseURL:e}),a=i.createCDSClientWithHttpClient(n);return{cdsResolver:new r.CDSResolver(a),organizationDataAccess:new s.OrganizationDataAccess(n,t)}},t.getCrmDataAccessInstance=function(){return a},t.setCrmDataAccessInstsance=function(e){console.log("Setting Global CrmDataAccess instance"),a=e}},539:function(e,t){},54:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(48),i=n(456),r=n(258),s=function(){function e(){}return e.GetNavigationHandlerObject=function(e){return a.CrmNavigationHelpers.isCrmUrlNavigationEnabled()?new i.CrmNavigationHandler:new r.ReduxNavigationHandler(e)},e}();t.NavigationHandlerFactory=s},541:function(e,t){},576:function(e,t){},577:function(e,t){},697:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function s(e){try{l(a.next(e))}catch(e){r(e)}}function o(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,o)}l((a=a.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,a,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function o(r){return function(o){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,a=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,o])}}};Object.defineProperty(t,"__esModule",{value:!0});var r,s,o=n(155),l=n(43),c=n(698);!function(e){e.OneToMany="OneToManyRelationship",e.ManyToOne="ManyToOneRelationship"}(r=t.RelationshipType||(t.RelationshipType={})),function(e){e.String="String",e.MultilineText="Memo",e.WholeNumber="Integer_None",e.Date="DateTime",e.OptionSet="Picklist",e.MultiOptionSet="MultiSelectPicklistType",e.TwoOptions="Boolean",e.Lookup="Lookup",e.Customer="Customer",e.Owner="Owner",e.Currency="Money",e.Float="Double",e.Decimal="Decimal",e.Language="Integer_Language",e.UniqueIdentifier="UniqueIdentifier",e.Duration="Integer_Duration"}(s=t.EDataType||(t.EDataType={})),t.getCDSResolver=function(e,t,n){return void 0===n&&(n="9.0"),new d(o.createCDSClient(e,void 0))};var d=function(){function e(e){this.cdsClient=e,this.dependentEntities={},this.orgLanguages=void 0,this.resolvedFields={},this.resolvedFieldsMetadata={},this.resolvedRelatedEntities={},this.resolvedOptionSetMembers={},this.resolvedEntityViews={},this.rawdependentEntities={}}return e.prototype.fetchDependentEntityMetadata=function(e){return a(this,void 0,void 0,(function(){return i(this,(function(t){return void 0===this.dependentEntities[e]&&(this.dependentEntities[e]=this.cdsClient.then((function(t){return t.fetchEntityAndRelatedEntityMetadata({entityName:e})}))),[2,this.dependentEntities[e]]}))}))},e.prototype.resolveFields=function(e){return a(this,void 0,void 0,(function(){return i(this,(function(t){return void 0===this.resolvedFields[e.name]&&(this.resolvedFields[e.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var t=[];e&&(e.AttributesMetadata.DependentAttributes.forEach((function(e){var n={name:e.LogicalName,displayName:e.DisplayName,metadataId:e.AttributeId,format:e.AttributeFormatType,maxValue:e.MaxValue,minValue:e.MinValue,precision:e.Precision,targets:e.Targets,maxLength:e.MaxLength,dataType:u(e)};t.push(n)})),t=t.sort((function(e,t){return e.displayName.localeCompare(t.displayName)})));return t}))),[2,this.resolvedFields[e.name]]}))}))},e.prototype.resolveRelatedEntities=function(e){return a(this,void 0,void 0,(function(){return i(this,(function(t){return void 0===this.resolvedRelatedEntities[e.name]&&(this.resolvedRelatedEntities[e.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var t=[];if(e){var n=e.EntityRelationshipCollection.DependentRelationships,a=e.DependantEntitiesCollection.DependantEntities;n.filter((function(e){return e.EntityRelationshipType!==l.RelationshipTypeExt.ManyToManyRelationship})).forEach((function(n){var i=a.find((function(e){return e.LogicalName===n.RelationshipEntity}));if(i){var s={name:i.LogicalName,displayName:i.DisplayName,metadataId:i.EntityId,primaryIdField:i.PrimaryIdAttribute,primaryNameField:i.PrimaryNameAttribute},o=n.EntityRelationshipType===l.RelationshipTypeExt.ManyToOneRelationship?e.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName===n.ReferencingAttribute})):i.Attributes.DependentAttributes.find((function(e){return e.LogicalName===n.ReferencingAttribute})),c={referencedFieldName:n.ReferencedAttribute,referencingFieldName:n.ReferencingAttribute,displayName:o?o.DisplayName:n.ReferencingAttribute,isHierarchical:n.IsHierarchical,relationshipType:n.EntityRelationshipType===l.RelationshipTypeExt.OneToManyRelationship?r.OneToMany:r.ManyToOne};t.push([s,c])}})),t=t.sort((function(e,t){return e[0].displayName.localeCompare(t[0].displayName)}))}return t}))),[2,this.resolvedRelatedEntities[e.name]]}))}))},e.prototype.resolveOptionSetMembers=function(e,t){return a(this,void 0,void 0,(function(){return i(this,(function(n){return void 0===this.resolvedOptionSetMembers[e.name+"-"+t.name]&&(this.resolvedOptionSetMembers[e.name+"-"+t.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var n=[];if(e){var a=e.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName===t.name}));a&&a.OptionSet&&(("Picklist"===a.OptionSet.Type||"State"===a.OptionSet.Type||"Status"===a.OptionSet.Type)&&a.OptionSet.Options&&a.OptionSet.Options.OptionList?a.OptionSet.Options.OptionList.forEach((function(e){n.push({displayName:e.Label,value:e.Value})})):"Boolean"===a.OptionSet.Type&&(a.OptionSet.TrueOption&&n.push({displayName:a.OptionSet.TrueOption.Label,value:a.OptionSet.TrueOption.Value}),a.OptionSet.FalseOption&&n.push({displayName:a.OptionSet.FalseOption.Label,value:a.OptionSet.FalseOption.Value}))),n=n.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))}return n}))),[2,this.resolvedOptionSetMembers[e.name+"-"+t.name]]}))}))},e.prototype.resolveLookupRecords=function(e,t,n){return a(this,void 0,void 0,(function(){return i(this,(function(e){throw new Error("working on it")}))}))},e.prototype.resolveLookupRecordsSimple=function(e,t,n){return a(this,void 0,void 0,(function(){var a,r,s,o,l,c,d;return i(this,(function(u){switch(u.label){case 0:return[4,this.fetchDependentEntityMetadata(e.name)];case 1:return a=u.sent(),r=[],[4,this.cdsClient];case 2:if(s=u.sent(),!(a&&t&&t.length>0))return[3,6];o=function(t){var o,l,c;return i(this,(function(i){switch(i.label){case 0:if(!(o=t===e.name?a:a.DependantEntitiesCollection.DependantEntities.find((function(e){return e.LogicalName===t}))))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),l=o.EntitySetName+"?$select="+o.PrimaryNameAttribute+","+o.PrimaryIdAttribute+"&$orderby="+o.PrimaryNameAttribute+" asc&$top=100",n&&n.searchString&&(l+="&$filter=contains("+o.PrimaryNameAttribute+",'"+n.searchString+"')"),[4,s.executeOperation(l,"GET",{},void 0,{scenarioName:"CDSResolver.ResolveLookupRecordsSimple"})];case 2:return(c=i.sent())&&c.value&&c.value.forEach((function(e){r.push({entityLogicalName:o.LogicalName,entityDisplayName:o.DisplayName,id:e[o.PrimaryIdAttribute],displayName:e[o.PrimaryNameAttribute]})})),[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}}))},l=0,c=t,u.label=3;case 3:return l<c.length?(d=c[l],[5,o(d)]):[3,6];case 4:u.sent(),u.label=5;case 5:return l++,[3,3];case 6:return[2,r]}}))}))},e.prototype.resolveLookupRecordsById=function(e,t,n){return a(this,void 0,void 0,(function(){var a,r,s,o,l,c,d;return i(this,(function(u){switch(u.label){case 0:return[4,this.fetchDependentEntityMetadata(e.name)];case 1:return a=u.sent(),r=[],[4,this.cdsClient];case 2:if(s=u.sent(),!(a&&t&&t.length>0&&n&&n.length>0))return[3,6];o=function(t){var o,l,c,d;return i(this,(function(i){switch(i.label){case 0:if(!(o=t===e.name?a:a.DependantEntitiesCollection.DependantEntities.find((function(e){return e.LogicalName===t}))))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),l="",n.forEach((function(e){l&&(l+=" or "),l+=o.PrimaryIdAttribute+" eq "+e})),c=o.EntitySetName+"?$select="+o.PrimaryNameAttribute+","+o.PrimaryIdAttribute+"&$filter=("+l+")",[4,s.executeOperation(c,"GET",{},void 0,{scenarioName:"CDSResolver.ResolveLookupRecordsById"})];case 2:return(d=i.sent())&&d.value&&d.value.forEach((function(e){r.push({entityLogicalName:o.LogicalName,entityDisplayName:o.DisplayName,id:e[o.PrimaryIdAttribute],displayName:e[o.PrimaryNameAttribute]})})),[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}}))},l=0,c=t,u.label=3;case 3:return l<c.length?(d=c[l],[5,o(d)]):[3,6];case 4:u.sent(),u.label=5;case 5:return l++,[3,3];case 6:return[2,r]}}))}))},e.prototype.resolveEntityViews=function(e){return a(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this.resolvedEntityViews[e.name])try{this.resolvedEntityViews[e.name]=this.cdsClient.then((function(t){return t.fetchList("View",{entityId:e.metadataId,entityName:e.name,solutionName:""},void 0,{scenarioName:"CDSResolver.ResolveEntityViews"}).then((function(e){var t=[],n=e.data;return n.length>0&&(n.forEach((function(e){var n={name:e.name,isDefault:e.isdefault,savedQueryId:e.savedqueryid,queryType:e.querytype,columns:[]};t.push(n)})),t=t.sort((function(e,t){return e.name.localeCompare(t.name)}))),t}))}))}catch(e){}return[2,this.resolvedEntityViews[e.name]]}))}))},e.prototype.resolveOrganizationEnabledLanguages=function(){return a(this,void 0,void 0,(function(){return i(this,(function(e){if(void 0===this.orgLanguages)try{this.orgLanguages=this.cdsClient.then((function(e){return e.fetchOrganizationEnabledLanguages().then((function(e){var t=e;return t=t.sort((function(e,t){return e.label.localeCompare(t.label)}))}))}))}catch(e){}return[2,this.orgLanguages]}))}))},e.prototype.getLocalizedLabels=function(){return a(this,void 0,void 0,(function(){var e,t,n;return i(this,(function(a){switch(a.label){case 0:e={},t=[],Object.keys(c.AllLabelsMap).forEach((function(n){var a=n;c.AllLabelsMap[a].resourceIdentifier&&t.push(c.AllLabelsMap[a].resourceIdentifier),e[a]=c.AllLabelsMap[a].local})),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.cdsClient];case 2:return[4,(n=a.sent()).localizationService.fetchResourceStrings(t)];case 3:return a.sent(),Object.keys(c.AllLabelsMap).forEach((function(t){var a=t;c.AllLabelsMap[a].resourceIdentifier&&(e[a]=n.localizationService.getResourceString(c.AllLabelsMap[a].resourceIdentifier)||e[a])})),[3,5];case 4:return a.sent(),[3,5];case 5:return[2,e]}}))}))},e.prototype.resolveFieldsMetadata=function(e){return void 0===this.resolvedFieldsMetadata[e.name]&&(this.resolvedFieldsMetadata[e.name]=this.fetchRawEntityMetadata(e.name).then((function(e){var t=e.Attributes,n=[];return t.forEach((function(e){e.AttributeType=e.AttributeType+"Type";var t={name:e.LogicalName,displayName:e&&e.DisplayName&&e.DisplayName.UserLocalizedLabel&&e.DisplayName.UserLocalizedLabel.Label||e.LogicalName,metadataId:e.MetadataId,format:e.AttributeFormatType,maxValue:e.MaxValue,minValue:e.MinValue,precision:e.Precision,targets:e.Targets,maxLength:e.MaxLength,dataType:u(e),CalculationOf:e.CalculationOf};n.push(t)})),n=n.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))}))),this.resolvedFieldsMetadata[e.name]},e.prototype.fetchRawEntityMetadata=function(e){return void 0===this.rawdependentEntities[e]&&(this.rawdependentEntities[e]=this.cdsClient.then((function(t){var n="EntityDefinitions(LogicalName%20%3D%20'"+e+"')?%24select=MetadataId%2CIsCustomEntity%2CLogicalName%2CLogicalCollectionName%2CObjectTypeCode%2CDisplayName%2CPrimaryNameAttribute%2CPrimaryIdAttribute&%24expand=Attributes%2COneToManyRelationships(%24select%3DMetadataId%2CIsHierarchical%2CReferencedAttribute%2CReferencingAttribute)";return t.executeOperation(n,"GET",{}).then((function(e){return new Promise((function(t){t(e)}))}))}))),this.rawdependentEntities[e]},e}();function u(e){switch(e.AttributeType){case l.AttributeTypeCode.Memo+"Type":return s.MultilineText;case l.AttributeTypeCode.Integer+"Type":if(e.AttributeFormatType){if("Language"===e.AttributeFormatType)return s.Language;if("Duration"===e.AttributeFormatType)return s.Duration}return s.WholeNumber;case l.AttributeTypeCode.DateTime+"Type":return s.Date;case l.AttributeTypeCode.Picklist+"Type":case l.AttributeTypeCode.State+"Type":case l.AttributeTypeCode.Status+"Type":case l.AttributeTypeCode.EntityName+"Type":return s.OptionSet;case"MultiSelectPicklistType":return s.MultiOptionSet;case l.AttributeTypeCode.Boolean+"Type":return s.TwoOptions;case l.AttributeTypeCode.Lookup+"Type":return s.Lookup;case l.AttributeTypeCode.Customer+"Type":return s.Customer;case l.AttributeTypeCode.Owner+"Type":return s.Owner;case l.AttributeTypeCode.Money+"Type":return s.Currency;case l.AttributeTypeCode.Double+"Type":return s.Float;case l.AttributeTypeCode.Decimal+"Type":return s.Decimal;case l.AttributeTypeCode.Uniqueidentifier+"Type":return s.UniqueIdentifier;default:return s.String}}t.CDSResolver=d},698:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllLabelsMap={contains:{local:"Contains",resourceIdentifier:"Web._tools.search.search.js_12_2"},doesNotContain:{local:"Does not contain",resourceIdentifier:"Web._tools.search.search.js_12_3_SentenceCase"},beginsWith:{local:"Begins with",resourceIdentifier:"Web._tools.search.search.js_12_4_SentenceCase"},doesNotBeginWith:{local:"Does not begin with",resourceIdentifier:"Web._tools.search.search.js_12_5_SentenceCase"},endsWith:{local:"Ends with",resourceIdentifier:"Web._tools.search.search.js_12_6_SentenceCase"},doesNotEndWith:{local:"Does not end with",resourceIdentifier:"Web._tools.search.search.js_12_7_SentenceCase"},containsData:{local:"Contains data",resourceIdentifier:"Web._tools.search.search.js_12_8_SentenceCase"},doesNotContainData:{local:"Does not contain data",resourceIdentifier:"Web._tools.search.search.js_12_9_SentenceCase"},equals:{local:"Equals",resourceIdentifier:"Web._tools.search.search.js_12_0"},doesNotEqual:{local:"Does not equal",resourceIdentifier:"Web._tools.search.search.js_12_1_SentenceCase"},greaterThan:{local:"Is greater than",resourceIdentifier:"Web._tools.search.search.js_15_0_SentenceCase"},greaterThanOrEqualTo:{local:"Is greater than or equal to",resourceIdentifier:"Web._tools.search.search.js_15_1_SentenceCase"},lessThan:{local:"Is less than",resourceIdentifier:"Web._tools.search.search.js_15_2_SentenceCase"},lessThanOrEqualTo:{local:"Is less than or equal to",resourceIdentifier:"Web._tools.search.search.js_15_3_SentenceCase"},dateQuarter:{local:"Quarter {0}",resourceIdentifier:"ViewDesigner.RecordFilter.quarter"},dateFiscalYear:{local:"FY{0}",resourceIdentifier:"FiscalYear_Format_String_NoSpace"},on:{local:"On",resourceIdentifier:"Web._tools.search.search.js_16_0"},onOrAfter:{local:"On or after",resourceIdentifier:"Web._tools.search.search.js_16_1_SentenceCase"},onOrBefore:{local:"On or before",resourceIdentifier:"Web._tools.search.search.js_16_2_SentenceCase"},yesterday:{local:"Yesterday",resourceIdentifier:"Web._tools.search.search.js_16_3"},today:{local:"Today",resourceIdentifier:"Web._tools.search.search.js_16_4"},tomorrow:{local:"Tomorrow",resourceIdentifier:"Web._tools.search.search.js_16_5"},nextSevenDays:{local:"Next 7 days",resourceIdentifier:"Web._tools.search.search.js_16_6_SentenceCase"},lastSevenDays:{local:"Last 7 days",resourceIdentifier:"Web._tools.search.search.js_16_7_SentenceCase"},nextWeek:{local:"Next week",resourceIdentifier:"Web._tools.search.search.js_16_8_SentenceCase"},lastWeek:{local:"Last week",resourceIdentifier:"Web._tools.search.search.js_16_9_SentenceCase"},thisWeek:{local:"This week",resourceIdentifier:"Web._tools.search.search.js_16_10_SentenceCase"},nextMonth:{local:"Next month",resourceIdentifier:"Web._tools.search.search.js_16_11_SentenceCase"},lastMonth:{local:"Last month",resourceIdentifier:"Web._tools.search.search.js_16_12_SentenceCase"},thisMonth:{local:"This month",resourceIdentifier:"Web._tools.search.search.js_16_13_SentenceCase"},nextYear:{local:"Next year",resourceIdentifier:"Web._tools.search.search.js_16_14_SentenceCase"},lastYear:{local:"Last year",resourceIdentifier:"Web._tools.search.search.js_16_15_SentenceCase"},thisYear:{local:"This year",resourceIdentifier:"Web._tools.search.search.js_16_16_SentenceCase"},lastXHours:{local:"Last x hours",resourceIdentifier:"AF_Option_LastXHours_SentenceCase"},nextXHours:{local:"Next x hours",resourceIdentifier:"AF_Option_NextXHours_SentenceCase"},lastXDays:{local:"Last x days",resourceIdentifier:"AF_Option_LastXDays_SentenceCase"},nextXDays:{local:"Next x days",resourceIdentifier:"AF_Option_NextXDays_SentenceCase"},lastXWeeks:{local:"Last x weeks",resourceIdentifier:"AF_Option_LastXWeeks_SentenceCase"},nextXWeeks:{local:"Next x weeks",resourceIdentifier:"AF_Option_NextXWeeks_SentenceCase"},lastXMonths:{local:"Last x months",resourceIdentifier:"AF_Option_LastXMonths_SentenceCase"},nextXMonths:{local:"Next x months",resourceIdentifier:"AF_Option_NextXMonths_SentenceCase"},lastXYears:{local:"Last x years",resourceIdentifier:"AF_Option_LastXYears_SentenceCase"},nextXYears:{local:"Next x years",resourceIdentifier:"AF_Option_NextXYears_SentenceCase"},anyTime:{local:"Any time",resourceIdentifier:"Web._tools.search.search.js_16_17_SentenceCase"},olderThanXMinutes:{local:"Older than a minutes",resourceIdentifier:"AF_Option_OlderThanXMinutes_SentenceCase"},olderThanXHours:{local:"Older than x hours",resourceIdentifier:"AF_Option_OlderThanXHours_SentenceCase"},olderThanXDays:{local:"Older than x days",resourceIdentifier:"AF_Option_OlderThanXDays_SentenceCase"},olderThanXWeeks:{local:"Older than x weeks",resourceIdentifier:"AF_Option_OlderThanXWeeks_SentenceCase"},olderThanXMonths:{local:"Older than x months",resourceIdentifier:"AF_Option_OlderThanXMonths_SentenceCase"},olderThanXYears:{local:"Older than x years",resourceIdentifier:"AF_Option_OlderThanXYears_SentenceCase"},inFiscalYear:{local:"In fiscal year",resourceIdentifier:"AF_Option_InFiscalYear_SentenceCase"},lastFiscalYear:{local:"Last fiscal year",resourceIdentifier:"AF_Option_LastFiscalYear_SentenceCase"},thisFiscalYear:{local:"This fiscal year",resourceIdentifier:"AF_Option_ThisFiscalYear_SentenceCase"},nextFiscalYear:{local:"Next fiscal year",resourceIdentifier:"AF_Option_NextFiscalYear_SentenceCase"},lastXFiscalYears:{local:"Last x fiscal years",resourceIdentifier:"AF_Option_LastXFiscalYears_SentenceCase"},nextXFiscalYears:{local:"Next x fiscal years",resourceIdentifier:"AF_Option_NextXFiscalYears_SentenceCase"},inFiscalPeriod:{local:"In fiscal period",resourceIdentifier:"AF_Option_InFiscalPeriod_SentenceCase"},lastFiscalPeriod:{local:"Last fiscal period",resourceIdentifier:"AF_Option_LastFiscalPeriod_SentenceCase"},thisFiscalPeriod:{local:"This fiscal period",resourceIdentifier:"AF_Option_ThisFiscalPeriod_SentenceCase"},nextFiscalPeriod:{local:"Next fiscal period",resourceIdentifier:"AF_Option_NextFiscalPeriod_SentenceCase"},lastXFiscalPeriods:{local:"Last x fiscal periods",resourceIdentifier:"AF_Option_LastXFiscalPeriods_SentenceCase"},nextXFiscalPeriods:{local:"Next x fiscal periods",resourceIdentifier:"AF_Option_NextXFiscalPeriods_SentenceCase"},inFiscalPeriodAndYear:{local:"In fiscal period and year",resourceIdentifier:"AF_Option_InFiscalPeriodAndYear_SentenceCase"},inOrAfterFiscalPeriodAndYear:{local:"In or after fiscal period",resourceIdentifier:"AF_Option_InOrAfterFiscalPeriod_SentenceCase"},inOrBeforeFiscalPeriodAndYear:{local:"In or before fiscal period",resourceIdentifier:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase"},containValues:{local:"Contain values",resourceIdentifier:"Web._tools.search.search.js_17_4_SentenceCase"},doesNotContainValues:{local:"Does not contain values",resourceIdentifier:"Web._tools.search.search.js_17_5_SentenceCase"},equalsCurrentUserLanguage:{local:"Equals current user language",resourceIdentifier:"AF_Option_EqUserLanguage_SentenceCase"},isCurrentUser:{local:"Equals current user",resourceIdentifier:"Web._tools.search.search.js_17_0_SentenceCase"},notCurrentUser:{local:"Does not equal current user",resourceIdentifier:"Web._tools.search.search.js_17_1_SentenceCase"},isCurrentBusinessUnit:{local:"Equals current business unit",resourceIdentifier:"Web._tools.search.search.js_19_1_SentenceCase"},notCurrentBusinessUnit:{local:"Does not equal current business unit",resourceIdentifier:"Web._tools.search.search.js_19_2_SentenceCase"},under:{local:"Under",resourceIdentifier:"Web._tools.search.search.js_12_18"},notUnder:{local:"Not under",resourceIdentifier:"Web._tools.search.search.js_12_19_SentenceCase"},above:{local:"Above",resourceIdentifier:"ViewDesigner.RecordFilter.above"},aboveOrEqual:{local:"Equals or above",resourceIdentifier:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase"},underOrEqual:{local:"Equals or under",resourceIdentifier:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase"},isCurrentUserOrReportingHierarchy:{local:"Equals current user or his reporting hierarchy",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase"},isCurrentUserAndTeamsOrReportingHierarchyAndTeams:{local:"Equals current user and his teams or his reporting hierarchy and their teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase"},isCurrentUserTeams:{local:"Equals current user's teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase"},isCurrentUserOrTeams:{local:"Equals current user or user's teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase"},addButton:{local:"Add",resourceIdentifier:"Workflow.DynamicExpressions.Add"},addRow:{local:"Add row",resourceIdentifier:"MenuItem_Label_AddRow_SentenceCase"},addGroup:{local:"Add group",resourceIdentifier:"MenuItem_Label_AddGroup_SentenceCase"},addRelatedEntity:{local:"Add related entity",resourceIdentifier:"MenuItem_Label_AddRelatedEntity_SentenceCase"},deleteExpression:{local:"Delete",resourceIdentifier:"Web._controls.listedit.buttons.Delete"},moveUpExpression:{local:"Move up",resourceIdentifier:"Web._controls.listedit.buttons.MoveUp_SentenceCase"},moveDownExpression:{local:"Move down",resourceIdentifier:"Web._controls.listedit.buttons.MoveDown_SentenceCase"},makeGroup:{local:"Group",resourceIdentifier:"CC_Timeline_Group"},ungroup:{local:"Ungroup",resourceIdentifier:"AF_MenuItem_UnGroup"},errorQuickFind:{local:"View belongs to a quick find, expression editing is not available",resourceIdentifier:"AF_Error_QuickFindView"},errorMalformed:{local:"Malformed expression, could not render",resourceIdentifier:"AF_Error_MalformedExpression"},andGroup:{local:"And",resourceIdentifier:"AF_Text_And_SentenceCase"},orGroup:{local:"Or",resourceIdentifier:"AF_Text_Or_SentenceCase"},relatedEntityPlaceholder:{local:"Choose a related entity",resourceIdentifier:"AF_Message_ChooseRelatedEntity"},doesNotContainDataWarning:{local:"Conditions cannot be added under relationships with no related data",resourceIdentifier:"AF_Error_DoesnNotContainData"},inputControlLabel:{local:"Value",resourceIdentifier:"ViewDesigner.ConditionFilter.Value.Label"},fieldSelectorControlLabel:{local:"Field selector",resourceIdentifier:"AF_Aria_FieldSelector"},operatorSelectorControlLabel:{local:"Operator",resourceIdentifier:"SystemCustomization.BusinessRules.Expression.Operator"},fieldPlaceholder:{local:"Select a field",resourceIdentifier:"Audit.Incontext.Filters.AttributesGroup"},durationUnit:{local:"minutes",resourceIdentifier:"CC_Duration_Minutes"},noValue:{local:"Provide a value for the condition",resourceIdentifier:"AF_Message_NoValue"},loadingResults:{local:"Loading..",resourceIdentifier:"RelatedInformation.DataLoading"},noResults:{local:"No results found.",resourceIdentifier:"RelatedInformation.NoResults"},maxLength:{local:"Input text has more characters than the maximum allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxLength"},minValue:{local:"Input value is lower than the minimum value allowed for this field ({0})",resourceIdentifier:"AF_Error_MinValue"},maxValue:{local:"Input value is greater than the maximum value allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxValue"},maxPrecision:{local:"Input value has a greater precision than the maximum allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxPrecision"},errorNoValues:{local:"Provide at least one value for the condition",resourceIdentifier:"AF_Error_NoValues"},viewAll:{local:"View all options",resourceIdentifier:"AF_Message_ViewAllOptions"},incorrectDataType:{local:"Incorrect data type",resourceIdentifier:"AF_Error_IncorrectDataType"},invalidField:{local:"{0} has been removed from the system or is no longer available for filtering",resourceIdentifier:"AF_Error_InvalidField"},moreCommandsAriaLabel:{local:"More commands",resourceIdentifier:"AF_Aria_MoreCommands"},rowSelectorAriaLabel:{local:"Row selector",resourceIdentifier:"AF_Aria_RowSelector"},groupSelectorAriaLabel:{local:"Group selector",resourceIdentifier:"AF_Aria_GroupSelector"},groupExpandAriaLabel:{local:"Expand",resourceIdentifier:"AF_MenuItem_Expand"},groupCollapseAriaLabel:{local:"Collapse",resourceIdentifier:"AF_MenuItem_Collapse"},groupExpandAriaDescription:{local:"Expand this group",resourceIdentifier:"AF_Aria_GroupExpand"},groupCollapseAriaDescription:{local:"Collapse this group",resourceIdentifier:"AF_Aria_GroupCollapse"}}},699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){this.axiosInstance=e,this.orgId=t};t.OrganizationDataAccess=a},81:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(0)),o=n(38),l=n(37);n(49);var c=n(54),d=n(48),u=n(42),g=n(44);o.initializeIcons();var p=function(e){function t(t){var n=e.call(this,t)||this;return n.state={rerender:new Date},n}return i(t,e),t.prototype._LaunchView=function(e){var t={id:e};d.CrmNavigationHelpers.navigateWithParams(t);var n=new Map;n.set("Page",e),n.set("Status","Requested"),u.logInfo("SalesAdminSettings","SalesAdminSettings.PageLoadStatus",n)},t.prototype.render=function(){var e=this,t=this.props.tabItems.map((function(t){return s.default.createElement(g.Link,{className:e.props.currentSelectedId==t.key?"tablinkSelectected":"tablink",onClick:function(){return e._LaunchView(t.key)}},s.default.createElement("label",{className:"lblStyle"},t.localizedString))}));return s.default.createElement("div",{className:"menuColumnDIVStyle"},t)},t}(s.default.Component);t.NavigationSettingsApp=p;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){return s.default.createElement("div",{id:"Navigation_ConWrapper"})},t.prototype.componentDidMount=function(){var e=this;setTimeout((function(){e.props.method()}),500),this.props.method()},t}(s.default.Component);t.NavigationComponentControlWrapper=S,t.default=p;t.ConnectedNavigationSettingsApp=l.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:c.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(p)},92:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(42),i=function(){function e(){}return e.prototype.logBussinessEvent=function(e,t,n){void 0===n&&(n={}),a.logInfo(e,t,n)},e.prototype.logCustomerEvent=function(e,t,n){void 0===n&&(n={}),a.logInfo(e,t,n)},e.prototype.logError=function(e,t,n,i){void 0===i&&(i={}),a.logError(e,t,n,i)},e}();t.NotificationLogger=i}});