var adminsettings=function(e){function t(t){for(var a,o,s=t[0],l=t[1],c=t[2],d=0,g=[];d<s.length;d++)o=s[d],r[o]&&g.push(r[o][0]),r[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);g.length;)g.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={0:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var s=window.webpackJsonpadminsettings=window.webpackJsonpadminsettings||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;return i.push([383,1]),n()}({141:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(198),r=n(391);t.initialAppState={mainPageType:a.IMainPageType.MainPage,crmOrgInfo:{calenderStartDate:"",clientUrl:"",orgId:""},viewId:"",isManage:"",salesSettings:r.GetDefaultSalesSettings()}},198:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.MainPage=0]="MainPage",e[e.SettingPage=1]="SettingPage"}(t.IMainPageType||(t.IMainPageType={}))},241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(397),r=n(198),i=function(){function e(e){this.dispatch=e}return e.prototype.OpenPage=function(e){console.log("OpenPage <>");this.dispatch(a.changeMainPageType(r.IMainPageType.SettingPage))},e}();t.ReduxNavigationHandler=i},268:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(51),u=n(47),d=n(66),g=l(n(0)),p=n(59),f=n(42),_=n(67);n(76);var h=n(77),S=n(78),m=n(57),b=n(58),y=n(64);p.initializeIcons();var v=function(e){function t(t){var n=e.call(this,t)||this;return n._root=g.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return g.default.createElement(c.GroupHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handle_bc=n.handle_bc.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={bcSettingStatus:{isChanged:!1,currentValue:!1}},n._items=[],n._items.push({key:"bc",name:"Save business card images",description:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_BusinessCard),featurekey:"bc",onchangehandler:n.handle_bc}),n._groups=[{key:"g1",name:"Improve Productivity",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return r(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:window.Xrm.Utility.showProgressIndicator(m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,S.XrmHelper.LoadSalesSettings()];case 2:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({bcSettingStatus:{isChanged:!1,currentValue:f.store.getState().salesSettings.store_business_card_image}}),this.pageHeader.focus(),[2]}}))}))},t.prototype.handle_bc=function(e,t){console.log("handle_bc >>"),console.log(t),this.state.bcSettingStatus.isChanged=!this.state.bcSettingStatus.isChanged,this.state.bcSettingStatus.currentValue=t,this.setState({bcSettingStatus:{isChanged:this.state.bcSettingStatus.isChanged,currentValue:t}}),f.store.getState().salesSettings.store_business_card_image=t,console.log("handle_bc <<")},t.GetCurrentState=function(e){return console.log("BCSettingsApp::GetCurrentState() >>"),0==e.localeCompare("bc")&&f.store.getState().salesSettings.store_business_card_image},t.SetCurrentState=function(e,t){console.log("EESettingsApp::SetCurrentState() >>"),0==e.localeCompare("bc")&&(f.store.getState().salesSettings.is_contextual_email_enabled=t),console.log("EESettingsApp::SetCurrentState() <<")},t.prototype.render=function(){var e=this,t=this.state.bcSettingStatus.isChanged;return g.default.createElement("div",{className:"SettingsAppContainer"},g.default.createElement("div",{className:"SettingsApp"},g.default.createElement("div",{className:"pageHeader"},g.default.createElement("span",{ref:function(t){return e.pageHeader=t},className:"SettingsAppTitle",tabIndex:0},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.GroupHeader_Productivity_Tools))),g.default.createElement("div",{className:"ManageDetailsListStyle"},g.default.createElement(d.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:u.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),g.default.createElement(d.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:20}},g.default.createElement(d.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}),g.default.createElement(d.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction})))))},t.prototype._onSaveAction=function(){this.state.bcSettingStatus.isChanged&&(S.XrmHelper.SetBusinessCardOptions(this.state.bcSettingStatus.currentValue),this.state.bcSettingStatus.isChanged=!1,this.setState({bcSettingStatus:{isChanged:!1,currentValue:this.state.bcSettingStatus.currentValue}}))},t.prototype._onCancelAction=function(){y.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.IsSettingEnabled=function(e){return f.store.getState().salesSettings.is_pai_enabled},t.prototype._setCurrentValue=function(e,t){switch(e){case"bc":this.state.bcSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var r=e.key,i=t.GetCurrentState(r),o=t.IsSettingEnabled(r),s=e.description;return this._setCurrentValue(r,i),g.default.createElement("div",{className:"TableItems"},g.default.createElement("div",{className:"ManagePageDescription"},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Manage_Setting_BusCard_Title)),g.default.createElement("div",{className:"GroupItemDescTable"},g.default.createElement("span",{className:"GroupItemDescription"},s),o?g.default.createElement(d.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:i,onChange:e.onchangehandler}):g.default.createElement(d.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:i,onChange:e.onchangehandler,disabled:!0})))},t.prototype._onRenderRow=function(e){return g.default.createElement(d.DetailsRow,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return g.default.createElement(d.DetailsHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(g.default.Component);t.default=v;t.ConnectedBCSettingsApp=_.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:h.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(v)},269:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(90),u=n(2),d=n(51),g=n(47),p=n(66),f=l(n(0)),_=n(59),h=n(42),S=n(67);n(76);var m=n(77),b=n(78),y=n(422),v=n(57),C=n(58),I=n(64);_.initializeIcons();var w=function(e){function t(t){var n=e.call(this,t)||this;n._root=f.default.createRef(),n._items=[],n._groups=[],n._labelId=u.getId("dialogLabel"),n._subTextId=u.getId("subTextLabel"),n._dragOptions={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:c.ContextualMenu},n._onRenderGroupHeader=function(e){return f.default.createElement(d.GroupHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"},expand:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handle_enable_linkedin_updates=n.handle_enable_linkedin_updates.bind(n),n.handle_enable_sales_navigator_integration=n.handle_enable_sales_navigator_integration.bind(n),n.handle_photo_refresh=n.handle_photo_refresh.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.handle_photo_refresh=n.handle_photo_refresh.bind(n),n.state={hideDialog:!0,isDraggable:!1,salesNavigatorStatus:{isChanged:!1,currentValue:!1},profilePhotosStatus:{isChanged:!1,currentValue:!1},profileChangesStatus:{isChanged:!1,currentValue:!1}};var a="https://www.linkedin.com/help/sales-navigator/answer/83284";return n._items=[],n._items.push({key:"sales_nav_int",name:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Manage_Setting_Title_LI_SalesNav),description:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Manage_Setting_Label_LI_SalesNav),featurekey:"sales_nav_int",learnmorelink:"",onchangehandler:n.handle_enable_sales_navigator_integration}),n._items.push({key:"photo_refresh",name:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Manage_Setting_Title_LI_ProfilePic),description:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Manage_Setting_Label_LI_SalesNav),learnmorelink:a,featurekey:"photo_refresh",onchangehandler:n.handle_photo_refresh}),n._items.push({key:"enable_linkedin_updates",name:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Manage_Setting_Title_LI_Changes),description:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Manage_Setting_Label_LI_Changes),learnmorelink:a,featurekey:"enable_linkedin_updates",onchangehandler:n.handle_enable_linkedin_updates}),n._groups=[{key:"g1",name:"",startIndex:0,count:3}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return r(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:window.Xrm.Utility.showProgressIndicator(v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Processing)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,b.XrmHelper.LoadSalesSettings()];case 2:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({salesNavigatorStatus:{isChanged:!1,currentValue:h.store.getState().salesSettings.sales_linkedin_enable_feature},profileChangesStatus:{isChanged:!1,currentValue:h.store.getState().salesSettings.sales_enable_linkedin_updates},profilePhotosStatus:{isChanged:!1,currentValue:h.store.getState().salesSettings.sales_linkedin_profile_feature}}),this.pageHeader.focus(),[2]}}))}))},t.prototype.handle_enable_sales_navigator_integration=function(e,t){console.log("handle_enable_sales_navigator_integration >>"),this.state.salesNavigatorStatus.isChanged=!this.state.salesNavigatorStatus.isChanged,this.state.salesNavigatorStatus.currentValue=t,this.setState({salesNavigatorStatus:{isChanged:this.state.salesNavigatorStatus.isChanged,currentValue:t}}),h.store.getState().salesSettings.sales_linkedin_enable_feature=t,console.log("handle_enable_sales_navigator_integration <<")},t.prototype.handle_photo_refresh=function(e,t){console.log("handle_photo_refresh >>"),this.state.profilePhotosStatus.isChanged=!this.state.profilePhotosStatus.isChanged,this.state.profilePhotosStatus.currentValue=t,this.setState({profilePhotosStatus:{isChanged:this.state.profilePhotosStatus.isChanged,currentValue:t}}),h.store.getState().salesSettings.sales_linkedin_profile_feature=t,console.log("handle_photo_refresh <<")},t.prototype.handle_enable_linkedin_updates=function(e,t){this.state.profileChangesStatus.isChanged=!this.state.profileChangesStatus.isChanged,this.state.profileChangesStatus.currentValue=t,this.setState({profileChangesStatus:{isChanged:this.state.profileChangesStatus.isChanged,currentValue:t}}),h.store.getState().salesSettings.sales_enable_linkedin_updates=t},t.AllowLIInstallation=function(){return b.XrmHelper.IsFCBEnabled("LinkedInIntegration")&&b.XrmHelper.IsSystemAdministrator()&&!b.XrmHelper.IsRestrictedEnvironment()?h.store.getState().salesSettings.is_linkedin_installed?(console.log("AllowLIInstallation 2"),!1):(console.log("AllowLIInstallation 3"),!0):(console.log("AllowLIInstallation 1"),!1)},t.IsSettingEnabled=function(e){return console.log("LinkedInIntSettingsApp.IsSettingEnabled >>"),console.log(b.XrmHelper.IsFCBEnabled("LinkedInIntegration")),console.log(b.XrmHelper.IsSystemAdministrator()),console.log(b.XrmHelper.IsRestrictedEnvironment()),console.log(h.store.getState().salesSettings.is_linkedin_installed),!(!b.XrmHelper.IsFCBEnabled("LinkedInIntegration")||!b.XrmHelper.IsSystemAdministrator()||b.XrmHelper.IsRestrictedEnvironment())&&(!!h.store.getState().salesSettings.is_linkedin_installed&&(0==e.localeCompare("sales_nav_int")||0==e.localeCompare("photo_refresh")||!(!b.XrmHelper.IsFCBEnabled("NoLongerInOrg")||0!=e.localeCompare("enable_linkedin_updates"))))},t.GetCurrentState=function(e){return console.log("LinkedInIntSettingsApp::GetCurrentState() >>"),0==e.localeCompare("sales_nav_int")?h.store.getState().salesSettings.sales_linkedin_enable_feature:0==e.localeCompare("photo_refresh")?h.store.getState().salesSettings.sales_linkedin_profile_feature:0==e.localeCompare("enable_linkedin_updates")&&h.store.getState().salesSettings.sales_enable_linkedin_updates},t.prototype._installLinkedIn=function(){window.open(b.XrmHelper.GetRISPAUrl(),"_blank")},t.prototype._learnMoreLI=function(){window.open("https://docs.microsoft.com/en-us/dynamics365/linkedin/install-sales-navigator","_blank")},t.prototype._launchMoreDetails=function(){window.open("https://go.microsoft.com/fwlink/?LinkId=521839","_blank")},t.prototype._launchMSPrivacyPolicy=function(){window.open("https://go.microsoft.com/fwlink/?LinkId=521839","_blank")},t.prototype.render=function(){var e=this;console.log("LinkedInIntSettings render >>");var n=this.state,a=(n.hideDialog,n.isDraggable,t.AllowLIInstallation(),this.state.salesNavigatorStatus.isChanged||this.state.profilePhotosStatus.isChanged||this.state.profileChangesStatus.isChanged);return f.default.createElement("div",{className:"SettingsAppContainer"},f.default.createElement(p.MessageBar,{messageBarType:p.MessageBarType.warning,style:{fontSize:"14px",fontFamily:"Segoe UI"}},v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.MessageBar_Text_LI)),f.default.createElement("div",{className:"SettingsApp"},f.default.createElement("div",{className:"pageHeader"},f.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0},v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.GroupHeader_LinkedIn)),f.default.createElement("br",null),f.default.createElement("span",{className:"SettingsAppDescription"},v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Setting_Label_LinkedIn)),f.default.createElement("br",null)),f.default.createElement("div",{className:"LinkedInTable"},f.default.createElement(p.Stack,{style:{paddingTop:"10px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},f.default.createElement("span",null,f.default.createElement(y.PrimaryButton,{text:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Manage_Btn_LinkedIn_Enable),disabled:!1,onClick:this._installLinkedIn})," ")),f.default.createElement("div",{className:"ManageDetailsListStyle"},f.default.createElement(p.DetailsList,{className:"LIDetailsListStyle",key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:g.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),f.default.createElement(p.Stack,{style:{paddingTop:"5px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},f.default.createElement(p.Link,{href:"https://docs.microsoft.com/en-us/dynamics365/linkedin/install-sales-navigator",target:"_blank"},v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Learn_More)),f.default.createElement(p.Link,{href:"https://go.microsoft.com/fwlink/?LinkId=521839",target:"_blank"},v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Policy))),f.default.createElement(p.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},f.default.createElement(y.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!a}),f.default.createElement(y.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction}))))))},t.prototype._onSaveAction=function(){if(h.store.getState().salesSettings.sales_linkedin_configurationid.length<=0||(this.state.salesNavigatorStatus.isChanged&&(b.XrmHelper.SetProperty("sales_linkedin_configuration",h.store.getState().salesSettings.sales_linkedin_configurationid,"sales_linkedin_enable_feature",this.state.salesNavigatorStatus.currentValue),this.setState({salesNavigatorStatus:{isChanged:!1,currentValue:this.state.salesNavigatorStatus.currentValue}})),this.state.profilePhotosStatus.isChanged&&b.XrmHelper.SetProperty("sales_linkedin_configuration",h.store.getState().salesSettings.sales_linkedin_configurationid,"sales_linkedin_profile_feature",this.state.profilePhotosStatus.currentValue),this.setState({profilePhotosStatus:{isChanged:!1,currentValue:this.state.profilePhotosStatus.currentValue}})),this.state.profileChangesStatus.isChanged){if(this.state.profileChangesStatus.currentValue){window.Xrm.Utility.showProgressIndicator("Processing");var e=b.XrmHelper.enableLinkedInUpdates();e.then((function(e){null!=e&&e.json().then((function(e){window.Xrm.Utility.closeProgressIndicator();null!=e.Result?(b.XrmHelper.FetchLinkedInUpdatesStatus(),console.log("enableLinkedInUpdates success")):console.log("enableLinkedInUpdates failed")}))})),e.catch((function(e){console.log("enableLinkedInUpdates failed"),window.Xrm.Utility.closeProgressIndicator()}))}else{var t=b.XrmHelper.disableLinkedInUpdates();window.Xrm.Utility.showProgressIndicator("Processing"),t.then((function(e){null!=e&&e.json().then((function(e){window.Xrm.Utility.closeProgressIndicator(),null!=e.Result?console.log("disableLinkedInUpdates success"):console.log("disableLinkedInUpdates failed")}))})),t.catch((function(e){console.log("disableLinkedInUpdates failed"),window.Xrm.Utility.closeProgressIndicator()}))}this.setState({profileChangesStatus:{isChanged:!1,currentValue:this.state.profileChangesStatus.currentValue}})}},t.prototype._onCancelAction=function(){I.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"sales_nav_int":this.state.salesNavigatorStatus.currentValue=t;break;case"photo_refresh":this.state.profilePhotosStatus.currentValue=t;break;case"enable_linkedin_updates":this.state.profileChangesStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var r=e.key,i=t.GetCurrentState(r);this._setCurrentValue(r,i);var o=t.IsSettingEnabled(r),s=e.description,l="",c=v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Manage_Setting_Label_LI_Condition);console.log(r),0==r.localeCompare("enable_linkedin_updates")&&(l=h.store.getState().salesSettings.sales_enable_linkedin_updates_status),console.log(s);e.description;return f.default.createElement("div",{className:"TableItems"},f.default.createElement("div",{className:"ManagePageDescription"},e.name),f.default.createElement("div",{className:"GroupItemDescTable"},f.default.createElement("span",{className:"GroupItemDescription"},s,""!==e.learnmorelink?f.default.createElement(f.default.Fragment,null,""!==l?f.default.createElement("pre",{style:{fontFamily:"Segoe UI"}},f.default.createElement("br",null),f.default.createElement("span",null,l)):"",f.default.createElement("pre",null,f.default.createElement("span",{style:{fontFamily:"Segoe UI"}},"("),f.default.createElement(p.Link,{style:{whiteSpace:"nowrap"},href:e.learnmorelink,target:"_blank"},f.default.createElement("span",null,"CRM "),f.default.createElement("span",{style:{fontStyle:"italic"}},"Sync")),f.default.createElement("span",{style:{fontFamily:"Segoe UI"}}," "+c+").")," ")):f.default.createElement("span",null)),o?f.default.createElement(p.Toggle,{className:"ToggleButton",id:r,onText:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Yes),offText:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_No),defaultChecked:i,onChange:e.onchangehandler}):f.default.createElement(p.Toggle,{className:"ToggleButton",id:r,onText:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Yes),offText:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_No),defaultChecked:i,disabled:!0,onChange:e.onchangehandler})))},t.prototype._onRenderRow=function(e){return f.default.createElement(p.DetailsRow,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return f.default.createElement(p.DetailsHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(f.default.Component);t.default=w;t.ConnectedLinkedInIntSettingsApp=S.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:m.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(w)},293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateCrmClientUrlAndOrgId=function(e,t){return{type:"@@CrmOrgInfo/UpdateClientUrlAndOrgId",payload:{url:e,orgId:t}}},t.UpdateOrgFiscalCalenderStartDate=function(e){return{type:"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate",payload:{fiscalStartDate:e}}},t.TriggerFetchOrgFiscalCalenderStart=function(){return{type:"@@CrmOrgInfo/TriggerFetchOrgFiscalCalenderStartDate",payload:{}}}},383:function(e,t,n){"use strict";var a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(386)),i=n(387);r.unregister();var o=(new i.SalesAdminBootManager).boot;t.salesAdminBoot=o},386:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function a(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}t.register=function(t){if("serviceWorker"in navigator){if(new URL(e.env.PUBLIC_URL,window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var r=e.env.PUBLIC_URL+"/service-worker.js";n?(!function(e,t){fetch(e).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):a(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(r,t),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):a(r,t)}))}},t.unregister=function(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}}).call(this,n(63))},387:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),i=n(396),o=a(n(0)),s=a(n(44)),l=a(n(402)),c=n(293),u=n(57),d=function(){function e(){}return e.prototype.boot=function(e,t,n,a,d){void 0===n&&(n=""),u.GlobalLocalizedStringsProvider.UpdateCCFStringsProvider(a);var g=new i.SalesAdminActions(r.store.dispatch,r.store.getState);return r.store.dispatch(c.UpdateCrmClientUrlAndOrgId(t,n)),r.store.getState().viewId=d.viewid,r.store.getState().isManage=d.ismanage,s.default.render(o.default.createElement(l.default,null),e),g},e}();t.SalesAdminBootManager=d},389:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(159),r=n(390),i=n(392),o=n(393),s=n(394);t.rootReducer=a.combineReducers({mainPageType:r.mainPageTypeReducer,crmOrgInfo:i.crmOrgInfoReducer,viewId:o.viewIdReducer,isManage:o.viewIdReducer,salesSettings:s.salesSettingsReducer})},390:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(141);t.mainPageTypeReducer=function(e,t){switch(void 0===e&&(e=a.initialAppState.mainPageType),t.type){case"@@mainPage/ChangeType":return t.payload.newType;default:return e}return e}},391:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetDefaultSalesSettings=function(){return{qualify_lead_experience:!1,is_quick_create_enabled_for_opportunity_close:!1,customize_close_opportunity_form:!1,is_contextual_email_enabled:!1,is_pai_enabled:!1,store_business_card_image:!1,pdf_settings:new Map,pdf_entityDisplayNames:new Map,is_msteams_basic_enabled:!1,is_msteams_advanced_enabled:!1,is_linkedin_installed:!1,sales_linkedin_configurationid:"",sales_linkedin_enable_feature:!1,sales_linkedin_profile_feature:!1,sales_enable_linkedin_updates:!1,sales_enable_linkedin_updates_status:"",sales_linkedin_updates_status:"",is_tenant_admin:!1,is_system_admin:!1,entityList:[]}}},392:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(141);t.crmOrgInfoReducer=function(e,t){switch(void 0===e&&(e=r.initialAppState.crmOrgInfo),t.type){case"@@CrmOrgInfo/UpdateClientUrlAndOrgId":return a({},e,{clientUrl:t.payload.url,orgId:t.payload.orgId});case"@@CrmOrgInfo/UpdateOrgFiscalCalenderStartDate":return a({},e,{calenderStartDate:t.payload.fiscalStartDate});default:return e}return e}},393:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.viewIdReducer=function(e,t){return void 0===e&&(e=""),e}},394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(141);t.salesSettingsReducer=function(e,t){return void 0===e&&(e=a.initialAppState.salesSettings),e}},395:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.loggerMiddleware=function(e){return function(e){return function(t){!function(e){var t={};e.type,null!=e.payload&&(t=a({},e.payload))}(t);return e(t)}}}},396:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(42),r=n(241),i=function(){function e(e,t){void 0===t&&(t=void 0),this.dispatch=e,this.getState=t,this.navigationHandlers=new r.ReduxNavigationHandler(e)}return e.prototype.showPage=function(e,t){a.store.getState().viewId=e,a.store.getState().isManage=t,this.navigationHandlers.OpenPage(e)},e}();t.SalesAdminActions=i},397:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeMainPageType=function(e){return{type:"@@mainPage/ChangeType",payload:{newType:e}}}},402:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(0));n(403);var i=n(42),o=n(67),s=n(409),l=n(493),c={};t.default=function(){var e=i.store.getState().crmOrgInfo.clientUrl,t=i.store.getState().crmOrgInfo.orgId;null==c[e]&&(c[e]=l.createCrmDataAccessFromCrmUrl(e,t));var n=c[e];return l.setCrmDataAccessInstsance(n),r.default.createElement("div",{className:"SAConfigApp"},r.default.createElement(o.Provider,{store:i.store},r.default.createElement(s.ConnectedMainAppContainer,{crmDataAccess:n})))}},403:function(e,t,n){var a=n(404);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(244)(a,r);a.locals&&(e.exports=a.locals)},404:function(e,t,n){(e.exports=n(243)(!1)).push([e.i,".SAConfigApp {\n  /* padding: 20px; */\n  background-color: white;\n  color: #323130 !important; }\n",""])},409:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(0)),s=n(59),l=n(67),c=n(42),u=n(198),d=n(410),g=n(488),p=n(489),f=n(268),_=n(490),h=n(269),S=n(491),m=n(492),b=n(293),y=n(78);s.initializeIcons();var v=function(e){function t(t){var n=e.call(this,t)||this;return y.XrmHelper.LoadSalesSettings(),n.state={},n}return r(t,e),t.prototype.componentDidMount=function(){this.props.triggerFetchOrgSettings()},t.prototype.render=function(){var e=void 0;return console.log("mainAppContainer::render() >>"),console.log(c.store.getState().viewId),"l_and_m"==c.store.getState().viewId?e=o.default.createElement(S.ConnectedLandMSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"opp_custom_fields"==c.store.getState().viewId?e=o.default.createElement(m.ConnectedOppCustomFieldsApp,{crmDataAccess:this.props.crmDataAccess}):"pdf_generation"==c.store.getState().viewId?e=o.default.createElement(g.ConnectedPDFSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"enhanced_email"==c.store.getState().viewId?e=o.default.createElement(p.ConnectedEESettingsApp,{crmDataAccess:this.props.crmDataAccess}):"business_card_scan"==c.store.getState().viewId?e=o.default.createElement(f.ConnectedBCSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"teams_int"==c.store.getState().viewId?e=o.default.createElement(_.ConnectedTeamsIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}):"linkedin_int"==c.store.getState().viewId?e=o.default.createElement(h.ConnectedLinkedInIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}):(console.log("mainAppContainer::render() 22>>"),console.log(c.store.getState().viewId),e=o.default.createElement(d.ConnectedOverviewApp,{crmDataAccess:this.props.crmDataAccess})),o.default.createElement("div",{className:"MainAppContainer"},e)},t}(o.default.Component);t.default=v;t.ConnectedMainAppContainer=l.connect((function(e){return{isSettingPageOpened:e.mainPageType==u.IMainPageType.SettingPage}}),(function(e){return{triggerFetchOrgSettings:function(){e(b.TriggerFetchOrgFiscalCalenderStart())}}}))(v)},410:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(66),l=n(51),c=n(47),u=n(66),d=o(n(0)),g=n(59),p=n(42),f=n(67),_=n(64);n(76);var h=n(77),S=n(57),m=n(58),b=n(268),y=n(269);g.initializeIcons();var v=function(e){function t(t){var n=e.call(this,t)||this;n._root=d.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return d.default.createElement(l.GroupHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"},title:{fontFamily:"Segoe UI",fontSize:"16px",fontWeight:600,lineHeight:"19px",color:"#323130"}}}))},n._initializeGrpExpand=function(){var e=n._groups,t=n._collapseOnStartCheck;e.forEach((function(e){e.isCollapsed=!t(e.key)}))},n._collapseOnStartCheck=function(e){var t=!1;p.store.getState().viewId;switch(p.store.getState().isManage){case"lno":t="g1"===e;break;case"pt":t="g2"===e;break;case"cnc":t="g3"===e;break;case"li":t="g4"===e;break;default:t=!0}return t},n.state={};return n._items=[{key:"1",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_QualifiedLeads),description:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_QualifiedLeads),learnmorelink:"",viewid:"l_and_m"},{key:"2",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_CustomFields),description:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_CustomFields),learnmorelink:"",viewid:"opp_custom_fields"},{key:"3",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_EnhancedEmail),description:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_EnhancedEmail),learnmorelink:"https://docs.microsoft.com/en-us/dynamics365/sales-enterprise/set-up-enhanced-email",viewid:"enhanced_email"},{key:"4",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_BusinessCard),description:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_BusinessCard),learnmorelink:"https://docs.microsoft.com/en-us/dynamics365/sales-enterprise/retain-business-card-image-after-scanning",viewid:"business_card_scan"},{key:"5",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_ConvertPDF),description:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_ConvertPDF),learnmorelink:"https://docs.microsoft.com/en-us/dynamics365/sales-enterprise/enable-pdf-generation-quote",viewid:"pdf_generation"},{key:"6",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Title_TeamsInteg),description:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_TeamsInteg),learnmorelink:"https://docs.microsoft.com/en-us/dynamics365/teams-integration/teams-install-app",viewid:"teams_int"},{key:"7",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_LinkedIn),description:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Setting_Label_LinkedIn),learnmorelink:"https://docs.microsoft.com/en-us/dynamics365/linkedin/install-sales-navigator",viewid:"linkedin_int"}],n._groups=[{key:"g1",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_Lead_Opty),startIndex:0,count:2},{key:"g2",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_Productivity_Tools),startIndex:2,count:3},{key:"g3",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_Chat_Collab),startIndex:5,count:1},{key:"g4",name:S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.GroupHeader_LinkedIn),startIndex:6,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return r(t,e),t.prototype.componentWillMount=function(){},t.prototype.componentDidMount=function(){this.pageHeader.focus()},t.prototype.componentWillUnmount=function(){},t._LaunchLeadandConfig=function(e){var t={id:e};_.CrmNavigationHelpers.navigateWithParams(t)},t.prototype.render=function(){var e=this;console.log("ismanage "+p.store.getState().isManage+"::value"),console.log("viewId "+p.store.getState().viewId+"::value"),console.log("pagetype "+p.store.getState().mainPageType+"::value"),this._initializeGrpExpand();var t=new c.Selection({canSelectItem:function(){return!1}});if("true"===p.store.getState().isManage)d.default.createElement("div",{className:"MainAppContainer"},d.default.createElement(y.ConnectedLinkedInIntSettingsApp,{crmDataAccess:this.props.crmDataAccess}));else{if("false"!==p.store.getState().isManage)return d.default.createElement("div",{className:"SettingsAppContainer"},d.default.createElement("div",{className:"SettingsApp"},d.default.createElement("div",{className:"pageHeader"},d.default.createElement("div",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0},S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Overview_Title)),d.default.createElement("div",{className:"SettingsAppDescription"},S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Overview_Desc))),d.default.createElement("div",{className:"DetailListSetting"},d.default.createElement(u.DetailsList,{className:"DetailsListStyle",componentRef:this._root,items:this._items,groups:this._groups,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:c.SelectionMode.none,selection:t,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader,groupProps:{onRenderHeader:this._onRenderGroupHeader}}))));d.default.createElement(b.ConnectedBCSettingsApp,{crmDataAccess:this.props.crmDataAccess})}},t.prototype._onRenderColumn=function(e,n,a){var r=e.description,i=S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Learn_More);return d.default.createElement("div",{className:"TableItems"},d.default.createElement("div",{className:"GroupItemName"},e.name),d.default.createElement("div",{className:"GroupItemDescTable"},d.default.createElement("span",{className:"GroupItemDescription"},r,""!==e.learnmorelink?d.default.createElement(s.Link,{target:"_blank",href:e.learnmorelink},"Â ",i):d.default.createElement("span",null)),d.default.createElement(s.Link,{style:{whiteSpace:"nowrap",fontSize:"14px"},onClick:function(){return t._LaunchLeadandConfig(e.viewid)}},S.GlobalLocalizedStringsProvider.GetString(m.STRING_KEYS.Label_Manage))))},t.prototype._onRenderRow=function(e){return d.default.createElement(u.DetailsRow,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t.prototype._onRenderDetailsHeader=function(e){return d.default.createElement(u.DetailsHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(d.default.Component);t.default=v;t.ConnectedOverviewApp=f.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:h.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(v)},411:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(58),r=function(){function e(){var e;this.stringDict=((e={})[a.STRING_KEYS.SAS_OK]="OK",e[a.STRING_KEYS.SAS_CANCEL]="Cancel",e[a.STRING_KEYS.SAS_CRM_PROCESSING_CALLS]="Loading...",e)}return e.prototype.getLocalizedString=function(e){return this.stringDict[e]},e}();t.DefaultLocalizedStringsProvider=r},412:function(e,t,n){(e.exports=n(243)(!1)).push([e.i,".SettingsApp {\n  padding-top: 40px;\n  width: 100%;\n  padding-left: 50px;\n  padding-right: 25px; }\n\n.SettingsAppTitle {\n  font-family: 'Segoe UI';\n  padding-bottom: 20px;\n  font-size: 24px;\n  line-height: 28px;\n  color: #323130;\n  width: calc(90vw);\n  white-space: pre-wrap;\n  font-weight: 600; }\n\n.DetailListSetting {\n  padding-top: 15px;\n  padding-bottom: 20px; }\n\n.DetailsListStyle {\n  height: calc(80vh - 3.43rem);\n  width: calc(90vw);\n  overflow-y: scroll;\n  overflow-x: hidden;\n  overflow-wrap: break-word; }\n\n.ManageDetailsListStyle {\n  padding-top: 10px;\n  height: calc(80vh - 3.43rem);\n  width: calc(90vw);\n  overflow-y: scroll;\n  overflow-x: hidden;\n  overflow-wrap: break-word;\n  max-height: 375px; }\n\n.LIDetailsListStyle {\n  padding-top: 10px;\n  height: calc(55vh - 3.43rem);\n  width: calc(90vw);\n  max-height: 280px;\n  overflow-x: hidden;\n  overflow-wrap: break-word; }\n\n.SettingsAppDescription {\n  padding-top: 10px;\n  font-family: 'Segoe UI';\n  width: calc(60vw);\n  white-space: pre-wrap;\n  font-size: 14px;\n  line-height: 16px;\n  color: #605E5C; }\n\n.SettingsAppContainer {\n  font-family: 'Segoe UI'; }\n\n.GroupHeader {\n  padding-top: 30px;\n  font-family: 'Segoe UI';\n  font-size: 15px;\n  line-height: 19px;\n  color: #323130; }\n\n.TableItems {\n  width: inherit;\n  white-space: pre-wrap; }\n\n.GroupItemName {\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 16px;\n  width: calc(90vw);\n  white-space: pre-wrap;\n  color: #323130; }\n\n.GroupItemDescTable {\n  display: flex;\n  justify-content: left;\n  width: calc(60vw - 3.43rem); }\n\n.GroupItemDescription {\n  padding-top: 10px;\n  padding-right: 30px;\n  height: auto;\n  width: calc(35vw);\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 20px;\n  color: #605E5C;\n  white-space: pre-wrap; }\n\n.PDFGroupItemDescription {\n  height: auto;\n  width: calc(35vw);\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  color: #605E5C;\n  white-space: pre-wrap; }\n\n.LandMSettingsAppDescription {\n  padding-top: 10px;\n  height: 20px;\n  width: calc(90vw);\n  display: block;\n  word-wrap: break-word;\n  white-space: unset;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  color: #605E5C;\n  justify-content: space-between; }\n\n.GroupItemManageLinkItem {\n  vertical-align: bottom;\n  font-family: 'Segoe UI';\n  width: 30%;\n  color: #2266E3; }\n\n.ToggleButton {\n  vertical-align: bottom;\n  font-family: 'Segoe UI';\n  color: #2266E3;\n  white-space: nowrap; }\n\n.GroupItemDescTable {\n  display: flex;\n  justify-content: left; }\n\n.LinkedInTable {\n  padding-top: 20px; }\n\n.LinkedInLearnMoreButton {\n  padding-left: 20px; }\n\n.LinkedInManageFooter {\n  width: 30%;\n  padding-top: 30px;\n  padding-left: 10px;\n  display: flex;\n  justify-content: space-between; }\n\n.LinkedInManageDetailsList {\n  padding-top: 20px; }\n\n.ManagePageTitle {\n  display: block;\n  padding-top: 20px;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 16px;\n  width: calc(90vw);\n  white-space: pre-wrap;\n  color: #323130; }\n\n.ManagePageDescription {\n  display: block;\n  padding-top: 0px;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  font-weight: 600;\n  line-height: 16px;\n  width: calc(90vw);\n  white-space: pre-wrap;\n  color: #323130; }\n\n.ManagePageExplain {\n  padding-top: 10px;\n  font-family: 'Segoe UI';\n  font-size: 14px;\n  line-height: 16px;\n  width: calc(90vw);\n  white-space: pre-wrap;\n  color: #605E5C; }\n\n.PdfSettingsTable {\n  padding-top: 20px;\n  display: flex;\n  justify-content: space-evenly; }\n",""])},413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(64),r=function(){function e(){}return e.prototype.OpenPage=function(e){console.log("CrmNavigationHandler.OpenPage >");var t={id:e};a.CrmNavigationHelpers.navigateWithParams(t),console.log("CrmNavigationHandler.OpenPage <")},e}();t.CrmNavigationHandler=r},414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{},operationName:"msdyn_EnableSharePoint",operationType:0}},e}();t.EnableSharePointRequest=a},415:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this.Enable=e,this.LogicalEntityNames=t}return e.prototype.getMetadata=function(){return{boundParameter:"",parameterTypes:{Enable:{typeName:"Edm.Boolean",structuralProperty:1},LogicalEntityNames:{typeName:"Edm.String",structuralProperty:1}},operationName:"msdyn_SetTeamsDocumentStatus",operationType:0}},e}();t.EnableMSTeamsDocumentManagementRequest=a},416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{},operationName:"IsPaiEnabled",operationType:0}},e}();t.IsPAIEnabledRequest=a},417:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{},operationName:"msdyn_IsLinkedInDataValidationEnabled",operationType:0}},e}();t.IsLinkedInDataValidationEnabledRequest=a},418:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{},operationName:"msdyn_EnableLinkedInDataValidation",operationType:0}},e}();t.EnableLinkedInDataValidationRequest=a},419:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this.ApiType=e,this.ApiPayLoad=null!=t?t:""}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{ApiType:{typeName:"Edm.Int32",structuralProperty:1},ApiPayLoad:{typeName:"Edm.String",structuralProperty:1}},operationName:"msdyn_DataValidationApi",operationType:0}},e}();t.DisableLinkedInDataValidationRequest=a},42:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(159),i=n(389),o=n(141),s=n(395);function l(e){var t=[],n=window.__REDUX_DEVTOOLS_EXTENSION__;n&&t.push(n());var a=[s.loggerMiddleware],o=r.compose.apply(void 0,[r.applyMiddleware.apply(void 0,a)].concat(t));return r.createStore(i.rootReducer,e,o)}t.default=l,t.store=l(o.initialAppState),t.resetStore=function(){t.store=l(a({},a({},o.initialAppState,{crmOrgInfo:a({},o.initialAppState.crmOrgInfo,{calenderStartDate:t.store.getState().crmOrgInfo.calenderStartDate})})))}},420:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getMetadata=function(){return{boundParameter:null,parameterTypes:{},operationName:"RetrieveTenantAdminPermissions",operationType:1}},e}();t.RetrieveTenantAdminPermissionsRequest=a},421:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this.filter=e,this.columns=t}return e.prototype.getMetadata=function(){return{boundParameter:void 0,parameterTypes:{},operationName:"EntityDefinitions",operationType:2}},e}();t.RetrieveEntityDefinitions=a},488:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(66),u=l(n(0)),d=n(59),g=n(42),p=n(67);n(76);var f=n(77),_=n(78),h=n(66),S=n(47),m=n(57),b=n(58),y=n(64);d.initializeIcons();var v=function(e){function t(t){var n=e.call(this,t)||this;return n._root=u.default.createRef(),n._items=[],n._groups=[],n.handle_basic_pdfsettings=function(e,t){console.log("handle_basic_pdfsettings >>")},n._onRenderColumn=n._onRenderColumn.bind(n),n.handle_pdf=n.handle_pdf.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.addItems=n.addItems.bind(n),n.state={accountPdfSetting:{isChanged:!1,currentValue:!1},contactPdfSetting:{isChanged:!1,currentValue:!1},leadPdfSetting:{isChanged:!1,currentValue:!1},opportunityPdfSetting:{isChanged:!1,currentValue:!1},quotePdfSetting:{isChanged:!1,currentValue:!1},salesorderPdfSetting:{isChanged:!1,currentValue:!1},invoicePdfSetting:{isChanged:!1,currentValue:!1}},n.addItems(),n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return r(t,e),t.prototype.addItems=function(){this._items=[],this._items.push({key:"account",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("account"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"contact",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("contact"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"lead",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("lead"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"opportunity",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("opportunity"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"quote",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("quote"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"salesorder",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("salesorder"),description:"",featurekey:"",onchangehandler:this.handle_pdf}),this._items.push({key:"invoice",name:g.store.getState().salesSettings.pdf_entityDisplayNames.get("invoice"),description:"",featurekey:"",onchangehandler:this.handle_pdf})},t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:window.Xrm.Utility.showProgressIndicator(m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,_.XrmHelper.LoadSalesSettings()];case 2:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.addItems(),this.setState({accountPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("account")},contactPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("contact")},leadPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("lead")},opportunityPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("opportunity")},quotePdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("quote")},salesorderPdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("order")},invoicePdfSetting:{isChanged:!1,currentValue:g.store.getState().salesSettings.pdf_settings.get("invoice")}}),this.pageHeader.focus(),[2]}}))}))},t.prototype.handle_pdf=function(e,n){var a=e.currentTarget.id;switch(a){case"account":this.state.accountPdfSetting.isChanged=!this.state.accountPdfSetting.isChanged,this.state.accountPdfSetting.currentValue=n,t.SetCurrentState(a,n),this.setState({accountPdfSetting:{isChanged:this.state.accountPdfSetting.isChanged,currentValue:this.state.accountPdfSetting.currentValue}});break;case"contact":this.state.contactPdfSetting.isChanged=!this.state.contactPdfSetting.isChanged,this.state.contactPdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({contactPdfSetting:{isChanged:this.state.contactPdfSetting.isChanged,currentValue:this.state.contactPdfSetting.currentValue}});break;case"lead":this.state.leadPdfSetting.isChanged=!this.state.leadPdfSetting.isChanged,this.state.leadPdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({leadPdfSetting:{isChanged:this.state.leadPdfSetting.isChanged,currentValue:this.state.leadPdfSetting.currentValue}});break;case"opportunity":this.state.opportunityPdfSetting.isChanged=!this.state.opportunityPdfSetting.isChanged,this.state.opportunityPdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({opportunityPdfSetting:{isChanged:this.state.opportunityPdfSetting.isChanged,currentValue:this.state.opportunityPdfSetting.currentValue}});break;case"quote":this.state.quotePdfSetting.isChanged=!this.state.quotePdfSetting.isChanged,this.state.quotePdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({opportunityPdfSetting:{isChanged:this.state.opportunityPdfSetting.isChanged,currentValue:this.state.opportunityPdfSetting.currentValue}});break;case"salesorder":this.state.salesorderPdfSetting.isChanged=!this.state.salesorderPdfSetting.isChanged,this.state.salesorderPdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({salesorderPdfSetting:{isChanged:this.state.salesorderPdfSetting.isChanged,currentValue:this.state.salesorderPdfSetting.currentValue}});break;case"invoice":this.state.invoicePdfSetting.isChanged=!this.state.invoicePdfSetting.isChanged,this.state.invoicePdfSetting.currentValue=n,g.store.getState().salesSettings.pdf_settings.set(a,n),this.setState({invoicePdfSetting:{isChanged:this.state.invoicePdfSetting.isChanged,currentValue:this.state.invoicePdfSetting.currentValue}})}console.log("handle_pdf >>"),console.log("handle_pdf <<")},t.GetCurrentState=function(e){if(console.log("PDFSettingsApp::GetCurrentState() >>"),g.store.getState().salesSettings.pdf_settings.has(e)){var t=g.store.getState().salesSettings.pdf_settings.get(e);return null!=t&&t}return!1},t.SetCurrentState=function(e,t){console.log("PDFSettingsApp::SetCurrentState() >>"),g.store.getState().salesSettings.pdf_settings.set(e,t)},t.prototype.render=function(){var e=this,t=this.state.accountPdfSetting.isChanged||this.state.contactPdfSetting.isChanged||this.state.invoicePdfSetting.isChanged||this.state.leadPdfSetting.isChanged||this.state.opportunityPdfSetting.isChanged||this.state.quotePdfSetting.isChanged||this.state.salesorderPdfSetting.isChanged;return u.default.createElement("div",{className:"SettingsAppContainer"},u.default.createElement("div",{className:"SettingsApp"},u.default.createElement("div",{className:"pageHeader"},u.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.GroupHeader_Productivity_Tools))),u.default.createElement("div",{className:"ManagePageTitle"},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_ConvertPDF)),u.default.createElement("div",{className:"ManagePageExplain"},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_ConvertPDF)),u.default.createElement("div",{className:"ManageDetailsListStyle"},u.default.createElement(h.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:S.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader})),u.default.createElement(c.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},u.default.createElement(c.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}),u.default.createElement(h.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction}))))},t.prototype._onSaveAction=function(){(this.state.accountPdfSetting.isChanged||this.state.contactPdfSetting.isChanged||this.state.leadPdfSetting.isChanged||this.state.opportunityPdfSetting.isChanged||this.state.quotePdfSetting.isChanged||this.state.salesorderPdfSetting.isChanged||this.state.invoicePdfSetting.isChanged)&&(_.XrmHelper.SetPDFSettings(),this.state.accountPdfSetting.isChanged=!1,this.state.contactPdfSetting.isChanged=!1,this.state.leadPdfSetting.isChanged=!1,this.state.opportunityPdfSetting.isChanged=!1,this.state.salesorderPdfSetting.isChanged=!1,this.state.invoicePdfSetting.isChanged=!1,this.setState({accountPdfSetting:{isChanged:!1,currentValue:this.state.accountPdfSetting.currentValue}}),this.setState({contactPdfSetting:{isChanged:!1,currentValue:this.state.contactPdfSetting.currentValue}}),this.setState({leadPdfSetting:{isChanged:!1,currentValue:this.state.leadPdfSetting.currentValue}}),this.setState({opportunityPdfSetting:{isChanged:!1,currentValue:this.state.opportunityPdfSetting.currentValue}}),this.setState({salesorderPdfSetting:{isChanged:!1,currentValue:this.state.salesorderPdfSetting.currentValue}}),this.setState({invoicePdfSetting:{isChanged:!1,currentValue:this.state.invoicePdfSetting.currentValue}}))},t.prototype._onCancelAction=function(){y.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._onRenderColumn=function(e,n,a){return console.log("_onRenderColumn >>"),u.default.createElement("div",{className:"TableItems"},u.default.createElement("div",{className:"GroupItemDescTable"},u.default.createElement("span",{className:"PDFGroupItemDescription"},e.name),u.default.createElement(c.Toggle,{id:e.key,onText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Enabled),offText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Disabled),defaultChecked:t.GetCurrentState(e.key),onChange:e.onchangehandler})))},t.prototype._onRenderRow=function(e){return u.default.createElement(h.DetailsRow,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return u.default.createElement(h.DetailsHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(u.default.Component);t.default=v;t.ConnectedPDFSettingsApp=p.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:f.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(v)},489:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(51),u=n(47),d=n(66),g=l(n(0)),p=n(59),f=n(42),_=n(67);n(76);var h=n(77),S=n(78),m=n(57),b=n(58),y=n(64);p.initializeIcons();var v=function(e){function t(t){var n=e.call(this,t)||this;return n._root=g.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return g.default.createElement(c.GroupHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handle_ee=n.handle_ee.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={eeSettingStatus:{isChanged:!1,currentValue:!1}},n._items=[],n._items.push({key:"ee",name:"Enhanced Email",description:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_EnhancedEmail),featurekey:"ee",onchangehandler:n.handle_ee}),n._groups=[{key:"g1",name:"Improve Productivity",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return r(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:window.Xrm.Utility.showProgressIndicator(m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,S.XrmHelper.LoadSalesSettings()];case 2:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({eeSettingStatus:{isChanged:!1,currentValue:f.store.getState().salesSettings.is_contextual_email_enabled}}),this.pageHeader.focus(),[2]}}))}))},t.prototype.handle_ee=function(e,t){console.log("handle_ee >>"),console.log(t),this.state.eeSettingStatus.isChanged=!this.state.eeSettingStatus.isChanged,this.state.eeSettingStatus.currentValue=t,console.log("isChanged: "+this.state.eeSettingStatus.isChanged),console.log("currentValue: "+this.state.eeSettingStatus.currentValue),f.store.getState().salesSettings.is_contextual_email_enabled=t,this.setState({eeSettingStatus:{isChanged:this.state.eeSettingStatus.isChanged,currentValue:t}}),console.log("handle_ee <<")},t.GetCurrentState=function(e){return console.log("EESettingsApp::GetCurrentState() >>"),0==e.localeCompare("ee")&&f.store.getState().salesSettings.is_contextual_email_enabled},t.SetCurrentState=function(e,t){console.log("EESettingsApp::SetCurrentState() >>"),0==e.localeCompare("ee")&&(f.store.getState().salesSettings.is_contextual_email_enabled=t),console.log("EESettingsApp::SetCurrentState() <<")},t.prototype.render=function(){var e=this,t=this.state.eeSettingStatus.isChanged;return g.default.createElement("div",{className:"SettingsAppContainer"},g.default.createElement("div",{className:"SettingsApp"},g.default.createElement("div",{className:"pageHeader"},g.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.GroupHeader_Productivity_Tools))),g.default.createElement("div",{className:"ManageDetailsListStyle"},g.default.createElement(d.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:u.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),g.default.createElement(d.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:20}},g.default.createElement(d.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}),g.default.createElement(d.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction})))))},t.prototype._onSaveAction=function(){this.state.eeSettingStatus.isChanged&&(S.XrmHelper.SetProperty("organization",S.XrmHelper.getOrganizationId(),"iscontextualemailenabled",this.state.eeSettingStatus.currentValue),this.state.eeSettingStatus.isChanged=!1,this.setState({eeSettingStatus:{isChanged:!1,currentValue:this.state.eeSettingStatus.currentValue}}))},t.prototype._onCancelAction=function(){y.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"ee":this.state.eeSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var r=e.key,i=t.GetCurrentState(r);return this._setCurrentValue(r,i),g.default.createElement("div",{className:"TableItems"},g.default.createElement("div",{className:"ManagePageDescription"},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_EnhancedEmail)),g.default.createElement("div",{className:"GroupItemDescTable"},g.default.createElement("span",{className:"GroupItemDescription"},e.description),g.default.createElement(d.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:i,onChange:e.onchangehandler})))},t.prototype._onRenderRow=function(e){return g.default.createElement(d.DetailsRow,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return g.default.createElement(d.DetailsHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(g.default.Component);t.default=v;t.ConnectedEESettingsApp=_.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:h.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(v)},490:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(25),u=n(90),d=n(2),g=n(51),p=n(47),f=n(66),_=l(n(0)),h=n(59),S=n(42),m=n(67);n(76);var b=n(77),y=n(78),v=n(57),C=n(58),I=n(64);h.initializeIcons();var w=function(e){function t(t){var n=e.call(this,t)||this;return n._root=_.default.createRef(),n._items=[],n._groups=[],n._labelId=d.getId("dialogLabel"),n._subTextId=d.getId("subTextLabel"),n._dragOptions={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:u.ContextualMenu},n.handle_basic_teams_int=function(e,t){n.state.basicTeamsSettingStatus.isChanged=!n.state.basicTeamsSettingStatus.isChanged,n.state.basicTeamsSettingStatus.currentValue=t,n.setState({basicTeamsSettingStatus:{isChanged:n.state.basicTeamsSettingStatus.isChanged,currentValue:t}}),S.store.getState().salesSettings.is_msteams_basic_enabled=t},n._closeDialogCancel=function(){console.log("_closeDialogcancel >>"),n.setState({hideDialog:!0}),n.forceUpdate(),console.log("_closeDialogcancel <<")},n._onRenderGroupHeader=function(e){return _.default.createElement(g.GroupHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"},expand:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handle_basic_teams_int=n.handle_basic_teams_int.bind(n),n.handle_adv_teams_int=n.handle_adv_teams_int.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={hideDialog:!0,isDraggable:!1,basicTeamsSettingStatus:{isChanged:!1,currentValue:!1},advTeamsSettingStatus:{isChanged:!1,currentValue:!1}},n._items=[],n._items.push({key:"basic_teams_int",name:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Setting_Title_TeamsInteg),description:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Setting_Label_TeamsInteg),featurekey:"basic_teams_int",onchangehandler:n.handle_basic_teams_int}),n._groups=[{key:"g1",name:"",startIndex:0,count:2}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return r(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:window.Xrm.Utility.showProgressIndicator(v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Processing)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,y.XrmHelper.LoadSalesSettings()];case 2:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({basicTeamsSettingStatus:{isChanged:!1,currentValue:S.store.getState().salesSettings.is_msteams_basic_enabled},advTeamsSettingStatus:{isChanged:!1,currentValue:S.store.getState().salesSettings.is_msteams_advanced_enabled}}),this.pageHeader.focus(),[2]}}))}))},t.GetCurrentState=function(e){return console.log("TeamsIntSettingsApp::GetCurrentState() >>"),0==e.localeCompare("basic_teams_int")?S.store.getState().salesSettings.is_msteams_basic_enabled:0==e.localeCompare("adv_teams_int")&&S.store.getState().salesSettings.is_msteams_advanced_enabled},t.prototype.handle_adv_teams_int=function(e,t){console.log("handle_adv_teams_int >>"),console.log("handle_adv_teams_int <<")},t.prototype.render=function(){var e=this,t=this.state,n=(t.hideDialog,t.isDraggable,this.state.advTeamsSettingStatus.isChanged||this.state.basicTeamsSettingStatus.isChanged);return _.default.createElement("div",{className:"SettingsAppContainer"},_.default.createElement("div",{className:"SettingsApp"},_.default.createElement("div",{className:"pageHeader"},_.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0},v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.GroupHeader_Chat_Collab))),_.default.createElement("div",{className:"ManagePageTitle"},v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Setting_Title_TeamsInteg)),_.default.createElement("div",{className:"ManageDetailsListStyle"},_.default.createElement(f.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:p.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),_.default.createElement(f.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:20}},_.default.createElement(c.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!n}),_.default.createElement(f.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Cancel),onClick:this._onCancelActionT})))))},t.prototype._onSaveAction=function(){var e=this;if(this.state.basicTeamsSettingStatus.isChanged){this.setState({hideDialog:!0});var t,n=["account","annotation","appointment","businessunit","campaign","category","competitor","contact","email","incident","kbarticle","knowledgearticle","lead","opportunity","opportunityproduct","product","quote","salesorder","task","team","invoice","salesliterature","msdyn_agreement","msdyn_expense","msdyn_timegroup","msdyn_inventoryadjustment","msdyn_inventorytransfer","msdyn_project","msdyn_purchaseorder","msdyn_purchaseorderreceipt","msdyn_resourcerequest","msdyn_rma","msdyn_rmareceipt","msdyn_rtv","msdyn_workorder"];if(this.state.basicTeamsSettingStatus.currentValue)if(y.XrmHelper.IsFCBEnabled("SharePointS2S"))if(console.log("SharePointS2S is not enabled."),0==y.XrmHelper.GetSharePointDeploymentType())window.Xrm.Utility.showProgressIndicator(v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Processing)),(t=y.XrmHelper.EnableMSTeamsDocumentManagement(n)).then((function(){window.Xrm.Utility.closeProgressIndicator(),console.log("EnableMSTeamsDocumentManagement success"),y.XrmHelper.SetProperty("organization",y.XrmHelper.getOrganizationId(),"ismsteamsenabled",!0),e.setState({basicTeamsSettingStatus:{isChanged:!1,currentValue:!0}})})),t.catch((function(e){console.log("EnableMSTeamsDocumentManagement() failed"),console.log(e),window.Xrm.Utility.closeProgressIndicator()}));else console.log("SharePointDeploymentType is not Online.");else window.Xrm.Utility.showProgressIndicator(v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Processing)),(t=y.XrmHelper.EnableSharePoint()).then((function(){console.log("EnableSharePoint success"),window.Xrm.Utility.closeProgressIndicator();var t=y.XrmHelper.EnableMSTeamsDocumentManagement(n);t.then((function(){console.log("EnableMSTeamsDocumentManagement success"),y.XrmHelper.SetProperty("organization",y.XrmHelper.getOrganizationId(),"ismsteamsenabled",!0),e.setState({basicTeamsSettingStatus:{isChanged:!1,currentValue:!0}})})),t.catch((function(e){console.log("EnableMSTeamsDocumentManagement() failed"),console.log(e)}))})),t.catch((function(e){console.log("EnableSharePoint() failed"),console.log(e),window.Xrm.Utility.closeProgressIndicator()}));else if(console.log("SharePointS2S is not enabled."),0==y.XrmHelper.GetSharePointDeploymentType())window.Xrm.Utility.showProgressIndicator(v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Processing)),(t=y.XrmHelper.EnableMSTeamsDocumentManagement(n)).then((function(){console.log("EnableMSTeamsDocumentManagement success"),window.Xrm.Utility.closeProgressIndicator(),y.XrmHelper.SetProperty("organization",y.XrmHelper.getOrganizationId(),"ismsteamsenabled",!1),e.setState({basicTeamsSettingStatus:{isChanged:!1,currentValue:e.state.basicTeamsSettingStatus.currentValue}})})),t.catch((function(e){console.log("EnableMSTeamsDocumentManagement() failed"),console.log(e),window.Xrm.Utility.closeProgressIndicator()}));else console.log("SharePointDeploymentType is not Online.")}this.state.advTeamsSettingStatus.isChanged},t.prototype._onCancelActionT=function(){I.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"basic_teams_int":this.state.basicTeamsSettingStatus.currentValue=t;break;case"adv_teams_int":this.state.advTeamsSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var r=e.key,i=t.GetCurrentState(r),o=t.IsSettingEnabled(r),s=e.description;return this._setCurrentValue(r,i),_.default.createElement("div",{className:"TableItems"},_.default.createElement("div",{className:"GroupItemDescTable"},_.default.createElement("span",{className:"GroupItemDescription",dangerouslySetInnerHTML:{__html:s}}),o?_.default.createElement(f.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Yes),offText:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_No),defaultChecked:i,onChange:e.onchangehandler}):_.default.createElement(f.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_Yes),offText:v.GlobalLocalizedStringsProvider.GetString(C.STRING_KEYS.Label_No),defaultChecked:i,disabled:!0,onChange:e.onchangehandler})))},t.IsSettingEnabled=function(e){return console.log("teamsIntSettingsApp.IsSettingEnabled >>"),console.log(y.XrmHelper.IsFCBEnabled("MSTeamsIntegration")),console.log(y.XrmHelper.IsFCBEnabled("MSTeamsIntegrationSetting")),console.log(y.XrmHelper.IsFCBEnabled("MSTeamsCollaborationPreview")),!(!y.XrmHelper.IsFCBEnabled("MSTeamsIntegration")||!y.XrmHelper.IsFCBEnabled("MSTeamsIntegrationSetting"))&&(!(0!=e.localeCompare("basic_teams_int")||!y.XrmHelper.IsSystemAdministrator())||!!(0==e.localeCompare("adv_teams_int")&&y.XrmHelper.IsTenantAdmin()&&y.XrmHelper.IsFCBEnabled("MSTeamsCollaborationPreview")&&y.XrmHelper.IsFCBEnabled("October2019Update")&&S.store.getState().salesSettings.is_msteams_basic_enabled))},t.prototype._onRenderRow=function(e){return _.default.createElement(f.DetailsRow,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return _.default.createElement(f.DetailsHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t}(_.default.Component);t.default=w;t.ConnectedTeamsIntSettingsApp=m.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:b.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(w)},491:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(51),u=n(47),d=n(66),g=l(n(0)),p=n(59),f=n(42),_=n(67);n(76);var h=n(77),S=n(78),m=n(57),b=n(58),y=n(64);p.initializeIcons();var v=function(e){function t(t){var n=e.call(this,t)||this;n._root=g.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return g.default.createElement(c.GroupHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handleQLE=n.handleQLE.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={lmSettingStatus:{isChanged:!1,currentValue:!1}};return n._items=[],n._items.push({key:"qle",name:"Qualify lead experience",description:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.GroupHeader_Lead_Opty),featurekey:"qle",learnmorelink:"https://docs.microsoft.com/en-us/dynamics365/sales-enterprise/define-lead-qualification-experience",onchangehandler:n.handleQLE}),n._groups=[{key:"g1",name:"Lead and Opportunity Management",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return r(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:window.Xrm.Utility.showProgressIndicator(m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,S.XrmHelper.LoadSalesSettings()];case 2:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),console.log("**************success*****",f.store.getState().salesSettings.qualify_lead_experience),[3,4];case 3:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),console.log("***********Failure********",f.store.getState().salesSettings.qualify_lead_experience),[3,4];case 4:return this.setState({lmSettingStatus:{isChanged:!1,currentValue:f.store.getState().salesSettings.qualify_lead_experience}}),this.pageHeader.focus(),[2]}}))}))},t.prototype.handleQLE=function(e,t){console.log("handleQLE >>"),console.log(t),this.state.lmSettingStatus.isChanged=!this.state.lmSettingStatus.isChanged,this.state.lmSettingStatus.currentValue=t,this.setState({lmSettingStatus:{isChanged:this.state.lmSettingStatus.isChanged,currentValue:t}}),f.store.getState().salesSettings.qualify_lead_experience=t,console.log("handleQLE <<")},t.GetCurrentState=function(e){return console.log("LandMSettingsApp::GetCurrentState() >>"),0==e.localeCompare("qle")?f.store.getState().salesSettings.qualify_lead_experience:(console.log("LandMSettingsApp::GetCurrentState() <<"),!1)},t.prototype.render=function(){var e=this,t=this.state.lmSettingStatus.isChanged;return g.default.createElement("div",{className:"SettingsAppContainer"},g.default.createElement("div",{className:"SettingsApp"},g.default.createElement("div",{className:"pageHeader"},g.default.createElement("span",{ref:function(t){return e.pageHeader=t},className:"SettingsAppTitle",tabIndex:0},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.GroupHeader_Lead_Opty))),g.default.createElement("div",{className:"ManageDetailsListStyle"},g.default.createElement(d.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:u.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),g.default.createElement(d.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:40}},g.default.createElement(d.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}),g.default.createElement(d.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction})))))},t.prototype._onSaveAction=function(){this.state.lmSettingStatus.isChanged&&(S.XrmHelper.SetQualifyLeadExperience(this.state.lmSettingStatus.currentValue),this.state.lmSettingStatus.isChanged=!1,this.setState({lmSettingStatus:{isChanged:!1,currentValue:this.state.lmSettingStatus.currentValue}}))},t.prototype._onCancelAction=function(){y.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"qle":this.state.lmSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var r=e.key,i=t.GetCurrentState(r),o=t.IsSettingEnabled(r),s=e.description;this._setCurrentValue(r,i);var l=m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Learn_More);return g.default.createElement("div",{className:"TableItems"},g.default.createElement("div",{className:"ManagePageDescription"},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_QualifiedLeads)),g.default.createElement("div",{className:"GroupItemDescTable"},g.default.createElement("span",{className:"GroupItemDescription"},s,""!==e.learnmorelink?g.default.createElement(g.default.Fragment,null,g.default.createElement("pre",null,g.default.createElement(d.Link,{style:{whiteSpace:"nowrap"},href:e.learnmorelink,target:"_blank"},l)," ")):g.default.createElement("span",null)),o?g.default.createElement(d.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:i,onChange:e.onchangehandler}):g.default.createElement(d.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:i,disabled:!0,onChange:e.onchangehandler})))},t.IsSettingEnabled=function(e){return console.log("IsSettingEnabled >>"),console.log(e),0==e.localeCompare("qle")&&(console.log("A"),S.XrmHelper.IsFCBEnabled("October2019Update")?(console.log("B"),!0):(console.log("B2"),!1))},t.prototype._onRenderRow=function(e){return g.default.createElement(d.DetailsRow,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return g.default.createElement(d.DetailsHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(g.default.Component);t.default=v;t.ConnectedLandMSettingsApp=_.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:h.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(v)},492:function(e,t,n){"use strict";var a,r=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(51),u=n(47),d=n(66),g=l(n(0)),p=n(59),f=n(42),_=n(67);n(76);var h=n(77),S=n(78),m=n(57),b=n(58),y=n(64);p.initializeIcons();var v=function(e){function t(t){var n=e.call(this,t)||this;n._root=g.default.createRef(),n._items=[],n._groups=[],n._onRenderGroupHeader=function(e){return g.default.createElement(c.GroupHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},headerCount:{display:"none"}}}))},n._setCurrentValue=n._setCurrentValue.bind(n),n._onRenderColumn=n._onRenderColumn.bind(n),n.handleIsQuickCreateEnabledForOpportunityClose=n.handleIsQuickCreateEnabledForOpportunityClose.bind(n),n._onSaveAction=n._onSaveAction.bind(n),n.state={cfSettingStatus:{isChanged:!1,currentValue:!1}};m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Learn_More);return n._items=[],n._items.push({key:"ccof",name:"Customize close opportunity form",description:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Label_CustomFields),learnmorelink:"https://docs.microsoft.com/en-us/dynamics365/sales-enterprise/enable-opportunity-close-customization",featurekey:"ccof",onchangehandler:n.handleIsQuickCreateEnabledForOpportunityClose}),n._groups=[{key:"g1",name:"Lead and Opportunity Management",startIndex:0,count:1}],n._columns=[{key:"name",name:"Name",fieldName:"name",minWidth:100,maxWidth:200,isResizable:!0}],n}return r(t,e),t.prototype.componentDidMount=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:window.Xrm.Utility.showProgressIndicator(m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Processing)),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,S.XrmHelper.LoadSalesSettings()];case 2:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 3:return e.sent(),window.Xrm.Utility.closeProgressIndicator(),[3,4];case 4:return this.setState({cfSettingStatus:{isChanged:!1,currentValue:f.store.getState().salesSettings.customize_close_opportunity_form}}),this.pageHeader.focus(),[2]}}))}))},t.prototype.handleIsQuickCreateEnabledForOpportunityClose=function(e,t){console.log("handleIsQuickCreateEnabledForOpportunityClose >>"),console.log(t),this.state.cfSettingStatus.isChanged=!this.state.cfSettingStatus.isChanged,this.state.cfSettingStatus.currentValue=t,this.setState({cfSettingStatus:{isChanged:this.state.cfSettingStatus.isChanged,currentValue:t}}),f.store.getState().salesSettings.is_quick_create_enabled_for_opportunity_close=t,console.log("handleIsQuickCreateEnabledForOpportunityClose <<")},t.GetCurrentState=function(e){return console.log("OppCustomFieldsApp::GetCurrentState() >>"),0==e.localeCompare("ccof")&&f.store.getState().salesSettings.is_quick_create_enabled_for_opportunity_close},t.prototype.render=function(){var e=this,t=this.state.cfSettingStatus.isChanged;return g.default.createElement("div",{className:"SettingsAppContainer"},g.default.createElement("div",{className:"SettingsApp"},g.default.createElement("div",{className:"pageHeader"},g.default.createElement("span",{className:"SettingsAppTitle",ref:function(t){return e.pageHeader=t},tabIndex:0},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.GroupHeader_Lead_Opty))),g.default.createElement("div",{className:"ManageDetailsListStyle"},g.default.createElement(d.DetailsList,{key:Date.now(),componentRef:this._root,items:this._items,isHeaderVisible:!1,columns:this._columns,ariaLabelForSelectAllCheckbox:"Toggle selection for all items",ariaLabelForSelectionColumn:"Toggle selection",checkButtonAriaLabel:"Row checkbox",onRenderItemColumn:this._onRenderColumn,compact:!1,selectionMode:u.SelectionMode.none,onRenderRow:this._onRenderRow,onRenderDetailsHeader:this._onRenderDetailsHeader}),g.default.createElement(d.Stack,{style:{paddingTop:"20px",height:"32px",borderRadius:"2px"},horizontal:!0,tokens:{childrenGap:20}},g.default.createElement(d.PrimaryButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Save),onClick:this._onSaveAction,disabled:!t}),g.default.createElement(d.DefaultButton,{style:{fontFamily:"Segoe UI",fontSize:"14px",lineHeight:"19px",borderRadius:"2px"},text:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Cancel),onClick:this._onCancelAction})))))},t.prototype._onSaveAction=function(){this.state.cfSettingStatus.isChanged&&(S.XrmHelper.SetProperty("organization",S.XrmHelper.getOrganizationId(),"isquickcreateenabledforopportunityclose",this.state.cfSettingStatus.currentValue),this.state.cfSettingStatus.isChanged=!1,this.setState({cfSettingStatus:{isChanged:!1,currentValue:this.state.cfSettingStatus.currentValue}}))},t.prototype._onCancelAction=function(){y.CrmNavigationHelpers.navigateWithParams({id:"overview"})},t.prototype._setCurrentValue=function(e,t){switch(e){case"ccof":this.state.cfSettingStatus.currentValue=t}},t.prototype._onRenderColumn=function(e,n,a){console.log("_onRenderColumn >>");var r=e.key,i=t.GetCurrentState(r),o=t.IsSettingEnabled(r),s=e.description;this._setCurrentValue(r,i);var l=m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Learn_More);return g.default.createElement("div",{className:"TableItems"},g.default.createElement("div",{className:"ManagePageDescription"},m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Setting_Title_CustomFields)),g.default.createElement("div",{className:"GroupItemDescTable"},g.default.createElement("span",{className:"GroupItemDescription"},s,""!==e.learnmorelink?g.default.createElement(g.default.Fragment,null,g.default.createElement("pre",null,g.default.createElement(d.Link,{style:{whiteSpace:"nowrap"},href:e.learnmorelink,target:"_blank"},l)," ")):g.default.createElement("span",null)),o?g.default.createElement(d.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:i,onChange:e.onchangehandler}):g.default.createElement(d.Toggle,{className:"ToggleButton",id:r,inlineLabel:!0,onText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_Yes),offText:m.GlobalLocalizedStringsProvider.GetString(b.STRING_KEYS.Label_No),defaultChecked:i,disabled:!0,onChange:e.onchangehandler})))},t.IsSettingEnabled=function(e){return console.log("IsSettingEnabled >>"),console.log(e),0==e.localeCompare("ccof")&&(console.log("C"),S.XrmHelper.IsFCBEnabled("EnableQuickCreateForOpportunityClose")&&S.XrmHelper.IsFCBEnabled("October2019Update")?(console.log("D"),!0):(console.log("E"),!1))},t.prototype._onRenderRow=function(e){return g.default.createElement(d.DetailsRow,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}},cell:{paddingLeft:"0px"}}}))},t.prototype._onRenderDetailsHeader=function(e){return g.default.createElement(d.DetailsHeader,i({},e,{styles:{root:{selectors:{":hover":{background:"transparent"}}}}}))},t}(g.default.Component);t.default=v;t.ConnectedOppCustomFieldsApp=_.connect((function(e){return{appStatus:!1}}),(function(e,t){return{navigationHandler:h.NavigationHandlerFactory.GetNavigationHandlerObject(e)}}))(v)},493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(150),i=n(656),o=n(658),s=n(334);t.createCrmDataAccessFromCrmUrl=function(e,t){var n=s.create({baseURL:e}),a=r.createCDSClientWithHttpClient(n);return{cdsResolver:new i.CDSResolver(a),organizationDataAccess:new o.OrganizationDataAccess(n,t)}},t.getCrmDataAccessInstance=function(){return a},t.setCrmDataAccessInstsance=function(e){console.log("Setting Global CrmDataAccess instance"),a=e}},499:function(e,t){},501:function(e,t){},536:function(e,t){},537:function(e,t){},57:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(411),r=function(){function e(){}return e.UpdateCCFStringsProvider=function(e){this.ccfStringsProvider=e},e.GetString=function(e){return this.ccfStringsProvider?this.ccfStringsProvider.getLocalizedString(e):this.defaultProvider.getLocalizedString(e)},e.defaultProvider=new a.DefaultLocalizedStringsProvider,e}();t.GlobalLocalizedStringsProvider=r},58:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.STRING_KEYS={SAS_OK:"SAS_OK",SAS_CANCEL:"SAS_CANCEL",SAS_CRM_PROCESSING_CALLS:"SAS_CRM_PROCESSING_CALLS",SAS_Overview:"SAS_Overview",Label_Learn_More:"Label_Learn_More",Label_Manage:"Label_Manage",Label_Yes:"Label_Yes",Label_No:"Label_No",Label_Disabled:"Label_Disabled",Label_Enabled:"Label_Enabled",Label_Save:"Label_Save",Label_Cancel:"Label_Cancel",Label_difference:"Label_difference",Label_Policy:"Label_Policy",Label_ToastMessage_Success:"Label_ToastMessage_Success",Label_ToastMessage_Failure:"Label_ToastMessage_Failure",Label_Processing:"Label_Processing",MessageBar_Text_LI:"MessageBar_Text_LI",Label_LI_Status:"Label_LI_Status",Label_LI_Status_NextRefresh:"Label_LI_Status_NextRefresh",Label_LI_Status_LastRefresh:"Label_LI_Status_LastRefresh",Overview_Title:"Overview_Title",Overview_Desc:"Overview_Desc",GroupHeader_Lead_Opty:"GroupHeader_Lead_Opty",Setting_Title_QualifiedLeads:"Setting_Title_QualifiedLeads",Setting_Label_QualifiedLeads:"Setting_Label_QualifiedLeads",Setting_Title_CustomFields:"Setting_Title_CustomFields",Setting_Label_CustomFields:"Setting_Label_CustomFields",GroupHeader_Productivity_Tools:"GroupHeader_Productivity_Tools",Setting_Title_EnhancedEmail:"Setting_Title_EnhancedEmail",Setting_Label_EnhancedEmail:"Setting_Label_EnhancedEmail",Setting_Title_BusinessCard:"Setting_Title_BusinessCard",Setting_Label_BusinessCard:"Setting_Label_BusinessCard",Setting_Title_ConvertPDF:"Setting_Title_ConvertPDF",Setting_Label_ConvertPDF:"Setting_Label_ConvertPDF",GroupHeader_Chat_Collab:"GroupHeader_Chat_Collab",Setting_Title_TeamsInteg:"Setting_Title_TeamsInteg",Setting_Label_TeamsInteg:"Setting_Label_TeamsInteg",GroupHeader_LinkedIn:"GroupHeader_LinkedIn",Setting_Label_LinkedIn:"Setting_Label_LinkedIn",Manage_Setting_BusCard_Title:"Manage_Setting_BusCard_Title",Manage_Setting_BusCard_Label:"Manage_Setting_BusCard_Label",Manage_Setting_TeamsInteg_Enhanced:"Manage_Setting_TeamsInteg_Enhanced",Manage_Btn_LinkedIn_Enable:"Manage_Btn_LinkedIn_Enable",Manage_Setting_Title_LI_SalesNav:"Manage_Setting_Title_LI_SalesNav",Manage_Setting_Label_LI_SalesNav:"Manage_Setting_Label_LI_SalesNav",Manage_Setting_Title_LI_ProfilePic:"Manage_Setting_Title_LI_ProfilePic",Manage_Setting_Label_LI_ProfilePic:"Manage_Setting_Label_LI_ProfilePic",Manage_Setting_Label_LI_Condition:"Manage_Setting_Label_LI_Condition",Manage_Setting_Title_LI_Changes:"Manage_Setting_Title_LI_Changes",Manage_Setting_Label_LI_Changes:"Manage_Setting_Label_LI_Changes"}},64:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(57),r=n(58),i=function(){function e(){}return e.isCrmUrlNavigationEnabled=function(){return null!=window.Xrm},e.navigateWithParams=function(e){var t={pageType:"control",controlName:"MscrmControls.FieldControls.CCFadminsettings",data:e};window.Xrm.Utility.showProgressIndicator(a.GlobalLocalizedStringsProvider.GetString(r.STRING_KEYS.Label_Processing)),window.Xrm.Navigation.navigateTo(t,{target:1}).then((function(){window.Xrm.Utility.closeProgressIndicator()}),(function(){window.Xrm.Utility.closeProgressIndicator()}))},e}();t.CrmNavigationHelpers=i},656:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i,o,s=n(150),l=n(37),c=n(657);!function(e){e.OneToMany="OneToManyRelationship",e.ManyToOne="ManyToOneRelationship"}(i=t.RelationshipType||(t.RelationshipType={})),function(e){e.String="String",e.MultilineText="Memo",e.WholeNumber="Integer_None",e.Date="DateTime",e.OptionSet="Picklist",e.MultiOptionSet="MultiSelectPicklistType",e.TwoOptions="Boolean",e.Lookup="Lookup",e.Customer="Customer",e.Owner="Owner",e.Currency="Money",e.Float="Double",e.Decimal="Decimal",e.Language="Integer_Language",e.UniqueIdentifier="UniqueIdentifier",e.Duration="Integer_Duration"}(o=t.EDataType||(t.EDataType={})),t.getCDSResolver=function(e,t,n){return void 0===n&&(n="9.0"),new u(s.createCDSClient(e,void 0))};var u=function(){function e(e){this.cdsClient=e,this.dependentEntities={},this.orgLanguages=void 0,this.resolvedFields={},this.resolvedFieldsMetadata={},this.resolvedRelatedEntities={},this.resolvedOptionSetMembers={},this.resolvedEntityViews={},this.rawdependentEntities={}}return e.prototype.fetchDependentEntityMetadata=function(e){return a(this,void 0,void 0,(function(){return r(this,(function(t){return void 0===this.dependentEntities[e]&&(this.dependentEntities[e]=this.cdsClient.then((function(t){return t.fetchEntityAndRelatedEntityMetadata({entityName:e})}))),[2,this.dependentEntities[e]]}))}))},e.prototype.resolveFields=function(e){return a(this,void 0,void 0,(function(){return r(this,(function(t){return void 0===this.resolvedFields[e.name]&&(this.resolvedFields[e.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var t=[];e&&(e.AttributesMetadata.DependentAttributes.forEach((function(e){var n={name:e.LogicalName,displayName:e.DisplayName,metadataId:e.AttributeId,format:e.AttributeFormatType,maxValue:e.MaxValue,minValue:e.MinValue,precision:e.Precision,targets:e.Targets,maxLength:e.MaxLength,dataType:d(e)};t.push(n)})),t=t.sort((function(e,t){return e.displayName.localeCompare(t.displayName)})));return t}))),[2,this.resolvedFields[e.name]]}))}))},e.prototype.resolveRelatedEntities=function(e){return a(this,void 0,void 0,(function(){return r(this,(function(t){return void 0===this.resolvedRelatedEntities[e.name]&&(this.resolvedRelatedEntities[e.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var t=[];if(e){var n=e.EntityRelationshipCollection.DependentRelationships,a=e.DependantEntitiesCollection.DependantEntities;n.filter((function(e){return e.EntityRelationshipType!==l.RelationshipTypeExt.ManyToManyRelationship})).forEach((function(n){var r=a.find((function(e){return e.LogicalName===n.RelationshipEntity}));if(r){var o={name:r.LogicalName,displayName:r.DisplayName,metadataId:r.EntityId,primaryIdField:r.PrimaryIdAttribute,primaryNameField:r.PrimaryNameAttribute},s=n.EntityRelationshipType===l.RelationshipTypeExt.ManyToOneRelationship?e.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName===n.ReferencingAttribute})):r.Attributes.DependentAttributes.find((function(e){return e.LogicalName===n.ReferencingAttribute})),c={referencedFieldName:n.ReferencedAttribute,referencingFieldName:n.ReferencingAttribute,displayName:s?s.DisplayName:n.ReferencingAttribute,isHierarchical:n.IsHierarchical,relationshipType:n.EntityRelationshipType===l.RelationshipTypeExt.OneToManyRelationship?i.OneToMany:i.ManyToOne};t.push([o,c])}})),t=t.sort((function(e,t){return e[0].displayName.localeCompare(t[0].displayName)}))}return t}))),[2,this.resolvedRelatedEntities[e.name]]}))}))},e.prototype.resolveOptionSetMembers=function(e,t){return a(this,void 0,void 0,(function(){return r(this,(function(n){return void 0===this.resolvedOptionSetMembers[e.name+"-"+t.name]&&(this.resolvedOptionSetMembers[e.name+"-"+t.name]=this.fetchDependentEntityMetadata(e.name).then((function(e){var n=[];if(e){var a=e.AttributesMetadata.DependentAttributes.find((function(e){return e.LogicalName===t.name}));a&&a.OptionSet&&(("Picklist"===a.OptionSet.Type||"State"===a.OptionSet.Type||"Status"===a.OptionSet.Type)&&a.OptionSet.Options&&a.OptionSet.Options.OptionList?a.OptionSet.Options.OptionList.forEach((function(e){n.push({displayName:e.Label,value:e.Value})})):"Boolean"===a.OptionSet.Type&&(a.OptionSet.TrueOption&&n.push({displayName:a.OptionSet.TrueOption.Label,value:a.OptionSet.TrueOption.Value}),a.OptionSet.FalseOption&&n.push({displayName:a.OptionSet.FalseOption.Label,value:a.OptionSet.FalseOption.Value}))),n=n.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))}return n}))),[2,this.resolvedOptionSetMembers[e.name+"-"+t.name]]}))}))},e.prototype.resolveLookupRecords=function(e,t,n){return a(this,void 0,void 0,(function(){return r(this,(function(e){throw new Error("working on it")}))}))},e.prototype.resolveLookupRecordsSimple=function(e,t,n){return a(this,void 0,void 0,(function(){var a,i,o,s,l,c,u;return r(this,(function(d){switch(d.label){case 0:return[4,this.fetchDependentEntityMetadata(e.name)];case 1:return a=d.sent(),i=[],[4,this.cdsClient];case 2:if(o=d.sent(),!(a&&t&&t.length>0))return[3,6];s=function(t){var s,l,c;return r(this,(function(r){switch(r.label){case 0:if(!(s=t===e.name?a:a.DependantEntitiesCollection.DependantEntities.find((function(e){return e.LogicalName===t}))))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),l=s.EntitySetName+"?$select="+s.PrimaryNameAttribute+","+s.PrimaryIdAttribute+"&$orderby="+s.PrimaryNameAttribute+" asc&$top=100",n&&n.searchString&&(l+="&$filter=contains("+s.PrimaryNameAttribute+",'"+n.searchString+"')"),[4,o.executeOperation(l,"GET",{},void 0,{scenarioName:"CDSResolver.ResolveLookupRecordsSimple"})];case 2:return(c=r.sent())&&c.value&&c.value.forEach((function(e){i.push({entityLogicalName:s.LogicalName,entityDisplayName:s.DisplayName,id:e[s.PrimaryIdAttribute],displayName:e[s.PrimaryNameAttribute]})})),[3,4];case 3:return r.sent(),[3,4];case 4:return[2]}}))},l=0,c=t,d.label=3;case 3:return l<c.length?(u=c[l],[5,s(u)]):[3,6];case 4:d.sent(),d.label=5;case 5:return l++,[3,3];case 6:return[2,i]}}))}))},e.prototype.resolveLookupRecordsById=function(e,t,n){return a(this,void 0,void 0,(function(){var a,i,o,s,l,c,u;return r(this,(function(d){switch(d.label){case 0:return[4,this.fetchDependentEntityMetadata(e.name)];case 1:return a=d.sent(),i=[],[4,this.cdsClient];case 2:if(o=d.sent(),!(a&&t&&t.length>0&&n&&n.length>0))return[3,6];s=function(t){var s,l,c,u;return r(this,(function(r){switch(r.label){case 0:if(!(s=t===e.name?a:a.DependantEntitiesCollection.DependantEntities.find((function(e){return e.LogicalName===t}))))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),l="",n.forEach((function(e){l&&(l+=" or "),l+=s.PrimaryIdAttribute+" eq "+e})),c=s.EntitySetName+"?$select="+s.PrimaryNameAttribute+","+s.PrimaryIdAttribute+"&$filter=("+l+")",[4,o.executeOperation(c,"GET",{},void 0,{scenarioName:"CDSResolver.ResolveLookupRecordsById"})];case 2:return(u=r.sent())&&u.value&&u.value.forEach((function(e){i.push({entityLogicalName:s.LogicalName,entityDisplayName:s.DisplayName,id:e[s.PrimaryIdAttribute],displayName:e[s.PrimaryNameAttribute]})})),[3,4];case 3:return r.sent(),[3,4];case 4:return[2]}}))},l=0,c=t,d.label=3;case 3:return l<c.length?(u=c[l],[5,s(u)]):[3,6];case 4:d.sent(),d.label=5;case 5:return l++,[3,3];case 6:return[2,i]}}))}))},e.prototype.resolveEntityViews=function(e){return a(this,void 0,void 0,(function(){return r(this,(function(t){if(void 0===this.resolvedEntityViews[e.name])try{this.resolvedEntityViews[e.name]=this.cdsClient.then((function(t){return t.fetchList("View",{entityId:e.metadataId,entityName:e.name,solutionName:""},void 0,{scenarioName:"CDSResolver.ResolveEntityViews"}).then((function(e){var t=[],n=e.data;return n.length>0&&(n.forEach((function(e){var n={name:e.name,isDefault:e.isdefault,savedQueryId:e.savedqueryid,queryType:e.querytype,columns:[]};t.push(n)})),t=t.sort((function(e,t){return e.name.localeCompare(t.name)}))),t}))}))}catch(e){}return[2,this.resolvedEntityViews[e.name]]}))}))},e.prototype.resolveOrganizationEnabledLanguages=function(){return a(this,void 0,void 0,(function(){return r(this,(function(e){if(void 0===this.orgLanguages)try{this.orgLanguages=this.cdsClient.then((function(e){return e.fetchOrganizationEnabledLanguages().then((function(e){var t=e;return t=t.sort((function(e,t){return e.label.localeCompare(t.label)}))}))}))}catch(e){}return[2,this.orgLanguages]}))}))},e.prototype.getLocalizedLabels=function(){return a(this,void 0,void 0,(function(){var e,t,n;return r(this,(function(a){switch(a.label){case 0:e={},t=[],Object.keys(c.AllLabelsMap).forEach((function(n){var a=n;c.AllLabelsMap[a].resourceIdentifier&&t.push(c.AllLabelsMap[a].resourceIdentifier),e[a]=c.AllLabelsMap[a].local})),a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.cdsClient];case 2:return[4,(n=a.sent()).localizationService.fetchResourceStrings(t)];case 3:return a.sent(),Object.keys(c.AllLabelsMap).forEach((function(t){var a=t;c.AllLabelsMap[a].resourceIdentifier&&(e[a]=n.localizationService.getResourceString(c.AllLabelsMap[a].resourceIdentifier)||e[a])})),[3,5];case 4:return a.sent(),[3,5];case 5:return[2,e]}}))}))},e.prototype.resolveFieldsMetadata=function(e){return void 0===this.resolvedFieldsMetadata[e.name]&&(this.resolvedFieldsMetadata[e.name]=this.fetchRawEntityMetadata(e.name).then((function(e){var t=e.Attributes,n=[];return t.forEach((function(e){e.AttributeType=e.AttributeType+"Type";var t={name:e.LogicalName,displayName:e&&e.DisplayName&&e.DisplayName.UserLocalizedLabel&&e.DisplayName.UserLocalizedLabel.Label||e.LogicalName,metadataId:e.MetadataId,format:e.AttributeFormatType,maxValue:e.MaxValue,minValue:e.MinValue,precision:e.Precision,targets:e.Targets,maxLength:e.MaxLength,dataType:d(e),CalculationOf:e.CalculationOf};n.push(t)})),n=n.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}))}))),this.resolvedFieldsMetadata[e.name]},e.prototype.fetchRawEntityMetadata=function(e){return void 0===this.rawdependentEntities[e]&&(this.rawdependentEntities[e]=this.cdsClient.then((function(t){var n="EntityDefinitions(LogicalName%20%3D%20'"+e+"')?%24select=MetadataId%2CIsCustomEntity%2CLogicalName%2CLogicalCollectionName%2CObjectTypeCode%2CDisplayName%2CPrimaryNameAttribute%2CPrimaryIdAttribute&%24expand=Attributes%2COneToManyRelationships(%24select%3DMetadataId%2CIsHierarchical%2CReferencedAttribute%2CReferencingAttribute)";return t.executeOperation(n,"GET",{}).then((function(e){return new Promise((function(t){t(e)}))}))}))),this.rawdependentEntities[e]},e}();function d(e){switch(e.AttributeType){case l.AttributeTypeCode.Memo+"Type":return o.MultilineText;case l.AttributeTypeCode.Integer+"Type":if(e.AttributeFormatType){if("Language"===e.AttributeFormatType)return o.Language;if("Duration"===e.AttributeFormatType)return o.Duration}return o.WholeNumber;case l.AttributeTypeCode.DateTime+"Type":return o.Date;case l.AttributeTypeCode.Picklist+"Type":case l.AttributeTypeCode.State+"Type":case l.AttributeTypeCode.Status+"Type":case l.AttributeTypeCode.EntityName+"Type":return o.OptionSet;case"MultiSelectPicklistType":return o.MultiOptionSet;case l.AttributeTypeCode.Boolean+"Type":return o.TwoOptions;case l.AttributeTypeCode.Lookup+"Type":return o.Lookup;case l.AttributeTypeCode.Customer+"Type":return o.Customer;case l.AttributeTypeCode.Owner+"Type":return o.Owner;case l.AttributeTypeCode.Money+"Type":return o.Currency;case l.AttributeTypeCode.Double+"Type":return o.Float;case l.AttributeTypeCode.Decimal+"Type":return o.Decimal;case l.AttributeTypeCode.Uniqueidentifier+"Type":return o.UniqueIdentifier;default:return o.String}}t.CDSResolver=u},657:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllLabelsMap={contains:{local:"Contains",resourceIdentifier:"Web._tools.search.search.js_12_2"},doesNotContain:{local:"Does not contain",resourceIdentifier:"Web._tools.search.search.js_12_3_SentenceCase"},beginsWith:{local:"Begins with",resourceIdentifier:"Web._tools.search.search.js_12_4_SentenceCase"},doesNotBeginWith:{local:"Does not begin with",resourceIdentifier:"Web._tools.search.search.js_12_5_SentenceCase"},endsWith:{local:"Ends with",resourceIdentifier:"Web._tools.search.search.js_12_6_SentenceCase"},doesNotEndWith:{local:"Does not end with",resourceIdentifier:"Web._tools.search.search.js_12_7_SentenceCase"},containsData:{local:"Contains data",resourceIdentifier:"Web._tools.search.search.js_12_8_SentenceCase"},doesNotContainData:{local:"Does not contain data",resourceIdentifier:"Web._tools.search.search.js_12_9_SentenceCase"},equals:{local:"Equals",resourceIdentifier:"Web._tools.search.search.js_12_0"},doesNotEqual:{local:"Does not equal",resourceIdentifier:"Web._tools.search.search.js_12_1_SentenceCase"},greaterThan:{local:"Is greater than",resourceIdentifier:"Web._tools.search.search.js_15_0_SentenceCase"},greaterThanOrEqualTo:{local:"Is greater than or equal to",resourceIdentifier:"Web._tools.search.search.js_15_1_SentenceCase"},lessThan:{local:"Is less than",resourceIdentifier:"Web._tools.search.search.js_15_2_SentenceCase"},lessThanOrEqualTo:{local:"Is less than or equal to",resourceIdentifier:"Web._tools.search.search.js_15_3_SentenceCase"},dateQuarter:{local:"Quarter {0}",resourceIdentifier:"ViewDesigner.RecordFilter.quarter"},dateFiscalYear:{local:"FY{0}",resourceIdentifier:"FiscalYear_Format_String_NoSpace"},on:{local:"On",resourceIdentifier:"Web._tools.search.search.js_16_0"},onOrAfter:{local:"On or after",resourceIdentifier:"Web._tools.search.search.js_16_1_SentenceCase"},onOrBefore:{local:"On or before",resourceIdentifier:"Web._tools.search.search.js_16_2_SentenceCase"},yesterday:{local:"Yesterday",resourceIdentifier:"Web._tools.search.search.js_16_3"},today:{local:"Today",resourceIdentifier:"Web._tools.search.search.js_16_4"},tomorrow:{local:"Tomorrow",resourceIdentifier:"Web._tools.search.search.js_16_5"},nextSevenDays:{local:"Next 7 days",resourceIdentifier:"Web._tools.search.search.js_16_6_SentenceCase"},lastSevenDays:{local:"Last 7 days",resourceIdentifier:"Web._tools.search.search.js_16_7_SentenceCase"},nextWeek:{local:"Next week",resourceIdentifier:"Web._tools.search.search.js_16_8_SentenceCase"},lastWeek:{local:"Last week",resourceIdentifier:"Web._tools.search.search.js_16_9_SentenceCase"},thisWeek:{local:"This week",resourceIdentifier:"Web._tools.search.search.js_16_10_SentenceCase"},nextMonth:{local:"Next month",resourceIdentifier:"Web._tools.search.search.js_16_11_SentenceCase"},lastMonth:{local:"Last month",resourceIdentifier:"Web._tools.search.search.js_16_12_SentenceCase"},thisMonth:{local:"This month",resourceIdentifier:"Web._tools.search.search.js_16_13_SentenceCase"},nextYear:{local:"Next year",resourceIdentifier:"Web._tools.search.search.js_16_14_SentenceCase"},lastYear:{local:"Last year",resourceIdentifier:"Web._tools.search.search.js_16_15_SentenceCase"},thisYear:{local:"This year",resourceIdentifier:"Web._tools.search.search.js_16_16_SentenceCase"},lastXHours:{local:"Last x hours",resourceIdentifier:"AF_Option_LastXHours_SentenceCase"},nextXHours:{local:"Next x hours",resourceIdentifier:"AF_Option_NextXHours_SentenceCase"},lastXDays:{local:"Last x days",resourceIdentifier:"AF_Option_LastXDays_SentenceCase"},nextXDays:{local:"Next x days",resourceIdentifier:"AF_Option_NextXDays_SentenceCase"},lastXWeeks:{local:"Last x weeks",resourceIdentifier:"AF_Option_LastXWeeks_SentenceCase"},nextXWeeks:{local:"Next x weeks",resourceIdentifier:"AF_Option_NextXWeeks_SentenceCase"},lastXMonths:{local:"Last x months",resourceIdentifier:"AF_Option_LastXMonths_SentenceCase"},nextXMonths:{local:"Next x months",resourceIdentifier:"AF_Option_NextXMonths_SentenceCase"},lastXYears:{local:"Last x years",resourceIdentifier:"AF_Option_LastXYears_SentenceCase"},nextXYears:{local:"Next x years",resourceIdentifier:"AF_Option_NextXYears_SentenceCase"},anyTime:{local:"Any time",resourceIdentifier:"Web._tools.search.search.js_16_17_SentenceCase"},olderThanXMinutes:{local:"Older than a minutes",resourceIdentifier:"AF_Option_OlderThanXMinutes_SentenceCase"},olderThanXHours:{local:"Older than x hours",resourceIdentifier:"AF_Option_OlderThanXHours_SentenceCase"},olderThanXDays:{local:"Older than x days",resourceIdentifier:"AF_Option_OlderThanXDays_SentenceCase"},olderThanXWeeks:{local:"Older than x weeks",resourceIdentifier:"AF_Option_OlderThanXWeeks_SentenceCase"},olderThanXMonths:{local:"Older than x months",resourceIdentifier:"AF_Option_OlderThanXMonths_SentenceCase"},olderThanXYears:{local:"Older than x years",resourceIdentifier:"AF_Option_OlderThanXYears_SentenceCase"},inFiscalYear:{local:"In fiscal year",resourceIdentifier:"AF_Option_InFiscalYear_SentenceCase"},lastFiscalYear:{local:"Last fiscal year",resourceIdentifier:"AF_Option_LastFiscalYear_SentenceCase"},thisFiscalYear:{local:"This fiscal year",resourceIdentifier:"AF_Option_ThisFiscalYear_SentenceCase"},nextFiscalYear:{local:"Next fiscal year",resourceIdentifier:"AF_Option_NextFiscalYear_SentenceCase"},lastXFiscalYears:{local:"Last x fiscal years",resourceIdentifier:"AF_Option_LastXFiscalYears_SentenceCase"},nextXFiscalYears:{local:"Next x fiscal years",resourceIdentifier:"AF_Option_NextXFiscalYears_SentenceCase"},inFiscalPeriod:{local:"In fiscal period",resourceIdentifier:"AF_Option_InFiscalPeriod_SentenceCase"},lastFiscalPeriod:{local:"Last fiscal period",resourceIdentifier:"AF_Option_LastFiscalPeriod_SentenceCase"},thisFiscalPeriod:{local:"This fiscal period",resourceIdentifier:"AF_Option_ThisFiscalPeriod_SentenceCase"},nextFiscalPeriod:{local:"Next fiscal period",resourceIdentifier:"AF_Option_NextFiscalPeriod_SentenceCase"},lastXFiscalPeriods:{local:"Last x fiscal periods",resourceIdentifier:"AF_Option_LastXFiscalPeriods_SentenceCase"},nextXFiscalPeriods:{local:"Next x fiscal periods",resourceIdentifier:"AF_Option_NextXFiscalPeriods_SentenceCase"},inFiscalPeriodAndYear:{local:"In fiscal period and year",resourceIdentifier:"AF_Option_InFiscalPeriodAndYear_SentenceCase"},inOrAfterFiscalPeriodAndYear:{local:"In or after fiscal period",resourceIdentifier:"AF_Option_InOrAfterFiscalPeriod_SentenceCase"},inOrBeforeFiscalPeriodAndYear:{local:"In or before fiscal period",resourceIdentifier:"AF_Option_InOrBeforeFiscalPeriod_SentenceCase"},containValues:{local:"Contain values",resourceIdentifier:"Web._tools.search.search.js_17_4_SentenceCase"},doesNotContainValues:{local:"Does not contain values",resourceIdentifier:"Web._tools.search.search.js_17_5_SentenceCase"},equalsCurrentUserLanguage:{local:"Equals current user language",resourceIdentifier:"AF_Option_EqUserLanguage_SentenceCase"},isCurrentUser:{local:"Equals current user",resourceIdentifier:"Web._tools.search.search.js_17_0_SentenceCase"},notCurrentUser:{local:"Does not equal current user",resourceIdentifier:"Web._tools.search.search.js_17_1_SentenceCase"},isCurrentBusinessUnit:{local:"Equals current business unit",resourceIdentifier:"Web._tools.search.search.js_19_1_SentenceCase"},notCurrentBusinessUnit:{local:"Does not equal current business unit",resourceIdentifier:"Web._tools.search.search.js_19_2_SentenceCase"},under:{local:"Under",resourceIdentifier:"Web._tools.search.search.js_12_18"},notUnder:{local:"Not under",resourceIdentifier:"Web._tools.search.search.js_12_19_SentenceCase"},above:{local:"Above",resourceIdentifier:"ViewDesigner.RecordFilter.above"},aboveOrEqual:{local:"Equals or above",resourceIdentifier:"ViewDesigner.RecordFilter.eq_or_above_SentenceCase"},underOrEqual:{local:"Equals or under",resourceIdentifier:"ViewDesigner.RecordFilter.eq_or_under_SentenceCase"},isCurrentUserOrReportingHierarchy:{local:"Equals current user or his reporting hierarchy",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrHierarchy_SentenceCase"},isCurrentUserAndTeamsOrReportingHierarchyAndTeams:{local:"Equals current user and his teams or his reporting hierarchy and their teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrHierarchyAndTeams_SentenceCase"},isCurrentUserTeams:{local:"Equals current user's teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserTeams_SentenceCase"},isCurrentUserOrTeams:{local:"Equals current user or user's teams",resourceIdentifier:"OwnershipOperator_EqualsCurrentUserOrUserTeams_SentenceCase"},addButton:{local:"Add",resourceIdentifier:"Workflow.DynamicExpressions.Add"},addRow:{local:"Add row",resourceIdentifier:"MenuItem_Label_AddRow_SentenceCase"},addGroup:{local:"Add group",resourceIdentifier:"MenuItem_Label_AddGroup_SentenceCase"},addRelatedEntity:{local:"Add related entity",resourceIdentifier:"MenuItem_Label_AddRelatedEntity_SentenceCase"},deleteExpression:{local:"Delete",resourceIdentifier:"Web._controls.listedit.buttons.Delete"},moveUpExpression:{local:"Move up",resourceIdentifier:"Web._controls.listedit.buttons.MoveUp_SentenceCase"},moveDownExpression:{local:"Move down",resourceIdentifier:"Web._controls.listedit.buttons.MoveDown_SentenceCase"},makeGroup:{local:"Group",resourceIdentifier:"CC_Timeline_Group"},ungroup:{local:"Ungroup",resourceIdentifier:"AF_MenuItem_UnGroup"},errorQuickFind:{local:"View belongs to a quick find, expression editing is not available",resourceIdentifier:"AF_Error_QuickFindView"},errorMalformed:{local:"Malformed expression, could not render",resourceIdentifier:"AF_Error_MalformedExpression"},andGroup:{local:"And",resourceIdentifier:"AF_Text_And_SentenceCase"},orGroup:{local:"Or",resourceIdentifier:"AF_Text_Or_SentenceCase"},relatedEntityPlaceholder:{local:"Choose a related entity",resourceIdentifier:"AF_Message_ChooseRelatedEntity"},doesNotContainDataWarning:{local:"Conditions cannot be added under relationships with no related data",resourceIdentifier:"AF_Error_DoesnNotContainData"},inputControlLabel:{local:"Value",resourceIdentifier:"ViewDesigner.ConditionFilter.Value.Label"},fieldSelectorControlLabel:{local:"Field selector",resourceIdentifier:"AF_Aria_FieldSelector"},operatorSelectorControlLabel:{local:"Operator",resourceIdentifier:"SystemCustomization.BusinessRules.Expression.Operator"},fieldPlaceholder:{local:"Select a field",resourceIdentifier:"Audit.Incontext.Filters.AttributesGroup"},durationUnit:{local:"minutes",resourceIdentifier:"CC_Duration_Minutes"},noValue:{local:"Provide a value for the condition",resourceIdentifier:"AF_Message_NoValue"},loadingResults:{local:"Loading..",resourceIdentifier:"RelatedInformation.DataLoading"},noResults:{local:"No results found.",resourceIdentifier:"RelatedInformation.NoResults"},maxLength:{local:"Input text has more characters than the maximum allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxLength"},minValue:{local:"Input value is lower than the minimum value allowed for this field ({0})",resourceIdentifier:"AF_Error_MinValue"},maxValue:{local:"Input value is greater than the maximum value allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxValue"},maxPrecision:{local:"Input value has a greater precision than the maximum allowed for this field ({0})",resourceIdentifier:"AF_Error_MaxPrecision"},errorNoValues:{local:"Provide at least one value for the condition",resourceIdentifier:"AF_Error_NoValues"},viewAll:{local:"View all options",resourceIdentifier:"AF_Message_ViewAllOptions"},incorrectDataType:{local:"Incorrect data type",resourceIdentifier:"AF_Error_IncorrectDataType"},invalidField:{local:"{0} has been removed from the system or is no longer available for filtering",resourceIdentifier:"AF_Error_InvalidField"},moreCommandsAriaLabel:{local:"More commands",resourceIdentifier:"AF_Aria_MoreCommands"},rowSelectorAriaLabel:{local:"Row selector",resourceIdentifier:"AF_Aria_RowSelector"},groupSelectorAriaLabel:{local:"Group selector",resourceIdentifier:"AF_Aria_GroupSelector"},groupExpandAriaLabel:{local:"Expand",resourceIdentifier:"AF_MenuItem_Expand"},groupCollapseAriaLabel:{local:"Collapse",resourceIdentifier:"AF_MenuItem_Collapse"},groupExpandAriaDescription:{local:"Expand this group",resourceIdentifier:"AF_Aria_GroupExpand"},groupCollapseAriaDescription:{local:"Collapse this group",resourceIdentifier:"AF_Aria_GroupCollapse"}}},658:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e,t){this.axiosInstance=e,this.orgId=t};t.OrganizationDataAccess=a},76:function(e,t,n){var a=n(412);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(244)(a,r);a.locals&&(e.exports=a.locals)},77:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(64),r=n(413),i=n(241),o=function(){function e(){}return e.GetNavigationHandlerObject=function(e){return a.CrmNavigationHelpers.isCrmUrlNavigationEnabled()?new r.CrmNavigationHandler:new i.ReduxNavigationHandler(e)},e}();t.NavigationHandlerFactory=o},78:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function o(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,s)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,i,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(r=2&i[0]?a.return:i[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,i[1])).done)return r;switch(a=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,a=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){o.label=i[1];break}if(6===i[0]&&o.label<r[1]){o.label=r[1],r=i;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(i);break}r[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],a=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(42),s=n(414),l=n(415),c=n(416),u=n(417),d=n(418),g=n(419),p=n(420),f=n(421),_=n(57),h=n(58);!function(e){e[e.GetStatus=0]="GetStatus",e[e.Enable=1]="Enable",e[e.Disable=2]="Disable"}(i||(i={}));var S=function(){function e(){}return e.IsRestrictedEnvironment=function(){return!1},e.GetRISPAUrl=function(){var e=window.Xrm.Utility.getGlobalContext().getClientUrl(),t=this.getOrganizationId(),n=window.Xrm.Page.context.getUserLcid();console.log(e),console.log(t),console.log(n);var a=e.split("."),r="https://crmrispa."+a[a.length-3]+"."+a[a.length-2]+".com/LinkedInProvisioning/index?orgId="+t+"&lcid="+n;return console.log(r),r},e.GetSharePointDeploymentType=function(){return 0},e.isXrmEnabled=function(){return null!=window.Xrm},e.getOrganizationId=function(){var e=window.Xrm.Utility.getGlobalContext().organizationSettings;return console.log(e),e.organizationId},e.IsTenantAdmin=function(){console.log("IsTenantAdmin() >> <<"),console.log(o.store.getState().salesSettings.is_tenant_admin);var e=window.Xrm.Utility.getGlobalContext().organizationSettings;return console.log(e),console.log(e.attributes),console.log(e.attributes.sharePointDeploymentType),o.store.getState().salesSettings.is_tenant_admin},e.GetIsSystemAdministrator=function(){console.log("GetIsSystemAdministrator >>");var e=window.Xrm.Utility.getGlobalContext().userSettings.securityRoles,t=window.Xrm.WebApi.online.retrieveMultipleRecords("role","?$select=roleid&$filter=_roletemplateid_value eq 627090ff-40a3-4053-8790-584edc5be201");t.then((function(t){if(console.log("GetIsSystemAdministrator <>"),console.log(t),null!=t&&null!=t.entities)for(var n=0;n<t.entities.length;n++)for(var a=0;a<e.length;a++)e[a].toLowerCase()==t.entities[n].roleid.toLowerCase()&&(console.log("Current user is admin."),o.store.getState().salesSettings.is_system_admin=!0);0==o.store.getState().salesSettings.is_system_admin&&console.log("Current user is not a admin")})),t.catch((function(e){console.log(e)})),console.log("GetIsSystemAdministrator <<")},e.IsSystemAdministrator=function(){return o.store.getState().salesSettings.is_system_admin},e.getLoggedInUserInfo=function(){var e=window.Xrm.Utility.getGlobalContext().userSettings;return console.log(e),{entityLogicalName:"systemuser",displayName:e.userName,id:e.userId}},e.isUserLanguageRTL=function(){return!!e.isXrmEnabled()&&window.Xrm.Utility.getGlobalContext().userSettings.isRTL},e.LoadSalesSettings=function(){return a(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return console.log("LoadSalesSettings >>"),e.isXrmEnabled()?[4,e.LoadLandMSettings()]:[3,7];case 1:return t.sent(),[4,e.LoadPDFSettings()];case 2:return t.sent(),[4,e.LoadBusinessCardSettings()];case 3:return t.sent(),[4,e.LoadImproveProductivitySettings()];case 4:return t.sent(),[4,e.LoadCandI()];case 5:return t.sent(),[4,e.LoadLinkedInSettings()];case 6:t.sent(),t.label=7;case 7:return console.log("LoadSalesSettings <<"),[2]}}))}))},e.LoadLandMSettings=function(){return a(this,void 0,void 0,(function(){var e,t,n,a,i,s,l,c,u;return r(this,(function(r){switch(r.label){case 0:console.log("LoadLandMSettings >>"),e=window.Xrm.Utility.getGlobalContext().organizationSettings,t="?$select=qualifyleadadditionaloptions",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,t)];case 2:return n=r.sent(),console.log("qualifyleadadditionaloptions <success>"),console.log(n),c=JSON.parse(n.qualifyleadadditionaloptions),console.log(c),0==n.qualifyleadadditionaloptions.localeCompare("{}")?o.store.getState().salesSettings.qualify_lead_experience=!0:(a=c.DefaultQualifyFlow,o.store.getState().salesSettings.qualify_lead_experience="true"===a),[3,4];case 3:return i=r.sent(),console.log("qualifyleadadditionaloptions <failed>"),console.error(i),[3,4];case 4:s="?$select=isquickcreateenabledforopportunityclose",r.label=5;case 5:return r.trys.push([5,7,,8]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,s)];case 6:return l=r.sent(),console.log("isquickcreateenabledforopportunityclose <success>"),console.log(l),c=JSON.parse(l.isquickcreateenabledforopportunityclose),console.log(c),o.store.getState().salesSettings.is_quick_create_enabled_for_opportunity_close=c,[3,8];case 7:return u=r.sent(),console.log("isquickcreateenabledforopportunityclose <failed>"),console.error(u),[3,8];case 8:return console.log("LoadLandMSettings <<"),[2]}}))}))},e.LoadBusinessCardSettings=function(){return a(this,void 0,void 0,(function(){var t,n,a,i;return r(this,(function(r){switch(r.label){case 0:t=new c.IsPAIEnabledRequest,r.label=1;case 1:return r.trys.push([1,6,,7]),[4,window.Xrm.WebApi.online.execute(t)];case 2:return(n=r.sent())?[4,n.json()]:[3,4];case 3:a=r.sent();try{a.ispaienabled&&e.IsFCBEnabled("October2019Update")?o.store.getState().salesSettings.is_pai_enabled=!0:o.store.getState().salesSettings.is_pai_enabled=!1}catch(e){o.store.getState().salesSettings.is_pai_enabled=!1,console.log("Error while geting ispaienabled"+e)}return[3,5];case 4:console.log("pai enabled response check failed: "+n),r.label=5;case 5:return[3,7];case 6:return i=r.sent(),console.log("Retreiving EnablePAI FCB value failed: "+i),[3,7];case 7:return[2]}}))}))},e.LoadLinkedInSettings=function(){return a(this,void 0,void 0,(function(){var t,n,a,i,s,l,c;return r(this,(function(r){switch(r.label){case 0:console.log("LoadLinkedInSettings >>"),e.GetIsSystemAdministrator(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveMultipleRecords("sales_linkedin_configuration","")];case 2:return t=r.sent(),console.log("sales_linkedin_configurations >>"),console.log(t),n=window.Xrm.Utility.getGlobalContext().organizationSettings,console.log(n.OrgType),console.log(n.attributes),t.entities.length>0?(console.log(t.entities[0].sales_linkedin_configurationid),console.log(t.entities[0].sales_linkedin_enable_feature),console.log(t.entities[0].sales_linkedin_profile_feature),o.store.getState().salesSettings.sales_linkedin_configurationid=t.entities[0].sales_linkedin_configurationid,o.store.getState().salesSettings.sales_linkedin_enable_feature=t.entities[0].sales_linkedin_enable_feature,o.store.getState().salesSettings.sales_linkedin_profile_feature=t.entities[0].sales_linkedin_profile_feature,o.store.getState().salesSettings.is_linkedin_installed=!0):(console.log("sales_linkedin_configuration entity settings are null"),o.store.getState().salesSettings.sales_linkedin_configurationid="",o.store.getState().salesSettings.sales_linkedin_enable_feature=!1,o.store.getState().salesSettings.sales_linkedin_profile_feature=!1,o.store.getState().salesSettings.is_linkedin_installed=!1),console.log("sales_linkedin_configurations <<"),[3,4];case 3:return a=r.sent(),console.log(a),2147868684==a.errorCode&&(o.store.getState().salesSettings.is_linkedin_installed=!1),console.error("LoadLinkedInSettings: "+a.message),[3,4];case 4:i=new p.RetrieveTenantAdminPermissionsRequest,r.label=5;case 5:return r.trys.push([5,9,,10]),[4,window.Xrm.WebApi.online.execute(i)];case 6:return(s=r.sent())?[4,s.json()]:[3,8];case 7:l=r.sent();try{console.log("tenantInfo recieved"),"true"==JSON.parse(l.AdminPermissions).isCurrentUserTenantAdmin.toLowerCase()&&(console.log("current user is Tenant admin"),o.store.getState().salesSettings.is_tenant_admin=!0)}catch(e){console.log(e)}r.label=8;case 8:return[3,10];case 9:return c=r.sent(),console.log(c),[3,10];case 10:return e.FetchLinkedInUpdatesStatus(),console.log("LoadLinkedInSettings <<"),[2]}}))}))},e.LoadPDFSettings=function(){return a(this,void 0,void 0,(function(){var e,t,n,i,s,l,c=this;return r(this,(function(u){switch(u.label){case 0:console.log("LoadPDFSettings >>"),e=["account","contact","lead","opportunity","quote","salesorder","invoice"],t=window.Xrm.Utility.getGlobalContext().organizationSettings,n="?$select=ispdfgenerationenabled",u.label=1;case 1:return u.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",t.organizationId,n)];case 2:return i=u.sent(),console.log("ispdfgenerationenabled <success>"),console.log(i),s=JSON.parse(i.ispdfgenerationenabled),console.log(s),console.log(s.account),console.log(s.contact),console.log(s.lead),console.log(s.opportunity),console.log(s.quote),console.log(s.salesorder),console.log(s.invoice),console.log("end"),e.forEach((function(e){o.store.getState().salesSettings.pdf_settings.set(e,s[e])})),[3,4];case 3:return l=u.sent(),console.log("ispdfgenerationenabled <failed>"),console.error(l),[3,4];case 4:return e.forEach((function(e){return a(c,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,window.Xrm.Utility.getEntityMetadata(e,["DisplayName"])];case 1:return t=n.sent(),o.store.getState().salesSettings.pdf_entityDisplayNames.set(e,t.DisplayName),[3,3];case 2:return n.sent(),o.store.getState().salesSettings.pdf_entityDisplayNames.set(e,e),[3,3];case 3:return[2]}}))}))})),[2]}}))}))},e.LoadCandI=function(){return a(this,void 0,void 0,(function(){var e,t,n,a,i,s,l,c,u,d,g,p,_,h,S;return r(this,(function(r){switch(r.label){case 0:console.log("LoadCandI >>"),e=window.Xrm.Utility.getGlobalContext().organizationSettings,t="?$select=ismsteamsenabled",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,t)];case 2:return n=r.sent(),console.log("ismsteamsenabled <success>"),console.log(n),l=n.ismsteamsenabled,console.log(l),o.store.getState().salesSettings.is_msteams_basic_enabled=l,[3,4];case 3:return a=r.sent(),console.log("ismsteamsenabled <failed>"),console.error(a),[3,4];case 4:i="?$select=ismsteamscollaborationenabled",r.label=5;case 5:return r.trys.push([5,7,,8]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,i)];case 6:return s=r.sent(),console.log("ismsteamscollaborationenabled <success>"),console.log(s),l=s.ismsteamscollaborationenabled,console.log(l),o.store.getState().salesSettings.is_msteams_advanced_enabled=l,[3,8];case 7:return c=r.sent(),console.log("ismsteamscollaborationenabled <failed>"),console.error(c),[3,8];case 8:u=["LogicalName"],d=new f.RetrieveEntityDefinitions("",u),r.label=9;case 9:return r.trys.push([9,13,,14]),[4,window.Xrm.WebApi.online.execute(d)];case 10:return(g=r.sent())?[4,g.json()]:[3,12];case 11:p=r.sent();try{for(o.store.getState().salesSettings.entityList=[],_=p.value,h=0;h<_.length;h++)o.store.getState().salesSettings.entityList.push(_[h].LogicalName)}catch(e){console.log(e)}r.label=12;case 12:return[3,14];case 13:return S=r.sent(),console.log(S),[3,14];case 14:return console.log("LoadCandI <<"),[2]}}))}))},e.LoadImproveProductivitySettings=function(){return a(this,void 0,void 0,(function(){var e,t,n,a,i,s,l;return r(this,(function(r){switch(r.label){case 0:console.log("LoadImproveProductivitySettings >>"),e=window.Xrm.Utility.getGlobalContext().organizationSettings,t="?$select=iscontextualemailenabled",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,t)];case 2:return n=r.sent(),console.log("iscontextualemailenabled <success>"),console.log(n),s=JSON.parse(n.iscontextualemailenabled),console.log(s),o.store.getState().salesSettings.is_contextual_email_enabled=s,[3,4];case 3:return a=r.sent(),console.log("iscontextualemailenabled <failed>"),console.error(a),[3,4];case 4:"?$select=businesscardoptions";try{i=window.Xrm.WebApi.retrieveRecord("organization",e.organizationId,"?$select=businesscardoptions"),console.log("businesscardoptions <success>"),console.log(i),s=JSON.parse(i.businesscardoptions),console.log(s),l=s.StoreBusinessCardImage,o.store.getState().salesSettings.store_business_card_image="true"===l}catch(e){console.log("businesscardoptions <failed>"),console.error(e)}return console.log("LoadImproveProductivitySettings <<"),[2]}}))}))},e.SetProperty=function(t,n,a,r){if(console.log("SetProperty >>"),e.isXrmEnabled()){var i={};i[a]=r,e.updateRecordWithSpinner(t,n,i)}console.log("SetProperty <<")},e.updateRecordWithSpinner=function(e,t,n){window.Xrm.Utility.showProgressIndicator(_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_Processing)),window.Xrm.WebApi.updateRecord(e,t,n).then((function(){window.Xrm.Utility.closeProgressIndicator(),window.Xrm.UI.addGlobalNotification(1,1,_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_ToastMessage_Success),"",null)}),(function(e){window.Xrm.Utility.closeProgressIndicator(),window.Xrm.UI.addGlobalNotification(1,2,_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_ToastMessage_Failure),"",null)}))},e.SetQualifyLeadExperience=function(t){if(console.log("SetQualifyLeadExperience >>"),e.isXrmEnabled()){var n={},a='{"DefaultQualifyFlow":"'+String(t)+'"}';n.qualifyleadadditionaloptions=a;var r=window.Xrm.Utility.getGlobalContext().organizationSettings;e.updateRecordWithSpinner("organization",r.organizationId,n)}console.log("SetQualifyLeadExperience <<")},e.SetBusinessCardOptions=function(t){if(console.log("SetBusinessCardOptions >>"),e.isXrmEnabled()){var n={},a='{"StoreBusinessCardImage":"'+String(t)+'"}';n.businesscardoptions=a;var r=window.Xrm.Utility.getGlobalContext().organizationSettings;e.updateRecordWithSpinner("organization",r.organizationId,n)}console.log("SetBusinessCardOptions <<")},e.SetPDFSettings=function(){var t;if(console.log("SetPDFSettings >>"),e.isXrmEnabled()){var n={};o.store.getState().salesSettings.pdf_settings.forEach((function(e,t){console.log(t,e),n[t]=e})),console.log(n);var a=window.Xrm.Utility.getGlobalContext().organizationSettings;e.updateRecordWithSpinner("organization",a.organizationId,((t={}).ispdfgenerationenabled=JSON.stringify(n),t))}console.log("SetPDFSettings <<")},e.IsFCBEnabled=function(e){return window.Xrm.Internal.isFeatureEnabled(e)},e.EnableSharePoint=function(){return a(this,void 0,void 0,(function(){var t,n,a;return r(this,(function(r){switch(r.label){case 0:return console.log("EnableSharePoint >>"),e.isXrmEnabled()?(t=new s.EnableSharePointRequest,[4,window.Xrm.WebApi.online.execute(t)]):[3,2];case 1:return n=r.sent(),console.log(n),a=n.OperationResult,console.log(a),[2,a];case 2:return[2,!1]}}))}))},e.EnableMSTeamsDocumentManagement=function(t){return a(this,void 0,void 0,(function(){var n,a,i,s,c,u,d;return r(this,(function(r){switch(r.label){case 0:if(console.log("EnableMSTeamsDocumentManagement >>"),!e.isXrmEnabled())return[3,2];for(n=[],a=0,i=t;a<i.length;a++)s=i[a],o.store.getState().salesSettings.entityList.indexOf(s)>-1&&n.push(s);return console.log("Filtered entity list"),console.log(n),console.log(n.length),console.log(t.length),console.log(o.store.getState().salesSettings.entityList.length),console.log(JSON.stringify(n)),c=new l.EnableMSTeamsDocumentManagementRequest(!0,JSON.stringify(n)),[4,window.Xrm.WebApi.online.execute(c)];case 1:return u=r.sent(),console.log(u),d=u.OperationResult,console.log(d),[2,d];case 2:return[2,!1]}}))}))},e.enableLinkedInUpdates=function(){return a(this,void 0,void 0,(function(){var t;return r(this,(function(n){return console.log("enableLinkedInUpdates >>"),e.isXrmEnabled()?(t=new d.EnableLinkedInDataValidationRequest,[2,window.Xrm.WebApi.online.execute(t)]):(console.log("enableLinkedInUpdates <<"),[2])}))}))},e.isUCI=function(){var e=window.Xrm;return e&&e.Internal&&e.Internal.isUci()},e.disableLinkedInUpdates=function(){return a(this,void 0,void 0,(function(){var t;return r(this,(function(n){return console.log("disableLinkedInUpdates >>"),e.isXrmEnabled()?(t=new g.DisableLinkedInDataValidationRequest(i.Disable),[2,Xrm.WebApi.online.execute(t)]):(console.log("disableLinkedInUpdates <<"),[2])}))}))},e.FetchLinkedInUpdatesStatus=function(){return a(this,void 0,void 0,(function(){var e,t;return r(this,(function(n){return console.log("FetchLinkedInUpdatesStatus >>"),e=new u.IsLinkedInDataValidationEnabledRequest,(t=Xrm.WebApi.online.execute(e)).then((function(e){null!=e&&(console.log(e),e.json().then((function(e){if(null!=e.Result){var t=JSON.parse(e.Result);console.log(t);var n={orchestrationInstanceId:t?t.orchestrationInstanceId:null,dataValidationSetting:!!t&&t.isDataValidationEnabled,status:t&&t.customStatus&&t.customStatus.status?t.customStatus.status.result:null,errorMsg:t&&t.customStatus&&t.customStatus.status?t.customStatus.status.errorCode:null,lastRefreshTime:t&&t.customStatus?t.customStatus.lastRefreshTime:null,nextRefreshTime:t&&t.customStatus?t.customStatus.nextRefreshTime:null};if(console.log(n.status),console.log(n.dataValidationSetting),console.log(n.lastRefreshTime),console.log(n.nextRefreshTime),null==n.errorMsg||40004!=n.errorMsg&&40003!=n.errorMsg?n.errorMsg="UNEXPECTED_ERROR":n.errorMsg="CRM_SYNC_UNAVAILABLE",o.store.getState().salesSettings.sales_enable_linkedin_updates=n.dataValidationSetting,n.dataValidationSetting){var a="",r="",i="";if(null!=t&&null!=t.customStatus&&null!=t.customStatus.status&&0==t.customStatus.status.result.localeCompare("Queued"))a="On (pending)",r=new Date(n.nextRefreshTime).toString(),i=_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_LI_Status)+" "+a+_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_LI_Status_NextRefresh)+" "+r;else if(null!=t&&null!=t.customStatus&&null!=t.customStatus.status&&0==t.customStatus.status.result.localeCompare("Terminated")){a="Disabled",r=new Date(n.lastRefreshTime).toString(),i=_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_LI_Status)+" "+a+_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_LI_Status_LastRefresh)+" "+r}else null!=t&&null!=t.customStatus&&null!=t.customStatus.status&&0==t.customStatus.status.result.localeCompare("Success")?(a="On",i=_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_LI_Status)+" "+a):null!=t&&null!=t.customStatus&&null!=t.customStatus.status&&0==t.customStatus.status.result.localeCompare("Failed")?(a="On",i=_.GlobalLocalizedStringsProvider.GetString(h.STRING_KEYS.Label_LI_Status)+" "+a):null!=t&&null!=t.customStatus&&null!=t.customStatus.status&&(console.log("Neither Queued/Terminated"),console.log(t.customStatus.status.result),console.log(n.status));console.log(i),o.store.getState().salesSettings.sales_enable_linkedin_updates_status=i}else o.store.getState().salesSettings.sales_enable_linkedin_updates_status=""}}),(function(e){console.log(e),o.store.getState().salesSettings.sales_enable_linkedin_updates_status=""})))})),t.catch((function(e){console.log(e),o.store.getState().salesSettings.is_linkedin_installed=!1})),console.log("FetchLinkedInUpdatesStatus <<"),[2]}))}))},e}();t.XrmHelper=S}});