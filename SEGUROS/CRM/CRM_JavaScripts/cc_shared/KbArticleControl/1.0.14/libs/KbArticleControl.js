var MscrmControls;(function(MscrmControls){var KbArticleControl;(function(KbArticleControl){"use strict";var Constants=function(){function Constants(){}Constants.NumberOfViewsIconToolTip="SearchWidget.SearchKMArticles.NumberOfViewsToolTip";Constants.ModifiedOnLabelToolTip="SearchWidget.SearchKMArticles.LastModifiedDateLabelToolTip";Constants.ArticleAssociatedTag="SearchWidget.ArticleTagLabel.Associated";Constants.ArticleAssociatedTagToolTip="SearchWidget.ArticleIconToolTip.Associated";Constants.RatingIconToolTip="SearchWidget.SearchKMArticles.RatingIconToolTip";Constants.NumberOfRatingToolTip="SearchWidget.SearchKMArticles.NumberOfRatingToolTip";Constants.ModifiedOnLabel="SearchWidget.SearchKMArticles.LastModifiedDateLabel";Constants.AllDraftArticlesResourceName="SearchWidget.Filters.AllDraftArticles";Constants.AllPublishedArticlesResourceName="SearchWidget.Filters.AllPublishedArticles";Constants.AllApprovedArticlesResourceName="SearchWidget.Filters.AllApprovedArticles";Constants.WebresourceNameArticleActions="ArticleActions";Constants.EnterKeyValue="Enter";Constants.ServerSearchFailure="SearchWidget.SearchKMArticles.ServerFailure";Constants.KBArticleControlID="kbarticle";Constants.GLOBAL_NOTIFICATION_TYPE_TOAST=1;Constants.GLOBAL_NOTIFICATION_LEVEL_SUCCESS=1;return Constants}();KbArticleControl.Constants=Constants})(KbArticleControl=MscrmControls.KbArticleControl||(MscrmControls.KbArticleControl={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var KbArticleControl;(function(KbArticleControl_1){"use strict";var KbArticleControl=function(){function KbArticleControl(){this.isInitialized=false}KbArticleControl.prototype.init=function(context,notifyOutputChanged,state,container){var _this=this;this._context=context;MscrmControls.KbCommonUtils.FCBUtil.SetCustomerEnabledWaves(context);if(MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)){MscrmControls.KbCommonUtils.ActionOperationRegistration.RegisterAllActions();this._stateManager=KbArticleControl_1.StateManager.Instance(KbArticleControl_1.Constants.KBArticleControlID,true);!this.isInitialized&&this.fetchControlInitSettings().then(function(value){_this.isInitialized=true;_this.kmPrivileges=value.KMPrivileges;_this.useExternalKMPortal=value.UseExternalKMPortal;_this.externalKMPortalURL=value.ExternalKMPortalURL;_this._context.utils.requestRender()},function(error){var errorMessage=error&&error.message||error&&error.error&&error.error.message||"";_this.UpdateErrorStateInContext(context,KbArticleControl_1.Constants.ServerSearchFailure,false,errorMessage)});this._stateManager.InitializeModels(this._context);if(MscrmControls.KbCommonUtils.ActionOperationUtils.IsInArticlePageContext())document.title=MscrmCommon.ControlUtils.String.Format(context.resources.getString("KbArticlePage.Standalone.PageTitle"),context.parameters.article.title)}};KbArticleControl.prototype.UpdateErrorStateInContext=function(context,errorMessage,isControlDisabled,errorDescription,additionalProperties){if(isControlDisabled===void 0)isControlDisabled=false;var stateManager=KbArticleControl_1.StateManager.Instance(KbArticleControl_1.Constants.KBArticleControlID);stateManager.errorDetails=errorDescription;stateManager.errorMessage=errorMessage;stateManager.error=true;stateManager.loading=false;additionalProperties&&Object.assign(stateManager,additionalProperties)};KbArticleControl.prototype.fetchControlInitSettings=function(){var entityIdentifier="";if(this._context.page.entityTypeName)entityIdentifier="EntityLogicalName='"+this._context.page.entityTypeName+"'";var kmInitSettingsUrl=this._context.page.getClientUrl()+"/api/data/v9.0/RetrieveKMControlInitializationSettings("+entityIdentifier+")";return MscrmControls.KbCommonUtils.Fetch(this._context.client.userAgent,MscrmControls.KbCommonUtils.GET_METHOD,kmInitSettingsUrl).then(function(parsedValue){return JSON.parse(parsedValue.Result)})};KbArticleControl.prototype.IsKbArticlePageType=function(){return window&&window.location&&window.location.href&&window.location.href.toLowerCase().indexOf("kbarticle")>-1};KbArticleControl.prototype.updateView=function(context){this._context=context;if(MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)){this._stateManager.kmPrivileges=this.kmPrivileges;this._stateManager.useExternalKMPortal=this.useExternalKMPortal;this._stateManager.externalKMPortalURL=this.externalKMPortalURL;MscrmControls.KbCommonUtils.KbCommonControlLocale.initialize(function(id){return context.resources.getString(id)})}return this.render(false)};KbArticleControl.prototype.renderArticleMetadata=function(){if(this.KbSearchResultLegendsObject==null){this.KbSearchResultLegendsObject=new KbArticleControl_1.KbSearchResultLegends;this.KbSearchResultLegendsObject.init(this._context)}var resultLegends=this.KbSearchResultLegendsObject.render(this._context.parameters.article);return this._context.factory.createElement("Container",{id:"kbSearchResults.footer.id_test",key:"kbSearchResults.footer.id",style:{width:"100%",display:"flex"}},resultLegends)};KbArticleControl.prototype.renderArticleTitle=function(title){return this._context.factory.createElement("LABEL",{id:"contentPaneArticleTitle",style:{fontFamily:this._context.theming.fontfamilies.semibold,fontSize:MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)?this._context.theming.fontsizes.font175:this._context.theming.fontsizes.font125,color:this._context.theming.colors.grays.gray06,textOverflow:"ellipsis",overflow:"hidden",width:"100%",maxWidth:"100%",height:"2em",whiteSpace:"normal"}},title)};KbArticleControl.prototype.renderArticleActions=function(articleRecord,isPopupControl,describedByElementId){var articleActionsObject=new KbArticleControl_1.ArticleActions;articleActionsObject.init(this._context);return articleActionsObject.render(articleRecord,isPopupControl,this._context.accessibility.getUniqueId(describedByElementId))};KbArticleControl.prototype.renderControlBlock=function(isPopupControl){if(isPopupControl===void 0)isPopupControl=false;var controlBlock=[],title=this._context.parameters.article.title,renderArticleTitle=this.renderArticleTitle(title),articleTitleProps={id:"ContentPaneArticleName",key:"ContentPaneArticleNameDiv",style:{marginTop:MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)?this._context.theming.measures.measure125:this._context.theming.measures.measure100,marginBottom:MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)?this._context.theming.measures.measure125:this._context.theming.measures.measure025,width:"100%"}},articleMetadataProps={id:"ContentPaneArticleMetadata",key:"ContentPaneArticleMetadatadiv",style:{minHeight:"20px",marginTop:this._context.theming.measures.measure025,width:"100%"}},controlBlockProps={id:"controlBlockArticleInfoHeaderReadPane",key:"controlBlockArticleInfoReadPanelDiv",ref:"controlBlockArticleInfoReadPanelDiv"};if(MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)){var articleTitleId="articleTitle"+this._context.parameters.article.knowledgeArticleId,rowsForActionRender=this.renderArticleActions(this._context.parameters.article,isPopupControl,articleTitleId);if(this.IsKbArticlePageType()&&rowsForActionRender!=null){var actionDiv=this._context.factory.createElement("Container",{id:"contentPaneArticleActionsContainer",key:"kbSearchResults.action",style:{width:"100%",height:this._context.theming.measures.measure175,marginRight:this._context.client.isRTL?this._context.theming.measures.measure100:0,position:"relative",borderBottom:"1px solid #ccc",paddingBottom:this._context.theming.measures.measure125}},rowsForActionRender);controlBlock.push(actionDiv)}articleTitleProps.style["display"]="block";articleMetadataProps.style["display"]="block";controlBlockProps.style={width:"100%",display:"block",maxWidth:"100%",margin:"auto"};if(MscrmControls.KbCommonUtils.ActionOperationUtils.IsInArticlePageContext())controlBlockProps.style["maxWidth"]=this._context.theming.breakpoints.dimensionm}controlBlock.push(this._context.factory.createElement("Container",articleTitleProps,renderArticleTitle));controlBlock.push(this._context.factory.createElement("Container",articleMetadataProps,this.renderArticleMetadata()));return this._context.factory.createElement("Container",controlBlockProps,controlBlock)};KbArticleControl.prototype.render=function(isPopupControl){return this.renderControlBlock(isPopupControl)};KbArticleControl.prototype.getOutputs=function(){return null};KbArticleControl.prototype.destroy=function(){};return KbArticleControl}();KbArticleControl_1.KbArticleControl=KbArticleControl})(KbArticleControl=MscrmControls.KbArticleControl||(MscrmControls.KbArticleControl={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var KbArticleControl;(function(KbArticleControl){"use strict";var StateManager=function(){function StateManager(){this.loading=true}StateManager.Instance=function(controlId,initializingControl){if(initializingControl===void 0)initializingControl=false;if(!StateManager._stateManager[controlId]||initializingControl)StateManager._stateManager[controlId]=new StateManager;return StateManager._stateManager[controlId]};StateManager.prototype.GetkbSearchResultContentPaneObject=function(){};StateManager.prototype.SetSelectedArticle=function(selectedKbSearchRecord,context){};StateManager.prototype.SetIsSearchMode=function(isSearchMode,context){};StateManager.prototype.InitializeModels=function(context){this._context=context};StateManager.prototype.ReportEventToTelemetry=function(actionName){var kbArticleControlEvent=new KbArticleControl.KbArticleEventTelemetry(actionName);KbArticleControl.KbArticleEventTelemetry.reportEvent(this._context,kbArticleControlEvent)};StateManager._stateManager={};return StateManager}();KbArticleControl.StateManager=StateManager})(KbArticleControl=MscrmControls.KbArticleControl||(MscrmControls.KbArticleControl={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var KbArticleControl;(function(KbArticleControl){"use strict";var EventName="ucikbarticlecontrol",KbArticleEventTelemetry=function(){function KbArticleEventTelemetry(controlAction){this.eventName=EventName;this.eventParameters=[{name:"Action",value:controlAction},{name:"EventTime",value:new Date}]}KbArticleEventTelemetry.reportEvent=function(context,event){if(context===null)return;context.reporting.reportEvent(event)};return KbArticleEventTelemetry}();KbArticleControl.KbArticleEventTelemetry=KbArticleEventTelemetry})(KbArticleControl=MscrmControls.KbArticleControl||(MscrmControls.KbArticleControl={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var KbArticleControl;(function(KbArticleControl){"use strict";var KbSearchResultLegends=function(){function KbSearchResultLegends(){this._searchUIEnhancementsEnabled=false}KbSearchResultLegends.prototype.init=function(context,notifyOutputChanged,state,container){this._context=context};KbSearchResultLegends.prototype.render=function(kbSearchRecord){var controlBlock=[];this._searchUIEnhancementsEnabled=MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements);var knowledgeArticleViews=kbSearchRecord.knowledgeArticleViews,knowledgeArticleViewsTooltipValue=MscrmCommon.ControlUtils.String.Format(this._context.resources.getString(KbArticleControl.Constants.NumberOfViewsIconToolTip),knowledgeArticleViews.toString()),modifiedOnResourceTooltipValue=this._context.resources.getString(KbArticleControl.Constants.ModifiedOnLabelToolTip),knowledgeArticleViewsLabel=this._context.factory.createElement("LABEL",{id:"knowledgeArticleViews_"+kbSearchRecord.knowledgeArticleId.toString(),key:"knowledgeArticleViews_"+kbSearchRecord.knowledgeArticleId.toString(),title:knowledgeArticleViewsTooltipValue,accessibilityHidden:true,tabIndex:-1,style:{fontSize:this._searchUIEnhancementsEnabled?this._context.theming.fontsizes.font085:"",lineHeight:this._searchUIEnhancementsEnabled?this._context.theming.fontsizes.font115:""}},knowledgeArticleViews),knowledgeArticleViewsAccessibilityLabel=this._context.factory.createElement("LABEL",{id:"knowledgeArticleViewsAccessibilityLabel_"+kbSearchRecord.knowledgeArticleId.toString(),key:"knowledgeArticleViewsAccessibilityLabel_"+kbSearchRecord.knowledgeArticleId.toString(),style:MscrmControls.KbCommonUtils.Constants.AccessibilityLabelStyle},knowledgeArticleViewsTooltipValue),rating=kbSearchRecord.rating?kbSearchRecord.rating:0,ratingAccessibilityLabelText=MscrmCommon.ControlUtils.String.Format(KbArticleControl.Constants.NumberOfRatingToolTip,rating.toString()),ratingTooltipValue=KbArticleControl.Constants.RatingIconToolTip,ratingLabel=this._context.factory.createElement("LABEL",{id:"rating_"+kbSearchRecord.knowledgeArticleId.toString(),key:"rating_"+kbSearchRecord.knowledgeArticleId.toString(),title:ratingAccessibilityLabelText,accessibilityHidden:true,tabIndex:-1,style:{fontSize:this._searchUIEnhancementsEnabled?this._context.theming.fontsizes.font085:"",lineHeight:this._searchUIEnhancementsEnabled?this._context.theming.fontsizes.font115:""}},rating),ratingAccessibilityLabel=this._context.factory.createElement("LABEL",{id:"ratingAccessibilityLabel_"+kbSearchRecord.knowledgeArticleId.toString(),key:"ratingAccessibilityLabel_"+kbSearchRecord.knowledgeArticleId.toString(),style:MscrmControls.KbCommonUtils.Constants.AccessibilityLabelStyle},ratingAccessibilityLabelText);if(kbSearchRecord.modifiedOn){var modifiedOnValue,formattedDateTime=this._context.formatting.formatTime(new Date(kbSearchRecord.modifiedOn.toString()),1).split(/\s/);modifiedOnValue=formattedDateTime.length>1?formattedDateTime[0]:""}modifiedOnResourceTooltipValue=modifiedOnResourceTooltipValue.concat(" "+modifiedOnValue);var modifiedOnValueLabel=this._context.factory.createElement("LABEL",{id:"modifiedOnValue",key:"modifiedOnValue",style:{padding:this._searchUIEnhancementsEnabled?"":"0 0 0 3px",fontSize:this._searchUIEnhancementsEnabled?this._context.theming.fontsizes.font085:this._context.theming.fontsizes.font100,lineHeight:this._searchUIEnhancementsEnabled?this._context.theming.fontsizes.font115:"",color:this._context.theming.colors.grays.gray05},title:modifiedOnResourceTooltipValue,accessibilityLabel:modifiedOnResourceTooltipValue},modifiedOnValue),modifiedOnResourceValue=this._context.resources.getString(KbArticleControl.Constants.ModifiedOnLabel),modifiedOnResourceLabel=this._context.factory.createElement("LABEL",{id:"modifiedOnResourceValue_"+kbSearchRecord.knowledgeArticleId.toString(),key:"modifiedOnResourceValue_"+kbSearchRecord.knowledgeArticleId.toString(),style:{fontSize:this._context.theming.fontsizes.font100,color:this._context.theming.colors.grays.gray05},title:modifiedOnResourceTooltipValue,accessibilityHidden:true},modifiedOnResourceValue);if(MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)){var props=modifiedOnResourceLabel.getProperties();props.style["paddingLeft"]="5px";props.style["paddingRight"]="5px"}var modifiedOnDiv=this._context.factory.createElement("Container",{id:"kbSearchResults.footerDivModifiedOn",key:"kbSearchResults.footerDivModifiedOn",style:{whiteSpace:"nowrap",flexWrap:"wrap",marginLeft:this._context.client.isRTL?this._context.theming.measures.measure100:0,marginRight:this._context.client.isRTL?0:this._context.theming.measures.measure100,display:"flex"}},[this._searchUIEnhancementsEnabled?null:modifiedOnResourceLabel,modifiedOnValueLabel]),numberOfViewsIconId="microsoftIcon_numberOfViewsButton_",numberOfViewsIcon=this._context.factory.createElement("MICROSOFTICON",{id:numberOfViewsIconId,key:numberOfViewsIconId,type:176,accessibilityHidden:true,tabIndex:-1}),numberOfViewsIconDiv=this._context.factory.createElement("Container",{id:"numberOfViewsIcon",key:"numberOfViewsIconDiv",ref:"numberOfViewsIconDiv",style:{whiteSpace:"nowrap",display:"inline-block",paddingLeft:this._context.client.isRTL?this._context.theming.measures.measure025:0,paddingRight:this._context.client.isRTL?0:this._context.theming.measures.measure025,fontSize:"16px"},title:knowledgeArticleViewsTooltipValue},[numberOfViewsIcon,knowledgeArticleViewsAccessibilityLabel]);controlBlock.push(numberOfViewsIconDiv,knowledgeArticleViewsLabel);this._searchUIEnhancementsEnabled&&controlBlock.push(this.renderMetadataSeparator(MscrmControls.KbCommonUtils.Constants.NumberOfViews,kbSearchRecord.knowledgeArticleId.toString()));if(this._context.parameters.enableRating!=="false"){var ratingFullIconId="microsoftIcon_ratingFullButton_",ratingFullIcon=this._context.factory.createElement("MICROSOFTICON",{id:ratingFullIconId,key:ratingFullIconId,type:this._searchUIEnhancementsEnabled?431:16,accessibilityHidden:true,tabIndex:-1}),ratingFullIconDiv=this._context.factory.createElement("Container",{id:"ratingFullIcon",key:"ratingFullIconDiv",ref:"ratingFullIconDiv",style:{whiteSpace:"nowrap",display:"inline-block",marginLeft:this._searchUIEnhancementsEnabled?"":this._context.client.isRTL?0:this._context.theming.measures.measure100,marginRight:this._searchUIEnhancementsEnabled?"":this._context.client.isRTL?this._context.theming.measures.measure100:0,paddingLeft:this._context.client.isRTL?this._context.theming.measures.measure025:0,paddingRight:this._context.client.isRTL?0:this._context.theming.measures.measure025,fontSize:"16px"},title:this._searchUIEnhancementsEnabled?ratingAccessibilityLabelText:ratingTooltipValue,accessibilityLabel:this._searchUIEnhancementsEnabled?ratingAccessibilityLabelText:ratingTooltipValue},[ratingFullIcon,ratingAccessibilityLabel]);this._searchUIEnhancementsEnabled?controlBlock.unshift(ratingFullIconDiv,ratingLabel,this.renderMetadataSeparator(MscrmControls.KbCommonUtils.Constants.Rating,kbSearchRecord.knowledgeArticleId.toString())):controlBlock.push(ratingFullIconDiv,ratingLabel)}var footerDivRatingandArticleView=this._context.factory.createElement("Container",{id:"kbSearchResults.footerDivRatingandArticleView",key:"kbSearchResults.footerDivRatingandArticleView",style:{whiteSpace:"normal",display:"flex",flexWrap:"nowrap"}},controlBlock),headerIconBlockStyle=MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)?{width:"100%"}:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%"},headerIconsBlockList=MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)?[footerDivRatingandArticleView,modifiedOnDiv]:[modifiedOnDiv,footerDivRatingandArticleView];if(this._searchUIEnhancementsEnabled&&kbSearchRecord.isAssociated){var linkedTooltipValue=MscrmCommon.ControlUtils.String.Format(this._context.resources.getString(KbArticleControl.Constants.ArticleAssociatedTagToolTip),this._context.parameters.entityDisplayName),linkedArticleLabel=this._context.factory.createElement("LABEL",{id:"kbArticleLinked_"+kbSearchRecord.knowledgeArticleId.toString(),key:"kbArticleLinked_"+kbSearchRecord.knowledgeArticleId.toString(),title:linkedTooltipValue,accessibilityLabel:linkedTooltipValue,style:{color:"#323130",fontSize:this._context.theming.fontsizes.font085,lineHeight:this._context.theming.fontsizes.font115}},MscrmCommon.ControlUtils.String.Format(this._context.resources.getString(KbArticleControl.Constants.ArticleAssociatedTag),this._context.parameters.entityDisplayName)),linkedArticle=this._context.factory.createElement("Container",{id:"kbArticle.LinkedArticle_"+kbSearchRecord.knowledgeArticleId.toString(),key:"kbArticle.LinkedArticle_"+kbSearchRecord.knowledgeArticleId.toString(),style:{color:"#fff",backgroundColor:"#CCDEFF",borderRadius:"2px",padding:"1px 5px"}},linkedArticleLabel);headerIconsBlockList.unshift(linkedArticle);var props=footerDivRatingandArticleView.getProperties();props.style["paddingLeft"]=this._context.theming.measures.measure075;props.style["paddingRight"]=this._context.theming.measures.measure075}var headerIconsBlock=this._context.factory.createElement("Container",{id:"controlBlockHeaderIconPane",key:"controlBlockHeaderIconPaneDiv",ref:"controlBlockHeaderIconPaneDiv",className:"controlBlockHeaderIconPane",style:headerIconBlockStyle},headerIconsBlockList);return headerIconsBlock};KbSearchResultLegends.prototype.renderMetadataSeparator=function(separatorId,kbArticleId){return this._context.factory.createElement("LABEL",{id:"articleMetadataSeparator_"+separatorId+"_"+kbArticleId+"_"+(!MscrmControls.KbCommonUtils.ActionOperationUtils.IsInArticlePageContext?this._context.parameters.controlId:""),key:"articleMetadataSeparator_"+separatorId+"_"+kbArticleId+"_"+(!MscrmControls.KbCommonUtils.ActionOperationUtils.IsInArticlePageContext?this._context.parameters.controlId:""),style:{fontSize:this._context.theming.fontsizes.font085,paddingLeft:this._context.theming.measures.measure050,paddingRight:this._context.theming.measures.measure050,fontWeight:800}},MscrmControls.KbCommonUtils.Constants.MiddleDotUnicode)};KbSearchResultLegends.prototype.getOutputs=function(){return null};KbSearchResultLegends.prototype.destroy=function(){};KbSearchResultLegends.prototype.onPreNavigation=function(){};return KbSearchResultLegends}();KbArticleControl.KbSearchResultLegends=KbSearchResultLegends})(KbArticleControl=MscrmControls.KbArticleControl||(MscrmControls.KbArticleControl={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var KbArticleControl;(function(KbArticleControl){"use strict";var ArticleActions=function(){function ArticleActions(){this.searchUIEnhancementsEnabled=false}ArticleActions.prototype.init=function(context,notifyOutputChanged,state,container){this._stateManager=KbArticleControl.StateManager.Instance(KbArticleControl.Constants.KBArticleControlID);this._context=context;this.searchUIEnhancementsEnabled=MscrmControls.KbCommonUtils.FCBUtil.IsFeatureEnabled(this._context,MscrmControls.KbCommonUtils.FCBUtil.SearchUIEnhancements)};ArticleActions.prototype.handleArticleActionClick=function(articleActionId,articleRecord,articleActions){var _this=this;MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostStartMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"handleArticleActionClick","");var selectedArticleActionId=articleActionId,selectedKnowledgeArticleId=articleRecord.knowledgeArticleId;if(selectedArticleActionId<0||!selectedKnowledgeArticleId){MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostEndMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"handleArticleActionClick","");return}if(!MscrmControls.KbCommonUtils.ArticleAction[selectedArticleActionId]){MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostEndMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"handleArticleActionClick","");return}MscrmControls.KbCommonUtils.ActionOperationFactory.Instance.Execute(selectedArticleActionId,{controlContext:this._context,record:articleRecord,stateManager:this._stateManager});this.reportActionToTelemetry(selectedArticleActionId);setTimeout(function(){if(articleActionId>=2)return;var articleActionElementId="articleActionsFirstAction";if(articleActionId===1)articleActionElementId="articleActionsSecondAction";var uniqueId=_this._context.accessibility.getUniqueId(articleActionElementId);_this._context.accessibility.focusElementById(uniqueId)},0);MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostEndMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"handleArticleActionClick","")};ArticleActions.prototype.GetMicrosoftSymbolIconByArticleActionId=function(actionId){return MscrmControls.KbCommonUtils.ActionOperationFactory.Instance.GetSymbolCode(actionId)};ArticleActions.prototype.renderArticleActionIcon=function(articleRecord,currentAction,firstAction,secondAction){if(firstAction===void 0)firstAction=false;if(secondAction===void 0)secondAction=false;var prefixString;if(firstAction)prefixString="_firstArticleAction_";else if(secondAction)prefixString="_secondArticleAction_";var menuFlyoutActionIconId="microsoftIcon"+prefixString+articleRecord.knowledgeArticleId.toString()+"_"+currentAction+"_",articleActionsActionTooltip=this.GetLocalizedActionTooltip(currentAction),style;if(firstAction)style={display:"inline-flex",fontSize:this._context.theming.fontsizes.font115,paddingRight:this._context.client.isRTL?"0rem":this._context.theming.measures.measure025,paddingLeft:this._context.client.isRTL?this._context.theming.measures.measure025:"0rem",paddingTop:this._context.theming.measures.measure015};else if(secondAction)style={display:"inline-flex",fontSize:this._context.theming.fontsizes.font115,paddingRight:this._context.client.isRTL?this.searchUIEnhancementsEnabled?0:this._context.theming.measures.measure100:this._context.theming.measures.measure025,paddingLeft:this._context.client.isRTL?this._context.theming.measures.measure025:this.searchUIEnhancementsEnabled?0:this._context.theming.measures.measure100,paddingTop:this._context.theming.measures.measure015};style["color"]=MscrmControls.KbCommonUtils.Constants.COLOR_ACTION_ICON;var menuFlyoutActionIcon=this._context.factory.createElement("MICROSOFTICON",{id:menuFlyoutActionIconId,key:menuFlyoutActionIconId,accessibilityHidden:true,role:"presentation",tabIndex:-1,title:articleActionsActionTooltip,hidden:false,type:this.GetMicrosoftSymbolIconByArticleActionId(currentAction)});return this._context.factory.createElement("Container",{id:"menuFlyoutActionIconContainer_"+menuFlyoutActionIconId,key:"menuFlyoutActionIconContainer_"+menuFlyoutActionIconId,style:style},menuFlyoutActionIcon)};ArticleActions.prototype.getUniqueActionId=function(knowledgeArticleId,actionPosition){return "actionItem_"+actionPosition+"_"+knowledgeArticleId};ArticleActions.prototype.renderActionTitle=function(articleRecord,currentAction,articleActions,firstAction){if(firstAction===void 0)firstAction=false;var actionTitleId=this.getUniqueActionId(articleRecord.knowledgeArticleId,currentAction),articleActionsActionLabel=this._context.resources.getString(this.getArticleActionToLabelNameMapping(currentAction));if(firstAction)return this._context.factory.createElement("LABEL",{id:actionTitleId,key:actionTitleId,role:"button",tabIndex:-1,style:{fontSize:this._context.theming.fontsizes.font100,paddingLeft:this._context.client.isRTL?this.searchUIEnhancementsEnabled?0:this._context.theming.measures.measure100:0,paddingRight:this._context.client.isRTL?0:this.searchUIEnhancementsEnabled?0:this._context.theming.measures.measure100,cursor:"pointer",color:MscrmControls.KbCommonUtils.Constants.COLOR_ACTION_TITLE}},articleActionsActionLabel);else return this._context.factory.createElement("LABEL",{id:actionTitleId,key:actionTitleId,role:"menuitem",tabIndex:-1,style:{fontSize:this._context.theming.fontsizes.font100,cursor:"pointer",color:MscrmControls.KbCommonUtils.Constants.COLOR_ACTION_TITLE}},articleActionsActionLabel)};ArticleActions.prototype.renderInlineActions=function(articleRecord,isPopupControl,describedByElementId,articleActions){var _this=this;MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostStartMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"renderInlineActions","");var childrenActions=[],firstAction=articleActions[0],secondAction=articleActions[1],style={display:"inline-flex",cursor:"pointer",padding:this._context.theming.measures.measure050,":hover":{backgroundColor:MscrmControls.KbCommonUtils.Constants.BGCOLOR_ACTION}},firstActionIcon=this.renderArticleActionIcon(articleRecord,firstAction,true),firstActionTitle=this.renderActionTitle(articleRecord,firstAction,articleActions,true),articleActionsActionLabel=this._context.resources.getString(this.getArticleActionToLabelNameMapping(firstAction)),articleActionsActionTooltip=this.GetLocalizedActionTooltip(firstAction),firstActionContainer=this._context.factory.createElement("CONTAINER",{id:"articleActionsFirstAction_"+articleRecord.knowledgeArticleId.toString(),key:"articleActionsFirstAction",style:style,tabIndex:0,role:"button",title:articleActionsActionTooltip,accessibilityLabel:articleActionsActionLabel,describedByElementId:describedByElementId,onKeyDown:function(event){_this.handleArticleActionsInlineActionKeyDown(event,firstAction,articleRecord,articleActions)},onClick:this.handleArticleActionClick.bind(this,firstAction,articleRecord,articleActions)},[firstActionIcon,firstActionTitle]);childrenActions.push(firstActionContainer);if(secondAction){var secondActionContainer=this.renderSecondAction(articleRecord,describedByElementId,articleActions);childrenActions.push(secondActionContainer)}var result=this._context.factory.createElement("CONTAINER",{id:"articleActionsFirstSecondAction_"+articleRecord.knowledgeArticleId.toString(),key:"articleActionsFirstSecondAction"},childrenActions);MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostEndMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"renderInlineActions","");return result};ArticleActions.prototype.GetLocalizedActionTooltip=function(action){return this._context.resources.getString(this.getArticleActionToTooltipNameMapping(action))};ArticleActions.prototype.renderSecondAction=function(articleRecord,describedByElementId,articleActions){var _this=this;MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostStartMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"renderSecondAction","");var secondAction=articleActions[1],secondActionIcon=this.renderArticleActionIcon(articleRecord,secondAction,false,true),secondActionTitle=this.renderActionTitle(articleRecord,secondAction,articleActions,true),articleActionsActionLabel=this._context.resources.getString(this.getArticleActionToLabelNameMapping(secondAction)),articleActionsActionTooltip=this.GetLocalizedActionTooltip(secondAction),secondActionTitleToolTipText=articleActionsActionTooltip,secondActionContainer=this._context.factory.createElement("CONTAINER",{id:"articleActionsSecondAction_"+articleRecord.knowledgeArticleId.toString(),key:"articleActionsSecondAction",style:{display:"inline-flex",cursor:"pointer",padding:this._context.theming.measures.measure050,borderLeft:this.searchUIEnhancementsEnabled?0:this._context.client.isRTL?0:this._context.theming.borders.border02,borderRight:this.searchUIEnhancementsEnabled?0:this._context.client.isRTL?this._context.theming.borders.border02:0,":hover":{backgroundColor:MscrmControls.KbCommonUtils.Constants.BGCOLOR_ACTION}},tabIndex:0,role:"button",title:articleActionsActionTooltip,accessibilityLabel:articleActionsActionLabel,describedByElementId:describedByElementId,onKeyDown:function(event){_this.handleArticleActionsInlineActionKeyDown(event,secondAction,articleRecord,articleActions)},onClick:this.handleArticleActionClick.bind(this,secondAction,articleRecord,articleActions)},[secondActionIcon,secondActionTitle]);MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostEndMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"renderSecondAction","");return secondActionContainer};ArticleActions.prototype.getArticleActionToLabelNameMapping=function(articleAction){return MscrmControls.KbCommonUtils.ActionOperationFactory.Instance.GetLabel(articleAction)};ArticleActions.prototype.getArticleActionToTooltipNameMapping=function(articleAction){return MscrmControls.KbCommonUtils.ActionOperationFactory.Instance.GetTooltip(articleAction)};ArticleActions.prototype.render=function(articleRecord,isPopupControl,describedByElementId){var _this=this;MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostStartMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"render","");var style,controlBlock=[],articleActions=Object.keys(MscrmControls.KbCommonUtils.ArticleAction).filter(function(val){return parseInt(val,10)>-1}).map(function(strVal){return parseInt(strVal,10)});articleActions=articleActions.filter(function(articleAction){return _this.isActionValid(articleAction,articleRecord)});if(articleActions.length==0)return null;controlBlock.push(this.renderInlineActions(articleRecord,isPopupControl,describedByElementId,articleActions));style={width:"100%",display:"flex"};var result=this._context.factory.createElement("CONTAINER",{id:"articleActions_"+articleRecord.knowledgeArticleId.toString(),key:"articleActions",style:style,className:"mscrm-articleActions"},controlBlock);MscrmControls.KbCommonUtils.TelemetryReporter.Instance.PostEndMarker(this._context,KbArticleControl.Constants.WebresourceNameArticleActions,"render","");return result};ArticleActions.prototype.handleArticleActionsInlineActionKeyDown=function(event,firstAction,articleRecord,articleActions){if(event.key===KbArticleControl.Constants.EnterKeyValue){event.stopPropagation();event.preventDefault();this.handleArticleActionClick(firstAction,articleRecord,articleActions)}};ArticleActions.prototype.isActionValid=function(articleAction,articleRecord){return MscrmControls.KbCommonUtils.ActionOperationFactory.Instance.Validate(articleAction,{controlContext:this._context,record:articleRecord,stateManager:this._stateManager})};ArticleActions.prototype.reportActionToTelemetry=function(id){switch(id){case MscrmControls.KbCommonUtils.ArticleAction.CopyLink:this._stateManager.ReportEventToTelemetry("CopyLinkButtonClicked");break;case MscrmControls.KbCommonUtils.ArticleAction.PrintArticle:this._stateManager.ReportEventToTelemetry("PrintArticleButtonClicked");break}};ArticleActions.prototype.getOutputs=function(){return null};ArticleActions.prototype.destroy=function(){};ArticleActions.prototype.onPreNavigation=function(){};return ArticleActions}();KbArticleControl.ArticleActions=ArticleActions})(KbArticleControl=MscrmControls.KbArticleControl||(MscrmControls.KbArticleControl={}))})(MscrmControls||(MscrmControls={}))