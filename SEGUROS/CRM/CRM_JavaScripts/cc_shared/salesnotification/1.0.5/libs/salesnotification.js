var notificationapp;notificationapp=(()=>{"use strict";var e={470:(e,t,n)=>{n.r(t),n.d(t,{SalesPremiumNotification:()=>r.SalesPremiumNotification});var r=n(769)},769:(e,t,n)=>{e.exports=n(539)},539:(e,t,n)=>{var r,i=(r=n(999))&&"object"==typeof r&&"default"in r?r.default:r,a=n(337),o=n(337),s=n(337),l=n(337),c=n(337);function u(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)}))}}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var d,h,y,S,v=(function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=Object.create((t&&t.prototype instanceof f?t:f).prototype),a=new I(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return{value:void 0,done:!0}}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=E(o,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var u={};function f(){}function p(){}function m(){}var g={};g[i]=function(){return this};var d=Object.getPrototypeOf,h=d&&d(d(L([])));h&&h!==t&&n.call(h,i)&&(g=h);var y=m.prototype=f.prototype=Object.create(g);function S(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function v(e,t){var r;this._invoke=function(i,a){function o(){return new t((function(r,o){!function r(i,a,o,s){var l=c(e[i],e,a);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(f).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,s)}))}s(l.arg)}(i,a,r,o)}))}return r=r?r.then(o,o):o()}}function E(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function L(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:w}}function w(){return{value:void 0,done:!0}}return p.prototype=y.constructor=m,m.constructor=p,p.displayName=s(m,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,s(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},S(v.prototype),v.prototype[a]=function(){return this},e.AsyncIterator=v,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new v(l(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(y),s(y,o,"Generator"),y[i]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=L,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,u):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;_(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:L(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(S={exports:{}}),S.exports);!function(e){e[e.blocked=2]="blocked",e[e.error=1]="error",e[e.info=0]="info",e[e.severeWarning=3]="severeWarning",e[e.success=4]="success",e[e.warning=5]="warning"}(d||(d={})),function(e){e[e.None=0]="None",e[e.Installed=1]="Installed",e[e.Uninstalled=2]="Uninstalled",e[e.InstallRequested=3]="InstallRequested",e[e.UninstallRequested=4]="UninstallRequested",e[e.InstallFailed=5]="InstallFailed",e[e.UninstallFailed=6]="UninstallFailed",e[e.Installing=7]="Installing",e[e.Uninstalling=8]="Uninstalling",e[e.InstallScheduled=9]="InstallScheduled",e[e.InstallRetrying=10]="InstallRetrying",e[e.Loading=11]="Loading"}(h||(h={})),function(e){e[e.None=0]="None",e[e.NoLicenseBar=1]="NoLicenseBar",e[e.InstallingBar=2]="InstallingBar",e[e.InstalledBar=3]="InstalledBar",e[e.NoOfTrialDaysLeftBar=4]="NoOfTrialDaysLeftBar",e[e.TrialEndedBar=5]="TrialEndedBar"}(y||(y={}));var E=function(){function e(e){this.ApiVersion=e}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"msdyn_GetSIPackageStatus",operationType:0,parameterTypes:{ApiVersion:{typeName:"Edm.String",structuralProperty:1}}}},e}(),N=function(){function e(e,t){this.MethodName=e,this.HttpRequestType=t}return e.prototype.getMetadata=function(){return{boundParameter:null,operationName:"msdyn_ExecuteSIRequest",operationType:0,parameterTypes:{MethodName:{typeName:"Edm.String",structuralProperty:1},HttpRequestType:{typeName:"Edm.String",structuralProperty:1}}}},e}(),_=function(){};function I(e,t){return L(e,t)<=0}function L(e,t){var n=Date.parse(e),r=new Date;r.setDate(r.getDate()-t);var i=(n-Number(r))/864e5;return Math.floor(i)}_.SiKeyValueConfigEntityName="msdyn_sikeyvalueconfig",_.SiKeyValueConfigEntityKeyFieldName="msdyn_configkey",_.SiKeyValueConfigEntityValueFieldName="msdyn_configvalue",_.SiKeyValueConfigEntityIdFieldName="msdyn_sikeyvalueconfigid",_.ShowInstallSuccessMessageBar="showInstallSuccessMessageBar",_.GetLicense="getlicense",_.GetValidLicenseInfo="getvalidlicenseinfo",_.Get="get",_.SyncIcon="Sync",_.DiamondIcon="Diamond",_.SalesPremiumNotificationType="SalesPremiumNotificationType",_.RegionSegmentUrlMap=new Map([["crm","https://nam.sales.ai.dynamics.com"],["crm3","https://ccan.sales.ai.dynamics.com"],["crm4","https://weur.sales.ai.dynamics.com"],["crm5","https://seapj.sales.ai.dynamics.com"],["crm6","https://eoce.sales.ai.dynamics.com"],["crm7","https://ejpn.sales.ai.dynamics.com"],["crm8","https://cind.sales.ai.dynamics.com"],["crm10","https://tip1.sales.ai.dynamics.com"],["crm11","https://gbr.sales.ai.dynamics.com"],["crm12","https://cfra.sales.ai.dynamics.com"],["crm17","https://swiss.sales.ai.dynamics.com"]]);var w=function(){function e(){}return e.initLogger=function(e){this.logger=e},e}();function T(){return B.apply(this,arguments)}function B(){return(B=f(v.mark((function e(){var t;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new E("V1"),e.abrupt("return",new Promise((function(e,n){var r,i,a;null==(r=Xrm)||null==(i=r.WebApi)||null==(a=i.online)||a.execute(t).then((function(t){t.ok?t.json().then((function(n){w.logger.logBussinessEvent("SalesNotification.getSalesPackageInstallationStatusV1","Api response is ok.",{response:t});var r=JSON.parse(n.SIPackageStatus),i={PackageStatus:h[String(r.PackageStatus)],Version:r.Version,Error:r.Error};e(i)})):w.logger.logBussinessEvent("SalesNotification.getSalesPackageInstallationStatusV1","Api response is not ok",{response:t})}),(function(e){w.logger.logError("SalesNotification.getSalesPackageInstallationStatusV1",e,"Error in GetSalesPackageInstallationStatus"),n({PackageStatus:h.None,Version:"",Error:e.responseText})}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return k.apply(this,arguments)}function k(){return(k=f(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=f(v.mark((function e(t,n){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:(r=e.sent).HasValidLicenseNow?t(O()):r.IsInternalTrialExpired?r.HasValidLicenseAtInstall?t({SalesNotificationType:y.NoLicenseBar}):r.HasValidLicenseAtInstall?n({SalesNotificationType:y.None}):t({SalesNotificationType:y.TrialEndedBar}):t({SalesNotificationType:y.NoOfTrialDaysLeftBar,NoofTrialDaysLeft:r.NoOfTrialDaysLeft});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(){return D.apply(this,arguments)}function D(){return(D=f(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){var n,r;null==(n=Xrm)||null==(r=n.WebApi)||r.retrieveMultipleRecords("msdyn_sikeyvalueconfig","?$filter=msdyn_configkey eq 'showinstallsuccessmessagebar'").then((function(t){w.logger.logBussinessEvent("SalesPremiumNotification.upsertSiKeyValueConfigMessageBar","Response is Ok.",{response:t}),null!=t&&t.entities.length>0?e("true"==t.entities[0][_.SiKeyValueConfigEntityValueFieldName]):(b(),e(!0))}),(function(e){w.logger.logError("SalesNotification.upsertSiKeyValueConfigMessageBar",e,"Upsert failed for Message Bar."),t(!1)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){var e,t;return null==(e=Xrm)||null==(t=e.WebApi)?void 0:t.createRecord(_.SiKeyValueConfigEntityName,{msdyn_configkey:_.ShowInstallSuccessMessageBar,msdyn_configvalue:"true"}).then((function(){w.logger.logBussinessEvent("SalesNotification.createSiKeyValueConfigMessageBar","SikeyValue record created for Message Bar.")}),(function(e){w.logger.logError("SalesNotification.createSiKeyValueConfigMessageBar",e,"SikeyValue record creation failed for Message Bar")}))}function M(){return R.apply(this,arguments)}function R(){return(R=f(v.mark((function e(){var t;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new N(_.GetValidLicenseInfo,_.Get),e.abrupt("return",new Promise((function(e,n){var r,i;null==(r=Xrm)||null==(i=r.WebApi)||i.online.execute(t).then((function(t){t.ok?t.json().then((function(r){if(null!=r.Response&&""!=r.Response){var i=JSON.parse(r.Response),a={HasValidLicenseNow:i.hasValidLicenseNow,HasValidLicenseAtInstall:i.hasValidLicenseAtInstall,SIAddonInstallationDate:i.siAddonInstallationDate,NoOfTrialDays:i.noOfTrialDays,IsInternalTrialExpired:I(i.siAddonInstallationDate,i.noOfTrialDays),NoOfTrialDaysLeft:L(i.siAddonInstallationDate,i.noOfTrialDays)};w.logger.logBussinessEvent("SalesPremiumNotification.getLicenseInfo","Response is ok.",{response:t}),e(a)}else w.logger.logBussinessEvent("SalesNotification.getLicenseInfo","Api response is not ok",{response:r}),n({HasValidLicenseNow:!1,HasValidLicenseAtInstall:!1,IsInternalTrialExpired:!0})})):w.logger.logBussinessEvent("SalesNotification.getLicenseInfo","Api response is not ok",{response:t})}),(function(e){w.logger.logError("SalesNotification.getLicenseInfo",e,"Error in Get License Info"),n({HasValidLicenseNow:!1,HasValidLicenseAtInstall:!1,IsInternalTrialExpired:!0})}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return A.apply(this,arguments)}function A(){return(A=f(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=f(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P();case 2:t(e.sent?{SalesNotificationType:y.InstalledBar}:{SalesNotificationType:y.None}),n({SalesNotificationType:y.None});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return C.apply(this,arguments)}function C(){return(C=f(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=f(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:e.t0=e.sent.PackageStatus,e.next=e.t0===h.Installing?6:e.t0===h.Installed?8:10;break;case 6:return t({SalesNotificationType:y.InstallingBar}),e.abrupt("break",12);case 8:return t(x()),e.abrupt("break",12);case 10:return t({SalesNotificationType:y.None}),e.abrupt("break",12);case 12:n({SalesNotificationType:y.None});case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V=function(){};V.SALES_PREMIUM_INSTALLED_SUCCESS_LEARN_MORE="https://aka.ms/salesPremiumInstalledSuccessLearnMore",V.ENJOYING_PREMIUM_LEARN_MORE="https://aka.ms/enjoyingPremiumLearnMore",V.SALES_PREMIUM_LICENSE_NOT_AVAILABLE_LEARN_MORE="https://aka.ms/salesPremiumLicenseNotAvailableLearnMore",V.SALES_PREMIUM_TRIAL_ENDED_LEARN_MORE="https://aka.ms/salesPremiumTrialEndedLearnMore",V.GET_SALES_PREMIUM_BUTTON_LINK="https://aka.ms/getSalesPremiumButtonLink";var U=function(){};U.measure00="0px",U.measure02="2px",U.measure04="4px",U.measure05="5px",U.measure06="6px",U.measure08="8px",U.measure10="10px",U.measure12="12px",U.measure14="14px",U.measure16="16px",U.measure18="18px",U.measure20="20px",U.measure21="21px",U.measure22="22px",U.measure24="24px",U.measure28="28px",U.measure32="32px",U.measure48="48px",U.measure75="75px";var F=function(){};F.DynamicsBlue="#2266E3",F.DynamicsBlueDark="#0B53CE",F.DynamicsBlueDarker="#0742AB",F.LinkBlue="#0078d4",F.White="#ffffff",F.WhiteDark="#eaeaea",F.WhiteDarker="#f8f8f8",F.Gray120="#201F1E",F.Gray130="#323130",F.Gray060="#605E5C",F.Gray100="rgba(0, 0, 0, 0.87)",F.Gray090="rgba(0, 0, 0, 0.62)",F.Gray160="#FAF9F8",F.Green4="#DFF6DD",F.Red4="#FDE7E9",F.SevereWarningColor="#fde7e9",F.DynamicsTint="#E7EFFF";var j=function(){};j.SeogeUI="Segoe UI";var W=function(){};W.Normal="normal";var H=function(){};H.Normal="normal",H.Weight300=300,H.Weight400=400,H.Weight500=500,H.Weight600=600;var K=function(){function e(){}return e.messageBarDiv=function(){return{content:{fontFamily:j.SeogeUI,fontStyle:W.Normal,fontWeight:H.Normal,fontSize:U.measure12,lineHeight:U.measure16},iconContainer:{fontSize:U.measure00,minWidth:U.measure00,margin:U.measure00}}},e.messageBarStartingText=function(){return{fontWeight:H.Weight600,padding:U.measure04}},e.noOfTrialDaysLeftBarDiv=function(){return{content:{fontFamily:j.SeogeUI,fontStyle:W.Normal,fontWeight:H.Normal,fontSize:U.measure12,lineHeight:U.measure16,backgroundColor:F.DynamicsTint},iconContainer:{fontSize:U.measure00,minWidth:U.measure00,margin:U.measure00}}},e.messageBarButton=function(){return{backgroundColor:F.White}},e}();function q(){var e,t,n;w.logger.logCustomerEvent("SalesPremiumNotification.setUpPremiumHandler","Set up Premium Button clicked."),null==(e=Xrm)||null==(t=e.Page)||null==(n=t.context)||n.getCurrentAppProperties().then((function(e){window.open("/main.aspx?appid="+e.appId+"&pagetype=control&pagetype=control&controlName=MscrmControls.UnifiedConfigCustomControl.UnifiedConfigCustomControl","_self")}))}function X(){w.logger.logCustomerEvent("SalesPremiumNotification.getSalesPremiumHandler","Get Sales Premium Button clicked."),window.open(V.GET_SALES_PREMIUM_BUTTON_LINK,"_blank")}function z(e,t){return i.createElement(l.MessageBarButton,{onClick:t,text:e,style:K.messageBarButton()})}var J=function(){function e(){}return e.updateStringProvider=function(e){this.stringProvider=e},e.GetString=function(e){return this.stringProvider.getLocalizedString(e)},e}(),Y=function(e){function t(t){var n;return(n=e.call(this,t)||this).handleOnDismiss=n.handleOnDismiss.bind(g(n)),n}m(t,e);var n=t.prototype;return n.handleOnDismiss=function(){this.props.onClose(this.props.type)},n.render=function(){switch(this.props.type){case y.InstallingBar:return i.createElement(o.MessageBar,{messageBarType:d.info,onDismiss:this.handleOnDismiss,isMultiline:!1,styles:K.messageBarDiv()},i.createElement("div",null,i.createElement(a.Icon,{iconName:_.SyncIcon}),i.createElement("span",{style:K.messageBarStartingText()},J.GetString("Getting_Everything_Ready_Title")),J.GetString("Getting_Everything_Ready_Desc")));case y.InstalledBar:return function(e,t){var n=i.createElement(i.Fragment,null);return t||(n=z(J.GetString("Set_Up_Premium"),q)),i.createElement(o.MessageBar,{messageBarType:d.success,onDismiss:e,isMultiline:!1,styles:K.messageBarDiv(),actions:n},i.createElement("div",null,i.createElement(a.Icon,{iconName:_.DiamondIcon}),i.createElement("span",{style:K.messageBarStartingText()},J.GetString("Sales_Premium_Install_Success_Text")),J.GetString("Sales_Premium_Install_Success_Desc"),i.createElement(s.Link,{href:V.SALES_PREMIUM_INSTALLED_SUCCESS_LEARN_MORE,target:"_blank"},J.GetString("Learn_more"))))}(this.handleOnDismiss,this.props.isRiCommon);case y.NoLicenseBar:return function(e){return i.createElement(o.MessageBar,{messageBarType:d.warning,onDismiss:e,isMultiline:!1,styles:K.messageBarDiv(),actions:z(J.GetString("Get_Sales_Premium_Button"),X)},i.createElement("div",null,i.createElement(a.Icon,{iconName:_.DiamondIcon}),i.createElement("span",{style:K.messageBarStartingText()}),J.GetString("No_License_Desc"),i.createElement(s.Link,{href:V.SALES_PREMIUM_LICENSE_NOT_AVAILABLE_LEARN_MORE,target:"_blank"},J.GetString("Learn_more"))))}(this.handleOnDismiss);case y.NoOfTrialDaysLeftBar:return function(e,t){return i.createElement(o.MessageBar,{messageBarType:d.info,onDismiss:e,isMultiline:!1,styles:K.noOfTrialDaysLeftBarDiv(),actions:z(J.GetString("Get_Sales_Premium_Button"),X)},i.createElement("div",null,i.createElement(a.Icon,{iconName:_.DiamondIcon}),i.createElement("span",{style:K.messageBarStartingText()},J.GetString("Enjoying_Premium_Title")),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Array.prototype.slice.call(arguments,1);return t[0].replace(/{(\d+)}/g,(function(e,t){return void 0!==r[t]?r[t]:e}))}(J.GetString("Enjoying_Premium_Desc"),String(t)),i.createElement(s.Link,{href:V.ENJOYING_PREMIUM_LEARN_MORE,target:"_blank"},J.GetString("Learn_more"))))}(this.handleOnDismiss,this.props.daysLeft);case y.TrialEndedBar:return function(e){return i.createElement(o.MessageBar,{messageBarType:d.warning,onDismiss:e,isMultiline:!1,styles:K.messageBarDiv(),actions:z(J.GetString("Get_Sales_Premium_Button"),X)},i.createElement("div",null,i.createElement(a.Icon,{iconName:_.DiamondIcon}),i.createElement("span",{style:K.messageBarStartingText()},J.GetString("Trial_Ended_Title")),J.GetString("Trial_Ended_Desc"),i.createElement(s.Link,{href:V.SALES_PREMIUM_TRIAL_ENDED_LEARN_MORE,target:"_blank"},J.GetString("Learn_more"))))}(this.handleOnDismiss);default:return null}},t}(i.Component),$=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={SalesNotificationType:y.None},n.closeMessageBar=n.closeMessageBar.bind(g(n)),n}m(t,e);var n=t.prototype;return n.closeMessageBar=function(){var e,t,n;"undefined"!=typeof sessionStorage&&null!==sessionStorage&&sessionStorage.setItem(_.SalesPremiumNotificationType,String(this.state.SalesNotificationType)),this.state.SalesNotificationType==y.InstalledBar&&(n={msdyn_configkey:_.ShowInstallSuccessMessageBar,msdyn_configvalue:"false"},null==(e=Xrm)||null==(t=e.WebApi)||t.retrieveMultipleRecords("msdyn_sikeyvalueconfig","?$filter=msdyn_configkey eq 'showinstallsuccessmessagebar'").then((function(e){var t,r;return null==(t=Xrm)||null==(r=t.WebApi)?void 0:r.updateRecord(_.SiKeyValueConfigEntityName,e.entities[0][_.SiKeyValueConfigEntityIdFieldName].toString(),n).then((function(){w.logger.logBussinessEvent("SalesNotification.updateSikeyValueConfigForMessageBar","Update Succeeded")}),(function(e){w.logger.logError("SalesNotification.updateSikeyValueConfigForMessageBar",e,"Update failed.")}))}))),w.logger.logCustomerEvent("SalesNotificationControl","Message Bar is closed"),this.setState(p({},this.state,{SalesNotificationType:y.None}))},n.componentDidMount=function(){this.initState()},n.initState=function(){var e=f(v.mark((function e(){var t,n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:(n=(t=e.sent).SalesNotificationType)==y.InstallingBar?this.startTimer():clearInterval(this.timerID),"undefined"!=typeof sessionStorage&&null!==sessionStorage&&sessionStorage.getItem(_.SalesPremiumNotificationType)&&sessionStorage.getItem(_.SalesPremiumNotificationType)==String(n)?this.setState(p({},this.state,{SalesNotificationType:y.None})):this.setState(p({},this.state,{SalesNotificationType:n,NoofTrialDaysLeft:t.NoofTrialDaysLeft}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.startTimer=function(){var e=this;this.timerID||(this.timerID=setInterval((function(){e.initState()}),2e4))},n.render=function(){return w.logger.logBussinessEvent("SalesNotificationControl","Message Bar rendered is:"+y[this.state.SalesNotificationType]),i.createElement(Y,{onClose:this.closeMessageBar,type:this.state.SalesNotificationType,daysLeft:this.state.NoofTrialDaysLeft,isRiCommon:this.props.isRiCommon})},t}(i.Component);t.SalesPremiumNotification=function(e,t,n){return o=(null==(r=Xrm)||null==(a=r.Utility)?void 0:a.getGlobalContext().getClientUrl()).split("."),_.RegionSegmentUrlMap.has(o[o.length-3])?(J.updateStringProvider(e),w.initLogger(n),c.initializeIcons(),i.createElement($,{isRiCommon:t})):i.createElement(i.Fragment,null," ");var r,a,o}},337:e=>{e.exports=Fabric},999:e=>{e.exports=__React}},t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(470)})();