!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AdaptiveCards=e():t.AdaptiveCards=e()}(window,function(){return n={},r.m=i={"./src/adaptivecards.ts":function(t,i,e){"use strict";function n(t){for(var e in t)i.hasOwnProperty(e)||(i[e]=t[e])}Object.defineProperty(i,"__esModule",{value:!0}),n(e("./src/card-elements.ts")),n(e("./src/enums.ts")),n(e("./src/host-config.ts")),n(e("./src/shared.ts")),n(e("./src/utils.ts"))},"./src/card-elements.ts":function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var c,o,d=i("./src/enums.ts"),h=i("./src/shared.ts"),f=i("./src/utils.ts"),s=i("./src/host-config.ts"),g=i("./src/text-formatters.ts");function a(t,e){t&&t.setCollection(e)}function y(t,e){if(e)for(var i=0;i<e.length;i++)if(t.getJsonTypeName()===e[i])return;return 1}function m(t,e,i,n,r,o,s){var a,l,u,p=null;return e&&"object"==typeof e&&(a=!1,l=f.getStringValue(e.type),i&&0<=i.indexOf(l)?ke(o(l,c.ForbiddenType),s):((p=r(l))?(p.setParent(t),p.parse(e,s),a=p.shouldFallback()&&n):(a=n,ke(o(l,c.UnknownType),s)),a&&((u=e.fallback)||t.setShouldFallback(!0),"string"==typeof u&&"drop"===u.toLowerCase()?p=null:"object"==typeof u&&(p=m(t,u,i,!0,r,o,s))))),p}function l(t,e,i,n,r){return m(t,e,i,n,function(t){return We.actionTypeRegistry.createInstance(t)},function(t,e){return e==c.UnknownType?{error:d.ValidationError.UnknownActionType,message:"Unknown action type: "+t+". Fallback will be used if present."}:{error:d.ValidationError.ActionTypeNotAllowed,message:"Action type "+t+" is not allowed in this context."}},r)}function u(t,e,i,n){return m(t,e,[],i,function(t){return We.elementTypeRegistry.createInstance(t)},function(t,e){return e==c.UnknownType?{error:d.ValidationError.UnknownElementType,message:"Unknown element type: "+t+". Fallback will be used if present."}:{error:d.ValidationError.ElementTypeNotAllowed,message:"Element type "+t+" is not allowed in this context."}},n)}(o=c=c||{})[o.UnknownType=0]="UnknownType",o[o.ForbiddenType=1]="ForbiddenType",e.createActionInstance=l,e.createElementInstance=u;var p=(v.prototype.parse=function(t,e){this._rawProperties=We.enableFullJsonRoundTrip?t:{}},v.prototype.toJSON=function(){var t=We.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{};return t},v.prototype.setCustomProperty=function(t,e){"string"==typeof e&&f.isNullOrEmpty(e)||null==e?delete this._rawProperties[t]:this._rawProperties[t]=e},v.prototype.getCustomProperty=function(t){return this._rawProperties[t]},v);function v(){this._rawProperties={}}e.SerializableObject=p;var b=function(t){this.cardObject=t,this.errors=[]};e.ValidationFailure=b;var C=(S.prototype.getFailureIndex=function(t){for(var e=0;e<this.failures.length;e++)if(this.failures[e].cardObject===t)return e;return-1},S.prototype.addFailure=function(t,e){var i,n=this.getFailureIndex(t);n<0?(i=new b(t),this.failures.push(i)):i=this.failures[n],i.errors.push(e)},S);function S(){this.allIds={},this.failures=[]}e.ValidationResults=C;var _,E=(r(x,_=p),x.prototype.internalValidateProperties=function(t){f.isNullOrEmpty(this.id)||(t.allIds.hasOwnProperty(this.id)?(1==t.allIds[this.id]&&t.addFailure(this,{error:d.ValidationError.DuplicateId,message:"Duplicate Id: "+this.id}),t.allIds[this.id]+=1):t.allIds[this.id]=1)},x.prototype.parse=function(t,e){_.prototype.parse.call(this,t,e),this.id=f.getStringValue(t.id)},x.prototype.toJSON=function(){var t=_.prototype.toJSON.call(this);return f.setProperty(t,"type",this.getJsonTypeName()),f.setProperty(t,"id",this.id),t},x.prototype.validateProperties=function(){var t=new C;return this.internalValidateProperties(t),t},x);function x(){return null!==_&&_.apply(this,arguments)||this}e.CardObject=E;var A,w=(r(I,A=E),I.prototype.internalRenderSeparator=function(){var t,e,i=f.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:null,lineColor:this.separator?this.hostConfig.separator.lineColor:null},this.separatorOrientation);return We.alwaysBleedSeparators&&i&&this.separatorOrientation==d.Orientation.Horizontal&&((t=this.getParentContainer())&&t.getEffectivePadding()&&(e=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding()),i.style.marginLeft="-"+e.left+"px",i.style.marginRight="-"+e.right+"px")),i},I.prototype.updateRenderedElementVisibility=function(){var t=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(this._renderedElement.style.display=t),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":this._separatorElement.style.display=t)},I.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,Oe(this,!1))},I.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.visibility=null,this.isVisible=!0,Oe(this,!1))},I.prototype.handleOverflow=function(t){var e;(this.isVisible||this.isHiddenDueToOverflow())&&(e=this.truncateOverflow(t),this._truncatedDueToOverflow=e||this._truncatedDueToOverflow,e?e&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow())},I.prototype.resetOverflow=function(){var t=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),t=!(this._truncatedDueToOverflow=!1)),this.isHiddenDueToOverflow&&this.showElementHiddenDueToOverflow(),t},I.prototype.createPlaceholderElement=function(){var t=document.createElement("div");return t.style.border="1px dashed #DDDDDD",t.style.padding="4px",t.style.minHeight="32px",t.style.fontSize="10px",t.innerText="Empty "+this.getJsonTypeName(),t},I.prototype.adjustRenderedElementSize=function(t){"auto"===this.height?t.style.flex="0 0 auto":t.style.flex="1 1 auto",this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")},I.prototype.overrideInternalRender=function(){return this.internalRender()},I.prototype.applyPadding=function(){var t,e;this.separatorElement&&(We.alwaysBleedSeparators&&this.separatorOrientation==d.Orientation.Horizontal&&!this.isBleeding()?(t=new h.PaddingDefinition,this.getImmediateSurroundingPadding(t),e=this.hostConfig.paddingDefinitionToSpacingDefinition(t),this.separatorElement.style.marginLeft="-"+e.left+"px",this.separatorElement.style.marginRight="-"+e.right+"px"):(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"))},I.prototype.truncateOverflow=function(t){return!1},I.prototype.undoOverflowTruncation=function(){},I.prototype.getDefaultPadding=function(){return new h.PaddingDefinition},I.prototype.getHasBackground=function(){return!1},I.prototype.getPadding=function(){return this._padding},I.prototype.setPadding=function(t){this._padding=t},Object.defineProperty(I.prototype,"supportsMinHeight",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"allowCustomPadding",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"separatorOrientation",{get:function(){return d.Orientation.Horizontal},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"defaultStyle",{get:function(){return d.ContainerStyle.Default},enumerable:!0,configurable:!0}),I.prototype.asString=function(){return""},I.prototype.isBleeding=function(){return!1},I.prototype.toJSON=function(){var t=A.prototype.toJSON.call(this);return f.setProperty(t,"isVisible",this.isVisible,!0),null!==this.horizontalAlignment&&f.setEnumProperty(d.HorizontalAlignment,t,"horizontalAlignment",this.horizontalAlignment),f.setEnumProperty(d.Spacing,t,"spacing",this.spacing,d.Spacing.Default),f.setProperty(t,"separator",this.separator,!1),f.setProperty(t,"height",this.height,"auto"),this.supportsMinHeight&&f.setProperty(t,"minHeight","number"!=typeof this.minPixelHeight||isNaN(this.minPixelHeight)?void 0:this.minPixelHeight+"px"),t},I.prototype.setParent=function(t){this._parent=t},I.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},I.prototype.getForbiddenElementTypes=function(){return null},I.prototype.getForbiddenActionTypes=function(){return null},I.prototype.getImmediateSurroundingPadding=function(t,e,i,n,r){var o,s,a,l,u;void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=!0),this.parent&&(o=e&&this.parent.isTopElement(this),s=i&&this.parent.isRightMostElement(this),a=n&&this.parent.isBottomElement(this),l=r&&this.parent.isLeftMostElement(this),(u=this.parent.getEffectivePadding())&&(o&&u.top!=d.Spacing.None&&(t.top=u.top,o=!1),s&&u.right!=d.Spacing.None&&(t.right=u.right,s=!1),a&&u.bottom!=d.Spacing.None&&(t.bottom=u.bottom,a=!1),l&&u.left!=d.Spacing.None&&(t.left=u.left,l=!1)),(o||s||a||l)&&this.parent.getImmediateSurroundingPadding(t,o,s,a,l))},I.prototype.parse=function(t,e){var i,n,r,o,s;A.prototype.parse.call(this,t,e),n=t,r=e,o=(i=this).getRootElement(),null!=(s=o&&o.onParseElement?o.onParseElement:We.onParseElement)&&s(i,n,r),this.requires.parse(t.requires,e),this.isVisible=f.getBoolValue(t.isVisible,this.isVisible),this.horizontalAlignment=f.getEnumValue(d.HorizontalAlignment,t.horizontalAlignment,this.horizontalAlignment),this.spacing=f.getEnumValue(d.Spacing,t.spacing,d.Spacing.Default),this.separator=f.getBoolValue(t.separator,this.separator);var a=t.separation;void 0!==a&&("none"===a?(this.spacing=d.Spacing.None,this.separator=!1):"strong"===a?(this.spacing=d.Spacing.Large,this.separator=!0):"default"===a&&(this.spacing=d.Spacing.Default,this.separator=!1),ke({error:d.ValidationError.Deprecated,message:'The "separation" property is deprecated and will be removed. Use the "spacing" and "separator" properties instead.'},e));var l=t.height;if("auto"!==l&&"stretch"!==l||(this.height=l),this.supportsMinHeight){var u=t.minHeight;if(u&&"string"==typeof u){var p=!1;try{var c=h.SizeAndUnit.parse(u,!0);c.unit==d.SizeUnit.Pixel&&(this.minPixelHeight=c.physicalSize,p=!0)}catch(t){}p||ke({error:d.ValidationError.InvalidPropertyValue,message:'Invalid "minHeight" value: '+u},e)}}else this.minPixelHeight=null},I.prototype.getActionCount=function(){return 0},I.prototype.getActionAt=function(t){throw new Error("Index out of range.")},I.prototype.remove=function(){return!!(this.parent&&this.parent instanceof Q)&&this.parent.removeItem(this)},I.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this._renderedElement},I.prototype.updateLayout=function(t){void 0===t&&(t=!0),this.updateRenderedElementVisibility(),this.applyPadding()},I.prototype.indexOf=function(t){return-1},I.prototype.isDesignMode=function(){var t=this.getRootElement();return t instanceof We&&t.designMode},I.prototype.isRendered=function(){return this._renderedElement&&0<this._renderedElement.offsetHeight},I.prototype.isFirstElement=function(t){return!0},I.prototype.isLastElement=function(t){return!0},I.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},I.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},I.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},I.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},I.prototype.isBleedingAtTop=function(){return!1},I.prototype.isBleedingAtBottom=function(){return!1},I.prototype.isLeftMostElement=function(t){return!0},I.prototype.isRightMostElement=function(t){return!0},I.prototype.isTopElement=function(t){return this.isFirstElement(t)},I.prototype.isBottomElement=function(t){return this.isLastElement(t)},I.prototype.isHiddenDueToOverflow=function(){return this._renderedElement&&"hidden"==this._renderedElement.style.visibility},I.prototype.getRootElement=function(){for(var t=this;t.parent;)t=t.parent;return t},I.prototype.getParentContainer=function(){for(var t=this.parent;t;){if(t instanceof Ce)return t;t=t.parent}return null},I.prototype.getAllInputs=function(){return[]},I.prototype.getResourceInformation=function(){return[]},I.prototype.getElementById=function(t){return this.id===t?this:null},I.prototype.getActionById=function(t){return null},I.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},I.prototype.setShouldFallback=function(t){this._shouldFallback=t},I.prototype.getEffectivePadding=function(){var t=this.getPadding();return t&&this.allowCustomPadding?t:this.getDefaultPadding()},Object.defineProperty(I.prototype,"lang",{get:function(){return this._lang?this._lang:this.parent?this.parent.lang:void 0},set:function(t){if(t&&""!=t){if(!/^[a-z]{2,3}$/gi.exec(t))throw new Error("Invalid language identifier: "+t)}this._lang=t},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:$e},set:function(t){this._hostConfig=t},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"isInteractive",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"isStandalone",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"isInline",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"isVisible",{get:function(){return this._isVisible},set:function(t){We.useAdvancedCardBottomTruncation&&!t&&this.undoOverflowTruncation(),this._isVisible!=t&&(this._isVisible=t,this.updateRenderedElementVisibility(),this._renderedElement&&Oe(this))},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!0,configurable:!0}),I);function I(){var t=null!==A&&A.apply(this,arguments)||this;return t._shouldFallback=!1,t._lang=void 0,t._hostConfig=null,t._parent=null,t._renderedElement=null,t._separatorElement=null,t._isVisible=!0,t._truncatedDueToOverflow=!1,t._defaultRenderedElementDisplayMode=null,t._padding=null,t.requires=new s.HostCapabilities,t.horizontalAlignment=null,t.spacing=d.Spacing.Default,t.separator=!1,t.customCssSelector=null,t.height="auto",t.minPixelHeight=null,t}e.CardElement=w;var T,P=(r(O,T=w),O.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},O.prototype.getFontSize=function(t){switch(this.size){case d.TextSize.Small:return t.fontSizes.small;case d.TextSize.Medium:return t.fontSizes.medium;case d.TextSize.Large:return t.fontSizes.large;case d.TextSize.ExtraLarge:return t.fontSizes.extraLarge;default:return t.fontSizes.default}},O.prototype.getColorDefinition=function(t,e){switch(e){case d.TextColor.Accent:return t.accent;case d.TextColor.Dark:return t.dark;case d.TextColor.Light:return t.light;case d.TextColor.Good:return t.good;case d.TextColor.Warning:return t.warning;case d.TextColor.Attention:return t.attention;default:return t.default}},O.prototype.setText=function(t){this._text=t},O.prototype.asString=function(){return this.text},O.prototype.toJSON=function(){var t=T.prototype.toJSON.call(this);return f.setEnumProperty(d.TextSize,t,"size",this.size,d.TextSize.Default),f.setEnumProperty(d.TextWeight,t,"weight",this.weight,d.TextWeight.Default),f.setEnumProperty(d.TextColor,t,"color",this.color,d.TextColor.Default),f.setProperty(t,"text",this.text),f.setProperty(t,"isSubtle",this.isSubtle,!1),f.setEnumProperty(d.FontType,t,"fontType",this.fontType,d.FontType.Default),t},O.prototype.applyStylesTo=function(t){var e,i=this.hostConfig.getFontTypeDefinition(this.fontType);switch(i.fontFamily&&(t.style.fontFamily=i.fontFamily),this.size){case d.TextSize.Small:e=i.fontSizes.small;break;case d.TextSize.Medium:e=i.fontSizes.medium;break;case d.TextSize.Large:e=i.fontSizes.large;break;case d.TextSize.ExtraLarge:e=i.fontSizes.extraLarge;break;default:e=i.fontSizes.default}t.style.fontSize=e+"px";var n,r=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);switch(t.style.color=f.stringToCssColor(this.isSubtle?r.subtle:r.default),this.weight){case d.TextWeight.Lighter:n=i.fontWeights.lighter;break;case d.TextWeight.Bolder:n=i.fontWeights.bolder;break;default:n=i.fontWeights.default}t.style.fontWeight=n.toString()},O.prototype.parse=function(t,e){T.prototype.parse.call(this,t,e),this.text=f.getStringValue(t.text);var i=f.getStringValue(t.size);i&&"normal"===i.toLowerCase()?(this.size=d.TextSize.Default,ke({error:d.ValidationError.Deprecated,message:'The TextBlock.size value "normal" is deprecated and will be removed. Use "default" instead.'},e)):this.size=f.getEnumValue(d.TextSize,i,this.size);var n=f.getStringValue(t.weight);n&&"normal"===n.toLowerCase()?(this.weight=d.TextWeight.Default,ke({error:d.ValidationError.Deprecated,message:'The TextBlock.weight value "normal" is deprecated and will be removed. Use "default" instead.'},e)):this.weight=f.getEnumValue(d.TextWeight,n,this.weight),this.color=f.getEnumValue(d.TextColor,t.color,this.color),this.isSubtle=f.getBoolValue(t.isSubtle,this.isSubtle),this.fontType=f.getEnumValue(d.FontType,t.fontType,this.fontType)},Object.defineProperty(O.prototype,"effectiveColor",{get:function(){return this.color?this.color:d.TextColor.Default},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"text",{get:function(){return this._text},set:function(t){this.setText(t)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},enumerable:!0,configurable:!0}),O);function O(){var t=null!==T&&T.apply(this,arguments)||this;return t._selectAction=null,t.size=d.TextSize.Default,t.weight=d.TextWeight.Default,t.color=d.TextColor.Default,t.isSubtle=!1,t.fontType=null,t}e.BaseTextBlock=P;var k,V=(r(N,k=P),N.prototype.restoreOriginalContent=function(){var t=this.maxLines?this._computedLineHeight*this.maxLines+"px":null;this.renderedElement.style.maxHeight=t,this.renderedElement.innerHTML=this._originalInnerHtml},N.prototype.truncateIfSupported=function(t){var e=this.renderedElement.children,i=!e.length;if(i||1==e.length&&"p"==e[0].tagName.toLowerCase()){var n=i?this.renderedElement:e[0];return f.truncate(n,t,this._computedLineHeight),!0}return!1},N.prototype.setText=function(t){k.prototype.setText.call(this,t),this._processedText=null},N.prototype.getRenderedDomElementType=function(){return"div"},N.prototype.internalRender=function(){var o=this;if(this._processedText=null,f.isNullOrEmpty(this.text))return null;var t,e,i,n,r,s=this.hostConfig,a=document.createElement(this.getRenderedDomElementType());a.classList.add(s.makeCssClassName("ac-textBlock")),a.style.overflow="hidden",this.applyStylesTo(a),this.selectAction&&(a.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,o.selectAction.execute()},s.supportsInteractivity&&(a.tabIndex=0,a.setAttribute("role","button"),a.setAttribute("aria-label",this.selectAction.title),a.classList.add(s.makeCssClassName("ac-selectable")))),this._processedText||(this._treatAsPlainText=!0,t=g.formatText(this.lang,this.text),this.useMarkdown?(We.allowMarkForTextHighlighting&&(t=t.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==")),(e=We.applyMarkdown(t)).didProcess&&e.outputHtml?(this._processedText=e.outputHtml,this._treatAsPlainText=!1,We.allowMarkForTextHighlighting&&(i="",(n=this.getEffectiveStyleDefinition()).highlightBackgroundColor&&(i+="background-color: "+n.highlightBackgroundColor+";"),n.highlightForegroundColor&&(i+="color: "+n.highlightForegroundColor+";"),f.isNullOrEmpty(i)||(i='style="'+i+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+i+">").replace(/\/==/g,"</mark>"))):(this._processedText=t,this._treatAsPlainText=!0)):(this._processedText=t,this._treatAsPlainText=!0)),this._treatAsPlainText?a.innerText=this._processedText:a.innerHTML=this._processedText,a.title=this._processedText,a.firstElementChild instanceof HTMLElement&&((r=a.firstElementChild).style.marginTop="0px",r.style.width="100%",this.wrap||(r.style.overflow="hidden",r.style.textOverflow="ellipsis")),a.lastElementChild instanceof HTMLElement&&(a.lastElementChild.style.marginBottom="0px");for(var l=a.getElementsByTagName("a"),u=0;u<l.length;u++){var p=l[u];p.classList.add(s.makeCssClassName("ac-anchor")),p.target="_blank",p.onclick=function(t){var e,i,n,r;e=o,i=t.target,n=e.getRootElement(),null!=(r=n&&n.onAnchorClicked?n.onAnchorClicked:We.onAnchorClicked)&&r(e,i)&&(t.preventDefault(),t.cancelBubble=!0)}}return this.wrap?(a.style.wordWrap="break-word",0<this.maxLines&&(a.style.maxHeight=this._computedLineHeight*this.maxLines+"px",a.style.overflow="hidden")):(a.style.whiteSpace="nowrap",a.style.textOverflow="ellipsis"),(We.useAdvancedTextBlockTruncation||We.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=a.innerHTML),a},N.prototype.truncateOverflow=function(t){return t>=this._computedLineHeight&&this.truncateIfSupported(t)},N.prototype.undoOverflowTruncation=function(){var t;this.restoreOriginalContent(),We.useAdvancedTextBlockTruncation&&this.maxLines&&(t=this._computedLineHeight*this.maxLines,this.truncateIfSupported(t))},N.prototype.toJSON=function(){var t=k.prototype.toJSON.call(this);return f.setProperty(t,"wrap",this.wrap,!1),f.setNumberProperty(t,"maxLines",this.maxLines),t},N.prototype.applyStylesTo=function(t){k.prototype.applyStylesTo.call(this,t);var e=this.getParentContainer(),i=!!e&&e.isRtl();switch(this.horizontalAlignment){case d.HorizontalAlignment.Center:t.style.textAlign="center";break;case d.HorizontalAlignment.Right:t.style.textAlign=i?"left":"right";break;default:t.style.textAlign=i?"right":"left"}var n=this.hostConfig.lineHeights;if(n)switch(this.size){case d.TextSize.Small:this._computedLineHeight=n.small;break;case d.TextSize.Medium:this._computedLineHeight=n.medium;break;case d.TextSize.Large:this._computedLineHeight=n.large;break;case d.TextSize.ExtraLarge:this._computedLineHeight=n.extraLarge;break;default:this._computedLineHeight=n.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.fontType));t.style.lineHeight=this._computedLineHeight+"px"},N.prototype.parse=function(t,e){k.prototype.parse.call(this,t,e),this.wrap=f.getBoolValue(t.wrap,this.wrap),this.maxLines=f.getNumberValue(t.maxLines)},N.prototype.getJsonTypeName=function(){return"TextBlock"},N.prototype.updateLayout=function(t){void 0===t&&(t=!1),k.prototype.updateLayout.call(this,t),We.useAdvancedTextBlockTruncation&&this.maxLines&&this.isRendered()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))},N);function N(){var t=null!==k&&k.apply(this,arguments)||this;return t._processedText=null,t._treatAsPlainText=!0,t.wrap=!1,t.useMarkdown=!0,t}e.TextBlock=V;var z,D=(r(F,z=V),F.prototype.getRenderedDomElementType=function(){return"label"},F.prototype.internalRender=function(){var t=z.prototype.internalRender.call(this);return f.isNullOrEmpty(this.forElementId)||(t.htmlFor=this.forElementId),t},F);function F(){return null!==z&&z.apply(this,arguments)||this}var M,B=(r(L,M=P),L.prototype.internalRender=function(){var e=this;if(f.isNullOrEmpty(this.text))return null;var t,i=this.hostConfig,n=g.formatText(this.lang,this.text),r=document.createElement("span");return r.classList.add(i.makeCssClassName("ac-textRun")),this.applyStylesTo(r),this.selectAction&&i.supportsInteractivity?((t=document.createElement("a")).classList.add(i.makeCssClassName("ac-anchor")),t.href=this.selectAction.getHref(),t.target="_blank",t.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute()},t.innerText=n,r.appendChild(t)):r.innerText=n,r},L.prototype.applyStylesTo=function(t){var e;M.prototype.applyStylesTo.call(this,t),this.italic&&(t.style.fontStyle="italic"),this.strikethrough&&(t.style.textDecoration="line-through"),this.highlight&&(e=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),t.style.backgroundColor=f.stringToCssColor(this.isSubtle?e.highlightColors.subtle:e.highlightColors.default))},L.prototype.toJSON=function(){var t=M.prototype.toJSON.call(this);return f.setProperty(t,"italic",this.italic,!1),f.setProperty(t,"strikethrough",this.strikethrough,!1),f.setProperty(t,"highlight",this.highlight,!1),this.selectAction&&f.setProperty(t,"selectAction",this.selectAction.toJSON()),t},L.prototype.parse=function(t,e){M.prototype.parse.call(this,t,e),this.italic=f.getBoolValue(t.italic,this.italic),this.strikethrough=f.getBoolValue(t.strikethrough,this.strikethrough),this.highlight=f.getBoolValue(t.highlight,this.highlight),this.selectAction=l(this,t.selectAction,[se.JsonTypeName],!this.isDesignMode(),e)},L.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(L.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(L.prototype,"isInline",{get:function(){return!0},enumerable:!0,configurable:!0}),L);function L(){var t=null!==M&&M.apply(this,arguments)||this;return t.italic=!1,t.strikethrough=!1,t.highlight=!1,t}e.TextRun=B;var R,H=(r(j,R=w),j.prototype.internalAddInline=function(t,e){if(void 0===e&&(e=!1),!t.isInline)throw new Error("RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline.");if(!(null==t.parent||e)&&t.parent!=this)throw new Error("RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock.");t.setParent(this),this._inlines.push(t)},j.prototype.internalRender=function(){if(0<this._inlines.length){var t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-richTextBlock");var e=this.getParentContainer(),i=!!e&&e.isRtl();switch(this.horizontalAlignment){case d.HorizontalAlignment.Center:t.style.textAlign="center";break;case d.HorizontalAlignment.Right:t.style.textAlign=i?"left":"right";break;default:t.style.textAlign=i?"right":"left"}for(var n=0,r=this._inlines;n<r.length;n++){var o=r[n];t.appendChild(o.render())}return t}return null},j.prototype.asString=function(){for(var t="",e=0,i=this._inlines;e<i.length;e++){t+=i[e].asString()}return t},j.prototype.parse=function(t,e){if(R.prototype.parse.call(this,t,e),this._inlines=[],Array.isArray(t.inlines))for(var i=0,n=t.inlines;i<n.length;i++){var r,o=n[i],s=void 0;(s="string"==typeof o?((r=new B).text=o,r):u(this,o,!1,e))&&this.internalAddInline(s,!0)}},j.prototype.toJSON=function(){var t=R.prototype.toJSON.call(this);if(0<this._inlines.length){for(var e=[],i=0,n=this._inlines;i<n.length;i++){var r=n[i];e.push(r.toJSON())}f.setProperty(t,"inlines",e)}return t},j.prototype.getJsonTypeName=function(){return"RichTextBlock"},j.prototype.getInlineCount=function(){return this._inlines.length},j.prototype.getInlineAt=function(t){if(0<=t&&t<this._inlines.length)return this._inlines[t];throw new Error("RichTextBlock.getInlineAt: Index out of range ("+t+")")},j.prototype.addInline=function(t){this.internalAddInline(t)},j.prototype.removeInline=function(t){var e=this._inlines.indexOf(t);return 0<=e&&(this._inlines[e].setParent(null),this._inlines.splice(e,1),!0)},j);function j(){var t=null!==R&&R.apply(this,arguments)||this;return t._inlines=[],t}e.RichTextBlock=H;var J,W=(r(U,J=p),U.prototype.parse=function(t){J.prototype.parse.call(this,t),this.name=f.getStringValue(t.title),this.value=f.getStringValue(t.value)},U.prototype.toJSON=function(){var t=J.prototype.toJSON.call(this);return f.setProperty(t,"title",this.name),f.setProperty(t,"value",this.value),t},U);function U(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0);var i=J.call(this)||this;return i.name=t,i.value=e,i}e.Fact=W;var q,G=(r(X,q=w),Object.defineProperty(X.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!0,configurable:!0}),X.prototype.internalRender=function(){var t=null,e=this.hostConfig;if(0<this.facts.length){(t=document.createElement("table")).style.borderWidth="0px",t.style.borderSpacing="0px",t.style.borderStyle="none",t.style.borderCollapse="collapse",t.style.display="block",t.style.overflow="hidden",t.classList.add(e.makeCssClassName("ac-factset"));for(var i=0;i<this.facts.length;i++){var n=document.createElement("tr");0<i&&(n.style.marginTop=e.factSet.spacing+"px");var r=document.createElement("td");r.style.padding="0",r.classList.add(e.makeCssClassName("ac-fact-title")),e.factSet.title.maxWidth&&(r.style.maxWidth=e.factSet.title.maxWidth+"px"),r.style.verticalAlign="top";var o=new V;o.setParent(this),o.text=f.isNullOrEmpty(this.facts[i].name)?"Title":this.facts[i].name,o.size=e.factSet.title.size,o.color=e.factSet.title.color,o.isSubtle=e.factSet.title.isSubtle,o.weight=e.factSet.title.weight,o.wrap=e.factSet.title.wrap,o.spacing=d.Spacing.None,f.appendChild(r,o.render()),f.appendChild(n,r),(r=document.createElement("td")).style.width="10px",f.appendChild(n,r),(r=document.createElement("td")).style.padding="0",r.style.verticalAlign="top",r.classList.add(e.makeCssClassName("ac-fact-value")),(o=new V).setParent(this),o.text=this.facts[i].value,o.size=e.factSet.value.size,o.color=e.factSet.value.color,o.isSubtle=e.factSet.value.isSubtle,o.weight=e.factSet.value.weight,o.wrap=e.factSet.value.wrap,o.spacing=d.Spacing.None,f.appendChild(r,o.render()),f.appendChild(n,r),f.appendChild(t,n)}}return t},X.prototype.getJsonTypeName=function(){return"FactSet"},X.prototype.toJSON=function(){var t=q.prototype.toJSON.call(this);return f.setArrayProperty(t,"facts",this.facts),t},X.prototype.parse=function(t,e){q.prototype.parse.call(this,t,e),this.facts=[];var i=t.facts;if(Array.isArray(i))for(var n=0,r=i;n<r.length;n++){var o=r[n],s=new W;s.parse(o),this.facts.push(s)}},X);function X(){var t=null!==q&&q.apply(this,arguments)||this;return t.facts=[],t}e.FactSet=G;var $,Y=(r(Z,$=w),Z.prototype.parseDimension=function(t,e,i){if(e){if("string"==typeof e)try{var n=h.SizeAndUnit.parse(e);if(n.unit==d.SizeUnit.Pixel)return n.physicalSize}catch(t){}ke({error:d.ValidationError.InvalidPropertyValue,message:"Invalid image "+t+": "+e},i)}return 0},Z.prototype.applySize=function(t){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(t.style.width=this.pixelWidth+"px"),this.pixelHeight&&(t.style.height=this.pixelHeight+"px");else switch(this.size){case d.Size.Stretch:t.style.width="100%";break;case d.Size.Auto:t.style.maxWidth="100%";break;case d.Size.Small:t.style.width=this.hostConfig.imageSizes.small+"px";break;case d.Size.Large:t.style.width=this.hostConfig.imageSizes.large+"px";break;case d.Size.Medium:t.style.width=this.hostConfig.imageSizes.medium+"px"}},Object.defineProperty(Z.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!0,configurable:!0}),Z.prototype.internalRender=function(){var n=this,t=null;if(!f.isNullOrEmpty(this.url)){switch((t=document.createElement("div")).style.display="flex",t.style.alignItems="flex-start",t.onkeypress=function(t){!n.selectAction||13!=t.keyCode&&32!=t.keyCode||(t.preventDefault(),t.cancelBubble=!0,n.selectAction.execute())},t.onclick=function(t){n.selectAction&&(t.preventDefault(),t.cancelBubble=!0,n.selectAction.execute())},this.horizontalAlignment){case d.HorizontalAlignment.Center:t.style.justifyContent="center";break;case d.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}var e=this.hostConfig,i=document.createElement("img");i.onload=function(t){Te(n)},i.onerror=function(t){var e,i=n.getRootElement();n.renderedElement.innerHTML="",i&&i.designMode&&((e=document.createElement("div")).style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.backgroundColor="#EEEEEE",e.style.color="black",e.innerText=":-(",e.style.padding="10px",n.applySize(e),n.renderedElement.appendChild(e)),Te(n)},i.style.maxHeight="100%",i.style.minWidth="0",i.classList.add(e.makeCssClassName("ac-image")),null!=this.selectAction&&e.supportsInteractivity&&(i.tabIndex=0,i.setAttribute("role","button"),i.setAttribute("aria-label",this.selectAction.title),i.classList.add(e.makeCssClassName("ac-selectable"))),this.applySize(i),this.style===d.ImageStyle.Person&&(i.style.borderRadius="50%",i.style.backgroundPosition="50% 50%",i.style.backgroundRepeat="no-repeat"),f.isNullOrEmpty(this.backgroundColor)||(i.style.backgroundColor=f.stringToCssColor(this.backgroundColor)),i.src=this.url,i.alt=this.altText,i.title=this.altText,t.appendChild(i)}return t},Z.prototype.toJSON=function(){var t=$.prototype.toJSON.call(this);return this._selectAction&&f.setProperty(t,"selectAction",this._selectAction.toJSON()),f.setEnumProperty(d.ImageStyle,t,"style",this.style,d.ImageStyle.Default),f.setProperty(t,"backgroundColor",this.backgroundColor),f.setProperty(t,"url",this.url),f.setEnumProperty(d.Size,t,"size",this.size,d.Size.Auto),this.pixelWidth&&f.setProperty(t,"width",this.pixelWidth+"px"),this.pixelHeight&&f.setProperty(t,"height",this.pixelHeight+"px"),f.setProperty(t,"altText",this.altText),t},Z.prototype.getJsonTypeName=function(){return"Image"},Z.prototype.getActionById=function(t){var e=$.prototype.getActionById.call(this,t);return!e&&this.selectAction&&(e=this.selectAction.getActionById(t)),e},Z.prototype.parse=function(t,e){$.prototype.parse.call(this,t,e),this.url=f.getStringValue(t.url),this.backgroundColor=f.getStringValue(t.backgroundColor);var i=f.getStringValue(t.style);i&&"normal"===i.toLowerCase()?(this.style=d.ImageStyle.Default,ke({error:d.ValidationError.Deprecated,message:'The Image.style value "normal" is deprecated and will be removed. Use "default" instead.'},e)):this.style=f.getEnumValue(d.ImageStyle,i,this.style),this.size=f.getEnumValue(d.Size,t.size,this.size),this.altText=f.getStringValue(t.altText),t.pixelWidth&&"number"==typeof t.pixelWidth&&(this.pixelWidth=t.pixelWidth,ke({error:d.ValidationError.Deprecated,message:"The pixelWidth property is deprecated and will be removed. Use the width property instead."},e)),t.pixelHeight&&"number"==typeof t.pixelHeight&&(this.pixelHeight=t.pixelHeight,ke({error:d.ValidationError.Deprecated,message:"The pixelHeight property is deprecated and will be removed. Use the height property instead."},e));var n=this.parseDimension("width",t.width,e);0<n&&(this.pixelWidth=n),0<(n=this.parseDimension("height",t.height,e))&&(this.pixelHeight=n),this.selectAction=l(this,t.selectAction,[se.JsonTypeName],!this.isDesignMode(),e)},Z.prototype.getResourceInformation=function(){return f.isNullOrEmpty(this.url)?[]:[{url:this.url,mimeType:"image"}]},Object.defineProperty(Z.prototype,"selectAction",{get:function(){return this._selectAction},set:function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},enumerable:!0,configurable:!0}),Z);function Z(){var t=null!==$&&$.apply(this,arguments)||this;return t.style=d.ImageStyle.Default,t.size=d.Size.Auto,t.pixelWidth=null,t.pixelHeight=null,t.altText="",t}e.Image=Y;var K,Q=(r(tt,K=w),tt.prototype.isElementAllowed=function(t,e){if(!this.hostConfig.supportsInteractivity&&t.isInteractive)return!1;if(e)for(var i=0,n=e;i<n.length;i++){var r=n[i];if(t.getJsonTypeName()===r)return!1}return!0},tt.prototype.applyPadding=function(){var t;K.prototype.applyPadding.call(this),this.renderedElement&&(t=new h.SpacingDefinition,this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0")},tt.prototype.getSelectAction=function(){return this._selectAction},tt.prototype.setSelectAction=function(t){this._selectAction=t,this._selectAction&&this._selectAction.setParent(this)},Object.defineProperty(tt.prototype,"isSelectable",{get:function(){return!1},enumerable:!0,configurable:!0}),tt.prototype.parse=function(t,e){K.prototype.parse.call(this,t,e),this.isSelectable&&(this._selectAction=l(this,t.selectAction,[se.JsonTypeName],!this.isDesignMode(),e))},tt.prototype.toJSON=function(){var t=K.prototype.toJSON.call(this);return this._selectAction&&this.isSelectable&&f.setProperty(t,"selectAction",this._selectAction.toJSON()),t},tt.prototype.internalValidateProperties=function(t){K.prototype.internalValidateProperties.call(this,t);for(var e=0;e<this.getItemCount();e++){var i=this.getItemAt(e);!this.hostConfig.supportsInteractivity&&i.isInteractive&&t.addFailure(this,{error:d.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."}),this.isElementAllowed(i,this.getForbiddenElementTypes())||t.addFailure(this,{error:d.ValidationError.InteractivityNotAllowed,message:"Elements of type "+i.getJsonTypeName()+" are not allowed in this container."}),i.internalValidateProperties(t)}this._selectAction&&this._selectAction.internalValidateProperties(t)},tt.prototype.render=function(){var e=this,t=K.prototype.render.call(this),i=this.hostConfig;return this.allowVerticalOverflow&&(t.style.overflowX="hidden",t.style.overflowY="auto"),t&&this.isSelectable&&this._selectAction&&i.supportsInteractivity&&(t.classList.add(i.makeCssClassName("ac-selectable")),t.tabIndex=0,t.setAttribute("role","button"),t.setAttribute("aria-label",this._selectAction.title),t.onclick=function(t){null!=e._selectAction&&(t.preventDefault(),t.cancelBubble=!0,e._selectAction.execute())},t.onkeypress=function(t){null==e._selectAction||13!=t.keyCode&&32!=t.keyCode||(t.preventDefault(),t.cancelBubble=!0,e._selectAction.execute())}),t},tt.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),K.prototype.updateLayout.call(this,t),t)for(var e=0;e<this.getItemCount();e++)this.getItemAt(e).updateLayout()},tt.prototype.getAllInputs=function(){for(var t=[],e=0;e<this.getItemCount();e++)t=t.concat(this.getItemAt(e).getAllInputs());return t},tt.prototype.getResourceInformation=function(){for(var t=[],e=0;e<this.getItemCount();e++)t=t.concat(this.getItemAt(e).getResourceInformation());return t},tt.prototype.getElementById=function(t){var e=K.prototype.getElementById.call(this,t);if(!e)for(var i=0;i<this.getItemCount()&&!(e=this.getItemAt(i).getElementById(t));i++);return e},tt);function tt(){var t=null!==K&&K.apply(this,arguments)||this;return t._selectAction=null,t.allowVerticalOverflow=!1,t}e.CardElementContainer=Q;var et,it=(r(nt,et=Q),nt.prototype.internalRender=function(){var t=null;if(0<this._images.length){(t=document.createElement("div")).style.display="flex",t.style.flexWrap="wrap";for(var e=0;e<this._images.length;e++){this._images[e].size=this.imageSize;var i=this._images[e].render();i.style.display="inline-flex",i.style.margin="0px",i.style.marginRight="10px",i.style.maxHeight=this.hostConfig.imageSet.maxImageHeight+"px",f.appendChild(t,i)}}return t},nt.prototype.getItemCount=function(){return this._images.length},nt.prototype.getItemAt=function(t){return this._images[t]},nt.prototype.getFirstVisibleRenderedItem=function(){return this._images&&0<this._images.length?this._images[0]:null},nt.prototype.getLastVisibleRenderedItem=function(){return this._images&&0<this._images.length?this._images[this._images.length-1]:null},nt.prototype.removeItem=function(t){if(t instanceof Y){var e=this._images.indexOf(t);if(0<=e)return this._images.splice(e,1),t.setParent(null),this.updateLayout(),!0}return!1},nt.prototype.getJsonTypeName=function(){return"ImageSet"},nt.prototype.toJSON=function(){var t=et.prototype.toJSON.call(this);if(f.setEnumProperty(d.Size,t,"imageSize",this.imageSize,d.Size.Medium),0<this._images.length){for(var e=[],i=0,n=this._images;i<n.length;i++){var r=n[i];e.push(r.toJSON())}f.setProperty(t,"images",e)}return t},nt.prototype.parse=function(t,e){if(et.prototype.parse.call(this,t,e),this.imageSize=f.getEnumValue(d.Size,t.imageSize,d.Size.Medium),null!=t.images){var i=t.images;this._images=[];for(var n=0;n<i.length;n++){var r=new Y;r.parse(i[n],e),this.addImage(r)}}},nt.prototype.addImage=function(t){if(t.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(t),t.setParent(this)},nt.prototype.indexOf=function(t){return t instanceof Y?this._images.indexOf(t):-1},nt);function nt(){var t=null!==et&&et.apply(this,arguments)||this;return t._images=[],t.imageSize=d.Size.Medium,t}e.ImageSet=it;var rt,ot=(r(st,rt=p),st.prototype.parse=function(t,e){rt.prototype.parse.call(this,t,e),this.mimeType=f.getStringValue(t.mimeType),this.url=f.getStringValue(t.url)},st.prototype.toJSON=function(){var t=rt.prototype.toJSON.call(this);return f.setProperty(t,"mimeType",this.mimeType),f.setProperty(t,"url",this.url),t},st);function st(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0);var i=rt.call(this)||this;return i.url=t,i.mimeType=e,i}e.MediaSource=ot;var at,lt=(r(ut,at=w),ut.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster},ut.prototype.processSources=function(){this._selectedSources=[],this._selectedMediaType=void 0;for(var t=0,e=this.sources;t<e.length;t++){var i,n=e[t],r=n.mimeType?n.mimeType.split("/"):[];2==r.length&&(this._selectedMediaType||0<=(i=ut.supportedMediaTypes.indexOf(r[0]))&&(this._selectedMediaType=ut.supportedMediaTypes[i]),r[0]==this._selectedMediaType&&this._selectedSources.push(n))}},ut.prototype.renderPoster=function(){var i=this,e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-media-poster"),e.setAttribute("role","contentinfo"),e.setAttribute("aria-label",this.altText?this.altText:"Media content"),e.style.position="relative",e.style.display="flex";var n,t,r,o,s=this.getPosterUrl();return s?((n=document.createElement("img")).style.width="100%",n.style.height="100%",n.onerror=function(t){n.parentNode.removeChild(n),e.classList.add("empty"),e.style.minHeight="150px"},n.src=s,e.appendChild(n)):(e.classList.add("empty"),e.style.minHeight="150px"),this.hostConfig.supportsInteractivity&&0<this._selectedSources.length&&((t=document.createElement("div")).setAttribute("role","button"),t.setAttribute("aria-label","Play media"),t.className=this.hostConfig.makeCssClassName("ac-media-playButton"),t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.onclick=function(t){var e;i.hostConfig.media.allowInlinePlayback?(t.preventDefault(),t.cancelBubble=!0,e=i.renderMediaPlayer(),i.renderedElement.innerHTML="",i.renderedElement.appendChild(e),e.play()):ut.onPlay&&(t.preventDefault(),t.cancelBubble=!0,ut.onPlay(i))},(r=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),r.style.width="12px",r.style.height="15px",r.style.borderTopWidth="7.5px",r.style.borderBottomWidth="7.5px",r.style.borderLeftWidth="12px",r.style.borderRightWidth="0",r.style.borderStyle="solid",r.style.borderTopColor="transparent",r.style.borderRightColor="transparent",r.style.borderBottomColor="transparent",r.style.transform="translate(1.2px,0px)",t.appendChild(r),(o=document.createElement("div")).style.position="absolute",o.style.left="0",o.style.top="0",o.style.width="100%",o.style.height="100%",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",o.appendChild(t),e.appendChild(o)),e},ut.prototype.renderMediaPlayer=function(){var t,e,i="video"==this._selectedMediaType?(t=document.createElement("video"),(e=this.getPosterUrl())&&(t.poster=e),t):document.createElement("audio");i.controls=!0,i.preload="none",i.style.width="100%";for(var n=0,r=this.sources;n<r.length;n++){var o=r[n],s=document.createElement("source");s.src=o.url,s.type=o.mimeType,i.appendChild(s)}return i},ut.prototype.internalRender=function(){var t=document.createElement("div");return t.className=this.hostConfig.makeCssClassName("ac-media"),this.processSources(),t.appendChild(this.renderPoster()),t},ut.prototype.parse=function(t,e){if(at.prototype.parse.call(this,t,e),this.poster=f.getStringValue(t.poster),this.altText=f.getStringValue(t.altText),this.sources=[],Array.isArray(t.sources))for(var i=0,n=t.sources;i<n.length;i++){var r=n[i],o=new ot;o.parse(r,e),this.sources.push(o)}},ut.prototype.toJSON=function(){var t=at.prototype.toJSON.call(this);return f.setProperty(t,"poster",this.poster),f.setProperty(t,"altText",this.altText),f.setArrayProperty(t,"sources",this.sources),t},ut.prototype.getJsonTypeName=function(){return"Media"},ut.prototype.getResourceInformation=function(){var t=[],e=this.getPosterUrl();f.isNullOrEmpty(e)||t.push({url:e,mimeType:"image"});for(var i=0,n=this.sources;i<n.length;i++){var r=n[i];f.isNullOrEmpty(r.url)||t.push({url:r.url,mimeType:r.mimeType})}return t},Object.defineProperty(ut.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!0,configurable:!0}),ut.supportedMediaTypes=["audio","video"],ut);function ut(){var t=null!==at&&at.apply(this,arguments)||this;return t.sources=[],t}e.Media=lt;var pt,ct=(r(ht,pt=p),ht.prototype.parse=function(t){pt.prototype.parse.call(this,t),this.necessity=f.getEnumValue(d.InputValidationNecessity,t.necessity,this.necessity),this.errorMessage=f.getStringValue(t.errorMessage)},ht.prototype.toJSON=function(){if(this.necessity==d.InputValidationNecessity.Optional&&f.isNullOrEmpty(this.errorMessage))return null;var t=pt.prototype.toJSON.call(this);return f.setEnumProperty(d.InputValidationNecessity,t,"necessity",this.necessity,d.InputValidationNecessity.Optional),f.setProperty(t,"errorMessage",this.errorMessage),t},ht);function ht(){var t=null!==pt&&pt.apply(this,arguments)||this;return t.necessity=d.InputValidationNecessity.Optional,t.errorMessage=void 0,t}e.InputValidationOptions=ct;var dt,gt=(r(ft,dt=w),Object.defineProperty(ft.prototype,"isNullable",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(ft.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!0,configurable:!0}),Object.defineProperty(ft.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!0,configurable:!0}),ft.prototype.overrideInternalRender=function(){var t=this.hostConfig;return this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column",this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=t.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex",this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement.style.minWidth="0px",We.useBuiltInInputValidation&&this.isNullable&&this.validation.necessity==d.InputValidationNecessity.RequiredWithVisualCue&&this._renderedInputControlElement.classList.add(t.makeCssClassName("ac-input-required")),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this._outerContainerElement},ft.prototype.valueChanged=function(){var t,e,i;this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),e=(t=this).getRootElement(),(i=e&&e.onInputValueChanged?e.onInputValueChanged:We.onInputValueChanged)&&i(t)},ft.prototype.resetValidationFailureCue=function(){We.useBuiltInInputValidation&&this.renderedElement&&(this._renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this._errorMessageElement&&(this._outerContainerElement.removeChild(this._errorMessageElement),this._errorMessageElement=null))},ft.prototype.showValidationErrorMessage=function(){this.renderedElement&&We.useBuiltInInputValidation&&We.displayInputValidationErrors&&!f.isNullOrEmpty(this.validation.errorMessage)&&(this._errorMessageElement=document.createElement("span"),this._errorMessageElement.className=this.hostConfig.makeCssClassName("ac-input-validation-error-message"),this._errorMessageElement.textContent=this.validation.errorMessage,this._outerContainerElement.appendChild(this._errorMessageElement))},ft.prototype.parseInputValue=function(t){return t},ft.prototype.toJSON=function(){var t=dt.prototype.toJSON.call(this);return f.setProperty(t,"title",this.title),f.setProperty(t,"value",this.renderedElement&&!f.isNullOrEmpty(this.value)?this.value:this.defaultValue),We.useBuiltInInputValidation&&f.setProperty(t,"validation",this.validation.toJSON()),t},ft.prototype.internalValidateProperties=function(t){dt.prototype.internalValidateProperties.call(this,t),f.isNullOrEmpty(this.id)&&t.addFailure(this,{error:d.ValidationError.PropertyCantBeNull,message:"All inputs must have a unique Id"})},ft.prototype.validateValue=function(){if(We.useBuiltInInputValidation){this.resetValidationFailureCue();var t=this.validation.necessity==d.InputValidationNecessity.Optional||!f.isNullOrEmpty(this.value);return!t&&this.renderedElement&&(this._renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),t}return!0},ft.prototype.parse=function(t,e){var i;dt.prototype.parse.call(this,t,e),this.id=f.getStringValue(t.id),this.defaultValue=f.getStringValue(t.value),!We.useBuiltInInputValidation||(i=t.validation)&&this.validation.parse(i)},ft.prototype.getAllInputs=function(){return[this]},Object.defineProperty(ft.prototype,"defaultValue",{get:function(){return this._defaultValue},set:function(t){this._defaultValue=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(ft.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),ft);function ft(){var t=null!==dt&&dt.apply(this,arguments)||this;return t.validation=new ct,t}e.Input=gt;var yt,mt=(r(vt,yt=gt),vt.prototype.internalRender=function(){var e=this;if(this.isMultiline){var t=document.createElement("textarea");return t.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),t.style.flex="1 1 auto",t.tabIndex=0,f.isNullOrEmpty(this.placeholder)||(t.placeholder=this.placeholder,t.setAttribute("aria-label",this.placeholder)),f.isNullOrEmpty(this.defaultValue)||(t.value=this.defaultValue),this.maxLength&&0<this.maxLength&&(t.maxLength=this.maxLength),t.oninput=function(){e.valueChanged()},t.onkeypress=function(t){10==t.keyCode&&e.inlineAction&&e.inlineAction.execute()},t}var i=document.createElement("input");return i.type=d.InputTextStyle[this.style].toLowerCase(),i.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),i.style.flex="1 1 auto",i.tabIndex=0,f.isNullOrEmpty(this.placeholder)||(i.placeholder=this.placeholder,i.setAttribute("aria-label",this.placeholder)),f.isNullOrEmpty(this.defaultValue)||(i.value=this.defaultValue),this.maxLength&&0<this.maxLength&&(i.maxLength=this.maxLength),i.oninput=function(){e.valueChanged()},i.onkeypress=function(t){13==t.keyCode&&e.inlineAction&&e.inlineAction.execute()},i},vt.prototype.overrideInternalRender=function(){var t,e,i=this,n=yt.prototype.overrideInternalRender.call(this);return this.inlineAction&&((t=document.createElement("button")).className=this.hostConfig.makeCssClassName("ac-inlineActionButton"),t.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,i.inlineAction.execute()},f.isNullOrEmpty(this.inlineAction.iconUrl)?(t.classList.add("textOnly"),t.textContent=f.isNullOrEmpty(this.inlineAction.title)?"Title":this.inlineAction.title):(t.classList.add("iconOnly"),(e=document.createElement("img")).style.height="100%",e.style.display="none",e.onload=function(){e.style.removeProperty("display")},e.onerror=function(){t.removeChild(e),t.classList.remove("iconOnly"),t.classList.add("textOnly"),t.textContent=f.isNullOrEmpty(i.inlineAction.title)?"Title":i.inlineAction.title},e.src=this.inlineAction.iconUrl,t.appendChild(e),f.isNullOrEmpty(this.inlineAction.title)||(t.title=this.inlineAction.title)),t.style.marginLeft="8px",this.inputControlContainerElement.appendChild(t)),n},vt.prototype.getJsonTypeName=function(){return"Input.Text"},vt.prototype.getActionById=function(t){var e=yt.prototype.getActionById.call(this,t);return!e&&this.inlineAction&&(e=this.inlineAction.getActionById(t)),e},vt.prototype.toJSON=function(){var t=yt.prototype.toJSON.call(this);return f.setProperty(t,"placeholder",this.placeholder),f.setNumberProperty(t,"maxLength",this.maxLength),f.setProperty(t,"isMultiline",this.isMultiline,!1),f.setEnumProperty(d.InputTextStyle,t,"style",this.style,d.InputTextStyle.Text),this._inlineAction&&f.setProperty(t,"inlineAction",this._inlineAction.toJSON()),t},vt.prototype.parse=function(t,e){yt.prototype.parse.call(this,t,e),this.maxLength=f.getNumberValue(t.maxLength),this.isMultiline=f.getBoolValue(t.isMultiline,this.isMultiline),this.placeholder=f.getStringValue(t.placeholder),this.style=f.getEnumValue(d.InputTextStyle,t.style,this.style),this.inlineAction=l(this,t.inlineAction,[se.JsonTypeName],!this.isDesignMode(),e)},Object.defineProperty(vt.prototype,"inlineAction",{get:function(){return this._inlineAction},set:function(t){this._inlineAction=t,this._inlineAction&&this._inlineAction.setParent(this)},enumerable:!0,configurable:!0}),Object.defineProperty(vt.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):null},enumerable:!0,configurable:!0}),vt);function vt(){var t=null!==yt&&yt.apply(this,arguments)||this;return t.isMultiline=!1,t.style=d.InputTextStyle.Text,t}e.TextInput=mt;var bt,Ct=(r(St,bt=gt),St.prototype.internalRender=function(){var t,e,i,n=this,r=document.createElement("div");return r.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),r.style.width="100%",r.style.display="flex",r.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=f.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this._checkboxInputElement.setAttribute("aria-label",this.title),this._checkboxInputElement.tabIndex=0,this.defaultValue==this.valueOn&&(this._checkboxInputElement.checked=!0),this._checkboxInputElement.onchange=function(){n.valueChanged()},f.appendChild(r,this._checkboxInputElement),f.isNullOrEmpty(this.title)&&!this.isDesignMode()||((t=new D).setParent(this),t.forElementId=this._checkboxInputElement.id,t.hostConfig=this.hostConfig,t.text=f.isNullOrEmpty(this.title)?this.getJsonTypeName():this.title,t.useMarkdown=We.useMarkdownInRadioButtonAndCheckbox,t.wrap=this.wrap,(e=t.render()).style.display="inline-block",e.style.flex="1 1 auto",e.style.marginLeft="6px",e.style.verticalAlign="middle",(i=document.createElement("div")).style.width="6px",f.appendChild(r,i),f.appendChild(r,e)),r},Object.defineProperty(St.prototype,"isNullable",{get:function(){return!1},enumerable:!0,configurable:!0}),St.prototype.getJsonTypeName=function(){return"Input.Toggle"},St.prototype.toJSON=function(){var t=bt.prototype.toJSON.call(this);return f.setProperty(t,"valueOn",this.valueOn,"true"),f.setProperty(t,"valueOff",this.valueOff,"false"),f.setProperty(t,"wrap",this.wrap),t},St.prototype.parse=function(t,e){bt.prototype.parse.call(this,t,e),this.title=f.getStringValue(t.title),this.valueOn=f.getStringValue(t.valueOn,this.valueOn),this.valueOff=f.getStringValue(t.valueOff,this.valueOff),this.wrap=f.getBoolValue(t.wrap,this.wrap)},Object.defineProperty(St.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:null},enumerable:!0,configurable:!0}),St);function St(){var t=null!==bt&&bt.apply(this,arguments)||this;return t.valueOn="true",t.valueOff="false",t.wrap=!1,t}e.ToggleInput=Ct;var _t,Et=(r(xt,_t=p),xt.prototype.parse=function(t){_t.prototype.parse.call(this,t),this.title=f.getStringValue(t.title,""),this.value=f.getStringValue(t.value,"")},xt.prototype.toJSON=function(){var t=_t.prototype.toJSON.call(this);return f.setProperty(t,"title",this.title),f.setProperty(t,"value",this.value),t},xt);function xt(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0);var i=_t.call(this)||this;return i.title=t,i.value=e,i}e.Choice=Et;var At,wt=(r(It,At=gt),It.getUniqueCategoryName=function(){var t="__ac-category"+It.uniqueCategoryCounter;return It.uniqueCategoryCounter++,t},It.prototype.internalRender=function(){var t=this;if(this.isMultiSelect){var e=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):null;(a=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-multiSelect"),a.style.width="100%",this._toggleInputs=[];for(var i=0;i<this.choices.length;i++){var n=document.createElement("input");n.id=f.generateUniqueId(),n.type="checkbox",n.style.margin="0",n.style.display="inline-block",n.style.verticalAlign="middle",n.value=this.choices[i].value,n.style.flex="0 0 auto",n.setAttribute("aria-label",this.choices[i].title),e&&0<=e.indexOf(this.choices[i].value)&&(n.checked=!0),n.onchange=function(){t.valueChanged()},this._toggleInputs.push(n),(p=new D).setParent(this),p.forElementId=n.id,p.hostConfig=this.hostConfig,p.text=f.isNullOrEmpty(this.choices[i].title)?"Choice "+i:this.choices[i].title,p.useMarkdown=We.useMarkdownInRadioButtonAndCheckbox,p.wrap=this.wrap,(c=p.render()).style.display="inline-block",c.style.flex="1 1 auto",c.style.marginLeft="6px",c.style.verticalAlign="middle",(h=document.createElement("div")).style.width="6px",(d=document.createElement("div")).style.display="flex",d.style.alignItems="center",f.appendChild(d,n),f.appendChild(d,h),f.appendChild(d,c),f.appendChild(a,d)}return a}if(this.isCompact){this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%";var r=document.createElement("option");r.selected=!0,r.disabled=!0,r.hidden=!0,r.value="",this.placeholder&&(r.text=this.placeholder),f.appendChild(this._selectElement,r);for(var o=0;o<this.choices.length;o++){var s=document.createElement("option");s.value=this.choices[o].value,s.text=this.choices[o].title,s.setAttribute("aria-label",this.choices[o].title),this.choices[o].value==this.defaultValue&&(s.selected=!0),f.appendChild(this._selectElement,s)}return this._selectElement.onchange=function(){t.valueChanged()},this._selectElement}var a,l=It.getUniqueCategoryName();(a=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-expanded"),a.style.width="100%",this._toggleInputs=[];for(var u=0;u<this.choices.length;u++){var p,c,h,d,g=document.createElement("input");g.id=f.generateUniqueId(),g.type="radio",g.style.margin="0",g.style.display="inline-block",g.style.verticalAlign="middle",g.name=f.isNullOrEmpty(this.id)?l:this.id,g.value=this.choices[u].value,g.style.flex="0 0 auto",g.setAttribute("aria-label",this.choices[u].title),this.choices[u].value==this.defaultValue&&(g.checked=!0),g.onchange=function(){t.valueChanged()},this._toggleInputs.push(g),(p=new D).setParent(this),p.forElementId=g.id,p.hostConfig=this.hostConfig,p.text=f.isNullOrEmpty(this.choices[u].title)?"Choice "+u:this.choices[u].title,p.useMarkdown=We.useMarkdownInRadioButtonAndCheckbox,p.wrap=this.wrap,(c=p.render()).style.display="inline-block",c.style.flex="1 1 auto",c.style.marginLeft="6px",c.style.verticalAlign="middle",(h=document.createElement("div")).style.width="6px",(d=document.createElement("div")).style.display="flex",d.style.alignItems="center",f.appendChild(d,g),f.appendChild(d,h),f.appendChild(d,c),f.appendChild(a,d)}return a},It.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},It.prototype.toJSON=function(){var t=At.prototype.toJSON.call(this);return f.setProperty(t,"placeholder",this.placeholder),f.setArrayProperty(t,"choices",this.choices),f.setProperty(t,"style",this.isCompact?null:"expanded"),f.setProperty(t,"isMultiSelect",this.isMultiSelect,!1),f.setProperty(t,"wrap",this.wrap,!1),t},It.prototype.internalValidateProperties=function(t){At.prototype.internalValidateProperties.call(this,t),0==this.choices.length&&t.addFailure(this,{error:d.ValidationError.CollectionCantBeEmpty,message:"An Input.ChoiceSet must have at least one choice defined."});for(var e=0,i=this.choices;e<i.length;e++){var n=i[e];n.title&&n.value||t.addFailure(this,{error:d.ValidationError.PropertyCantBeNull,message:"All choices in an Input.ChoiceSet must have their title and value properties set."})}},It.prototype.parse=function(t,e){if(At.prototype.parse.call(this,t,e),this.isCompact=!("expanded"===t.style),this.isMultiSelect=f.getBoolValue(t.isMultiSelect,this.isMultiSelect),this.placeholder=f.getStringValue(t.placeholder),this.choices=[],Array.isArray(t.choices))for(var i=0,n=t.choices;i<n.length;i++){var r=n[i],o=new Et;o.parse(r),this.choices.push(o)}this.wrap=f.getBoolValue(t.wrap,this.wrap)},Object.defineProperty(It.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0==this._toggleInputs.length)return null;for(var t="",e=0;e<this._toggleInputs.length;e++)this._toggleInputs[e].checked&&(""!=t&&(t+=this.hostConfig.choiceSetInputValueSeparator),t+=this._toggleInputs[e].value);return""==t?null:t}if(this.isCompact)return this._selectElement&&0<this._selectElement.selectedIndex?this._selectElement.value:null;if(!this._toggleInputs||0==this._toggleInputs.length)return null;for(var e=0;e<this._toggleInputs.length;e++)if(this._toggleInputs[e].checked)return this._toggleInputs[e].value;return null},enumerable:!0,configurable:!0}),It.uniqueCategoryCounter=0,It);function It(){var t=null!==At&&At.apply(this,arguments)||this;return t.choices=[],t.isCompact=!1,t.isMultiSelect=!1,t.wrap=!1,t}e.ChoiceSetInput=wt;var Tt,Pt=(r(Ot,Tt=gt),Ot.prototype.internalRender=function(){var t=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=0,f.isNullOrEmpty(this.defaultValue)||(this._numberInputElement.value=this.defaultValue),f.isNullOrEmpty(this.placeholder)||(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){t.valueChanged()},this._numberInputElement},Ot.prototype.getJsonTypeName=function(){return"Input.Number"},Ot.prototype.toJSON=function(){var t=Tt.prototype.toJSON.call(this);return f.setProperty(t,"placeholder",this.placeholder),f.setNumberProperty(t,"min",this.min),f.setNumberProperty(t,"max",this.max),t},Ot.prototype.parse=function(t,e){Tt.prototype.parse.call(this,t,e),this.placeholder=f.getStringValue(t.placeholder),this.min=f.getNumberValue(t.min),this.max=f.getNumberValue(t.max)},Object.defineProperty(Ot.prototype,"min",{get:function(){return this._min},set:function(t){this._min=t},enumerable:!0,configurable:!0}),Object.defineProperty(Ot.prototype,"max",{get:function(){return this._max},set:function(t){this._max=t},enumerable:!0,configurable:!0}),Object.defineProperty(Ot.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(Ot.prototype,"valueAsNumber",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0},enumerable:!0,configurable:!0}),Ot);function Ot(){return null!==Tt&&Tt.apply(this,arguments)||this}e.NumberInput=Pt;var kt,Vt=(r(Nt,kt=gt),Nt.prototype.internalRender=function(){var t=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this._dateInputElement.setAttribute("min",this.min),this._dateInputElement.setAttribute("max",this.max),this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){t.valueChanged()},f.isNullOrEmpty(this.defaultValue)||(this._dateInputElement.value=this.defaultValue),this._dateInputElement},Nt.prototype.getJsonTypeName=function(){return"Input.Date"},Nt.prototype.toJSON=function(){var t=kt.prototype.toJSON.call(this);return f.setProperty(t,"min",this.min),f.setProperty(t,"max",this.max),t},Nt.prototype.parse=function(t,e){kt.prototype.parse.call(this,t,e),this.min=f.getStringValue(t.min),this.max=f.getStringValue(t.max)},Object.defineProperty(Nt.prototype,"min",{get:function(){return this._min},set:function(t){this._min=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Nt.prototype,"max",{get:function(){return this._max},set:function(t){this._max=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Nt.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:null},enumerable:!0,configurable:!0}),Nt);function Nt(){return null!==kt&&kt.apply(this,arguments)||this}e.DateInput=Vt;var zt,Dt,Ft,Mt=(r(Bt,zt=gt),Bt.prototype.internalRender=function(){var t=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this._timeInputElement.setAttribute("min",this.min),this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){t.valueChanged()},f.isNullOrEmpty(this.defaultValue)||(this._timeInputElement.value=this.defaultValue),this._timeInputElement},Bt.prototype.parseInputValue=function(t){return/^[0-9]{2}:[0-9]{2}$/.test(t)?t:null},Bt.prototype.getJsonTypeName=function(){return"Input.Time"},Bt.prototype.toJSON=function(){var t=zt.prototype.toJSON.call(this);return f.setProperty(t,"min",this.min),f.setProperty(t,"max",this.max),t},Bt.prototype.parse=function(t,e){zt.prototype.parse.call(this,t,e),this.min=f.getStringValue(t.min),this.max=f.getStringValue(t.max)},Object.defineProperty(Bt.prototype,"min",{get:function(){return this._min},set:function(t){this._min=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Bt.prototype,"max",{get:function(){return this._max},set:function(t){this._max=this.parseInputValue(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Bt.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:null},enumerable:!0,configurable:!0}),Bt);function Bt(){return null!==zt&&zt.apply(this,arguments)||this}e.TimeInput=Mt,(Ft=Dt=Dt||{})[Ft.Normal=0]="Normal",Ft[Ft.Expanded=1]="Expanded",Ft[Ft.Subdued=2]="Subdued";var Lt=(Rt.prototype.updateCssStyle=function(){var t,e,i=this.action.parent.hostConfig;switch(this.action.renderedElement.className=i.makeCssClassName("ac-pushButton"),f.isNullOrEmpty(this._parentContainerStyle)||this.action.renderedElement.classList.add("style-"+this._parentContainerStyle),this.action instanceof se&&this.action.renderedElement.classList.add(i.makeCssClassName("expandable")),this.action.renderedElement.classList.remove(i.makeCssClassName("expanded")),this.action.renderedElement.classList.remove(i.makeCssClassName("subdued")),this._state){case Dt.Expanded:this.action.renderedElement.classList.add(i.makeCssClassName("expanded"));break;case Dt.Subdued:this.action.renderedElement.classList.add(i.makeCssClassName("subdued"))}f.isNullOrEmpty(this.action.style)||(this.action.style===d.ActionStyle.Positive?(t=this.action.renderedElement.classList).add.apply(t,i.makeCssClassNames("primary","style-positive")):(e=this.action.renderedElement.classList).add.apply(e,i.makeCssClassNames("style-"+this.action.style.toLowerCase())))},Rt.prototype.render=function(){var e=this;this.action.render(),this.action.renderedElement.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.click()},this.updateCssStyle()},Rt.prototype.click=function(){null!=this.onClick&&this.onClick(this)},Object.defineProperty(Rt.prototype,"state",{get:function(){return this._state},set:function(t){this._state=t,this.updateCssStyle()},enumerable:!0,configurable:!0}),Rt);function Rt(t,e){this._state=Dt.Normal,this.onClick=null,this.action=t,this._parentContainerStyle=e}var Ht,jt=(r(Jt,Ht=E),Jt.prototype.setCollection=function(t){this._actionCollection=t},Jt.prototype.addCssClasses=function(t){},Jt.prototype.internalGetReferencedInputs=function(t){return{}},Jt.prototype.internalPrepareForExecution=function(t){},Jt.prototype.internalValidateInputs=function(t){var e=[];if(We.useBuiltInInputValidation&&!this.ignoreInputValidation)for(var i=0,n=Object.keys(t);i<n.length;i++){var r=t[n[i]];r.validateValue()||e.push(r)}return e},Jt.prototype.getHref=function(){return""},Jt.prototype.toJSON=function(){var t=Ht.prototype.toJSON.call(this);return f.setProperty(t,"type",this.getJsonTypeName()),f.setProperty(t,"title",this.title),f.setProperty(t,"iconUrl",this.iconUrl),f.setProperty(t,"style",this.style,d.ActionStyle.Default),t},Jt.prototype.render=function(t){void 0===t&&(t="ac-pushButton");var e=this.parent.hostConfig,i=document.createElement("button");this.addCssClasses(i),i.setAttribute("aria-label",this.title),i.type="button",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center";var n,r=!f.isNullOrEmpty(this.title),o=document.createElement("div");o.style.overflow="hidden",o.style.textOverflow="ellipsis",e.actions.iconPlacement==d.ActionIconPlacement.AboveTitle||e.actions.allowTitleToWrap||(o.style.whiteSpace="nowrap"),r&&(o.innerText=this.title),f.isNullOrEmpty(this.iconUrl)?i.classList.add("noIcon"):((n=document.createElement("img")).src=this.iconUrl,n.style.width=e.actions.iconSize+"px",n.style.height=e.actions.iconSize+"px",n.style.flex="0 0 auto",e.actions.iconPlacement==d.ActionIconPlacement.AboveTitle?(i.classList.add("iconAbove"),i.style.flexDirection="column",r&&(n.style.marginBottom="4px")):(i.classList.add("iconLeft"),r&&(n.style.marginRight="4px")),i.appendChild(n)),i.appendChild(o),this._renderedElement=i},Jt.prototype.setParent=function(t){this._parent=t},Jt.prototype.execute=function(){var t,e,i;this.onExecute&&this.onExecute(this),e=(t=this).parent.getRootElement(),(i=e&&e.onExecuteAction?e.onExecuteAction:We.onExecuteAction)&&t.prepareForExecution()&&i(t)},Jt.prototype.prepareForExecution=function(){var t=this.getReferencedInputs();return!(0<this.internalValidateInputs(t).length)&&(this.internalPrepareForExecution(t),!0)},Jt.prototype.parse=function(t,e){var i,n,r,o,s;Ht.prototype.parse.call(this,t,e),n=t,r=e,o=(i=this).parent?i.parent.getRootElement():null,null!=(s=o&&o.onParseAction?o.onParseAction:We.onParseAction)&&s(i,n,r),this.requires.parse(t.requires,e),t.title||""===t.title||ke({error:d.ValidationError.PropertyCantBeNull,message:"Actions should always have a title."},e),this.title=f.getStringValue(t.title),this.iconUrl=f.getStringValue(t.iconUrl),this.style=f.getStringValue(t.style,this.style)},Jt.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},Jt.prototype.getAllInputs=function(){return[]},Jt.prototype.getResourceInformation=function(){return f.isNullOrEmpty(this.iconUrl)?[]:[{url:this.iconUrl,mimeType:"image"}]},Jt.prototype.getActionById=function(t){if(this.id==t)return this},Jt.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs(this.parent.getRootElement().getAllInputs())},Jt.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},Jt.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.parent.hostConfig.hostCapabilities)},Object.defineProperty(Jt.prototype,"isPrimary",{get:function(){return this.style==d.ActionStyle.Positive},set:function(t){t?this.style=d.ActionStyle.Positive:this.style==d.ActionStyle.Positive&&(this.style=d.ActionStyle.Default)},enumerable:!0,configurable:!0}),Object.defineProperty(Jt.prototype,"ignoreInputValidation",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(Jt.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(Jt.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),Jt);function Jt(){var t=null!==Ht&&Ht.apply(this,arguments)||this;return t._shouldFallback=!1,t._parent=null,t._actionCollection=null,t._renderedElement=null,t.requires=new s.HostCapabilities,t.style=d.ActionStyle.Default,t}e.Action=jt;var Wt,Ut=(r(qt,Wt=jt),qt.prototype.internalGetReferencedInputs=function(t){for(var e={},i=0,n=t;i<n.length;i++){var r=n[i];e[r.id]=r}return e},qt.prototype.internalPrepareForExecution=function(t){this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={};for(var e=0,i=Object.keys(t);e<i.length;e++){var n=t[i[e]];null!=n.value&&(this._processedData[n.id]=n.value)}this._isPrepared=!0},qt.prototype.getJsonTypeName=function(){return qt.JsonTypeName},qt.prototype.toJSON=function(){var t=Wt.prototype.toJSON.call(this);return f.setProperty(t,"ignoreInputValidation",this.ignoreInputValidation,!1),f.setProperty(t,"data",this._originalData),t},qt.prototype.parse=function(t,e){Wt.prototype.parse.call(this,t,e),this._ignoreInputValidation=f.getBoolValue(t.ignoreInputValidation,this._ignoreInputValidation),this.data=t.data},Object.defineProperty(qt.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(t){this._ignoreInputValidation=t},enumerable:!0,configurable:!0}),Object.defineProperty(qt.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(t){this._originalData=t,this._isPrepared=!1},enumerable:!0,configurable:!0}),qt.JsonTypeName="Action.Submit",qt);function qt(){var t=null!==Wt&&Wt.apply(this,arguments)||this;return t._isPrepared=!1,t._ignoreInputValidation=!1,t}e.SubmitAction=Ut;var Gt,Xt=(r($t,Gt=jt),$t.prototype.getJsonTypeName=function(){return $t.JsonTypeName},$t.prototype.toJSON=function(){var t=Gt.prototype.toJSON.call(this);return f.setProperty(t,"url",this.url),t},$t.prototype.internalValidateProperties=function(t){Gt.prototype.internalValidateProperties.call(this,t),f.isNullOrEmpty(this.url)&&t.addFailure(this,{error:d.ValidationError.PropertyCantBeNull,message:"An Action.OpenUrl must have its url property set."})},$t.prototype.parse=function(t,e){Gt.prototype.parse.call(this,t,e),this.url=f.getStringValue(t.url)},$t.prototype.getHref=function(){return this.url},$t.JsonTypeName="Action.OpenUrl",$t);function $t(){return null!==Gt&&Gt.apply(this,arguments)||this}e.OpenUrlAction=Xt;var Yt,Zt=(r(Kt,Yt=jt),Kt.prototype.getJsonTypeName=function(){return Kt.JsonTypeName},Kt.prototype.execute=function(){for(var t=0,e=Object.keys(this.targetElements);t<e.length;t++){var i=e[t],n=this.parent.getRootElement().getElementById(i);n&&("boolean"==typeof this.targetElements[i]?n.isVisible=this.targetElements[i]:n.isVisible=!n.isVisible)}},Kt.prototype.parse=function(t){Yt.prototype.parse.call(this,t),this.targetElements={};var e=t.targetElements;if(e&&Array.isArray(e))for(var i=0,n=e;i<n.length;i++){var r,o=n[i];"string"==typeof o?this.targetElements[o]=void 0:"object"!=typeof o||(r=o.elementId)&&"string"==typeof r&&(this.targetElements[r]=f.getBoolValue(o.isVisible,void 0))}},Kt.prototype.toJSON=function(){for(var t=Yt.prototype.toJSON.call(this),e=[],i=0,n=Object.keys(this.targetElements);i<n.length;i++){var r=n[i];"boolean"==typeof this.targetElements[r]?e.push({elementId:r,isVisible:this.targetElements[r]}):e.push(r)}return t.targetElements=e,t},Kt.prototype.addTargetElement=function(t,e){void 0===e&&(e=void 0),this.targetElements[t]=e},Kt.prototype.removeTargetElement=function(t){delete this.targetElements[t]},Kt.JsonTypeName="Action.ToggleVisibility",Kt);function Kt(){var t=null!==Yt&&Yt.apply(this,arguments)||this;return t.targetElements={},t}e.ToggleVisibilityAction=Zt;var Qt,te=(r(ee,Qt=p),ee.prototype.parse=function(t){Qt.prototype.parse.call(this,t),this.name=f.getStringValue(t.name),this.value=f.getStringValue(t.value)},ee.prototype.toJSON=function(){var t=Qt.prototype.toJSON.call(this);return f.setProperty(t,"name",this.name),f.setProperty(t,"value",this._value.getOriginal()),t},ee.prototype.getReferencedInputs=function(t,e){this._value.getReferencedInputs(t,e)},ee.prototype.prepareForExecution=function(t){this._value.substituteInputValues(t,h.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(ee.prototype,"value",{get:function(){return this._value.get()},set:function(t){this._value.set(t)},enumerable:!0,configurable:!0}),ee);function ee(t,e){void 0===t&&(t=""),void 0===e&&(e="");var i=Qt.call(this)||this;return i._value=new h.StringWithSubstitutions,i.name=t,i.value=e,i}e.HttpHeader=te;var ie,ne=(r(re,ie=jt),re.prototype.internalGetReferencedInputs=function(t){var e={};this._url.getReferencedInputs(t,e);for(var i=0,n=this._headers;i<n.length;i++){n[i].getReferencedInputs(t,e)}return this._body.getReferencedInputs(t,e),e},re.prototype.internalPrepareForExecution=function(t){this._url.substituteInputValues(t,h.ContentTypes.applicationXWwwFormUrlencoded);for(var e=h.ContentTypes.applicationJson,i=0,n=this._headers;i<n.length;i++){var r=n[i];r.prepareForExecution(t),r.name&&"content-type"==r.name.toLowerCase()&&(e=r.value)}this._body.substituteInputValues(t,e)},re.prototype.getJsonTypeName=function(){return re.JsonTypeName},re.prototype.toJSON=function(){var t=ie.prototype.toJSON.call(this);return f.setProperty(t,"method",this.method),f.setProperty(t,"url",this._url.getOriginal()),f.setProperty(t,"body",this._body.getOriginal()),f.setProperty(t,"ignoreInputValidation",this.ignoreInputValidation,!1),f.setArrayProperty(t,"headers",this.headers),t},re.prototype.internalValidateProperties=function(t){if(ie.prototype.internalValidateProperties.call(this,t),f.isNullOrEmpty(this.url)&&t.addFailure(this,{error:d.ValidationError.PropertyCantBeNull,message:"An Action.Http must have its url property set."}),0<this.headers.length)for(var e=0,i=this.headers;e<i.length;e++){i[e].name||t.addFailure(this,{error:d.ValidationError.PropertyCantBeNull,message:"All headers of an Action.Http must have their name and value properties set."})}},re.prototype.parse=function(t,e){if(ie.prototype.parse.call(this,t,e),this.url=f.getStringValue(t.url),this.method=f.getStringValue(t.method),this.body=f.getStringValue(t.body),this._ignoreInputValidation=f.getBoolValue(t.ignoreInputValidation,this._ignoreInputValidation),this._headers=[],Array.isArray(t.headers))for(var i=0,n=t.headers;i<n.length;i++){var r=n[i],o=new te;o.parse(r),this.headers.push(o)}},Object.defineProperty(re.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(t){this._ignoreInputValidation=t},enumerable:!0,configurable:!0}),Object.defineProperty(re.prototype,"url",{get:function(){return this._url.get()},set:function(t){this._url.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(re.prototype,"body",{get:function(){return this._body.get()},set:function(t){this._body.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(re.prototype,"headers",{get:function(){return this._headers?this._headers:[]},set:function(t){this._headers=t},enumerable:!0,configurable:!0}),re.JsonTypeName="Action.Http",re);function re(){var t=null!==ie&&ie.apply(this,arguments)||this;return t._url=new h.StringWithSubstitutions,t._body=new h.StringWithSubstitutions,t._headers=[],t._ignoreInputValidation=!1,t}e.HttpAction=ne;var oe,se=(r(ae,oe=jt),ae.prototype.addCssClasses=function(t){oe.prototype.addCssClasses.call(this,t),t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))},ae.prototype.getJsonTypeName=function(){return ae.JsonTypeName},ae.prototype.toJSON=function(){var t=oe.prototype.toJSON.call(this);return this.card&&f.setProperty(t,"card",this.card.toJSON()),t},ae.prototype.internalValidateProperties=function(t){oe.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},ae.prototype.parse=function(t,e){oe.prototype.parse.call(this,t,e);var i=t.card;i?this.card.parse(i,e):ke({error:d.ValidationError.PropertyCantBeNull,message:'An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},e)},ae.prototype.setParent=function(t){oe.prototype.setParent.call(this,t),this.card.setParent(t)},ae.prototype.getAllInputs=function(){return this.card.getAllInputs()},ae.prototype.getResourceInformation=function(){return oe.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())},ae.prototype.getActionById=function(t){return oe.prototype.getActionById.call(this,t)||this.card.getActionById(t)},ae.JsonTypeName="Action.ShowCard",ae);function ae(){var t=null!==oe&&oe.apply(this,arguments)||this;return t.card=new Ge,t}e.ShowCardAction=se;var le=(ue.prototype.refreshContainer=function(){var t,e;this._actionCardContainer.innerHTML="",null!==this._actionCard?(this._actionCardContainer.style.marginTop=0<this._renderedActionCount?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px",t=this._owner.getEffectivePadding(),this._owner.getImmediateSurroundingPadding(t),e=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(t),null!==this._actionCard&&(this._actionCard.style.paddingLeft=e.left+"px",this._actionCard.style.paddingRight=e.right+"px",this._actionCard.style.marginLeft="-"+e.left+"px",this._actionCard.style.marginRight="-"+e.right+"px",0==e.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=e.bottom+"px",this._actionCard.style.marginBottom="-"+e.bottom+"px"),f.appendChild(this._actionCardContainer,this._actionCard))):this._actionCardContainer.style.marginTop="0px"},ue.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},ue.prototype.hideActionCard=function(){var t=this._expandedAction;this._expandedAction=null,this._actionCard=null,this.refreshContainer(),t&&(this.layoutChanged(),Pe(t,!1))},ue.prototype.showActionCard=function(t,e,i){var n;void 0===e&&(e=!1),void 0===i&&(i=!0),null!=t.card&&(t.card.suppressStyle=e,n=t.card.render(),this._actionCard=n,this._expandedAction=t,this.refreshContainer(),i&&(this.layoutChanged(),Pe(t,!0)))},ue.prototype.collapseExpandedAction=function(){for(var t=0;t<this.buttons.length;t++)this.buttons[t].state=Dt.Normal;this.hideActionCard()},ue.prototype.expandShowCardAction=function(t,e){for(var i=0;i<this.buttons.length;i++)this.buttons[i].action!==t?this.buttons[i].state=Dt.Subdued:this.buttons[i].state=Dt.Expanded;this.showActionCard(t,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),e)},ue.prototype.actionClicked=function(t){if(t.action instanceof se)this._owner.hostConfig.actions.showCard.actionMode===d.ShowCardActionMode.Popup?t.action.execute():t.action===this._expandedAction?this.collapseExpandedAction():this.expandShowCardAction(t.action,!0);else{for(var e=0;e<this.buttons.length;e++)this.buttons[e].state=Dt.Normal;this.hideActionCard(),t.action.execute()}},ue.prototype.getParentContainer=function(){return this._owner instanceof Ce?this._owner:this._owner.getParentContainer()},ue.prototype.findActionButton=function(t){for(var e=0,i=this.buttons;e<i.length;e++){var n=i[e];if(n.action==t)return n}return null},ue.prototype.parse=function(t,e){if(this.clear(),t&&t instanceof Array)for(var i=0,n=t;i<n.length;i++){var r=n[i],o=l(this._owner,r,[],!this._owner.isDesignMode(),e);o&&this.addAction(o)}},ue.prototype.toJSON=function(){if(0<this.items.length){for(var t=[],e=0,i=this.items;e<i.length;e++){var n=i[e];t.push(n.toJSON())}return t}return null},ue.prototype.getActionById=function(t){for(var e=null,i=0;i<this.items.length&&!(e=this.items[i].getActionById(t));i++);return e},ue.prototype.validateProperties=function(t){this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions&&t.addFailure(this._owner,{error:d.ValidationError.TooManyActions,message:"A maximum of "+this._owner.hostConfig.actions.maxActions+" actions are allowed."}),0<this.items.length&&!this._owner.hostConfig.supportsInteractivity&&t.addFailure(this._owner,{error:d.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."});for(var e=0,i=this.items;e<i.length;e++){var n=i[e];y(n,this._owner.getForbiddenActionTypes())||t.addFailure(this._owner,{error:d.ValidationError.ActionTypeNotAllowed,message:"Actions of type "+n.getJsonTypeName()+" are not allowe."}),n.internalValidateProperties(t)}},ue.prototype.render=function(t,e){var i=this,n=this._owner.hostConfig;if(!n.supportsInteractivity)return null;var r=document.createElement("div"),o=n.actions.maxActions?Math.min(n.actions.maxActions,this.items.length):this.items.length,s=this._owner.getForbiddenActionTypes();if(this._actionCardContainer=document.createElement("div"),this._renderedActionCount=0,n.actions.preExpandSingleShowCardAction&&1==o&&this.items[0]instanceof se&&y(this.items[0],s))this.showActionCard(this.items[0],!0),this._renderedActionCount=1;else{var a=document.createElement("div");if(a.className=n.makeCssClassName("ac-actionSet"),a.style.display="flex",t==d.Orientation.Horizontal)if(a.style.flexDirection="row",this._owner.horizontalAlignment&&n.actions.actionAlignment!=d.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case d.HorizontalAlignment.Center:a.style.justifyContent="center";break;case d.HorizontalAlignment.Right:a.style.justifyContent="flex-end";break;default:a.style.justifyContent="flex-start"}else switch(n.actions.actionAlignment){case d.ActionAlignment.Center:a.style.justifyContent="center";break;case d.ActionAlignment.Right:a.style.justifyContent="flex-end";break;default:a.style.justifyContent="flex-start"}else if(a.style.flexDirection="column",this._owner.horizontalAlignment&&n.actions.actionAlignment!=d.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case d.HorizontalAlignment.Center:a.style.alignItems="center";break;case d.HorizontalAlignment.Right:a.style.alignItems="flex-end";break;default:a.style.alignItems="flex-start"}else switch(n.actions.actionAlignment){case d.ActionAlignment.Center:a.style.alignItems="center";break;case d.ActionAlignment.Right:a.style.alignItems="flex-end";break;case d.ActionAlignment.Stretch:a.style.alignItems="stretch";break;default:a.style.alignItems="flex-start"}for(var l=this.getParentContainer().getEffectiveStyle(),u=0;u<this.items.length;u++)if(y(this.items[u],s)){var p,c=this.findActionButton(this.items[u]);if(c||((c=new Lt(this.items[u],l)).onClick=function(t){i.actionClicked(t)},this.buttons.push(c)),c.render(),n.actions.actionsOrientation==d.Orientation.Horizontal&&n.actions.actionAlignment==d.ActionAlignment.Stretch?c.action.renderedElement.style.flex="0 1 100%":c.action.renderedElement.style.flex="0 1 auto",c.action.renderedElement.title=this.items[u].title,a.appendChild(c.action.renderedElement),this._renderedActionCount++,this._renderedActionCount>=n.actions.maxActions||u==this.items.length-1)break;0<n.actions.buttonSpacing&&(p=document.createElement("div"),t===d.Orientation.Horizontal?(p.style.flex="0 0 auto",p.style.width=n.actions.buttonSpacing+"px"):p.style.height=n.actions.buttonSpacing+"px",f.appendChild(a,p))}var h=document.createElement("div");h.style.overflow="hidden",h.appendChild(a),f.appendChild(r,h)}f.appendChild(r,this._actionCardContainer);for(u=0;u<this.buttons.length;u++)if(this.buttons[u].state==Dt.Expanded){this.expandShowCardAction(this.buttons[u].action,!1);break}return 0<this._renderedActionCount?r:null},ue.prototype.addAction=function(t){if(!t)throw new Error("The action parameter cannot be null.");if(t.parent&&t.parent!==this._owner||!(this.items.indexOf(t)<0))throw new Error("The action already belongs to another element.");this.items.push(t),t.parent||t.setParent(this._owner),a(t,this)},ue.prototype.removeAction=function(t){this.expandedAction&&this._expandedAction==t&&this.collapseExpandedAction();var e=this.items.indexOf(t);if(0<=e){this.items.splice(e,1),t.setParent(null),a(t,null);for(var i=0;i<this.buttons.length;i++)if(this.buttons[i].action==t){this.buttons.splice(i,1);break}return!0}return!1},ue.prototype.clear=function(){this.items=[],this.buttons=[],this._expandedAction=null,this._renderedActionCount=0},ue.prototype.getAllInputs=function(){for(var t=[],e=0;e<this.items.length;e++)var i=this.items[e],t=t.concat(i.getAllInputs());return t},ue.prototype.getResourceInformation=function(){for(var t=[],e=0;e<this.items.length;e++)t=t.concat(this.items[e].getResourceInformation());return t},Object.defineProperty(ue.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:!0,configurable:!0}),Object.defineProperty(ue.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!0,configurable:!0}),ue);function ue(t){this._expandedAction=null,this._renderedActionCount=0,this._actionCard=null,this.items=[],this.buttons=[],this._owner=t}var pe,ce=(r(he,pe=w),he.prototype.internalRender=function(){return this._actionCollection.render(this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())},he.prototype.toJSON=function(){var t=pe.prototype.toJSON.call(this);return f.setEnumProperty(d.Orientation,t,"orientation",this.orientation),f.setProperty(t,"actions",this._actionCollection.toJSON()),t},he.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?pe.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction},he.prototype.getJsonTypeName=function(){return"ActionSet"},he.prototype.getActionCount=function(){return this._actionCollection.items.length},he.prototype.getActionAt=function(t){if(0<=t&&t<this.getActionCount())return this._actionCollection.items[t];pe.prototype.getActionAt.call(this,t)},he.prototype.internalValidateProperties=function(t){pe.prototype.internalValidateProperties.call(this,t),this._actionCollection.validateProperties(t)},he.prototype.parse=function(t,e){pe.prototype.parse.call(this,t,e);var i=t.orientation;i&&(this.orientation=f.getEnumValue(d.Orientation,i,d.Orientation.Horizontal)),this._actionCollection.parse(t.actions,e)},he.prototype.addAction=function(t){this._actionCollection.addAction(t)},he.prototype.getAllInputs=function(){return this._actionCollection.getAllInputs()},he.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},Object.defineProperty(he.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),he);function he(){var t=pe.call(this)||this;return t.orientation=null,t._actionCollection=new le(t),t}e.ActionSet=ce;var de,ge=(r(fe,de=Q),fe.prototype.applyBackground=function(){var t=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));f.isNullOrEmpty(t.backgroundColor)||(this.renderedElement.style.backgroundColor=f.stringToCssColor(t.backgroundColor))},fe.prototype.applyPadding=function(){var t,e,i;de.prototype.applyPadding.call(this),this.renderedElement&&(t=new h.SpacingDefinition,this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.isBleeding()?(e=new h.PaddingDefinition,this.getImmediateSurroundingPadding(e),i=this.hostConfig.paddingDefinitionToSpacingDefinition(e),this.renderedElement.style.marginRight="-"+i.right+"px",this.renderedElement.style.marginLeft="-"+i.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+i.top+"px",this.renderedElement.style.marginBottom="-"+i.bottom+"px"),this.separatorElement&&this.separatorOrientation==d.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+i.left+"px",this.separatorElement.style.marginRight="-"+i.right+"px")):(this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")))},fe.prototype.getHasBackground=function(){for(var t=this.parent;t;){var e=t instanceof Ce&&t.backgroundImage.isValid();if(t instanceof fe&&this.hasExplicitStyle&&(t.getEffectiveStyle()!=this.getEffectiveStyle()||e))return!0;t=t.parent}return!1},fe.prototype.getDefaultPadding=function(){return this.getHasBackground()?new h.PaddingDefinition(d.Spacing.Padding,d.Spacing.Padding,d.Spacing.Padding,d.Spacing.Padding):de.prototype.getDefaultPadding.call(this)},fe.prototype.getHasExpandedAction=function(){return!1},fe.prototype.getBleed=function(){return this._bleed},fe.prototype.setBleed=function(t){this._bleed=t},Object.defineProperty(fe.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(fe.prototype,"hasExplicitStyle",{get:function(){return null!=this._style},enumerable:!0,configurable:!0}),Object.defineProperty(fe.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(fe.prototype,"supportsMinHeight",{get:function(){return!0},enumerable:!0,configurable:!0}),fe.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},fe.prototype.toJSON=function(){var t=de.prototype.toJSON.call(this);return f.setProperty(t,"style",this.style),t},fe.prototype.internalValidateProperties=function(t){de.prototype.internalValidateProperties.call(this,t),this._style&&(this.hostConfig.containerStyles.getStyleByName(this._style)||t.addFailure(this,{error:d.ValidationError.InvalidPropertyValue,message:"Unknown container style: "+this._style}))},fe.prototype.parse=function(t,e){de.prototype.parse.call(this,t,e),this._style=f.getStringValue(t.style)},fe.prototype.render=function(){var t=de.prototype.render.call(this);return t&&this.getHasBackground()&&this.applyBackground(),t},fe.prototype.getEffectiveStyle=function(){var t=this.style;return t||de.prototype.getEffectiveStyle.call(this)},Object.defineProperty(fe.prototype,"style",{get:function(){return this.allowCustomStyle&&this._style&&this.hostConfig.containerStyles.getStyleByName(this._style)?this._style:null},set:function(t){this._style=t},enumerable:!0,configurable:!0}),fe);function fe(){var t=null!==de&&de.apply(this,arguments)||this;return t._style=null,t._bleed=!1,t}e.StylableCardElementContainer=ge;var ye,me=(r(ve,ye=p),ve.prototype.reset=function(){this.url=void 0,this.fillMode=ve.defaultFillMode,this.horizontalAlignment=ve.defaultHorizontalAlignment,this.verticalAlignment=ve.defaultVerticalAlignment},ve.prototype.parse=function(t,e){ye.prototype.parse.call(this,t,e),this.url=f.getStringValue(t.url),this.fillMode=f.getEnumValue(d.FillMode,t.fillMode,this.fillMode),this.horizontalAlignment=f.getEnumValue(d.HorizontalAlignment,t.horizontalAlignment,this.horizontalAlignment),this.verticalAlignment=f.getEnumValue(d.VerticalAlignment,t.verticalAlignment,this.verticalAlignment)},ve.prototype.toJSON=function(){if(!this.isValid())return null;if(this.fillMode==ve.defaultFillMode&&this.horizontalAlignment==ve.defaultHorizontalAlignment&&this.verticalAlignment==ve.defaultVerticalAlignment)return this.url;var t=ye.prototype.toJSON.call(this);return f.setProperty(t,"url",this.url),f.setEnumProperty(d.FillMode,t,"fillMode",this.fillMode,ve.defaultFillMode),f.setEnumProperty(d.HorizontalAlignment,t,"horizontalAlignment",this.horizontalAlignment,ve.defaultHorizontalAlignment),f.setEnumProperty(d.VerticalAlignment,t,"verticalAlignment",this.verticalAlignment,ve.defaultVerticalAlignment),t},ve.prototype.apply=function(t){if(this.url){switch(t.style.backgroundImage="url('"+this.url+"')",this.fillMode){case d.FillMode.Repeat:t.style.backgroundRepeat="repeat";break;case d.FillMode.RepeatHorizontally:t.style.backgroundRepeat="repeat-x";break;case d.FillMode.RepeatVertically:t.style.backgroundRepeat="repeat-y";break;case d.FillMode.Cover:default:t.style.backgroundRepeat="no-repeat",t.style.backgroundSize="cover"}switch(this.horizontalAlignment){case d.HorizontalAlignment.Center:t.style.backgroundPositionX="center";break;case d.HorizontalAlignment.Right:t.style.backgroundPositionX="right"}switch(this.verticalAlignment){case d.VerticalAlignment.Center:t.style.backgroundPositionY="center";break;case d.VerticalAlignment.Bottom:t.style.backgroundPositionY="bottom"}}},ve.prototype.isValid=function(){return!f.isNullOrEmpty(this.url)},ve.defaultFillMode=d.FillMode.Cover,ve.defaultHorizontalAlignment=d.HorizontalAlignment.Left,ve.defaultVerticalAlignment=d.VerticalAlignment.Top,ve);function ve(){var t=null!==ye&&ye.apply(this,arguments)||this;return t.fillMode=ve.defaultFillMode,t.horizontalAlignment=ve.defaultHorizontalAlignment,t.verticalAlignment=ve.defaultVerticalAlignment,t}e.BackgroundImage=me;var be,Ce=(r(Se,be=ge),Se.prototype.insertItemAt=function(t,e,i){if(t.parent&&!i)throw new Error("The element already belongs to another container.");if(!t.isStandalone)throw new Error("Elements of type "+t.getJsonTypeName()+" cannot be used as standalone elements.");e<0||e>=this._items.length?this._items.push(t):this._items.splice(e,0,t),t.setParent(this)},Se.prototype.supportsExcplitiHeight=function(){return!0},Se.prototype.getItemsCollectionPropertyName=function(){return"items"},Se.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.backgroundImage.apply(this.renderedElement),be.prototype.applyBackground.call(this)},Se.prototype.internalRender=function(){this._renderedItems=[];var t,e=this.hostConfig,i=document.createElement("div");switch(null!=this.rtl&&this.rtl&&(i.dir="rtl"),i.classList.add(e.makeCssClassName("ac-container")),i.style.display="flex",i.style.flexDirection="column",We.useAdvancedCardBottomTruncation&&(i.style.minHeight="-webkit-min-content"),this.verticalContentAlignment){case d.VerticalAlignment.Center:i.style.justifyContent="center";break;case d.VerticalAlignment.Bottom:i.style.justifyContent="flex-end";break;default:i.style.justifyContent="flex-start"}if(0<this._items.length)for(var n=0;n<this._items.length;n++){var r=this.isElementAllowed(this._items[n],this.getForbiddenElementTypes())?this._items[n].render():null;r&&(0<this._renderedItems.length&&this._items[n].separatorElement&&(this._items[n].separatorElement.style.flex="0 0 auto",f.appendChild(i,this._items[n].separatorElement)),f.appendChild(i,r),this._renderedItems.push(this._items[n]))}else this.isDesignMode()&&((t=this.createPlaceholderElement()).style.width="100%",t.style.height="100%",i.appendChild(t));return i},Se.prototype.truncateOverflow=function(t){for(var n=this.renderedElement.offsetTop+t+1,r=function(t){var e=t.renderedElement;if(e)switch(f.getFitStatus(e,n)){case d.ContainerFitStatus.FullyInContainer:t.resetOverflow()&&r(t);break;case d.ContainerFitStatus.Overflowing:var i=n-e.offsetTop;t.handleOverflow(i);break;case d.ContainerFitStatus.FullyOutOfContainer:t.handleOverflow(0)}},e=0,i=this._items;e<i.length;e++){var o=i[e];r(o)}return!0},Se.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._items;t<e.length;t++){e[t].resetOverflow()}},Se.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||be.prototype.getHasBackground.call(this)},Object.defineProperty(Se.prototype,"isSelectable",{get:function(){return!0},enumerable:!0,configurable:!0}),Se.prototype.toJSON=function(){var t=be.prototype.toJSON.call(this);if(f.setProperty(t,"backgroundImage",this.backgroundImage.toJSON()),f.setEnumProperty(d.VerticalAlignment,t,"verticalContentAlignment",this.verticalContentAlignment,d.VerticalAlignment.Top),0<this._items.length){for(var e=[],i=0,n=this._items;i<n.length;i++){var r=n[i];e.push(r.toJSON())}f.setProperty(t,this.getItemsCollectionPropertyName(),e)}return f.setProperty(t,"bleed",this.bleed,!1),t},Se.prototype.getItemCount=function(){return this._items.length},Se.prototype.getItemAt=function(t){return this._items[t]},Se.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&0<this._renderedItems.length)for(var t=0,e=this._renderedItems;t<e.length;t++){var i=e[t];if(i.isVisible)return i}return null},Se.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&0<this._renderedItems.length)for(var t=this._renderedItems.length-1;0<=t;t--)if(this._renderedItems[t].isVisible)return this._renderedItems[t];return null},Se.prototype.getJsonTypeName=function(){return"Container"},Se.prototype.isFirstElement=function(t){for(var e=this.isDesignMode(),i=0;i<this._items.length;i++)if(this._items[i].isVisible||e)return this._items[i]==t;return!1},Se.prototype.isLastElement=function(t){for(var e=this.isDesignMode(),i=this._items.length-1;0<=i;i--)if(this._items[i].isVisible||e)return this._items[i]==t;return!1},Se.prototype.isRtl=function(){if(null!=this.rtl)return this.rtl;var t=this.getParentContainer();return!!t&&t.isRtl()},Se.prototype.isBleedingAtTop=function(){var t=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!t&&t.isBleedingAtTop()},Se.prototype.isBleedingAtBottom=function(){var t=this.getLastVisibleRenderedItem();return this.isBleeding()||!!t&&(t.isBleedingAtBottom()&&t.getEffectiveStyle()==this.getEffectiveStyle())},Se.prototype.parse=function(t,e){be.prototype.parse.call(this,t,e),this.setShouldFallback(!1),this._items=[],this._renderedItems=[],this.backgroundImage.reset();var i=t.backgroundImage;if(i&&("string"==typeof i?(this.backgroundImage.url=i,this.backgroundImage.fillMode=d.FillMode.Cover):"object"==typeof i&&this.backgroundImage.parse(i,e)),this.verticalContentAlignment=f.getEnumValue(d.VerticalAlignment,t.verticalContentAlignment,this.verticalContentAlignment),null!=t[this.getItemsCollectionPropertyName()]){var n=t[this.getItemsCollectionPropertyName()];this.clear();for(var r=0;r<n.length;r++){var o=u(this,n[r],!this.isDesignMode(),e);o&&this.insertItemAt(o,-1,!0)}}this.bleed=f.getBoolValue(t.bleed,this.bleed)},Se.prototype.indexOf=function(t){return this._items.indexOf(t)},Se.prototype.addItem=function(t){this.insertItemAt(t,-1,!1)},Se.prototype.insertItemBefore=function(t,e){this.insertItemAt(t,this._items.indexOf(e),!1)},Se.prototype.insertItemAfter=function(t,e){this.insertItemAt(t,this._items.indexOf(e)+1,!1)},Se.prototype.removeItem=function(t){var e=this._items.indexOf(t);return 0<=e&&(this._items.splice(e,1),t.setParent(null),this.updateLayout(),!0)},Se.prototype.clear=function(){this._items=[]},Se.prototype.getResourceInformation=function(){var t=be.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},Se.prototype.getActionById=function(t){var e=be.prototype.getActionById.call(this,t);if(!e&&(this.selectAction&&(e=this.selectAction.getActionById(t)),!e))for(var i=0;i<this._items.length&&!(e=this._items[i].getActionById(t));i++);return e},Object.defineProperty(Se.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Se.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(t){this.setSelectAction(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Se.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:!0,configurable:!0}),Se);function Se(){var t=null!==be&&be.apply(this,arguments)||this;return t._items=[],t._renderedItems=[],t.backgroundImage=new me,t.verticalContentAlignment=d.VerticalAlignment.Top,t.rtl=null,t}e.Container=Ce;var _e,Ee=(r(xe,_e=Ce),xe.prototype.adjustRenderedElementSize=function(t){var e;this.isDesignMode()?(t.style.minWidth="20px",t.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(t.style.minWidth="0",this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?t.style.flex="0 1 auto":"stretch"===this.width?t.style.flex="1 1 50px":(e=this.width).unit==d.SizeUnit.Pixel?(t.style.flex="0 0 auto",t.style.width=e.physicalSize+"px"):t.style.flex="1 1 "+(0<this._computedWeight?this._computedWeight:e.physicalSize)+"%"},Object.defineProperty(xe.prototype,"separatorOrientation",{get:function(){return d.Orientation.Vertical},enumerable:!0,configurable:!0}),xe.prototype.getJsonTypeName=function(){return"Column"},xe.prototype.toJSON=function(){var t=_e.prototype.toJSON.call(this);return this.width instanceof h.SizeAndUnit?this.width.unit==d.SizeUnit.Pixel?f.setProperty(t,"width",this.width.physicalSize+"px"):f.setProperty(t,"width",this.width.physicalSize):f.setProperty(t,"width",this.width),t},xe.prototype.parse=function(t,e){_e.prototype.parse.call(this,t,e);var i=t.width;if(void 0===i&&void 0!==(i=t.size)&&ke({error:d.ValidationError.Deprecated,message:'The "Column.size" property is deprecated and will be removed. Use the "Column.width" property instead.'},e),i){var n=!1;try{this.width=h.SizeAndUnit.parse(i)}catch(t){"string"!=typeof i||"auto"!==i&&"stretch"!==i?n=!0:this.width=i}n&&ke({error:d.ValidationError.InvalidPropertyValue,message:"Invalid column width:"+i+' - defaulting to "auto"'},e)}},Object.defineProperty(xe.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof we)&&(this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!0,configurable:!0}),Object.defineProperty(xe.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),xe);function xe(t){void 0===t&&(t="auto");var e=_e.call(this)||this;return e._computedWeight=0,e.width="auto",e.width=t,e}e.Column=Ee;var Ae,we=(r(Ie,Ae=ge),Ie.prototype.createColumnInstance=function(t,e){return m(this,t,[],!this.isDesignMode(),function(t){return t&&"Column"!==t?null:new Ee},function(t,e){return e==c.UnknownType?{error:d.ValidationError.UnknownElementType,message:"Unknown element type: "+t+". Fallback will be used if present."}:{error:d.ValidationError.ElementTypeNotAllowed,message:"Element type "+t+" isn't allowed in a ColumnSet."}},e)},Ie.prototype.internalRender=function(){if(this._renderedColumns=[],0<this._columns.length){var t=this.hostConfig,e=document.createElement("div");switch(e.className=t.makeCssClassName("ac-columnSet"),e.style.display="flex",We.useAdvancedCardBottomTruncation&&(e.style.minHeight="-webkit-min-content"),this.horizontalAlignment){case d.HorizontalAlignment.Center:e.style.justifyContent="center";break;case d.HorizontalAlignment.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}for(var i=0,n=0,r=this._columns;n<r.length;n++){(o=r[n]).width instanceof h.SizeAndUnit&&o.width.unit==d.SizeUnit.Weight&&(i+=o.width.physicalSize)}for(var o,s,a=0,l=this._columns;a<l.length;a++){(o=l[a]).width instanceof h.SizeAndUnit&&o.width.unit==d.SizeUnit.Weight&&0<i&&(s=100/i*o.width.physicalSize,o._computedWeight=s);var u=o.render();u&&(0<this._renderedColumns.length&&o.separatorElement&&(o.separatorElement.style.flex="0 0 auto",f.appendChild(e,o.separatorElement)),f.appendChild(e,u),this._renderedColumns.push(o))}return 0<this._renderedColumns.length?e:null}return null},Ie.prototype.truncateOverflow=function(t){for(var e=0,i=this._columns;e<i.length;e++){i[e].handleOverflow(t)}return!0},Ie.prototype.undoOverflowTruncation=function(){for(var t=0,e=this._columns;t<e.length;t++){e[t].resetOverflow()}},Object.defineProperty(Ie.prototype,"isSelectable",{get:function(){return!0},enumerable:!0,configurable:!0}),Ie.prototype.toJSON=function(){var t=Ae.prototype.toJSON.call(this);if(0<this._columns.length){for(var e=[],i=0,n=this._columns;i<n.length;i++){var r=n[i];e.push(r.toJSON())}f.setProperty(t,"columns",e)}return f.setProperty(t,"bleed",this.bleed,!1),t},Ie.prototype.isFirstElement=function(t){for(var e=0;e<this._columns.length;e++)if(this._columns[e].isVisible)return this._columns[e]==t;return!1},Ie.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&0<this._renderedColumns.length)for(var t=0,e=this._columns;t<e.length;t++){if(e[t].isBleedingAtTop())return!0}return!1},Ie.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&0<this._renderedColumns.length)for(var t=0,e=this._columns;t<e.length;t++){if(e[t].isBleedingAtBottom())return!0}return!1},Ie.prototype.getCount=function(){return this._columns.length},Ie.prototype.getItemCount=function(){return this.getCount()},Ie.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&0<this._renderedColumns.length?this._renderedColumns[0]:null},Ie.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&0<this._renderedColumns.length?this._renderedColumns[this._renderedColumns.length-1]:null},Ie.prototype.getColumnAt=function(t){return this._columns[t]},Ie.prototype.getItemAt=function(t){return this.getColumnAt(t)},Ie.prototype.getJsonTypeName=function(){return"ColumnSet"},Ie.prototype.parse=function(t,e){if(Ae.prototype.parse.call(this,t,e),null!=t.columns){var i=t.columns;this._columns=[];for(var n=0;n<i.length;n++){var r=this.createColumnInstance(i[n],e);this._columns.push(r)}}this.bleed=f.getBoolValue(t.bleed,this.bleed)},Ie.prototype.internalValidateProperties=function(t){Ae.prototype.internalValidateProperties.call(this,t);for(var e=0,i=0,n=0,r=this._columns;n<r.length;n++){var o=r[n];"number"==typeof o.width?e++:"stretch"===o.width&&i++}0<e&&0<i&&t.addFailure(this,{error:d.ValidationError.Hint,message:"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."})},Ie.prototype.addColumn=function(t){if(t.parent)throw new Error("This column already belongs to another ColumnSet.");this._columns.push(t),t.setParent(this)},Ie.prototype.removeItem=function(t){if(t instanceof Ee){var e=this._columns.indexOf(t);if(0<=e)return this._columns.splice(e,1),t.setParent(null),this.updateLayout(),!0}return!1},Ie.prototype.indexOf=function(t){return t instanceof Ee?this._columns.indexOf(t):-1},Ie.prototype.isLeftMostElement=function(t){return 0==this._columns.indexOf(t)},Ie.prototype.isRightMostElement=function(t){return this._columns.indexOf(t)==this._columns.length-1},Ie.prototype.isTopElement=function(t){return 0<=this._columns.indexOf(t)},Ie.prototype.isBottomElement=function(t){return 0<=this._columns.indexOf(t)},Ie.prototype.getActionById=function(t){for(var e=null,i=0;i<this._columns.length&&!(e=this._columns[i].getActionById(t));i++);return e},Object.defineProperty(Ie.prototype,"bleed",{get:function(){return this.getBleed()},set:function(t){this.setBleed(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Ie.prototype,"padding",{get:function(){return this.getPadding()},set:function(t){this.setPadding(t)},enumerable:!0,configurable:!0}),Object.defineProperty(Ie.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(t){this.setSelectAction(t)},enumerable:!0,configurable:!0}),Ie);function Ie(){var t=null!==Ae&&Ae.apply(this,arguments)||this;return t._columns=[],t}function Te(t){var e=t.getRootElement(),i=e&&e.onImageLoaded?e.onImageLoaded:We.onImageLoaded;i&&i(t)}function Pe(t,e){var i=t.parent.getRootElement(),n=i&&i.onInlineCardExpanded?i.onInlineCardExpanded:We.onInlineCardExpanded;n&&n(t,e)}function Oe(t,e){void 0===e&&(e=!0);var i=t.getRootElement();e&&i.updateLayout();var n=i&&i.onElementVisibilityChanged?i.onElementVisibilityChanged:We.onElementVisibilityChanged;null!=n&&n(t)}function ke(t,e){e&&e.push(t),null!=We.onParseError&&We.onParseError(t)}e.ColumnSet=we;var Ve,Ne=(r(ze,Ve=Ce),ze.prototype.internalRender=function(){var t=Ve.prototype.internalRender.call(this),e=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,!1);return e&&(f.appendChild(t,f.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing),lineThickness:null,lineColor:null},d.Orientation.Horizontal)),f.appendChild(t,e)),this.renderIfEmpty||0<t.children.length?t:null},ze.prototype.getHasExpandedAction=function(){return 0!=this.renderedActionCount&&(1==this.renderedActionCount?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction)},Object.defineProperty(ze.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!0,configurable:!0}),ze.prototype.toJSON=function(){var t=Ve.prototype.toJSON.call(this);return f.setProperty(t,"actions",this._actionCollection.toJSON()),t},ze.prototype.getActionCount=function(){return this._actionCollection.items.length},ze.prototype.getActionAt=function(t){if(0<=t&&t<this.getActionCount())return this._actionCollection.items[t];Ve.prototype.getActionAt.call(this,t)},ze.prototype.getActionById=function(t){var e=this._actionCollection.getActionById(t);return e||Ve.prototype.getActionById.call(this,t)},ze.prototype.parse=function(t,e){Ve.prototype.parse.call(this,t,e),this._actionCollection.parse(t.actions,e)},ze.prototype.internalValidateProperties=function(t){Ve.prototype.internalValidateProperties.call(this,t),this._actionCollection&&this._actionCollection.validateProperties(t)},ze.prototype.isLastElement=function(t){return Ve.prototype.isLastElement.call(this,t)&&0==this._actionCollection.items.length},ze.prototype.addAction=function(t){this._actionCollection.addAction(t)},ze.prototype.clear=function(){Ve.prototype.clear.call(this),this._actionCollection.clear()},ze.prototype.getAllInputs=function(){return Ve.prototype.getAllInputs.call(this).concat(this._actionCollection.getAllInputs())},ze.prototype.getResourceInformation=function(){return Ve.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())},ze.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?Ve.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction},Object.defineProperty(ze.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),ze);function ze(){var t=Ve.call(this)||this;return t._actionCollection=new le(t),t}e.ContainerWithActions=Ne;var De=(Fe.prototype.findTypeRegistration=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e].typeName===t)return this._items[e];return null},Fe.prototype.clear=function(){this._items=[]},Fe.prototype.registerType=function(t,e){var i=this.findTypeRegistration(t);null!=i?i.createInstance=e:(i={typeName:t,createInstance:e},this._items.push(i))},Fe.prototype.unregisterType=function(t){for(var e=0;e<this._items.length;e++)if(this._items[e].typeName===t)return void this._items.splice(e,1)},Fe.prototype.createInstance=function(t){var e=this.findTypeRegistration(t);return e?e.createInstance():null},Fe.prototype.getItemCount=function(){return this._items.length},Fe.prototype.getItemAt=function(t){return this._items[t]},Fe);function Fe(){this._items=[],this.reset()}e.TypeRegistry=De;var Me,Be=(r(Le,Me=De),Le.prototype.reset=function(){this.clear(),this.registerType("Container",function(){return new Ce}),this.registerType("TextBlock",function(){return new V}),this.registerType("RichTextBlock",function(){return new H}),this.registerType("TextRun",function(){return new B}),this.registerType("Image",function(){return new Y}),this.registerType("ImageSet",function(){return new it}),this.registerType("Media",function(){return new lt}),this.registerType("FactSet",function(){return new G}),this.registerType("ColumnSet",function(){return new we}),this.registerType("ActionSet",function(){return new ce}),this.registerType("Input.Text",function(){return new mt}),this.registerType("Input.Date",function(){return new Vt}),this.registerType("Input.Time",function(){return new Mt}),this.registerType("Input.Number",function(){return new Pt}),this.registerType("Input.ChoiceSet",function(){return new wt}),this.registerType("Input.Toggle",function(){return new Ct})},Le);function Le(){return null!==Me&&Me.apply(this,arguments)||this}e.ElementTypeRegistry=Be;var Re,He=(r(je,Re=De),je.prototype.reset=function(){this.clear(),this.registerType(Xt.JsonTypeName,function(){return new Xt}),this.registerType(Ut.JsonTypeName,function(){return new Ut}),this.registerType(se.JsonTypeName,function(){return new se}),this.registerType(Zt.JsonTypeName,function(){return new Zt})},je);function je(){return null!==Re&&Re.apply(this,arguments)||this}e.ActionTypeRegistry=He;var Je,We=(r(Ue,Je=Ne),Object.defineProperty(Ue,"processMarkdown",{get:function(){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},set:function(t){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},enumerable:!0,configurable:!0}),Ue.applyMarkdown=function(t){var e={didProcess:!1};return Ue.onProcessMarkdown?Ue.onProcessMarkdown(t,e):window.markdownit?(e.outputHtml=window.markdownit().render(t),e.didProcess=!0):console.warn("Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"),e},Ue.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||Ue.currentVersion.major<this.version.major||Ue.currentVersion.major==this.version.major&&Ue.currentVersion.minor<this.version.minor)},Ue.prototype.getItemsCollectionPropertyName=function(){return"body"},Ue.prototype.internalRender=function(){var t=Je.prototype.internalRender.call(this);return Ue.useAdvancedCardBottomTruncation&&(t.style.minHeight=null),t},Ue.prototype.getHasBackground=function(){return!0},Ue.prototype.getDefaultPadding=function(){return new h.PaddingDefinition(d.Spacing.Padding,d.Spacing.Padding,d.Spacing.Padding,d.Spacing.Padding)},Object.defineProperty(Ue.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(Ue.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(Ue.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!0,configurable:!0}),Object.defineProperty(Ue.prototype,"hasBackground",{get:function(){return!0},enumerable:!0,configurable:!0}),Ue.prototype.getJsonTypeName=function(){return"AdaptiveCard"},Ue.prototype.toJSON=function(){var t=Je.prototype.toJSON.call(this);return f.setProperty(t,"$schema","http://adaptivecards.io/schemas/adaptive-card.json"),!this.bypassVersionCheck&&this.version&&f.setProperty(t,"version",this.version.toString()),f.setProperty(t,"fallbackText",this.fallbackText),f.setProperty(t,"lang",this.lang),f.setProperty(t,"speak",this.speak),t},Ue.prototype.internalValidateProperties=function(t){Je.prototype.internalValidateProperties.call(this,t),"AdaptiveCard"!=this._cardTypeName&&t.addFailure(this,{error:d.ValidationError.MissingCardType,message:'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'}),this.bypassVersionCheck||this.version?this.isVersionSupported()||t.addFailure(this,{error:d.ValidationError.UnsupportedCardVersion,message:"The specified card version ("+this.version+") is not supported. The maximum supported card version is "+Ue.currentVersion}):t.addFailure(this,{error:d.ValidationError.PropertyCantBeNull,message:"The version property must be specified."})},Ue.prototype.parse=function(t,e){this._fallbackCard=null,this._cardTypeName=f.getStringValue(t.type),this.speak=f.getStringValue(t.speak);var i=f.getStringValue(t.lang);if(i&&"string"==typeof i)try{this.lang=i}catch(t){ke({error:d.ValidationError.InvalidPropertyValue,message:t.message},e)}this.version=s.Version.parse(t.version,e),this.fallbackText=f.getStringValue(t.fallbackText);var n=u(null,t.fallback,!this.isDesignMode(),e);n&&(this._fallbackCard=new Ue,this._fallbackCard.addItem(n)),Je.prototype.parse.call(this,t,e)},Ue.prototype.render=function(t){var e;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,e=this._fallbackCard.render()):(e=Je.prototype.render.call(this))&&(e.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),e.tabIndex=0,f.isNullOrEmpty(this.speak)||e.setAttribute("aria-label",this.speak)),t&&(t.appendChild(e),this.updateLayout()),e},Ue.prototype.updateLayout=function(t){var e,i;void 0===t&&(t=!0),Je.prototype.updateLayout.call(this,t),Ue.useAdvancedCardBottomTruncation&&this.isRendered()&&(e=this.renderedElement,i=this.hostConfig.getEffectiveSpacing(d.Spacing.Default),this.handleOverflow(e.offsetHeight-i))},Ue.prototype.shouldFallback=function(){return Je.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(Ue.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!0,configurable:!0}),Ue.currentVersion=new s.Version(1,2),Ue.useAdvancedTextBlockTruncation=!0,Ue.useAdvancedCardBottomTruncation=!1,Ue.useMarkdownInRadioButtonAndCheckbox=!0,Ue.allowMarkForTextHighlighting=!1,Ue.alwaysBleedSeparators=!1,Ue.enableFullJsonRoundTrip=!1,Ue.useBuiltInInputValidation=!0,Ue.displayInputValidationErrors=!0,Ue.elementTypeRegistry=new Be,Ue.actionTypeRegistry=new He,Ue.onAnchorClicked=null,Ue.onExecuteAction=null,Ue.onElementVisibilityChanged=null,Ue.onImageLoaded=null,Ue.onInlineCardExpanded=null,Ue.onInputValueChanged=null,Ue.onParseElement=null,Ue.onParseAction=null,Ue.onParseError=null,Ue.onProcessMarkdown=null,Ue);function Ue(){var t=null!==Je&&Je.apply(this,arguments)||this;return t._cardTypeName="AdaptiveCard",t._fallbackCard=null,t.onAnchorClicked=null,t.onExecuteAction=null,t.onElementVisibilityChanged=null,t.onImageLoaded=null,t.onInlineCardExpanded=null,t.onInputValueChanged=null,t.onParseElement=null,t.onParseAction=null,t.version=new s.Version(1,0),t.designMode=!1,t}e.AdaptiveCard=We;var qe,Ge=(r(Xe,qe=We),Xe.prototype.getDefaultPadding=function(){return new h.PaddingDefinition(this.suppressStyle?d.Spacing.None:d.Spacing.Padding,d.Spacing.Padding,this.suppressStyle?d.Spacing.None:d.Spacing.Padding,d.Spacing.Padding)},Object.defineProperty(Xe.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(Xe.prototype,"defaultStyle",{get:function(){return this.suppressStyle?d.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:d.ContainerStyle.Emphasis},enumerable:!0,configurable:!0}),Xe.prototype.render=function(t){var e=qe.prototype.render.call(this,t);return e.setAttribute("aria-live","polite"),e.removeAttribute("tabindex"),e},Xe.prototype.getForbiddenActionTypes=function(){return[se]},Xe);function Xe(){var t=null!==qe&&qe.apply(this,arguments)||this;return t.suppressStyle=!1,t}var $e=new s.HostConfig({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:d.Spacing.Default,buttonSpacing:10,showCard:{actionMode:d.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:d.Orientation.Horizontal,actionAlignment:d.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:d.Size.Medium,maxImageHeight:100},factSet:{title:{color:d.TextColor.Default,size:d.TextSize.Default,isSubtle:!1,weight:d.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:d.TextColor.Default,size:d.TextSize.Default,isSubtle:!1,weight:d.TextWeight.Default,wrap:!0},spacing:10}})},"./src/enums.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,r,o,s,a,l,u,p,c,h,d,g,f,y,m,v,b,C=(S.Default="default",S.Positive="positive",S.Destructive="destructive",S);function S(){}e.ActionStyle=C,(n=e.Size||(e.Size={}))[n.Auto=0]="Auto",n[n.Stretch=1]="Stretch",n[n.Small=2]="Small",n[n.Medium=3]="Medium",n[n.Large=4]="Large",(r=e.SizeUnit||(e.SizeUnit={}))[r.Weight=0]="Weight",r[r.Pixel=1]="Pixel",(o=e.TextSize||(e.TextSize={}))[o.Small=0]="Small",o[o.Default=1]="Default",o[o.Medium=2]="Medium",o[o.Large=3]="Large",o[o.ExtraLarge=4]="ExtraLarge",(s=e.TextWeight||(e.TextWeight={}))[s.Lighter=0]="Lighter",s[s.Default=1]="Default",s[s.Bolder=2]="Bolder",(a=e.FontType||(e.FontType={}))[a.Default=0]="Default",a[a.Monospace=1]="Monospace",(l=e.Spacing||(e.Spacing={}))[l.None=0]="None",l[l.Small=1]="Small",l[l.Default=2]="Default",l[l.Medium=3]="Medium",l[l.Large=4]="Large",l[l.ExtraLarge=5]="ExtraLarge",l[l.Padding=6]="Padding",(u=e.TextColor||(e.TextColor={}))[u.Default=0]="Default",u[u.Dark=1]="Dark",u[u.Light=2]="Light",u[u.Accent=3]="Accent",u[u.Good=4]="Good",u[u.Warning=5]="Warning",u[u.Attention=6]="Attention",(p=e.HorizontalAlignment||(e.HorizontalAlignment={}))[p.Left=0]="Left",p[p.Center=1]="Center",p[p.Right=2]="Right",(c=e.VerticalAlignment||(e.VerticalAlignment={}))[c.Top=0]="Top",c[c.Center=1]="Center",c[c.Bottom=2]="Bottom",(h=e.ActionAlignment||(e.ActionAlignment={}))[h.Left=0]="Left",h[h.Center=1]="Center",h[h.Right=2]="Right",h[h.Stretch=3]="Stretch",(d=e.ImageStyle||(e.ImageStyle={}))[d.Default=0]="Default",d[d.Person=1]="Person",(g=e.ShowCardActionMode||(e.ShowCardActionMode={}))[g.Inline=0]="Inline",g[g.Popup=1]="Popup",(f=e.Orientation||(e.Orientation={}))[f.Horizontal=0]="Horizontal",f[f.Vertical=1]="Vertical",(y=e.FillMode||(e.FillMode={}))[y.Cover=0]="Cover",y[y.RepeatHorizontally=1]="RepeatHorizontally",y[y.RepeatVertically=2]="RepeatVertically",y[y.Repeat=3]="Repeat",(m=e.ActionIconPlacement||(e.ActionIconPlacement={}))[m.LeftOfTitle=0]="LeftOfTitle",m[m.AboveTitle=1]="AboveTitle",(v=e.InputTextStyle||(e.InputTextStyle={}))[v.Text=0]="Text",v[v.Tel=1]="Tel",v[v.Url=2]="Url",v[v.Email=3]="Email",(b=e.InputValidationNecessity||(e.InputValidationNecessity={}))[b.Optional=0]="Optional",b[b.Required=1]="Required",b[b.RequiredWithVisualCue=2]="RequiredWithVisualCue";var _,E,x=(A.Default="default",A.Emphasis="emphasis",A.Accent="accent",A.Good="good",A.Attention="attention",A.Warning="warning",A);function A(){}e.ContainerStyle=x,(_=e.ValidationError||(e.ValidationError={}))[_.Hint=0]="Hint",_[_.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",_[_.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",_[_.Deprecated=3]="Deprecated",_[_.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",_[_.InteractivityNotAllowed=5]="InteractivityNotAllowed",_[_.InvalidPropertyValue=6]="InvalidPropertyValue",_[_.MissingCardType=7]="MissingCardType",_[_.PropertyCantBeNull=8]="PropertyCantBeNull",_[_.TooManyActions=9]="TooManyActions",_[_.UnknownActionType=10]="UnknownActionType",_[_.UnknownElementType=11]="UnknownElementType",_[_.UnsupportedCardVersion=12]="UnsupportedCardVersion",_[_.DuplicateId=13]="DuplicateId",(E=e.ContainerFitStatus||(e.ContainerFitStatus={}))[E.FullyInContainer=0]="FullyInContainer",E[E.Overflowing=1]="Overflowing",E[E.FullyOutOfContainer=2]="FullyOutOfContainer"},"./src/host-config.ts":function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var s=i("./src/enums.ts"),o=i("./src/utils.ts"),a=i("./src/shared.ts"),l=(u.prototype.parse=function(t){t&&(this.default=t.default||this.default,this.subtle=t.subtle||this.subtle)},u);function u(t,e){this.default="#000000",this.subtle="#666666",t&&(this.default=t),e&&(this.subtle=e)}e.ColorDefinition=l;var p,c=(r(h,p=l),h.prototype.parse=function(t){p.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},h);function h(){var t=null!==p&&p.apply(this,arguments)||this;return t.highlightColors=new l("#22000000","#11000000"),t}e.TextColorDefinition=c;var d=function(t){this.allowCustomStyle=!1,t&&(this.allowCustomStyle=t.allowCustomStyle||this.allowCustomStyle)};e.AdaptiveCardConfig=d;var g=(f.prototype.toJSON=function(){return{imageSize:s.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},f);function f(t){this.imageSize=s.Size.Medium,this.maxImageHeight=100,t&&(this.imageSize=null!=t.imageSize?t.imageSize:this.imageSize,this.maxImageHeight=o.getNumberValue(t.maxImageHeight,100))}e.ImageSetConfig=g;var y=(m.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},m);function m(t){this.allowInlinePlayback=!0,t&&(this.defaultPoster=t.defaultPoster,this.allowInlinePlayback=t.allowInlinePlayback||this.allowInlinePlayback)}e.MediaConfig=y;var v=(b.prototype.getDefaultWeight=function(){return s.TextWeight.Default},b.prototype.toJSON=function(){return{size:s.TextSize[this.size],color:s.TextColor[this.color],isSubtle:this.isSubtle,weight:s.TextWeight[this.weight],wrap:this.wrap}},b);function b(t){this.size=s.TextSize.Default,this.color=s.TextColor.Default,this.isSubtle=!1,this.weight=s.TextWeight.Default,this.wrap=!0,t&&(this.size=o.parseHostConfigEnum(s.TextSize,t.size,s.TextSize.Default),this.color=o.parseHostConfigEnum(s.TextColor,t.color,s.TextColor.Default),this.isSubtle=t.isSubtle||this.isSubtle,this.weight=o.parseHostConfigEnum(s.TextWeight,t.weight,this.getDefaultWeight()),this.wrap=null!=t.wrap?t.wrap:this.wrap)}e.FactTextDefinition=v;var C,S=(r(_,C=v),_.prototype.getDefaultWeight=function(){return s.TextWeight.Bolder},_);function _(t){var e=C.call(this,t)||this;return e.maxWidth=150,e.weight=s.TextWeight.Bolder,t&&(e.maxWidth=null!=t.maxWidth?t.maxWidth:e.maxWidth,e.weight=o.parseHostConfigEnum(s.TextWeight,t.weight,s.TextWeight.Bolder)),e}e.FactTitleDefinition=S;var E=function(t){this.title=new S,this.value=new v,this.spacing=10,t&&(this.title=new S(t.title),this.value=new v(t.value),this.spacing=t.spacing&&null!=t.spacing?t.spacing&&t.spacing:this.spacing)};e.FactSetConfig=E;var x=(A.prototype.toJSON=function(){return{actionMode:s.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},A);function A(t){this.actionMode=s.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=s.ContainerStyle.Emphasis,t&&(this.actionMode=o.parseHostConfigEnum(s.ShowCardActionMode,t.actionMode,s.ShowCardActionMode.Inline),this.inlineTopMargin=null!=t.inlineTopMargin?t.inlineTopMargin:this.inlineTopMargin,this.style=t.style&&"string"==typeof t.style?t.style:s.ContainerStyle.Emphasis)}e.ShowCardActionConfig=x;var w=(I.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:s.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:s.Orientation[this.actionsOrientation],actionAlignment:s.ActionAlignment[this.actionAlignment]}},I);function I(t){if(this.maxActions=5,this.spacing=s.Spacing.Default,this.buttonSpacing=20,this.showCard=new x,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=s.Orientation.Horizontal,this.actionAlignment=s.ActionAlignment.Left,this.iconPlacement=s.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=24,t){this.maxActions=null!=t.maxActions?t.maxActions:this.maxActions,this.spacing=o.parseHostConfigEnum(s.Spacing,t.spacing&&t.spacing,s.Spacing.Default),this.buttonSpacing=null!=t.buttonSpacing?t.buttonSpacing:this.buttonSpacing,this.showCard=new x(t.showCard),this.preExpandSingleShowCardAction=o.getBoolValue(t.preExpandSingleShowCardAction,!1),this.actionsOrientation=o.parseHostConfigEnum(s.Orientation,t.actionsOrientation,s.Orientation.Horizontal),this.actionAlignment=o.parseHostConfigEnum(s.ActionAlignment,t.actionAlignment,s.ActionAlignment.Left),this.iconPlacement=o.parseHostConfigEnum(s.ActionIconPlacement,t.iconPlacement,s.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=t.allowTitleToWrap?t.allowTitleToWrap:this.allowTitleToWrap;try{var e=a.SizeAndUnit.parse(t.iconSize);e.unit==s.SizeUnit.Pixel&&(this.iconSize=e.physicalSize)}catch(t){}}}e.ActionsConfig=w;var T=(P.prototype.parseSingleColor=function(t,e){t&&this[e].parse(t[e])},P.prototype.parse=function(t){t&&(this.parseSingleColor(t,"default"),this.parseSingleColor(t,"dark"),this.parseSingleColor(t,"light"),this.parseSingleColor(t,"accent"),this.parseSingleColor(t,"good"),this.parseSingleColor(t,"warning"),this.parseSingleColor(t,"attention"))},P);function P(t){this.default=new c,this.dark=new c,this.light=new c,this.accent=new c,this.good=new c,this.warning=new c,this.attention=new c,this.parse(t)}e.ColorSetDefinition=T;var O=(k.prototype.parse=function(t){t&&(this.backgroundColor=t.backgroundColor,this.foregroundColors.parse(t.foregroundColors),this.highlightBackgroundColor=t.highlightBackgroundColor,this.highlightForegroundColor=t.highlightForegroundColor)},Object.defineProperty(k.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!0,configurable:!0}),k);function k(t){this.foregroundColors=new T({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#54A254",subtle:"#DD54A254"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(t)}e.ContainerStyleDefinition=O;var V,N=(r(z,V=O),Object.defineProperty(z.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!0,configurable:!0}),z);function z(){return null!==V&&V.apply(this,arguments)||this}var D=(F.prototype.toJSON=function(){var e=this,i=[];Object.keys(this._allStyles).forEach(function(t){e._allStyles[t].isBuiltIn||i.push({name:t,style:e._allStyles[t]})});var t={default:this.default,emphasis:this.emphasis};return 0<i.length&&(t.customStyles=i),t},F.prototype.getStyleByName=function(t,e){return void 0===e&&(e=null),this._allStyles.hasOwnProperty(t)?this._allStyles[t]:e},Object.defineProperty(F.prototype,"default",{get:function(){return this._allStyles[s.ContainerStyle.Default]},enumerable:!0,configurable:!0}),Object.defineProperty(F.prototype,"emphasis",{get:function(){return this._allStyles[s.ContainerStyle.Emphasis]},enumerable:!0,configurable:!0}),F);function F(t){if(this._allStyles={},this._allStyles[s.ContainerStyle.Default]=new N,this._allStyles[s.ContainerStyle.Emphasis]=new N,this._allStyles[s.ContainerStyle.Accent]=new N,this._allStyles[s.ContainerStyle.Good]=new N,this._allStyles[s.ContainerStyle.Attention]=new N,this._allStyles[s.ContainerStyle.Warning]=new N,t){this._allStyles[s.ContainerStyle.Default].parse(t[s.ContainerStyle.Default]),this._allStyles[s.ContainerStyle.Emphasis].parse(t[s.ContainerStyle.Emphasis]),this._allStyles[s.ContainerStyle.Accent].parse(t[s.ContainerStyle.Accent]),this._allStyles[s.ContainerStyle.Good].parse(t[s.ContainerStyle.Good]),this._allStyles[s.ContainerStyle.Attention].parse(t[s.ContainerStyle.Attention]),this._allStyles[s.ContainerStyle.Warning].parse(t[s.ContainerStyle.Warning]);var e=t.customStyles;if(e&&Array.isArray(e))for(var i=0,n=e;i<n.length;i++){var r,o=n[i];!o||(r=o.name)&&"string"==typeof r&&(this._allStyles.hasOwnProperty(r)?this._allStyles[r].parse(o.style):this._allStyles[r]=new O(o.style))}}}e.ContainerStyleSet=D;var M=(B.parse=function(t,e){if(!t)return null;var i=new B;i._versionString=t;var n=/(\d+).(\d+)/gi.exec(t);return null!=n&&3==n.length?(i._major=parseInt(n[1]),i._minor=parseInt(n[2])):i._isValid=!1,!i._isValid&&e&&e.push({error:s.ValidationError.InvalidPropertyValue,message:"Invalid version string: "+i._versionString}),i},B.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},B.prototype.compareTo=function(t){if(!this.isValid||!t.isValid)throw new Error("Cannot compare invalid version.");return this.major>t.major?1:this.major<t.major?-1:this.minor>t.minor?1:this.minor<t.minor?-1:0},Object.defineProperty(B.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"major",{get:function(){return this._major},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"minor",{get:function(){return this._minor},enumerable:!0,configurable:!0}),Object.defineProperty(B.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,configurable:!0}),B);function B(t,e,i){void 0===t&&(t=1),void 0===e&&(e=1),this._isValid=!0,this._major=t,this._minor=e,this._label=i}e.Version=M;var L=(R.prototype.setCapability=function(t,e){this.capabilities||(this.capabilities={}),this.capabilities[t]=e},R.prototype.parse=function(t,e){if(t)for(var i in t){var n,r=t[i];"string"==typeof r&&("*"==r?this.setCapability(i,"*"):(n=M.parse(r,e)).isValid&&this.setCapability(i,n))}},R.prototype.hasCapability=function(t,e){return!(!this.capabilities||!this.capabilities.hasOwnProperty(t))&&("*"==e||"*"==this.capabilities[t]||e.compareTo(this.capabilities[t])<=0)},R.prototype.areAllMet=function(t){if(this.capabilities)for(var e in this.capabilities)if(!t.hasCapability(e,this.capabilities[e]))return!1;return!0},R);function R(){this.capabilities=null}e.HostCapabilities=L;var H=(j.prototype.parse=function(t){this.fontFamily=t.fontFamily||this.fontFamily,this.fontSizes={small:t.fontSizes&&t.fontSizes.small||this.fontSizes.small,default:t.fontSizes&&t.fontSizes.default||this.fontSizes.default,medium:t.fontSizes&&t.fontSizes.medium||this.fontSizes.medium,large:t.fontSizes&&t.fontSizes.large||this.fontSizes.large,extraLarge:t.fontSizes&&t.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:t.fontWeights&&t.fontWeights.lighter||this.fontWeights.lighter,default:t.fontWeights&&t.fontWeights.default||this.fontWeights.default,bolder:t.fontWeights&&t.fontWeights.bolder||this.fontWeights.bolder}},j.monospace=new j("'Courier New', Courier, monospace"),j);function j(t){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},t&&(this.fontFamily=t)}e.FontTypeDefinition=H;var J=(W.prototype.getStyleDefinition=function(t){switch(t){case s.FontType.Monospace:return this.monospace;case s.FontType.Default:default:return this.default}},W);function W(t){this.default=new H,this.monospace=new H("'Courier New', Courier, monospace"),t&&(this.default.parse(t.default),this.monospace.parse(t.monospace))}e.FontTypeSet=J;var U=(q.prototype.getFontTypeDefinition=function(t){return this.fontTypes?this.fontTypes.getStyleDefinition(t):t==s.FontType.Monospace?H.monospace:this._legacyFontType},q.prototype.getEffectiveSpacing=function(t){switch(t){case s.Spacing.Small:return this.spacing.small;case s.Spacing.Default:return this.spacing.default;case s.Spacing.Medium:return this.spacing.medium;case s.Spacing.Large:return this.spacing.large;case s.Spacing.ExtraLarge:return this.spacing.extraLarge;case s.Spacing.Padding:return this.spacing.padding;default:return 0}},q.prototype.paddingDefinitionToSpacingDefinition=function(t){return new a.SpacingDefinition(this.getEffectiveSpacing(t.top),this.getEffectiveSpacing(t.right),this.getEffectiveSpacing(t.bottom),this.getEffectiveSpacing(t.left))},q.prototype.makeCssClassNames=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=[],n=0,r=t;n<r.length;n++){var o=r[n];i.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return i},q.prototype.makeCssClassName=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.makeCssClassNames.apply(this,t).join(" ");return i||""},Object.defineProperty(q.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(t){this._legacyFontType.fontFamily=t},enumerable:!0,configurable:!0}),Object.defineProperty(q.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!0,configurable:!0}),Object.defineProperty(q.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!0,configurable:!0}),q);function q(t){this.hostCapabilities=new L,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.fontTypes=null,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new D,this.actions=new w,this.adaptiveCard=new d,this.imageSet=new g,this.media=new y,this.factSet=new E,this.cssClassNamePrefix=null,this.alwaysAllowBleed=!1,t&&(("string"==typeof t||t instanceof String)&&(t=JSON.parse(t)),this.choiceSetInputValueSeparator=t&&"string"==typeof t.choiceSetInputValueSeparator?t.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=t&&"boolean"==typeof t.supportsInteractivity?t.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new H,this._legacyFontType.parse(t),t.fontTypes&&(this.fontTypes=new J(t.fontTypes)),t.lineHeights&&(this.lineHeights={small:t.lineHeights.small,default:t.lineHeights.default,medium:t.lineHeights.medium,large:t.lineHeights.large,extraLarge:t.lineHeights.extraLarge}),this.imageSizes={small:t.imageSizes&&t.imageSizes.small||this.imageSizes.small,medium:t.imageSizes&&t.imageSizes.medium||this.imageSizes.medium,large:t.imageSizes&&t.imageSizes.large||this.imageSizes.large},this.containerStyles=new D(t.containerStyles),this.spacing={small:t.spacing&&t.spacing.small||this.spacing.small,default:t.spacing&&t.spacing.default||this.spacing.default,medium:t.spacing&&t.spacing.medium||this.spacing.medium,large:t.spacing&&t.spacing.large||this.spacing.large,extraLarge:t.spacing&&t.spacing.extraLarge||this.spacing.extraLarge,padding:t.spacing&&t.spacing.padding||this.spacing.padding},this.separator={lineThickness:t.separator&&t.separator.lineThickness||this.separator.lineThickness,lineColor:t.separator&&t.separator.lineColor||this.separator.lineColor},this.actions=new w(t.actions||this.actions),this.adaptiveCard=new d(t.adaptiveCard||this.adaptiveCard),this.imageSet=new g(t.imageSet),this.factSet=new E(t.factSet))}e.HostConfig=U},"./src/shared.ts":function(t,u,e){"use strict";Object.defineProperty(u,"__esModule",{value:!0});var o=e("./src/enums.ts");u.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var i=(n.prototype.getReferencedInputs=function(t,e){if(!e)throw new Error("The referencedInputs parameter cannot be null.");for(var i=0,n=t;i<n.length;i++){var r=n[i];null!=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original)&&(e[r.id]=r)}},n.prototype.substituteInputValues=function(t,e){this._processed=this._original;for(var i,n=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;null!=(i=n.exec(this._original));){for(var r,o=null,s=0,a=Object.keys(t);s<a.length;s++){var l=a[s];if(l.toLowerCase()==i[1].toLowerCase()){o=t[l];break}}o&&(r="",o.value&&(r=o.value),e===u.ContentTypes.applicationJson?r=(r=JSON.stringify(r)).slice(1,-1):e===u.ContentTypes.applicationXWwwFormUrlencoded&&(r=encodeURIComponent(r)),this._processed=this._processed.replace(i[0],r))}this._isProcessed=!0},n.prototype.getOriginal=function(){return this._original},n.prototype.get=function(){return this._isProcessed?this._processed:this._original},n.prototype.set=function(t){this._original=t,this._isProcessed=!1},n);function n(){this._isProcessed=!1,this._original=null,this._processed=null}u.StringWithSubstitutions=i;function r(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=t,this.right=e,this.bottom=i,this.left=n}u.SpacingDefinition=r;function s(t,e,i,n){void 0===t&&(t=o.Spacing.None),void 0===e&&(e=o.Spacing.None),void 0===i&&(i=o.Spacing.None),void 0===n&&(n=o.Spacing.None),this.top=o.Spacing.None,this.right=o.Spacing.None,this.bottom=o.Spacing.None,this.left=o.Spacing.None,this.top=t,this.right=e,this.bottom=i,this.left=n}u.PaddingDefinition=s;var a=(l.parse=function(t,e){void 0===e&&(e=!1);var i=new l(0,o.SizeUnit.Weight),n=/^([0-9]+)(px|\*)?$/g.exec(t),r=e?3:2;if(n&&n.length>=r)return i.physicalSize=parseInt(n[1]),3==n.length&&"px"==n[2]&&(i.unit=o.SizeUnit.Pixel),i;throw new Error("Invalid size: "+t)},l);function l(t,e){this.physicalSize=t,this.unit=e}u.SizeAndUnit=a;var p=(c.generate=function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return c.lut[255&t]+c.lut[t>>8&255]+c.lut[t>>16&255]+c.lut[t>>24&255]+"-"+c.lut[255&e]+c.lut[e>>8&255]+"-"+c.lut[e>>16&15|64]+c.lut[e>>24&255]+"-"+c.lut[63&i|128]+c.lut[i>>8&255]+"-"+c.lut[i>>16&255]+c.lut[i>>24&255]+c.lut[255&n]+c.lut[n>>8&255]+c.lut[n>>16&255]+c.lut[n>>24&255]},c.initialize=function(){for(var t=0;t<256;t++)c.lut[t]=(t<16?"0":"")+t.toString(16)},c.lut=[],c);function c(){}(u.UUID=p).initialize()},"./src/text-formatters.ts":function(t,e,i){"use strict";var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var o=(s.prototype.format=function(t,e){for(var i,n=e;null!=(i=this._regularExpression.exec(e));)n=n.replace(i[0],this.internalFormat(t,i));return n},s);function s(t){this._regularExpression=t}var a,l=(r(u,a=o),u.prototype.internalFormat=function(t,e){var i=new Date(Date.parse(e[1])),n=null!=e[2]?e[2].toLowerCase():"compact";return"compact"!=n?i.toLocaleDateString(t,{day:"numeric",weekday:n,month:n,year:"numeric"}):i.toLocaleDateString()},u);function u(){return null!==a&&a.apply(this,arguments)||this}var p,c=(r(h,p=o),h.prototype.internalFormat=function(t,e){return new Date(Date.parse(e[1])).toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"})},h);function h(){return null!==p&&p.apply(this,arguments)||this}e.formatText=function(t,e){for(var i=[new l(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new c(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)],n=e,r=0;r<i.length;r++)n=i[r].format(t,n);return n}},"./src/utils.ts":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("./src/enums.ts"),n=i("./src/shared.ts");function o(t){return null==t||""===t}function s(t,e,i){if(o(e))return i;for(var n in t){if(0<=parseInt(n,10)){var r=t[n];if(r&&"string"==typeof r&&r.toLowerCase()===e.toLowerCase())return parseInt(n,10)}}return i}function a(t,e,i,n){void 0===n&&(n=void 0),null==i||i===n?delete t[e]:t[e]=i}function l(t){var e=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(t);if(e&&e[4]){var i=parseInt(e[1],16)/255;return"rgba("+parseInt(e[2],16)+","+parseInt(e[3],16)+","+parseInt(e[4],16)+","+i+")"}return t}function h(t,e){for(e+=1;e<t.length&&"<"==t[e];)for(;e<t.length&&">"!=t[e++];);return e}e.generateUniqueId=function(){return"__ac-"+n.UUID.generate()},e.isNullOrEmpty=o,e.appendChild=function(t,e){null!=e&&null!=e&&t.appendChild(e)},e.getStringValue=function(t,e){return void 0===e&&(e=void 0),"string"==typeof t?t.toString():e},e.getNumberValue=function(t,e){return void 0===e&&(e=void 0),"number"==typeof t?t:e},e.getBoolValue=function(t,e){if("boolean"==typeof t)return t;if("string"==typeof t)switch(t.toLowerCase()){case"true":return!0;case"false":return!1;default:return e}return e},e.getEnumValue=s,e.setProperty=a,e.setNumberProperty=function(t,e,i,n){void 0===n&&(n=void 0),null==i||i===n||isNaN(i)?delete t[e]:t[e]=i},e.setEnumProperty=function(t,e,i,n,r){void 0===r&&(r=void 0);var o=e[i],s=null==o||void 0!==t[o];n==r||null==n?s&&delete e[i]:e[i]=t[n]},e.setArrayProperty=function(t,e,i){var n=[];if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];n.push(s.toJSON())}0==n.length?t.hasOwnProperty(e)&&Array.isArray(t[e])&&delete t[e]:a(t,e,n)},e.parseHostConfigEnum=function(t,e,i){return"string"==typeof e?s(t,e,i):"number"==typeof e?e:i},e.renderSeparation=function(t,e,i){if(0<e.spacing||0<e.lineThickness){var n=document.createElement("div");return n.className=t.makeCssClassName("ac-"+(i==r.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),i==r.Orientation.Horizontal?e.lineThickness?(n.style.paddingTop=e.spacing/2+"px",n.style.marginBottom=e.spacing/2+"px",n.style.borderBottom=e.lineThickness+"px solid "+l(e.lineColor)):n.style.height=e.spacing+"px":e.lineThickness?(n.style.paddingLeft=e.spacing/2+"px",n.style.marginRight=e.spacing/2+"px",n.style.borderRight=e.lineThickness+"px solid "+l(e.lineColor)):n.style.width=e.spacing+"px",n.style.overflow="hidden",n}return null},e.stringToCssColor=l,e.truncate=function(e,t,i){function n(){return-1<=t-e.scrollHeight}if(!n()){for(var r=e.innerHTML,o=function(t){e.innerHTML=r.substring(0,t)+"..."},s=function(t){var e=[],i=h(t,-1);for(;i<t.length;)" "==t[i]&&e.push(i),i=h(t,i);return e}(r),a=0,l=s.length,u=0;a<l;){var p=Math.floor((a+l)/2);o(s[p]),n()?(u=s[p],a=p+1):l=p}if(o(u),i&&t-e.scrollHeight>=i-1){for(var c=h(r,u);c<r.length&&(o(c),n());)c=h(r,u=c);o(u)}}},e.getFitStatus=function(t,e){var i=t.offsetTop;return i+t.clientHeight<=e?r.ContainerFitStatus.FullyInContainer:i<e?r.ContainerFitStatus.Overflowing:r.ContainerFitStatus.FullyOutOfContainer}}},r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="./src/adaptivecards.ts");function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var i,n});