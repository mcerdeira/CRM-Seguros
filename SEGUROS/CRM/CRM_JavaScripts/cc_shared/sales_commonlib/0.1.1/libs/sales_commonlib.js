var t=function(){function t(){}var e=t.prototype;return e.reportInfo=function(e){t.reportLog("SITraceBIEvent",e)},e.reportUserAction=function(e){t.reportLog("SITraceCIEvent",e)},e.reportWarning=function(e){t.reportLog("SITraceEvent",e,2)},e.reportError=function(e){t.reportLog("SITraceEvent",e,1)},t.reportLog=function(e,n,a){try{var o=n&&n.context&&n.context.reporting?n.context.reporting:Xrm&&Xrm.Reporting?Xrm.Reporting:null,i=Xrm&&Xrm.Utility&&Xrm.Utility.getGlobalContext();i&&i.getCurrentAppName&&i.getCurrentAppName().then((function(c){var s=new r(n.source,i&&i.organizationSettings&&i.organizationSettings.attributes&&i.organizationSettings.attributes.organizationId,n.area,e,c,n.action,n.actionOn,n.methodName,n.message,n.data,t.getCustomControlId(n),a);o&&o.reportEvent&&o.reportEvent(s)}))}catch(t){console.error(t)}},t.getCustomControlId=function(t){try{return t&&t.context&&t.context.client&&t.context.client._customControlProperties.manifest.CustomControlId}catch(t){return""}},e.getEventParams=function(t,e,r,n,a,o,i,c){return{area:e,context:t,methodName:r,source:n,action:i,actionOn:c,data:o,message:a}},t}(),e=function(t,e){this.name=t,this.value=e},r=function(){function t(t,e,r,n,a,o,i,c,s,m,d,u){this.eventParameters=[],this.eventName=n,t&&this.addEventParameter("Source",t),e&&this.addEventParameter("OrgId",e),r&&this.addEventParameter("Area",r),a&&this.addEventParameter("appName",a),o&&this.addEventParameter("Action",o),i&&this.addEventParameter("ActionOn",i),c&&this.addEventParameter("MethodName",c),s&&this.addEventParameter("Message",s),m&&this.addEventParameter("Data",this.SafeJsonStringify(m)),d&&this.addEventParameter("CustomControlId",d),u&&this.addEventParameter("Level",u)}var r=t.prototype;return r.addEventParameter=function(t,r){var n=new e(t,r);this.eventParameters.push(n)},r.SafeJsonStringify=function(t){try{return JSON.stringify(t)}catch(t){return console.error(t),""}},t}(),n=function(){function e(){}var r=e.prototype;return r.start=function(t,r,n){void 0===n&&(n=e.throttledForMs);var a=(performance||new Date).now(),o=e.trackedScenarios[t+"_"+r];if(o){if(a-o.startTime<n)return;e.trackedScenarios[t+"_"+r]={startTime:a}}else e.trackedScenarios[t+"_"+r]={startTime:a}},r.stop=function(r,n,a,o){void 0===o&&(o={scenario:n,timeTaken:0});var i=(performance||new Date).now(),c=e.trackedScenarios[r+"_"+n];c&&(o.scenario=n,o.timeTaken=i-c.startTime,(new t).reportInfo({context:a,area:r,methodName:"StopWatch.stop",source:"StopWatch",data:o})),e.trackedScenarios[r+"_"+n]=null},e}();n.trackedScenarios={},n.throttledForMs=18e4;var SalesCommon=function(){};SalesCommon.Telemetry=new t,SalesCommon.StopWatch=new n,exports.SalesCommon=SalesCommon;