var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),MscrmCommon;!function(MscrmCommon){var ErrorHandling;!function(ErrorHandling){"use strict";var ErrorCode=function(){function ErrorCode(){}return ErrorCode.ValueOutOfRangeId="CustomControl_OutOfRange_Error",ErrorCode.InvalidInputMaskId="CustomControl_InvalidInput_Error",ErrorCode.MaxLengthExceededId="CustomControl_MaxLengthExceeded_Error",ErrorCode}();ErrorHandling.ErrorCode=ErrorCode}(ErrorHandling=MscrmCommon.ErrorHandling||(MscrmCommon.ErrorHandling={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ErrorHandling;!function(ErrorHandling){"use strict";var NotificationHandler=function(){function NotificationHandler(setNotification,clearNotification){this.setNotification=setNotification,this.clearNotification=clearNotification,this.setNotification=setNotification,this.clearNotification=clearNotification}return NotificationHandler.prototype.notify=function(message,id){this.setNotification(message,id)},NotificationHandler.prototype.clear=function(id){this.clearNotification(id)},NotificationHandler}();ErrorHandling.NotificationHandler=NotificationHandler}(ErrorHandling=MscrmCommon.ErrorHandling||(MscrmCommon.ErrorHandling={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ErrorHandling;!function(ErrorHandling){"use strict";var ExceptionHandler=function(){function ExceptionHandler(){}return ExceptionHandler.throwException=function(message){throw message},ExceptionHandler}();ErrorHandling.ExceptionHandler=ExceptionHandler}(ErrorHandling=MscrmCommon.ErrorHandling||(MscrmCommon.ErrorHandling={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var ProgressIndicatorType;!function(ProgressIndicatorType){ProgressIndicatorType[ProgressIndicatorType.Bar=0]="Bar",ProgressIndicatorType[ProgressIndicatorType.Ring=1]="Ring"}(ProgressIndicatorType=MscrmCommon.ProgressIndicatorType||(MscrmCommon.ProgressIndicatorType={}))}(MscrmCommon||(MscrmCommon={}));var Mscrm;!function(Mscrm){"use strict";var AttributeSourceType;!function(AttributeSourceType){AttributeSourceType[AttributeSourceType.Unknown=-1]="Unknown",AttributeSourceType[AttributeSourceType.Persistent=0]="Persistent",AttributeSourceType[AttributeSourceType.Calculated=1]="Calculated",AttributeSourceType[AttributeSourceType.Rollup=2]="Rollup"}(AttributeSourceType=Mscrm.AttributeSourceType||(Mscrm.AttributeSourceType={}))}(Mscrm||(Mscrm={}));var Mscrm;!function(Mscrm){"use strict";var UpdateEventType;!function(UpdateEventType){UpdateEventType[UpdateEventType.DataSet=0]="DataSet",UpdateEventType[UpdateEventType.Layout=1]="Layout",UpdateEventType[UpdateEventType.Activation=2]="Activation",UpdateEventType[UpdateEventType.Theming=3]="Theming"}(UpdateEventType=Mscrm.UpdateEventType||(Mscrm.UpdateEventType={}));var UpdateEvents=function(){function UpdateEvents(){this.ignoredEvents={},this.ignoredEvents[Mscrm.UpdateEventType.DataSet]=!1,this.ignoredEvents[Mscrm.UpdateEventType.Layout]=!1,this.ignoredEvents[Mscrm.UpdateEventType.Activation]=!0,this.ignoredEvents[Mscrm.UpdateEventType.Theming]=!1}return UpdateEvents.getEventType=function(event){switch(event){case"dataset":return Mscrm.UpdateEventType.DataSet;case"layout":return Mscrm.UpdateEventType.Layout;case"activation":return Mscrm.UpdateEventType.Activation;case"theming":return Mscrm.UpdateEventType.Theming;default:return null}},UpdateEvents.getEventCode=function(event){switch(event){case Mscrm.UpdateEventType.DataSet:return"dataset";case Mscrm.UpdateEventType.Layout:return"layout";case Mscrm.UpdateEventType.Activation:return"activation";case Mscrm.UpdateEventType.Theming:return"theming";default:return null}},UpdateEvents.prototype.shouldIgnoreEvent=function(event,shouldIgnore){MscrmCommon.ControlUtils.Object.isNullOrUndefined(event)||(this.ignoredEvents[event]=shouldIgnore)},UpdateEvents.prototype.isIgnoredEvent=function(event){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(event)&&this.ignoredEvents[event]},UpdateEvents.hasEvent=function(updatedProperties,event){var eventCode=UpdateEvents.getEventCode(event);return new MscrmCommon.ArrayQuery(updatedProperties).contains(function(item){return item==eventCode})},UpdateEvents}();Mscrm.UpdateEvents=UpdateEvents}(Mscrm||(Mscrm={}));var MscrmCommon;!function(MscrmCommon){"use strict";var AttributeConstants=function(){function AttributeConstants(){}return AttributeConstants.Checked="checked",AttributeConstants.ReadOnly="readonly",AttributeConstants.Disabled="disabled",AttributeConstants.Style="style",AttributeConstants.Layout="layout",AttributeConstants}();MscrmCommon.AttributeConstants=AttributeConstants}(MscrmCommon||(MscrmCommon={}));var MscrmControls;!function(MscrmControls){var Common;!function(Common){"use strict";var ControlState;!function(ControlState){ControlState[ControlState.Disabled=0]="Disabled",ControlState[ControlState.Enabled=1]="Enabled"}(ControlState=Common.ControlState||(Common.ControlState={}))}(Common=MscrmControls.Common||(MscrmControls.Common={}))}(MscrmControls||(MscrmControls={}));var MscrmCommon;!function(MscrmCommon){"use strict";var CommonControl=function(){function CommonControl(){this.lastKeyPress=!0,this.isInitialized=!1,this.isEnabled=!1,this.shouldPreventMultipleEventTypes=!0,this.isInReadMode=!0,this.updateEvents=new Mscrm.UpdateEvents}return Object.defineProperty(CommonControl.prototype,"isControlInitialized",{get:function(){return this.isInitialized},set:function(value){},enumerable:!0,configurable:!0}),CommonControl.prototype.init=function(context,notifyOutputChanged,state,container){MscrmCommon.ControlUtils.Object.isNullOrUndefined(container)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.NullOrUndefinedInitContainer),MscrmCommon.ControlUtils.Object.isNullOrUndefined(notifyOutputChanged)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.NullOrUndefinedInitNotifyOutputChangedDelegate),this.isControlInitialized||(this.container=container,this.notifyOutputChanged=notifyOutputChanged,this.disablePanoramaScroll=context.utils.disablePanoramaScroll.bind(context.utils),this.initializeControl(context,state))},CommonControl.prototype.updateView=function(context){this.shouldIgnoreUpdate(context)||(this.throwIfPropertyBagNotValid(context),this.isInitialized||MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.UninitializedErrorMessage),this.handleEditToReadModeTransition(context),this.isEnabled=this.isControlEnabled(context),this.updateCore(context),context.mode.isRead||context.mode.isPreview?this.renderReadMode(context):this.renderEditMode(context))},CommonControl.prototype.getOutputs=function(){return this.isControlInitialized||MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.UninitializedControl),this.getOutputsCore()},CommonControl.prototype.onPreNavigation=function(){},CommonControl.prototype.destroy=function(){this.isControlInitialized&&(this.eventGuard.destroy(),this.destroyCore()),this.cleanup()},CommonControl.prototype.createWrapperContainer=function(className,isRtl){void 0===className&&(className=""),void 0===isRtl&&(isRtl=!1);var wrapperContainer=document.createElement("div");return wrapperContainer.className=MscrmCommon.CommonControl.ClassName,wrapperContainer.className+=""===className?"":" "+className,MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.container)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.CommonControl.NullOrUndefinedInitContainer),isRtl&&(wrapperContainer.className+=" "+MscrmCommon.CommonControl.ClassRtl),this.container.appendChild(wrapperContainer),wrapperContainer},CommonControl.prototype.initCore=function(context,state){MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(CommonControl.MethodNotOverridenFormat,"initCore"))},CommonControl.prototype.updateCore=function(context){MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(CommonControl.MethodNotOverridenFormat,"updateCore"))},CommonControl.prototype.destroyCore=function(){MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(CommonControl.MethodNotOverridenFormat,"destroyCore"))},CommonControl.prototype.renderReadMode=function(context){this.shouldNotifyOutputChanged=!1},CommonControl.prototype.renderEditMode=function(context){this.shouldNotifyOutputChanged=!1,this.isInReadMode&&(this.preventEditModePanoramaEvents&&(this.removePanoramaEventsHandlers(),this.addPanoramaEventsHandlers()),this.eventGuard.preventClicksUntilUserInteracted()),this.isInReadMode=!1},CommonControl.prototype.getOutputsCore=function(){return MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(CommonControl.MethodNotOverridenFormat,"getOutputsCore")),null},CommonControl.prototype.notifyEnabledControlOutputChanged=function(){this.isEnabled&&this.shouldNotifyOutputChanged&&this.notifyOutputChanged()},CommonControl.prototype.isControlEnabled=function(context){return!(context.mode.isRead||context.mode.isPreview||context.mode.isControlDisabled||context.page&&context.page.isPageReadOnly)},CommonControl.prototype.showDefaultLabelCore=function(context){return!1},CommonControl.prototype.toggleContainerVisibility=function(value){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.controlWrapperContainer)?value?$(this.container).show():$(this.container).hide():value?$(this.controlWrapperContainer).show():$(this.controlWrapperContainer).hide()},CommonControl.prototype.initializeControl=function(context,state){try{this.throwIfPropertyBagNotValid(context),this.notificationHandler=new MscrmCommon.ErrorHandling.NotificationHandler(context.utils.setNotification.bind(context.utils),context.utils.clearNotification.bind(context.utils)),this.htmlEncode=context.utils.crmHtmlEncode.bind(context.utils),this.eventGuard=new MscrmCommon.EventGuard(this.container,context.client.userAgent),this.initCore(context,state),this.shouldPreventMultipleEventTypes&&this.eventGuard.preventMultipleEventTypes(),this.isEnabled=this.isControlEnabled(context),this.isInitialized=!0}catch(e){if(this.container.hasChildNodes())for(var childCount=this.container.childNodes.length,i=childCount-1;i>=0;i--)this.container.removeChild(this.container.childNodes[i]);MscrmCommon.ErrorHandling.ExceptionHandler.throwException(e)}},CommonControl.prototype.shouldIgnoreUpdate=function(context){var shouldIgnore=!0;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(context)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.updatedProperties)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.updateEvents)||0==context.updatedProperties.length)return!1;for(var i=0;i<context.updatedProperties.length;i++){var eventType=Mscrm.UpdateEvents.getEventType(context.updatedProperties[i]);shouldIgnore=shouldIgnore&&this.updateEvents.isIgnoredEvent(eventType)}return shouldIgnore},CommonControl.prototype.throwIfPropertyBagNotValid=function(context){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(context)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.UninitializedDataBagMessage),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.parameters)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.parameters")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.setNotification)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.setNotification")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.clearNotification)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.clearNotification")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.openInBrowser)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.openInBrowser")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.getServiceUri)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.getServiceUri")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.mode)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.mode")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(!this.isControlEnabled(context))&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.mode.isControlDisabled")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.mode.isRead)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.mode.isRead")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.mode.isPreview)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.mode.isPreview")),MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.crmHtmlEncode))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.crmHtmlEncode")},CommonControl.prototype.cleanup=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.container)||(MscrmCommon.ThemingHelper.removeStyles(this.container),this.preventEditModePanoramaEvents&&this.removePanoramaEventsHandlers()),this.isInitialized=!1,this.notifyOutputChanged=null,$(this.container).empty(),this.container=null},CommonControl.prototype.handleEditToReadModeTransition=function(context){!this.isInReadMode&&context.mode.isRead&&(this.preventEditModePanoramaEvents&&this.removePanoramaEventsHandlers(),this.eventGuard.stopPreventingClicks(),this.isInReadMode=!0)},CommonControl.prototype.removePanoramaEventsHandlers=function(){$(this.container).off(CommonControl.PointerDownEventName),$(this.container).off(CommonControl.PointerMoveEventName),$(this.container).off(CommonControl.PointerUpEventName),$(this.container).off(CommonControl.TouchEndEventName)},CommonControl.prototype.addPanoramaEventsHandlers=function(){var _this=this;$(this.container).on(CommonControl.PointerDownEventName,function(event){_this.isEnabled&&(_this.disablePanoramaScroll(!0),event.stopPropagation())}),$(this.container).on(CommonControl.PointerMoveEventName,function(event){_this.isEnabled&&event.stopPropagation()}),$(this.container).on(CommonControl.PointerUpEventName,function(event){_this.isEnabled&&_this.disablePanoramaScroll(!1)}),$(this.container).on(CommonControl.TouchEndEventName,function(event){_this.isEnabled&&_this.disablePanoramaScroll(!1)})},CommonControl.prototype.bindFocusVisibility=function(focusElement,container){var _this=this;focusElement.on("focus",function(){_this.lastKeyPress&&container.addClass(CommonControl.accessibilityOutlineClassName)}),focusElement.on("focusout",function(){container.removeClass(CommonControl.accessibilityOutlineClassName)}),container.on("mousedown touchstart",function(){_this.lastKeyPress=!1,container.removeClass(CommonControl.accessibilityOutlineClassName)}),container.on("keydown",function(){_this.lastKeyPress=!0})},CommonControl.prototype.unbindFocusVisibility=function(focusElement,container){focusElement.off("focus"),focusElement.off("focusout"),container.off("mousedown"),container.off("touchstart"),container.off("keydown")},CommonControl.ClassName="mocaControls",CommonControl.ClassRtl="rtl",CommonControl.PointerDownEventName="pointerdown.CustomControl",CommonControl.PointerMoveEventName="pointermove.CustomControl",CommonControl.PointerUpEventName="pointerup.CustomControl",CommonControl.TouchEndEventName="touchend.CustomControl",CommonControl.DefaultValueLabel="---",CommonControl.NullOrUndefinedInitContainer="Null or undefined control container.",CommonControl.NullOrUndefinedInitValueContainer="Null or undefined control value container.",CommonControl.NullOrUndefinedInitNotifyOutputChangedDelegate="Null or undefined NotifyOutputChanged delegate.",CommonControl.UninitializedErrorMessage="init should be called before calling update.",CommonControl.UninitializedDataBagMessage="Null or undefined dataBag property.",CommonControl.InvalidDataBagKeyFormat="Expected key {0} in the input data bag.",CommonControl.UninitializedControl="Control is used uninitialized.",CommonControl.InvalidInputParamMinMax="Min and max values do not bound a valid interval.",CommonControl.InvalidInputParamStep="Step parameter should be greater than 0 and less than the interval bound by min and max.",CommonControl.InvalidInputParamValue="Value for the control is not within the desired interval.",CommonControl.NotGreaterThanZeroInputParamValue="Parameter {0} should be greater than zero.",CommonControl.InvalidInputParam="One or more of the input parameters are invalid: {0}",CommonControl.MethodNotOverridenFormat="Method {0} is not overridden in the specialized class.",CommonControl.MethodNotImplementedInControl="Method {0} is not implemented in the control.",CommonControl.accessibilityOutlineClassName="outline-for-accessibility",CommonControl}();MscrmCommon.CommonControl=CommonControl}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var FieldControlBase=function(_super){function FieldControlBase(){var _this=_super.call(this)||this;return _this.updateEvents.shouldIgnoreEvent(Mscrm.UpdateEventType.Layout,!0),_this.updateEvents.shouldIgnoreEvent(Mscrm.UpdateEventType.Activation,!0),_this}return __extends(FieldControlBase,_super),FieldControlBase}(MscrmCommon.CommonControl);MscrmCommon.FieldControlBase=FieldControlBase}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var EventConstants=function(){function EventConstants(){}return EventConstants.Change="change",EventConstants.Click="click",EventConstants.JQueryKnobConfigure="configure",EventConstants.JQuerySwipeLeft="swipeleft",EventConstants.JQuerySwipeRight="swiperight",EventConstants.KeyUp="keyup",EventConstants.KeyDown="keydown",EventConstants.MouseUp="mouseup",EventConstants.MouseDown="mousedown",EventConstants.MouseOver="mouseover",EventConstants.MouseMove="mousemove",EventConstants.MouseOut="mouseout",EventConstants.PointerDown="pointerdown",EventConstants.PointerMove="pointermove",EventConstants.PointerUp="pointerup",EventConstants.PointerOut="pointerout",EventConstants.MSPointerOver="MSPointerOver",EventConstants.MSPointerDown="MSPointerDown",EventConstants.MSPointerOut="MSPointerOut",EventConstants.MSPointerUp="MSPointerUp",EventConstants.MSPointerMove="MSPointerMove",EventConstants.TouchStart="touchstart",EventConstants.TouchMove="touchmove",EventConstants.TouchEnd="touchend",EventConstants.WijmoValueChangedEvent="valueChanged",EventConstants.WijmoIsDroppedDownChangedEvent="isDroppedDownChanged",EventConstants.WijmoSelectedIndexChangedEvent="selectedIndexChanged",EventConstants.VMouseMove="vmousemove",EventConstants.Focus="focus",EventConstants.FocusIn="focusin",EventConstants.FocusOut="focusout",EventConstants.FocusEvents="focusin focusout",EventConstants}();MscrmCommon.EventConstants=EventConstants}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var EventGuard=function(){function EventGuard(container,userAgent){this.container=container,this.userAgent=userAgent}return EventGuard.prototype.destroy=function(){this.stopPreventingClicks(),this.stopPreventingFocus(),this.stopPreventingMultipleEventTypes(),this.container=null,this.userAgent=null},EventGuard.prototype.preventClicksUntilUserInteracted=function(){var _this=this;null!=this.container&&null!=this.userAgent&&(this.stopPreventingClicks(),$(this.container).on(EventGuard.hasUserInteractedEventName,function(e){_this.userInteractedInEditMode=!0}),this.removeClickEventHandler=EventGuard.handleEditModeClickEvents(this.container,this))},EventGuard.prototype.stopPreventingClicks=function(){this.userInteractedInEditMode=!1,$(this.container).off(EventGuard.hasUserInteractedEventName),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.removeClickEventHandler)||this.removeClickEventHandler(),this.removeClickEventHandler=null},EventGuard.prototype.preventEditModeTransitionFocus=function(){var _this=this;if(null!=this.container&&null!=this.userAgent){this.stopPreventingFocus(),this.userInteractedInEditModeWithAnInputElement=!1;var inputElements=$(this.container).find("input");inputElements.each(function(index,element){element.setAttribute(MscrmCommon.AttributeConstants.ReadOnly,MscrmCommon.AttributeConstants.ReadOnly),_this.userAgent.isAndroid&&$(element).on(EventGuard.focusRemoveEvent,function(e){$(element).blur(),$(element).off(EventGuard.focusRemoveEvent)}),$(element).on(EventGuard.hasUserInteractedWithElementEventName,function(e){_this.stopPreventingFocusEvents(element)})})}},EventGuard.prototype.stopPreventingFocus=function(){var _this=this;if(!this.userInteractedInEditModeWithAnInputElement){var inputElements=$(this.container).find("input");inputElements.each(function(index,element){_this.stopPreventingFocusEvents(element)})}},EventGuard.prototype.preventMultipleEventTypes=function(){var _this=this;if(null!=this.container&&null!=this.userAgent){var resetMultipleEventTypeFlags=function(e){_this.shouldPreventMouseEvents=!1,_this.shouldPreventTouchEvents=!1},removeTouchEventHandlers=EventGuard.preventTouchEventsAfterMouseDown(this.container,this),removeMouseEventHandlers=EventGuard.preventMouseEventsAfterTouchStart(this.container,this);this.container.addEventListener(MscrmCommon.EventConstants.Click,resetMultipleEventTypeFlags,!0);var removalCallback=function(){removeTouchEventHandlers(),removeMouseEventHandlers(),_this.container.removeEventListener(MscrmCommon.EventConstants.Click,resetMultipleEventTypeFlags,!0)};this.removeMultipleEventHandlers=removalCallback}},EventGuard.prototype.stopPreventingMultipleEventTypes=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.removeMultipleEventHandlers)||this.removeMultipleEventHandlers(),this.removeMultipleEventHandlers=null},EventGuard.prototype.stopPreventingFocusEvents=function(element){element.removeAttribute(MscrmCommon.AttributeConstants.ReadOnly),this.userAgent.isAndroid&&$(element).off(EventGuard.focusRemoveEvent),$(element).off(EventGuard.hasUserInteractedWithElementEventName),this.userInteractedInEditModeWithAnInputElement=!0},EventGuard.handleEditModeClickEvents=function(element,eventGuard){var preventFirstClick=function(e){eventGuard.userInteractedInEditMode||(e.stopPropagation(),eventGuard.userInteractedInEditMode=!0,$(element).trigger(MscrmCommon.EventConstants.Click)),eventGuard.userInteractedInEditMode=!0};return element.addEventListener(MscrmCommon.EventConstants.Click,preventFirstClick,!0),function(){element.removeEventListener(MscrmCommon.EventConstants.Click,preventFirstClick,!0)}},EventGuard.preventTouchEventsAfterMouseDown=function(element,eventGuard){var onTouchStart=function(e){eventGuard.shouldPreventTouchEvents?e.stopImmediatePropagation():eventGuard.shouldPreventMouseEvents=!0},preventTouchEventsIfRequired=function(e){eventGuard.shouldPreventTouchEvents&&e.stopImmediatePropagation()};return element.addEventListener(MscrmCommon.EventConstants.TouchStart,onTouchStart,!0),element.addEventListener(MscrmCommon.EventConstants.TouchMove,preventTouchEventsIfRequired,!0),element.addEventListener(MscrmCommon.EventConstants.TouchEnd,preventTouchEventsIfRequired,!0),function(){element.removeEventListener(MscrmCommon.EventConstants.TouchStart,onTouchStart,!0),element.removeEventListener(MscrmCommon.EventConstants.TouchMove,preventTouchEventsIfRequired,!0),element.removeEventListener(MscrmCommon.EventConstants.TouchEnd,preventTouchEventsIfRequired,!0)}},EventGuard.preventMouseEventsAfterTouchStart=function(element,eventGuard){var onMouseDown=function(e){eventGuard.shouldPreventMouseEvents?e.stopImmediatePropagation():eventGuard.shouldPreventTouchEvents=!0},preventMouseEventsIfRequired=function(e){eventGuard.shouldPreventMouseEvents&&e.stopImmediatePropagation()};return element.addEventListener(MscrmCommon.EventConstants.MouseDown,onMouseDown,!0),element.addEventListener(MscrmCommon.EventConstants.MouseMove,preventMouseEventsIfRequired,!0),element.addEventListener(MscrmCommon.EventConstants.MouseUp,preventMouseEventsIfRequired,!0),function(){element.removeEventListener(MscrmCommon.EventConstants.MouseDown,onMouseDown,!0),element.removeEventListener(MscrmCommon.EventConstants.MouseMove,preventMouseEventsIfRequired,!0),element.removeEventListener(MscrmCommon.EventConstants.MouseUp,preventMouseEventsIfRequired,!0)}},EventGuard.focusRemoveEvent="focus.RemoveFocus",EventGuard.hasUserInteractedEventName="pointerdown.UserInteracted",EventGuard.hasUserInteractedWithElementEventName="pointerdown.UserInteractedElement",EventGuard}();MscrmCommon.EventGuard=EventGuard}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var MethodConstants=function(){function MethodConstants(){}return MethodConstants.Destroy="destroy",MethodConstants.Refresh="refresh",MethodConstants.Value="value",MethodConstants.Option="option",MethodConstants.Disable="disable",MethodConstants.Enable="enable",MethodConstants}();MscrmCommon.MethodConstants=MethodConstants}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var ControlGuidGenerator=function(){function ControlGuidGenerator(){}return ControlGuidGenerator.newGuid=function(controlName){return controlName+"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0,v="x"==c?r:3&r|8;return v.toString(16)})},ControlGuidGenerator}();ControlUtils.ControlGuidGenerator=ControlGuidGenerator}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var Enum=function(){function Enum(){}return Enum.getFromString=function(enumArray,stringValue){for(var i in enumArray)if(enumArray[i]==stringValue)return parseInt(i);return-1},Enum}();ControlUtils.Enum=Enum}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var Event=function(){function Event(){}return Event.createName=function(eventName,eventNamespace){return ControlUtils.String.Format("{0}.{1}",eventName,eventNamespace)},Event}();ControlUtils.Event=Event}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var HitTarget=function(){function HitTarget(){}return HitTarget.exists=function(container,hitTargetClassSelector){return container.find(hitTargetClassSelector).length>0},HitTarget.create=function(container,controlDomElement,hitTargetClass,trackElementClassSelector,paddingLeftPx,min,max,setControlValue){min>max&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException("Expected max to be bigger then min"),controlDomElement.wrap('<div class="'+hitTargetClass+'"/>');var controlNumericRange=max-min,hitTargetElement=container.find("."+hitTargetClass),setValue=function(event){var offset=container.find(trackElementClassSelector).offset(),width=controlDomElement.width(),height=controlDomElement.height(),isClickOutsideControlHeight=event.pageY<offset.top||event.pageY>offset.top+height;if(isClickOutsideControlHeight){var isClickInsideContainer=$(event.target).hasClass(controlDomElement[0].className)||$(event.target).hasClass(hitTargetClass);if(isClickInsideContainer){var xAxisDisplacementPercent=Math.abs(event.pageX+paddingLeftPx-offset.left)/width;if(1>=xAxisDisplacementPercent){var newValue=ControlUtils.NumericInterval.trunc(min+controlNumericRange*xAxisDisplacementPercent);setControlValue(newValue)}event.type===MscrmCommon.EventConstants.PointerDown?($(document).on(HitTarget.mouseUpHitTargetEventName,function(e){HitTarget.removeHitTargetSubsequentEvents(hitTargetElement)}),hitTargetElement.on(HitTarget.subsequentEvents,setValue)):event.type===MscrmCommon.EventConstants.PointerUp&&HitTarget.removeHitTargetSubsequentEvents(hitTargetElement)}}};hitTargetElement.on(HitTarget.initialEvents,setValue),hitTargetElement.on(MscrmCommon.EventConstants.TouchEnd,function(event){HitTarget.removeHitTargetSubsequentEvents(hitTargetElement)})},HitTarget.removeHitTargetSubsequentEvents=function(hitTargetElement){$(document).off(HitTarget.mouseUpHitTargetEventName),hitTargetElement.off(HitTarget.subsequentEvents)},HitTarget.initialEvents="click pointerdown",HitTarget.subsequentEvents="pointermove pointerup",HitTarget.mouseUpHitTargetEventName="mouseup.HitTarget",HitTarget}();ControlUtils.HitTarget=HitTarget}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var NumericInterval=function(){function NumericInterval(){}return NumericInterval.provideDefaultValuesIfNullDataBagParameters=function(context,hasStep){void 0===hasStep&&(hasStep=!0),hasStep&&ControlUtils.Object.isNullOrUndefined(context.parameters.step)&&(context.parameters.step={raw:0}),ControlUtils.Object.isNullOrUndefined(context.parameters.min)&&(context.parameters.min={raw:0}),ControlUtils.Object.isNullOrUndefined(context.parameters.max)&&(context.parameters.max={raw:0})},NumericInterval.throwIfNullDataBagParameters=function(context,hasStep){void 0===hasStep&&(hasStep=!0),ControlUtils.Object.isNullOrUndefined(context.parameters.value)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value")),ControlUtils.Object.isNullOrUndefined(context.parameters.value.attributes.MinValue)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes.MinValue")),ControlUtils.Object.isNullOrUndefined(context.parameters.value.attributes.MaxValue)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes.MaxValue")),hasStep&&ControlUtils.Object.isNullOrUndefined(context.parameters.step)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"step")),ControlUtils.Object.isNullOrUndefined(context.parameters.min)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"min")),ControlUtils.Object.isNullOrUndefined(context.parameters.max)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"max"));
},NumericInterval.processPropertyBagValues=function(context,notificationHandler,roundValues){void 0===roundValues&&(roundValues=!0),ControlUtils.Object.isNullOrUndefined(context.parameters)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException("Expected context.parameters object");var min=context.parameters.min,max=context.parameters.max,value=context.parameters.value,step=context.parameters.step,hasStep=!ControlUtils.Object.isNullOrUndefined(step);if(ControlUtils.Object.isNullOrUndefined(notificationHandler)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException("Expected notificationHandler object"),notificationHandler.clear(MscrmCommon.ErrorHandling.ErrorCode.ValueOutOfRangeId),ControlUtils.Object.isNullOrUndefined(min.raw)&&(min.raw=context.parameters.value.attributes.MinValue),ControlUtils.Object.isNullOrUndefined(max.raw)&&(max.raw=context.parameters.value.attributes.MaxValue),max.raw<min.raw){var swap=max.raw;max.raw=min.raw,min.raw=swap}if((ControlUtils.Object.isNullOrUndefined(value.raw)||1==value.error)&&(value.raw=min.raw),hasStep&&ControlUtils.Object.isNullOrUndefined(step.raw)&&(step.raw=NumericInterval.StepDefaultValue),roundValues&&(min.raw=Math.round(min.raw),max.raw=Math.round(max.raw),value.raw=Math.round(value.raw),hasStep&&(step.raw=Math.round(step.raw))),hasStep&&(step.raw>max.raw-min.raw||step.raw<=0||value.raw%step.raw!==0)&&(step.raw=NumericInterval.StepDefaultValue),value.raw<min.raw||value.raw>max.raw){var messageFormat=context.resources.getString(MscrmCommon.ErrorHandling.ErrorCode.ValueOutOfRangeId),message=ControlUtils.String.Format(messageFormat,min.raw,max.raw);notificationHandler.notify(message,MscrmCommon.ErrorHandling.ErrorCode.ValueOutOfRangeId)}},NumericInterval.createOptionalNumberPropery=function(value){return{raw:value,type:"Optional",error:null,attributes:null,errorMessage:null}},NumericInterval.moveValueToMultipleOfStep=function(value,context){if(Math.abs(value-context.parameters.min.raw)%context.parameters.step.raw!==0&&value!==context.parameters.max.raw){var stepsAfterMinimum=Math.floor(Math.abs(value-context.parameters.min.raw)/context.parameters.step.raw);isNaN(stepsAfterMinimum)&&(stepsAfterMinimum=0),value=context.parameters.min.raw+stepsAfterMinimum*context.parameters.step.raw,value>context.parameters.max.raw&&(value=context.parameters.max.raw)}return value},NumericInterval.getFormattedValue=function(value){var formattedValue=value.formatted;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(formattedValue)||MscrmCommon.ControlUtils.String.isNullOrWhitespace(formattedValue)){var rawValue=value.raw;formattedValue=MscrmCommon.ControlUtils.Object.isNullOrUndefined(rawValue)?MscrmCommon.ControlUtils.String.Empty:rawValue.toString()}return formattedValue},NumericInterval.isPercent=function(formattedValue){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(formattedValue)&&formattedValue.indexOf("%")>-1},NumericInterval.setValueContainer=function(container,value){var jqueryContainer=$(container);jqueryContainer.show(),jqueryContainer.text(value)},NumericInterval.getPrecision=function(property){return property.attributes.Precision},NumericInterval.isNumber=function(value){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&"number"==typeof value},NumericInterval.trunc=function(x){return 0>x?Math.ceil(x):Math.floor(x)},NumericInterval.isNumeric=function(value){return!isNaN(value)&&isFinite(value)},NumericInterval.StepDefaultValue=1,NumericInterval}();ControlUtils.NumericInterval=NumericInterval}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var WijmoGlobalization=function(){function WijmoGlobalization(){}return WijmoGlobalization.setCrmNumberFormatting=function(crmFormatting){WijmoGlobalization.formatting=crmFormatting,WijmoGlobalization.wijmoFormatNumber||(WijmoGlobalization.wijmoFormatNumber=wijmo.Globalize.formatNumber,wijmo.Globalize.formatNumber=WijmoGlobalization.formatNumber)},WijmoGlobalization.formatNumber=function(value,format,trim){var matches=format.match(/\d+/),prec=matches?parseInt(matches[0]):null;switch(format[0]){case"N":return WijmoGlobalization.formatting.formatDecimal(value,prec);case"C":return WijmoGlobalization.formatting.formatCurrency(value,prec);default:return WijmoGlobalization.wijmoFormatNumber(value,format,trim)}},WijmoGlobalization.getFormat=function(context){var numberFormattingInfo=context.client.numberFormattingInfo,formattedValue=MscrmCommon.ControlUtils.NumericInterval.getFormattedValue(context.parameters.value),crmNumberType=context.parameters.value.attributes.Type,isPercent=MscrmCommon.ControlUtils.NumericInterval.isPercent(formattedValue),overriddenPrecision=MscrmCommon.ControlUtils.NumericInterval.getPrecision(context.parameters.value);WijmoGlobalization.setWijmoNumberFormatStructure(numberFormattingInfo,crmNumberType,isPercent,overriddenPrecision);var valueFormat=MscrmCommon.Globalization.WijmoNumberFormatFactory.getNumberFormatString(numberFormattingInfo,crmNumberType,isPercent,overriddenPrecision);return valueFormat},WijmoGlobalization.getFormattedValue=function(value,format){return wijmo.Globalize.format(value,format)},WijmoGlobalization.setWijmoNumberFormatStructure=function(crmNumberFormat,numberType,isPercent,overriddenPrecision){var wijmoNumberFormat=MscrmCommon.Globalization.WijmoNumberFormatFactory.getWijmoNumberFormatStructure(crmNumberFormat,numberType,isPercent,overriddenPrecision);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(wijmo.culture)?void(wijmo.culture={Globalize:{numberFormat:wijmoNumberFormat}}):void(wijmo.culture.Globalize.numberFormat=wijmoNumberFormat)},WijmoGlobalization}();ControlUtils.WijmoGlobalization=WijmoGlobalization}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var Object=function(){function Object(){}return Object.isNullOrUndefined=function(object){return"undefined"==typeof object||null==object},Object}();ControlUtils.Object=Object}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var Property=function(){function Property(){}return Property.isNullOrEmpty=function(property){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(property)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(property.raw)||MscrmCommon.ControlUtils.String.isNullOrEmpty(property.raw)},Property}();ControlUtils.Property=Property}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var ControlUtils;!function(ControlUtils){"use strict";var String=function(){function String(){}return String.isNullOrEmpty=function(s){return null==s||0===s.length},String.isNullOrWhitespace=function(s){return null==s||0===s.trim().length},String.isNullUndefinedOrWhitespace=function(s){return null==s||void 0==s||0===s.trim().length},String.Format=function(format){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];for(var returnValue=format,i=1;i<arguments.length;i++){var actualValue="undefined"==typeof arguments[i]||null==arguments[i]?"":arguments[i].toString();returnValue=returnValue.replace(new RegExp("\\{"+(i-1)+"\\}","g"),actualValue)}return returnValue},String.EqualsIgnoreCase=function(string1,string2){var isString1Null=null==string1,isString2Null=null==string2,isString1Undefined=void 0==string1,isString2Undefined=void 0==string2;return!!(isString1Null&&isString2Null||isString1Undefined&&isString2Undefined)||isString1Null==isString2Null&&isString1Undefined==isString2Undefined&&string1.toUpperCase()===string2.toUpperCase()},String.ReplaceLineBreaksWithBrTags=function(text){return text.replace(/(?:\r\n|&#13;&#10;|\r|&#13;|\n|&#10;)/g,"<br />")},String.Empty="",String}();ControlUtils.String=String}(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var SizeMode;!function(SizeMode){SizeMode[SizeMode.Fullmode=0]="Fullmode",SizeMode[SizeMode.Sbreakpoint=1]="Sbreakpoint",SizeMode[SizeMode.Mbreakpoint=2]="Mbreakpoint"}(SizeMode||(SizeMode={}));var CellScope;!function(CellScope){CellScope[CellScope.Header=0]="Header",CellScope[CellScope.EditForm=1]="EditForm",CellScope[CellScope.Footer=2]="Footer"}(CellScope||(CellScope={}));var ThemingHelper=function(){function ThemingHelper(){}return ThemingHelper.injectStyle=function(container,css){MscrmCommon.ControlUtils.Object.isNullOrUndefined(container)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidContainerMessage),MscrmCommon.ControlUtils.Object.isNullOrUndefined(css)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssMessage);var styleElements=container.getElementsByTagName("style"),styleTag=null;0===styleElements.length?(styleTag=document.createElement("style"),container.appendChild(styleTag)):styleTag=styleElements.item(0),styleTag.innerHTML=css},ThemingHelper.removeStyles=function(container){MscrmCommon.ControlUtils.Object.isNullOrUndefined(container)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidContainerMessage);for(var styles=container.getElementsByTagName("style"),stylesCount=styles.length,i=stylesCount-1;i>=0;i--)container.removeChild(styles.item(i))},ThemingHelper.getProcessNonSelectedColor=function(theming){return"#6F6F6F"},ThemingHelper.getGlobalLinkColor=function(theming){return ThemingHelper.validateCssColor(theming.colors.globallink)},ThemingHelper.getHoverLinkColor=function(theming){var hoverlinkeffectcolor=theming.hoverlinkeffect;return MscrmCommon.ControlUtils.Object.isNullOrUndefined(theming.colors)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(theming.colors.hoverlinkeffect)||(hoverlinkeffectcolor=theming.colors.hoverlinkeffect),ThemingHelper.validateCssColor(hoverlinkeffectcolor)},ThemingHelper.getProcessControlColor=function(theming){return ThemingHelper.validateCssColor(theming.colors.processcontrol)},ThemingHelper.getShadeControlColor=function(theming){return ThemingHelper.validateCssColor(theming.colors.controlshade)},ThemingHelper.getFontFamily=function(theming){return ThemingHelper.validateCssFontFamily(theming.normalfontfamily)},ThemingHelper.getFontColor=function(theming){return ThemingHelper.validateCssColor(theming.normalfontcolor)},ThemingHelper.getFontSize=function(theming){return ThemingHelper.validateCssSize(theming.normalfontsize)},ThemingHelper.validateCssColor=function(value){MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage);var hexMatch=value.match(/^#[0-9a-fA-F]{6}$/),rgbMatch=value.match(/^rgb\(\d{1,3}%?, ?\d{1,3}%?, ?\d{1,3}%?\)$/),rgbaMatch=value.match(/^rgba\(\d{1,3}%?, ?\d{1,3}%?, ?\d{1,3}%?, ?[0-1]?.[0-9]\)$/),hslMatch=value.match(/^hsl\(\d{1,3}, ?\d{1,3}%, ?\d{1,3}%\)$/),hslaMatch=value.match(/^hsla\(\d{1,3}, ?\d{1,3}%, ?\d{1,3}%, ?[0-1]?.[0-9]\)$/),nameMatch=value.match(/^[a-zA-Z]+$/);return hexMatch&&1===hexMatch.length||rgbMatch&&1===rgbMatch.length||rgbaMatch&&1===rgbaMatch.length||hslMatch&&1===hslMatch.length||hslaMatch&&1===hslaMatch.length||nameMatch&&1===nameMatch.length?value:void MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage)},ThemingHelper.validateCssFontFamily=function(value){MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage);var fontMatch=value.match(/^[a-zA-Z\-\"\', ]+$/);return fontMatch&&1===fontMatch.length||MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage),value},ThemingHelper.validateCssSize=function(value){MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage);var sizeMatch=value.match(/^\d+[%a-z]+$/);return sizeMatch&&1===sizeMatch.length||MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage),value},ThemingHelper.isHeaderCell=function(scope){return scope&&scope.raw===CellScope.Header},ThemingHelper.getEditModeStyle=function(theming,scope,deviceSizeMode,error){var colors=theming.colors,measures=theming.measures,fontsizes=theming.fontsizes,solidborderstyle=theming.solidborderstyle,textbox=theming.textbox,borderWidth=error?textbox.errorlinethickness:textbox.linethickness;return{width:"100%",boxSizing:"border-box",lineHeight:textbox.lineheight,fontWeight:textbox.fontweight,fontSize:ThemingHelper.isHeaderCell(scope)?fontsizes.font125:fontsizes.font100,color:error?textbox.redcolor:textbox.contentcolor,marginLeft:this.getMarginLeftFromDeviceSizeMode(measures,deviceSizeMode),paddingLeft:textbox.horizontalpadding,paddingRight:textbox.horizontalpadding,paddingTop:textbox.verticalpadding,paddingBottom:textbox.verticalpadding,backgroundColor:error?textbox.errorbackgroundcolor:textbox.backgroundcolor,borderColor:error?textbox.redcolor:colors.grays.gray05,borderStyle:solidborderstyle,borderLeftWidth:borderWidth,borderRightWidth:borderWidth,borderBottomWidth:borderWidth,borderTopWidth:borderWidth}},ThemingHelper.getReadModeStyle=function(theming,scope,deviceSizeMode,error,isControlDisabled){var measures=theming.measures,fontsizes=theming.fontsizes,solidborderstyle=theming.solidborderstyle,textbox=theming.textbox,isHeader=ThemingHelper.isHeaderCell(scope),readModeStyle={width:"100%",lineHeight:textbox.lineheight,fontWeight:isHeader?textbox.fontweight:textbox.contentfontweight,fontSize:isHeader?fontsizes.font125:fontsizes.font100,color:error?textbox.redcolor:textbox.contentcolor,marginLeft:ThemingHelper.getMarginLeftFromDeviceSizeMode(measures,deviceSizeMode),borderColor:textbox.restmodecolor,borderStyle:solidborderstyle,borderWidth:textbox.linethickness,paddingLeft:textbox.horizontalpadding,paddingRight:textbox.horizontalpadding,paddingTop:textbox.verticalpadding,paddingBottom:textbox.verticalpadding};return isControlDisabled?Object.assign(readModeStyle,ThemingHelper.getDisableStyle(theming)):readModeStyle},ThemingHelper.getDisableStyle=function(theming){return{borderWidth:theming.textbox.linethickness,borderStyle:theming.solidborderstyle,borderColor:"transparent",color:theming.colors.basecolor.grey.grey7,backgroundColor:theming.textbox.backgroundcolor,opacity:1,"-webkit-text-fill-color":this.getHighContrastEnabled()?"":theming.colors.basecolor.grey.grey7,cursor:"default",fontSize:theming.fontsizes.font100,fontFamily:theming.fontfamilies.regular,textDecoration:"none",":hover":{backgroundColor:theming.colors.basecolor.grey.grey2,borderColor:theming.colors.basecolor.grey.grey2}}},ThemingHelper.convertHexColorToRGBA=function(hex,opacity){var c;c=hex.substring(1).split(""),3===c.length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]);var hexString="0x"+c.join("");return"rgba("+[hexString>>16&255,hexString>>8&255,255&hexString].join(",")+","+opacity+")"},ThemingHelper.getMarginLeftFromDeviceSizeMode=function(measures,deviceSizeMode){return deviceSizeMode&&deviceSizeMode.raw&&(deviceSizeMode.raw===SizeMode.Mbreakpoint||deviceSizeMode.raw===SizeMode.Sbreakpoint)?"-"+measures.measure050:void 0},ThemingHelper.getHighContrastEnabled=function(){var isHighContrastEnabled=!1,highContrastMediaFeatue="(-ms-high-contrast: active)",mediaQuery=window.matchMedia(highContrastMediaFeatue);if(mediaQuery.matches)return!0;var htmlTag=document.getElementsByTagName("html");return isHighContrastEnabled=null!=htmlTag[0].getAttribute("hc")},ThemingHelper.InvalidContainerMessage="The supplied container is null or undefined.",ThemingHelper.InvalidCssMessage="The supplied CSS is null or undefined.",ThemingHelper.InvalidCssValueMessage="The supplied CSS value is not valid.",ThemingHelper.ReadModeClassName="readmode",ThemingHelper.EditModeClassName="editmode",ThemingHelper}();MscrmCommon.ThemingHelper=ThemingHelper}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var FullscreenHelper=function(){function FullscreenHelper(){}return Object.defineProperty(FullscreenHelper,"supportsFullscreenApi",{get:function(){var apiTarget=document;return apiTarget.fullscreenEnabled||apiTarget.webkitFullscreenEnabled||apiTarget.mozFullScreenEnabled||apiTarget.msFullscreenEnabled},set:function(value){},enumerable:!0,configurable:!0}),Object.defineProperty(FullscreenHelper,"fullscreenElement",{get:function(){var apiTarget=document;return apiTarget.fullscreenElement||apiTarget.webkitFullscreenElement||apiTarget.mozFullScreenElement||apiTarget.msFullscreenElement},set:function(value){},enumerable:!0,configurable:!0}),FullscreenHelper.requestFullscreen=function(fullscreenTarget){fullscreenTarget.requestFullscreen?fullscreenTarget.requestFullscreen():fullscreenTarget.webkitRequestFullscreen?fullscreenTarget.webkitRequestFullscreen():fullscreenTarget.mozRequestFullScreen?fullscreenTarget.mozRequestFullScreen():fullscreenTarget.msRequestFullscreen&&fullscreenTarget.msRequestFullscreen()},FullscreenHelper.requestFullscreenUsingStyling=function(fullscreenTarget){$(fullscreenTarget).css("width","100vw"),$(fullscreenTarget).css("height","100vh"),$(fullscreenTarget).css("overflow","visible !important"),$(fullscreenTarget).css("position","fixed !important"),$(fullscreenTarget).css("top","0px"),$(fullscreenTarget).css("left","0px"),$(fullscreenTarget).css("background-color","#000000")},FullscreenHelper.exitFullscreen=function(){var apiTarget=document;apiTarget.exitFullscreen?apiTarget.exitFullscreen():apiTarget.webkitExitFullscreen?apiTarget.webkitExitFullscreen():apiTarget.mozCancelFullScreen?apiTarget.mozCancelFullScreen():apiTarget.msExitFullscreen&&apiTarget.msExitFullscreen()},FullscreenHelper.exitFullscreenUsingStyling=function(fullscreenTarget){$(fullscreenTarget).css("width",""),$(fullscreenTarget).css("height",""),$(fullscreenTarget).css("overflow",""),$(fullscreenTarget).css("position",""),$(fullscreenTarget).css("top",""),$(fullscreenTarget).css("left",""),$(fullscreenTarget).css("background-color","")},FullscreenHelper}();MscrmCommon.FullscreenHelper=FullscreenHelper}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var DataSetColumnSortStatus=function(){function DataSetColumnSortStatus(){}return DataSetColumnSortStatus}();MscrmCommon.DataSetColumnSortStatus=DataSetColumnSortStatus}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var ConditionExpression=function(){function ConditionExpression(){}return ConditionExpression}();MscrmCommon.ConditionExpression=ConditionExpression}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var FilterExpression=function(){function FilterExpression(){}return FilterExpression}();MscrmCommon.FilterExpression=FilterExpression}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var PrimitiveValue=function(){function PrimitiveValue(value,dataType){this.value=value,this.dataType=dataType}return PrimitiveValue}();MscrmCommon.PrimitiveValue=PrimitiveValue}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var Globalization;!function(Globalization){"use strict";var CrmNumberType=function(){function CrmNumberType(){}return CrmNumberType.CrmDecimalTypeName="decimal",CrmNumberType.CrmDoubleTypeName="double",CrmNumberType.CrmIntegerTypeName="integer",CrmNumberType.CrmMoneyTypeName="money",CrmNumberType}();Globalization.CrmNumberType=CrmNumberType}(Globalization=MscrmCommon.Globalization||(MscrmCommon.Globalization={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var Globalization;!function(Globalization){"use strict";var ExceptionHandler=MscrmCommon.ErrorHandling.ExceptionHandler,NumberPatternFactory=function(){function NumberPatternFactory(){this.currencyPositivePatternArray=["$n","n$","$ n","n $"],this.currencyNegativePatternArray=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"],this.percentPositivePatternArray=["n %","n%","%n","% n"],this.percentNegativePatternArray=["-n %","-n%","-%n","%-n","%n-","n-%","n%-","-% n","n %-","% n-","% -n","n- %"]}return NumberPatternFactory.prototype.getCurrencyPositivePattern=function(patternValue){return this.getPattern(this.currencyPositivePatternArray,patternValue)},NumberPatternFactory.prototype.getCurrencyNegativePattern=function(patternValue){return this.getPattern(this.currencyNegativePatternArray,patternValue)},NumberPatternFactory.prototype.getPercentPositivePattern=function(patternValue){return this.getPattern(this.percentPositivePatternArray,patternValue)},NumberPatternFactory.prototype.getPercentNegativePattern=function(patternValue){return this.getPattern(this.percentNegativePatternArray,patternValue)},NumberPatternFactory.prototype.getPattern=function(patternArray,patternValue){return(0>patternValue||patternValue>=patternArray.length)&&ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(NumberPatternFactory.NoSuchPatternError,patternValue)),patternArray[patternValue]},NumberPatternFactory.NoSuchPatternError="The number formatting pattern value that you specified does not exist: {0}.",NumberPatternFactory}();Globalization.NumberPatternFactory=NumberPatternFactory}(Globalization=MscrmCommon.Globalization||(MscrmCommon.Globalization={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){var Globalization;!function(Globalization){"use strict";var WijmoNumberFormatFactory=function(){function WijmoNumberFormatFactory(){}return WijmoNumberFormatFactory.getWijmoNumberFormatStructure=function(numberFormatInfo,crmNumberType,isPercent,overriddenPrecision){var decimalSeparator=numberFormatInfo.NumberDecimalSeparator,groupSeparator=numberFormatInfo.NumberGroupSeparator;crmNumberType.toLowerCase()==Globalization.CrmNumberType.CrmMoneyTypeName&&(decimalSeparator=numberFormatInfo.CurrencyDecimalSeparator,groupSeparator=numberFormatInfo.CurrencyGroupSeparator),isPercent&&(decimalSeparator=numberFormatInfo.PercentDecimalSeparator,groupSeparator=numberFormatInfo.PercentGroupSeparator);var patternFactory=new Globalization.NumberPatternFactory,percentNegativePattern=patternFactory.getPercentNegativePattern(numberFormatInfo.PercentNegativePattern),percentPositivePattern=patternFactory.getPercentPositivePattern(numberFormatInfo.PercentPositivePattern),currencyNegativePattern=patternFactory.getCurrencyNegativePattern(numberFormatInfo.CurrencyNegativePattern),currencyPositivePattern=patternFactory.getCurrencyPositivePattern(numberFormatInfo.CurrencyPositivePattern);return{".":WijmoNumberFormatFactory.validateSymbolLength(decimalSeparator,1),",":WijmoNumberFormatFactory.validateSymbolLength(groupSeparator,1),percent:{pattern:[percentNegativePattern,percentPositivePattern]},currency:{decimals:MscrmCommon.ControlUtils.Object.isNullOrUndefined(overriddenPrecision)?numberFormatInfo.CurrencyDecimalDigits:overriddenPrecision,symbol:WijmoNumberFormatFactory.validateSymbolLength(numberFormatInfo.CurrencySymbol,6),pattern:[currencyNegativePattern,currencyPositivePattern]}}},WijmoNumberFormatFactory.getNumberFormatString=function(numberFormatInfo,crmNumberType,isPercent,overriddenPrecision){if(crmNumberType=crmNumberType.toLowerCase(),isPercent)return"p"+(MscrmCommon.ControlUtils.Object.isNullOrUndefined(overriddenPrecision)?numberFormatInfo.PercentDecimalDigits.toString():overriddenPrecision.toString());switch(crmNumberType){case Globalization.CrmNumberType.CrmIntegerTypeName:return"n0";case Globalization.CrmNumberType.CrmMoneyTypeName:return"c";default:return"n"+(MscrmCommon.ControlUtils.Object.isNullOrUndefined(overriddenPrecision)?numberFormatInfo.NumberDecimalDigits.toString():overriddenPrecision.toString())}},WijmoNumberFormatFactory.validateSymbolLength=function(value,maxLength){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&value.length>maxLength&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(WijmoNumberFormatFactory.InvalidSymbolErrorMessage),value},WijmoNumberFormatFactory.InvalidSymbolErrorMessage="An invalid symbol has been provided by the number formatting information infrastructure.",WijmoNumberFormatFactory}();Globalization.WijmoNumberFormatFactory=WijmoNumberFormatFactory}(Globalization=MscrmCommon.Globalization||(MscrmCommon.Globalization={}))}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var ArrayQuery=function(){function ArrayQuery(data){this.data=data}return ArrayQuery.prototype.select=function(selector){for(var temp=[],i=0;i<this.data.length;i++){var value=selector(this.data[i],i);temp.push(value)}return new ArrayQuery(temp)},ArrayQuery.prototype.transform=function(selector){for(var temp=[],i=0;i<this.data.length;i++){var item=selector(this.data[i],i);temp[item.key]=item.value}return new ArrayQuery(temp)},ArrayQuery.prototype.each=function(delegate){for(var i=0;i<this.data.length;i++)delegate(this.data[i],i);return this},ArrayQuery.prototype.where=function(selector){for(var temp=[],i=0;i<this.data.length;i++)selector(this.data[i])&&temp.push(this.data[i]);return new ArrayQuery(temp)},ArrayQuery.prototype.firstOrDefault=function(selector){var list=this.where(selector).items();return list.length>0?list[0]:null},ArrayQuery.prototype.contains=function(selector){return null!=this.firstOrDefault(selector)},ArrayQuery.prototype.items=function(){return this.data},ArrayQuery}();MscrmCommon.ArrayQuery=ArrayQuery}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var DisplayMode=function(){function DisplayMode(){}return DisplayMode.UNKNOWN="UNKNOWN",DisplayMode.READ="READ",DisplayMode.EDIT="EDIT",DisplayMode.EDITHINT="EDITHINT",DisplayMode}();MscrmCommon.DisplayMode=DisplayMode;var ModeSwitchEventName=function(){function ModeSwitchEventName(){}return ModeSwitchEventName.fromReadToEdit="FROM_READ_TO_EDIT",ModeSwitchEventName}();MscrmCommon.ModeSwitchEventName=ModeSwitchEventName;var DisplayModeManager=function(){function DisplayModeManager(ins){this.instance=ins}return DisplayModeManager.prototype.getMode=function(){return this.currentMode},DisplayModeManager.prototype.setMode=function(newMode,params){var oldMode=this.currentMode;if(null==oldMode&&(oldMode=DisplayMode.UNKNOWN),oldMode!=newMode){switch(newMode){case DisplayMode.EDIT:switch(oldMode){case DisplayMode.READ:this.instance.context.utils.fireEvent(ModeSwitchEventName.fromReadToEdit,params),this.instance.context.mode.focus()}}this.currentMode=newMode}},DisplayModeManager}();MscrmCommon.DisplayModeManager=DisplayModeManager}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict"}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var EDITABLE_GRID_CONTROL_ID="MscrmControls.Grid.GridControl",DISABLE_EDITABLE_GRID_CONTROL_ON_PHONE_FCB="DisableEditableGridControlOnPhone",ENABLE_EDITING_PARAM_KEY="EnableEditing",ENABLE_EDITING_VALUE_YES="yes",GridHelper=function(){function GridHelper(){}return GridHelper.shouldRenderAsReadOnlyGridOnPhone=function(context,customControlConfiguration,deviceFormFactor){return!!(context.utils.isFeatureEnabled(DISABLE_EDITABLE_GRID_CONTROL_ON_PHONE_FCB)&&3===deviceFormFactor&&customControlConfiguration.Name===EDITABLE_GRID_CONTROL_ID&&customControlConfiguration.Parameters&&customControlConfiguration.Parameters[ENABLE_EDITING_PARAM_KEY]&&customControlConfiguration.Parameters[ENABLE_EDITING_PARAM_KEY].Value&&customControlConfiguration.Parameters[ENABLE_EDITING_PARAM_KEY].Value.toLowerCase()===ENABLE_EDITING_VALUE_YES)},GridHelper}();MscrmCommon.GridHelper=GridHelper}(MscrmCommon||(MscrmCommon={}));var Guid=function(){function Guid(value){if(this._guid=Guid._formatGuidString(value),!this.guid)throw new Error(value+" is not a valid Guid value.");Object.freeze(this)}return Object.defineProperty(Guid.prototype,"guid",{get:function(){return this._guid},set:function(value){},enumerable:!0,configurable:!0}),Guid.toString=function(guid){return guid?guid.guid:null},Guid.prototype.toString=function(){return this.guid},Guid.equals=function(x,y){return Guid.toString(x)===Guid.toString(y)},Guid.tryParse=function(value){return Guid.tryParseOrNull(value)||Guid.EMPTY},Guid.tryParseOrNull=function(value){var parsedValue=Guid._formatGuidString(value);return parsedValue?new Guid(parsedValue):null},Guid._formatGuidString=function(value){if(!value)return null;value=value.toLowerCase();var hyphenMatch=Guid.braceAndHyphenGuidVerifierPattern.exec(value);if(hyphenMatch)return hyphenMatch[1].length!==hyphenMatch[8].length?null:hyphenMatch[2];var contiguousMatch=Guid.contiguousGuidVerifierPattern.exec(value);return contiguousMatch?contiguousMatch.filter(function(_,index){return index>0}).join("-"):null},Guid.braceAndHyphenGuidVerifierPattern=/^({?)((\d|[a-f]){8}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){12})(}?)$/,Guid.contiguousGuidVerifierPattern=/^([a-f\d]{8})([a-f\d]{4})([a-f\d]{4})([a-f\d]{4})([a-f\d]{12})$/,Guid.EMPTY=new Guid("00000000-0000-0000-0000-000000000000"),Guid}(),MscrmCommon;!function(MscrmCommon){var KMPerformanceTelemetry=function(){function KMPerformanceTelemetry(){this.stopwatches={}}return Object.defineProperty(KMPerformanceTelemetry,"Instance",{get:function(){return KMPerformanceTelemetry.instance||(KMPerformanceTelemetry.instance=new KMPerformanceTelemetry),KMPerformanceTelemetry.instance},enumerable:!0,configurable:!0}),KMPerformanceTelemetry.prototype.GetStopwatchKeys=function(){return Object.keys(this.stopwatches)},KMPerformanceTelemetry.prototype.AddStartMarker=function(eventId){for(var params=[],_i=1;_i<arguments.length;_i++)params[_i-1]=arguments[_i];var key=eventId;params.forEach(function(id){key+=id}),this.stopwatches[key]||(this.stopwatches[key]=new Date)},KMPerformanceTelemetry.prototype.AddEndMarker=function(eventId,context){for(var params=[],_i=2;_i<arguments.length;_i++)params[_i-2]=arguments[_i];var endTime=new Date,key=eventId;if(params.forEach(function(id){key+=id}),this.stopwatches[key]){var startTime=this.stopwatches[key],timeTaken=endTime.getTime()-startTime.getTime(),event={eventName:MscrmCommon.KMTelemetryConstants.KBSEARCH_CONTROL_PERFORMANCE,eventParameters:[]};event.eventParameters.push({name:"actionName",value:eventId}),event.eventParameters.push({name:"timeTaken",value:timeTaken}),event.eventParameters.push({name:"userId",value:context.userSettings.userId}),context&&context.reporting.reportEvent(event),delete this.stopwatches[key]}},KMPerformanceTelemetry.prototype.AddActionLogForUsageCalculations=function(actionName,context){for(var params=[],_i=2;_i<arguments.length;_i++)params[_i-2]=arguments[_i];var event={eventName:"KbSearchControlUsage",eventParameters:[]};event.eventParameters.push({name:"ActionName",value:actionName}),event.eventParameters.push({name:"UserId",value:context.userSettings.userId}),actionName===MscrmCommon.KMTelemetryConstants.WATERMARK_ACTION_KBSEARCH_PERFORMED&&params.length>0?event.eventParameters.push({name:"IsManualSearch",value:params[0]}):actionName===MscrmCommon.KMTelemetryConstants.WATERMARK_ACTION_OPEN_ARTICLE_TO_READ&&params.length>0?event.eventParameters.push({name:"KbArticleIndex",value:params[0]}):actionName===MscrmCommon.KMTelemetryConstants.WATERMARK_ACTION_SORT_ORDER_CHANGED&&params.length>0?event.eventParameters.push({name:"SelectedSortOrder",value:params[0]}):actionName===MscrmCommon.KMTelemetryConstants.WATERMARK_ACTION_STATUS_FILTER_CHANGED&&params.length>0?event.eventParameters.push({name:"SelectedStatusFilter",value:params[0]}):actionName===MscrmCommon.KMTelemetryConstants.WATERMARK_ACTION_LANGUAGE_FILTER_CHANGED&&params.length>0&&event.eventParameters.push({
name:"SelectedLanguageFilter",value:params[0]}),context&&context.reporting.reportEvent(event)},KMPerformanceTelemetry.prototype.AddErrorLog=function(context,errorMessage,errorDetails){var event={eventName:"KbSearchControlError",eventParameters:[]};event.eventParameters.push({name:"ErrorMessage",value:errorMessage}),event.eventParameters.push({name:"ErrorDetails",value:errorDetails}),context&&context.reporting.reportEvent(event)},KMPerformanceTelemetry}();MscrmCommon.KMPerformanceTelemetry=KMPerformanceTelemetry}(MscrmCommon||(MscrmCommon={}));var MscrmCommon;!function(MscrmCommon){"use strict";var KMTelemetryConstants=function(){function KMTelemetryConstants(){}return KMTelemetryConstants.KBSEARCH_CONTROL_PERFORMANCE="KbSearchControlPerformance",KMTelemetryConstants.WATERMARK_ACTION_LOAD_KBSEARCH_CONTROL="Load_KBSearch_Control",KMTelemetryConstants.WATERMARK_ACTION_LOAD_SEARCH_RESULTS="Load_Search_Results",KMTelemetryConstants.WATERMARK_ACTION_OPEN_ARTICLE_TO_READ="Open_Article_To_Read",KMTelemetryConstants.WATERMARK_ACTION_LINK_KBARTICLE="Link_Knowledge_Article_To_Entity",KMTelemetryConstants.WATERMARK_ACTION_UNLINK_KBARTICLE="Unlink_Knowledge_Article_To_Entity",KMTelemetryConstants.WATERMARK_ACTION_EMAIL_ARTICLE_CONTENT="Email_Article_Content",KMTelemetryConstants.WATERMARK_ACTION_EMAIL_ARTICLE_URL="Email_Article_URL",KMTelemetryConstants.WATERMARK_ACTION_SEE_MORE_OPTION_CLICKED="SeeMore_Option_Clicked",KMTelemetryConstants.WATERMARK_ACTION_KBSEARCH_PERFORMED="KbSearch_Performed",KMTelemetryConstants.WATERMARK_ACTION_KBSEARCH_CONTROL_INITIALIZED="KBSearchControl_Initialized",KMTelemetryConstants.WATERMARK_ACTION_SORT_ORDER_CHANGED="Article_Sort_Order_Changed",KMTelemetryConstants.WATERMARK_ACTION_STATUS_FILTER_CHANGED="Article_Status_Filter_Changed",KMTelemetryConstants.WATERMARK_ACTION_LANGUAGE_FILTER_CHANGED="Article_Language_Filter_Changed",KMTelemetryConstants}();MscrmCommon.KMTelemetryConstants=KMTelemetryConstants}(MscrmCommon||(MscrmCommon={}));var Mscrm;!function(Mscrm){"use strict"}(Mscrm||(Mscrm={}));
//# sourceMappingURL=D:\a\1\s\target\Release\amd64\package\Controls\\CommonControl\CommonControl.js.map