var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.generateFormDescriptorInfoForActivityPointer=function(i,o){i&&i.attributeDescriptors&&(o[e.ListComponent.CardHeader]=[],i.attributeDescriptors[t.ActivityTypeCode]&&o[e.ListComponent.CardHeader].push({DataFieldName:i.attributeDescriptors[t.ActivityTypeCode].LogicalName,Label:i.attributeDescriptors[t.ActivityTypeCode].DisplayName,ClassId:i.attributeDescriptors[t.ActivityTypeCode].Id}),i.attributeDescriptors[t.PriorityCode]&&o[e.ListComponent.CardHeader].push({DataFieldName:i.attributeDescriptors[t.PriorityCode].LogicalName,Label:i.attributeDescriptors[t.PriorityCode].DisplayName,ClassId:i.attributeDescriptors[t.PriorityCode].Id}),i.attributeDescriptors[t.ScheduledEnd]&&o[e.ListComponent.CardHeader].push({DataFieldName:i.attributeDescriptors[t.ScheduledEnd].LogicalName,Label:i.attributeDescriptors[t.ScheduledEnd].DisplayName,ClassId:i.attributeDescriptors[t.ScheduledEnd].Id}),o[e.ListComponent.CardDetails]=[],i.attributeDescriptors[t.Subject]&&o[e.ListComponent.CardDetails].push({DataFieldName:i.attributeDescriptors[t.Subject].LogicalName,Label:i.attributeDescriptors[t.Subject].DisplayName,ClassId:i.attributeDescriptors[t.Subject].Id}),i.attributeDescriptors[t.RegardingObjectId]&&o[e.ListComponent.CardDetails].push({DataFieldName:i.attributeDescriptors[t.RegardingObjectId].LogicalName,Label:i.attributeDescriptors[t.RegardingObjectId].DisplayName,ClassId:i.attributeDescriptors[t.RegardingObjectId].Id}),o[e.ListComponent.CardFooter]=[],i.attributeDescriptors[t.OwnerId]&&o[e.ListComponent.CardFooter].push({DataFieldName:i.attributeDescriptors[t.OwnerId].LogicalName,Label:i.attributeDescriptors[t.OwnerId].DisplayName,ClassId:i.attributeDescriptors[t.OwnerId].Id}),i.attributeDescriptors[t.CreatedOn]&&o[e.ListComponent.CardFooter].push({DataFieldName:i.attributeDescriptors[t.CreatedOn].LogicalName,Label:i.attributeDescriptors[t.CreatedOn].DisplayName,ClassId:i.attributeDescriptors[t.CreatedOn].Id}),o[e.ListComponent.ColorStrip]=[],i.attributeDescriptors[t.StateCode]&&o[e.ListComponent.ColorStrip].push({DataFieldName:i.attributeDescriptors[t.StateCode].LogicalName,Label:i.attributeDescriptors[t.StateCode].DisplayName,ClassId:i.attributeDescriptors[t.StateCode].Id}))},t.ActivityTypeCode="activitytypecode",t.PriorityCode="prioritycode",t.ScheduledEnd="scheduledend",t.Subject="subject",t.Description="description",t.RegardingObjectId="regardingobjectid",t.OwnerId="ownerid",t.CreatedOn="createdon",t.StateCode="statecode",t}();e.ActivityCardComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r){var n=this;this.textPropertyName="text",this.valuePropertyName="value",this.selectedIndexChangedEventHandler=function(){n.ariaLiveRegionService.sendAssertiveCellValueMessage(n.input.text,n.datasetColumn.displayName)},this.itemClickedEventHandler=function(){n.gridControl.finishEditing()},this.editEndingEventHandler=function(e,t){if(n.dispose(),!t.cancel){t.cancel=!0;var i=n.input.selectedItem[n.textPropertyName];n.gridControl.setCellData(t.row,t.col,i,!0,!1),n.gridControl.focus()}},this.keyDownHandler=function(t){var i=n.input.itemsSource.length;e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowUpCode)&&n.input.isDroppedDown&&(n.input.selectedIndex=(n.input.selectedIndex-1+i)%i,e.TypeUtils.stopEventPropagation(t)),e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowDownCode)&&(n.input.isDroppedDown?(n.input.selectedIndex=(n.input.selectedIndex+1)%i,e.TypeUtils.stopEventPropagation(t)):t.altKey&&(n.input.isDroppedDown=!0)),e.TypeUtils.isKeyCode(t,e.GridConstants.kbSpaceCode)&&n.spaceKeyAction(t)},this.gridControl=t,this.eventArgs=i,this.showEmptyOption=!(e.GridUtils.columnRequired(o)||e.GridUtils.columnHasDefaultValue(o)),this.datasetColumn=o,this.ariaLiveRegionService=r}return t.prototype.createDropdownEditor=function(){this.editorRoot=document.createElement("div"),this.input=new wijmo.input.Menu(this.editorRoot),this.input.maxDropDownHeight=e.GridConstants.customDropDownMaxHeight,this.cleanupLayout(this.input),this.fillDropdown(),this.setSelectedValue(),this.input.selectedIndexChanged.addHandler(this.selectedIndexChangedEventHandler),this.input.addEventListener(this.editorRoot,e.WijmoConstants.eventKeyDown,this.keyDownHandler),this.input.itemClicked.addHandler(this.itemClickedEventHandler),this.eventArgs.cell.appendChild(this.editorRoot),this.gridControl.cellEditEnding.addHandler(this.editEndingEventHandler),this.input.focus()},t.prototype.cleanupLayout=function(e){this.cleanupNode(e.hostElement)},t.prototype.cleanupNode=function(e){if(e.nodeType===Node.ELEMENT_NODE&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.childNodes))for(var t=0;t<e.childNodes.length;t++)this.cleanupNode(e.childNodes.item(t));("BUTTON"===e.nodeName||"wj-part"in e.attributes&&"btn"===e.attributes.getNamedItem("wj-part").nodeValue)&&"tabindex"in e.attributes&&e.attributes.removeNamedItem("tabindex")}},t.prototype.spaceKeyAction=function(t){this.input.isDroppedDown=!this.input.isDroppedDown,this.setSelectedValue(),e.TypeUtils.stopEventPropagation(t)},t.prototype.fillDropdown=function(){this.input.displayMemberPath=this.textPropertyName,this.input.selectedValuePath=this.valuePropertyName;for(var e=this.getOptions(),t=[],i=0,o=e;i<o.length;i++){var r=o[i];(-1!==r.Value||this.showEmptyOption)&&t.push({text:r.Label,value:r.Value})}this.input.itemsSource=t},t.prototype.setSelectedValue=function(){for(var e=this.getCurrentValue(),t=0,i=this.input.itemsSource;t<i.length;t++){var o=i[t];if(o[this.valuePropertyName]==e||null==o[this.valuePropertyName]&&null==e){this.input.selectedValue=o[this.valuePropertyName],this.input.header=o[this.textPropertyName];break}}},t.prototype.getOptions=function(){return[]},t.prototype.getCurrentValue=function(){return 0},t.prototype.dispose=function(){this.eventArgs.cell.removeChild(this.editorRoot),this.gridControl.cellEditEnding.removeHandler(this.editEndingEventHandler),this.input.selectedIndexChanged.removeHandler(this.selectedIndexChangedEventHandler),this.input.itemClicked.removeHandler(this.itemClickedEventHandler),this.input.dispose()},t}();e.WijmoDropdownEditorBase=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o,r,n){var s=t.call(this,e,i,r,n)||this;return s.value=o,s.createBooleanEditor(),s}return __extends(i,t),i.prototype.createBooleanEditor=function(){this.createDropdownEditor()},i.prototype.getOptions=function(){return e.GridUtils.getOptionsFromAttributes(this.datasetColumn)},i.prototype.getCurrentValue=function(){var e=this.datasetColumn.attributes.defaultValue?1:0,t=MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.value)?e:this.value;return t},i.prototype.spaceKeyAction=function(t){var i=this.input.itemsSource.length;e.TypeUtils.isKeyCode(t,e.GridConstants.kbSpaceCode)&&(this.input.selectedIndex=(this.input.selectedIndex+1)%i,this.gridControl.finishEditing(),e.TypeUtils.stopEventPropagation(t))},i}(e.WijmoDropdownEditorBase);e.WijmoBooleanEditor=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r,n){var s=this;this.editEndingEventHandler=function(e,t){if(s.dispose(),!t.cancel){t.cancel=!0;var i=Array();if(s.multiSelectPicklistItems)for(var o=0;o<s.multiSelectPicklistItems.length;++o)s.multiSelectPicklistItems[o].selected&&i.push(s.multiSelectPicklistItems[o].value);var r=s.gridControl.columns,n=r;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n[t.col])){var a=n[t.col].dataMap;n[t.col].dataMap=null,s.gridControl.setCellData(t.row,t.col,i,!0,!1),n[t.col].dataMap=a}}},this.gridMultiSelectOptionsetEditorKeyboardHandler=function(t,i,o){e.TypeUtils.stopEventPropagation(i);var r=t?wijmo.grid.SelMove.NextCell:wijmo.grid.SelMove.None;o.gridControl._selHdl.moveSelection(wijmo.grid.SelMove.None,r,!0),r!=wijmo.grid.SelMove.None&&o.gridControl._selHdl.moveSelection(wijmo.grid.SelMove.None,wijmo.grid.SelMove.PrevCell,!0),o.gridControl.containsFocus()||window.setTimeout(function(){o.gridControl.focus()},0)},this.keyDownHandler=function(t){switch(t.keyCode){case e.GridConstants.kbTabCode:s.gridControl.finishEditing(!1),s.gridMultiSelectOptionsetEditorKeyboardHandler(!0,t,s);break;case e.GridConstants.kbEscapeCode:s.gridControl.finishEditing(!0),s.gridMultiSelectOptionsetEditorKeyboardHandler(!1,t,s)}},this.handleMouseDown=function(e){$.contains(s.editorSol,e.target)||s.eventArgs.cell==e.target||s.gridControl.finishEditing(!1)},this.handleScroll=function(e){var t=s;s.onScrollMethod=setTimeout(function(){"none"===t.editorSol.style.display&&t.gridControl.finishEditing(!1)})},this.onWindowResize=function(e){s.gridSol.positionSOL(s.eventArgs.cell.getBoundingClientRect().top,s.eventArgs.cell.getBoundingClientRect().bottom,!1)},this.gridControl=t,this.eventArgs=i,this.multiSelectPicklistItems=o,this.wijmo=wijmo,this.isWebClient=r,this.isControlDisabled=n,this.createMultiSelectOptionSetEditor()}return t.prototype.createMultiSelectOptionSetEditor=function(){this.editorRoot=document.createElement("div"),this.editorRoot.classList.add("custom-editor-div");var i="gridSelectElement_"+t.uniqueId++,o="GridMSOSField_"+t.uniqueId,r=3,n=this.isControlDisabled;this.editorSol=document.createElement("div"),this.editorSol.id=e.WijmoConstants.msosId,this.editorSol.setAttribute("name","solEditorParent"),this.editorSol.classList.add("custom-editor-div"),this.isWebClient&&this.editorSol.classList.add("focused-input"),this.editorSol.innerHTML=MscrmCommon.ControlUtils.String.Format("<select id='{0}' name='solEditorChild' multiple='multiple'></select>",i),this.editorSol.classList.add("wj-control"),this.editorSol.classList.add("wj-popup"),this.eventArgs.cell.appendChild(this.editorRoot);var s=this.eventArgs.cell.getBoundingClientRect().top,a=this.eventArgs.cell.getBoundingClientRect().bottom;this.wijmo.showPopup(this.editorSol,this.editorRoot,!1),MscrmCommon.ControlUtils.Object.isNullOrUndefined($.fn.searchableOptionList)&&initializeSolLibrary(jQuery,window,document),$(".stage").length>0&&$(".stage").css("clear","both"),this.gridSol=$("#"+i).searchableOptionList({showSelectAll:!0,shouldDefaultFocusonInput:!0,defaultMaxRowsInCurrentSelections:2,isControlDisabled:!1,data:this.multiSelectPicklistItems,key:o,texts:{noItemsAvailable:e.GridLocale.multiPicklistNoItemsLabel,selectAll:e.GridLocale.multiPicklistSelectAllLabel,searchplaceholder:e.GridLocale.multiPicklistTypeAheadLabel,expand:e.GridLocale.multiPicklistMoreLabel,collapse:e.GridLocale.multiPicklistLessLabel,optionSetItemAriaLabel:e.GridLocale.multiPicklistItemsLabel,typeSomethingInputAriaLabel:e.GridLocale.multiPicklistInputLabel,selectedListNavigation:e.GridLocale.multiPicklistListNavigationLabel,displayItemsRemoved:e.GridLocale.multiPicklistItemsRemovedLabel,moreLinkTitle:e.GridLocale.multiPicklistMoreLinkTitle,lessLinkTitle:e.GridLocale.multiPicklistLessLinkTitle,selectAllFocusTitle:e.GridLocale.multiPicklistSelectAllFocusTitle,selectAllDeselect:e.GridLocale.multiPicklistSelectAllDeselect,selectAllSelect:e.GridLocale.multiPicklistSelectAllSelect,totalItems:e.GridLocale.multiPicklistTotalItems,deleteItemTitle:e.GridLocale.multiPicklistDeleteTitle},events:{onInitialized:function(t,i){this.$container.addClass("msos-grid-container"),this.$innerContainer.addClass("msos-grid-inner-container"),this.$selectionContainer.addClass("msos-grid-selection-container"),this.$moreLessContainer.add("msos-grid-moreless-link");var o=this.$currentSelectionContainer.find(".sol-selected-display-item");o.add("msos-grid-selected-display-item");var l=this.$currentSelectionContainer.find(".sol-selected-display-item");if(l.add("msos-grid-selected-display-item-text"),l&&0==l.length&&this.$currentSelectionContainer&&(e.GridUtils.isUci()?(this.$currentSelectionContainer.addClass("uci-msos-grid-current-selection-normal"),this.$currentSelectionContainer.addClass("uci-msos-grid-current-selection-expanded")):(this.$currentSelectionContainer.addClass("msos-grid-current-selection-normal"),this.$currentSelectionContainer.addClass("msos-grid-current-selection-expanded"))),this.gridMSOSEditor=$("#"+e.WijmoConstants.msosId),this.positionSOL=function(t,i,o){if(this.displayBelowInput=!1,this.frameHeight=document.documentElement.clientHeight,t>this.frameHeight)this.gridMSOSEditor.hide();else{this.gridMSOSEditor.show();var n=this.gridMSOSEditor.offset().top,s=this.gridMSOSEditor.offset().top+this.gridMSOSEditor.outerHeight(!0);if(t!=n&&i!=s||o){var a=this.$container.offset().top,l="none"===this.$moreLessContainer.css("display")?this.$moreLessContainer.outerHeight()+e.WijmoConstants.moreLessTextHeight:this.$moreLessContainer.outerHeight(),c=a+this.currentSelectionContainerExpandedMaxHeight+this.$input.outerHeight()+l,d=e.WijmoConstants.currentSelectionContainerRowHeight*r+(this.$currentSelectionContainer.css("padding-top")?parseFloat(this.$currentSelectionContainer.css("padding-top").split("px")[0]):0)+(this.$currentSelectionContainer.css("padding-bottom")?parseFloat(this.$currentSelectionContainer.css("padding-bottom").split("px")[0]):0)+this.$input.outerHeight()+l;if($(document.documentElement).css("clear","both"),c>this.frameHeight||!o)if(t<this.frameHeight-i)document.documentElement.clientHeight-t<d?this.$container.css("min-height",d):this.$container.css("max-height",document.documentElement.clientHeight-t),o||(this.gridMSOSEditor.css("top",t),this.gridMSOSEditor.css("bottom",""));else{var u=document.documentElement.clientHeight-i;this.gridMSOSEditor.css("top","inherit"),this.gridMSOSEditor.css("bottom",u),d>i?this.$container.css("min-height",d):this.$container.css("max-height",i)}}}},this.positionSOL(s,a,!0),n&&(this.toggleControlState(n),this.$container.addClass("msos-sol-container-Disabled"),this.$moreLessContainer.addClass("msos-sol-moreless-container-Disabled"),null!=this.$currentSelectionContainer)){var c=this.$currentSelectionContainer.find(".sol-selected-display-item");c&&c.length>0&&(this.$currentSelectionContainer.find(".sol-selected-display-item").first().focus(),this.$currentSelectionContainer.find(".sol-selected-display-item").first().addClass("keyboard-selection"))}this.updateSelectionContainer=function(){this.displayBelowInput=!1,this.inputBoxTop=this.$input.offset().top,this.inputBoxBottom=this.inputBoxTop+this.$input.outerHeight(),this.selectionContainerHeight=this.$selectionContainer.outerHeight(),this.frameHeight-this.inputBoxBottom>this.selectionContainerHeight?this.displayBelowInput=!0:this.inputBoxBottom>this.selectionContainerHeight?this.displayBelowInput=!1:(this.$selectionContainer.addClass("sol-selection-container-reduced-height"),this.$selection.addClass("sol-selection-reduced-height"),this.selectionContainerHeight=this.containerHeight=this.$selectionContainer.outerHeight(!1),this.frameHeight-this.inputBoxBottom>this.containerHeight?this.displayBelowInput=!0:this.inputBoxBottom>this.containerHeight&&(this.displayBelowInput=!1)),this.$innerContainer.addClass("sol-inner-container-transform"),"block"==this.$innerContainer.css("display")&&(this.$selectionContainer.css("border-top-right-radius","initial"),this.$actionButtons&&this.$actionButtons.css("border-top-right-radius","initial"));var e=this.$selectionContainer.css("border-left-width")?parseFloat(this.$selectionContainer.css("border-left-width").split("px")[0]):0;this.$selectionContainer.css("left",0-e).css("width",this.$innerContainer.outerWidth(!1));var t=this.$innerContainer.outerHeight();this.displayBelowInput?(this.$selectionContainer.css("top",t+e),this.$selectionContainer.css("bottom","inherit")):(this.$selectionContainer.css("bottom",t+e),this.$selectionContainer.css("top","inherit"))}},onChange:function(e,t){for(var i=0;i<e.items.length;++i)if(e.items[i].value==t[0].value){e.items[i].selected=t[0].checked;break}this.multiSelectPicklistItems=e.items},onOpen:function(){this.updateSelectionContainer()},onScroll:function(){this.updateSelectionContainer()}}}),this.editorSol.addEventListener(e.WijmoConstants.eventKeyDown,this.keyDownHandler),this.gridControl.cellEditEnding.addHandler(this.editEndingEventHandler),document.addEventListener(e.WijmoConstants.eventSingleClick,this.handleMouseDown,!0),parent.document.addEventListener(e.WijmoConstants.eventSingleClick,this.handleMouseDown,!0),window.addEventListener(e.WijmoConstants.eventWindowResize,this.onWindowResize,!0),document.addEventListener(e.WijmoConstants.eventMouseScroll,this.handleScroll,!0)},t.prototype.dispose=function(){this.gridControl.cellEditEnding.removeHandler(this.editEndingEventHandler),clearTimeout(this.onScrollMethod),this.editorSol.removeEventListener(e.WijmoConstants.eventKeyDown,this.keyDownHandler),document.removeEventListener(e.WijmoConstants.eventSingleClick,this.handleMouseDown,!0),document.removeEventListener(e.WijmoConstants.eventMouseScroll,this.handleScroll,!0),parent.document.removeEventListener(e.WijmoConstants.eventSingleClick,this.handleMouseDown,!0),window.removeEventListener(e.WijmoConstants.eventWindowResize,this.onWindowResize,!0),this.wijmo.hidePopup(this.editorSol,!0),$.contains(this.eventArgs.cell,this.editorRoot)&&this.eventArgs.cell.removeChild(this.editorRoot)},t.uniqueId=0,t}();e.WijmoMultiSelectOptionsetEditor=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o,r,n){var s=t.call(this,e,i,o,n)||this;return s.value=r,s.createDropdownEditor(),s}return __extends(i,t),i.prototype.getOptions=function(){return e.GridUtils.getOptionsFromAttributes(this.datasetColumn)},i.prototype.getCurrentValue=function(){var e=this.datasetColumn.attributes.defaultValue?this.datasetColumn.attributes.defaultValue:-1,t=MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.value)?e:this.value;return t},i}(e.WijmoDropdownEditorBase);e.WijmoWholeOptionsetEditor=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r){var n=this;this.valueChangedEvent=new wijmo.Event,this.disposed=!1,this.handleValueChanged=function(e,t){n.updateLabelText(),n.valueChangedEvent.raise(n,t)},this.pluralLabel=o,this.singularLabel=i,this.rootElement=document.createElement("div"),this.input=this.createInput(this.rootElement,r),this.label=this.createLabel(this.rootElement),this.attachEventHandlers();var s=MscrmCommon.ControlUtils.String.Format("width: {0}",e.WijmoConstants.durationInputRatio);this.rootElement.setAttribute("style",s),this.rootElement.classList.add("input-control"),t.appendChild(this.rootElement),this.updateLabelText()}return Object.defineProperty(t.prototype,"valueChanged",{get:function(){return this.valueChangedEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.input.value},set:function(e){this.input.value=e},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this.input.focus()},t.prototype.addEventListener=function(e,t,i,o){this.input.addEventListener(e,t,i,o)},t.prototype.removeEventListener=function(e,t,i){this.input.removeEventListener(e,t,i)},t.prototype.attachEventHandlers=function(){this.input.valueChanged.addHandler(this.handleValueChanged),this.addEventListener(this.rootElement,e.WijmoConstants.eventDoubleClick,function(t){return e.TypeUtils.stopEventPropagation(t)})},t.prototype.dettachEventHandlers=function(){this.input.valueChanged.removeHandler(this.handleValueChanged),this.removeEventListener(this.rootElement,e.WijmoConstants.eventDoubleClick)},t.prototype.createInput=function(e,t){var i=new wijmo.input.InputNumber(e);return i.max=t,i.min=0,i.step=1,i.showSpinner=!1,i.isRequired=!1,i},t.prototype.createLabel=function(e){var t=document.createElement("div");return t.classList.add("label"),e.appendChild(t),t},t.prototype.updateLabelText=function(){this.label.innerText=1==this.value?this.singularLabel:this.pluralLabel},t.prototype.dispose=function(){this.disposed||(this.dettachEventHandlers(),this.valueChangedEvent.removeAllHandlers(),this.valueChangedEvent=null,this.input.dispose(),this.label=null,this.disposed=!0)},t}();e.DurationValueInput=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.MultiSelectPicklist||(e.MultiSelectPicklist={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(){var e=t.call(this)||this;return e.oldOptions=[],e}return __extends(i,t),i.prototype.initCore=function(e){this.dataBag=e,this.processPropertyBagValues(e),this.renderControl(e)},i.prototype.updateCore=function(e){this.shouldNotifyOutputChanged=!1,this.processPropertyBagValues(e);var t=e.parameters.value.attributes.Options;this.isSameAvailableOptionValueCollection(t)||($(this.container).empty(),this.renderControl(e));var i=[];MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.parameters.value.raw)||(i=e.parameters.value.raw),this.sol.refreshControl(i),this.shouldNotifyOutputChanged=!0,this.sol.toggleControlState(e.mode.isControlDisabled)},i.prototype.renderControl=function(e){this.populateData(e),this.createControl(e)},i.prototype.isSameAvailableOptionValueCollection=function(e){if(this.oldOptions.length!==e.length)return!1;for(var t=0;t<this.oldOptions.length;t++)if(e[t].Value!==this.oldOptions[t].Value)return!1;return!0},i.prototype.processPropertyBagValues=function(e){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.parameters.value))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.parameters.value.attributes.Options))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes.Options");0===e.parameters.value.attributes.Options.length&&(e.parameters.value.raw=null)},i.prototype.getOutputsCore=function(){return{value:this.getselectedOptionValues()}},i.prototype.getselectedOptionValues=function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.sol)?[]:this.sol.getValues()},i.prototype.destroyCore=function(){this.isControlInitialized},i.prototype.renderReadMode=function(e){t.prototype.renderReadMode.call(this,e),$(this.container).hide(),this.eventGuard.stopPreventingFocus()},i.prototype.renderEditMode=function(e){$(this.container).show(),this.shouldNotifyOutputChanged=!0},i.prototype.populateData=function(t){var i;if(this.multiSelectPicklistItems=[],t&&t.parameters&&t.parameters.value&&t.parameters.value.attributes&&t.parameters.value.attributes.Options){for(i=0;i<t.parameters.value.attributes.Options.length;i++){var o=t.parameters.value.attributes.Options[i].Label.toString(),r=t.parameters.value.attributes.Options[i].Value,n=MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.parameters.value.attributes.Options[i].accessibilityLabel)?t.parameters.value.attributes.Options[i].Label.toString():t.parameters.value.attributes.Options[i].accessibilityLabel.toString();if(""!==o&&-1!==r){var s=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.parameters.value.raw)&&-1!=t.parameters.value.raw.indexOf(r);this.multiSelectPicklistItems.push(new e.MultiselectPicklistItem("option",o,r,n,s))}}this.oldOptions=t.parameters.value.attributes.Options}},i.prototype.getLocalizedStrings=function(e){var t=function(t,i){var o=window.getAttributeInWindow;return o?o(t):e.resources.getString(i)};return{noItemsAvailable:t("LOCID_MULTIPICKLIST_NOITEMS","MultiSelectPicklistControl.NotItemsAvailable"),selectAll:t("LOCID_MULTIPICKLIST_SELECT_ALL","MultiSelectPicklistControl.SelectAll"),searchplaceholder:e.parameters.value.security.readable?t("LOCID_MULTIPICKLIST_TYPEAHEAD","MultiSelectPicklistControl.TypeAheadSearchText"):"******",expand:t("LOCID_MULTIPICKLIST_MORE","MultiSelectPicklistControl.More"),collapse:t("LOCID_MULTIPICKLIST_LESS","MultiSelectPicklistControl.Less"),optionSetItemAriaLabel:t("LOCID_MSO_ITEM_ARIALABEL","MultiSelectPicklistControl.Screenreader.OptionSetItem.AriaLabel"),typeSomethingInputAriaLabel:(e.mode.label?e.mode.label:e.parameters.value.attributes.DisplayName)+" "+t("LOCID_MSO_INPUT_ARIALABEL","MultiSelectPicklistControl.Screenreader.TypeSomethingInput.AriaLabel"),selectedListNavigation:t("LOCID_MSO_LIST_NAVIGATION","MultiSelectPicklistControl.Screenreader.SelectedItemsList.Navigation"),displayItemsRemoved:t("LOCID_MSO_ITEMS_REMOVED","MultiSelectPicklistControl.Screenreader.DisplayItems.Removed"),moreLinkTitle:t("LOCID_MSO_MORELINK_TITLE","MultiSelectPicklistControl.Screenreader.More.Title"),lessLinkTitle:t("LOCID_MSO_LESSLINK_TITLE","MultiSelectPicklistControl.Screenreader.Less.Title"),selectAllFocusTitle:t("LOCID_MSO_SELECTALL_FOCUSTITLE","MultiSelectPicklistControl.Screenreader.SelectAll.Title"),selectAllDeselect:t("LOCID_MSO_SELECTALL_DESELECT","MultiSelectPicklistControl.Screenreader.SelectAll.Deselect"),selectAllSelect:t("LOCID_MSO_SELECTALL_SELECT","MultiSelectPicklistControl.Screenreader.SelectAll.Select"),totalItems:t("LOCID_MSO_TOTAL_ITEMS","MultiSelectPicklistControl.Screenreader.TotalItems"),deleteItemTitle:t("LOCID_MSO_DELETE_TITLE","MultiSelectPicklistControl.DeleteItem.Title")}},i.isUci=function(){var e=window;return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm.Internal)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm.Internal.isUci)&&e.Xrm.Internal.isUci()},i.prototype.getScrollTarget=function(){var e=$("#"+i.turboFormScrollTarget);return 0==e.length?$(window):e},i.prototype.createControl=function(e){this.stringResourceProvider=e.resources.getString;var t=e.client.isRTL,o="<select id='{0}' name='character' multiple='multiple'></select>",r=e.parameters.value.attributes.LogicalName+"_"+i.uniqueId++,n=MscrmCommon.ControlUtils.String.Format(o,r);$(this.container).append($(n));var s=this;this.sol=$("#"+r).searchableOptionList({showSelectAll:!0,shouldDefaultFocusonInput:!i.isUci(),defaultMaxRowsInCurrentSelections:2,isRTL:t,isControlDisabled:e.mode.isControlDisabled,key:e.parameters.value.attributes.LogicalName,texts:this.getLocalizedStrings(e),data:s.multiSelectPicklistItems,scrollTarget:this.getScrollTarget(),events:{onChange:function(e,t){s.notifyEnabledControlOutputChanged.apply(s)},onScroll:function(){var e=-1,t=0,o=0;this.$selectionContainer.css("top","0"),this.$selectionContainer.css("left","0"),t=i.isUci()?0:this.$selectionContainer.get(0).getBoundingClientRect().top,o=this.$selectionContainer.get(0).getBoundingClientRect().left;var r,n,s,a=document.documentElement.clientHeight;if(this.updateSelectionContainer=function(){var e=this.$input.parent().get(0);r=MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)?t:e.getBoundingClientRect().bottom-t;var i=this.$selectionContainer.outerHeight(!1);return n=r+i,s=!1,!(n>a)||(s=!0,r=this.$input.offset().top-t-i-parseInt(this.$selectionContainer.css("border-bottom-width"),10),r>0)},!this.updateSelectionContainer()&&(this.$selectionContainer.addClass("sol-selection-container-reduced-height"),this.$selection.addClass("sol-selection-reduced-height"),!this.updateSelectionContainer()&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(parent.document.body.getElementsByTagName("iframe")))){var l=parent.document.body.getElementsByTagName("iframe")[0];MscrmCommon.ControlUtils.Object.isNullOrUndefined(l)||l.getAttribute("id")!==i.turboFormQuickCreateContainer||(l.style.height=parseInt(l.style.height)+(n-a)+"px",r=n-this.$selectionContainer.outerHeight(!1))}"block"==this.$innerContainer.css("display")&&(this.$selectionContainer.css("border-top-right-radius","initial"),this.$actionButtons&&this.$actionButtons.css("border-top-right-radius","initial")),i.isUci()?(this.$selectionContainer.css("position","absolute").css("left",e),s?this.$selectionContainer.css("top","inherit").css("bottom",this.$innerContainer.outerHeight(!1)):this.$selectionContainer.css("bottom","inherit").css("top",this.$innerContainer.outerHeight(!1))):this.$selectionContainer.css("position","fixed").css("top",Math.floor(r)).css("left",this.$container.offset().left-o),this.$selectionContainer.css("width",this.$innerContainer.outerWidth(!1)-1),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.config.scrollTarget.offset())||(r<this.config.scrollTarget.offset().top?this.$selectionContainer.addClass("sol-filtered-search"):this.$selectionContainer.removeClass("sol-filtered-search"))}}})},i.uniqueId=0,i.turboFormScrollTarget="tdAreas",i.solOptionHeight=35,i.turboFormQuickCreateContainer="NavBarGloablQuickCreate",i}(MscrmCommon.FieldControlBase);e.MultiSelectPicklistControl=t}(t=e.MultiSelectPicklist||(e.MultiSelectPicklist={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,i,o,r){this.type=e,this.label=t,this.value=i,this.tooltip=o,this.selected=r}return e}();e.MultiselectPicklistItem=t}(t=e.MultiSelectPicklist||(e.MultiSelectPicklist={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.apply=function(e){if(!t.applied){t.userAgent=e;var i=wijmo;i.grid.filter.ValueFilter.prototype.apply=t.applyValueFilter,i.input.DropDown.prototype._handleResize=t._handleResize,i.grid._MouseHandler.prototype._mousedown=t._mousedown,i.grid._MouseHandler.prototype._click=t._click,i.grid._MouseHandler.prototype._mousemove=t._mousemove,i.mouseToPage=t.mouseToPage,i.input.AutoComplete.prototype._setText=t._autocompleteSetText;var o=i.grid._KeyboardHandler.prototype._keydown;i.grid._KeyboardHandler.prototype._keydown=t._keyDown(o),i.input.InputNumber.prototype.onGotFocus=t.inputNumberOnGotFocus,i.hidePopup=t.hidePopup,i.grid.filter.ColumnFilterEditor.prototype._handleResize=t.filterHandleResize,i.grid.FlexGrid.prototype._setFocus=t._setFocus,i.grid.FlexGrid.prototype._setFocusNoScroll=t._setFocusNoScroll,t.applied=!0}},t.mouseToPage=function(e){if(e instanceof wijmo.Point)return e;if(e.touches&&e.touches.length>0?e=e.touches[0]:e.changedTouches&&e.changedTouches.length>0&&(e=e.changedTouches[0]),wijmo.isNumber(e.clientX)&&wijmo.isNumber(e.clientY))return new wijmo.Point(e.clientX+pageXOffset,e.clientY+pageYOffset);throw"Mouse or touch event expected."},t._keyboardSort=function(e,t,i){if(t.range&&t.panel){var o=(t.range.bottomRow,t.panel.columns[t.col]),r=e._getBindingColumn(t.panel,t.row,o),n=r?r._getBindingSort():null;if(r.allowSorting&&n){for(var s=t.grid.collectionView.sortDescriptions,a=null,l=0;l<s.length;l++)if(s[l].property==n){a=!s[l].ascending;break}if(null==a){if(i)return;a=!0}var c=new wijmo.grid.CellRangeEventArgs(t.panel,t.range);e.onSortingColumn(c)&&(e._edtHdl._commitRowEdits(),i?s.clear():s.splice(0,s.length,new wijmo.collections.SortDescription(n,a)),e.onSortedColumn(c)),window.setTimeout(function(){var i=e.cells.hostElement.querySelectorAll("[role=columnheader]");i&&i[t.col-1]&&i[t.col-1].focus()},1e3)}}},t._keyDown=function(i){return function(o){var r=this._g,n=new wijmo.grid.HitTestInfo(o.target,null);if(-1!==n.row&&1===n.col&&!o.ctrlKey&&!o.shiftKey&&!o.altKey&&!o.metaKey&&!wijmo.hasClass(o.target,e.WijmoConstants.headerCSSClass)&&(e.TypeUtils.isKeyCode(o,e.GridConstants.kbArrowUpCode)||e.TypeUtils.isKeyCode(o,e.GridConstants.kbArrowDownCode)||e.TypeUtils.isKeyCode(o,e.GridConstants.kbSpaceCode)||!r.rightToLeft&&e.TypeUtils.isKeyCode(o,e.GridConstants.kbArrowRightCode)||r.rightToLeft&&e.TypeUtils.isKeyCode(o,e.GridConstants.kbArrowLeftCode))){
var s=Math.max(0,r._szClient.height-r.columnHeaders.height),a=n.row,l=n.col,c=r.cells.getCellElement(a,l);switch(o.keyCode){case e.GridConstants.kbArrowUpCode:a=r.rows.getNextCell(n.row,wijmo.grid.SelMove.Prev,s);break;case e.GridConstants.kbArrowDownCode:a=r.rows.getNextCell(n.row,wijmo.grid.SelMove.Next,s);break;case e.GridConstants.kbArrowLeftCode:case e.GridConstants.kbArrowRightCode:a=n.row,l=Math.min(n.col+1,r.columns.length-1),t._handleSelection(n,r,a,l,!0);break;case e.GridConstants.kbSpaceCode:t._handleSelection(n,r,n.row,n.col,!1)}var d=r.cells.getCellElement(a,l);return d&&(wijmo.setAttribute(c,e.GridConstants.tabIndex,-1),wijmo.setAttribute(d,e.GridConstants.tabIndex,0),r._activeCell=d,d.focus()),void o.preventDefault()}if(-1===n.row&&!o.shiftKey&&!o.altKey&&!o.metaKey){var u=!1;switch(o.keyCode){case e.GridConstants.kbEnterCode:t._keyboardSort(r,n,!!o.ctrlKey&&o.ctrlKey),u=!0;break;case e.GridConstants.kbSpaceCode:if(1===n.col)return void o.preventDefault();return;case e.GridConstants.kbArrowUpCode:case e.GridConstants.kbArrowDownCode:case e.GridConstants.kbArrowLeftCode:case e.GridConstants.kbArrowRightCode:u=!0}return void(u&&(o.preventDefault(),o.stopImmediatePropagation()))}i.apply(this,arguments)}},t._handleSelection=function(e,t,i,o,r){if(e.row>-1&&e.col>-1){var n=t.rows,s=t._selHdl._sel,a=new wijmo.grid.CellRange(e.row,e.col);t._mouseHdl._startListBoxSelection(e.row);for(var l=!1,c=0;c<n.length;c++){var d=a.containsRow(c)?t._mouseHdl._lbSelState:null!=t._mouseHdl._lbSelRows[c];if(r&&(d=c===i),d!==n[c].isSelected){var u=new wijmo.grid.CellRangeEventArgs(t.cells,new wijmo.grid.CellRange(c,s.col,c,s.col2));t.onSelectionChanging(u)&&(n[c]._setFlag(wijmo.grid.RowColFlags.Selected,d,!0),l=!0,t.onSelectionChanged(u))}}(l||s&&s.row===i)&&(s.row=i,s.col=o,t.refreshCells(!1,!0,!0))}},t.applied=!1,t._setFocus=function(e){if(this.hostElement&&(e||!this.containsFocus())){var t=wijmo.getActiveElement(),i=this._eFocus,o="tabindex";if(t&&t.getAttribute&&"columnheader"==t.getAttribute("role"))return;this.activeEditor?wijmo.contains(this.activeEditor,t)||(this._setFocusNoScroll(this.activeEditor),i.removeAttribute(o)):this._activeCell?wijmo.contains(this._activeCell,t)||t!=this._root&&(this._setFocusNoScroll(this._activeCell),i.removeAttribute(o)):wijmo.contains(i,t)||i.focus(),this.containsFocus()||i.focus()}},t._setFocusNoScroll=function(e){if("columnheader"!=e.getAttribute("role")){var t=this.scrollPosition,i=e.style;i.position;e!=this._eFocus&&(e.tabIndex=this._tabIndex,e.focus()),this.scrollPosition=t}},t.filterHandleResize=function(){this._wasTouching||wijmo.grid.filter.ColumnFilterEditor.prototype.onButtonClicked()},t.applyValueFilter=function(e){var t=this.column;return!(this._bnd&&this._values&&Object.keys(this._values).length)||(t.dataType==wijmo.DataType.Array?(e=this.dataMap?this.dataMap.getDisplayValues(e):t.dataMap?t.dataMap.getDisplayValues(e):wijmo.Globalize.format(e,t.format),Object.keys(this._values).every(function(t){return e.indexOf(t)>=0})):(e=this._bnd.getValue(e),e=this.dataMap?this.dataMap.getDisplayValue(e):t.dataMap?t.dataMap.getDisplayValue(e):wijmo.Globalize.format(e,t.format),void 0!=this._values[e]))},t._handleResize=function(){this.isDroppedDown&&(this.refresh(),this.isDroppedDown=!0)},t._mousemove=function(e){if(null!=this._htDown){if(0==e.buttons&&this._eMouse&&e.timeStamp-this._eMouse.timeStamp>600)return void this.resetMouseState();if(this._eMouse=e,this._szRowCol)this._handleResizing(e);else switch(this._htDown.cellType){case wijmo.grid.CellType.Cell:this._mouseSelect(e,e.shiftKey);break;case wijmo.grid.CellType.RowHeader:0==(this._g.allowDragging&wijmo.grid.AllowDragging.Rows)&&this._mouseSelect(e,!0)}}},t._mousedown=function(e){var i=this._g,o=i.hitTest(e),r=o.cellType,n=e.ctrlKey||e.metaKey;if(this._selDown=i.selection,o.panel==i.cells){if(wijmo.closestClass(e.target,wijmo.grid.CellFactory._WJC_DROPDOWN)){e.preventDefault();var s=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(i._edtHdl)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(i._edtHdl._toggleListBox)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||i._edtHdl._toggleListBox(e,o.range)};return void(t.userAgent&&t.userAgent.isIos?setTimeout(s,500):s())}if(i.editRange&&i.editRange.contains(o.range))return}var a=wijmo.getActiveElement();if(e.target!=a||!i._isInputElement(e.target)){if(r==wijmo.grid.CellType.None)return void i._edtHdl._commitRowEdits();if(this._htDown=o,this._eMouse=e,null!=this._szRowCol)return a!=i._eFocus&&(i._eFocus.tabIndex=0,i._eFocus.focus()),void this._handleResizing(e);switch(r){case wijmo.grid.CellType.Cell:1!=o.col?(n&&i.selectionMode==wijmo.grid.SelectionMode.ListBox&&this._startListBoxSelection(o.row),this._mouseSelect(e,e.shiftKey)):0==(this._g.allowDragging&wijmo.grid.AllowDragging.Rows)&&(i.selectionMode==wijmo.grid.SelectionMode.ListBox&&this._startListBoxSelection(o.row),this._mouseSelect(e,e.shiftKey));break;case wijmo.grid.CellType.RowHeader:0==(this._g.allowDragging&wijmo.grid.AllowDragging.Rows)&&(i.selectionMode==wijmo.grid.SelectionMode.ListBox&&this._startListBoxSelection(o.row),this._mouseSelect(e,e.shiftKey))}if(r==wijmo.grid.CellType.Cell&&i.rows.maxGroupLevel>-1&&wijmo.closestClass(e.target,wijmo.grid.CellFactory._WJC_COLLAPSE)){var l=wijmo.tryCast(i.rows[o.row],wijmo.grid.GroupRow);if(l)return n?i.collapseGroupsToLevel(l.isCollapsed?l.level+1:l.level):l.isCollapsed=!l.isCollapsed,void this.resetMouseState()}}},t._click=function(t){if(Date.now()-this._tsLast>50&&!t.pointerType){var i=this._g,o=t.target,r=new wijmo.grid.HitTestInfo(o,null);if(!t.defaultPrevented&&r.grid==i&&!i._isInputElement(o))if(r.panel==i.topLeftCells)e.WijmoGridComponent.selectAllOrNothing(i);else if(r.panel==i.columnHeaders)this._eMouse=t,this._clickSort(t,r);else if(r.panel==i.rowHeaders||1==r.col)this._startListBoxSelection(r.row),this._mouseSelect(t,t.shiftKey);else if(r.panel==i.cells&&1!=r.col)if(r.row<0)this._clickSort(t,r);else if(wijmo.closestClass(o,wijmo.grid.CellFactory._WJC_COLLAPSE)){var n=i.rows[r.row];n instanceof wijmo.grid.GroupRow&&(t.ctrlKey?i.collapseGroupsToLevel(n.isCollapsed?n.level+1:n.level):n.isCollapsed=!n.isCollapsed)}else wijmo.closestClass(o,wijmo.grid.CellFactory._WJC_DROPDOWN)?i._edtHdl._toggleListBox(t,r.range):i.select(r.range)}},t._autocompleteSetText=function(e){var t=this;if(!this._inCallback){if(!e&&this.selectedIndex>-1&&(this.selectedIndex=-1),e!=this._oldText&&(this._tbx.value!=e&&(this._tbx.value=e),this._oldText=e,this.onTextChanged(),!e&&this.collectionView))return this._rxHighlight=null,this.collectionView.filter=this._query=null,void(this.isDroppedDown=!1);this._toSearch&&clearTimeout(this._toSearch),e!=this.getDisplayText()&&(this._toSearch=setTimeout(function(){t._toSearch=null;var e=t.text.trim().toLowerCase();if(e.length>=t._minLength&&e!=t._query){t._query=e,e=e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var i=wijmo.escapeHtml(e);t._rxMatch=new RegExp("(?=.*"+e.replace(/ /g,")(?=.*")+")","ig"),t._rxHighlight=t.isContentHtml?new RegExp("("+i.replace(/ /g,"|")+")(?![^<]*>|[^<>]* </)","ig"):new RegExp("("+i.replace(/ /g,"|")+")","ig"),t.itemsSourceFunction?t.itemsSourceFunction(e,t.maxItems,t._itemsSourceFnCallBackBnd):t._updateItems()}},this._delay))}},t.inputNumberOnGotFocus=function(e){if(!this.isTouching){this._tbx.focus();var t=this.text.indexOf(this._chrDec);0>t&&(t=this._getInputRange(!0)[1]),wijmo.setSelectionRange(this._tbx,t)}wijmo.Control.prototype.onGotFocus.call(this,e)},t.hidePopup=function(e,i,o){void 0===i&&(i=!0),void 0===o&&(o=!1),o?wijmo.animate(function(o){e.style.opacity=(1-o).toString(),1==o&&(t.internalHidePopup(e,i),e.style.opacity="")}):t.internalHidePopup(e,i)},t.internalHidePopup=function(e,t){e.style.display="none",t&&e.parentElement&&"none"==e.style.display&&wijmo.removeChild(e);var i=e[wijmo.Control._SCRL_KEY];i instanceof wijmo.Control&&i.dispose(),delete e[wijmo.Control._SCRL_KEY],delete e[wijmo.Control._OWNR_KEY]},t}();e.MicrosoftWijmoPatches=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){this.dependencyObject={}}return t.prototype.add=function(e,t){this.dependencyObject[e]=t},t.prototype.getService=function(e){return this.dependencyObject[e]},t.prototype.getAllCurrentRecords=function(){for(var e={},t=0,i=this.gridFeatures;t<i.length;t++){var o=i[t],r=o.getCurrentRecord();null!==r&&(e[r.name]=r.value)}return e},Object.defineProperty(t.prototype,"gridFeatures",{get:function(){return this.getService(e.Services.gridFeatures)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gridComponent",{get:function(){return this.getService(e.Services.gridComponent)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gridState",{get:function(){return this.getService(e.Services.stateService)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){for(var e=0,t=this.gridFeatures;e<t.length;e++){var i=t[e];i.dispose()}for(var o in this.dependencyObject)this.dependencyObject.hasOwnProperty(o)&&"dispose"in this.dependencyObject[o]&&this.dependencyObject[o].dispose();this.dependencyObject=null},t}();e.GridCompositionRoot=t;var i=function(){function e(){}return e}();e.RecordDefenition=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){this.dependencyObject={}}return t.prototype.add=function(e,t){this.dependencyObject[e]=t},t.prototype.getService=function(e){return this.dependencyObject[e]},Object.defineProperty(t.prototype,"listFeatures",{get:function(){return this.getService(e.Services.gridFeatures)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listComponent",{get:function(){return this.getService(e.Services.listComponent)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var e=this.listFeatures;if(e)for(var t=0,i=e;t<i.length;t++){var o=i[t];o.dispose()}for(var r in this.dependencyObject)this.dependencyObject.hasOwnProperty(r)&&"dispose"in this.dependencyObject[r]&&this.dependencyObject[r].dispose();this.dependencyObject=null},t}();e.ListCompositionRoot=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e){this.gridComponent=e}return Object.defineProperty(t.prototype,"selectedRowId",{get:function(){return null==this.selectedRow?null:this.gridComponent.getCellData(this.selectedRow,0,!1)},enumerable:!0,configurable:!0}),t.prototype.clearSelectedRowFieldAccess=function(e){if(!(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.selectedRow)||this.selectedRow<0)){for(var t=0;t<e.length;t++){var i=this.gridComponent.getColumnIndex(e[t].name),o=this.gridComponent.isColumnVisible(e[t].name);if(!(0>i)&&o){var r=this.gridComponent.findCellHtml(this.selectedRow,i);MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)||this.removeStyles(r,i)}}this.selectedRow=null}},t.prototype.applyStyles=function(t,i,o){var r=this;o.then(function(o){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.gridComponent)){var n=r.gridComponent.findCellHtml(t,i);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)){if(!o.isReadable){var s=r.gridComponent.getColumnType(i);r.gridComponent.formatDisplay(e.WijmoConstants.notReadableString,n,s),wijmo.toggleClass(n,e.FieldAccessConstants.notReadableCSSClass,!0)}r.gridComponent.isEditable&&(o.isEditable?(wijmo.toggleClass(n,e.FieldAccessConstants.requiredCSSClass,o.isRequired()),wijmo.setAttribute(n,e.GridConstants.ariaRequired,o.isRequired()),r.createAcessibilityInstruction(n)):(wijmo.toggleClass(n,e.FieldAccessConstants.notEditableCSSClass,!0),wijmo.setAttribute(n,e.GridConstants.ariaReadOnly,!0)),wijmo.toggleClass(n,e.FieldAccessConstants.recommendedCSSClass,o.isRecommended()),wijmo.toggleClass(n,e.FieldAccessConstants.securedCSSClass,o.isSecured))}}})},t.prototype.getColumnIndex=function(e){return this.gridComponent.getColumnIndex(e)},t.prototype.isColumnVisible=function(e){return this.gridComponent.isColumnVisible(e)},t.prototype.isRecordSelected=function(e){return-1!==this.gridComponent.selectedRows.indexOf(e)},t.prototype.createAcessibilityInstruction=function(t){var i=t.id+e.GridConstants.instructionPostfix;MscrmCommon.ControlUtils.Object.isNullOrUndefined(document.getElementById(i))&&e.GridUtils.createCellAccessibilityMessage(e.GridLocale.accessibilityStartEditingInstruction,t,i)},t.prototype.removeStyles=function(t,i){if(t.classList.contains(e.FieldAccessConstants.notReadableCSSClass)){var o=this.gridComponent.getColumnType(i);this.gridComponent.formatDisplay(e.WijmoConstants.undefinedString,t,o)}wijmo.removeClass(t,e.FieldAccessConstants.notReadableCSSClass),wijmo.removeClass(t,e.FieldAccessConstants.securedCSSClass),wijmo.removeClass(t,e.FieldAccessConstants.requiredCSSClass),wijmo.removeClass(t,e.FieldAccessConstants.recommendedCSSClass),wijmo.removeClass(t,e.FieldAccessConstants.notEditableCSSClass)},t.prototype.dispose=function(){this.gridComponent=null,this.selectedRow=null},t}();e.WijmoFieldAccessComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.initialize=function(i){t.editableGridAriaLabel=i(e.LabelId.editableGridAria),t.emptyCellAriaLabel=i(e.LabelId.emptyCellAria),t.commandBarFlyoutOpenButton=i(e.LabelId.commandBarFlyoutOpenButton),t.commandBarSortIconText=i(e.LabelId.commandBarSortIconText),t.commandBarSortToolTipText=i(e.LabelId.commandBarSortToolTipText),t.commandBarSelectIconText=i(e.LabelId.commandBarSelectIconText),t.commandBarSelectToolTipText=i(e.LabelId.commandBarSelectToolTipText),t.cellTemplateAriaLabel=i(e.LabelId.cellTemplateAria),t.groupByMenuHeaderLabel=i(e.LabelId.groupByMenuHeader),t.chooseColumnsMenuHeaderLabel=i(e.LabelId.chooseColumnsMenuHeader),t.groupByItemsCountLabel=i(e.LabelId.groupByItemsCount),t.noGroupingOptionLabel=i(e.LabelId.noGroupingOption),t.firstPageTooltipLabel=i(e.LabelId.firstPageTooltip),t.nextPageTooltipLabel=i(e.LabelId.nextPageTooltip),t.currentPageTooltipLabel=i(e.LabelId.currentPageTooltip),t.currentPagingMask=i(e.LabelId.currentPagingMask),t.previousPageTooltipLabel=i(e.LabelId.previousPageTooltip),t.accessibilityStartEditingInstruction=i(e.LabelId.accessibilityStartEditingInstruction),t.rollupLastUpdatedLabel=i(e.LabelId.rollupFieldLastUpdatedLabel),t.durationHoursLabel=i(e.LabelId.durationHoursText),t.durationMinutesLabel=i(e.LabelId.durationMinutesText),t.durationDaysLabel=i(e.LabelId.durationDaysText),t.durationHourLabel=i(e.LabelId.durationHourText),t.durationMinuteLabel=i(e.LabelId.durationMinuteText),t.durationDayLabel=i(e.LabelId.durationDayText),t.noRecordsText=i(e.LabelId.noRecordsText),t.jumpBarButtonText=i(e.LabelId.jumpBarButtonText),t.enableLookupFilter=i(e.LabelId.enableLookupFilter),t.disableLookupFilter=i(e.LabelId.disableLookupFilter),t.saveButtonLabel=i(e.LabelId.saveButtonLabel),t.selectAllButtonLabel=i(e.LabelId.selectAllButtonLabel),t.selectAllButtonAccessibilityLabel=i(e.LabelId.selectAllButtonAccessibilityLabel),t.refreshButtonLabel=i(e.LabelId.refreshButtonLabel),t.unsavedStatusLabel=i(e.LabelId.unsavedStatusLabel),t.savingStatusLabel=i(e.LabelId.savingStatusLabel),t.refreshStatusLabel=i(e.LabelId.refreshStatusLabel),t.genericUpdateError=i(e.LabelId.genericUpdateErrorLabel),t.rowNavigationButtonTooltip=i(e.LabelId.rowNavigationButtonTooltip),t.rowNavigationButtonTooltipSpecific=i(e.LabelId.rowNavigationButtonTooltipSpecific),t.rowDeleteButtonTooltip=i(e.LabelId.rowDeleteButtonTooltip),t.multiPicklistNoItemsLabel=i(e.LabelId.multiPicklistNoItemsLabel),t.multiPicklistSelectAllLabel=i(e.LabelId.multiPicklistSelectAllLabel),t.multiPicklistTypeAheadLabel=i(e.LabelId.multiPicklistTypeAheadLabel),t.multiPicklistMoreLabel=i(e.LabelId.multiPicklistMoreLabel),t.multiPicklistLessLabel=i(e.LabelId.multiPicklistLessLabel),t.multiPicklistItemsLabel=i(e.LabelId.multiPicklistItemsLabel),t.multiPicklistInputLabel=i(e.LabelId.multiPicklistInputLabel),t.multiPicklistListNavigationLabel=i(e.LabelId.multiPicklistListNavigationLabel),t.multiPicklistItemsRemovedLabel=i(e.LabelId.multiPicklistItemsRemovedLabel),t.multiPicklistMoreLinkTitle=i(e.LabelId.multiPicklistMoreLinkTitle),t.multiPicklistLessLinkTitle=i(e.LabelId.multiPicklistLessLinkTitle),t.multiPicklistSelectAllFocusTitle=i(e.LabelId.multiPicklistSelectAllFocusTitle),t.multiPicklistSelectAllDeselect=i(e.LabelId.multiPicklistSelectAllDeselect),t.multiPicklistSelectAllSelect=i(e.LabelId.multiPicklistSelectAllSelect),t.multiPicklistTotalItems=i(e.LabelId.multiPicklistTotalItems),t.multiPicklistDeleteTitle=i(e.LabelId.multiPicklistDeleteTitle),t.sortByColumnName=i(e.LabelId.sortByColumnName),t.sortedByColumnName=i(e.LabelId.sortedByColumnName),t.streamFiltered=i(e.LabelId.streamFiltered),t.streamUnfiltered=i(e.LabelId.streamUnfiltered),t.columnFiltered=i(e.LabelId.columnFiltered),t.columnUnfiltered=i(e.LabelId.columnUnfiltered),t.sortedByNone=i(e.LabelId.gridFilteringValueFilterNull),t.sortedByAscending=i(e.LabelId.gridFilteringAscending),t.sortedByDescending=i(e.LabelId.gridFilteringDescending),t.streamBulkOperations=i(e.LabelId.streamBulkOperations),t.closeButton=i(e.LabelId.closeButton),t.streamSortAscending=i(e.LabelId.streamSortAscending),t.streamSortDescending=i(e.LabelId.streamSortDescending),t.gridRowText=i(e.LabelId.gridRowText),t.gridHeaderRowText=i(e.LabelId.gridHeaderRowText),t.gridDataRowText=i(e.LabelId.gridDataRowText),t.listCardExpandText=i(e.LabelId.listCardExpandText),t.listCardCollapseText=i(e.LabelId.listCardCollapseText),t.closeSortPopupButtonText=i(e.LabelId.closeSortPopupButtonText)},t}();e.GridLocale=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(t){"use strict";t.SELECT_COMMAND_ID="ToggleSelectionMode";var i=function(i){function o(){var e=i.call(this)||this;return e.updateEvents.shouldIgnoreEvent(Mscrm.UpdateEventType.Activation,!1),e.shouldPreventMultipleEventTypes=!1,e}return __extends(o,i),o.prototype.initCore=function(e,t){MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.client.trackContainerResize)||e.client.trackContainerResize(!0),this.initCoreInternal(e,t)},o.prototype.initializeListView=function(e){this.currentList=new t.ListCompositionRoot,this.listComponent=new t.ListComponent(e,this.container,this.perfTool);this.listComponent.getListSortingPopup();this.addListCommandListeners(e),this.listComponent.setContext(e),this.initializeEnhancedPagination(e),this.listCoordinator=new t.ListCoordinator(this.enhancedPagination?[this.enhancedPagination]:[],this.listComponent),this.listCoordinator.initialize(e),this.listComponent.render(),this.updateAndReportRenderedType(e)},o.prototype.updateListView=function(e,i){if(this.listCoordinator&&i){var o=this.currentList.getService(t.Services.enhancedPaginationService);o||(o=this.initializeEnhancedPagination(e),this.listCoordinator=new t.ListCoordinator(this.enhancedPagination?[this.enhancedPagination]:[],this.listComponent),this.listCoordinator.initialize(e)),this.listComponent.onRecordsDataInit||this.addListCommandListeners(e),this.isRendered=this.listCoordinator.handleDataSetUpdate(e,o)}else this.listComponent.needsReRender()&&this.listComponent.render();this.hostCommands.fireListEvents(e)},o.prototype.initializeEnhancedPagination=function(e){var i=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.parameters.enhancedPagingDisabled);if(i&&!e.parameters.enhancedPagingDisabled.raw||!i||e.parameters.UseDefaultCardFormForList&&e.parameters.UseDefaultCardFormForList.raw){var o=new t.EnhancedPagingService(this.listComponent,e.parameters.Grid,e.utils,new t.EnhancedPagingComponent(this.listComponent),this.perfTool);this.currentList.add(t.Services.enhancedPaginationService,o);var r=new t.EnhancedPagination(o,new t.EnhancedPagingComponent(this.listComponent));return r.initialize(e),this.enhancedPagination=r,o}return null},o.prototype.updateCore=function(e){try{this.perfTool.tryStop(t.GridPerformanceStopwatch.PagingLoad),this.perfTool.tryStop(t.GridPerformanceStopwatch.Sorting),this.perfTool.tryStop(t.GridPerformanceStopwatch.Filtering);var i=Mscrm.UpdateEvents.hasEvent(e.updatedProperties,Mscrm.UpdateEventType.Layout),o=!1,r=void 0,n=void 0;if(i){if(r=e.client.allocatedWidth,n=e.client.allocatedHeight,0===r&&0===n)return;var s=this.getViewType(e,r);s!=this.currentViewType&&(this.destroyCore(),this.initCoreInternal(e),o=!0)}this.currentViewType===t.ViewType.List?this.updateCoreList(e,o):this.currentViewType==t.ViewType.Grid&&this.updateCoreGrid(e,i,o,r,n)}catch(a){var l=new Array;throw l.push({name:"updatedProperties",value:e.updatedProperties.join(",")}),this.gridTelemetry.reportFailure("updateCore",a,null,l),a}},o.prototype.onPreNavigation=function(){this.currentGrid.gridComponent.finishEdit();var e=this.currentGrid.getService(t.Services.dataSetService);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.dataSet)){var i=e.dataSet.getSelectedRecord();!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&i.isRecordValid()&&e.beginRecordSave()}},o.prototype.getOutputsCore=function(){var e=this.currentGrid.getAllCurrentRecords();return e},o.prototype.destroyCore=function(){try{this.isControlInitialized&&(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridCoordinator)||(this.gridCoordinator.dispose(),this.gridCoordinator=null),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.currentGrid)||(this.currentGrid.dispose(),this.currentGrid=null),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.criticalRegionService)||(this.criticalRegionService.dispose(),this.criticalRegionService=null),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.listCoordinator)||(this.listCoordinator.dispose(),this.listCoordinator=null),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.currentList)||(this.currentList.dispose(),this.currentList=null),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.listComponent)||this.listComponent.destroy(),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.perfTool)||(this.perfTool.dispose(),this.perfTool=null))}catch(e){throw this.gridTelemetry.reportFailure("destroyCore",e),e}finally{MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridTelemetry)||(this.gridTelemetry.dispose(),this.gridTelemetry=null)}},o.prototype.initCoreInternal=function(e,i){var o=this;try{this.gridTelemetry=new t.GridTelemetry(e.reporting),this.gridTelemetry.setDefaultEventParams(e.parameters),this.perfTool=new t.GridPerformance,this.perfTool.initialize(function(t){return e.utils.createPerformanceStopwatch(t)}),this.perfTool.tryStart(t.GridPerformanceStopwatch.InitToRendered);var r=e.client.allocatedWidth;if(this.currentViewType=this.getViewType(e,r),this.perfTool.tryStart(t.GridPerformanceStopwatch.InitGrid),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.hostCommands)&&(this.hostCommands=new t.HostCommands),t.GridLocale.initialize(function(t){return e.resources.getString(t)}),this.currentViewType!=t.ViewType.List){t.FilteringLocale.initialize(function(t){return e.resources.getString(t)}),MscrmCommon.ControlUtils.WijmoGlobalization.setCrmNumberFormatting(e.formatting),MscrmCommon.ControlUtils.WijmoGlobalization.setWijmoNumberFormatStructure(e.client.numberFormattingInfo,MscrmCommon.Globalization.CrmNumberType.CrmDecimalTypeName,!1,null);var n=new t.WijmoGridControlFactory(this.perfTool,this.gridTelemetry,e.client.userAgent);this.criticalRegionService=n.buildCriticalRegionService();var s=e.parameters,a=s.Grid,l=s.useSkypeProtocol,c=e.mode.isOffline?t.EnableEditing.No:t.GridUtils.parsePropertyOrDefault(e.parameters.EnableEditing,t.EnableEditingUtil.parseValue,t.EnableEditing.Yes),d=c==t.EnableEditing.Yes,u=d?t.GridUtils.parsePropertyOrDefault(e.parameters.EnableGroupBy,t.EnableGroupByUtil.parseValue,t.EnableGroupBy.Yes):t.EnableGroupBy.No,m=d?t.GridUtils.parsePropertyOrDefault(e.parameters.EnableFiltering,t.EnableFilteringUtil.parseValue,t.EnableFiltering.Yes):t.EnableFiltering.No,p=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.parameters.enhancedPagingDisabled),h=!!p&&!e.parameters.enhancedPagingDisabled.raw,g=n.create(e,i,this.notifyOutputChanged).withPagination(h||d).withKeyboardNavigation().withAriaLiveRegion().withSorting().withEditing(c).withFiltering(m).withGrouping(u).withSubGrid(function(t){return t.create(e,i,o.notifyOutputChanged).withEditing(c).withFiltering(m).withSorting().withPagination(h||d).withKeyboardNavigation().withAriaLiveRegion()});c!==t.EnableEditing.Yes&&g.withFieldTypeColumns(l);var f=g.build(this.container,a,!1,this.criticalRegionService,this.perfTool);this.currentGrid=f;var C=f.getService(t.Services.dataAdapter),v=f.getService(t.Services.stateService),y=f.getService(t.Services.dataSetService),S=f.getService(t.Services.errorHandlingService);this.gridCoordinator=new t.GridCoordinator(f.gridFeatures,f.gridComponent,C,v,y,this.criticalRegionService,S,this.perfTool),this.gridCoordinator.initialize(e),this.updateAndReportRenderedType(e)}else this.initializeListView(e);this.container.setAttribute(t.GridConstants.role,"presentation"),this.perfTool.tryStop(t.GridPerformanceStopwatch.InitGrid)}catch(b){throw this.gridTelemetry.reportFailure("initCoreInternal",b),b}},o.prototype.updateCoreList=function(e,i){if(!e.parameters.Grid.working){this.currentList||this.initializeListView(e);var o=e.parameters.isNewPageRequested&&e.parameters.isNewPageRequested.raw,r=i||t.GridUtils.shouldRender(e.updatedProperties)||o||e.parameters.Grid.hasError;return t.GridUtils.isPopUpRootNodeEvent(e.updatedProperties)||t.GridUtils.isForcedUpdate?(t.GridUtils.isForcedUpdate=!1,void this.listComponent.render()):void this.updateListView(e,r)}},o.prototype.updateCoreGrid=function(e,i,o,r,n){this.currentGrid||this.initCore(e),this.hostCommands.fireGridEvents(e);var s=e.mode.isOffline,a=this.currentGrid.gridComponent;a.isEditable=a.isEditable&&!s,this.gridCoordinator.notifyAboutOfflineMode(s);var l=this.currentGrid.getService(t.Services.containerService),c=this.currentGrid&&this.currentGrid.getService(t.Services.enhancedPaginationService),d=i&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(a.activeEditor);d&&(d=l.resizeControl(n,r,t.GridUtils.isEditableGridOnLegacyClient(a.isEditable)));var u=!a.isEditable&&d,m=this.currentGrid.getService(t.Services.dataSetService);m&&t.GridUtils.containsKey(e.updatedProperties,t.GridConstants.propertyKeyGrid)&&(m.dataSet=e.parameters.Grid);var p=e.parameters.isNewPageRequested&&e.parameters.isNewPageRequested.raw;(u||o||t.GridUtils.shouldRender(e.updatedProperties)||p||!this.isRendered&&!e.parameters.Grid.working)&&(this.isRendered=this.gridCoordinator.handleDataSetUpdate(e.mode.isVisible||e.mode.isActive,e.parameters,!1,c)),c&&c.shouldRestoreScrollPosition&&(a.refresh(),c.restoreScrollPosition());var h=a.isEditable&&t.GridUtils.isPhone(e.client.getFormFactor());(d||h)&&(a.isEditable&&(this.gridCoordinator.handleSizeChange(e.parameters),this.reflowEditableGridColumns(e,h)),a.refresh()),e.decorators&&e.decorators.ClassName&&(a.gridRoot.className&&-1!==a.gridRoot.className.indexOf(e.decorators.ClassName)||(a.gridRoot.className||(a.gridRoot.className=""),a.gridRoot.className+=" "+e.decorators.ClassName))},o.prototype.getViewType=function(e,i){var o=e.mode.isOffline?t.EnableEditing.No:t.GridUtils.parsePropertyOrDefault(e.parameters.EnableEditing,t.EnableEditingUtil.parseValue,t.EnableEditing.Yes),r=t.GridUtils.parsePropertyOrDefault(e.parameters.ReflowBehavior,t.ReflowBehaviorUtil.parseValue,o===t.EnableEditing.Yes?t.ReflowBehavior.GridOnly:t.ReflowBehavior.Reflow);return t.GridUtils.determineViewType(o===t.EnableEditing.Yes,r,i)},o.prototype.reflowEditableGridColumns=function(e,i){if(e.parameters.Grid.columns.length>t.GridConstants.maxNumberOfColumnsOnSmallScreen){var o=e.parameters.Grid.columns.slice(t.GridConstants.maxNumberOfColumnsOnSmallScreen).map(function(e){return e.name});this.currentGrid.gridComponent.hideColumns(o,i)}},o.prototype.updateAndReportRenderedType=function(i){this.container.setAttribute(t.GridConstants.dataType,e.Grid.ViewType[this.currentViewType]);var o=i.mode.isOffline?t.EnableEditing.No:t.GridUtils.parsePropertyOrDefault(i.parameters.EnableEditing,t.EnableEditingUtil.parseValue,t.EnableEditing.Yes),r=[{name:t.GridConstants.gridDataType,value:e.Grid.ViewType[this.currentViewType]},{name:t.GridConstants.eventDescription,value:t.GridConstants.gridRenderingMessage+e.Grid.ViewType[this.currentViewType]},{name:t.GridConstants.gridViewId,value:i.parameters.Grid.getViewId()},{name:t.GridConstants.gridLoadType,value:o===t.EnableEditing.Yes?t.GridConstants.editableGrid:t.GridConstants.readonlyGrid}];this.gridTelemetry.reportEvent(t.GridConstants.loadEvent,r)},o.prototype.addListCommandListeners=function(e){var i=this,o=this.listComponent.getListSortingPopup();this.listComponent.onRecordsDataInit=function(r){i.hostCommands.disposeCommands(t.ViewType.List),r.sortedRecordIds.length&&(i.hostCommands.addCommandListener(t.ViewType.List,t.GridLocale.commandBarSelectIconText,t.SELECT_COMMAND_ID,i.listComponent.OnSelectionModeChanged.bind(i.listComponent),e.client.isRTL?"SelectButtonRTL":"SelectButton",t.GridLocale.commandBarSelectToolTipText),i.hostCommands.addCommandListener(t.ViewType.List,t.GridLocale.commandBarSortIconText,o.getSortButtonId(),o.renderSortingPopup.bind(o),"SortButton",t.GridLocale.commandBarSortToolTipText))}},o}(MscrmCommon.CommonControl);t.SharedGrid=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return Object.defineProperty(e.prototype,"isTreeView",{get:function(){return this._isTreeView},set:function(e){this._isTreeView=e,this._isGroupByEnabled=!e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGroupByEnabled",{get:function(){return this._isGroupByEnabled},set:function(e){this._isGroupByEnabled=e,this._isTreeView=!e},enumerable:!0,configurable:!0}),e}();e.GridControlState=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.initialize=function(i){t.filterAscendingLabel=i(e.LabelId.gridFilteringAscending),t.filterDescendingLabel=i(e.LabelId.gridFilteringDescending),t.filterApplyLabel=i(e.LabelId.gridFilteringApply),t.filterClearLabel=i(e.LabelId.gridFilteringClear),t.filterByConditionLabel=i(e.LabelId.gridFilteringCondition),t.filterByValueLabel=i(e.LabelId.gridFilteringValue),t.valueFilterSearchLabel=i(e.LabelId.gridFilteringValueFilterSearch),t.valueFilterSelectAllLabel=i(e.LabelId.gridFilteringValueFilterSelectAll),t.valueFilterNullLabel=i(e.LabelId.gridFilteringValueFilterNull),t.conditionFilterHeaderLabel=i(e.LabelId.gridFilteringConditionFilterHeader),t.conditionFilterAndLabel=i(e.LabelId.gridFilteringConditionFilterAnd),t.conditionFilterOrLabel=i(e.LabelId.gridFilteringConditionFilterOr),t.conditionFilterOperatorNotSetLabel=i(e.LabelId.gridFilteringConditionFilterOperatorNotSet),t.conditionFilterOperatorEqualsLabel=i(e.LabelId.gridFilteringConditionFilterOperatorEquals),t.conditionFilterOperatorDoesNotEqualLabel=i(e.LabelId.gridFilteringConditionFilterOperatorDoesNotEqual),t.conditionFilterOperatorBeginsWithLabel=i(e.LabelId.gridFilteringConditionFilterOperatorBeginsWith),t.conditionFilterOperatorEndsWithLabel=i(e.LabelId.gridFilteringConditionFilterOperatorEndsWith),t.conditionFilterOperatorContainsLabel=i(e.LabelId.gridFilteringConditionFilterOperatorContains),t.conditionFilterOperatorDoesNotContainLabel=i(e.LabelId.gridFilteringConditionFilterOperatorDoesNotContain),t.conditionFilterOperatorGreaterLabel=i(e.LabelId.gridFilteringConditionFilterOperatorGreater),
t.conditionFilterOperatorGreaterOrEqualLabel=i(e.LabelId.gridFilteringConditionFilterOperatorGreaterOrEqual),t.conditionFilterOperatorLessLabel=i(e.LabelId.gridFilteringConditionFilterOperatorLess),t.conditionFilterOperatorLessOrEqualLabel=i(e.LabelId.gridFilteringConditionFilterOperatorLessOrEqual),t.conditionFilterOperatorIsBeforeLabel=i(e.LabelId.gridFilteringConditionFilterOperatorIsBefore),t.conditionFilterOperatorIsAfterLabel=i(e.LabelId.gridFilteringConditionFilterOperatorIsAfter)},t}();e.FilteringLocale=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.editableGridAria="CC_Grid_Name",e.commandBarFlyoutOpenButton="Command_Bar_Flyout_Open_Button",e.commandBarSortIconText="Command_Bar_Sort_Icon_Text",e.commandBarSortToolTipText="Command_Bar_Sort_Tool_Tip_Text",e.commandBarSelectIconText="Command_Bar_Select_Icon_Text",e.commandBarSelectToolTipText="Command_Bar_Select_Tool_Tip_Text",e.emptyCellAria="CustomControl_Grid_Aria_Empty_Cell",e.cellTemplateAria="CustomControl_Grid_Aria_Cell_Template",e.groupByMenuHeader="CustomControl_Grid_GroupBy_MenuHeader",e.chooseColumnsMenuHeader="CustomControl_Grid_ChooseColumns_MenuHeader",e.groupByItemsCount="CustomControl_Grid_GroupBy_Items",e.noGroupingOption="CustomControl_Grid_NoGrouping",e.firstPageTooltip="CustomControl_Grid_Paging_First",e.nextPageTooltip="CustomControl_Grid_Paging_Next",e.currentPageTooltip="CustomControl_Grid_Paging_Current",e.currentPagingMask="Grid_Paging_Mask",e.previousPageTooltip="CustomControl_Grid_Paging_Previous",e.accessibilityStartEditingInstruction="CustomControl_Grid_Accessibility_StartEditingInstruction",e.rollupFieldLastUpdatedLabel="RollupFieldLastUpdatedLabel",e.durationHoursText="L_DurationScrollerItem.Hours_Text",e.durationMinutesText="L_DurationScrollerItem.Minutes_Text",e.durationDaysText="L_DurationScrollerItem.Days_Text",e.durationHourText="L_DurationScrollerItem.Hour_Text",e.durationMinuteText="L_DurationScrollerItem.Minute_Text",e.durationDayText="L_DurationScrollerItem.Day_Text",e.noRecordsText="L_List_No_Records_Text",e.jumpBarButtonText="JumpBar_Button_Text",e.enableLookupFilter="CustomControl_Grid_Lookup_Enable_Filter",e.disableLookupFilter="CustomControl_Grid_Lookup_Disable_Filter",e.gridFilteringAscending="CustomControl_Grid_Filtering_Ascending",e.gridFilteringDescending="CustomControl_Grid_Filtering_Descending",e.gridFilteringApply="CustomControl_Grid_Filtering_Apply",e.gridFilteringClear="CustomControl_Grid_Filtering_Clear",e.gridFilteringCondition="CustomControl_Grid_Filtering_Condition",e.gridFilteringValue="CustomControl_Grid_Filtering_Value",e.gridFilteringValueFilterSearch="CustomControl_Grid_Filtering_ValueFilter_Search",e.gridFilteringValueFilterSelectAll="CustomControl_Grid_Filtering_ValueFilter_SelectAll",e.gridFilteringValueFilterNull="CustomControl_Grid_Filtering_ValueFilter_Null",e.gridFilteringConditionFilterHeader="CustomControl_Grid_Filtering_ConditionFilter_Header",e.gridFilteringConditionFilterAnd="CustomControl_Grid_Filtering_ConditionFilter_And",e.gridFilteringConditionFilterOr="CustomControl_Grid_Filtering_ConditionFilter_Or",e.gridFilteringConditionFilterOperatorNotSet="CustomControl_Grid_Filtering_ConditionOperator_NotSet",e.gridFilteringConditionFilterOperatorEquals="CustomControl_Grid_Filtering_ConditionOperator_Equals",e.gridFilteringConditionFilterOperatorDoesNotEqual="CustomControl_Grid_Filtering_ConditionOperator_DoesNotEqual",e.gridFilteringConditionFilterOperatorBeginsWith="CustomControl_Grid_Filtering_ConditionOperator_BeginsWith",e.gridFilteringConditionFilterOperatorEndsWith="CustomControl_Grid_Filtering_ConditionOperator_EndsWith",e.gridFilteringConditionFilterOperatorContains="CustomControl_Grid_Filtering_ConditionOperator_Contains",e.gridFilteringConditionFilterOperatorDoesNotContain="CustomControl_Grid_Filtering_ConditionOperator_DoesNotContain",e.gridFilteringConditionFilterOperatorGreater="CustomControl_Grid_Filtering_ConditionOperator_Greater",e.gridFilteringConditionFilterOperatorGreaterOrEqual="CustomControl_Grid_Filtering_ConditionOperator_GreaterOrEqual",e.gridFilteringConditionFilterOperatorLess="CustomControl_Grid_Filtering_ConditionOperator_Less",e.gridFilteringConditionFilterOperatorLessOrEqual="CustomControl_Grid_Filtering_ConditionOperator_LessOrEqual",e.gridFilteringConditionFilterOperatorIsBefore="CustomControl_Grid_Filtering_ConditionOperator_IsBefore",e.gridFilteringConditionFilterOperatorIsAfter="CustomControl_Grid_Filtering_ConditionOperator_IsAfter",e.saveButtonLabel="L_Save_Text",e.selectAllButtonLabel="GridControl_SelectAll",e.selectAllButtonAccessibilityLabel="GridControl_SelectAllRows",e.refreshButtonLabel="MenuItem_Label_Refresh",e.unsavedStatusLabel="UnSavedChangesWarning",e.savingStatusLabel="SavingInformation",e.refreshStatusLabel="Grid.Loading.Data.Refresh",e.genericUpdateErrorLabel="Form_Component_Error",e.rowNavigationButtonTooltip="CustomControl_Grid_RowNavigation_Button_Tooltip",e.rowNavigationButtonTooltipSpecific="CustomControl_Grid_RowNavigation_Button_Tooltip_Specific",e.rowDeleteButtonTooltip="CustomControl_Grid_RowDelete_Button_Tooltip",e.multiPicklistNoItemsLabel="MultiSelectPicklistControl_NotItemsAvailable",e.multiPicklistSelectAllLabel="MultiSelectPicklistControl_SelectAll",e.multiPicklistTypeAheadLabel="MultiSelectPicklistControl_TypeAheadSearchText",e.multiPicklistMoreLabel="MultiSelectPicklistControl_More",e.multiPicklistLessLabel="MultiSelectPicklistControl_Less",e.multiPicklistItemsLabel="MultiSelectPicklistControl_Screenreader_OptionSetItem_AriaLabel",e.multiPicklistInputLabel="MultiSelectPicklistControl_Screenreader_TypeSomethingInput_AriaLabel",e.multiPicklistListNavigationLabel="MultiSelectPicklistControl_Screenreader_SelectedItemsList_Navigation",e.multiPicklistItemsRemovedLabel="MultiSelectPicklistControl_Screenreader_DisplayItems_Removed",e.multiPicklistMoreLinkTitle="MultiSelectPicklistControl_Screenreader_More_Title",e.multiPicklistLessLinkTitle="MultiSelectPicklistControl_Screenreader_Less_Title",e.multiPicklistSelectAllFocusTitle="MultiSelectPicklistControl_Screenreader_SelectAll_Title",e.multiPicklistSelectAllDeselect="MultiSelectPicklistControl_Screenreader_SelectAll_Deselect",e.multiPicklistSelectAllSelect="MultiSelectPicklistControl_Screenreader_SelectAll_Select",e.multiPicklistTotalItems="MultiSelectPicklistControl_Screenreader_TotalItems",e.multiPicklistDeleteTitle="MultiSelectPicklistControl_DeleteItem_Title",e.sortByColumnName="Grid_ToolTip_SortBy",e.sortedByColumnName="Grid_ToolTip_SortedBy",e.streamFiltered="Stream_Filtered",e.streamUnfiltered="Stream_Unfiltered",e.columnFiltered="AppliedFilters_ScreenReader_Label",e.columnUnfiltered="GridFilters_NoFilterAppliedTextForTooltip",e.streamBulkOperations="Stream_HeaderCommandBarMultiSelectIcon_Label",e.closeButton="closeButton",e.streamSortAscending="Stream_HeaderSortButton_Label_Ascending",e.streamSortDescending="Stream_HeaderSortButton_Label_Descending",e.gridRowText="Grid_Row_Text",e.gridHeaderRowText="Grid_Header_Row_Text",e.gridDataRowText="Grid_Data_Row_Text",e.listCardExpandText="ListCard_Expand_Text",e.listCardCollapseText="ListCard_Collapse_Text",e.closeSortPopupButtonText="Close_Sort_Popup_Button_Text",e}();e.LabelId=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r,n,s,a,l){var c=this;this.refreshDataSet=function(e,t){c.refreshDataSetHandler(e,t)},this.onCollectionOrLayoutChangedEventHandler=function(e,t){c.stateService.saveState(c.gridComponent)},this.onEnteringCriticalRegion=function(e,t){for(var i=0,o=c.features;i<o.length;i++){var r=o[i];r.enteringCriticalRegion()}},this.onSavingEventHandler=function(t,i){c.gridComponent.updateStatusArea(e.StatusUpdateType.Saving);for(var o=0,r=c.features;o<r.length;o++){var n=r[o];n.saving(i)}},this.onSavedEventHandler=function(t,i){i.isRecordSavedSuccessfully&&!i.moreItemsInQueue&&c.gridComponent.updateStatusArea(e.StatusUpdateType.Saved);for(var o=0,r=c.features;o<r.length;o++){var n=r[o];n.saved(i)}},this.onErrorEventHandler=function(t,i){i.gridHasDirtyRecord&&c.gridComponent.updateStatusArea(e.StatusUpdateType.Unsaved);for(var o=0,r=c.features;o<r.length;o++){var n=r[o];n.onError(i)}},this.onLeftCriticalRegion=function(e,t){for(var i=0,o=c.features;i<o.length;i++){var r=o[i];r.leftCriticalRegion()}},this.features=t,this.gridComponent=i,this.dataAdapter=o,this.stateService=r,this.dataSetService=n,this.criticalRegion=s,this.errorHandlingService=a,this.perfTool=l}return t.prototype.initialize=function(e){this.context=e,this.isStateRestored=!1,this.subscribeForGridEvents(),this.initializeFeatures(e),this.registerToCriticalRegion(),this.stateService.setServerLayout(this.gridComponent.columnLayout)},t.prototype.notifyAboutOfflineMode=function(e){void 0===e&&(e=!1);for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.networkStatusChanged(e)}},t.prototype.handleDataSetUpdate=function(t,i,o,r){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.currentDataSetUpdateHandler))return this.currentDataSetUpdateHandler.handleDataSetUpdate(t,i)&&(this.currentDataSetUpdateHandler=null),!1;if(!t)return!1;if(i.Grid.working)return!1;var n=this.getDataSet(i);if(this.dataSetService.dataSet=n,r){r.setDataSet(n),r.resetPreviousRecords();var s=i.isNewPageRequested&&i.isNewPageRequested.raw&&!r.didPerformBumpNext()&&!r.didPerformBumpPrevious()?i.gridPageNumber.raw:null;r.setNextPage(s)}if(r&&(r.didPerformBumpPrevious()||r.didPerformBumpNext()||r.isPageNumberChanged())){var a=this.dataAdapter.getGridRecordItems(n).sourceCollection;return r.appendNewRecords(n.paging,a.map(function(e){return e.recId})),!1}r&&r.reset(),this.errorHandlingService.clearTroubledRecords(),n.hasError?(o=!0,this.errorHandlingService.showUpdateError(n.errorMessage)):this.errorHandlingService.clearUpdateError(),this.perfTool.tryStart(e.GridPerformanceStopwatch.ProcessDataSetRecords);var l=this.dataAdapter.getGridRecordItems(n);this.perfTool.tryStop(e.GridPerformanceStopwatch.ProcessDataSetRecords);var c=new e.GridRenderingEventArgs(n,l);this.onRendering(c);var d=this.stateService.restoreState(this.gridComponent)||this.stateService.isStateEmpty();return!d||this.isStateRestored||o?(this.onStateRestored(c),this.criticalRegion.onDataSetRefresh(),this.gridComponent.updateStatusArea(e.StatusUpdateType.Clear),this.gridComponent.render(l),this.onRendered(c),n.clearSelectedRecord(),this.gridComponent.selectedRows=[],this.gridComponent.cancelSelection(),this.perfTool.tryStop(e.GridPerformanceStopwatch.InitToRendered),!0):(this.refreshDataSetHandler(this,e.GridDataSetOperationRequestedArgs.getRefreshCurrentDataSetArgs()),this.isStateRestored=!0,!1)},t.prototype.handleSizeChange=function(t){var i=this.getDataSet(t),o=new e.GridRenderingEventArgs(i,this.dataAdapter.getGridRecordItems(i));this.onSizeChange(o)},t.prototype.registerToCriticalRegion=function(){this.coordinatorId=MscrmCommon.ControlUtils.ControlGuidGenerator.newGuid("GridCoordinator"),this.criticalRegion.register(this.coordinatorId,this.dataSetService,this.errorHandlingService,this.gridComponent),this.criticalRegion.enteringCriticalRegion.addHandler(this.onEnteringCriticalRegion),this.criticalRegion.leftCriticalRegion.addHandler(this.onLeftCriticalRegion)},t.prototype.unregisterFromCriticalRegion=function(){this.criticalRegion.unregister(this.coordinatorId),this.criticalRegion.enteringCriticalRegion.removeHandler(this.onEnteringCriticalRegion),this.criticalRegion.leftCriticalRegion.removeHandler(this.onLeftCriticalRegion)},t.prototype.subscribeForGridEvents=function(){this.gridComponent.collectionChanged.addHandler(this.onCollectionOrLayoutChangedEventHandler),this.gridComponent.columnResized.addHandler(this.onCollectionOrLayoutChangedEventHandler),this.dataSetService.saving.addHandler(this.onSavingEventHandler),this.dataSetService.saved.addHandler(this.onSavedEventHandler),this.dataSetService.gridError.addHandler(this.onErrorEventHandler)},t.prototype.initializeFeatures=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.refreshRequested.addHandler(this.refreshDataSet),o.initialize(e),o.hasState()&&this.stateService.register(o)}},t.prototype.refreshDataSetHandler=function(e,t){t.hasDedicatedHandler&&(this.currentDataSetUpdateHandler=t.handler),this.executeDataSetOperation(t.hasDataSet?t.gridDataSet:this.dataSetService.dataSet,t.operation)},t.prototype.getDataSet=function(e){return e.Grid},t.prototype.onRendering=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.rendering(e)}},t.prototype.onStateRestored=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.stateRestored(e)}},t.prototype.onSizeChange=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.sizeChange(e)}},t.prototype.onRendered=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.rendered(e)}},t.prototype.executeDataSetOperation=function(t,i){switch(this.dataSetService.beginRecordSave(),i){case e.DataSetOperation.Refresh:this.gridComponent.updateStatusArea(e.StatusUpdateType.Refresh),t.refresh();break;case e.DataSetOperation.LoadPreviousPage:t.paging.loadPreviousPage();break;case e.DataSetOperation.LoadNextPage:t.paging.loadNextPage();break;case e.DataSetOperation.LoadFirstPage:t.paging.hasPreviousPage&&t.paging.reset()}},t.prototype.unsubscribeFromGridEvents=function(){this.gridComponent.collectionChanged.removeHandler(this.onCollectionOrLayoutChangedEventHandler),this.gridComponent.columnResized.removeHandler(this.onCollectionOrLayoutChangedEventHandler),this.dataSetService.saving.removeHandler(this.onSavingEventHandler),this.dataSetService.saved.removeHandler(this.onSavedEventHandler),this.dataSetService.gridError.removeHandler(this.onErrorEventHandler)},t.prototype.dispose=function(){this.unsubscribeFromGridEvents(),this.unregisterFromCriticalRegion(),this.gridComponent=null,this.dataAdapter=null,this.currentDataSetUpdateHandler=null,this.removeFeatureHandlers(),this.features=null,this.stateService=null,this.criticalRegion=null,this.coordinatorId=null,this.perfTool=null},t.prototype.removeFeatureHandlers=function(){for(var e=0,t=this.features;e<t.length;e++){var i=t[e];i.refreshRequested.removeHandler(this.refreshDataSet)}},t}();e.GridCoordinator=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){var i=this;this.refreshDataSet=function(e,t){i.refreshDataSetHandler(e,t)},this.features=e,this.listComponent=t}return t.prototype.initialize=function(e){this.context=e,this.dataSet=this.getDataSet(e.parameters),this.initializeFeatures(e)},t.prototype.handleDataSetUpdate=function(e,t){var i=e.parameters.Grid;if(t){var o=e.parameters.isNewPageRequested&&e.parameters.isNewPageRequested.raw;t.setDataSet(i),t.resetPreviousRecords();var r=!o||t.didPerformBumpNext()||t.didPerformBumpPrevious()?null:e.parameters.gridPageNumber.raw;t.setNextPage(r)}if(t&&(t.didPerformBumpPrevious()||t.didPerformBumpNext()||t.isPageNumberChanged())){var n=[];for(var s in i.records)n.push(s);return t.appendNewRecords(i.paging,n),t.clearBumpScrollFlag(),!1}return this.listComponent.setContext(e),t&&t.reset(),this.listComponent.render(),!0},t.prototype.initializeFeatures=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.refreshRequested.addHandler(this.refreshDataSet),o.initialize(e)}},t.prototype.refreshDataSetHandler=function(e,t){t.hasDedicatedHandler&&(this.currentDataSetUpdateHandler=t.handler),this.executeDataSetOperation(t.hasDataSet?t.gridDataSet:this.dataSet,t.operation)},t.prototype.getDataSet=function(e){return e.Grid},t.prototype.onRendering=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.rendering(e)}},t.prototype.onStateRestored=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.stateRestored(e)}},t.prototype.onRendered=function(e){for(var t=0,i=this.features;t<i.length;t++){var o=i[t];o.rendered(e)}},t.prototype.executeDataSetOperation=function(t,i){switch(i){case e.DataSetOperation.Refresh:t.refresh();break;case e.DataSetOperation.LoadPreviousPage:t.paging.loadPreviousPage();break;case e.DataSetOperation.LoadNextPage:t.paging.loadNextPage();break;case e.DataSetOperation.LoadFirstPage:t.paging.hasPreviousPage&&t.paging.reset()}},t.prototype.dispose=function(){this.dataSet=null,this.currentDataSetUpdateHandler=null,this.removeFeatureHandlers(),this.features=null},t.prototype.removeFeatureHandlers=function(){for(var e=0,t=this.features;e<t.length;e++){var i=t[e];i.refreshRequested.removeHandler(this.refreshDataSet)}},t}();e.ListCoordinator=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.AdditionalAttributes=0]="AdditionalAttributes",e[e.PagingLoad=1]="PagingLoad",e[e.DataSetUpdate=2]="DataSetUpdate",e[e.FieldAccess=3]="FieldAccess",e[e.RetrieveLookup=4]="RetrieveLookup",e[e.InitGrid=5]="InitGrid",e[e.Filtering=6]="Filtering",e[e.Sorting=7]="Sorting",e[e.ProcessDataSetRecords=8]="ProcessDataSetRecords",e[e.InitToRendered=9]="InitToRendered"}(t=e.GridPerformanceStopwatch||(e.GridPerformanceStopwatch={})),function(e){function t(t){var i="CustomControl.Grid.";switch(t){case e.AdditionalAttributes:return i+"AdditionalAttributes";case e.PagingLoad:return i+"PagingLoad";case e.DataSetUpdate:return i+"DataSetUpdate";case e.FieldAccess:return i+"FieldAccess";case e.RetrieveLookup:return i+"RetrieveLookup";case e.InitGrid:return i+"InitGrid";case e.Filtering:return i+"Filtering";case e.Sorting:return i+"Sorting";case e.ProcessDataSetRecords:return i+"ProcessDataSetRecords";case e.InitToRendered:return i+"InitToRendered";default:return i+"Unknown"}}e.generateId=t}(t=e.GridPerformanceStopwatch||(e.GridPerformanceStopwatch={}));var i=function(){function e(){this.clientMetricsReported=!1}return e.prototype.initialize=function(e){this.createPerformanceStopwatch=e,this.stopwatches={}},e.prototype.getStopwatch=function(e){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.createPerformanceStopwatch))throw new Error("Error: createPerformanceStopwatch function is not defined correctly. Please call GridPerformance.getInstance().initialize() first.");var i=t.generateId(e);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.stopwatches[i])&&(this.stopwatches[i]=new o(this.createPerformanceStopwatch(i))),this.stopwatches[i]},e.prototype.tryStart=function(e){try{var t=this.getStopwatch(e);t.isRunning||t.start()}catch(i){}},e.prototype.tryStop=function(e){try{var t=this.getStopwatch(e);t.isRunning&&t.stop()}catch(i){}},e.prototype.collectAndReportClientMetrics=function(){this.clientMetricsReported||MscrmCommon.ControlUtils.Object.isNullOrUndefined(Mscrm.MetricsCollector)||(Mscrm.MetricsCollector.collectAndReportClientMetrics(1),this.clientMetricsReported=!0)},e.prototype.dispose=function(){this.createPerformanceStopwatch=null,this.stopwatches=null},e}();e.GridPerformance=i;var o=function(){function e(e){this.perfStopWatch=e,this.isRunning=!1}return e.prototype.start=function(){this.perfStopWatch.start(),this.isRunning=!0},e.prototype.stop=function(){this.perfStopWatch.stop(),this.isRunning=!1},e.prototype.dispose=function(){this.perfStopWatch=null},e}();e.PerformanceStopwatchAdaptor=o}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o,r,n,s,a,l,c,d){var u=t.call(this,i,o,r,n,s,a,l,d)||this;return u.parentGridComponent=e,u.refreshDataSetCallback=c,u}return __extends(i,t),i.prototype.initialize=function(e){this.inputBag=e.parameters,t.prototype.initialize.call(this,e)},i.prototype.showSubGrid=function(i){var o=i.dataItem.recId.toLowerCase();return o!==e.GridUtils.getSubGridFilterValue(this.dataSetService.dataSet)?(this.currentRow=i,e.GridUtils.replaceSubGridFilterValue(this.dataSetService.dataSet,o),void this.refreshCurrentDataSet()):(t.prototype.handleDataSetUpdate.call(this,!0,this.getSubGridBag(),!0),this.gridComponent.gridHostingElement)},i.prototype.handleDataSetUpdate=function(e,i){var o=this.getDataSet(i);return this.dataSetService.dataSet=o,!o.working&&(t.prototype.handleDataSetUpdate.call(this,e,i,!0),this.gridComponent.refresh(),null!=this.currentRow&&this.parentGridComponent.showDetailGrid(this.currentRow),!0)},i.prototype.refreshDataSetHandler=function(t,i){this.refreshDataSetCallback(new e.GridDataSetOperationRequestedArgs(this.dataSetService.dataSet,this,!1,i.operation))},i.prototype.refreshCurrentDataSet=function(){this.refreshDataSetCallback(new e.GridDataSetOperationRequestedArgs(this.dataSetService.dataSet,this))},i.prototype.getDataSet=function(e){return e.SubGrid},i.prototype.getSubGridBag=function(){return{EnableGroupBy:this.inputBag.EnableGroupBy,EnableEditing:this.inputBag.EnableEditing,EnableFiltering:this.inputBag.EnableFiltering,ReflowBehavior:this.inputBag.ReflowBehavior,Grid:this.inputBag.SubGrid,SubGrid:this.inputBag.SubGrid,HideNestedGridColumnHeader:this.inputBag.HideNestedGridColumnHeader}},i.prototype.disposeGrid=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.currentGrid)||(null!==this.features&&this.removeFeatureHandlers(),this.currentGrid.dispose(),this.gridComponent=null,this.dataAdapter=null,this.features=null,this.currentGrid=null)},i.prototype.dispose=function(){this.disposeGrid(),t.prototype.dispose.call(this)},i}(e.GridCoordinator);e.SubGridCoordinator=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i){this.perfTool=e,this.gridTelemetry=t,this.userAgentInfo=i}return t.prototype.buildEnhancedPagingService=function(t,i,o){return new e.EnhancedPagingService(t,i,this.utils,o,this.perfTool)},t.prototype.buildEnhancedPagingComponent=function(t){return new e.EnhancedPagingComponent(t)},t.prototype.buildGridPagingService=function(t,i,o){var r=new e.PagingService(t,i,o,this.perfTool);return r},t.prototype.buildPagingComponent=function(t,i){var o=t.previousPageButton,r=t.nextPageButton,n=t.firstPageButton,s=t.currentPageElement;return new e.PagingComponent(n,o,s,r,i)},t.prototype.buildGridGroupingService=function(t,i,o){return new e.GroupingService(t,i,o)},t.prototype.buildGroupingComponent=function(t,i,o,r){return new e.GroupingComponent(t,i,o.columns,r)},t.prototype.buildFieldFactory=function(t,i,o,r){var n=new e.FieldFactory(t,i,o,r,this.communicationChannel);return this.hasFieldTypeColumns?n:n.withDefaultField()},t.prototype.buildFieldAccessComponent=function(t){return new e.WijmoFieldAccessComponent(t)},t.prototype.buildTypeProcessorService=function(t,i,o){return new e.WijmoTypeProcessorService(t,this.client,this.gridTelemetry,i,o)},t.prototype.buildTimeZoneService=function(t){return new e.TimeZoneService(t)},t.prototype.buildContainerService=function(t,i,o,r,n){var s=MscrmCommon.ControlUtils.ControlGuidGenerator.newGuid("Grid");return new e.ContainerService(s,t,i,o,this.hasGrouping,r,this.client,n)},t.prototype.buildWijmoGridComponent=function(e,t,i,o,r,n,s,a,l,c,d){return this.buildItemViewComponent(e,t,i,o,r,n,s,a,l,c,d)},t.prototype.buildErrorHandlingService=function(t,i,o){return new e.ErrorHandlingService(t,i,o,this.htmlEncode,this.isEditable)},t.prototype.buildLoggingService=function(){return new e.LoggingService(this.log)},t.prototype.buildDataAdapterService=function(t,i,o){return new e.WijmoDataAdapterService(t,i,o,this.communicationChannel)},t.prototype.buildNavigationService=function(t,i,o,r,n,s,a){return new e.NavigationService(t,i,o,r,n,s,a)},t.prototype.buildFieldAccessService=function(t){return new e.FieldAccessService(t,this.perfTool)},t.prototype.buildSelectionService=function(t){return e.GridUtils.supportMultiSelection(this.client.formFactor)?new e.MultiSelectionService(t):new e.SingleSelectionService(t)},t.prototype.buildStateService=function(t,i){return new e.WijmoStateService(t,i)},t.prototype.buildSortingService=function(t,i){return new e.SortingService(t,i,this.perfTool)},t.prototype.buildFilteringService=function(t,i,o){return new e.FilteringService(t,i,o,this.perfTool)},t.prototype.buildDataSetService=function(t,i,o){return new e.DataSetService(t,i,o,this.perfTool,this.gridTelemetry)},t.prototype.buildFilteringContext=function(t,i){return new e.FilteringContext(t,i)},t.prototype.buildAriaLiveRegionComponent=function(t){return new e.AriaLiveRegionComponent(t)},t.prototype.buildAriaLiveRegionService=function(t,i,o){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)?new e.BaseAriaLiveRegionService:new e.AriaLiveRegionService(o,t,i)},t.prototype.buildCriticalRegionService=function(){return new e.CriticalRegionService},t.prototype.create=function(t,i,o){return this.resetIncludedFeatures(),this.saveStateCallback=t.utils.setState.bind(t.utils),this.notifyOutputChanged=o,this.log=t.utils.log.bind(t.utils),this.state=i,this.client=t.client,this.utils=t.utils,this.formatting=t.formatting,this.htmlEncode=t.utils.crmHtmlEncode.bind(t.utils),this.navigation=t.navigation,this.mode=t.mode,this.theming=t.theming,this.learningPathBag=t.learningPath,this.webAPI=t.webAPI,this.communicationChannel=t.communicationChannel,this.factory=t.factory,this.reporting=t.reporting,this.offline=t.offline,!e.GridUtils.isUci()&&this.client&&e.GridUtils.isDesktop(this.client.formFactor)&&(e.WijmoConstants.defaultMinRowHeight=e.WijmoConstants.defaultMinRowHeightWeb),this},t.prototype.withFiltering=function(t){return this.hasFiltering=t==e.EnableFiltering.Yes,this},t.prototype.withSorting=function(){return this.hasSorting=!0,this},t.prototype.withPagination=function(e){return void 0===e&&(e=!0),this.hasPagination=e,this},t.prototype.withGrouping=function(t){return this.hasGrouping=t==e.EnableGroupBy.Yes,this},t.prototype.withEditing=function(t){return this.isEditable=t==e.EnableEditing.Yes,this},t.prototype.withSubGrid=function(e){return this.subGridBuilder=e(new t(this.perfTool,this.gridTelemetry,this.userAgentInfo)),this.hasSubGrid=!0,this},t.prototype.withKeyboardNavigation=function(){return this.hasKeyboardNavigation=!0,this},t.prototype.withAriaLiveRegion=function(){return this.hasAriaLiveRegion=!0,this},t.prototype.withFieldTypeColumns=function(e){return this.useSkypeProtocol=e,this.hasFieldTypeColumns=!0,this},t.prototype.build=function(t,i,o,r,n,s){var a=this;void 0===n&&(n=null),void 0===s&&(s=e.HideNestedGridColumnHeader.No),e.MicrosoftWijmoPatches.apply(this.client.userAgent),e.GridUtils.isDetail=o;var l=!0,c=[],d=new e.GridCompositionRoot,u=this.buildTimeZoneService(this.client.getUserTimeZoneUtcOffset.bind(this.client));u.formatTime=function(e,t){return a.formatting.formatTime(e,t)},u.formatDateShort=function(e,t){return a.formatting.formatDateShort(e,t)};var m=new e.LearningPathService(this.learningPathBag),p=this.buildContainerService(e.GridUtils.getGridState(i),this.client.allocatedWidth,this.client.allocatedHeight,t,m),h=this.buildLoggingService(),g=this.buildDataSetService(h,i,this.notifyOutputChanged),f=e.GridUtils.isUci()?g.getTargetEntityType():null,C=this.buildTypeProcessorService(u,this.utils.isFeatureEnabled("AllowMsosEditingInGrid"),f),v=this.hasAriaLiveRegion?this.buildAriaLiveRegionComponent(p.getContainerId()):null,y=this.buildAriaLiveRegionService(g,C,v),S=this.buildErrorHandlingService(p,g,y),b=this.buildDataAdapterService(h,C,S);!e.GridUtils.isUci()||!o||MscrmCommon.ControlUtils.Object.isNullOrUndefined(g)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(g.dataSet)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(g.dataSet.paging)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(g.dataSet.paging.pageSize)||g.dataSet.paging.hasNextPage||g.dataSet.paging.hasPreviousPage||(l=!1),p.build(o,this.isEditable,l);var w=this.buildFlexGridControl(o,t,p.getHostId(),s),O=this.buildStateService(this.saveStateCallback,this.state),M=this.buildNavigationService(this.navigation,O,r,this.utils,g,this.client.formFactor,this.mode.isOffline),E=this.buildSelectionService(g),I=this.buildFieldFactory(g,M,this.theming,this.useSkypeProtocol),T=this.buildWijmoGridComponent(w,p,C,u,S,g,b,M,y,m,I),D=this.buildFieldAccessComponent(T),_=this.buildFieldAccessService(D);if(d.add(e.Services.timeZoneService,u),d.add(e.Services.containerService,p),d.add(e.Services.gridComponent,T),d.add(e.Services.typeProcessorService,C),d.add(e.Services.fieldAccessComponent,D),d.add(e.Services.fieldAccessService,_),d.add(e.Services.selectionService,E),d.add(e.Services.stateService,O),d.add(e.Services.errorHandlingService,S),d.add(e.Services.dataAdapter,b),d.add(e.Services.dataSetService,g),d.add(e.Services.loggingService,h),d.add(e.Services.navigationService,M),d.add(e.Services.ariaLiveRegionComponent,v),d.add(e.Services.ariaLiveRegionService,y),this.isEditable){var L=this.buildRowButtonManager(T,g,M),P=new e.EditableGrid(T,C,_,E,g,S,M,p,this.client,this.mode,b,y,r,L,this.perfTool);this.CheckIfEditableOnMobile(P,g),c.push(P)}else{var R=new e.ReadOnly(T,C,_,E,g,M,p,this.client,this.mode,b,y,r,I);c.push(R)}if(this.hasFiltering){var U=this.buildFilteringContext(u,T),G=this.buildFilteringService(T,g,U),F=new e.Filtering(T,G,r);c.push(F),d.add(e.Services.filteringContext,U),d.add(e.Services.filteringService,G)}if(this.hasPagination)if(this.isEditable){var x=this.buildPagingComponent(p,T),N=this.buildGridPagingService(T,g,x),j=new e.Pagination(N,x,r);c.push(j),d.add(e.Services.paginationComponent,x),d.add(e.Services.paginationService,N)}else{var x=this.buildEnhancedPagingComponent(T),N=this.buildEnhancedPagingService(T,i,x),j=new e.EnhancedPagination(N,x);c.push(j),d.add(e.Services.enhancedPaginationComponent,x),d.add(e.Services.enhancedPaginationService,N)}if(this.hasGrouping&&e.GridUtils.getGridState(i).isGroupByEnabled){var H=this.buildGroupingComponent(p.getContainerId(),T,g,y),A=this.buildGridGroupingService(T,g,C),k=new e.Grouping(A,H,r);c.push(k),d.add(e.Services.groupingComponent,H),d.add(e.Services.groupingService,A)}if(this.hasSorting){var B=this.buildSortingService(i,d.getService(e.Services.groupingService)),W=new e.Sorting(T,B,r);c.push(W),d.add(e.Services.sortingService,B)}if(this.hasSubGrid){var V=new e.SubGrid(T,this.subGridBuilder,r,this.perfTool);c.push(V)}if(this.hasKeyboardNavigation){var K=new e.KeyboardNavigation(T,d.getService(e.Services.groupingComponent),d.getService(e.Services.paginationComponent),p,E,r,_);c.push(K)}return d.add(e.Services.gridFeatures,c),d},t.prototype.buildGridControlContainer=function(e){return e.id=MscrmCommon.ControlUtils.ControlGuidGenerator.newGuid("Grid"),e},t.prototype.buildFlexGridControl=function(t,i,o,r){void 0===r&&(r=e.HideNestedGridColumnHeader.No);try{var n={headersVisibility:t&&r==e.HideNestedGridColumnHeader.Yes?wijmo.grid.HeadersVisibility.None:wijmo.grid.HeadersVisibility.Column},s=t?i.getElementsByClassName("editableGrid").item(0):$(MscrmCommon.ControlUtils.String.Format("#{0}",o)).get(0);t&&r==e.HideNestedGridColumnHeader.Yes&&s.classList.add("hideNestedGridHeader");var a=new wijmo.grid.FlexGrid(s,n);return e.GridUtils.isTouchScreenDevice(this.client)&&(a.virtualizationThreshold=e.WijmoConstants.virtualizationThreshold),this.adjustGridLayout(s),a}catch(l){console.log(l)}},t.prototype.adjustGridLayout=function(t){var i=t&&t.firstChild;!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&(this.client.userAgent.isBrowserSafari||e.GridUtils.isTouchScreenDevice(this.client)&&!e.GridUtils.isEditableGridOnLegacyClient(this.isEditable))&&(t.style.height="auto",i.style.height="auto")},t.prototype.buildItemViewComponent=function(t,i,o,r,n,s,a,l,c,d,u){return new e.WijmoGridComponent(t,this.utils,this.client,this.offline,this.mode,i,o,r,n,s,a,this.htmlEncode,l,this.theming,c,d,u,this.perfTool,this.factory)},t.prototype.buildRowButtonManager=function(t,i,o){return new e.RowButtonManager(t,i,this.navigation,o,this.webAPI,this.client.isRTL,this.utils,this.isEditable);
},t.prototype.CheckIfEditableOnMobile=function(t,i){var o=!this.mode.isControlDisabled&&!this.mode.isOffline;if(e.GridUtils.isUci()){var r=i.getTargetEntityType();this.utils.getEntityMetadata(r).then(function(e){t.isEditable=o&&!e.IsReadOnlyInMobileClient})}else t.isEditable=o},t.prototype.resetIncludedFeatures=function(){this.isEditable=!1,this.hasFiltering=!1,this.hasSorting=!1,this.hasPagination=!1,this.hasGrouping=!1,this.hasSubGrid=!1},t}();e.WijmoGridControlFactory=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){var t=function(){function e(){}return Object.defineProperty(e,"SubGridParentIdName",{get:function(){return"SubGridParentId"},enumerable:!0,configurable:!0}),e}();e.SubGridDataSetPropertyNames=t;var i=function(){function e(){}return Object.defineProperty(e,"ParentIdName",{get:function(){return"ParentId"},enumerable:!0,configurable:!0}),e}();e.GridDataSetPropertyNames=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r){var n=this;this.raiseKeyDownEvent=function(e){return n.keyDownEvent.raise(n,e)},this.itemClickedHandler=function(t,i){if(!n.isDroppedDown){var o=t.selectedValue;n.selectedValue=o;var r=n.gridComponent.getGroupDescriptions();(0===r.length&&o||r.length>0&&r[0].propertyName!==o)&&n.groupingRequestedEvent.hasHandlers&&n.groupingRequestedEvent.raise(n,new e.GroupingRequestedEventArgs(o,null))}},this.onIndexChanged=function(e,t){n.ariaLiveRegionService.sendAssertiveMessage(n.menuGroupBy.getDisplayText());var i=n.menuGroupBy.dropDown.children.item(n.selectedIndex);i.focus()},this.onDropDown=function(e,t){if(n.isDroppedDown){for(var i=n.menuGroupBy.dropDown.children,o=0;o<i.length;o++)i.item(o).tabIndex=0;var r=n.gridComponent.getGroupDescriptions();r.length>0?n.selectedIndex=n.findIndex(r[0].propertyName):n.selectedIndex=0}},this.gridComponent=i,this.dataSetColumns=o,this.containerId=t,this.groupingRequestedEvent=new wijmo.Event,this.ariaLiveRegionService=r}return t.prototype.initialize=function(){this.divIdGroupBy="#"+this.containerId+e.GridConstants.groupBySelectPostfix,this.gridComponent.setGroupHeaderFormat("<b>{value}</b>"),this.gridComponent.setShowGroups(!0),$(this.divIdGroupBy).append($("<option>",{value:"",text:e.GridLocale.noGroupingOptionLabel}));for(var t=0,i=this.dataSetColumns;t<i.length;t++){var o=i[t];o.isHidden||o.attributes.type===e.MscrmDataTypes.multiSelectOptionset||$(this.divIdGroupBy).append($("<option>",{value:o.name,text:o.displayName}))}this.menuGroupBy=new wijmo.input.Menu(this.divIdGroupBy);var r=e.GridLocale.noGroupingOptionLabel;this.setGroupbyHeader(r);var n=this.containerId+e.GridConstants.groupBySelectPostfix+e.GridConstants.valuePostfix;$(this.divIdGroupBy).find("[wj-part='header']").attr("id",n),this.menuGroupBy.hostElement.setAttribute(e.GridConstants.ariaLabelledBy,[this.containerId+e.GridConstants.groupBySelectPostfix+e.GridConstants.labelPostfix,n].join(" ")),this.menuGroupBy.hostElement.setAttribute(e.GridConstants.role,"combobox"),this.menuGroupBy.itemClicked.addHandler(e.GridUtils.debounce.call(this,this.itemClickedHandler)),this.menuGroupBy.selectedIndexChanged.addHandler(this.onIndexChanged),this.menuGroupBy.isDroppedDownChanged.addHandler(e.GridUtils.debounce.call(this,this.onDropDown))},Object.defineProperty(t.prototype,"disableGroupMenu",{set:function(e){this.menuGroupBy.isDisabled=e,this.menuGroupBy.hostElement.tabIndex=e?-1:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupingRequested",{get:function(){return this.groupingRequestedEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keyDown",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.keyDownEvent)&&(this.keyDownEvent=new wijmo.Event,this.menuGroupBy.hostElement.addEventListener(e.WijmoConstants.eventKeyDown,this.raiseKeyDownEvent)),this.keyDownEvent},enumerable:!0,configurable:!0}),t.prototype.applyGroupBy=function(t){var i=e.GridLocale.noGroupingOptionLabel;if(t){var o=this.gridComponent.getColumnByName(t);MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||(i=o.header)}this.setGroupbyHeader(i)},t.prototype.findIndex=function(e){for(var t=0,i=0;i<this.getItemCount();i++)if(this.getValue(i)===e){t=i;break}return t},Object.defineProperty(t.prototype,"itemClicked",{get:function(){return this.menuGroupBy.itemClicked},enumerable:!0,configurable:!0}),t.prototype.getValue=function(e){return this.menuGroupBy.itemsSource[e].val},t.prototype.getItemCount=function(){return this.menuGroupBy.itemsSource.length},Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this.menuGroupBy.selectedIndex},set:function(e){this.menuGroupBy.selectedIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isDroppedDown",{get:function(){return this.menuGroupBy.isDroppedDown},set:function(e){this.menuGroupBy.isDroppedDown=e},enumerable:!0,configurable:!0}),t.prototype.setGroupbyHeader=function(e){this.menuGroupBy.header=e},t.prototype.dispose=function(){this.gridComponent=null,this.dataSetColumns=null,this.ariaLiveRegionService=null,this.menuGroupBy=null},t}();e.GroupingComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i){var o=this;this.clickHandler=function(e){o.entityReference&&null!=o.entityReference&&o.navigationService.navigateToEntityForm(o.entityReference)},this.parentContainer=e,this.navigationService=i,this.entityReference=t,this.control=this.createControl(),this.injectControl()}return t.prototype.injectControl=function(){this.control.classList.add("wj-input-group-btn"),this.control.classList.add("cc-lookup-nav-button"),this.parentContainer.appendChild(this.control),this.parentContainer.style.paddingRight=this.control.clientWidth+"px"},t.prototype.createControl=function(){var t=document.createElement("div");return this.actionButton=document.createElement("button"),t.appendChild(this.actionButton),this.actionButton.classList.add("wj-btn-default"),this.actionButton.classList.add("wj-btn"),this.actionButton.classList.add(e.GridConstants.navigableCell),this.actionButton.addEventListener("click",this.clickHandler),t},t.prototype.setEntityReference=function(e){this.entityReference=e},t.prototype.focus=function(){this.actionButton.focus()},t.prototype.dispose=function(){this.parentContainer.removeChild(this.control),this.parentContainer=null,this.control=null,this.actionButton=null,this.navigationService=null,this.entityReference=null},t}();e.LookupNavigationComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r,n,s){var a=this;this.dateChanged=function(e,t){return null===e.value?(a.gridControl.activeEditor.value=null,void(a.theDateTime=null)):(a.theDateTime=e.value,a.inputDate.value=a.theDateTime,void(2===a.dateTimeBehavior?a.gridControl.activeEditor.value=a.formatDateShort(a.theDateTime,!1):3===a.dateTimeBehavior?a.gridControl.activeEditor.value=a.formatTime(a.timeZoneService.browserTimeZoneToUtc(a.theDateTime),a.dateTimeBehavior):a.gridControl.activeEditor.value=a.formatTime(a.timeZoneService.userLocalToUtc(a.theDateTime),a.dateTimeBehavior)))},this.dateOrTimeChanged=function(e,t){return null===e.value?(a.gridControl.activeEditor.value=null,void(a.theDateTime=null)):(a.theDateTime=wijmo.DateTime.fromDateTime(e.value,a.inputTime.value),a.inputDate.value=a.theDateTime,a.inputTime.value=a.theDateTime,void(3===a.dateTimeBehavior?a.gridControl.activeEditor.value=a.formatTime(a.timeZoneService.browserTimeZoneToUtc(a.theDateTime),a.dateTimeBehavior):a.gridControl.activeEditor.value=a.formatTime(a.timeZoneService.userLocalToUtc(a.theDateTime),a.dateTimeBehavior)))},this.setDefaultDateTimeIfEmpty=function(){if(!a.inputDate.isDroppedDown&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(a.theDateTime)){var e=new Date;e.setHours(0),e.setMinutes(0),e.setSeconds(0),a.inputDate.value=e}},this.editEndingEventHandler=function(e,t){a.dispose(),t.cancel||(t.cancel=!0,a.gridControl.setCellData(t.row,t.col,a.theDateTime,!0,!1))},this.gridControl=e,this.eventArgs=t,this.columnFormat=o,this.theDateTime=MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)?null:this.parseDateTime(i),this.timeZoneService=n,this.dateTimeBehavior=r,this.formatTime=function(e,t){return a.timeZoneService.formatTime(e,t)},this.formatDateShort=function(e,t){return a.timeZoneService.formatDateShort(e,t)},this.dateFormattingInfo=s,this.createDateTimeEditor()}return t.prototype.createDateTimeEditor=function(){this.enableTimeEditor=MscrmCommon.ControlUtils.String.EqualsIgnoreCase(this.columnFormat,e.MscrmDataTypes.formatDateAndTime)||MscrmCommon.ControlUtils.String.EqualsIgnoreCase(this.columnFormat,e.MscrmDataTypes.dateAndTime),this.editorRoot=document.createElement("div");var t=document.createElement("div");if(this.editorRoot.appendChild(t),this.inputDate=new wijmo.input.InputDate(t),this.inputDate.format=this.dateFormattingInfo.ShortDatePattern.replace(/\//g,this.dateFormattingInfo.DateSeparator),this.inputDate.calendar.firstDayOfWeek=this.dateFormattingInfo.FirstDayOfWeek,this.inputDate.isRequired=!1,this.inputDate.value=this.theDateTime,this.inputDate.inputElement.classList.add(e.GridConstants.calendarIconGlyph),this.inputDate.isDroppedDownChanging.addHandler(this.setDefaultDateTimeIfEmpty),this.enableTimeEditor){var i=document.createElement("div");t.setAttribute("style",MscrmCommon.ControlUtils.String.Format("width: {0}",e.WijmoConstants.inputDateRatio)),i.setAttribute("style",MscrmCommon.ControlUtils.String.Format("width: {0}",e.WijmoConstants.inputTimeRatio)),this.editorRoot.appendChild(i),this.inputTime=new wijmo.input.InputTime(i),this.inputTime.inputType="text",this.inputTime.step=1,this.inputTime.format=this.dateFormattingInfo.ShortTimePattern.replace(/:/g,this.dateFormattingInfo.TimeSeparator),this.inputTime.isRequired=!1,this.inputTime.value=this.theDateTime,this.inputDate.valueChanged.addHandler(this.dateOrTimeChanged),this.inputDate.addEventListener(this.editorRoot,e.WijmoConstants.eventKeyDown,this.handleDateKeyPressed),this.inputTime.valueChanged.addHandler(this.dateOrTimeChanged),this.inputTime.isDroppedDownChanging.addHandler(this.setDefaultDateTimeIfEmpty)}else this.inputDate.valueChanged.addHandler(this.dateChanged);this.editorRoot.setAttribute("style","height: 100%"),this.eventArgs.cell.appendChild(this.editorRoot),this.inputDate.focus(),this.gridControl.cellEditEnding.addHandler(this.editEndingEventHandler)},t.prototype.parseDateTime=function(e){var t=null;return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.getMonth)?"string"==typeof e&&NaN!==Date.parse(e)&&(t=new Date(e)):t=e,null!==t?t:null},t.prototype.handleDateKeyPressed=function(t){if(e.TypeUtils.isKeyCode(t,e.GridConstants.kbTabCode)){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(document.activeElement))return;var i=$(this).find("input");if(2===i.length){var o=i[0],r=i[1];document.activeElement.isSameNode(o)&&!t.shiftKey?(e.TypeUtils.stopEventPropagation(t),window.setTimeout(function(){r.focus()},50)):document.activeElement.isSameNode(r)&&t.shiftKey&&(e.TypeUtils.stopEventPropagation(t),window.setTimeout(function(){o.focus()},50))}}},t.prototype.dispose=function(){this.eventArgs.cell.removeChild(this.editorRoot),this.gridControl.cellEditEnding.removeHandler(this.editEndingEventHandler),this.enableTimeEditor?(this.inputDate.valueChanged.removeHandler(this.dateOrTimeChanged),this.inputTime.valueChanged.removeHandler(this.dateOrTimeChanged),this.inputTime.dispose()):this.inputDate.valueChanged.removeHandler(this.dateChanged),this.inputDate.dispose()},t}();e.WijmoDateTimeEditor=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r){var n=this;this.valueChanged=function(t,i){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(n.inputDay.value)&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(n.inputHour.value)&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(n.inputMinute.value))n.theDuration=null;else{var o=n.getValueOrZero(n.inputDay.value),r=n.getValueOrZero(n.inputHour.value),s=n.getValueOrZero(n.inputMinute.value);n.theDuration=o*e.WijmoConstants.minutesInOneDay+r*e.WijmoConstants.minutesInOneHour+s}n.updateDisplayValue()},this.keyDownHandler=function(t){if(e.TypeUtils.isKeyCode(t,e.GridConstants.kbTabCode)){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(document.activeElement))return;var i=$(n.editorRoot).find("input");if(3===i.length){var o=i[0],r=i[1],s=i[2];document.activeElement.isSameNode(s)&&t.shiftKey||document.activeElement.isSameNode(o)&&!t.shiftKey?(e.TypeUtils.stopEventPropagation(t),window.setTimeout(function(){n.inputHour.focus()},50)):document.activeElement.isSameNode(r)&&(t.shiftKey?(e.TypeUtils.stopEventPropagation(t),window.setTimeout(function(){n.inputDay.focus()},50)):(e.TypeUtils.stopEventPropagation(t),window.setTimeout(function(){n.inputMinute.focus()},50)))}}e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowUpCode)&&e.TypeUtils.stopEventPropagation(t)},this.editEndingEventHandler=function(e,t){n.dispose(),t.cancel||(t.cancel=!0,n.gridControl.setCellData(t.row,t.col,n.theDuration,!0,!1),n.updateDisplayValue())},this.gridControl=t,this.eventArgs=i,this.theDuration=MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)?null:o,this.clientInfo=r,this.createDurationEditor()}return t.prototype.createDurationEditor=function(){this.editorRoot=document.createElement("div"),this.editorRoot.classList.add(e.WijmoConstants.durationEditorCssClass),this.editorRoot.style.minWidth=MscrmCommon.ControlUtils.String.Format("{0}px",e.WijmoConstants.durationEditorMinWidth),this.inputDay=new e.DurationValueInput(this.editorRoot,e.GridLocale.durationDayLabel,e.GridLocale.durationDaysLabel,e.WijmoConstants.durationMaxDay),this.inputHour=new e.DurationValueInput(this.editorRoot,e.GridLocale.durationHourLabel,e.GridLocale.durationHoursLabel,e.WijmoConstants.durationMaxHour),this.inputMinute=new e.DurationValueInput(this.editorRoot,e.GridLocale.durationMinuteLabel,e.GridLocale.durationMinutesLabel,e.WijmoConstants.durationMaxMinute),this.eventArgs.cell.appendChild(this.editorRoot),this.updateInputs(),this.updateDisplayValue(),this.inputDay.addEventListener(this.editorRoot,e.WijmoConstants.eventKeyDown,this.keyDownHandler),this.inputDay.valueChanged.addHandler(this.valueChanged),this.inputHour.valueChanged.addHandler(this.valueChanged),this.inputMinute.valueChanged.addHandler(this.valueChanged),this.gridControl.cellEditEnding.addHandler(this.editEndingEventHandler),this.inputMinute.focus()},t.prototype.getValueOrZero=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)?0:e},t.prototype.updateInputs=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.theDuration)||(this.inputDay.value=Math.floor(this.theDuration/e.WijmoConstants.minutesInOneDay),this.inputHour.value=Math.floor(this.theDuration%e.WijmoConstants.minutesInOneDay/e.WijmoConstants.minutesInOneHour),this.inputMinute.value=this.theDuration%e.WijmoConstants.minutesInOneHour)},t.prototype.updateDisplayValue=function(){var t;t=MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.theDuration)?MscrmCommon.CommonControl.DefaultValueLabel:this.theDuration>=e.WijmoConstants.minutesInOneDay?MscrmCommon.ControlUtils.String.Format("{0} {1}",(this.theDuration/e.WijmoConstants.minutesInOneDay).toFixed(2),this.theDuration>e.WijmoConstants.minutesInOneDay?e.GridLocale.durationDaysLabel:e.GridLocale.durationDayLabel):this.theDuration>=e.WijmoConstants.minutesInOneHour?MscrmCommon.ControlUtils.String.Format("{0} {1}",(this.theDuration/e.WijmoConstants.minutesInOneHour).toFixed(2),this.theDuration>e.WijmoConstants.minutesInOneHour?e.GridLocale.durationHoursLabel:e.GridLocale.durationHourLabel):MscrmCommon.ControlUtils.String.Format("{0} {1}",this.theDuration,this.theDuration>1?e.GridLocale.durationMinutesLabel:e.GridLocale.durationMinuteLabel),this.gridControl.activeEditor.value=t},t.prototype.dispose=function(){this.eventArgs.cell.removeChild(this.editorRoot),this.gridControl.cellEditEnding.removeHandler(this.editEndingEventHandler),this.inputDay.valueChanged.removeHandler(this.valueChanged),this.inputHour.valueChanged.removeHandler(this.valueChanged),this.inputMinute.valueChanged.removeHandler(this.valueChanged),this.inputDay.dispose(),this.inputHour.dispose(),this.inputMinute.dispose()},t}();e.WijmoDurationEditor=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){var t;!function(e){e[e.EnableFilter=0]="EnableFilter",e[e.DisableFilter=1]="DisableFilter",e[e.RegularSelection=2]="RegularSelection"}(t=e.LookupOptionType||(e.LookupOptionType={}));var i=function(){function i(){}return i.buildRegularOption=function(o,r,n){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o))throw MscrmCommon.ControlUtils.String.Format(e.LookupItemsCollectionBuilder.ErrorInvalidParameter,"record");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(r))throw MscrmCommon.ControlUtils.String.Format(e.LookupItemsCollectionBuilder.ErrorInvalidParameter,"columns");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(n))throw MscrmCommon.ControlUtils.String.Format(e.LookupItemsCollectionBuilder.ErrorInvalidParameter,"htmlEncode");var s=new i;return s.Id=o.getRecordId(),s.DisplayValue=i.getRegularDisplayValue(o,r,n),s.Type=t.RegularSelection,s},i.getRegularDisplayValue=function(e,t,i){for(var o='<div class="cc-grid-lookupitem">{0}</div>',r='<div class="cc-grid-lookupitem-field-{0}">{1}</div>',n="",s=0;s<t.length;s++)n+=MscrmCommon.ControlUtils.String.Format(r,s,i(e.getFormattedValue(t[s].name)));return MscrmCommon.ControlUtils.String.Format(o,n)},i.buildSpecialOption=function(o){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o))throw MscrmCommon.ControlUtils.String.Format(e.LookupItemsCollectionBuilder.ErrorInvalidParameter,"optionType");if(o===t.RegularSelection)throw"This method should only be used for special lookup options.";var r=new i;return r.Id=i.getSpecialId(o),r.DisplayValue=i.getSpecialDisplayValue(o),r.Type=o,r},i.getSpecialDisplayValue=function(i){switch(i){case t.EnableFilter:return e.GridLocale.enableLookupFilter;case t.DisableFilter:return e.GridLocale.disableLookupFilter;default:throw Error("Unknown special lookup option")}},i.getSpecialId=function(e){switch(e){case t.EnableFilter:return i.enableFilterId;case t.DisableFilter:return i.disableFilterId;default:throw Error("Unknown special lookup option")}},i.enableFilterId="ENABLE_FILTER",i.disableFilterId="DISABLE_FILTER",i}();e.LookupOption=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype._setText=function(i){if(this.selectedItem instanceof e.LookupOption){var o=this.selectedItem;o.Type==e.LookupOptionType.RegularSelection&&t.prototype._setText.call(this,i)}else t.prototype._setText.call(this,i)},i}(wijmo.input.AutoComplete);e.LookupAutoComplete=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r,n,s,a,l,c){var d=this;this.getLookupData=function(){d.perfTool.tryStart(e.GridPerformanceStopwatch.RetrieveLookup),d.dataSet.getLookupDataSet(d.column.binding).then(function(t){d.perfTool.tryStop(e.GridPerformanceStopwatch.RetrieveLookup),d.isDisposed||(d.dataAdapter.initialize(t,d.dataSet,d.htmlEncode),d.autoCompleteControl.selectedValuePath=d.dataAdapter.selectedValuePath,d.autoCompleteControl.displayMemberPath=d.dataAdapter.displayMemberPath,d.autoCompleteControl.itemsSourceFunction=d.dataAdapter.itemsSourceFunction,d.dataAdapter.setRefreshEnabled(),d.enableEventHandlers(),MscrmCommon.ControlUtils.Object.isNullOrUndefined(d.selectedRecord)?d.dataAdapter.clearUserTypedFilter():d.autoCompleteControl.text=d.selectedRecord.Name,d.autoCompleteControl.focus())},function(t){d.perfTool.tryStop(e.GridPerformanceStopwatch.RetrieveLookup),d.autoCompleteControl.isDisabled=!0})},this.selectionChangedHandler=function(){if(!d.autoCompleteControl.isDisabled){var t=d.autoCompleteControl.selectedItem,i=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t);(!i&&d.autoCompleteControl.text===MscrmCommon.ControlUtils.String.Empty||i)&&(i&&t.Type!==e.LookupOptionType.RegularSelection&&event.type===e.WijmoConstants.eventKeyDown&&!e.TypeUtils.isKeyCode(event,e.GridConstants.kbEnterCode)||(d.selectedRecord=d.dataAdapter.processSelection(t,d.selectedRecord)),d.ariaLiveRegionService.sendAssertiveCellValueMessage(d.autoCompleteControl.text,d.column.header),i&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(d.selectedRecord)&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(d.selectedRecord.Name)&&(d.selectedRecord.Name=d.autoCompleteControl.text),d.column.grid.activeEditor.value=d.selectedName,d.navigationControl&&d.navigationControl.setEntityReference(d.selectedRecord))}},this.handleKeyPressed=function(t){if(e.TypeUtils.isKeyCode(t,e.GridConstants.kbTabCode)){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(document.activeElement))return;d.navigationControl&&(e.TypeUtils.stopEventPropagation(t),window.setTimeout(function(){d.navigationControl.focus()},50))}e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowUpCode)&&e.TypeUtils.stopEventPropagation(t),e.TypeUtils.isKeyCode(t,e.GridConstants.kbEnterCode)&&d.autoCompleteControl.selectedIndexChanged.raise(d)},this.textChangedHandler=function(){d.autoCompleteControl.text===MscrmCommon.ControlUtils.String.Empty&&(d.dataAdapter.clearUserTypedFilter(),d.cancelCloseDropDown=!0)},this.isDroppedDownChangingHandler=function(e,t){1==d.autoCompleteControl.isDroppedDown&&d.cancelCloseDropDown&&(t.cancel=!0,d.cancelCloseDropDown=!1)},this.updatedLookupDataSetHandler=function(){d.autoCompleteControl._itemSourceFunctionCallback(d.dataAdapter.itemsSource)},this.editEndingEventHandler=function(e,t){d.dispose(),t.cancel||(t.cancel=!0,d.selectedRecord!=d.initialSelection&&d.column.grid.setCellData(t.row,t.col,d.selectedRecord,!1,!1))},this.navigationService=a,this.ariaLiveRegionService=l,this.column=o,this.dataAdapter=r,this.dataSet=n,this.htmlEncode=s,this.eventArgs=t,this.selectedRecord=i,this.initialSelection=i,this.perfTool=c,this.createEditor()}return t.prototype.createEditor=function(){this.editorRoot=document.createElement("div"),this.eventArgs.cell.appendChild(this.editorRoot),this.autoCompleteControl=this.createControlOnDOM(),this.autoCompleteControl.addEventListener(this.editorRoot,e.WijmoConstants.eventKeyDown,this.handleKeyPressed),this.column.grid.cellEditEnding.addHandler(this.editEndingEventHandler),this.navigationControl=new e.LookupNavigationComponent(this.eventArgs.cell,this.selectedRecord,this.navigationService),this.getLookupData()},t.prototype.createControlOnDOM=function(){return new e.LookupAutoComplete(this.editorRoot,{isRequired:!1,isContentHtml:!0,maxDropDownHeight:e.WijmoConstants.maxDropDownHeight})},Object.defineProperty(t.prototype,"selectedName",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.selectedRecord)?e.WijmoConstants.undefinedString:this.selectedRecord.Name},enumerable:!0,configurable:!0}),t.prototype.enableEventHandlers=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.autoCompleteControl)||(this.autoCompleteControl.selectedIndexChanged.addHandler(this.selectionChangedHandler),this.autoCompleteControl.textChanged.addHandler(this.textChangedHandler),this.autoCompleteControl.isDroppedDownChanging.addHandler(this.isDroppedDownChangingHandler)),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataAdapter)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataAdapter.updatedDataSetEvent)||this.dataAdapter.updatedDataSetEvent.addHandler(this.updatedLookupDataSetHandler)},t.prototype.disableEventHandlers=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.autoCompleteControl)||(this.autoCompleteControl.selectedIndexChanged.removeHandler(this.selectionChangedHandler),this.autoCompleteControl.textChanged.removeHandler(this.textChangedHandler),this.autoCompleteControl.isDroppedDownChanging.removeHandler(this.isDroppedDownChangingHandler)),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataAdapter)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataAdapter.updatedDataSetEvent)||this.dataAdapter.updatedDataSetEvent.removeHandler(this.updatedLookupDataSetHandler)},t.prototype.dispose=function(){this.column.grid.cellEditEnding.removeHandler(this.editEndingEventHandler),this.eventArgs.cell.removeChild(this.editorRoot),this.disableEventHandlers(),this.autoCompleteControl.dispose(),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataAdapter)||this.dataAdapter.dispose(),this.editorRoot=null,this.autoCompleteControl=null,this.dataAdapter=null,this.navigationControl.dispose()},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return null==this.autoCompleteControl},enumerable:!0,configurable:!0}),t.RetrieveLookupError="Error retrieving lookup dataset: {0}",t}();e.WijmoLookupEditor=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r,n,s){var a=this;this.valueChanged=function(e,t){a.gridControl.activeEditor.value=e.value},this.dblClickEventListener=function(t){e.TypeUtils.stopEventPropagation(t)},this.editEndingEventHandler=function(e,t){a.dispose(),t.cancel||(t.cancel=!0,a.gridControl.setCellData(t.row,t.col,a.input.value,!0,!1))},this.gridControl=t,this.editColumn=r,this.eventArgs=i,this.validation=n,this.precision=s,this.value=o,this.createNumberEditor()}return t.prototype.createNumberEditor=function(){this.editorRoot=document.createElement("div"),this.input=new wijmo.input.InputNumber(this.editorRoot),this.input.format=this.format,this.input.max=this.validation.max,this.input.min=this.validation.min,this.eventArgs.cell.appendChild(this.editorRoot),this.input.isRequired=!1,this.input.inputType="text",this.input.value=MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.value)?null:this.value,this.gridControl.activeEditor.value=String(this.input.value),this.input.valueChanged.addHandler(this.valueChanged),this.input.addEventListener(this.editorRoot,e.WijmoConstants.eventDoubleClick,this.dblClickEventListener),this.gridControl.cellEditEnding.addHandler(this.editEndingEventHandler),this.input.focus()},Object.defineProperty(t.prototype,"format",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.precision)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.editColumn.format)?this.editColumn.format:MscrmCommon.ControlUtils.String.Format("{0}{1}",this.editColumn.format[0],this.precision)},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.eventArgs.cell.removeChild(this.editorRoot),this.gridControl.cellEditEnding.removeHandler(this.editEndingEventHandler),this.input.valueChanged.removeHandler(this.valueChanged),this.input.removeEventListener(this.editorRoot,e.WijmoConstants.eventDoubleClick),this.input.dispose()},t}();e.WijmoNumberEditor=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r,n,s){var a=this;this.inputHandler=function(){a.gridControl.activeEditor.value=a.input.value},this.keydownHandler=function(t){e.TypeUtils.isKeyCode(t,e.GridConstants.kbEnterCode)&&(t.preventDefault(),a.input.value=a.input.value.substring(0,a.input.selectionStart)+"\n"+a.input.value.substring(a.input.selectionEnd,a.input.value.length),a.gridControl.activeEditor.value=a.input.value)},this.editEndingEventHandler=function(e,t){a.dispose(),t.cancel||(t.cancel=!0,a.gridControl.setCellData(t.row,t.col,a.input.value,!0,!1))},this.gridControl=t,this.editColumn=r,this.eventArgs=i,this.columnFormat=n,this.value=MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)?"":o,this.createTextAreaEditor(s)}return t.prototype.createTextAreaEditor=function(e){var t=this;this.input=document.createElement("textarea"),this.input.setAttribute("style",MscrmCommon.ControlUtils.String.Format("width: 100%; height: {0}px; resize: none",this.eventArgs.panel.rows[this.eventArgs.row].height)),this.eventArgs.cell.appendChild(this.input),this.input.value=this.value,this.input.addEventListener&&(this.input.addEventListener("input",this.inputHandler,!1),this.input.addEventListener("keydown",this.keydownHandler,!1)),Object.keys(e).forEach(function(i){t.input.setAttribute(i,e[i])}),this.gridControl.cellEditEnding.addHandler(this.editEndingEventHandler),this.input.focus()},t.prototype.dispose=function(){this.eventArgs.cell.removeChild(this.input),this.gridControl.cellEditEnding.removeHandler(this.editEndingEventHandler),this.input.removeEventListener("input",this.inputHandler,!1),this.input.removeEventListener("keydown",this.keydownHandler,!1)},t}();e.WijmoTextAreaEditor=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){var t=function(){function t(t){var i=this;this.updatedDataSet=new wijmo.Event,this.isFilterEnabled=!0,this.isInitialized=!1,this.shouldRefresh=!1,this.updatedLookupDataSetHandler=function(t){i.isDisposed()||(t&&(i.dataSet.records=t.records,i.dataSet.sortedRecordIds=t.sortedRecordIds),i.perfTool.tryStop(e.GridPerformanceStopwatch.RetrieveLookup),i.update(),MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.refreshedItemsCallback)?i.updatedDataSet.raise(i):(i.refreshedItemsCallback(i.itemsSource),i.refreshedItemsCallback=null))},this.perfTool=t}return t.prototype.initialize=function(t,i,o){this.isInitialized=!0,this.dataSet=t,this.parentDataSet=i,this.validateInputData();var r=t.columns.slice(0,e.GridConstants.maxNumberOfLookupColumns);this.filterManager=new e.LookupFilterManager(this.dataSet,r),this.itemsCollectionBuilder=new e.LookupItemsCollectionBuilder(o,r),this.update(),this.dataSet.addOnDataSetUpdated(this.updatedLookupDataSetHandler)},t.prototype.update=function(){this.itemsCollection=this.itemsCollectionBuilder.withAllowFilterOff(this.dataSet.filtering.canDisableRelationshipFilter()).withIsFilterEnabled(this.isFilterEnabled).withRecords(this.dataSet.sortedRecordIds,this.dataSet.records).build()},t.prototype.processSelection=function(t,i){this.validateIsInitialized();var o=MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)?null:t.Type;switch(o){case e.LookupOptionType.DisableFilter:this.toggleRelationshipFilter(!1);break;case e.LookupOptionType.EnableFilter:this.toggleRelationshipFilter(!0);break;case e.LookupOptionType.RegularSelection:i=MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.Id)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet.records[t.Id])?null:this.dataSet.records[t.Id].getNamedReference();break;default:i=null}return i},t.prototype.clearUserTypedFilter=function(){this.validateIsInitialized(),this.filterManager.clearFilter(),this.perfTool.tryStart(e.GridPerformanceStopwatch.RetrieveLookup),this.dataSet.refresh()},t.prototype.toggleRelationshipFilter=function(t){this.isFilterEnabled!=t&&this.dataSet.filtering.canDisableRelationshipFilter()&&(this.refreshedItemsCallback=null,this.isFilterEnabled=t,t?this.dataSet.filtering.enableRelationshipFilter(this.parentDataSet.getSelectedRecord()):this.dataSet.filtering.disableRelationshipFilter(),this.perfTool.tryStart(e.GridPerformanceStopwatch.RetrieveLookup),this.dataSet.refresh())},Object.defineProperty(t.prototype,"updatedDataSetEvent",{get:function(){return this.updatedDataSet},enumerable:!0,configurable:!0
}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return"Id"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return"DisplayValue"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemsSource",{get:function(){return this.itemsCollection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"itemsSourceFunction",{get:function(){var t=this;return function(i,o,r){!t.isDisposed()&&t.shouldRefresh&&(t.filterManager.setFilter(i),t.refreshedItemsCallback=r,t.perfTool.tryStart(e.GridPerformanceStopwatch.RetrieveLookup),t.dataSet.refresh())}},enumerable:!0,configurable:!0}),t.prototype.setRefreshEnabled=function(){this.shouldRefresh=!0},t.prototype.dispose=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.itemsCollection)||(this.itemsCollection.splice(0),this.itemsCollection=null),this.dataSet&&this.dataSet.removeOnDataSetUpdated&&this.dataSet.removeOnDataSetUpdated(this.updatedLookupDataSetHandler),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.updatedDataSetEvent)||this.updatedDataSetEvent.removeAllHandlers(),this.dataSet=null,this.filterManager=null,this.itemsCollectionBuilder=null},t.prototype.isDisposed=function(){return null==this.dataSet},t.prototype.validateInputData=function(){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidInputParam,"dataSet");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet.filtering))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidInputParam,"dataSet.filtering");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet.columns))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidInputParam,"dataSet.columns");if(0==this.dataSet.columns.length)throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidInputParam,"dataSet.columns[0]");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet.records))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidInputParam,"dataSet.records");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet.sortedRecordIds))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidInputParam,"dataSet.sortedRecordIds")},t.prototype.validateIsInitialized=function(){if(!this.isInitialized)throw new Error("This instance is not initialized yet.")},t}();e.LookupDataSetAdapter=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e){var i=t.call(this,e)||this;return e.formatItem.addHandler(i.formatItemExpCollapse,i),i}return __extends(i,t),i.prototype._hdrClick=function(e){},i.prototype.expanderMouseDown=function(e){t.prototype._hdrClick.call(this,e),e.stopPropagation()},i.prototype.formatItemExpCollapse=function(t,i){var o=this._g;i.panel.rows[i.row];if((this._mode==wijmo.grid.detail.DetailVisibilityMode.ExpandMulti||this._mode==wijmo.grid.detail.DetailVisibilityMode.ExpandSingle)&&i.panel!=o.columnHeaders&&1==i.col&&this._hasDetail(i.row)){var r=i.row<o.rows.length-1&&o.rows[i.row+1]instanceof wijmo.grid.detail.DetailRow,n=i.cell.querySelector(e.GridConstants.nestedGridExpanderClass);MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)&&(n=document.createElement("span"),n.classList.add(e.GridConstants.nestedGridExpanderClass),n.addEventListener(e.GridConstants.eventMouseDown,this.expanderMouseDown.bind(this)),i.cell.insertBefore(n,i.cell.firstChild),i.cell.classList.add(e.GridConstants.nestedGridCellClass)),n.classList.remove(r?e.GridConstants.nestedGridExpanderExpandClass:e.GridConstants.nestedGridExpanderCollapseClass),n.classList.add(r?e.GridConstants.nestedGridExpanderCollapseClass:e.GridConstants.nestedGridExpanderExpandClass),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.grid.activeEditor)||this.grid.selection.row!=i.row?n.classList.remove(e.GridConstants.nestedGridExpanderEditClass):n.classList.add(e.GridConstants.nestedGridExpanderEditClass)}},i}(wijmo.grid.detail.FlexGridDetailProvider);e.MicrosoftFlexGridDetailProvider=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r){this.sortPopupPopped=!1,this.sortPopupKey="sortPopup",this._context=t,this._dataSet=t.parameters.Grid,this._container=o,this._sortingService=new e.SortingService(this._dataSet,null,i),this._isRenderedInStream=this._context.parameters.UseDefaultCardFormForList&&this._context.parameters.UseDefaultCardFormForList.raw,this._parent=r}return Object.defineProperty(t.prototype,"sortingService",{get:function(){return this._sortingService},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataSet",{get:function(){return this._dataSet},enumerable:!0,configurable:!0}),t.prototype.getSortButtonId=function(){return"listSortButton"},t.prototype.getSortPopupListHeaderId=function(){return"SortPopupListHeader"},t.prototype.getSortPopupListFooterId=function(){return"SortPopupListFooter"},t.prototype.getSortPopupPopped=function(){return this.sortPopupPopped},t.prototype.renderSortingPopup=function(){var e=this;if(!this.sortPopupPopped){var t=this._context.utils.getPopupService(),i=document.createElement("div"),o=$(this._container).offset().top,r=$(this._container).offset().left,n=this._container.offsetWidth,s=void 0,a=void 0,l=this._container.offsetHeight,c=void 0;if(this._isRenderedInStream){var d=document.getElementById(this.getSortButtonId());d||(d=document.getElementById(this._context.accessibility.getUniqueId(this.getSortButtonId())));var u=$(d).offset().left;if(o=$(d).offset().top,n=void 0,a=d.offsetWidth+2*this.convertFromRemToPixelValue(this._context.theming.measures.measure150)+"px",l=$(document.documentElement).outerHeight()-o-2,this._context.client.isRTL){var m=u+$(d).outerWidth(),p=$(document.documentElement).outerWidth();c=p-m,s=m-r+"px",r=void 0}else{var h=r+$(this._container).outerWidth();r=u,s=h-r+"px"}}this.popupDiv=i;var g={name:this.sortPopupKey,popupToOpen:this.sortPopupKey,closeOnOutsideClick:!0,popupStyle:{width:n?n+"px":void 0,maxWidth:s,minWidth:a,borderStyle:"solid",borderColor:"black",borderWidth:"1px",flex:"",overflow:this._isRenderedInStream?"hidden":null,whiteSpace:this._isRenderedInStream?"nowrap":null,textOverflow:this._isRenderedInStream?"ellipsis":null,top:o+"px",left:r||0===r?r+"px":void 0,right:c?c+"px":void 0,flexDirection:"column",position:"absolute"},shadowStyle:{position:"absolute",width:"100%",height:"100%"},type:1,content:i};t.createPopup(g),this.removePopup=function(t){var i=document.getElementById(e.getSortPopupListHeaderId());i||(i=document.getElementById(e._context.accessibility.getUniqueId(e.getSortPopupListHeaderId()))),e.sortPopupPopped&&(e._isRenderedInStream||i.id!==t.target.id)&&(e._deletePopup(),e._focusOnSortButton())},document.addEventListener("click",this.removePopup),this._context.utils.bindDOMElement(this.renderSortPopupDataSet(n,l),this.popupDiv),this.sortPopupPopped=!0}},t.prototype.convertFromRemToPixelValue=function(e){var t=parseFloat(window.getComputedStyle(document.documentElement).fontSize);return t*parseFloat(e)},t.prototype.renderSortPopupDataSet=function(t,i){var o=this,r=(this.dataSet.columns,[]),n=this._context.factory.createElement("MICROSOFTICON",{id:"SortPopupCloseIcon",key:"SortPopupCloseIcon",type:97}),s=this._context.factory.createElement("TEXT",{id:"SortTitleText",key:"SortTitleText",style:{fontSize:this._context.theming.fontsizes.font100,color:this._context.theming.colors.base.white}},e.GridLocale.commandBarSortIconText),a=this._context.factory.createElement("BUTTON",{id:"ListCardButton",key:"ListCardButton",title:e.GridLocale.closeSortPopupButtonText,accessibilityLabel:e.GridLocale.closeSortPopupButtonText,role:"button",tabIndex:0,onClick:this._removePopup.bind(this),style:{backgroundColor:"transparent",borderStyle:this._context.theming.noneborderstyle,marginLeft:"auto",lineHeight:this._context.theming.fontsizes.font150,cursor:"pointer"}},[n]),l=this._context.factory.createElement("LISTITEM",{id:this.getSortPopupListHeaderId(),key:this.getSortPopupListHeaderId(),style:{fontWeight:this._context.theming.fontfamilies.bold,paddingLeft:this._context.theming.measures.measure150,width:t+"px",boxSizing:"border-box",display:"flex",lineHeight:this._context.theming.measures.measure250,cursor:"pointer",fontSize:this._context.theming.fontsizes.font100,fontColor:this._context.theming.colors.basecolor.white,backgroundColor:this._context.theming.colors.basecolor.blue.blue3}},[s,a]),c=this._context.factory.createElement("LISTITEM",{id:this.getSortPopupListFooterId(),key:this.getSortPopupListFooterId(),tabIndex:0,style:{display:"flex",height:this._context.theming.measures.measure100,fontSize:this._context.theming.fontsizes.font100,cursor:"pointer",fontColor:this._context.theming.colors.base.white,backgroundColor:this._context.theming.colors.whitebackground},accessibilityHidden:!0},[" "]);this._isRenderedInStream||r.push(l),r.push(this._renderSortPopupList(t)),r.push(c);var d=this._context.factory.createElement("SCROLLCONTAINER",{id:"SortPopupScrollContainer",key:"SortPopupScrollContainer",tabIndex:0,onKeyDown:function(e){o._keyDownHandler.call(o,e)},style:Object.assign({overflowY:"auto",maxHeight:i+"px"},this._isRenderedInStream&&{overflow:"hidden",textOverflow:"ellipsis"})},r);return d},t.prototype._renderSortPopupList=function(e){var t=this,i=[];if(this._isRenderedInStream){var o=this._parent.getAttributeDescriptorsByName(),r=0;for(var n in o){var s=o[n];(s.IsSortableEnabled||"modifiedon"===s.LogicalName)&&i.push(this.renderSortPopupListItem({alias:n,displayName:s.DisplayName},!1,e,!1)),r++}}else{var a=this.dataSet.columns;a.forEach(function(o,r){for(var n=0===o.order,s=!1,a=0,l=t._dataSet.sorting;a<l.length;a++){var c=l[a];c.name===o.alias&&(s=!0)}i.push(t.renderSortPopupListItem(o,s,e,n))})}var l=this._context.factory.createElement("LIST",{id:"SortPopupColumnsList",key:"SortPopupColumnsList",refCallback:this._setFocusOnFirstListItem.bind(this)},i);return l},t.prototype.renderSortPopupListItem=function(t,i,o,r){var n=this,s=t.alias,a=MscrmCommon.ControlUtils.String.Format(e.GridLocale.sortByColumnName,t.displayName);if(t.disableSorting||t.isHidden||"entityimage_url"===s)return null;var l=[],c={fontWeight:this._context.theming.fontfamilies.regular,paddingLeft:this._context.theming.measures.measure150,paddingRight:this._context.theming.measures.measure150,display:this._isRenderedInStream?"block":"flex",textOverflow:this._isRenderedInStream?"ellipsis":null,overflow:this._isRenderedInStream?"hidden":null,lineHeight:this._context.theming.measures.measure250,cursor:"pointer",fontSize:this._context.theming.fontsizes.font100,fontColor:this._context.theming.colors.grays.gray07,backgroundColor:this._context.theming.colors.whitebackground,whiteSpace:"nowrap",":hover":{backgroundColor:this._context.theming.colors.grays.gray01},":focus":{backgroundColor:this._context.theming.colors.grays.gray03}};if(l.push(t.displayName),i){var d=this._dataSet.sorting[0].sortDirection,u=this._context.factory.createElement("MICROSOFTICON",{id:"sortDirectionIcon"+d,key:"sortDirectionIcon"+d,type:0===d?58:59,style:{marginLeft:"auto"}});a=MscrmCommon.ControlUtils.String.Format(e.GridLocale.sortedByColumnName,t.displayName,0===d?e.GridLocale.sortedByAscending:e.GridLocale.sortedByDescending),l.push(u)}return this._context.factory.createElement("LISTITEM",(m={id:"SortFlyoutColumnsListItem_"+s+i,key:"SortFlyoutColumnsListItem_"+s+i,tabIndex:0,style:c,accessibilityLabel:a},m[i?"isSelected":void 0]=!0,m.onClick=function(){n.sortingService.applySorting(s),n._dataSet.refresh()},m),l);var m},t.prototype._setFocusOnFirstListItem=function(e){if(e){var t=e.firstChild;t&&setTimeout(function(){t.focus()},0)}},t.prototype._removePopup=function(){this._deletePopup(),this._focusOnSortButton()},t.prototype._deletePopup=function(){var e=this._context.utils.getPopupService();e.deletePopup(this.sortPopupKey),this.sortPopupPopped=!1,document.removeEventListener("click",this.removePopup)},t.prototype._focusOnSortButton=function(){var e=document.getElementById(this.getSortButtonId());e||(e=document.getElementById(this._context.accessibility.getUniqueId(this.getSortButtonId()))),e&&(e.tabIndex=0,e.focus())},t.prototype._handleKeyboardEventsForPopup=function(e,t){if(-1!==[40,38].indexOf(e.keyCode)){var i=e.target,o=this._context.accessibility.getUniqueId("ListCardButton"),r=document.getElementById(o),n=null;switch(e.keyCode){case 38:i!==r&&i===i.parentElement.firstElementChild?r&&r.focus():n=i.previousElementSibling;break;case 40:if(i===r){var s=document.getElementById(this._context.accessibility.getUniqueId("SortPopupColumnsList"));n=s?s.firstElementChild:null}else n=i.nextElementSibling}n&&n.focus()}},t.prototype._keyDownHandler=function(e){switch(e.keyCode){case 27:this._removePopup.call(this);break;case 13:var t=e.target;t.click(),e.preventDefault();break;default:this._handleKeyboardEventsForPopup(e,"SortPopupScrollContainer")}},t._setFocusTimer=null,t}();e.ListSortingPopupComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){var t;!function(e){e[e.None=0]="None",e[e.Lookup=1]="Lookup",e[e.Grid=2]="Grid"}(t=e.PresenceTarget||(e.PresenceTarget={}));var i=function(){function e(e,t,i){this.factory=e,this.utils=t,this.client=i}return e.prototype.addPresence=function(e,i,o,r){var n=e.textContent;e.textContent=null,r=null==r||"null"==r||void 0==r||"undefined"==r?"":r;var s=this.factory.createElement("PRESENCEINDICATOR",{sipUrl:i,entityReference:o,key:e.id+"_key",displaySize:0,style:{margin:"5px",position:"relative","float":this.client.isRTL?"right":"left"},parentControlId:e.id,absoluteId:e.id,accessibilityLabel:r,presenceTarget:t.Grid}),a=this.factory.createElement("CONTAINER",{id:e.id},[s,this.factory.createElement("LABEL",{},n)]),l=document.createElement("div");e.appendChild(l),this.utils.bindDOMElement(a,l)},e}();e.PresenceComponent=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o){var r=t.call(this)||this;return r.factory=e,r.utils=i,r.client=o,r}return __extends(i,t),i.prototype.updateCell=function(i,o,r,n,s,a){i.grid;t.prototype.updateCell.call(this,i,o,r,n,s,a);var l=n.hasAttribute(e.GridConstants.rowHeaderRowNumber)&&!n.classList.contains(e.WijmoConstants.groupClass),c=i.columns[r].binding;if(i.cellType==wijmo.grid.CellType.Cell&&"fullname"===c&&i.rows[o].dataItem){var d=i.rows[o].dataItem.sipValue;if(d){var u=new e.PresenceComponent(this.factory,this.utils,this.client);u.addPresence(n,d)}}l&&this.resetPadding(i,o,r,n),this.applyFilterTooltip(i,r,n)},i.prototype.resetPadding=function(e,t,i,o){var r=e.grid;r.rightToLeft?o.style.removeProperty("padding-right"):o.style.removeProperty("padding-left")},i.prototype.isEditingCell=function(e,t,i){return e.editRange&&e.editRange.contains(t,i)},i.prototype.applyFilterTooltip=function(t,i,o){if(t.cellType==wijmo.grid.CellType.ColumnHeader&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.columns[i].header)){var r=o.querySelector(".wj-elem-filter[role='button']");if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.classList)){var n;o.classList.contains(e.WijmoConstants.filterOffCSSClass)?n=e.GridLocale.columnUnfiltered:o.classList.contains(e.WijmoConstants.filterOnCSSClass)&&(n=e.GridLocale.columnFiltered),MscrmCommon.ControlUtils.String.isNullOrEmpty(n)||(r.title=MscrmCommon.ControlUtils.String.Format(n,t.columns[i].header))}}},i}(wijmo.grid.CellFactory);e.WijmoGridCellFactory=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(t){"use strict";var i=function(){function i(e,i,o,r,n,s,a,l,c,d,u,m,p,h,g,f,C,v,y){var S=this;this.isControlDisabled=!1,this.hideNestedGridColumnHeader=t.HideNestedGridColumnHeader.No,this.raiseClickEvent=function(e){return S.clickEvent.raise(S,e)},this.raiseDblClickEvent=function(e){return S.dblClickEvent.raise(S,e)},this.raiseMouseDownEvent=function(e){return S.mouseDownEvent.raise(S,e)},this.raiseMouseMoveEvent=function(e){return S.mouseMoveEvent.raise(S,e)},this.raiseMouseLeaveEvent=function(e){return S.mouseLeaveEvent.raise(S,e)},this.raiseKeyDownEvent=function(e){return S.keyDownEvent.raise(S,e)},this.raiseTouchStartEvent=function(e){return S.touchStartEvent.raise(S,e)},this.raiseTouchEndEvent=function(e){return S.touchEndEvent.raise(S,e)},this.raiseTouchMoveEvent=function(e){return S.touchMoveEvent.raise(S,e)},this.highlightedRow=-1,this.hasKeyboardSupport=!1,this.noRecordsDebounce=0,this.filterDisabledColumns=[t.GridConstants.btnHeaderColumnName,t.GridConstants.btnHeaderSelectColumnName],this.handleHighlightRecordMouseMove=function(e,i){var o=S.hitTest(i),r=o.cellType===wijmo.grid.CellType.Cell,n=o.cellType===wijmo.grid.CellType.RowHeader&&0==o.col;if(r||n){if(S.highlightedRow!==o.row&&S.hideHighlightedRow(),!t.GridUtils.isUci()||!S.isRowSelected(o.row)){S.highlightedRow=o.row;var s=t.GridUtils.isUci()?S.theming.colors.basecolor.grey.grey3:t.GridConstants.gridRowHoverColor;S.setRowBackground(S.highlightedRow,s)}}else S.hideHighlightedRow()},this.handleHighlightRecordMouseLeave=function(e,t){S.hideHighlightedRow()},this.onCollectionChangedEventHandler=function(e,t){S.collectionChangedEvent.hasHandlers&&S.collectionChangedEvent.raise(S,wijmo.EventArgs.empty)},this.defaultDropDownSelectedIndexChangeHandler=function(){var e=S.gridControl.activeEditor;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)){e.value=S.gridControl._edtHdl._lbx.selectedValue;var t=S.gridControl.columns[S.selection.col],i=MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)?MscrmCommon.ControlUtils.String.Empty:t.header;S.ariaLiveRegionService.sendPoliteCellValueMessage(S.activeListBox.getDisplayText(S.activeListBox.selectedIndex),i)}},this.defaultDropDownKeydownHandler=function(e){var i;t.TypeUtils.isKeyCode(e,t.GridConstants.kbArrowUpCode)&&(MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.activeEditor)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.activeListBox)||(i=S.activeListBox.itemsSource.length,S.activeListBox.selectedIndex=(S.activeListBox.selectedIndex-1+i)%i,t.TypeUtils.stopEventPropagation(e))),t.TypeUtils.isKeyCode(e,t.GridConstants.kbArrowDownCode)&&(e.altKey?MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.activeListBox)&&S.toggleDropDown(S.selection):MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.activeEditor)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.activeListBox)||(i=S.activeListBox.itemsSource.length,S.activeListBox.selectedIndex=(S.activeListBox.selectedIndex+1)%i),t.TypeUtils.stopEventPropagation(e))},this.displayCellEditErrorHandler=function(e,i){if(e.panel.cellType===wijmo.grid.CellType.Cell){var o=e.panel.grid.getCellData(e.row,0,!1),r=e.col===t.GridUtils.firstInformativeColumnIndex,n=S.errorHandlingService.getCellEncodedErrorMessage(o,i.binding,r);if(!MscrmCommon.ControlUtils.String.isNullUndefinedOrWhitespace(n)){wijmo.setAttribute(e.cell,t.GridConstants.ariaInvalid,!0);var s=document.createElement("div");e.cell.insertBefore(s,e.cell.firstChild),wijmo.toggleClass(s,t.WijmoConstants.errorIndicatorCSSClass,!0);var a=e.cell.id+t.GridConstants.cellErrorMessagePostfix;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(document.getElementById(a))){var l=t.GridUtils.createCellAccessibilityMessage(n,e.cell,a);l.setAttribute(t.GridConstants.role,"alert")}s.addEventListener(t.GridConstants.eventMouseDown,function(e){var i=new wijmo.Tooltip;i.isContentHtml=!0,t.TypeUtils.stopEventPropagation(e),i.popup.addHandler(function(){S.ariaLiveRegionService.sendAssertiveMessage(n)}),i.show(s,n)})}}},this.cellEditorHandler=function(e,i,o,r){var n=S.gridControl.editRange,s=S.validations[i.binding];if(!(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.attributes)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)||e.panel.cellType!==wijmo.grid.CellType.Cell||n.row!==e.row||n.col!==e.col)){var a=S.typeProcessorService.useOriginalEditor(o);if(a){var l=t.EditorsUtils.getOriginalEditor(e.cell);Object.keys(s).forEach(function(e){l.setAttribute(e.toString(),s[e])}),S.hasKeyboardSupport&&!t.EditorsUtils.isCustomDropDownEditorColumn(i,o)&&l.addEventListener(t.WijmoConstants.eventKeyDown,S.defaultDropDownKeydownHandler)}else{t.EditorsUtils.hideOriginalEditor(e.cell);var c=e.panel.grid.getCellData(e.row,e.col,!1),d=i.dataType,u=o.attributes.format,m=o.attributes.type,p=o.dataType;switch(d){case wijmo.DataType.Date:new t.WijmoDateTimeEditor(S.gridControl,e,c,u,o.attributes.behavior,S.timeZoneService,r.dateFormattingInfo);break;case wijmo.DataType.Number:if(m===t.MscrmDataTypes.whole&&MscrmCommon.ControlUtils.String.EqualsIgnoreCase(u,t.MscrmDataTypes.formatDuration))new t.WijmoDurationEditor(S.gridControl,e,c,S.client);else if(t.GridUtils.isWholeOptionSet(o))new t.WijmoWholeOptionsetEditor(S.gridControl,e,o,c,S.ariaLiveRegionService);else{var h=null,g=S.dataSetService.dataSet.getSelectedRecord();m!==t.MscrmDataTypes.currency||MscrmCommon.ControlUtils.Object.isNullOrUndefined(g)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(g.getCurrencyDecimalPrecision)||(h=g.getCurrencyDecimalPrecision(o)),new t.WijmoNumberEditor(S.gridControl,e,S.numberEditorKeyboardValue||c,i,s,h)}break;case wijmo.DataType.String:switch(m){case t.MscrmDataTypes.twoOptions:new t.WijmoBooleanEditor(S.gridControl,e,c,o,S.ariaLiveRegionService);break;case t.MscrmDataTypes.multiple:new t.WijmoTextAreaEditor(S.gridControl,e,c,i,u,s);break;case t.MscrmDataTypes.singleLine:MscrmCommon.ControlUtils.String.EqualsIgnoreCase(u,t.MscrmDataTypes.formatTextArea)&&new t.WijmoTextAreaEditor(S.gridControl,e,c,i,u,s)}break;case wijmo.DataType.Array:switch(m){case t.MscrmDataTypes.multiSelectOptionset:var f=e.panel.grid.getCellData(e.row,0,!1),C=S.getDataForMultiSelectPickListEditor(i,f),v=t.GridUtils.isDesktop(S.client.formFactor);new t.WijmoMultiSelectOptionsetEditor(S.gridControl,e,C,v,S.isControlDisabled)}break;case wijmo.DataType.Object:MscrmCommon.ControlUtils.String.EqualsIgnoreCase(p,t.MscrmDataTypes.dataTypeLookupSimple)&&new t.WijmoLookupEditor(e,c,i,new t.LookupDataSetAdapter(S.perfTool),S.dataSetService.dataSet,S.htmlEncode,S.navigationService,S.ariaLiveRegionService,S.perfTool)}}}},this.openFilterEditorHandler=function(e,i){var o=new wijmo.grid.HitTestInfo(i.target,null),r=S.isEditable?2:1;-1===o.row&&o.col>1&&o.col<=S.columns.length-r&&!i.shiftKey&&!i.altKey&&!i.metaKey&&i.keyCode===t.GridConstants.kbSpaceCode&&(i.preventDefault(),i.stopImmediatePropagation(),S.openFilterEditor(o.col))},this.focusColumnHeaderHandler=function(e){var t=new wijmo.grid.HitTestInfo(e.target,null),i=S.gridColumnHeaders.getCellElement(0,t.col);S.client&&S.client.userAgent&&S.client.userAgent.isBrowserIE?wijmo.setCss(i,{border:"dotted 1px"}):wijmo.setCss(i,{outline:"dotted 1px",outlineOffset:"-1px"})},this.blurColumnHeaderHandler=function(e){var t=new wijmo.grid.HitTestInfo(e.target,null),i=S.gridColumnHeaders.getCellElement(0,t.col);S.client&&S.client.userAgent&&S.client.userAgent.isBrowserIE?wijmo.setCss(i,{border:"none"}):wijmo.setCss(i,{outline:"none"})},this.applyAriaLabelsToRows=function(){var e=S.cells.hostElement.querySelectorAll("[role=row]");if(e&&e.length)for(var i=0;i<e.length;i++){var o=e[i];o&&!o.hasAttribute("aria-label")&&o.setAttribute("aria-label",0===i?t.GridLocale.gridHeaderRowText:t.GridLocale.gridDataRowText)}},this.updatedViewHandler=function(){var e=S.cells.hostElement.querySelectorAll("[role=columnheader]"),i=S.gridControl.columnHeaders.hostElement.parentElement.offsetHeight,o=S.gridControl.scrollPosition.y,r=S.gridColumnHeaders,n=(!t.GridUtils.isUci()&&t.GridUtils.isDesktop(S.client.formFactor),S.gridColumnHeaders.hostElement);n&&wijmo.setCss(n,{border:"1px solid transparent"});var s=r.hostElement.parentElement;s&&(s.hasAttribute("role")||s.setAttribute("role","presentation"));for(var a=0;a<e.length;a++){wijmo.setCss(e[a],{position:"",top:-(o+i),height:i,opacity:0,pointerEvents:"auto"});var l=e[a];r.getCellElement(0,a+1);l.setAttribute("tabIndex","0"),l.addEventListener("focus",S.focusColumnHeaderHandler),l.addEventListener("blur",S.blurColumnHeaderHandler),S.isEditable&&a==e.length-1&&l.setAttribute("tabIndex","-1")}S.applyAriaLabelsToRows()},this.formatCellDisplayValue=function(e,t){if(t.isVisible&&e.panel.cellType===wijmo.grid.CellType.Cell&&(MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.gridControl.activeEditor)||e.cell!==S.gridControl.activeEditor.parentElement)){var i=S.gridControl.getCellData(e.row,0,!1);MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||S.formatDisplayValue(S.dataSetService.records[i],i,e,t)}},this.applyCellStyleFormat=function(e,i){if(i.row>=0&&1===i.col&&S.gridControl.columnHeaders!=i.panel){var o=S.gridControl.rows[i.row];i.cell.setAttribute(t.GridConstants.rowHeaderRowNumber,i.row.toString()),o instanceof wijmo.grid.GroupRow?(o.isSelected=!1,i.cell.classList.add(t.GridConstants.groupHeaderCellClass)):i.cell.classList.add(t.GridConstants.appBarClass),S.applyCellSelectionStyle(o,i.cell)}i.cell.classList.contains(t.WijmoConstants.headerCSSClass)||(i.cell.setAttribute(t.GridConstants.dataId,"cell-"+i.row+"-"+i.col),i.cell.setAttribute(t.GridConstants.cellId,"id-cell-"+i.row+"-"+i.col))},this.applyNonSelectableCellStyleFormat=function(e,i){i.cell.setAttribute(t.GridConstants.tabIndex,"-1")},this.applyColumnHeaderFormat=function(e,i){if(i.panel.cellType===wijmo.grid.CellType.ColumnHeader){var o=i.col,r=S.getColumnName(o),n=e.getColumn(r).allowSorting;if(i.cell.id=r,i.cell.title=S.isOffline||!n?i.cell.textContent:MscrmCommon.ControlUtils.String.Format(t.GridLocale.sortByColumnName,i.cell.textContent),i.cell.id!==t.GridConstants.btnHeaderSelectColumnName)if(t.GridUtils.isUci()){var s=S.theming.colors.basecolor.blue.blue4;i.cell.innerHTML='<div class="headerCaption" style= "color:'+s+'; opacity: 1">'+i.cell.textContent+"</div>",!S.isEditable&&n&&(i.cell.removeAttribute("title"),i.cell.innerHTML='<div class="grid-filter-button-container" style="color:'+s+'"></div><div class="grid-header-text" style="color:'+s+'">'+i.cell.textContent+"</div>",i.cell.innerHTML+='<div class="wj-glyph-sortable" style="color:'+s+'; cursor: pointer"></div>',i.cell.innerHTML+='<div class="columnSeparator">&nbsp;</div>')}else i.cell.innerHTML='<div class="headerCaption">'+i.cell.textContent+"</div>";else i.cell.addEventListener(t.GridConstants.eventMouseDown,S.selectAllButtonMouseHandler),i.cell.setAttribute(t.GridConstants.ariaLabel,t.GridLocale.selectAllButtonAccessibilityLabel);S.hasKeyboardSupport&&i.cell.addEventListener(t.WijmoConstants.eventKeyDown,function(r){if(!(r.ctrlKey||r.shiftKey||r.altKey||r.metaKey))if(t.TypeUtils.isKeyCode(r,t.GridConstants.kbTabCode));else if((t.TypeUtils.isKeyCode(r,t.GridConstants.kbSpaceCode)||t.TypeUtils.isKeyCode(r,t.GridConstants.kbEnterCode))&&i.cell.id!==t.GridConstants.btnHeaderSelectColumnName){var n=new wijmo.grid.CellRangeEventArgs(i.panel,new wijmo.grid.CellRange(i.row,o));S.sortingColumn.raise(e,n)}else if(t.TypeUtils.isKeyCode(r,t.GridConstants.kbArrowDownCode)){var s=S.gridControl.cells.getCellElement(0,o);S.focusElement(s),S.gridControl.select(0,o),r.preventDefault()}else if(t.TypeUtils.isKeyCode(r,t.GridConstants.kbArrowLeftCode)){var a=S.gridColumnHeaders.getCellElement(S.gridColumnHeaders.rows.length-1,o-1);MscrmCommon.ControlUtils.Object.isNullOrUndefined(a)||(S.focusElement(a),r.preventDefault())}else if(t.TypeUtils.isKeyCode(r,t.GridConstants.kbArrowRightCode)){var a=S.gridColumnHeaders.getCellElement(S.gridColumnHeaders.rows.length-1,o+1);MscrmCommon.ControlUtils.Object.isNullOrUndefined(a)||(S.focusElement(a),r.preventDefault())}});var a=document.createElement("div");a.className="columnSeparator",i.cell.appendChild(a)}},this.applyEditableGridButtonsAreaHeader=function(e){var i=$(S.gridControl.hostElement).find('div[wj-part="ch"]');if(0!==i.length){var o=i.children(MscrmCommon.ControlUtils.String.Format(".{0}",t.GridConstants.headerButtonsClass));if(0===o.length){var r=document.createElement("div");r.classList.add(t.GridConstants.headerButtonsClass),MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.saveBtn)||r.appendChild(S.saveBtn),!t.GridUtils.isUci()&&t.GridUtils.isDesktop(e)&&r.appendChild(S.refreshBtn),i.append(r)}}},this.applySelectAllButtonAreaHeader=function(e,i){if(i.cellType===wijmo.grid.CellType.ColumnHeader&&0==i.cell.children.length){i.cell.title=MscrmCommon.ControlUtils.String.Empty,i.cell.innerText=MscrmCommon.ControlUtils.String.Empty;var o=$(i.cell).children(MscrmCommon.ControlUtils.String.Format(".{0}",t.GridConstants.headerButtonsLeftClass));if(0!==o.length)return;var r=document.createElement("div");r.classList.add(t.GridConstants.headerButtonsLeftClass),MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.selectAllBtn)||(S.selectAllBtn.tabIndex=-1,r.appendChild(S.selectAllBtn)),$(i.cell).append(r)}},this.fixWordWrapColumnHeaderStyle=function(e){var i=e.panel;i.cellType===wijmo.grid.CellType.ColumnHeader&&wijmo.toggleClass(e.cell,t.WijmoConstants.wordWrapCSSClass,!1)},this.applyColumnHeaderSortingStyle=function(e){var i=e.panel;if(i.cellType===wijmo.grid.CellType.ColumnHeader){var o=i.columns[e.col],r=S.sortingInfo(i,o);if(r){var n="",s=S.hiddenGridColumnHeaders&&S.hiddenGridColumnHeaders[e.col-1];0==r.sortDirection?(wijmo.toggleClass(e.cell,"wj-sort-asc",!0),n="wj-glyph-up",s&&s.setAttribute(t.GridConstants.ariaSort,"ascending")):1==r.sortDirection&&(wijmo.toggleClass(e.cell,"wj-sort-desc",!0),n="wj-glyph-down",s&&s.setAttribute(t.GridConstants.ariaSort,"descending"));var a=S.htmlEncode(o.header),l="",c=t.GridUtils.isUci()?"color:"+S.theming.colors.basecolor.blue.blue4+"; opacity: 1;":"",d=S.columnHasFilter(o.binding);S.isEditable&&d&&(l+='<div class="grid-filter-button-container" style="'+c+'"></div>'),l+='<div class="grid-header-text" style="'+c+'">'+a+"</div>",l+='<div class="'+n+'" style="'+c+'"></div>',l+='<div class="columnSeparator">&nbsp;</div>',e.cell.innerHTML=l}}},this.applyRollupColumnsFormat=function(e,i){var o=i.panel;if(o.cellType===wijmo.grid.CellType.Cell){var r=i.panel.columns[i.col];if(S.dataSetService.rollupColumns.indexOf(r.binding)>=0){var n=i.cell;if(0===n.getElementsByTagName("div").length){var s=i.panel.rows[i.row],a=new MscrmCommon.ArrayQuery(S.dataSetService.columns).firstOrDefault(function(e){return e.name===r.binding}),l=S.typeProcessorService.getValue(S.dataSetService.records[s.dataItem.recId],a,r.binding+"_date",!0);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(l)){var c=MscrmCommon.ControlUtils.String.Format("{0} {1}",t.GridLocale.rollupLastUpdatedLabel,l);if(!t.GridUtils.isUci()&&t.GridUtils.isDesktop(S.client.formFactor)){var d=document.createElement("span");d.title=c,d.className=t.GridConstants.rollupIconClass,n.insertBefore(d,n.firstChild)}else{var d=document.createElement("div");d.textContent=c,d.className=t.GridConstants.rollupDateClass,n.appendChild(d)}}}}}},this.beginningEditHandler=function(e,t){if(!t.cancel){MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.saveBtn)||(S.saveBtn.disabled=!1);var i=t.data;if(S.numberEditorKeyboardValue=null,i&&i instanceof KeyboardEvent&&i.charCode&&!i.ctrlKey&&!i.metaKey){var o=String.fromCharCode(i.charCode);S.numberEditorKeyboardValue=o>="0"&&"9">=o?+o:o}}},this.cellEditEndingHandler=function(e,t){var i=S.getCellData(t.row,t.col,!1),o=t.panel.grid.getCellData(t.row,0,!1),r=t.panel.columns[t.col].binding,n=t.panel.columns[t.col].dataType,s=function(e,t){S.cellEditEnded.removeHandler(s);var a=t.panel.grid.getCellData(t.row,t.col,!1);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.dataSetService.records[o]))return void S.onCellEditProcessed(t);
var l=i===a,c=null==i&&null==a;if(n==wijmo.DataType.Array&&(l=S.compareArrayValues(a,i)),l&&!c)return void S.onCellEditProcessed(t);var d=new MscrmCommon.ArrayQuery(S.dataSetService.columns).firstOrDefault(function(e){return e.name===r}),u=S.typeProcessorService.buildDatasetValue(d.attributes.type,d,a);S.dataSetService.submitValue(o,r,u),S.onCellEditProcessed(t)},a=function(e,t){S.cellEditEnded.removeHandler(a),S.onCellEditProcessed(t)};S.cellEditEnded.addHandler(t.cancel?a:s)},this.focusElement=function(e){if(e){var t=e.tabIndex;e.tabIndex=0,e.focus(),e.tabIndex=t}},this.saveButtonMouseHandler=function(e){S.saveButtonAction()},this.saveButtonKeyboardHandler=function(e){(t.TypeUtils.isKeyCode(e,t.GridConstants.kbEnterCode)||t.TypeUtils.isKeyCode(e,t.GridConstants.kbSpaceCode))&&(S.saveButtonAction(),MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.refreshBtn)?S.selectLastColumnHeader():S.refreshBtn.focus()),t.TypeUtils.isKeyCode(e,t.GridConstants.kbArrowDownCode)&&S.selectFirstRowLastDataColumn(),t.TypeUtils.isKeyCode(e,t.GridConstants.kbArrowRightCode)&&(MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.refreshBtn)||S.refreshBtn.focus()),t.TypeUtils.isKeyCode(e,t.GridConstants.kbArrowLeftCode)&&S.selectLastColumnHeader()},this.selectAllButtonMouseHandler=function(e){S.selectAllButtonAction()},this.selectAllButtonKeyboardHandler=function(e){t.TypeUtils.isKeyCode(e,t.GridConstants.kbSpaceCode)&&S.selectAllButtonAction()},this.refreshButtonMouseHandler=function(e){S.refreshButtonAction()},this.refreshButtonKeyboardHandler=function(e){(t.TypeUtils.isKeyCode(e,t.GridConstants.kbEnterCode)||t.TypeUtils.isKeyCode(e,t.GridConstants.kbSpaceCode))&&S.refreshButtonAction(),t.TypeUtils.isKeyCode(e,t.GridConstants.kbArrowDownCode)&&S.selectFirstRowLastDataColumn(),t.TypeUtils.isKeyCode(e,t.GridConstants.kbArrowLeftCode)&&(MscrmCommon.ControlUtils.Object.isNullOrUndefined(S.saveBtn)||S.saveBtn.disabled?S.selectLastColumnHeader():S.saveBtn.focus())},this.cleanupAttributes=function(e){var i=S.gridControl.cells.getCellElement(0,t.GridUtils.firstInformativeColumnIndex);S.gridControl.selection&&S.gridControl.selection.isValid&&(i=S.gridControl.cells.getCellElement(S.gridControl.selection.row,S.gridControl.selection.col)),i&&(i.tabIndex=0);var o=e.hostElement.querySelector("[wj-part=focus]");o&&o.removeAttribute("tabindex")},this.sortingInfo=function(e,t){for(var i=S.dataSetService.dataSet.sorting,o=0;o<i.length;++o)if(i[o].name===t.binding)return i[o];return null},this.gridControl=e,this.utils=i,this.client=o,this.offline=r,this.mode=n,this.containerService=s,this.typeProcessorService=a,this.timeZoneService=l,this.errorHandlingService=c,this.dataSetService=d,this.dataAdapterService=u,this.htmlEncode=m,this.navigationService=p,this.ariaLiveRegionService=g,this.learningPathService=f,this.fieldFactory=C,this.factory=y,this.utils=i,this.validations={},this.collectionChangedEvent=new wijmo.Event,this.cellEditProcessedEvent=new wijmo.Event,this.theming=h,this.msosDataMaps={},this.perfTool=v}return i.prototype.init=function(){var e=this;this.gridControl.autoGenerateColumns=!1,this.getIndexedValue(this.gridControl.columnHeaders.rows,0).height=t.WijmoConstants.defaultMinRowHeight,this.gridControl.rows.defaultSize=t.WijmoConstants.defaultMinRowHeight,this.gridControl.treeIndent=t.GridConstants.treeIndent,this.gridControl.cellFactory=new t.WijmoGridCellFactory(this.factory,this.utils,this.client),this.updatedView.addHandler(this.updatedViewHandler),this.isEditable&&this.keyDown.addHandler(this.openFilterEditorHandler),this.cleanupAttributes(this.gridControl),this.gridControl.updatedLayout.addHandler(function(){e.cleanupAttributes(e.gridControl)}),this.gridControl.lostFocus.addHandler(function(){e.cleanupAttributes(e.gridControl)}),this.gridControl.selection=new wijmo.grid.CellRange,this.initAccessibilityExtender(),this.subscribeMouseEvents(),this.noRecordsDiv=this.containerService.noRecordsDiv,this.initCalendarCulture(),this.initHeaderButtons(),this.msosDataMaps={}},i.prototype.disableDefaultEnterHandler=function(){this.gridControl.hostElement.parentElement.addEventListener("keydown",function(e){e.keyCode==t.GridConstants.kbEnterCode&&e.preventDefault()},!0)},i.prototype.enableTreeView=function(){this.gridControl.childItemsPath="children"},i.prototype.enableTreeViewEditing=function(){for(var e=0;e<this.gridControl.rows.length;e++)this.gridControl.rows[e].isReadOnly=!1},i.prototype.toggleDropDown=function(e){if(!(this.selection.col<=0||this.selection.col>this.dataSetService.columns.length)){var i=this.getColumnByName(this.getColumnName(this.selection.col)),o=t.GridUtils.getDatasetColumnByName(this.dataSetService.dataSet.columns,i.binding);if(t.EditorsUtils.isOptionSetDropDownEditorColumn(i,o)&&(this.gridControl._edtHdl._toggleListBox(e),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.activeListBox)||(this.activeListBox.selectedIndexChanged.removeAllHandlers(),this.activeListBox.selectedIndexChanged.addHandler(this.defaultDropDownSelectedIndexChangeHandler))),t.EditorsUtils.isCustomDropDownEditorColumn(i,o)&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.activeEditor)){this.startEditing();var r=wijmo.input.Menu.getControl(document.activeElement);MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)||(r.isDroppedDown=!0)}}},Object.defineProperty(i.prototype,"activeListBox",{get:function(){return this.gridControl._edtHdl._lbx},enumerable:!0,configurable:!0}),i.prototype.setRecordReadOnly=function(e,t){var i=MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl.collectionView)?void 0:this.gridControl.collectionView.items;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&0!==i.length)for(var o=0;o<i.length;o++)if(i[o].recId===e){this.gridControl.rows[o].isReadOnly=t;break}},i.prototype.setRefreshBtnDisabled=function(e){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.refreshBtn)||(this.refreshBtn.disabled=e)},i.prototype.enableMultiSelection=function(){this.gridControl.selectionMode=wijmo.grid.SelectionMode.ListBox},i.prototype.disableMultiSelection=function(){this.gridControl.selectionMode=wijmo.grid.SelectionMode.Row},i.prototype.initializeColumns=function(e){var i=this;e.forEach(function(e){t.GridUtils.isUci()&&i.isEditable&&(e.name==t.GridConstants.btnHeaderSelectColumnName?e.width=t.GridUtils.getHeaderSelectColumnWidth(e):e.name==t.GridConstants.btnHeaderColumnName&&(e.minWidth=t.GridUtils.getHeaderColumnWidth(e))),i.gridControl.columns.push(e),t.GridUtils.isBtnHeaderColumn(e.name)&&i.applyEditableGridButtonsAreaHeader(i.client.formFactor)})},i.prototype.setWijmoColumnWidth=function(e){var t=this.gridControl.columns;for(var i in e){var o=this.getColumnIndex(i);if(-1!==o){var r=t[o],n=e[i];r.width=n,r.size=n}}},i.prototype.initializeFiltering=function(){var e=this;this.gridFilter=new wijmo.grid.filter.FlexGridFilter(this.gridControl),this.gridFilter.showSortButtons=!1,this.gridFilter.filterColumns=[],this.gridControl.columns.forEach(function(t){var i=t.binding;e.columnHasFilter(i)&&e.gridFilter.filterColumns.push(i)}),this.initializeLocale(),this.saveCurrentFilter()},i.prototype.columnHasFilter=function(e){return-1==this.filterDisabledColumns.indexOf(e)},i.prototype.initializeLocale=function(){wijmo.culture.FlexGridFilter.ascending=t.FilteringLocale.filterAscendingLabel,wijmo.culture.FlexGridFilter.descending=t.FilteringLocale.filterDescendingLabel,wijmo.culture.FlexGridFilter.apply=t.FilteringLocale.filterApplyLabel,wijmo.culture.FlexGridFilter.clear=t.FilteringLocale.filterClearLabel,wijmo.culture.FlexGridFilter.conditions=t.FilteringLocale.filterByConditionLabel,wijmo.culture.FlexGridFilter.values=t.FilteringLocale.filterByValueLabel,wijmo.culture.FlexGridFilter.search=t.FilteringLocale.valueFilterSearchLabel,wijmo.culture.FlexGridFilter.selectAll=t.FilteringLocale.valueFilterSelectAllLabel,wijmo.culture.FlexGridFilter["null"]=t.FilteringLocale.valueFilterNullLabel,wijmo.culture.FlexGridFilter.header=t.FilteringLocale.conditionFilterHeaderLabel,wijmo.culture.FlexGridFilter.and=t.FilteringLocale.conditionFilterAndLabel,wijmo.culture.FlexGridFilter.or=t.FilteringLocale.conditionFilterOrLabel,wijmo.culture.FlexGridFilter.stringOperators=[{name:t.FilteringLocale.conditionFilterOperatorNotSetLabel,op:null},{name:t.FilteringLocale.conditionFilterOperatorEqualsLabel,op:wijmo.grid.filter.Operator.EQ},{name:t.FilteringLocale.conditionFilterOperatorDoesNotEqualLabel,op:wijmo.grid.filter.Operator.NE},{name:t.FilteringLocale.conditionFilterOperatorBeginsWithLabel,op:wijmo.grid.filter.Operator.BW},{name:t.FilteringLocale.conditionFilterOperatorEndsWithLabel,op:wijmo.grid.filter.Operator.EW},{name:t.FilteringLocale.conditionFilterOperatorContainsLabel,op:wijmo.grid.filter.Operator.CT}],wijmo.culture.FlexGridFilter.numberOperators=[{name:t.FilteringLocale.conditionFilterOperatorNotSetLabel,op:null},{name:t.FilteringLocale.conditionFilterOperatorEqualsLabel,op:wijmo.grid.filter.Operator.EQ},{name:t.FilteringLocale.conditionFilterOperatorDoesNotEqualLabel,op:wijmo.grid.filter.Operator.NE},{name:t.FilteringLocale.conditionFilterOperatorGreaterLabel,op:wijmo.grid.filter.Operator.GT},{name:t.FilteringLocale.conditionFilterOperatorGreaterOrEqualLabel,op:wijmo.grid.filter.Operator.GE},{name:t.FilteringLocale.conditionFilterOperatorLessLabel,op:wijmo.grid.filter.Operator.LT},{name:t.FilteringLocale.conditionFilterOperatorLessOrEqualLabel,op:wijmo.grid.filter.Operator.LE}],wijmo.culture.FlexGridFilter.dateOperators=[{name:t.FilteringLocale.conditionFilterOperatorNotSetLabel,op:null},{name:t.FilteringLocale.conditionFilterOperatorEqualsLabel,op:wijmo.grid.filter.Operator.EQ},{name:t.FilteringLocale.conditionFilterOperatorIsBeforeLabel,op:wijmo.grid.filter.Operator.LT},{name:t.FilteringLocale.conditionFilterOperatorIsAfterLabel,op:wijmo.grid.filter.Operator.GT}],wijmo.culture.FlexGridFilter.booleanOperators=[{name:t.FilteringLocale.conditionFilterOperatorNotSetLabel,op:null},{name:t.FilteringLocale.conditionFilterOperatorEqualsLabel,op:wijmo.grid.filter.Operator.EQ},{name:t.FilteringLocale.conditionFilterOperatorDoesNotEqualLabel,op:wijmo.grid.filter.Operator.NE}]},i.prototype.updateColumns=function(e){var t=this;Object.keys(e).forEach(function(i){t.updateColumn(i,e[i])})},i.prototype.createGridDetail=function(e,i,o){this.detailProvider=new t.MicrosoftFlexGridDetailProvider(this.gridControl),this.detailProvider.maxHeight=400,this.detailProvider.createDetailCell=e,this.detailProvider.rowHasDetail=i,this.detailProvider.disposeDetailCell=o},i.prototype.showDetailGrid=function(e){this.detailProvider&&this.detailProvider.showDetail(e,!0)},i.prototype.hideDetailGrid=function(e){this.detailProvider.hideDetail(e)},i.prototype.render=function(e){this.setItemsSource(e),this.switchNoRecordsLabelVisibility()},i.prototype.initCalendarCulture=function(){wijmo.culture.Globalize.calendar.months=this.client.dateFormattingInfo.MonthNames,wijmo.culture.Globalize.calendar.monthsAbbr=this.client.dateFormattingInfo.AbbreviatedMonthNames,wijmo.culture.Globalize.calendar.days=this.client.dateFormattingInfo.DayNames,wijmo.culture.Globalize.calendar.daysAbbr=this.client.dateFormattingInfo.AbbreviatedDayNames,wijmo.culture.Globalize.calendar.am=[this.client.dateFormattingInfo.AMDesignator,this.client.dateFormattingInfo.AMDesignator],wijmo.culture.Globalize.calendar.pm=[this.client.dateFormattingInfo.PMDesignator,this.client.dateFormattingInfo.PMDesignator]},i.prototype.initHeaderButtons=function(){this.isEditable?MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.saveBtn)&&(this.saveBtn=this.createHeaderButton(t.GridLocale.saveButtonLabel,t.GridConstants.headerBtnSaveClass,this.saveButtonMouseHandler,this.saveButtonKeyboardHandler,!0)):MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.saveBtn)||(this.saveBtn.removeEventListener(t.GridConstants.eventMouseDown,this.saveButtonMouseHandler),this.saveBtn.removeEventListener(t.WijmoConstants.eventKeyDown,this.saveButtonKeyboardHandler),this.saveBtn=null),!t.GridUtils.isUci()&&t.GridUtils.isDesktop(this.client.formFactor)&&(this.refreshBtn=this.createHeaderButton(t.GridLocale.refreshButtonLabel,t.GridConstants.headerBtnRefreshClass,this.refreshButtonMouseHandler,this.refreshButtonKeyboardHandler)),this.selectAllBtn=this.createHeaderButton(t.GridLocale.selectAllButtonLabel,t.GridConstants.headerBtnSelectClass,null,null)},i.prototype.refresh=function(){this.gridControl.refresh()},Object.defineProperty(i.prototype,"msosDataMap",{get:function(){return this.msosDataMaps},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isEditable",{get:function(){return!this.gridControl.isReadOnly},set:function(e){this.gridControl.isReadOnly=!e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isMultiSelectionEnabled",{get:function(){return i.isMultiSelectionEnabled(this.gridControl)},enumerable:!0,configurable:!0}),i.prototype.containsFocus=function(){return this.gridControl.containsFocus()},i.prototype.getCellBoundingRect=function(e,t){return 0>e||e>this.totalRowsCount-1||0>t||t>this.totalColumnsCount-1?null:this.gridControl.getCellBoundingRect(e,t)},i.prototype.getColumnIndex=function(e){var t=this.gridControl.columns.getColumn(e);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)?-1:t.index},i.prototype.isColumnVisible=function(e){var t=this.gridControl.columns.getColumn(e);return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)&&t.isVisible},i.prototype.startEditing=function(e,t,i){return this.gridControl.startEditing(e,t,i)},i.prototype.getSelectedState=function(e,t){return this.gridControl.getSelectedState(e,t)},i.prototype.getColumnFilter=function(e){return new t.GridColumnFilterModel(this.gridFilter.getColumnFilter(e))},i.prototype.saveCurrentFilter=function(){this.filterDefinition=this.gridFilter.filterDefinition},i.prototype.getFilterDefinition=function(){return this.filterDefinition},i.prototype.openFilterEditor=function(e,t){var i=e>-1?this.columns[e]:null;i&&!i.dataMap&&this.gridFilter&&this.gridFilter.getColumnFilter(i,!1)&&this.gridFilter.editColumnFilter(i,t)},i.prototype.closeFilterEditor=function(){this.gridFilter.closeEditor()},i.prototype.restoreFilters=function(e,t){void 0===t&&(t=null);var i=MscrmCommon.ControlUtils.String.isNullOrEmpty(t)?this.filterDefinition:t;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i))return null;var o=JSON.parse(i),r=[];if(o&&o.filters&&o.filters.length>0)for(var n=0;n<o.filters.length;n++){var s=this.gridControl.columns.getColumn(o.filters[n].binding),a=this.getColumnFilter(s.binding),l=a.getOriginalGridFilter();e(a,o.filters[n].type)&&(this.applyColumnFilterDefinition(l,o.filters[n]),r.push(a))}return this.saveCurrentFilter(),r},i.prototype.restoreAllFilters=function(){return this.restoreFilters(function(e){return!0})},i.prototype.applyColumnFilterDefinition=function(e,t){if(e)switch(t.type){case"condition":e.filterType=wijmo.grid.filter.FilterType.Condition,e.conditionFilter.condition1.operator=t.condition1.operator,e.conditionFilter.condition1.value=e.column.dataType===wijmo.DataType.Date?this.convertStringToDate(t.condition1.value):t.condition1.value,e.conditionFilter.and=t.and,e.conditionFilter.condition2.operator=t.condition2.operator,e.conditionFilter.condition2.value=e.column.dataType===wijmo.DataType.Date?this.convertStringToDate(t.condition2.value):t.condition2.value;break;case"value":e.filterType=wijmo.grid.filter.FilterType.Value,e.valueFilter.filterText=t.filterText,e.valueFilter.showValues=t.showValues}},i.prototype.convertStringToDate=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)?null:new Date(e)},Object.defineProperty(i.prototype,"columnLayout",{get:function(){return this.gridControl.columnLayout},set:function(e){this.gridControl.columnLayout=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columnResized",{get:function(){return this.gridControl.resizedColumn},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"formatItem",{get:function(){return this.gridControl.formatItem},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"updatedView",{get:function(){return this.gridControl.updatedView},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionChanging",{get:function(){return this.gridControl.selectionChanging},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionChanged",{get:function(){return this.gridControl.selectionChanged},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"beginningEdit",{get:function(){return this.gridControl.beginningEdit},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellEditEnding",{get:function(){return this.gridControl.cellEditEnding},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellEditEnded",{get:function(){return this.gridControl.cellEditEnded},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellEditProcessed",{get:function(){return this.cellEditProcessedEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortingColumn",{get:function(){return this.gridControl.sortingColumn},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lostFocus",{get:function(){return this.gridControl.lostFocus},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollPositionChanged",{get:function(){return this.gridControl.scrollPositionChanged},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columnsCollectionChanged",{get:function(){return this.gridControl.columns.collectionChanged},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selection",{get:function(){return this.gridControl.selection},enumerable:!0,configurable:!0}),i.prototype.select=function(e,t){this.gridControl.select(e,t)},Object.defineProperty(i.prototype,"prepareCellForEdit",{get:function(){return this.gridControl.prepareCellForEdit},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"loadedRows",{get:function(){return this.gridControl.loadedRows},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"activeEditor",{get:function(){return this.gridControl.activeEditor},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isEditing",{get:function(){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.getGridEditRange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cells",{get:function(){return this.gridControl.cells},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columns",{get:function(){return this.gridControl.columns},enumerable:!0,configurable:!0}),i.prototype.onCellEditProcessed=function(e){this.cellEditProcessed.raise(this,e)},i.prototype.onFormatItem=function(e){this.gridControl.onFormatItem(e)},i.prototype.onUpdatedView=function(e){this.gridControl.onUpdatedView(e)},i.prototype.onSortedColumn=function(e){this.gridControl.sortedColumn.raise(this,e)},i.prototype.hitTest=function(e){return this.gridControl.hitTest(e)},i.prototype.getCellData=function(e,t,i){return 0===this.gridControl.rows.length?null:this.gridControl.getCellData(e,t,i)},i.prototype.getRenderedCellHeight=function(){var e=this.row(0);return e?e.renderHeight:0},i.prototype.findRecord=function(e,t){for(var i=0;i<e.length;i++)if(e[i].recId===t)return e[i]},i.prototype.updateSourceCollection=function(e){var t=this,i=this.getCollectionDataView();i.beginUpdate(),i.sourceCollection.length=0;var o=this.dataAdapterService.getGridRecordItems(this.dataSetService.dataSet);(r=i.sourceCollection).splice.apply(r,[0,0].concat(e.map(function(e){return t.findRecord(o.sourceCollection,e)}))),i.pageSize=i.sourceCollection.length,i.refresh(),i.endUpdate();var r},i.prototype.setProgressIndicator=function(e){if(!this.progressIndicatorDiv){var i=this.containerService.getContainerId()+"_progressIndicatorDiv",o=t.ProgressIndicator.render(this.factory,i),r=this.containerService.progressIndicatorDiv;this.progressIndicatorDiv=r,this.utils.bindDOMElement(o,r);var n=this.getCollectionDataView();this.render(n)}if(e)switch(this.progressIndicatorDiv.style.display="block",e){case t.ProgressIndicatorPosition.Top:var s=t.GridConstants.progressIndicatorSize/2+t.GridConstants.firstRowHeight;this.progressIndicatorDiv.style.top=s+"px",this.progressIndicatorDiv.style.bottom="auto";break;case t.ProgressIndicatorPosition.Bottom:this.progressIndicatorDiv.style.top="auto",this.progressIndicatorDiv.style.bottom=t.GridConstants.progressIndicatorSize/2+"px"}else this.progressIndicatorDiv.style.display="none",this.progressIndicatorDiv.style.top=null,this.progressIndicatorDiv.style.bottom=null},i.prototype.getSourceCollectionIds=function(){var e=this.getCollectionDataView();return e.sourceCollection.map(function(e){return e.recId})},i.prototype.findCellHtml=function(e,i){var o=this.getCellBoundingRect(e,i);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o))return null;var r=document.elementFromPoint(o.left+o.width/2,o.top+o.height/2);for(wijmo.hasClass(r,t.WijmoConstants.headerCSSClass)&&(r=null);r&&!wijmo.hasClass(r,t.WijmoConstants.cellCSSClass);)r=r.parentElement;return r},i.prototype.getColumnName=function(e){if(-1===e)return MscrmCommon.ControlUtils.String.Empty;var t=this.gridControl.columns;return e==t.length&&(e-=1),t[e].binding},Object.defineProperty(i.prototype,"selectedRows",{get:function(){return i.selectedRows(this.gridControl)},set:function(e){this.gridControl.selectedRows=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalRowsCount",{get:function(){return this.gridControl.rows.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalColumnsCount",{get:function(){return this.gridControl.columns.length},enumerable:!0,configurable:!0}),i.prototype.row=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl.rows)?null:this.gridControl.rows[e]},i.prototype.selectedRowsNumbers=function(){return i.isMultiSelectionEnabled(this.gridControl)?new MscrmCommon.ArrayQuery(this.gridControl.rows).where(function(e){return e.isSelected}).select(function(e){return e.index}).items():[this.gridControl.selection.row]},i.prototype.isRowSelected=function(e){var t=this.selectedRowsNumbers();return t.indexOf(e)>=0},i.selectedRows=function(e){if(i.isMultiSelectionEnabled(e))return new MscrmCommon.ArrayQuery(e.rows).where(function(e){return e.isSelected}).select(function(e){return e&&e.dataItem?e.dataItem.recId:null}).items();if(e.selection.row>=0){var t=e.rows[e.selection.row];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.dataItem))return[t.dataItem.recId]}return[]},i.isMultiSelectionEnabled=function(e){return e.selectionMode===wijmo.grid.SelectionMode.ListBox},i.selectAllOrNothing=function(e){var t=e instanceof i?e.gridControl:e,o=t.selection,r=0==o.row&&0==o.col&&o.row2==t.rows.length-1&&o.col2==t.columns.length-1;r?t.select(-1,-1):t.rows.length&&t.select(new wijmo.grid.CellRange(0,0,t.rows.length-1,t.columns.length-1))},Object.defineProperty(i.prototype,"click",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.clickEvent)&&(this.clickEvent=new wijmo.Event,this.gridControl.hostElement.addEventListener(t.WijmoConstants.eventSingleClick,this.raiseClickEvent)),this.clickEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"touchStart",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.touchStartEvent)&&(this.touchStartEvent=new wijmo.Event,this.gridControl.hostElement.addEventListener(t.WijmoConstants.eventTouchStart,this.raiseTouchStartEvent)),this.touchStartEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"touchEnd",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.touchEndEvent)&&(this.touchEndEvent=new wijmo.Event,this.gridControl.hostElement.addEventListener(t.WijmoConstants.eventTouchEnd,this.raiseTouchEndEvent)),this.touchEndEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"touchMove",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.touchMoveEvent)&&(this.touchMoveEvent=new wijmo.Event,this.gridControl.hostElement.addEventListener(t.WijmoConstants.eventTouchMove,this.raiseTouchMoveEvent)),this.touchMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dblClick",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dblClickEvent)&&(this.dblClickEvent=new wijmo.Event,this.gridControl.hostElement.addEventListener(t.WijmoConstants.eventDoubleClick,this.raiseDblClickEvent)),this.dblClickEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mouseDown",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.mouseDownEvent)&&(this.mouseDownEvent=new wijmo.Event,this.gridControl.hostElement.addEventListener(t.GridConstants.eventMouseDown,this.raiseMouseDownEvent)),this.mouseDownEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mouseMove",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.mouseMoveEvent)&&(this.mouseMoveEvent=new wijmo.Event,t.GridUtils.isTouchScreenDevice(this.client)||this.gridControl.hostElement.addEventListener(t.WijmoConstants.eventMouseMove,this.raiseMouseMoveEvent)),this.mouseMoveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mouseLeave",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.mouseLeaveEvent)&&(this.mouseLeaveEvent=new wijmo.Event,this.gridControl.hostElement.addEventListener(t.WijmoConstants.eventMouseLeave,this.raiseMouseLeaveEvent)),this.mouseLeaveEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"keyDown",{get:function(){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.keyDownEvent)&&(this.keyDownEvent=new wijmo.Event,this.gridControl.hostElement.addEventListener(t.WijmoConstants.eventKeyDown,this.raiseKeyDownEvent)),this.keyDownEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"filterChanging",{get:function(){return this.gridFilter.filterChanging},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"filterChanged",{get:function(){return this.gridFilter.filterChanged},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gridHostingElement",{get:function(){return this.gridControl.hostElement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gridRoot",{get:function(){return $(this.gridControl.hostElement).find('div[wj-part="root"]')[0]},enumerable:!0,configurable:!0}),i.prototype.getScrollableElement=function(){return this.gridRoot},i.prototype.attachScrollHandler=function(e){var t=this.getScrollableElement();t&&t.addEventListener("scroll",e)},Object.defineProperty(i.prototype,"gridRowHeaderHostingElement",{get:function(){return this.gridControl.rowHeaders.hostElement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gridColumnHeaders",{get:function(){return this.gridControl.columnHeaders},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hiddenGridColumnHeaders",{get:function(){return this.gridControl.cells.hostElement.querySelectorAll("[role=columnheader]")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"saveButton",{get:function(){return this.saveBtn},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectAllButton",{get:function(){return this.selectAllBtn},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"refreshButton",{get:function(){return this.refreshBtn},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"collectionChanged",{get:function(){return this.collectionChangedEvent},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){if(this.updatedView.removeHandler(this.updatedViewHandler),this.keyDown.removeHandler(this.openFilterEditorHandler),this.unsubscribeCollectionChanged(),this.unsubscribeMouseEvents(),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl.hostElement)||this.gridControl.hostElement.removeEventListener(t.WijmoConstants.eventSingleClick,this.raiseClickEvent),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.saveBtn)||(this.saveBtn.removeEventListener(t.GridConstants.eventMouseDown,this.saveButtonMouseHandler),this.saveBtn.removeEventListener(t.WijmoConstants.eventKeyDown,this.saveButtonKeyboardHandler)),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.refreshBtn)||(this.refreshBtn.removeEventListener(t.GridConstants.eventMouseDown,this.refreshButtonMouseHandler),this.refreshBtn.removeEventListener(t.WijmoConstants.eventKeyDown,this.refreshButtonKeyboardHandler)),!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.hiddenGridColumnHeaders))for(var e=this.hiddenGridColumnHeaders,i=0;i<e.length;i++)e[i].removeEventListener("focus",this.focusColumnHeaderHandler),e[i].removeEventListener("blur",this.blurColumnHeaderHandler);this.gridControl.dispose(),this.gridFilter=null,this.gridControl=null,this.validations=null,this.clickEvent.removeAllHandlers(),this.clickEvent=null,this.touchStartEvent.removeAllHandlers(),this.touchStartEvent=null,this.touchEndEvent.removeAllHandlers(),this.touchEndEvent=null,this.touchMoveEvent.removeAllHandlers(),this.touchMoveEvent=null,this.dblClickEvent.removeAllHandlers(),this.dblClickEvent=null,this.typeProcessorService=null,this.timeZoneService=null,this.errorHandlingService=null,this.dataSetService=null,this.dataAdapterService=null,this.navigationService=null},i.prototype.getPageIndex=function(){return this.gridControl.itemsSource?this.gridControl.itemsSource.pageIndex:0},i.prototype.getPageCount=function(){return this.gridControl.itemsSource.pageCount},i.prototype.getCollectionDataView=function(){return this.gridControl.itemsSource},i.prototype.getColumnByName=function(e){return this.gridControl.columns.getColumn(e)},i.prototype.getGroupDescriptions=function(){return this.gridControl.itemsSource.groupDescriptions},i.prototype.setGroupHeaderFormat=function(e){this.gridControl.groupHeaderFormat=e},i.prototype.setShowGroups=function(e){this.gridControl.showGroups=e},i.prototype.finishEdit=function(){this.gridControl.finishEditing(!1)},i.prototype.hideHighlightedRow=function(){this.highlightedRow>=0&&this.gridControl.rows.length>this.highlightedRow&&(t.GridUtils.isUci()&&this.isRowSelected(this.highlightedRow)||(this.setRowBackground(this.highlightedRow),this.highlightedRow=-1))},i.prototype.cancelSelection=function(){this.gridControl.selection=new wijmo.grid.CellRange},i.prototype.blurCellSelection=function(e){e.tabIndex=-1,wijmo.toggleClass(e,"wj-state-selected",!1)},i.prototype.focusFirstCellOrLastSelectedCell=function(){if(!this.totalRowsCount||this.gridControl.selectedRows.length||wijmo.hasClass(wijmo.getActiveElement(),t.WijmoConstants.headerCSSClass)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl.collectionView)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl.collectionView.groupDescriptions)){var e=this.gridControl.cells.getCellElement(this.gridControl.selection.row,this.gridControl.selection.col);if(e)this.focusElement(e);else{var i=this.gridControl.cells.viewRange,o=i?i.row:0,r=this.gridControl.cells.getCellElement(o,1);this.focusElement(r)}}else{this.gridControl.selection=new wijmo.grid.CellRange(this.gridControl.collectionView.groupDescriptions.length,t.GridUtils.firstInformativeColumnIndex);var e=this.gridControl.cells.getCellElement(0,t.GridUtils.firstInformativeColumnIndex);this.focusElement(e)}},i.prototype.subscribeMouseEvents=function(){this.mouseMove.addHandler(this.handleHighlightRecordMouseMove),this.mouseLeave.addHandler(this.handleHighlightRecordMouseLeave)},i.prototype.unsubscribeMouseEvents=function(){this.mouseMove.removeHandler(this.handleHighlightRecordMouseMove),
this.mouseLeave.removeHandler(this.handleHighlightRecordMouseLeave)},i.prototype.getCellDefaultBackground=function(e){return t.GridUtils.isUci()?e.classList.contains(t.WijmoConstants.altCSSClass)?this.theming.colors.base.white:this.theming.colors.basecolor.grey.grey1:""},i.prototype.hexToRgb=function(e){if(!e||7!==e.length||"#"!==e[0])return"";var t=[parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16)];return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},i.prototype.areColorsDifferent=function(e,t){var i=this.hexToRgb(t);return e!==i},i.prototype.setRowBackground=function(e,i){var o=this;void 0===i&&(i="");var r=this.row(e);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)){r instanceof wijmo.grid.GroupRow&&(r.isSelected=!1);var n=!!i,s=this.containerService.getHostId(),a=MscrmCommon.ControlUtils.String.Format("#{0} div[{1}='{2}']",s,t.GridConstants.rowHeaderRowNumber,e),l=$(a).get(0);MscrmCommon.ControlUtils.Object.isNullOrUndefined(l)||l.classList.contains(t.WijmoConstants.detailCellCSSClass)||(l.style.background=i||this.getCellDefaultBackground(l),n?l.classList.add(t.GridConstants.headerCellHoverClass):l.classList.remove(t.GridConstants.headerCellHoverClass)),this.gridControl.columns.forEach(function(r,s){var a=o.gridControl.cells.getCellElement(e,s);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(a)&&!a.classList.contains(t.WijmoConstants.detailCellCSSClass)){var l=i||o.getCellDefaultBackground(a);if(o.areColorsDifferent(a.style.background,l)&&(a.style.background=l),t.GridUtils.isUci()){var c=a.firstElementChild;if(c){var d="A"===c.tagName,u=n?d?o.theming.colors.basecolor.blue.blue5:o.theming.colors.basecolor.black:d?o.theming.colors.basecolor.blue.blue4:o.theming.colors.basecolor.grey.grey7;o.areColorsDifferent(c.style.color,u)&&(c.style.color=u);var m=n?o.theming.fontfamilies.semibold:o.theming.fontfamilies.regular;c.style.fontFamily!==m&&(c.style.fontFamily=m)}}}})}},i.prototype.updateColumn=function(e,i){var o=this.gridControl.columns.getColumn(e);return null==o?void console.warn("Cannot find column to update, column name is "+e):(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.dataMap)||(this.getColumnTypeByName(e)===t.MscrmDataTypes.multiSelectOptionset&&(this.msosDataMaps[e]=i.dataMap),o.showDropDown=this.getColumnTypeByName(e)===t.MscrmDataTypes.optionset,o.dataMap=i.dataMap),MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.format)||(o.format=i.format),MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.inputType)||(o.inputType=i.inputType),MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.validations)||(this.validations[e]=i.validations),void(o.isRequired=!1))},i.prototype.getIndexedValue=function(e,t){return e[t]},i.prototype.setItemsSource=function(e){var t=this.selectedRows;this.unsubscribeCollectionChanged(),this.gridControl.itemsSource=e,this.subscribeCollectionChanged(e),this.collectionChangedEvent.hasHandlers&&this.collectionChanged.raise(this,wijmo.EventArgs.empty),this.setSelectedRecords(t)},i.prototype.setSelectedRecords=function(e){for(var t=function(t){var o=i.gridControl.rows[t];e.find(function(e){return e==o.dataItem.recId})&&(o.isSelected=!0)},i=this,o=0;o<this.gridControl.rows.length;o++)t(o)},i.prototype.subscribeCollectionChanged=function(e){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl.itemsSource)||e.groupDescriptions.collectionChanged.addHandler(this.onCollectionChangedEventHandler),this.columnsCollectionChanged.addHandler(this.onCollectionChangedEventHandler)},i.prototype.unsubscribeCollectionChanged=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl.itemsSource)||this.gridControl.itemsSource.groupDescriptions.collectionChanged.removeHandler(this.onCollectionChangedEventHandler),this.columnsCollectionChanged.removeHandler(this.onCollectionChangedEventHandler)},i.prototype.getGridEditRange=function(){return this.gridControl.editRange},i.prototype.getRowHeaderWidth=function(){return this.gridControl&&this.gridControl.rowHeaders?this.gridControl.rowHeaders.hostElement.clientWidth:0},i.prototype.handleKeyboardNavigation=function(e){var i=new wijmo.grid.HitTestInfo(e.target,null),o=-1===i.row;if((t.TypeUtils.isKeyCode(e,t.GridConstants.kbSpaceCode)||t.TypeUtils.isKeyCode(e,t.GridConstants.kbEnterCode))&&o&&1==i.col&&this.selectAllButtonAction(),t.TypeUtils.isKeyCode(e,t.GridConstants.kbTabCode)){var r=this.isEditable?2:1,n=this.totalRowsCount>0,s=o&&i.col===this.columns.length-r;e.shiftKey&&i.row>-1?this.blurCellSelection(e.target):!e.shiftKey&&s&&n?(e.preventDefault(),this.focusFirstCellOrLastSelectedCell()):!e.shiftKey&&i.row>-1&&this.blurCellSelection(e.target)}},i.prototype.getDataForMultiSelectPickListEditor=function(t,i){var o=[],r=this.dataSetService.records[i],n=r.getValue(t.binding),s=this.msosDataMaps[t.binding];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(s)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(s.collectionView)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(s.collectionView.items))for(var a=0;a<s.collectionView.items.length;a++)if(s.collectionView.items[a].Value&&!isNaN(s.collectionView.items[a].Value)){var l=parseInt(s.collectionView.items[a].Value),c=!1;if(n)for(var d=0;d<n.length;d++)if(n[d]===l){c=!0;break}var u=new e.MultiSelectPicklist.MultiselectPicklistItem("option",s.collectionView.items[a].Label,l,s.collectionView.items[a].Label,c);o.push(u)}return o},i.prototype.addLearningPathIDs=function(e){if(e.panel.cellType===wijmo.grid.CellType.ColumnHeader){var i=$(e.cell).parents('div[wj-part="ch"]');i.length>0&&this.learningPathService.addLearningPathIdToHtmlElement(e.cell,t.GridConstants.lpGridHeaderId),this.learningPathService.addLearningPathIdToHtmlElement(e.cell,t.GridConstants.lpGridColumnPrefixId+this.getColumnName(e.col))}else if(e.row>=0&&e.col>=0){var o=e.cell.parentElement;this.learningPathService.addLearningPathIdToHtmlElement(o,t.GridConstants.lpGridCellContainerId),this.learningPathService.addLearningPathIdToHtmlElement(e.cell,t.GridConstants.lpGridCellPrefixId+e.cell.getAttribute(t.GridConstants.dataId))}},i.prototype.applyCellsSelectionStyle=function(){for(var e=this.gridControl.rows.length,i=0;e>i;i++){var o=this.gridControl.cells.getCellElement(i,1),r=this.row(i);r instanceof wijmo.grid.GroupRow&&r.isCollapsed||o&&!o.classList.contains(t.WijmoConstants.detailCellCSSClass)&&this.applyCellSelectionStyle(r,o)}},i.prototype.renderUpdatedRecord=function(e,i,o){var r=this.dataAdapterService.updateGridRecordItem(i,o);if(this.refresh(),t.GridUtils.isTreeView(this.dataSetService.dataSet)){var n=this.dataAdapterService.getGridRecordItemsOnRecordUpdate(this.dataSetService.dataSet,i,this.gridFilter,r);MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)||this.render(n)}!MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)&&o.length>0&&this.updateStatusArea(t.StatusUpdateType.Unsaved)},i.prototype.updateStatusArea=function(e){var i=MscrmCommon.ControlUtils.String.Empty;switch(e){case t.StatusUpdateType.Unsaved:i=t.GridLocale.unsavedStatusLabel,MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.saveBtn)||(this.saveBtn.disabled=!1);break;case t.StatusUpdateType.Saving:i=t.GridLocale.savingStatusLabel;break;case t.StatusUpdateType.Saved:MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.saveBtn)||(this.saveBtn.disabled=!0);break;case t.StatusUpdateType.Refresh:i=t.GridLocale.refreshStatusLabel,MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.saveBtn)||(this.saveBtn.disabled=!0)}if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.statusAreaDiv)){var o=this.containerService.getContainerId();MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.parentComponent)||(o=this.parentComponent.containerService.getContainerId()),this.statusAreaDiv=$("#"+o+t.GridConstants.statusAreaPostfix)}!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.statusAreaDiv)&&this.statusAreaDiv.length>0&&(this.statusAreaDiv.text(i),MscrmCommon.ControlUtils.String.isNullOrEmpty(i)||this.ariaLiveRegionService.sendAssertiveMessage(i))},i.prototype.compareArrayValues=function(e,t){if(null==e&&null==t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var i=e.sort(),o=t.sort(),r=0;r<i.length;r++)if(i[r]!==o[r])return!1;return!0},i.prototype.getColumnType=function(e){var i=this.gridControl.columns[e];return t.GridUtils.getDatasetColumnByName(this.dataSetService.columns,i.binding).attributes.type},i.prototype.getColumnsCount=function(){return this.gridControl.columns.length},i.prototype.getColumnTypeByName=function(e){return t.GridUtils.getDatasetColumnByName(this.dataSetService.columns,e).attributes.type},i.prototype.formatDisplayValue=function(e,i,o,r){var n=this;if(o.cell.innerHTML="",!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)){if(t.GridUtils.isSelectAllBtnHeaderColumn(r.name))return void this.applyRowHeaderImage(this.gridControl.rows[o.row],o.cell);var s=t.GridUtils.getDatasetColumnByName(this.dataSetService.columns,r.binding);if(s&&s.attributes)if(!s||s.isPrimary||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSetService.dataSet.getCellImageInfo)){var a=t.GridUtils.getValueOrDefault(this.typeProcessorService.getValue(e,s,null,!0));MscrmCommon.ControlUtils.String.isNullOrEmpty(a)||o.cell.setAttribute(t.GridConstants.htmlTitleAttributeName,a),this.fieldFactory.updateCellView(o.cell,s,a,e.getRecordId(),null,null,this.factory,this.utils,this.client)}else{var l=o.row;this.dataSetService.dataSet.getCellImageInfo(s.name,i).then(function(r){var a=null,c=null;if(r&&(a=r.Url,c=r.Tooltip),n.row(l)&&n.gridControl.getCellData(l,0,!1)===i){var d=t.GridUtils.getValueOrDefault(n.typeProcessorService.getValue(e,s,null,!0));MscrmCommon.ControlUtils.String.isNullOrEmpty(d)||o.cell.setAttribute(t.GridConstants.htmlTitleAttributeName,d),n.fieldFactory.updateCellView(o.cell,s,d,e.getRecordId(),a,c,n.factory,n.utils,n.client)}})}}},i.prototype.formatDisplay=function(e,i,o){switch(o){case t.MscrmDataTypes.twoOptions:i.textContent=e;break;case t.MscrmDataTypes.lookup:i.textContent="";var r=document.createElement("span");r.classList.add(t.GridConstants.navigableCell),r.textContent=e,i.appendChild(r);break;case t.MscrmDataTypes.optionset:var n=!0;default:var s=!1;if($(i).contents().filter(function(){return this.nodeType===Node.TEXT_NODE&&(s=!0,!0)}).each(function(){this.textContent=this.textContent.split(/\S/)[0]+e}),!s){var a=document.createTextNode(e);n?$(i).prepend(a):$(i).append(a)}}},i.prototype.initAccessibilityExtender=function(){var e=this;if(wijmo.grid.accessibility){var t=new wijmo.grid.accessibility.AccessibilityExtender(this.gridControl);this.gridControl.sortedColumn.addHandler(function(i,o){var r=o.panel,n=i.columns[o.col],s=e.sortingInfo(r,n);t.alert("column "+n.header+" sorted in "+(0===s.sortDirection?"ascending":"descending")+" order")})}},i.prototype.applyCellSelectionStyle=function(e,i){var o=this,r=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e),n=!i.classList.contains(t.WijmoConstants.groupClass)&&e.isSelected||!this.isMultiSelectionEnabled&&this.gridControl.selection.row==e.index;if(r){var s=i.classList.contains(t.GridConstants.rowSelectedClass);if(n&&!s?i.classList.add(t.GridConstants.rowSelectedClass):!n&&s&&i.classList.remove(t.GridConstants.rowSelectedClass),t.GridUtils.isUci()){var a=n?this.theming.colors.maintheme.maincolor2.fill:"";this.applyAriaCheckBoxToTheCell(e,i,n),setTimeout(function(){o.setRowBackground(e.index,a)},10)}this.applyRowHeaderImage(e,i),t.GridUtils.isUci()&&(this.applyAriaSelectedToSelectedRow(e,n),this.applyAriaSelectedToAllSelectedCells(e,n))}},i.prototype.applyAriaSelectedToSelectedRow=function(e,t){var i=this;t||(this._applyAriaSelectedToSelectedRow(e,t),setTimeout(function(){i._applyAriaSelectedToSelectedRow(e,t)},0))},i.prototype._applyAriaSelectedToSelectedRow=function(e,t){var i=this.gridControl&&this.gridControl.cells&&this.gridControl.cells.hostElement&&this.gridControl.cells.hostElement.children&&this.gridControl.cells.hostElement.children[e.index+1];if(i){var o=i.hasAttribute("aria-selected");if(o){var r=i.getAttribute("aria-selected");t||"true"!==r?t&&"false"===r&&i.setAttribute("aria-selected","true"):i.setAttribute("aria-selected","false")}else i.setAttribute("aria-selected",t?"true":"false")}},i.prototype.applyAriaSelectedToAllSelectedCells=function(e,t){for(var i=this.gridControl.columns.length,o=1;i>o;++o){var r=this.gridControl.cells.getCellElement(e.index,o);if(r){var n=r.hasAttribute("aria-selected");if(n){var s=r.getAttribute("aria-selected");t||"true"!==s?t&&"false"===s&&r.setAttribute("aria-selected","true"):r.setAttribute("aria-selected","false")}else t?r.setAttribute("aria-selected","true"):r.setAttribute("aria-selected","false")}}},i.prototype.applyAriaCheckBoxToTheCell=function(e,i,o){var r=this.containerService.getContainerId(),n=r+"row-aria-checkbox-"+e.index,s=i.hasAttribute("aria-selected"),a=i.getAttribute("aria-selected");s?"true"!==a||o?"false"===a&&o&&i.setAttribute("aria-selected","true"):i.setAttribute("aria-selected","false"):o?i.setAttribute("aria-selected","true"):i.setAttribute("aria-selected","false");var l=document.getElementById(n);if(i.children.length&&l)s?"true"!==a||o?"false"===a&&o&&l.setAttribute("aria-checked","true"):l.setAttribute("aria-checked","false"):o?l.setAttribute("aria-checked","true"):l.setAttribute("aria-checked","false");else{l=document.createElement("div"),l.id=n,l.setAttribute("role","checkbox"),o?l.setAttribute("aria-checked","true"):l.setAttribute("aria-checked","false");var c=t.GridLocale.gridRowText;l.setAttribute("aria-label",c),i.appendChild(l)}},i.prototype.applyRowHeaderImage=function(e,t){var i=this;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSetService.dataSet.getCellImageInfo)){var o=this.gridControl.getCellData(e.index,0,!1),r=this.dataSetService.columns.find(function(e){return e.isPrimary&&!!e.imageProviderWebresource&&!!e.imageProviderFunctionName});if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)){t.style.textAlign=this.client.isRTL?"right":"left";var n=this.gridControl.columns,s=n;MscrmCommon.ControlUtils.Object.isNullOrUndefined(s[1])||(s[1].width=80,s[1].align=""),this.dataSetService.dataSet.getCellImageInfo(r.name,o).then(function(r){var n=null,s=null;if(r&&(n=r.Url,s=r.Tooltip),t.innerHTML="",n&&i.gridControl.getCellData(e.index,0,!1)===o){var a=document.createElement("img");a.src=n,s&&(a.alt=s),a.style.marginTop="2px",a.style.width="16px",a.style.height="16px",a.style.cssFloat=i.client.isRTL?"left":"right",t.appendChild(a)}})}}},i.prototype.switchNoRecordsLabelVisibility=function(){var e=this;!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridControl.itemsSource)&&this.gridControl.itemsSource.itemCount>0?(this.noRecordsDiv.style.display="none",this.noRecordsDiv.parentElement.style.overflow="hidden"):MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.noRecordsDiv)||(t.GridUtils.isUci()?(this.noRecordsDiv.style.display="block",this.noRecordsDiv.parentElement.style.overflow="auto",0!==this.noRecordsDebounce&&window.cancelAnimationFrame(this.noRecordsDebounce),this.noRecordsDebounce=window.requestAnimationFrame(function(){e.noRecordsDebounce=0;var i={fontSize:(e.noRecordsDiv.clientHeight<240?2:4.5)+"em",lineHeight:"100%",paddingBottom:"10px"},o={top:e.hideNestedGridColumnHeader==t.HideNestedGridColumnHeader.Yes?0:t.GridConstants.firstRowHeight+"px",bottom:0,left:0,width:"100%",height:"auto",position:"absolute",verticalAlign:"middle",textAlign:"center",color:e.theming.colors.basecolor.grey.grey5,fontSize:e.theming.fontsizes.sfontsize,fontFamily:e.theming.fontfamilies.regular},r=e.dataSetService.dataSet.hasError?{text:e.dataSetService.dataSet.errorMessage,icon:188,containerStyle:o,iconStyle:Object.assign(i,{color:"red"})}:{text:t.GridLocale.noRecordsText,icon:91,containerStyle:o,iconStyle:i},n=e.factory.createElement("PLACEHOLDER",r);e.utils.bindDOMElement(n,e.noRecordsDiv)})):this.noRecordsDiv.style.display="block")},Object.defineProperty(i.prototype,"isOffline",{get:function(){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.client.isOffline)&&this.client.isOffline()&&this.utils.isFeatureEnabled("MobileClientOffline")&&this.offline},enumerable:!0,configurable:!0}),i.prototype.saveButtonAction=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSetService)||this.dataSetService.beginRecordSave()},i.prototype.selectAllButtonAction=function(){i.selectAllOrNothing(this)},i.prototype.refreshButtonAction=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSetService)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSetService.dataSet)||(this.updateStatusArea(t.StatusUpdateType.Refresh),this.dataSetService.dataSet.refresh())},i.prototype.selectLastColumnHeader=function(){var e=this.getColumnIndex(t.GridConstants.btnHeaderColumnName),i=this.gridColumnHeaders.getCellElement(this.gridColumnHeaders.rows.length-1,e-1);MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||(this.focusElement(i),event.preventDefault())},i.prototype.selectFirstRowLastDataColumn=function(){var e=this.dataSetService.columns.length,t=this.gridControl.cells.getCellElement(0,e);this.gridControl.hostElement.focus(),this.focusElement(t),this.gridControl.select(0,e),event.preventDefault()},i.prototype.createHeaderButton=function(e,i,o,r,n){void 0===n&&(n=!1);var s=document.createElement("button");return s.title=e,s.classList.add(t.GridConstants.headerBtnClass),s.classList.add(i),s.addEventListener(t.GridConstants.eventMouseDown,o),s.addEventListener(t.WijmoConstants.eventKeyDown,r),s.disabled=n,s},i.prototype.enableKeyboardSupport=function(){this.hasKeyboardSupport=!0},i.prototype.hideColumns=function(e,t){var i=this;e.forEach(function(e){return i.gridControl.columns.getColumn(e).visible=!t})},i.prototype.isOfflineFeatureAvailable=function(){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.client.isOffline)&&this.client.isOffline()&&this.offline&&this.offline.isOfflineEnabled(this.mode.contextInfo.entityTypeName)},i}();t.WijmoGridComponent=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t="GridListContainer",i="ListSortingLiveRegion",o="modifiedon",r="GridList";e.entityImgUrlAlias="entityimage_url";var n;!function(e){e[e.Off=0]="Off",e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Perf=3]="Perf",e[e.Info=4]="Info",e[e.Verbose=5]="Verbose"}(n||(n={}));var s="6F3FB987-393B-4D2D-859F-9D0F0349B6AD",a=function(){function a(t,i,o){var r=this;this._cardStates={},this._cardFormState=0,this._formDescriptorControlDataSet={},this._hasEntityImage=!1,this._selectedItems=[],this._selectionMode=!1,this._hasFocusWhenSelected=void 0,this.resetTapHold=function(e){-1!==r._tapHoldTimer&&r.clearTimer()},this.onPointerDown=function(t,i){r._tapHoldTimer=setTimeout(function(){return r.tapHold(t,i)},e.WijmoConstants.tapHoldThreshold)},this.clearTimer=function(){r._tapHoldTimer&&(clearTimeout(r._tapHoldTimer),r._tapHoldTimer=null)},this.tapHold=function(e,t){r._tapHoldTimer=-1,r.OnSelectionModeChanged(),r._selectionMode&&r._onSelectionChanged(t),e.preventDefault()},this.setContext(t),this._container=i,this._listSortingPopup=new e.ListSortingPopupComponent(t,o,i,this),this._sortingService=new e.SortingService(this.dataSet,null,o)}return a.prototype.getFormDesctriptorControlDataSet=function(){return this._formDescriptorControlDataSet},Object.defineProperty(a.prototype,"selectedRecordIds",{get:function(){return this._selectedItems},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"IsSelectionMode",{get:function(){return this._selectionMode},enumerable:!0,configurable:!0}),a.prototype.getScrollableElement=function(){return this._scrollableElement},a.prototype.getListSortingPopup=function(){return this._listSortingPopup},a.prototype.getRenderedCellHeight=function(){return $(this.getScrollableElement()).children().first().outerHeight()},a.prototype.setProgressIndicator=function(t){if(t){switch(t){case e.ProgressIndicatorPosition.Top:var i=e.GridConstants.progressIndicatorSize;this._progressIndicatorDiv.style.top=i+"px",this._progressIndicatorDiv.style.bottom="auto";break;case e.ProgressIndicatorPosition.Bottom:this._progressIndicatorDiv.style.top="auto",this._progressIndicatorDiv.style.bottom="0"}this._progressIndicatorDiv.style.display="block"}else this._progressIndicatorDiv.style.display="none",this._progressIndicatorDiv.style.top=null,this._progressIndicatorDiv.style.bottom=null},Object.defineProperty(a.prototype,"onRecordsDataInit",{set:function(e){var t=this;this._recordsDataInit=function(i){e(i),t._recordsDataInit=null}},enumerable:!0,configurable:!0}),a.prototype.updateSourceCollection=function(e){this._recordIds=e,this._resetEntityAndConditionalImages(),this.render()},Object.defineProperty(a.prototype,"sortingService",{get:function(){return this._sortingService},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dataSet",{get:function(){return this._context.parameters.Grid},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"cardForm",{get:function(){return this._context.parameters.CardForm},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"componentContainerId",{get:function(){return this._isDefaultCardForm()?t+"AndHeader":t},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isCommandBarFlyoutMode",{get:function(){return!!this._activeCommandBarFlyoutId},enumerable:!0,configurable:!0}),a.prototype._isNonDefaultCardForm=function(){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.cardForm)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.cardForm.formDescriptor)},a.prototype._isNonDefaultCardFormInitialized=function(){return this._isNonDefaultCardForm()&&2===this.cardForm.formDescriptor.initialized},a.prototype._isDefaultCardForm=function(){var e=this._context.parameters.UseDefaultCardFormForList;return e&&e.raw},a.prototype.needsReRender=function(){return this._memoizedAllocatedHeight&&this._memoizedAllocatedWidth&&this._context.client&&this._context.client.allocatedHeight&&-1!==this._context.client.allocatedHeight&&this._context.client.allocatedWidth&&-1!==this._context.client.allocatedWidth&&(this._memoizedAllocatedHeight!==this._context.client.allocatedHeight||this._memoizedAllocatedWidth!==this._context.client.allocatedWidth)},a.prototype.streamQuickActionShortCut=function(e){var t=e.target,i=$(t).closest("li")[0],o=$(i).closest("div[id*=GridListContainerAndHeader]"),r=o.find("button")[0];r&&(r.focus(),e.preventDefault(),e.stopPropagation())},a.prototype.render=function(){var e=this,t=this.dataSet.getTargetEntityType();if(this._isNonDefaultCardForm()||this._isDefaultCardForm()){if(this._isNonDefaultCardForm()&&!this._isNonDefaultCardFormInitialized())return;if(0===this._cardFormState){if(this._cardFormState=1,this.cardForm&&this.cardForm.formDescriptor)this._runPostCardFormRetrievalJobs();else if(this._isDefaultCardForm()){var i=this._context.utils.retrieveFormWithAttributes(t,null,"Card"),o=this._context.utils.getEntityMetadata(t);Promise.all([i,o]).then(function(t){var i=t[0],o=t[1];o&&o.PrimaryImageAttribute&&(e._hasEntityImage=!0),i?(e._formDescriptorWithAttributes=i,e._runPostCardFormRetrievalJobs()):(e._cardFormState=2,e.createList(e))})}}else{if(1===this._cardFormState)return;this.createList(this)}}else this.createList(this)},a.prototype._runPostCardFormRetrievalJobs=function(){this._generateFormDescriptorInfo();var e=this._addColumnsToDataSet();e&&this.dataSet&&this.dataSet.refresh(),this._cardFormState=2,this.createList(this)},a.prototype._addColumnsToDataSet=function(){var t=[],i=this.dataSet.columns.map(function(e){return e.name});if(this._formDescriptorControlDataSet)for(var r in this._formDescriptorControlDataSet){var n=this._formDescriptorControlDataSet[r];if(n)for(var s in n)n[s].DataFieldName&&-1===i.indexOf(n[s].DataFieldName)&&(t.push(n[s].DataFieldName),this.dataSet.addColumn(n[s].DataFieldName))}var a=this.getAttributeDescriptorsByName();if(a)for(var l in a)-1===t.indexOf(l)&&-1===i.indexOf(l)&&(t.push(l),this.dataSet.addColumn(l));return this._isDefaultCardForm()&&(-1===t.indexOf(o)&&-1===i.indexOf(o)&&(t.push(o),this.dataSet.addColumn(o)),this._hasEntityImage&&-1===t.indexOf(e.entityImgUrlAlias)&&-1===i.indexOf(e.entityImgUrlAlias)&&(t.push(e.entityImgUrlAlias),this.dataSet.addColumn(e.entityImgUrlAlias))),!!t.length},a.prototype._generateFormDescriptorInfo=function(){var t=this.getFormDescriptor(),i=this.dataSet.getTargetEntityType();if(t)for(var o in a.CardFormSectionArray){var r=a.CardFormSectionArray[o];this._formDescriptorControlDataSet[r]=this._buildSectionControlInfo(r,t)}else"activitypointer"===i&&e.ActivityCardComponent.generateFormDescriptorInfoForActivityPointer(this._formDescriptorWithAttributes,this._formDescriptorControlDataSet)},a.prototype._buildSectionControlInfo=function(e,t){var i=[],o=t.Sections&&t.Sections[e];if(o||e!==a.ColorStrip||(o=t.Sections&&t.Sections[a.ColorStripDelimited]),o)if(o.Visible){var r=o.Rows;if(r)for(var l in r){var c=r[l];if(c.Visible){c.Cells.length||this._context.utils.log("GridListComponent","Row '"+l+"' has no cells. Section: '"+e+"'. Form: '"+t.Id.guid+"'",n.Verbose);for(var d in c.Cells){var u=c.Cells[d],m=t.Controls[u.ControlName];m?m.ClassId&&m.ClassId.guid?m.ClassId.guid.toUpperCase()!==s&&(m.DataFieldName?i.push(m):this._context.utils.log("GridListComponent","Control '"+u.ControlName+"' is missing DataFieldName. Section: '"+e+"'. Form: '"+t.Id.guid+"'",n.Error)):this._context.utils.log("GridListComponent","Control '"+u.ControlName+"' is missing ClassId. Section: '"+e+"'. Form: '"+t.Id.guid+"'",n.Error):this._context.utils.log("GridListComponent","No control with name '"+u.ControlName+"'. Section: '"+e+"'. Form: '"+t.Id.guid+"'",n.Error)}}else this._context.utils.log("GridListComponent","Row '"+l+"' is not visible, row.Visible="+c.Visible+". Section: '"+e+"'. Form: '"+t.Id.guid+"'",n.Verbose)}else this._context.utils.log("GridListComponent","Section: '"+e+"' has no rows. Form: '"+t.Id.guid+"'",n.Verbose)}else this._context.utils.log("GridListComponent","Section: '"+e+"' is not visible, section.Visible="+o.Visible+". Form: '"+t.Id.guid+"'",n.Verbose);else this._context.utils.log("GridListComponent","Form '"+t.Id.guid+"' is missing section '"+e+"'",n.Warning);return i},a.prototype.getFormDescriptor=function(){return this.cardForm&&this.cardForm.formDescriptor?this.cardForm.formDescriptor:this._formDescriptorWithAttributes?this._formDescriptorWithAttributes.formDescriptor:null},a.prototype.getFromDescriptorSectionControls=function(e){return this._formDescriptorControlDataSet?this._formDescriptorControlDataSet[e]:null},a.prototype.getAttributeDescriptorsByName=function(){return this._formDescriptorWithAttributes?this._formDescriptorWithAttributes.attributeDescriptors:null},a.prototype.getCardFormColorStripDataFieldname=function(){var e=this.getFromDescriptorSectionControls(a.ColorStrip);return e&&e[0]?e[0].DataFieldName:null},a.prototype.attachScrollHandler=function(e){var t=this;this._scrollHandler=function(i){t.clearTimer(),e(i)}},a.prototype.createList=function(t){var o=this;!this.dataSet.working&&this.loadConditionalImages().then(function(){o._conditionalImageLoadPromise=null;var n=o.dataSet.sortedRecordIds.length&&!o.dataSet.hasError,s=n?void 0:o._context.factory.createElement("PLACEHOLDER",o.dataSet.hasError?{text:o.dataSet.errorMessage,icon:188,iconStyle:{"font-size":"2em","font-weight":"normal",color:"red"}}:{text:e.GridLocale.noRecordsText,icon:91}),a=n?void 0:o._context.factory.createElement("LISTITEM",{},[s]),l=n?o._getListItems(t):a,c={display:"block",overflowY:"auto",overflowX:"hidden",height:"auto","& *:focus":{outlineOffset:"-1px"}};o._isDefaultCardForm()||(c=Object.assign({},c,{width:"100%"}),n||(c=Object.assign({},c,{height:"100%"})));var d=o._context.factory.createElement("SCROLLCONTAINER",{key:r,id:r,role:n?"grid":void 0,accessibilityLabel:o.dataSet.getTitle(),describedByElementId:o._context.accessibility.getUniqueId(i),semanticTag:"ul",style:c,className:o._context.decorators&&o._context.decorators.ClassName?""+o._context.decorators.ClassName:void 0,onScroll:o._scrollHandler,onKeyDown:function(t){var i=t.target,r=i.firstElementChild;o.IsSelectionMode&&t.keyCode===e.GridConstants.kbSpaceCode?(t.preventDefault(),r.click()):e.ListAccessibility.keyboardNavigation(t,r)}},l),u=[d];if(o._isDefaultCardForm()){o._listHeader||(o._listHeader=new e.ListHeaderComponent(o._context,o._requestRender.bind(o)));var m=o._listHeader.render(t);u.unshift(m)}var p=d;if(n||o._listHeader){var h={display:"flex",flexDirection:"column",height:"auto",backgroundColor:o._context.theming.colors.whitebackground,overflow:"hidden",width:"100%",position:"relative"};o._context.client&&o._context.client.allocatedHeight&&-1!==o._context.client.allocatedHeight&&(h=Object.assign(h,{maxHeight:o._context.client.allocatedHeight}),o._memoizedAllocatedHeight=o._context.client.allocatedHeight),o._context.client&&o._context.client.allocatedWidth&&-1!==o._context.client.allocatedWidth&&(o._memoizedAllocatedWidth=o._context.client.allocatedWidth),n&&u.push(o._getProgressIndicator(),o._renderSortLiveRegion()),p=o._context.factory.createElement("CONTAINER",{key:o.componentContainerId,id:o.componentContainerId,role:"presentation",style:h},u)}Object.assign(o._container.style,{display:"flex",flex:1}),o._context.utils.bindDOMElement(p,o._container),o._scrollableElement=o._container.querySelector("[id$='"+r+"']"),n&&o._setProgressIndicatorsDiv(o._container),n&&o._setFocusToFirstListItem(l)})},a.prototype._setFocusToFirstListItem=function(e){if(this._hasFocusWhenSelected===!1){var t=this;if(e&&e.length){var i=e,o=this._context.accessibility.getUniqueId(i[0].getComponentId());setTimeout(function(){var e=document.getElementById(o);e&&(e.focus(),t._hasFocusWhenSelected=!0)},0)}}},a.prototype._renderSortLiveRegion=function(){var t=this.dataSet.sorting[0],o=t&&this.dataSet.columns.find(function(e){var i=e.name;return i==t.name}),r=o?o.displayName:"",n=t&&a.getSortingNameByDirection(t.sortDirection),s=this._context.parameters.Grid.paging.totalResultCount+" "+MscrmCommon.ControlUtils.String.Format(e.GridLocale.sortedByColumnName,r,n);return this._context.factory.createElement("TEXT",{key:i,id:i,accessibilityLive:"assertive",accessibilityLabel:s,role:"alert",style:{display:"none"}},s)},a.getSortingNameByDirection=function(t){switch(t){case 0:return e.GridLocale.sortedByAscending;case 1:return e.GridLocale.sortedByDescending;case-1:return e.GridLocale.sortedByNone}},a.prototype.loadConditionalImages=function(){var e=this;if(this._conditionalImageLoadPromise)return this._conditionalImageLoadPromise;if(this._recordIds&&this._recordIds.length&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(this._entityImages)){this._entityImages={},this._conditionalImages={};var t=[];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet.getCellImageInfo)){var i=this.dataSet.columns.find(function(e){return e.isPrimary&&!!e.imageProviderWebresource&&!!e.imageProviderFunctionName}),o=this.dataSet.columns.find(function(e){return!e.isPrimary&&!!e.imageProviderWebresource&&!!e.imageProviderFunctionName});this._recordIds.forEach(function(r){var n=e._getEntityImageUrl(r);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i))e._entityImages[r]=n;else{var s=e.dataSet.getCellImageInfo(i.name,r).then(function(t){if(t){var i=t.Url;t.Tooltip;e._entityImages[r]=i?i:n}else e._entityImages[r]=n});t.push(s)}if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)){var s=e.dataSet.getCellImageInfo(o.name,r).then(function(t){if(t){var i=t.Url;t.Tooltip;e._conditionalImages[r]=i}});t.push(s)}})}return this._conditionalImageLoadPromise=Promise.all(t),this._conditionalImageLoadPromise}return this._entityImages&&this._recordIds.forEach(function(t){if(null==e._entityImages[t]){var i=e._getEntityImageUrl(t);
e._entityImages[t]=i,i&&(e._cardStates[t]=null)}}),Promise.resolve()},a.prototype._resetEntityAndConditionalImages=function(){this._entityImages=null,this._conditionalImages=null,this._conditionalImageLoadPromise=null},a.prototype._getEntityImageUrl=function(t){var i=this.dataSet.records[t],o=i&&i.getValue(e.entityImgUrlAlias);return o},a.prototype.setContext=function(e){this._context=e,this._recordsDataInit&&!this.dataSet.working&&this._recordsDataInit(this.dataSet),this._recordIds=this.dataSet.sortedRecordIds,this._resetEntityAndConditionalImages()},a.prototype.getSourceCollectionIds=function(){return this._recordIds},a.prototype._getProgressIndicator=function(){return e.ProgressIndicator.render(this._context.factory,"progressIndicatorDiv",!1)},a.prototype._setProgressIndicatorsDiv=function(e){this._progressIndicatorDiv=e.getElementsByClassName("indeterminateProgressRing").item(0)},a.prototype._getListItems=function(t){var i=this;return this._recordIds.map(function(o,r){var n=i.dataSet.records[o],s=i._cardStates[o]||(i._cardStates[o]=new e.ListItemComponent(i._context,n,t,i._entityImages[o],i._conditionalImages[o],i._onListItemClick.bind(i),i._toggleCommandBarFlyout.bind(i)));s.dataSetRecord=n;var a=i._activeCommandBarFlyoutId===o,l=i.IsSelectedItem(o),c=l?i._context.theming.colors.maintheme.maincolor2.fill:void 0,d=l||i.isCommandBarFlyoutMode?null:{backgroundColor:i._context.theming.colors.grays.gray03},u=r?"1px "+i._context.theming.solidborderstyle+" "+i._context.theming.colors.grays.gray03:void 0,m={listStyleType:"none",cursor:"pointer",borderTop:u,backgroundColor:c,":hover":d},p=s.render(i.IsSelectionMode,l,a,i.isCommandBarFlyoutMode),h=e.GridLocale.gridDataRowText+" "+s.getAccessibilityLabel(),g=Object.assign({role:"row"},h&&{accessibilityLabel:h},i.IsSelectionMode&&{isSelected:l});return i._context.factory.createElement("LISTITEM",Object.assign(g,{id:"ListItem_"+o,key:"ListItem_"+o,tabIndex:0,style:m,onKeyDown:function(e){e.ctrlKey&&e.altKey&&81===e.keyCode&&i.streamQuickActionShortCut(e)},onClick:function(e){return i._onListItemClick(e,n)},onClickCapture:i.resetTapHold,onPointerMove:i.resetTapHold,onTouchMove:i.resetTapHold,onPointerDown:i.isCommandBarFlyoutMode?null:function(e){return i.onPointerDown(e,o)}}),p)})},a.prototype.IsSelectedItem=function(e){return this._selectedItems.indexOf(e)>-1},a.prototype._onSelectionChanged=function(e){var t=this._selectedItems.indexOf(e);t>-1?this._selectedItems.splice(t,1):this._selectedItems.push(e),this.dataSet.setSelectedRecords(this._selectedItems),this._requestRender()},a.prototype._onListItemClick=function(t,i){var o=this;if(this.isCommandBarFlyoutMode||-1===this._tapHoldTimer)this.isCommandBarFlyoutMode&&this._toggleCommandBarFlyout();else{var r=i.getRecordId();if(this._selectionMode)this._onSelectionChanged(r);else{var n=i.getPrimaryEntityLogicalName(),s=new e.GridEntityReferenceModel(r,n);null==s||MscrmCommon.ControlUtils.String.isNullOrEmpty(s.LogicalName)||this._context.utils.getEntityMetadata(s.LogicalName).then(function(e){if(e&&e.IsBPFEntity){var t="Mscrm.HomepageGrid."+s.LogicalName+".OpenActiveStage",i={CommandButtonId:t};o._context.parameters.Grid.openDatasetItem(s,i)}else o._context.parameters.Grid.openDatasetItem(s,null)},function(e){o._context.parameters.Grid.openDatasetItem(s,null)})}}this.clearTimer(),t.preventDefault(),t.stopPropagation()},a.prototype._toggleCommandBarFlyout=function(e){this._activeCommandBarFlyoutId=e&&e!==this._activeCommandBarFlyoutId?e:null,this._requestRender()},a.prototype.OnSelectionModeChanged=function(){this._selectionMode=!this._selectionMode,this._selectedItems=[],this.dataSet.clearSelectedRecord(),this._hasFocusWhenSelected=!1,this._requestRender()},a.prototype._requestRender=function(){e.GridUtils.isForcedUpdate=!0,this._context.utils.requestRender()},a.prototype.getSortColumns=function(){var e=this.getAttributeDescriptorsByName(),t=[],i=[];this._isDefaultCardForm()||(t=this.dataSet.columns.slice(),i=t.map(function(e){return e.alias}));for(var r in e){var n=e[r];!n.IsSortableEnabled&&n.LogicalName!==o||-1!==i.indexOf(r)||(t.push({alias:r,displayName:n.DisplayName}),i.push(r))}return t},a.prototype.destroy=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this._context.utils.unbindDOMComponent)||this._context.utils.unbindDOMComponent(this.componentContainerId)},a.CardHeader="CardHeader",a.CardDetails="CardDetails",a.ColorStrip="ColorStrip",a.ColorStripDelimited="Color Strip",a.CardFooter="CardFooter",a.CardFormSectionArray=[a.CardHeader,a.CardDetails,a.ColorStrip,a.CardFooter],a}();e.ListComponent=a}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){this.listCommands=[],this.gridCommands=[]}return t.prototype.addCommandListener=function(t,i,o,r,n,s){void 0===n&&(n=""),void 0===s&&(s="");var a={Tooltip:{title:s},Icon:n,DisplayText:i,Id:o,execute:r};t===e.ViewType.List?this.listCommands.push(a):this.gridCommands.push(a)},t.prototype.fireListEvents=function(e){!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.utils.eventListenerExists)&&e.utils.eventListenerExists(t.SEND_CONTROL_COMMANDS_TO_HOST_COMMANDBAR)&&e.utils.fireEvent(t.SEND_CONTROL_COMMANDS_TO_HOST_COMMANDBAR,this.listCommands)},t.prototype.fireGridEvents=function(e){!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.utils.eventListenerExists)&&e.utils.eventListenerExists(t.SEND_CONTROL_COMMANDS_TO_HOST_COMMANDBAR)&&e.utils.fireEvent(t.SEND_CONTROL_COMMANDS_TO_HOST_COMMANDBAR,this.gridCommands)},t.prototype.disposeCommands=function(t){t===e.ViewType.List?this.listCommands=[]:this.gridCommands=[]},t.SEND_CONTROL_COMMANDS_TO_HOST_COMMANDBAR="sendgridcontrolcommandstohostcommandbar",t}();e.HostCommands=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t){void 0===t&&(t=""),this.fieldContainer=e,this.value=t,this.initComponent()}return e.prototype.initComponent=function(){this.rootElement=document.createElement("div"),this.rootElement.textContent=this.value,this.fieldContainer.appendChild(this.rootElement)},e.prototype.dispose=function(){this.fieldContainer.removeChild(this.rootElement)},e}();e.FieldBase=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o){this.fieldContainer=e,this.value=MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)?"":t,this.useSkypeProtocol=o,this.theming=i,this.initComponent()}return t.prototype.initComponent=function(){var e=this,t=document.createElement("a");t.textContent=this.value,t.title=this.value,t.href=this.value,t.tabIndex=-1,t.open=function(t){e.open(t)},t.style.fontSize=this.theming.fontsizes.font100,t.style.fontFamily=this.theming.fontfamilies.regular,t.style.color=this.theming.colors.basecolor.blue.blue4,t.style.display="inline-block",this.rootElement=t,this.fieldContainer.appendChild(this.rootElement)},t.prototype.dispose=function(){this.fieldContainer.removeChild(this.rootElement)},t.prototype.open=function(t){e.TypeUtils.stopEventPropagation(t),e.TypeUtils.preventDefault(t),this.rootElement.href&&window.open(this.rootElement.href,"_self")},t}();e.LinkFieldBase=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i){return e.call(this,t,i)||this}return __extends(t,e),t.prototype.initComponent=function(){this.rootElement=document.createElement("label"),this.rootElement.setAttribute("role","presentation"),this.rootElement.textContent=this.value;var e=this.fieldContainer.getElementsByTagName("label")[0];e&&e.parentNode?e.parentNode.replaceChild(this.rootElement,e):this.fieldContainer.appendChild(this.rootElement)},t}(e.FieldBase);e.LabelField=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o,r,n){var s=t.call(this,e,i,o)||this;return s.entityReference=r,s.navigationService=n,s}return __extends(i,t),i.prototype.initComponent=function(){var e=this;t.prototype.initComponent.call(this),this.rootElement.open=function(t){t.preventDefault(),t.stopPropagation(),e.open(t)},this.rootElement.href="#"},i.prototype.open=function(t){var i=this;e.TypeUtils.stopEventPropagation(t),e.TypeUtils.preventDefault(t),this.isNavigating||(setTimeout(function(){return i.isNavigating=!1},e.GridConstants.doubleTapThreshold),this.isNavigating=!0,this.navigationService.navigateToEntityForm(this.entityReference))},i}(e.LinkFieldBase);e.LookupField=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i,o){return e.call(this,t,i,o)||this}return __extends(t,e),t.prototype.initComponent=function(){e.prototype.initComponent.call(this),this.rootElement.href="mailto:"+this.value},t}(e.LinkFieldBase);e.EmailField=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i,o,r){return e.call(this,t,i,o,r)||this}return __extends(t,e),t.prototype.initComponent=function(){e.prototype.initComponent.call(this);var t,i="",o="";switch(this.useSkypeProtocol){case!0:t="skype",o="?call";break;case!1:t="ms-sfb",i="//call?id=";break;default:t="tel"}this.rootElement.href=t+":"+i+this.value+o},t}(e.LinkFieldBase);e.PhoneField=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i,o){return e.call(this,t,i,o)||this}return __extends(t,e),t.prototype.initComponent=function(){e.prototype.initComponent.call(this)},t}(e.LinkFieldBase);e.UrlField=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i){return e.call(this,t,i)||this}return __extends(t,e),t.prototype.initComponent=function(){this.rootElement=document.createElement("label"),this.rootElement.textContent=this.getStringRepresenation(JSON.parse(this.value)),this.fieldContainer.appendChild(this.rootElement)},t.prototype.getStringRepresenation=function(e){for(var t="",i="; ",o=0,r=e;o<r.length;o++){var n=r[o];t+=n+i}return t},t}(e.FieldBase);e.MultiSelectOptionField=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r){var n=this;this.linkElementCollection=new Array,this.openHandler=function(t){var i=n.getSelectedItemIndex();if(i>-1){var o=n.entityRecords[i].fields.partyid,r=o.reference&&o.reference.id&&o.reference.id.guid&&o.reference.id.guid.toString(),s=o.reference&&o.reference.etn;e.TypeUtils.stopEventPropagation(t),e.TypeUtils.preventDefault(t),n.dataSetService.dataSet.openDatasetItem(new e.GridEntityReferenceModel(r,s))}},this.getSelectedItemIndex=function(){for(var e=0;e<n.linkElementCollection.length;e++)if(n.linkElementCollection[e]==document.activeElement)return e;return-1},this.selectNextItem=function(t){var i=n.getSelectedItemIndex();i<n.linkElementCollection.length-1&&(e.TypeUtils.stopEventPropagation(t),e.TypeUtils.preventDefault(t),n.linkElementCollection[++i].focus())},this.selectPrevItem=function(t){var i=n.getSelectedItemIndex();-1==i&&(i=n.linkElementCollection.length),i>0&&(e.TypeUtils.stopEventPropagation(t),e.TypeUtils.preventDefault(t),n.linkElementCollection[--i].focus())},this.isFirstItemSelected=function(){return 0===n.getSelectedItemIndex()},this.isLastItemSelected=function(){return n.getSelectedItemIndex()===n.linkElementCollection.length-1},this.fieldContainer=t,this.entityRecords=i,this.dataSetService=o,this.theming=r,this.selectedItemIndex=-1,this.initComponent()}return t.prototype.initComponent=function(){var e=this,t=this.entityRecords.length-1;this.entityRecords.forEach(function(i,o){var r=i.fields.partyid,n=r.reference&&r.reference.name,s=e.createLinkElement(n);s.textContent=t>o?MscrmCommon.ControlUtils.String.Format("{0}; ",n):n,e.linkElementCollection.push(s),e.fieldContainer.appendChild(s)}),this.fieldContainer.selectNextItem=this.selectNextItem,this.fieldContainer.selectPrevItem=this.selectPrevItem,this.fieldContainer.isFirsItemSelected=this.isFirstItemSelected,this.fieldContainer.isLastItemSelected=this.isLastItemSelected},t.prototype.createLinkElement=function(e){var t=document.createElement("a");return t.title=e,t.href=e,t.tabIndex=-1,t.style.fontSize=this.theming.fontsizes.font100,t.style.setProperty(":hover",this.theming.colors.linkcolor.hover.text),t.style.setProperty(":visited",this.theming.colors.linkcolor.visited.text),t.style.setProperty(":link",this.theming.colors.linkcolor.normal.text),t.style.color=this.theming.colors.basecolor.blue.blue3,t.style.display="inline-block",t.open=this.openHandler,t},t.prototype.dispose=function(){this.fieldContainer.removeChild(this.rootElement)},t}();e.PartyListField=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r,n,s){this._context=e,this._props={dataSetRecord:t,entityImageUrl:o,conditionalImageUrl:r,onClickItem:n,onToggleCommandBarFlyout:s,entityName:t.getPrimaryEntityLogicalName(),entityPrimaryColumn:e.parameters.Grid.columns.find(function(e){return e.isPrimary})};var a=i.getFormDesctriptorControlDataSet();this._cardComponent=a&&Object.keys(a).length?this._createCardTemplate(i):this._createDefaultTemplate()}return Object.defineProperty(t.prototype,"dataSetRecord",{set:function(e){this._props.dataSetRecord!==e&&Object.assign(this._props,{dataSetRecord:e,entityName:e.getPrimaryEntityLogicalName()})},enumerable:!0,configurable:!0}),t.prototype.render=function(e,t,i,o){return this._cardComponent.state={isSelectionMode:e,isItemSelected:t,isCommandBarFlyoutOpened:i,isCommandBarFlyoutMode:o},this._cardComponent.render()},t.prototype.getAccessibilityLabel=function(){return this._cardComponent.getAccessibilityLabel()},t.prototype.getDescribedByElementId=function(){var e=this._cardComponent.getDescribedByElementId();return this._context.accessibility.getUniqueId(e)},t.prototype._createDefaultTemplate=function(){return new e.ListDefaultTemplate(this._context,this._props)},t.prototype._createCardTemplate=function(t){return new e.ListCardComponent(this._context,t,this._props)},t}();e.ListItemComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t="ListHeader",i="HeaderCommandBarCloseButton",o=function(){function o(e,t){this._context=e}return o.prototype.render=function(e){var i=this._getTitle(),o=null;if(!e.IsSelectionMode){var r=this._getIcon(),n=this._getRecordCount(e),s=this._getSortDropdown(e);o=this._context.factory.createElement("CONTAINER",{key:"ListHeaderLeft",id:"ListHeaderLeft",style:{display:"flex",flexDirection:"row",alignItems:"center",minWidth:0}},[r,n,s])}var a=this._getCommandBar(e),l=e.IsSelectionMode?this._getCloseCommandBarIcon(e):null,c=this._context.factory.createElement("CONTAINER",{key:"ListHeaderRight",id:"ListHeaderRight",style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",backgroundColor:e.IsSelectionMode?this._context.theming.colors.grays.gray07:void 0,width:e.IsSelectionMode?"100%":void 0}},e.IsSelectionMode?a.concat([l]):a),d=this._context.factory.createElement("CONTAINER",{key:"ListHeaderRow",id:"ListHeaderRow",style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:this._context.theming.measures.measure050,height:this._context.theming.measures.measure225}},e.IsSelectionMode?c:[o,c]),u=this._context.factory.createElement("CONTAINER",{key:t,id:t,style:{display:"flex",flexDirection:"column",flex:"0 0 auto",borderBottom:"1px "+this._context.theming.solidborderstyle+" "+this._context.theming.colors.grays.gray03,marginBottom:this._context.theming.measures.measure100}},[i,d]);return u},o.prototype._getTitle=function(){var t=this._context.factory.createElement("TEXT",{key:"HeaderTitleText",id:"HeaderTitleText",semanticTag:"h2",style:{fontSize:this._context.theming.fontsizes.font115,fontWeight:"normal",color:this._context.theming.colors.basecolor.blue.blue4,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}},this._context.parameters.Grid.getTitle?this._context.parameters.Grid.getTitle():""),i=this._context.parameters.Grid.getTargetEntityType(),o=!1;if("queueitem"===i)for(var r=this._context.parameters.Grid.filtering&&this._context.parameters.Grid.filtering.getFilter()&&this._context.parameters.Grid.filtering.getFilter().conditions,n=0,s=r;n<s.length;n++){var a=s[n];("objecttypecode"!==a.attributeName&&"queueid"!==a.attributeName||a.hasOwnProperty("entityName"))&&(o=!0)}else o=this._context.parameters.Grid.filtering&&this._context.parameters.Grid.filtering.getFilter()&&this._context.parameters.Grid.filtering.getFilter().conditions&&this._context.parameters.Grid.filtering.getFilter().conditions.length>0;var l=this._context.factory.createElement("CONTAINER",{key:"HeaderTitleTextContainer",id:"HeaderTitleTextContainer",title:this._context.parameters.Grid.getTitle?this._context.parameters.Grid.getTitle():"",style:{minWidth:"0"}},t),c=this._context.factory.createElement("TEXT",{key:"HeaderTitleFiltered",id:"HeaderTitleFiltered",style:{fontSize:this._context.theming.fontsizes.font085,color:this._context.theming.colors.basecolor.grey.grey5,paddingLeft:this._context.client.isRTL?void 0:this._context.theming.measures.measure100,paddingRight:this._context.client.isRTL?this._context.theming.measures.measure100:void 0},title:o?e.GridLocale.streamFiltered:e.GridLocale.streamUnfiltered},o?e.GridLocale.streamFiltered:e.GridLocale.streamUnfiltered),d=this._context.factory.createElement("CONTAINER",{key:"HeaderTitleFilteredContainer",id:"HeaderTitleFilteredContainer"},c),u=this._context.factory.createElement("CONTAINER",{key:"HeaderTitle",id:"HeaderTitle",style:{marginTop:this._context.theming.measures.measure025,height:this._context.theming.measures.measure225,marginBottom:this._context.theming.measures.measure025,alignItems:"center",justifyContent:"space-between",display:"flex"}},[l,d]);return u},o.prototype._getIcon=function(){var t=this._context.parameters.Grid.getTargetEntityType();if(t){var i=t.charAt(0).toUpperCase()+t.substring(1),o="incident"===t?84:e.CrmIconSymbol[i]||e.CrmIconSymbol[0],r="incident"===t?"MICROSOFTICON":"CRMICON",n=this._context.factory.createElement(r,{key:"HeaderIcon",id:"HeaderIcon",type:o,title:this._context.parameters.Grid.getTitle?this._context.parameters.Grid.getTitle():""}),s=this._context.factory.createElement("CONTAINER",{key:"HeaderIconContainer",id:"HeaderIconContainer",style:{fontSize:"16px",color:this._context.theming.colors.grays.gray05}},n);return s}return null},o.prototype._getRecordCount=function(t){var i=this._getSortAttribute(t),o=this._context.factory.createElement("MICROSOFTICON",{key:"HeaderSortArrow",id:"HeaderSortArrow",type:1===i.sortAttribute.sortDirection?59:58}),r=this._context.factory.createElement("CONTAINER",{key:"HeaderSortChevronWrapper",id:"HeaderSortChevronWrapper",style:{fontSize:"16px",color:this._context.theming.colors.grays.gray07,marginLeft:this._context.theming.measures.measure050,marginRight:this._context.theming.measures.measure075}},o),n="";n=1===i.sortAttribute.sortDirection?e.GridLocale.streamSortDescending:e.GridLocale.streamSortAscending;var s=this._context.parameters.Grid.paging.totalResultCount;n=s+" "+n;var a=this._context.factory.createElement("BUTTON",{key:"HeaderRecordCount",id:"HeaderRecordCount",title:n,accessibilityLabel:n,style:{background:"transparent",border:"0px none",marginLeft:this._context.theming.measures.measure075,fontSize:this._context.theming.fontsizes.font100,color:this._context.theming.colors.grays.gray07,alignItems:"center"},onClick:function(){i.isDefault&&t.sortingService.applySorting(i.sortAttribute.name),t.sortingService.applySorting(i.sortAttribute.name),t.sortingService.dataSet.refresh()}},[s,r]);return a},o.prototype._getSortDropdown=function(e){var t=this._getSortAttribute(e),i=this._context.factory.createElement("MICROSOFTICON",{key:"HeaderSortChevron",id:"HeaderSortChevron",type:72}),o=this._context.factory.createElement("CONTAINER",{key:"HeaderSortChevronWrapper",id:"HeaderSortChevronWrapper",accessibilityHidden:!0,style:{fontSize:"16px",color:this._context.theming.colors.grays.gray07,marginLeft:this._context.theming.measures.measure050,marginRight:this._context.theming.measures.measure075}},i),r=this._context.factory.createElement("TEXT",{key:"HeaderSortAttribute",id:"HeaderSortAttribute",role:"presentation",style:{fontSize:this._context.theming.fontsizes.font100,color:this._context.theming.colors.grays.gray07,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}},t.displayName),n=this._context.factory.createElement("CONTAINER",{key:"HeaderSortAttributeContainer",id:"HeaderSortAttributeConatiner",accessibilityHidden:!0,style:{minWidth:0}},r),s=this._context.factory.createElement("BUTTON",{key:e.getListSortingPopup().getSortButtonId(),id:e.getListSortingPopup().getSortButtonId(),role:"combobox",title:t.displayName,accessibilityLabel:t.displayName,accessibilityHasPopup:!0,accessibilityExpanded:e.getListSortingPopup().getSortPopupPopped(),style:{background:"transparent",border:"0px none",paddingRight:0,paddingLeft:0,minWidth:0},onClick:e.getListSortingPopup().renderSortingPopup.bind(e.getListSortingPopup())},[n,o]);return s},o.prototype._getSortAttribute=function(e){for(var t=null,i=null,o=e.getSortColumns(),r=e.sortingService.dataSet.sorting&&e.sortingService.dataSet.sorting[0],n=0,s=o;n<s.length;n++){var a=s[n];if(r&&r.name==a.alias)return{isDefault:!1,displayName:a.displayName,sortAttribute:r};if(!t&&(t=a.displayName,i=a.alias,!r))break}return{isDefault:!0,displayName:t,sortAttribute:{name:i,sortDirection:0}}},o.prototype._getCommandBar=function(e){var i=e.IsSelectionMode;if(!this._hasCommandBar){if(!i)return[this._getMultiSelectCommandBarButton(e)];this._hasCommandBar=!0}for(var o=e.selectedRecordIds,r=[],n=0,s=o;n<s.length;n++){var a=s[n],l=this._context.parameters.Grid.records[a];l&&r.push(l.getNamedReference())}var c=document.getElementById(this._context.accessibility.getUniqueId(t));if(c){var d=28,u=parseInt(window.getComputedStyle(c).width);u!=this.streamHeaderCommandBarWidth+d&&u&&(this.streamHeaderCommandBarWidth=u,this.streamHeaderCommandBarWidth-=d)}var m=this._context.factory.createElement("COMMANDBAR",{key:"HeaderCommandBar",id:"HeaderCommandBar",iconPosition:1,mainMenuLength:i?void 0:1,width:this.streamHeaderCommandBarWidth,ribbonId:"HomePageGrid:"+this._context.parameters.Grid.getTargetEntityType(),selectedRecords:r,isHidden:!i,customCommandManagerStyle:{margin:"0px",border:"0px none"},commandBarStyle:{container:{margin:"0px",border:"0px none"},list:{margin:"0px"},listItem:(p={margin:"0px",display:"flex",alignItems:"center"},p[this._context.client.isRTL?"paddingLeft":"paddingRight"]=this._context.theming.measures.measure100,p),listItemBody:{button:{display:"flex",alignItems:"center",fontSize:"16px",color:this._context.theming.colors.base.white,background:"transparent",border:"0px none",padding:"0px"},iconWrapperStyles:{display:"flex",alignItems:"center",marginLeft:this._context.theming.measures.measure100,marginRight:this._context.theming.measures.measure100,color:this._context.theming.colors.base.white},text:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"110px",color:this._context.theming.colors.base.white},icon:{color:this._context.theming.colors.base.white}},primaryOfSplitButton:(h={},h[this._context.client.isRTL?"marginLeft":"marginRight"]=this._context.theming.measures.measure100,h),moreIcon:{margin:i?void 0:"0px",marginLeft:i?this._context.theming.measures.measure100:void 0,marginRight:i?this._context.theming.measures.measure100:void 0,color:this._context.theming.colors.base.white},splitbuttonicon:{color:this._context.theming.colors.base.white},splitbuttonOverflowButton:(g={display:"flex",alignItems:"center"},g[this._context.client.isRTL?"paddingRight":"paddingLeft"]=this._context.theming.measures.measure050,g)}});return i?[m]:[m,this._getMultiSelectCommandBarButton(e)];var p,h,g},o.prototype._getCloseCommandBarIcon=function(t){var o=this,r=this._context.factory.createElement("MICROSOFTICON",{key:"HeaderCommandBarCloseIcon",id:"HeaderCommandBarCloseIcon",type:38}),n=this._context.factory.createElement("BUTTON",{key:i,id:i,title:e.GridLocale.closeButton,accessibilityLabel:e.GridLocale.closeButton,style:{fontSize:"16px",color:this._context.theming.colors.base.white,background:this._context.theming.colors.grays.gray07,border:"0px none",alignSelf:"center"},onClick:function(){t.OnSelectionModeChanged(),o._setFocus("button")}},r);return n},o.prototype._getMultiSelectCommandBarButton=function(t){var i=this,o="TwoOptions",r=e.CrmIconSymbol[o],n=this._context.factory.createElement("CRMICON",{key:"HeaderCommandBarCloseIcon",id:"HeaderCommandBarCloseIcon",type:r}),s=this._context.factory.createElement("BUTTON",{key:"HeaderCommandBarMultiSelectIcon",id:"HeaderCommandBarMultiSelectIcon",title:e.GridLocale.streamBulkOperations,accessibilityLabel:e.GridLocale.streamBulkOperations,accessibilityHasPopup:!0,style:{fontSize:"16px",color:this._context.theming.colors.grays.gray07,background:this._context.theming.colors.base.white,border:"0px none"},onClick:function(){t.OnSelectionModeChanged(),i._setFocus("ul > li")}},n);return s},o.prototype._setFocus=function(e){var t=this;window.setTimeout(function(){var i=t._context.accessibility.getUniqueId("ListHeaderRight"),o=document.getElementById(i),r=o.querySelector(e);r?r.focus():t._setFocus(e)},100)},o}();e.ListHeaderComponent=o}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t="ListItemLabel",i="CardCommandBar",o=i+"Button",r=function(){function r(t,i){this._state={isSelectionMode:!1,isItemSelected:!1,isCommandBarFlyoutOpened:!1,isCommandBarFlyoutMode:!1},this._context=t,this._props=i,this._gridTelemetry=new e.GridTelemetry(t.reporting),this._gridTelemetry.setDefaultEventParams(t.parameters)}return Object.defineProperty(r.prototype,"state",{set:function(e){Object.assign(this._state,e)},enumerable:!0,configurable:!0}),r.prototype.render=function(){var e=this,t=this._getAccessibilityFullDescription(),i=(this.getDescribedByElementId(),Object.assign({role:"gridcell"},t&&{accessibilityLabel:t},this._state.isSelectionMode&&{isSelected:this._state.isItemSelected})),o=this._props.dataSetRecord.getRecordId(),r=[this.renderEntityImage(),this._renderListItemContent()];return r.push(this._state.isSelectionMode?this.renderSelectionCheck():this.renderCommandBar(!0)),this._context.factory.createElement("CONTAINER",Object.assign(i,{key:"ListItemContainer_"+o,id:"ListItemContainer_"+o,style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between","font-size":this._context.theming.fontsizes.font100,"line-height":this._context.theming.measures.measure150,"font-family":this._context.theming.fontfamilies.regular,padding:this._context.theming.measures.measure100,height:this._context.theming.measures.measure450,"-webkit-transform":"translate3d(0, 0, 0)"},onClick:function(t){return e._props.onClickItem(t,e._props.dataSetRecord)}}),r)},r.prototype.getAccessibilityLabel=function(){var e=this;return this._getSectionColumns().filter(function(e){var t=e.isPrimary;return t}).map(function(t){var i=t.name,o=(t.displayName,t.dataType);return""+e._getFormattedValue(i,o)}).join(" ")},r.prototype.getDescribedByElementId=function(){var e=this._props.dataSetRecord.getRecordId();return"ListItemAriaDescribedBy_"+e},r.prototype._getAccessibilityFullDescription=function(){var e=this;return this._getSectionColumns().map(function(t){var i=t.name,o=(t.displayName,t.dataType);return""+e._getFormattedValue(i,o)}).join(" ")},r.prototype._getAccessibilityDescription=function(){var e=this;return this._getSectionColumns().filter(function(e){var t=e.isPrimary;return!t}).map(function(t){var i=t.name,o=(t.displayName,t.dataType);return""+e._getFormattedValue(i,o)}).join(", ")},r.prototype.renderEntityImage=function(){var e=this._props.entityImageUrl?(o={display:"block",justifyContent:"center",alignItems:"center",borderRadius:"50%",width:this._context.theming.measures.measure250,height:this._context.theming.measures.measure250,lineHeight:this._context.theming.measures.measure250,color:this._context.theming.colors.basecolor.white,fontSize:"16px",textAlign:"center"},o["margin"+(this._context.client.isRTL?"Left":"Right")]=this._context.theming.measures.measure100,o.overflow="hidden",o.maxWidth=this._context.theming.measures.measure250,o.maxHeight=this._context.theming.measures.measure250,o.backgroundColor="transparent",o):(r={borderRadius:"50%",display:"block",justifyContent:"center",alignItems:"center",width:this._context.theming.measures.measure250,height:this._context.theming.measures.measure250,lineHeight:this._context.theming.measures.measure250,color:this._context.theming.colors.basecolor.white,fontSize:"16px",textAlign:"center"},r["margin"+(this._context.client.isRTL?"Left":"Right")]=this._context.theming.measures.measure100,r.overflow="hidden",r),t=this._props.entityPrimaryColumn?this._getFormattedValue(this._props.entityPrimaryColumn.name,this._props.entityPrimaryColumn.dataType):MscrmCommon.ControlUtils.String.Empty,i=this._context.factory.createElement("ENTITYIMAGE",{key:"ListCardEntityImage",hasPrimaryImageField:!0,style:e,imageSrc:this._props.entityImageUrl,entityPrimaryField:t});return i;var o,r},r.prototype.renderCommandBar=function(r){var n=this;void 0===r&&(r=!1);var s=this._props.dataSetRecord.getRecordId(),a=!(this._context.parameters.EnableItemContextualActions&&this._context.parameters.EnableItemContextualActions.raw===!1);if(a){var l=o+"_"+s,c=i+"List_"+s,d=this._context.factory.createElement("MICROSOFTICON",{id:o+"Icon_"+s,key:o+"Icon_"+s,type:12,accessibilityHidden:!0}),u=this._getSectionColumns(1)[0],m=t+"_"+(u&&u.name)+"_"+s,p=this._context.factory.createElement("BUTTON",(C={id:l,key:l,accessibilityLabel:e.GridLocale.commandBarFlyoutOpenButton,describedByElementId:this._context.accessibility.getUniqueId(m),accessibilityHasPopup:!0,accessibilityExpanded:this._state.isCommandBarFlyoutOpened},C[this._state.isCommandBarFlyoutOpened?"ownsElementId":void 0]=this._context.accessibility.getUniqueId(c),C.role="button",C.tabIndex=0,C.onClick=function(e){e.preventDefault(),e.stopPropagation(),n._props.onToggleCommandBarFlyout(s)},C.style={backgroundColor:this._state.isCommandBarFlyoutOpened?this._context.theming.colors.grays.gray03:"transparent",borderStyle:this._context.theming.noneborderstyle,"line-height":"32px",width:"32px",padding:"0px","font-size":"16px",cursor:"pointer",color:this._context.theming.colors.grays.gray07,display:"block","text-align":"center"},C),[d]),h=null;this._state.isCommandBarFlyoutOpened&&(this._commands?h=this._renderCommandBarFlyout(l):this._context.parameters.Grid.retrieveRecordCommand([s],null,void 0,!0).then(function(t){void 0===t&&(t=[]);var i=t.filter(function(e){return e.shouldBeVisible&&("Button"===e.controlType||"SplitButton"===e.controlType)});n._commands=i||[],e.GridUtils.isForcedUpdate=!0,n._context.utils.requestRender()},function(e){n._gridTelemetry.reportFailure("renderCommandBar",e)}));var g=[p,h],f={display:"block",flex:"0 0 auto",alignSelf:"flex-start","margin-left":this._context.theming.measures.measure050};return r&&(Object.assign(f,{display:"flex","flex-direction":"column","justify-content":"space-between"}),
g.push(this.renderConditionalImage())),this._context.factory.createElement("CONTAINER",{key:"CardCommandContainer_"+s,id:"CardCommandContainer_"+s,style:f},g)}return null;var C},r.prototype._shouldDisplayColumn=function(e){var t=-1;return e&&!e.isHidden&&e.order!==t},r.prototype._getSectionColumns=function(t){void 0===t&&(t=3);var i=this._context.parameters.Grid.columns,o=i.length,r=[];this._shouldDisplayColumn(this._props.entityPrimaryColumn)&&r.push(this._props.entityPrimaryColumn);for(var n=0;o>n&&r.length<t;n++){var s=i[n];s.alias!==e.entityImgUrlAlias&&!s.isPrimary&&this._shouldDisplayColumn(s)&&r.push(s)}return r},r.prototype._renderCommandBarFlyout=function(t){var r=this,n=this._props.dataSetRecord.getRecordId(),s=this._commands.length?"CardCommandItem_"+this._commands[0].commandId+n:null,a=Math.max(document.documentElement.clientWidth,window.innerWidth||0),l=this._commands.map(function(t){var i=t.icon?e.MicrosoftIconSymbol[t.icon]:e.MicrosoftIconSymbol.Default,o=i?r._context.factory.createElement("MICROSOFTICON",{key:"CardCommandItemIcon_"+t.commandId,id:"CardCommandItemIcon_"+t.commandId,type:i,style:(a={},a["padding"+(r._context.client.isRTL?"Left":"Right")]=r._context.theming.measures.measure075,a),accessibilityHidden:!0}):null,s=r._context.factory.createElement("CONTAINER",{key:"CardCommandItemLabel_"+t.commandId,id:"CardCommandItemLabel_"+t.commandId,style:{display:"inline-block"}},t.label);return r._context.factory.createElement("LISTITEM",{key:"CardCommandItem_"+t.commandId+n,id:"CardCommandItem_"+t.commandId+n,tabIndex:0,role:"menuitem",style:{display:"block","line-height":r._context.theming.measures.measure250,"padding-left":r._context.theming.measures.measure150,"padding-right":r._context.theming.measures.measure150,"margin-top":r._context.theming.measures.measure075,"margin-bottom":r._context.theming.measures.measure075,"white-space":"nowrap",color:r._context.theming.colors.grays.gray07,"font-size":r._context.theming.fontsizes.font100,"font-family":r._context.theming.fontfamilies.regular,cursor:"pointer",backgroundColor:r._context.theming.colors.whitebackground,":hover":{backgroundColor:r._context.theming.colors.grays.gray03},":first-child":{"margin-top":r._context.theming.measures.measure150},":last-child":{"margin-bottom":r._context.theming.measures.measure150}},onClick:function(e){t.canExecute&&(t.execute(),e.preventDefault(),e.stopPropagation(),r._props.onToggleCommandBarFlyout())}},[o,s]);var a}),c=this._context.factory.createElement("LIST",{id:i+"List_"+n,key:i+"List_"+n,role:"menu",onKeyDown:function(t){return t.keyCode===e.GridConstants.kbEscapeCode?r._props.onToggleCommandBarFlyout():t.keyCode===e.GridConstants.kbTabCode?t.preventDefault():e.ListAccessibility.keyboardNavigation(t)}},l),d=this._context.factory.createElement("SCROLLCONTAINER",{id:i+"ListContainer_"+n,key:i+"ListContainer_"+n,style:{overflowY:"auto",width:"100%"}},c);return this._context.factory.createElement("FLYOUT",{id:i+"ListFlyout_"+n,key:i+"ListFlyout_"+n,focusElementId:s,flyoutDirection:7,flyoutStyle:Object.assign({boxShadow:this._context.theming.shadows.shadow01,borderStyle:"none",background:this._context.theming.colors.base.white},a<=parseInt(this._context.theming.breakpoints.dimensionxs)&&{width:"95%",margin:"0 2.5%"}),positionType:"relative",relativeToElementId:t,onOutsideClick:function(e){e.preventDefault(),e.stopPropagation();var t=e.target;t.id.includes(o)&&t.id.includes(n)||r._props.onToggleCommandBarFlyout()}},[d])},r.prototype._renderListItemContent=function(){var e=this,t=this._getSectionColumns().reduce(function(t,i){var o=i.name,r=i.dataType,n=i.isPrimary,s=e._getFormattedValue(o,r);return s&&t.push({name:o,fieldValue:s,isPrimary:n}),t},[]),i=(l={display:"block",flex:"1",overflow:"hidden","white-space":"nowrap"},l["margin"+(this._context.client.isRTL?"Left":"Right")]=this._context.theming.measures.measure025,l);if(1===t.length){var o=t[0],r=o.name,n=o.fieldValue,s=o.isPrimary;return this._renderLabel(n,r,s,i)}var a=t.map(function(t){var i=t.name,o=t.fieldValue,r=t.isPrimary;return e.renderField(o,i,r)});return this._context.factory.createElement("CONTAINER",{key:"ListItemContent_"+this._props.dataSetRecord.getRecordId(),id:"ListItemContent_"+this._props.dataSetRecord.getRecordId(),style:i},a);var l},r.prototype.renderField=function(e,t,i){return this._renderLabel(e,t,i)},r.prototype._getFormattedValue=function(t,i){var o=this._props.dataSetRecord,r=i==e.MscrmDataTypes.dataTypeWholeDuration;return r?o.reformatValue(t):o.getFormattedValue(t)},r.prototype._renderLabel=function(e,i,o,r){void 0===o&&(o=!1);var n=this._props.dataSetRecord.getRecordId(),s=t+"_"+i+"_"+n;return this._context.factory.createElement("LABEL",{key:s,id:s,style:Object.assign({},r,{display:"block","text-decoration":"none",overflow:"hidden","text-overflow":"ellipsis",cursor:"pointer",color:o?this._context.theming.colors.grays.gray07:this._context.theming.colors.grays.gray05})},e)},r.prototype.renderConditionalImage=function(){if(this._props.conditionalImageUrl){var e=this._context.factory.createElement("IMG",{key:"conditionalImage",source:this._props.conditionalImageUrl,style:{maxHeight:"32px",maxWidth:"32px",borderRadius:"50%",display:"block"}});return this._context.factory.createElement("CONTAINER",{key:"ListConditionalImage_"+this._props.dataSetRecord.getRecordId(),id:"ListConditionalImage_"+this._props.dataSetRecord.getRecordId(),style:{display:"flex",justifyContent:"center",alignItems:"center",flex:"0 0 32px",borderRadius:"50%",width:"32px",height:"32px",lineHeight:this._context.theming.measures.measure175,backgroundColor:this._context.theming.colors.grays.gray01,color:this._context.theming.colors.grays.gray07,fontSize:"16px",textAlign:"center"}},e)}return null},r.prototype.renderSelectionCheck=function(){var e=this._context.factory.createElement("MICROSOFTICON",{id:"selectionCheckBox_"+this._props.dataSetRecord.getRecordId(),key:"selectionCheckBox_"+this._props.dataSetRecord.getRecordId(),style:{cursor:"pointer"},type:this._state.isItemSelected?297:296},[]);return this._context.factory.createElement("CONTAINER",{key:"checkBoxContainer",style:(t={display:"flex",flexDirection:"column",justifyContent:"center",flex:"0 0 "+this._context.theming.measures.measure250,width:this._context.theming.measures.measure250,height:this._context.theming.measures.measure250,"align-items":"center","text-align":"center",color:this._context.theming.colors.grays.gray07},t["margin"+(this._context.client.isRTL?"Right":"Left")]=this._context.theming.measures.measure050,t.alignSelf="flex-start",t)},[e]);var t},r}();e.ListDefaultTemplate=r}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=0,i=1,o=function(o){function r(e,t,i){var r=o.call(this,e,i)||this;return r._parent=t,r._cardExpanded=r._context&&r._context.orgSettings&&r._context.orgSettings.boundDashboardDefaultCardExpanded,r._cardEverExpanded=r._cardExpanded,r}return __extends(r,o),r.prototype.render=function(){var e=this,t=this._getContent();return this._context.factory.createElement("CONTAINER",{key:"ListCard",id:"ListCard",role:"gridcell",onKeyDown:function(t){t.ctrlKey&&t.altKey&&81===t.keyCode&&e._parent.streamQuickActionShortCut(t)},onClick:function(t){return e._props.onClickItem(t,e._props.dataSetRecord)},style:this._getCardContainerStyle()},t)},r.prototype.getAccessibilityLabel=function(){return this._cardTitle?this._cardTitle:null},r.prototype.getDescribedByElementId=function(){return null},r.prototype._getFieldType=function(e){var t=this._context.parameters.Grid.columns;if(t){var i=t.find(function(t){return t.name===e});return i&&i.dataType}},r.prototype.renderField=function(t,i,o){var r,n=this,s=this._props.dataSetRecord,a=o?e.MscrmDataTypes.dataTypeLookupSimple:this._getFieldType(i);switch(a){case e.MscrmDataTypes.dataTypeLookupPartyList:for(var l=new Array,c=s.getValue(i),d=0;d<c.length;d++)if("unresolvedaddress"==c[d]._etn)l.push(t);else{var u=d==c.length-1?c[d].name:c[d].name+", ";r=this._context.factory.createElement("HYPERLINK",{key:"HyperLink_"+c[d].id,id:"HyperLink_"+c[d].id,tabIndex:d,style:{display:"inline",color:this._context.theming.colors.basecolor.blue.blue3,textDecoration:"none"},onClick:function(e){e.preventDefault(),e.stopPropagation();var t=e.target.tabIndex,o=s.getValue(i)[t];n._context.parameters.Grid.openDatasetItem(o)}},u),l.push(r)}r=this._context.factory.createElement("LIST",{key:"ListItemLookup_"+i+"_"+s.getRecordId(),id:"ListItemLookup_"+i+"_"+s.getRecordId(),style:{display:"inline",color:this._context.theming.colors.basecolor.blue.blue3,textDecoration:"none"}},l);break;case e.MscrmDataTypes.dataTypeLookupCustomer:case e.MscrmDataTypes.dataTypeLookupOwner:case e.MscrmDataTypes.dataTypeLookupRegarding:case e.MscrmDataTypes.dataTypeLookupSimple:r=this._context.factory.createElement("HYPERLINK",{key:"ListItemLookup",id:"ListItemLookup",style:{display:"block",color:this._context.theming.colors.basecolor.blue.blue3,textDecoration:"none"},onClick:function(t){t.preventDefault(),t.stopPropagation();var r=s.getValue(i);o&&(r=new e.GridEntityReferenceModel(s.getRecordId(),n._props.entityName)),n._context.parameters.Grid.openDatasetItem(r)}},t);break;case e.MscrmDataTypes.dataTypeSingleLineEmail:r=this._renderLink(t,"mailto:"+t);break;case e.MscrmDataTypes.dataTypeSingleLinePhone:r=this._renderLink(t,"tel:"+t);break;case e.MscrmDataTypes.dataTypeSingleLineURL:r=this._renderLink(t,t);break;case e.MscrmDataTypes.dataTypeWholeDuration:r=s.reformatValue(i);break;case e.MscrmDataTypes.dataTypeSingleLineTextArea:case e.MscrmDataTypes.dataTypeSingleLineTicker:case e.MscrmDataTypes.dataTypeTwoOptions:default:r=t}return r},r.prototype._renderLink=function(e,t){return this._context.factory.createElement("HYPERLINK",{key:"ListItemLink",href:t,style:{display:"block","text-decoration":"none",overflow:"hidden","text-overflow":"ellipsis",color:this._context.theming.colors.basecolor.blue.blue3}},e)},r.prototype._getStripColor=function(){var e=this._parent.getCardFormColorStripDataFieldname(),t=this._props.dataSetRecord.getFormattedValue(e);if(t){var i=this._parent.getAttributeDescriptorsByName(),o=i&&i[e];if(o&&o.OptionSet&&o.OptionSet.length>0)for(var r in o.OptionSet){var n=o.OptionSet[r];if(n.Label===t&&n.Color)return n.Color}}var s=this._props.entityName,a=s&&!MscrmCommon.ControlUtils.String.isNullOrEmpty(this._context.theming.getEntityColor(s))?this._context.theming.getEntityColor(s):this._context.theming.colors.defaultentity;return a},r.prototype._getContent=function(){var o=this._state.isSelectionMode?this.renderSelectionCheck():this.renderCommandBar(),r=this._renderSection(e.ListComponent.CardHeader,this._getHeaderSectionStyle(),this._getHeaderSectionFieldStyle(),[o]),n=this._renderSection(e.ListComponent.CardDetails,this._getDetailsSectionStyle(),this._getDetailsSectionFieldStyle(),null),s=this._getContainerStyle();s.alignItems="flex-start",s["margin-top"]=this._context.theming.measures.measure100,s["margin-bottom"]=this._context.theming.measures.measure100,this._cardExpanded||(s["white-space"]="nowrap");var a,l=this._context.factory.createElement("CONTAINER",{key:"CardDetails_"+this._props.dataSetRecord.getRecordId(),id:"CardDetails_"+this._props.dataSetRecord.getRecordId(),style:s},[this.renderEntityImage(),n]),c=this._getSectionFields(e.ListComponent.CardFooter,this._getFooterSectionFieldStyle());if(c.length>0){var d=this._renderButton(t,this.toggleButtonClickHandler.bind(this),this.toggleButtonKeyHandler.bind(this),this._cardExpanded),u=this._renderButton(i,this.toggleButtonClickHandler.bind(this),this.toggleButtonKeyHandler.bind(this),!this._cardExpanded);a=this._renderSection(e.ListComponent.ColorStrip,this._getStatusSectionStyle(),this._getStatusSectionFieldStyle(),[d,u])}else a=this._renderSection(e.ListComponent.ColorStrip,this._getStatusSectionStyle(),this._getStatusSectionFieldStyle());var m=[r,l,a];if(this._cardEverExpanded){var p=this._renderSection(e.ListComponent.CardFooter,this._getFooterSectionStyle(),this._getFooterSectionFieldStyle(),null,this._getFooterSectionLabelStyle());m.push(p)}return m},r.prototype._toggleButtonFocus=function(e){var t,o=e.currentTarget.id,r=o.substring(o.lastIndexOf("_")+1);t=r==i?e.currentTarget.parentElement.previousElementSibling.children[0]:e.currentTarget.parentElement.nextElementSibling.children[0];var n=this;window.setTimeout(function(){t?t.focus():n._toggleButtonFocus(e)},100)},r.prototype.toggleButtonClickHandler=function(e){e.preventDefault(),e.stopPropagation(),this._toggleButtonFocus(e),this._toggleListCard()},r.prototype.toggleButtonKeyHandler=function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),e.stopPropagation(),this._toggleButtonFocus(e),this._toggleListCard())},r.prototype._toggleListCard=function(){this._cardExpanded=!this._cardExpanded,this._cardEverExpanded=!0,e.GridUtils.isForcedUpdate=!0,this._context.utils.requestRender()},r.prototype._renderButton=function(t,o,r,n){var s=this._context.factory.createElement("MICROSOFTICON",{id:"ListCardButtonIcon_"+t,key:"ListCardButtonIcon_"+t,type:t}),a=this._context.factory.createElement("BUTTON",{id:"ListCardButton_"+t,key:"ListCardButton_"+t,title:t===i?e.GridLocale.listCardCollapseText:e.GridLocale.listCardExpandText,accessibilityLabel:t===i?e.GridLocale.listCardCollapseText:e.GridLocale.listCardExpandText,role:"button",tabIndex:0,onClick:o.bind(this),onKeyDown:r.bind(this),style:{backgroundColor:"transparent",borderStyle:this._context.theming.noneborderstyle,lineHeight:this._context.theming.fontsizes.font150,fontSize:this._context.theming.fontsizes.font100,color:this._context.theming.colors.grays.gray07,cursor:"pointer"}},[s]);return this._context.factory.createElement("CONTAINER",{key:"CardButtonContainer_"+t,id:"CardButtonContainer_"+t,style:{display:n?"none":"block"}},a)},r.prototype._renderSection=function(e,t,i,o,r){var n=this._createSection(e,t,i,r);if(o){var s=o;return n&&s.unshift(n),this._context.factory.createElement("CONTAINER",{key:"CardSectionWithControls_"+e,id:"CardSectionWithControls_"+e,style:this._getContainerStyle()},s)}return n},r.prototype._createSection=function(e,t,i,o){var r=this._getSectionFields(e,i,o);return this._context.factory.createElement("CONTAINER",{key:"CardSection_"+e,id:"CardSection_"+e,style:t||{}},r)},r.prototype._getSectionFields=function(t,i,o){var n,s=[],a=this._parent.getFromDescriptorSectionControls(t);if(a)for(var l in a){var c=a[l];if(c.ClassId.guid!==r.subGridClassId){var d=c.DataFieldName,u=this._props.dataSetRecord,m=u.getFormattedValue(d);if(m){var p=this.renderField(m,d,!1),h=i||{};0==s.length&&(h=Object.assign({"font-family":this._context.theming.fontfamilies.semibold,cursor:"pointer"},i)),t===e.ListComponent.ColorStrip&&(h=Object.assign({color:this._getStripColor(),textDecoration:"none"},i)),t===e.ListComponent.CardDetails&&(n=n?n+" "+m:m);var g=this._context.factory.createElement(t===e.ListComponent.ColorStrip?"HYPERLINK":"CONTAINER",{key:"FieldValue_"+d,id:"FieldValue_"+d,style:h},p);if(o){var f=this._context.factory.createElement("LABEL",{key:"FieldLabel_"+d,id:"FieldLabel_"+d,title:c.Label,accessibilityLabel:c.Label,style:o},c.Label),C=this._context.factory.createElement("CONTAINER",{key:"FieldContainer_"+d,id:"FieldContainer_"+d,style:this._getContainerStyle()},[g,f]);s.push(C)}else s.push(g)}}}return t===e.ListComponent.CardDetails&&(this._cardTitle=n),s},r.prototype._getContainerStyle=function(){return{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},r.prototype._getCardContainerStyle=function(){var e=this._getStripColor()||this._context.theming.colors.defaultentity;return t={display:"block",marginTop:this._context.theming.measures.measure100,marginBottom:this._context.theming.measures.measure100,":hover":{margin:0,paddingTop:this._context.theming.measures.measure100,paddingBottom:this._context.theming.measures.measure100}},t["padding"+(this._context.client.isRTL?"Right":"Left")]=this._context.theming.measures.measure100,t["border"+(this._context.client.isRTL?"Right":"Left")]=this._context.theming.measures.measure025+" "+this._context.theming.solidborderstyle+" "+e,t["font-size"]=this._context.theming.fontsizes.font100,t.color=this._context.theming.colors.grays.gray07,t["font-family"]=this._context.theming.fontfamilies.regular,t;var t},r.prototype._getHeaderSectionStyle=function(){return{display:"flex",flexDirection:"row",flexWrap:"wrap"}},r.prototype._getHeaderSectionFieldStyle=function(){return{display:"block",color:this._context.theming.colors.grays.gray05,"font-size":this._context.theming.fontsizes.font085,"margin-right":this._context.theming.measures.measure100,"font-family":this._context.theming.fontfamilies.regular,textOverflow:"ellipsis",overflow:"hidden","white-space":"nowrap","max-width":"20ch"}},r.prototype._getDetailsSectionStyle=function(){return{display:"block",flex:"1",overflow:"hidden","white-space":this._cardExpanded?"normal":"nowrap","max-height":this._cardExpanded?"":this._context.theming.measures.measure400}},r.prototype._getDetailsSectionFieldStyle=function(){return this._cardExpanded?{display:"block"}:{display:"block","text-overflow":"ellipsis",overflow:"hidden"}},r.prototype._getStatusSectionStyle=function(){return{display:"block","padding-left":this._context.client.isRTL?void 0:this._context.theming.measures.measure250,"margin-left":this._context.client.isRTL?void 0:this._context.theming.measures.measure100,"padding-right":this._context.client.isRTL?this._context.theming.measures.measure250:void 0,"margin-right":this._context.client.isRTL?this._context.theming.measures.measure100:void 0,"line-height":this._context.theming.measures.measure150,color:this._getStripColor()}},r.prototype._getStatusSectionFieldStyle=function(){return{display:"block","font-family":this._context.theming.fontfamilies.regular}},r.prototype._getFooterSectionStyle=function(){return{display:this._cardExpanded?"block":"none",overflow:"hidden","white-space":"normal","padding-bottom":this._context.theming.measures.measure100,"padding-left":this._context.theming.measures.measure100,"padding-right":this._context.theming.measures.measure100,"background-color":this._context.theming.colors.grays.gray01,"margin-top":this._context.theming.measures.measure050}},r.prototype._getFooterSectionFieldStyle=function(){return{display:"block","font-family":this._context.theming.fontfamilies.regular}},r.prototype._getFooterSectionLabelStyle=function(){return{"font-size":this._context.theming.fontsizes.font085,color:this._context.theming.colors.grays.gray05,alignSelf:"flex-end","white-space":"nowrap","margin-left":this._context.client.isRTL?void 0:this._context.theming.measures.measure100,"margin-right":this._context.client.isRTL?this._context.theming.measures.measure100:void 0}},r.subGridClassId="e7a81278-8635-4d9e-8d4d-59480b391c5b",r}(e.ListDefaultTemplate);e.ListCardComponent=o}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.keyboardNavigation=function(t,i){if(-1!==e.supportedKeys.indexOf(t.keyCode)){var o=t.target,r=t.currentTarget,n=r===o.parentElement,s=n?o:e.findListItem(o,r);switch(t.keyCode){case 38:var a=s.previousElementSibling;a&&a.focus(),t.preventDefault();break;case 40:var l=s.nextElementSibling;l&&l.focus(),t.preventDefault();break;case 36:if(n){var c=s.parentElement.firstElementChild;c&&c.focus()}break;case 35:if(n){var d=s.parentElement.lastElementChild;d&&d.focus()}break;case 13:(i||s).click()}}},e.findListItem=function(e,t){for(;e.parentElement!==t&&(e=e.parentElement););return e},e.supportedKeys=[38,40,13,36,35],e}();e.ListAccessibility=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r){this.theming=i,this.dataSetService=e,this.navigationService=t,this.useDefaultField=!1,this.communicationChannel=r,this.useSkypeProtocolProperty=o}return Object.defineProperty(t.prototype,"useSkypeProtocol",{get:function(){return this.useSkypeProtocolProperty?this.useSkypeProtocolProperty.raw:null},enumerable:!0,configurable:!0}),t.prototype.withDefaultField=function(){return this.useDefaultField=!0,this},t.prototype.updateCellView=function(t,i,o,r,n,s,a,l,c){if(void 0===n&&(n=null),void 0===s&&(s=null),!i.isPrimary&&i.imageProviderWebresource&&i.imageProviderFunctionName){var d=document.createElement("div");if(d.className="image-container",t.appendChild(d),n){var u=document.createElement("img");u.src=n,u.alt=s,d.appendChild(u)}}if(this.useDefaultField||o===e.WijmoConstants.undefinedString)return this.ShowGridPresence(t,i,r,a,l,c,o),void new e.LabelField(t,o);var m=i.isPrimary?e.MscrmDataTypes.dataTypeLookupSimple:i.dataType;switch(m){case e.MscrmDataTypes.dataTypeLookupCustomer:case e.MscrmDataTypes.dataTypeLookupOwner:case e.MscrmDataTypes.dataTypeLookupRegarding:case e.MscrmDataTypes.dataTypeLookupSimple:var p=this.ShowGridPresence(t,i,r,a,l,c,o);new e.LookupField(t,o,this.theming,p,this.navigationService);break;case e.MscrmDataTypes.dataTypeLookupPartyList:var h=!0,g=this.dataSetService.records[r]&&this.dataSetService.records[r].getValue(i.name);if(g)for(var f in g)if(!g[f].fields||!g[f].fields.partyid){h=!1;break}if(h)new e.PartyListField(t,g,this.dataSetService,this.theming);else{var C=this.dataSetService.records[r]&&this.dataSetService.records[r].getFormattedValue(i.name);new e.LabelField(t,C)}break;case e.MscrmDataTypes.dataTypeSingleLineEmail:new e.EmailField(t,o,this.theming);break;case e.MscrmDataTypes.dataTypeSingleLinePhone:new e.PhoneField(t,o,this.theming,this.useSkypeProtocol);break;case e.MscrmDataTypes.dataTypeSingleLineURL:new e.UrlField(t,o,this.theming);break;case e.MscrmDataTypes.dataTypeSingleLineTextArea:case e.MscrmDataTypes.dataTypeSingleLineTicker:case e.MscrmDataTypes.dataTypeTwoOptions:default:new e.LabelField(t,o)}},t.prototype.getEntityReferenceForElement=function(t,i,o){if(!i||!t)return null;var r=this.dataSetService.records[t],n=null;return n=o?new e.GridEntityReferenceModel(t,r.getPrimaryEntityLogicalName()):r.getValue(i)},t.prototype.ShowGridPresence=function(t,i,o,r,n,s,a){var l=null;if(l=this.getEntityReferenceForElement(o,i.name,i.isPrimary),l&&this.communicationChannel&&this.communicationChannel.isPresenceEnabled(l.LogicalName)){var c=new e.PresenceComponent(r,n,s);c.addPresence(t,null,{entityName:l.LogicalName,Id:l.Id.toString()},a)}return l},t}();e.FieldFactory=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r){this.grid=r,this.previous=t,this.next=o,this.first=e,this.current=i,this.loadingFirstPageOnServer=!1,this.loadingPreviousPageOnServer=!1,this.loadingNextPageOnServer=!1,this.hasPreviousPage=!1,this.hasNextPage=!1}return t.prototype.canGoBack=function(){return this.grid.getPageIndex()>0||this.hasPreviousPage},Object.defineProperty(t.prototype,"disablePagination",{set:function(e){this.previous.disabled=e||!this.canGoBack(),this.next.disabled=e||!this.hasNextPage,this.first.disabled=e||!this.canGoBack()},enumerable:!0,configurable:!0}),t.prototype.clickFirstPage=function(){this.first.click()},t.prototype.clickPreviousPage=function(){this.previous.click()},t.prototype.clickNextPage=function(){this.next.click()},t.prototype.addPreviousPageClicked=function(e){this.previous.addEventListener("click",e)},t.prototype.addNextPageClicked=function(e){this.next.addEventListener("click",e)},t.prototype.addFirstPageClicked=function(e){this.first.addEventListener("click",e)},t.prototype.removePreviousPageClicked=function(e){this.previous.removeEventListener("click",e)},t.prototype.removeNextPageClicked=function(e){this.next.removeEventListener("click",e)},t.prototype.removeFirstPageClicked=function(e){this.first.removeEventListener("click",e)},t.prototype.setPaginationButtonsState=function(t){var i=this.grid.getPageIndex(),o=this.grid.getPageCount();this.hasNextPage=t.paging.hasNextPage,this.hasPreviousPage=t.paging.hasPreviousPage,this.previous.disabled=!this.canGoBack(),this.next.disabled=(0===o||i===o-1)&&!this.hasNextPage,this.first.disabled=this.previous.disabled,this.current.innerText=MscrmCommon.ControlUtils.String.Format(e.GridLocale.currentPagingMask,e.GridUtils.isUci()?this.grid.getPageIndex()+1:"function"==typeof t.paging.get_currentPageNumber?t.paging.get_currentPageNumber():1)},t.prototype.markAsLoadingNextPage=function(){this.loadingNextPageOnServer=!0},t.prototype.markAsLoadingPreviousPage=function(){this.loadingPreviousPageOnServer=!0},t.prototype.markAsLoadingFirstPage=function(){this.loadingFirstPageOnServer=!0},t.prototype.ensureCorrectPage=function(e){var t=e;this.loadingFirstPageOnServer&&(t.moveToFirstPage(),t.currentItem=null,this.loadingFirstPageOnServer=!1),this.loadingPreviousPageOnServer&&(t.moveToPreviousPage(),t.currentItem=null,this.loadingPreviousPageOnServer=!1),this.loadingNextPageOnServer&&(t.moveToNextPage(),t.currentItem=null,this.loadingNextPageOnServer=!1)},t.prototype.getCurrentPageNumber=function(){return this.grid.getCollectionDataView().pageIndex},t.prototype.dispose=function(){this.grid=null},t}();e.PagingComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Bottom=2]="Bottom"}(t=e.ProgressIndicatorPosition||(e.ProgressIndicatorPosition={}));var i=function(){function t(){}return t.render=function(t,i,o){void 0===o&&(o=!0);var r=e.GridConstants.progressIndicatorSize+"px",n={width:r,height:r,margin:"0 auto"};return t.createElement("PROGRESSINDICATOR",{key:i,id:i,style:n,progressType:"ring",testhooks:{id:i+"_progressIndicator"},active:o},[])},t}();e.ProgressIndicator=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){var t=this;this.addGridScrolledListener=function(e){t.component.attachScrollHandler(e)},this.component=e}return e.prototype.removeGridScrolledListener=function(e){var t=this.component.getScrollableElement();t&&t.removeEventListener("scroll",e)},e.prototype.getRowHeight=function(){return this.component.getRenderedCellHeight()},e.prototype.getScrollHeight=function(){return $(this.component.getScrollableElement()).prop("scrollHeight")},e.prototype.getClientHeight=function(){return $(this.component.getScrollableElement()).prop("clientHeight")},e.prototype.getOffsetHeight=function(){return $(this.component.getScrollableElement()).prop("offsetHeight")},e.prototype.getScrollTop=function(){return $(this.component.getScrollableElement()).scrollTop()},e.prototype.scrollTop=function(e){$(this.component).scrollTop(e)},e.prototype.dispose=function(){this.component=null},e}();e.EnhancedPagingComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o){var r=this;this.onRowButtonClick=function(e){r.runButtonAction(e)},this.onRowButtonKeyDown=function(t){e.TypeUtils.isKeyCode(t,e.GridConstants.kbEnterCode)?r.runButtonAction(t):(e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowLeftCode)||e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowRightCode)||e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowUpCode)||e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowDownCode))&&r.rowButtonManager.handleKeyNavigation(t)},this.runButtonAction=function(t){null!=r.entityReference&&(e.TypeUtils.stopEventPropagation(t),r.run())},this.gridComponent=t,this.isRTL=i,this.buttonRow=-1,this.rowButtonManager=o,this.create()}return t.prototype.handleFormatItem=function(t){e.GridUtils.isBtnHeaderColumn(t.columnName)&&(t.row===this.buttonRow?this.append(t.cell):this.remove(t.cell))},t.prototype.handleScrollPositionChanged=function(){this.buttonRow=-1},t.prototype.isSameButtonElement=function(e){return this.button.isSameNode(e)},t.prototype.focus=function(){this.button.focus()},t.prototype.append=function(e){this.container.parentElement!==e&&e.appendChild(this.container)},t.prototype.remove=function(e){this.container.parentElement===e&&this.container.parentElement.removeChild(this.container)},t.prototype.reformatBtnHeaderCell=function(t){var i=this.gridComponent.getColumnIndex(e.GridConstants.btnHeaderColumnName),o=this.gridComponent.findCellHtml(t,i),r=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(o),n=!!r&&(o.parentElement.parentElement!==this.gridComponent.cells.hostElement||o.classList.contains(e.WijmoConstants.detailCellCSSClass));if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&r&&!n){var s=new wijmo.grid.CellRange(t,i,t,i);this.gridComponent.onFormatItem(new wijmo.grid.FormatItemEventArgs(this.gridComponent.cells,s,o))}},t.prototype.removeButton=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.container)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.container.parentElement)||this.container.parentElement.removeChild(this.container)},t.prototype.click=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.button)||this.button.click()},t.prototype.create=function(){this.container=document.createElement("div"),this.container.classList.add(e.WijmoConstants.inputGroupButtonCSSClass),this.container.style.cssFloat=this.isRTL?"left":"right",this.button=document.createElement("button"),this.button.tabIndex=-1,this.button.classList.add(e.GridConstants.rowBtnClass),this.button.classList.add(e.GridConstants.navigableCell),this.button.classList.add(e.WijmoConstants.buttonCSSClass),this.button.classList.add(e.WijmoConstants.buttonDefaultCSSClass),this.button.style.textDecoration="none",this.button.style.border="0px",this.button.addEventListener(e.GridConstants.eventMouseDown,this.onRowButtonClick),this.button.addEventListener(e.GridConstants.eventKeyDown,this.onRowButtonKeyDown),this.customize(),this.container.appendChild(this.button)},t.prototype.customize=function(){},t.prototype.run=function(){},t.prototype.dispose=function(){this.button.removeEventListener(e.GridConstants.eventMouseDown,this.onRowButtonClick),this.button.removeEventListener(e.GridConstants.eventKeyDown,this.onRowButtonKeyDown),this.entityReference=null,this.container=null,this.button=null},t}();e.RowButton=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r){this.gridComponent=e,this.dataSetService=t,this.navigationService=i,this.isRTL=o,this.isEditable=r}return t.prototype.createActiveRowButtons=function(e){var t=[],i=this.gridComponent.selectedRowsNumbers();if(this.gridComponent.selection.isSingleCell&&1==i.length){var o=i[0];this.createRowButtons(e,t,o)}return t},t.prototype.createRowButtons=function(i,o,r){var n=i.resolveEntityReference(r),s=null;if(n&&n.Id&&this.dataSetService){var a=this.dataSetService.getRecordById(n.Id);if(a){var l=a.getNamedReference();l&&l.Name&&(s=MscrmCommon.ControlUtils.String.Format(e.GridLocale.rowNavigationButtonTooltipSpecific,l.Name))}}o.push(t.createNavigationButton(this.gridComponent,this.navigationService,this.isRTL,i,r,n,s)),e.GridUtils.isDeleteButtonEnabled()&&o.push(t.createDeleteButton(this.gridComponent,this.isRTL,this.dataSetService,i,r,n))},t.prototype.createRowHoverButtons=function(e){var t=[];return this.createRowButtons(e,t,null),t},t.createNavigationButton=function(t,i,o,r,n,s,a){var l=new e.RowNavigationButton(t,i,o,r,a);return l.buttonRow=n,l.entityReference=s,l},t.createDeleteButton=function(t,i,o,r,n,s){var a=new e.RowDeleteButton(t,i,o,r);return a.buttonRow=n,a.entityReference=s,a},t}();e.RowButtonFactory=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(i,o,r,n,s){var a=t.call(this,i,r,n)||this;
return a.navigationService=o,a.button.title=s?s:e.GridLocale.rowNavigationButtonTooltip,a}return __extends(i,t),i.prototype.customize=function(){this.button.classList.add(e.GridConstants.rowBtnNavClass)},i.prototype.run=function(){this.navigationService.navigateToEntityForm(this.entityReference)},i}(e.RowButton);e.RowNavigationButton=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o,r){var n=t.call(this,e,i,r)||this;return n.dataSetService=o,n}return __extends(i,t),i.prototype.customize=function(){this.button.classList.add(e.GridConstants.rowBtnDeleteClass),this.button.title=e.GridLocale.rowDeleteButtonTooltip},i.prototype.run=function(){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.entityReference))if(e.GridUtils.isUci()){var t=[this.entityReference.Id.toString()],i=["Mscrm.DeleteSelectedRecord","Mscrm.HomepageGrid.[entityName].DeleteMenu".replace("[entityName]",this.entityReference.LogicalName)];this.dataSetService.dataSet.retrieveRecordCommand(t,i).done(function(e){!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)&&1==e.length&&e[0].canExecute&&e[0].execute()}).fail(function(e){console.error(e.message)})}else this.dataSetService.dataSet.deleteEntityAndRefresh(this.entityReference.Id.toString(),this.entityReference.LogicalName)},i.prototype.onDeleteSuccess=function(e){},i.prototype.onDeleteFail=function(e){},i}(e.RowButton);e.RowDeleteButton=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o,r,n,s,a,l){var c=this;this.selectionChangedHandler=function(e,t){for(var i=0,o=c.activeRowButtons;i<o.length;i++){var r=o[i];r.removeButton(),r.dispose()}if(c.activeRowButtons.length=0,c.activeRowButtons=c.rowButtonFactory.createActiveRowButtons(c),c.activeRowButtons.length>0){if(c.gridComponent.selection.col===c.gridComponent.selection.col2&&c.gridComponent.selection.col===c.gridComponent.getColumnsCount()-1){var n=c.activeRowButtons[c.activeRowButtons.length-1];window.setTimeout(function(){n.focus()},200)}c.gridComponent.refresh()}},this.handleMouseMoveForRow=function(e,t){var i=c.gridComponent.hitTest(t),o=c.hoverRow;MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.panel)||i.panel.cellType!==wijmo.grid.CellType.Cell?c.hoverRow=-1:c.hoverRow=i.row,c.onHoverRowUpdate(o)},this.handleMouseLeaveForRow=function(e,t){c.hoverRow=-1},this.gridComponent=t,this.dataSetService=i,this.isRTL=s,this.utils=a,this.hoverRow=-1,this.hoverRowButtons=[],this.activeRowButtons=[],this.navigation=o,this.navigationService=r,this.webAPI=n,this.rowButtonFactory=new e.RowButtonFactory(t,i,r,s,l),t.mouseMove.addHandler(this.handleMouseMoveForRow),t.mouseLeave.addHandler(this.handleMouseLeaveForRow),t.selectionChanged.addHandler(this.selectionChangedHandler),this.hoverRowButtons=this.rowButtonFactory.createRowHoverButtons(this)}return Object.defineProperty(t.prototype,"selectedRowsButtons",{get:function(){return this.activeRowButtons},enumerable:!0,configurable:!0}),t.prototype.onHoverRowUpdate=function(e){if(!(e===this.hoverRow||e>=this.gridComponent.totalRowsCount)){for(var t=0,i=this.hoverRowButtons;t<i.length;t++){var o=i[t];o.buttonRow=this.hoverRow}this.refreshEntityReference(this.hoverRow),e>=0&&this.reformatBtnHeaderCell(e),this.hoverRow>=0&&this.reformatBtnHeaderCell(this.hoverRow)}},t.prototype.reformatBtnHeaderCell=function(e){for(var t=0,i=this.hoverRowButtons;t<i.length;t++){var o=i[t];o.reformatBtnHeaderCell(e)}},t.prototype.refreshEntityReference=function(e){var t=this.resolveEntityReference(e);this.entityReference=t;for(var i=0,o=this.hoverRowButtons;i<o.length;i++){var r=o[i];r.entityReference=t}},t.prototype.handleKeyNavigation=function(t){for(var i=0;i<this.activeRowButtons.length;i++)if(this.activeRowButtons[i].isSameButtonElement(t.srcElement)){var o=e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowRightCode)?--i:++i;if(o>=0&&o<this.activeRowButtons.length&&!e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowUpCode)&&!e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowDownCode))e.TypeUtils.preventDefault(t),this.activeRowButtons[o].focus();else{var r=this.gridComponent.selection;e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowLeftCode)?r.col=r.col2=--r.col:e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowUpCode)?r.row=r.row2=--r.row:e.TypeUtils.isKeyCode(t,e.GridConstants.kbArrowDownCode)&&(r.row=r.row2=++r.row),r.row>=0&&r.row<this.gridComponent.totalRowsCount&&this.gridComponent.select(r)}return}},t.prototype.resolveEntityReference=function(t){var i=null,o=null,r=null;return t>=0&&(i=this.gridComponent.getCellData(t,0,!1)),MscrmCommon.ControlUtils.String.isNullUndefinedOrWhitespace(i)||(o=this.dataSetService.records[i]),MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||(r=new e.GridEntityReferenceModel(o.getRecordId(),o.getPrimaryEntityLogicalName())),r},t.prototype.handleScrollPositionChanged=function(){this.hoverRow=-1;for(var e=0,t=this.hoverRowButtons;e<t.length;e++){var i=t[e];i.handleScrollPositionChanged()}},t.prototype.handleFormatItem=function(e){for(var t=!1,i=0,o=this.activeRowButtons;i<o.length;i++){var r=o[i];r.handleFormatItem(e),r.buttonRow==e.row&&(t=!0)}for(var n=0,s=this.hoverRowButtons;n<s.length;n++){var r=s[n];t||r.handleFormatItem(e)}},t.prototype.dispose=function(){for(var e=0,t=this.hoverRowButtons;e<t.length;e++){var i=t[e];i.dispose()}for(var o=0,r=this.activeRowButtons;o<r.length;o++){var i=r[o];i.dispose()}this.gridComponent.selectionChanged.removeHandler(this.selectionChangedHandler),this.entityReference=null},t}();e.RowButtonManager=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.eventDoubleClick="dblclick",e.eventSingleClick="click",e.eventTouchStart="touchstart",e.eventTouchEnd="touchend",e.eventTouchMove="touchmove",e.eventKeyDown="keydown",e.eventMouseMove="mousemove",e.eventMouseLeave="mouseleave",e.eventMouseScroll="scroll",e.eventWindowResize="resize",e.tapHoldThreshold=800,e.virtualizationThreshold=750,e.defaultListViewMinWidth=309,e.listViewModeThreshold=480,e.defaultMinWidth=20,e.specialColumnsWidth=70,e.specialColumnWithConditionalImageWidth=105,e.navigateButtonMinimumWidth=45,e.selectButtonMinimumWidth=45,e.selectButtonWithConditionalImageMinimumWidth=80,e.columnSeparatorWidth=1,e.defaultMinRowHeight=52,e.defaultMinRowHeightWeb=40,e.pagerHeight=40,e.maxColumnForDynamicSizing=12,e.scrollBarWidth=17,e.inputDateRatio="53%",e.inputTimeRatio="47%",e.expandFactor=5,e.maxRowHeight=200,e.maxSubGridHeight=400,e.undefinedString="---",e.notReadableString="*******",e.headerCSSClass="wj-header",e.cellsCSSClass="wj-cells",e.cellCSSClass="wj-cell",e.errorIndicatorCSSClass="errorIndicator cc-grid-errorIndicator",e.treeArrowRightCSSClass="wj-glyph-right",e.treeArrowDownRightCSSClass="wj-glyph-down-right",e.rowHeadersCSSClass="wj-rowheaders",e.detailCellCSSClass="wj-detail",e.inputGroupButtonCSSClass="wj-input-group-btn",e.buttonDefaultCSSClass="wj-btn-default",e.buttonCSSClass="wj-btn",e.wordWrapCSSClass="wj-wrap",e.groupClass="wj-group",e.filterOffCSSClass="wj-filter-off",e.filterOnCSSClass="wj-filter-on",e.altCSSClass="wj-alt",e.cellIndexKey="wj-cell-index",e.durationMaxDay=31,e.durationMaxHour=23,e.durationMaxMinute=59,e.minutesInOneDay=1440,e.minutesInOneHour=60,e.durationInputRatio="30%",e.durationEditorMinWidth=190,e.durationEditorCssClass="duration-editor",e.maxDropDownHeight=250,e.msosId="gridMSOSCustomEditor",e.currentSelectionContainerRowHeight=26,e.moreLessTextHeight=15,e.normalFontSize="13px",e.themingMeasure300="3.00rem",e}();e.WijmoConstants=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.notReadableCSSClass="cc-gridcell-not-readable",e.securedCSSClass="cc-gridcell-secured",e.requiredCSSClass="cc-gridcell-required",e.recommendedCSSClass="cc-gridcell-recommended",e.notEditableCSSClass="cc-gridcell-not-editable",e}();e.FieldAccessConstants=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.eventMouseDown="mousedown",e.eventMouseClick="click",e.eventKeyDown="keydown",e.eventFocus="focus",e.doubleTapThreshold=500,e.controlDivPostfix="_control",e.componentDivPostfix="_component",e.groupBySelectPostfix="_groupBySelect",e.genericErrorPostfix="_genericError",e.searchPlaceholderPostfix="_searchPlaceholder",e.updateErrorPostfix="_updateError",e.pagerPostfix="_pager",e.firstPagePostfix="_firstPage",e.previousPagePostfix="_previousPage",e.nextPagePostfix="_nextPage",e.noRecordsPostfix="_noRecords",e.ariaPoliteLiveRegionPostfix="_ariaPoliteLiveRegion",e.ariaAssertiveLiveRegionPostfix="_ariaAssertiveLiveRegion",e.statusAreaPostfix="_statusArea",e.labelPostfix="_label",e.valuePostfix="_value",e.instructionPostfix="_instruction",e.cellErrorMessagePostfix="_error_message",e.progressIndicatorPostfix="_progressIndicator",e.tabIndex="tabindex",e.dataId="data-id",e.cellId="id",e.role="role",e.dataRowCount="data-row-count",e.dataColumnCount="data-col-count",e.rowHeaderRowNumber="header-row-number",e.dataType="data-type",e.ariaDescribedBy="aria-describedby",e.ariaRequired="aria-required",e.ariaReadOnly="aria-readonly",e.ariaInvalid="aria-invalid",e.ariaLabel="aria-label",e.ariaLabelledBy="aria-labelledby",e.ariaSort="aria-sort",e.stateGridLayout="gridColumnLayout",e.nonBreakingSpace=String.fromCharCode(160),e.OptionSetValue="Value",e.OptionSetLabel="Label",e.appBarClass="data-selectable",e.rowSelectedClass="cc-grid-selectedRow",e.noRecordsLabelClass="cc-grid-noRecordslabel",e.noRecordsContainerClass="cc-grid-noRecords-Container",e.navigableCell="cc-gridcell-navigable",e.rollupIconClass="cc-gridcell-rollup-icon",e.rollupDateClass="cc-gridcell-rollup-date",e.rowNavigatorClass="row-navigator",e.lookupNavigationButtonClass="cc-lookup-nav-button",e.headerCellHoverClass="cc-grid-rowHover",e.groupHeaderCellClass="data-group-selectable",e.gridProgressIndicatorClass="cc-grid-progressIndicator",e.headerButtonsClass="cc-ds-header-buttons",e.headerButtonsLeftClass="cc-ds-header-buttons-left",e.headerBtnClass="cc-ds-headerbtn",e.headerBtnRefreshClass="cc-ds-header-refresh-btn",e.headerBtnSelectClass="cc-ds-header-select-all-btn",e.headerBtnSaveClass="cc-ds-header-save-btn",e.rowBtnClass="cc-ds-rowbtn",e.rowBtnNavClass="cc-ds-rowbtn-nav",e.rowBtnDeleteClass="cc-ds-rowbtn-delete",e.calendarIconGlyph="cc-grid-calendar-icon",e.nestedGridDetailClass="cc-grid-detail",e.nestedGridCellClass="cc-grid-nested-cell",e.nestedGridExpanderClass="cc-grid-nested-expander",e.nestedGridExpanderEditClass="cc-grid-nested-expander-edit",e.nestedGridExpanderExpandClass="cc-grid-nested-expander-expand",e.nestedGridExpanderCollapseClass="cc-grid-nested-expander-collapse",e.parentRecordIdAttributeName="cc-parent-record-id",e.cellsDataIdAttributeName="grid-cell-container",e.gridRowHoverColor="#d8d8d8",e.treeIndent=37,e.customDropDownMaxHeight=150,e.firstRowHeight=52,e.controlName="GridControl",e.maxNumberOfLookupColumns=1,e.maxNumberOfColumnsOnSmallScreen=3,e.btnHeaderColumnName="btnheadercolumn",e.btnHeaderSelectColumnName="btnheaderselectcolumn",e.summaryHeaderColumnName="summaryheadercolumn",e.htmlTitleAttributeName="title",e.rowNavigatorButtonTolerance=2,e.kbTabCode=9,e.kbEnterCode=13,e.kbSpaceCode=32,e.kbPageUpCode=33,e.kbPageDownCode=34,e.kbArrowLeftCode=37,e.kbArrowUpCode=38,e.kbArrowRightCode=39,e.kbArrowDownCode=40,e.kbF4Code=115,e.lpGridContainerId="cc-grid",e.lpGridId="cc-grid|grid",e.lpGridFooterId="cc-grid|cc-grid-footer",e.lpGridFooterPagerId=e.lpGridFooterId+"|cc-grid-pager",e.lpGridHeaderId="cc-grid|cc-grid-header",e.lpGridCellContainerId="cc-grid|grid-cell-container",e.lpGridCellPrefixId="cc-grid|cc-grid-cell|",e.lpGridColumnPrefixId="cc-grid|cc-grid-column|",e.kbSCode=83,e.kbEscapeCode=27,e.componentName="SharedGrid",e.gridDataType="datatype",e.loadEvent="Load",e.eventDescription="event_description",e.gridRenderingMessage="grid control is rendering as :",e.gridLoadType="grid_load_type",e.editableGrid="editable grid",e.readonlyGrid="readonly grid",e.gridViewId="grid_viewId",e.propertyKeyGrid="Grid",e.progressIndicatorSize=40,e.propertyKeySubGrid="SubGrid",e.stateCodeColumn="statecode",e.statusCodeColumn="statuscode",e.glyphsOffset=40,e.glyphsFullOffset=60,e.connectionReadOnlyColumnName="record2id",e.connectionEntityName="connection",e.divNodeTagName="DIV",e}();e.GridConstants=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.compare=function(e,t){return e.constructor.__typeName===t},e.guid="Microsoft.Crm.Client.Core.Framework.Guid",e.optionSetObject="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel._optionMetadata",e.entityReference="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityReference",e.xrmEntityReference="Xrm.Objects.EntityReference",e.entityCollection="Microsoft.Crm.Client.Core.Storage.Common.ObjectModel.EntityCollection",e.twoOptions="boolean",e.dateAndTime="datetime",e.decimal="decimal",e.fp="float",e["double"]="double",e.whole="integer",e.currency="money",e.optionset="picklist",e.multiSelectOptionset="multiselectpicklist",e.lookup="lookup",e.singleLine="string",e.multiple="memo",e.state="state",e.status="status",e.entityName="entitynamestatic",e.customer="customer",e.owner="owner",e.partyList="partylist",e.multiselectoptionset="multiselectpicklist",e.uniqueIdentifier="uniqueidentifier",e.formatDateOnly="date",e.formatDateAndTime="dateandtime",e.formatNone="none",e.formatDuration="duration",e.formatTimeZone="timezone",e.formatLanguage="language",e.formatSimple="simple",e.formatCustomer="customer",e.formatOwner="owner",e.formatPartyList="partylist",e.formatRegarding="regarding",e.formatText="text",e.formatTextArea="textarea",e.formatEmail="email",e.formatURL="url",e.formatTicker="ticker",e.formatPhone="phone",e.dataTypeLookupSimple="Lookup.Simple",e.dataTypeLookupPartyList="Lookup.PartyList",e.dataTypeLookupCustomer="Lookup.Customer",e.dataTypeLookupOwner="Lookup.Owner",e.dataTypeLookupRegarding="Lookup.Regarding",e.dataTypeWholeTimezone="Whole.TimeZone",e.dataTypeWholeLanguage="Whole.Language",e.dataTypeWholeDuration="Whole.Duration",e.dataTypeSingleLineTextArea="SingleLine.TextArea",e.dataTypeSingleLineEmail="SingleLine.Email",e.dataTypeSingleLinePhone="SingleLine.Phone",e.dataTypeSingleLineTicker="SingleLine.Ticker",e.dataTypeSingleLineURL="SingleLine.URL",e.dataTypeDateAndTimeDateOnly="DateAndTime.DateOnly",e.dataTypeDateAndTimeDateAndTime="DateAndTime.DateAndTime",e.dataTypeMultiple="Multiple",e.dataTypeCurrency="Currency",e.dataTypeOptionSet="OptionSet",e.dataTypeTwoOptions="TwoOptions",e}();e.MscrmDataTypes=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.serverLayout="serverLayout",e.clientLayout="clientLayout",e.groupby="groupDescriptions",e.sort="sorting",e.filter="filtering",e}();e.WijmoStateKey=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.Entity=0]="Entity",e[e.List=1]="List",e[e.Account=2]="Account",e[e.Opportunity=3]="Opportunity",e[e.Sharepointdocument=4]="Sharepointdocument",e[e.Dashboard=5]="Dashboard",e[e.WORKSPACE=6]="WORKSPACE",e[e.Lead=7]="Lead",e[e.Contact=8]="Contact",e[e.Activitypointer=9]="Activitypointer",e[e.Drafts=10]="Drafts",e[e.Systemuser=11]="Systemuser",e[e.Letter=12]="Letter",e[e.Salesorder=13]="Salesorder",e[e.Competitor=14]="Competitor",e[e.Task=15]="Task",e[e.Fax=16]="Fax",e[e.Email=17]="Email",e[e.Phonecall=18]="Phonecall",e[e.Contract=19]="Contract",e[e.Quote=20]="Quote",e[e.Incident=21]="Incident",e[e.Campaign=22]="Campaign",e[e.Appointment=23]="Appointment",e[e.Invoice=24]="Invoice",e[e.Knowledgearticle=25]="Knowledgearticle",e[e.Product=26]="Product",e[e.Opportunityproduct=27]="Opportunityproduct",e[e.Queueitem=28]="Queueitem",e[e.Socialprofile=29]="Socialprofile",e[e.ChevronRight=30]="ChevronRight",e[e.Globe=31]="Globe",e[e.Ticker=32]="Ticker",e[e.Duration=33]="Duration",e[e.Timezone=34]="Timezone",e[e.Language=35]="Language",e[e.MultipleUsers=36]="MultipleUsers",e[e.Regarding=37]="Regarding",e[e.Checklist=38]="Checklist",e[e.TwoOptions=39]="TwoOptions",e[e.Currency=40]="Currency",e[e.DateTime=41]="DateTime",e[e.OfficeIcon=42]="OfficeIcon",e[e.OfficeIconWordFileSharedWithMe=43]="OfficeIconWordFileSharedWithMe",e[e.OfficeIconWordFileCheckedOut=44]="OfficeIconWordFileCheckedOut",e[e.OfficeIconExcelFile=45]="OfficeIconExcelFile",e[e.OfficeIconExcelFileSharedWithMe=46]="OfficeIconExcelFileSharedWithMe",e[e.OfficeIconExcelFileCheckedOut=47]="OfficeIconExcelFileCheckedOut",e[e.OfficeIconPowerPointFile=48]="OfficeIconPowerPointFile",e[e.OfficeIconPowerPointFileSharedWithMe=49]="OfficeIconPowerPointFileSharedWithMe",e[e.OfficeIconPowerPointFileCheckedOut=50]="OfficeIconPowerPointFileCheckedOut",e[e.OfficeIconOneNoteFile=51]="OfficeIconOneNoteFile",e[e.OfficeIconOneNoteFileSharedWithMe=52]="OfficeIconOneNoteFileSharedWithMe",e[e.OfficeIconOneNoteFileCheckedOut=53]="OfficeIconOneNoteFileCheckedOut",e[e.OfficeIconAccessFile=54]="OfficeIconAccessFile",e[e.OfficeIconAccessFileSharedWithMe=55]="OfficeIconAccessFileSharedWithMe",e[e.OfficeIconAccessFileCheckedOut=56]="OfficeIconAccessFileCheckedOut",e[e.OfficeIconProjectFile=57]="OfficeIconProjectFile",e[e.OfficeIconProjectFileSharedWithMe=58]="OfficeIconProjectFileSharedWithMe",e[e.OfficeIconProjectFileCheckedOut=59]="OfficeIconProjectFileCheckedOut",e[e.OfficeIconVisioFile=60]="OfficeIconVisioFile",e[e.OfficeIconVisioFileSharedWithMe=61]="OfficeIconVisioFileSharedWithMe",e[e.OfficeIconVisioFileCheckedOut=62]="OfficeIconVisioFileCheckedOut",e[e.OfficeIconHelpFile=63]="OfficeIconHelpFile",e[e.OfficeIconHelpFileSharedWithMe=64]="OfficeIconHelpFileSharedWithMe",e[e.OfficeIconHelpFileCheckedOut=65]="OfficeIconHelpFileCheckedOut",e[e.OfficeIconZipFile=66]="OfficeIconZipFile",e[e.OfficeIconZipFileSharedWithMe=67]="OfficeIconZipFileSharedWithMe",e[e.OfficeIconZipFileCheckedOut=68]="OfficeIconZipFileCheckedOut",e[e.OfficeIconSetupFile=69]="OfficeIconSetupFile",e[e.OfficeIconSetupFileSharedWithMe=70]="OfficeIconSetupFileSharedWithMe",e[e.OfficeIconSetupFileCheckedOut=71]="OfficeIconSetupFileCheckedOut",e[e.OfficeIconVideoFile=72]="OfficeIconVideoFile",e[e.OfficeIconVideoFileSharedWithMe=73]="OfficeIconVideoFileSharedWithMe",e[e.OfficeIconVideoFileCheckedOut=74]="OfficeIconVideoFileCheckedOut",e[e.OfficeIconImageFile=75]="OfficeIconImageFile",e[e.OfficeIconImageFileSharedWithMe=76]="OfficeIconImageFileSharedWithMe",e[e.OfficeIconImageFileCheckedOut=77]="OfficeIconImageFileCheckedOut",e[e.OfficeIconAudioFile=78]="OfficeIconAudioFile",e[e.OfficeIconAudioFileSharedWithMe=79]="OfficeIconAudioFileSharedWithMe",e[e.OfficeIconAudioFileCheckedOut=80]="OfficeIconAudioFileCheckedOut",e[e.OfficeIconExecutableFile=81]="OfficeIconExecutableFile",e[e.OfficeIconExecutableFileSharedWithMe=82]="OfficeIconExecutableFileSharedWithMe",e[e.OfficeIconExecutableFileCheckedOut=83]="OfficeIconExecutableFileCheckedOut",e[e.OfficeIconPdfFile=84]="OfficeIconPdfFile",e[e.OfficeIconPdfFileSharedWithMe=85]="OfficeIconPdfFileSharedWithMe",e[e.OfficeIconPdfFileCheckedOut=86]="OfficeIconPdfFileCheckedOut",e[e.OfficeIconWebFile=87]="OfficeIconWebFile",e[e.OfficeIconWebFileSharedWithMe=88]="OfficeIconWebFileSharedWithMe",e[e.OfficeIconWebFileCheckedOut=89]="OfficeIconWebFileCheckedOut",e[e.OfficeIconTextFile=90]="OfficeIconTextFile",e[e.OfficeIconTextFileSharedWithMe=91]="OfficeIconTextFileSharedWithMe",e[e.OfficeIconTextFileCheckedOut=92]="OfficeIconTextFileCheckedOut",e[e.OfficeIconFolder=93]="OfficeIconFolder",e[e.OfficeIconFolderSharedWithMe=94]="OfficeIconFolderSharedWithMe",e[e.OfficeIconFolderCheckedOut=95]="OfficeIconFolderCheckedOut",e[e.OfficeIconGenericFile=96]="OfficeIconGenericFile",e[e.OfficeIconGenericFileSharedWithMe=97]="OfficeIconGenericFileSharedWithMe",e[e.OfficeIconGenericFileCheckedOut=98]="OfficeIconGenericFileCheckedOut",e[e.Timer=99]="Timer"}(t=e.CrmIconSymbol||(e.CrmIconSymbol={}))}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.Refresh=0]="Refresh",e[e.LoadNextPage=1]="LoadNextPage",e[e.LoadPreviousPage=2]="LoadPreviousPage",e[e.LoadFirstPage=3]="LoadFirstPage"}(t=e.DataSetOperation||(e.DataSetOperation={}))}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No"}(t=e.EnableGroupBy||(e.EnableGroupBy={}));var i=function(){function e(){}return Object.defineProperty(e,"YesString",{get:function(){return"yes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NoString",{get:function(){return"no"},enumerable:!0,configurable:!0}),e.parseValue=function(i){var i=i.toLowerCase();switch(i){case e.YesString:return t.Yes;case e.NoString:return t.No;default:return null}},e}();e.EnableGroupByUtil=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No"}(t=e.EnableFiltering||(e.EnableFiltering={}));var i=function(){function e(){}return Object.defineProperty(e,"YesString",{get:function(){return"yes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NoString",{get:function(){return"no"},enumerable:!0,configurable:!0}),e.parseValue=function(i){var i=i.toLowerCase();switch(i){case e.YesString:return t.Yes;case e.NoString:return t.No;default:return null}},e}();e.EnableFilteringUtil=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.No=0]="No",e[e.Yes=1]="Yes",e[e.Unknown=2]="Unknown"}(t=e.IsEditable||(e.IsEditable={}))}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.timeZoneService=0]="timeZoneService",e[e.containerService=1]="containerService",e[e.gridComponent=2]="gridComponent",e[e.listComponent=3]="listComponent",e[e.typeProcessorService=4]="typeProcessorService",e[e.fieldAccessComponent=5]="fieldAccessComponent",e[e.fieldAccessService=6]="fieldAccessService",e[e.selectionService=7]="selectionService",e[e.stateService=8]="stateService",e[e.errorHandlingService=9]="errorHandlingService",e[e.dataAdapter=10]="dataAdapter",e[e.dataSetService=11]="dataSetService",e[e.filteringContext=12]="filteringContext",e[e.filteringService=13]="filteringService",e[e.paginationComponent=14]="paginationComponent",e[e.paginationService=15]="paginationService",e[e.enhancedPaginationComponent=16]="enhancedPaginationComponent",e[e.enhancedPaginationService=17]="enhancedPaginationService",e[e.groupingComponent=18]="groupingComponent",e[e.groupingService=19]="groupingService",e[e.sortingService=20]="sortingService",e[e.gridFeatures=21]="gridFeatures",e[e.loggingService=22]="loggingService",e[e.navigationService=23]="navigationService",e[e.ariaLiveRegionComponent=24]="ariaLiveRegionComponent",e[e.ariaLiveRegionService=25]="ariaLiveRegionService"}(t=e.Services||(e.Services={}))}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.Clear=0]="Clear",e[e.Unsaved=1]="Unsaved",e[e.Saving=2]="Saving",e[e.Saved=3]="Saved",e[e.Refresh=4]="Refresh"}(t=e.StatusUpdateType||(e.StatusUpdateType={}))}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.Yes=0]="Yes",e[e.No=1]="No"}(t=e.EnableEditing||(e.EnableEditing={}));var i=function(){function e(){}return Object.defineProperty(e,"YesString",{get:function(){return"yes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NoString",{get:function(){return"no"},enumerable:!0,configurable:!0}),e.parseValue=function(i){switch(i=i.toLowerCase()){case e.YesString:return t.Yes;case e.NoString:return t.No;default:return null}},e}();e.EnableEditingUtil=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.Reflow=0]="Reflow",e[e.GridOnly=1]="GridOnly",e[e.ListOnly=2]="ListOnly"}(t=e.ReflowBehavior||(e.ReflowBehavior={}));var i;!function(e){e[e.Grid=0]="Grid",e[e.List=1]="List"}(i=e.ViewType||(e.ViewType={}));var o=function(){function e(){}return Object.defineProperty(e,"ReflowString",{get:function(){return"reflow"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GridOnlyString",{get:function(){return"gridonly"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ListOnlyString",{get:function(){return"listonly"},enumerable:!0,configurable:!0}),e.parseValue=function(i){var i=i.toLowerCase();switch(i){case e.ReflowString:return t.Reflow;case e.GridOnlyString:return t.GridOnly;case e.ListOnlyString:return t.ListOnly;default:return null}},e}();e.ReflowBehaviorUtil=o}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.Expanded=0]="Expanded",e[e.UpArrowHead=1]="UpArrowHead",e[e.LeftArrowHead=2]="LeftArrowHead",e[e.Collapsed=3]="Collapsed",e[e.Edit=4]="Edit",e[e.Save=5]="Save",e[e.Delete=6]="Delete",e[e.Remove=7]="Remove",e[e.Add=8]="Add",e[e.Cancel=9]="Cancel",e[e.HandClick=10]="HandClick",e[e.Accept=11]="Accept",e[e.More=12]="More",e[e.Forward=13]="Forward",e[e.Favorite=14]="Favorite",e[e.Placeholder=15]="Placeholder",e[e.RatingFull=16]="RatingFull",e[e.RatingEmpty=17]="RatingEmpty",e[e.Options=18]="Options",e[e.Manage=19]="Manage",e[e.Settings=20]="Settings",e[e.Find=21]="Find",e[e.Help=22]="Help",e[e.ViewNotifications=23]="ViewNotifications",e[e.StageAdvance=24]="StageAdvance",e[e.CheckMark=25]="CheckMark",e[e.Locked=26]="Locked",e[e.Lock=27]="Lock",e[e.MoreOptions=28]="MoreOptions",e[e.ContactInfo=29]="ContactInfo",e[e.Pin=30]="Pin",e[e.Unpin=31]="Unpin",e[e.Refresh=32]="Refresh",e[e.Details=33]="Details",e[e.VisualFilter=34]="VisualFilter",e[e.GlobalFilter=35]="GlobalFilter",e[e.Diamond=36]="Diamond",e[e.ApplyFilter=37]="ApplyFilter",e[e.CancelFilter=38]="CancelFilter",e[e.StreamView=39]="StreamView",e[e.TileView=40]="TileView",e[e.Import=41]="Import",e[e.Tools=42]="Tools",e[e.Attach=43]="Attach",e[e.Filter=44]="Filter",e[e.Copy=45]="Copy",e[e.HighPriority=46]="HighPriority",e[e.ReduceTile=47]="ReduceTile",e[e.ExpandTile=48]="ExpandTile",e[e.GlobalFilterExpand=49]="GlobalFilterExpand",e[e.GlobalFilterCollapse=50]="GlobalFilterCollapse",e[e.Clear=51]="Clear",e[e.Post=52]="Post",e[e.OneNote=53]="OneNote",e[e.Home=54]="Home",e[e.SetAsHome=55]="SetAsHome",e[e.BackButton=56]="BackButton",e[e.BackButtonWithoutBorder=57]="BackButtonWithoutBorder",e[e.UpArrow=58]="UpArrow",e[e.DownArrow=59]="DownArrow",e[e.SetActiveButton=60]="SetActiveButton",e[e.SearchButton=61]="SearchButton",e[e.ForwardButton=62]="ForwardButton",e[e.Mail=63]="Mail",e[e.CheckedMail=64]="CheckedMail",e[e.FailedMail=65]="FailedMail",e[e.Phone=66]="Phone",e[e.Chat=67]="Chat",e[e.OpenPane=68]="OpenPane",e[e.ClosePane=69]="ClosePane",e[e.AddFriend=70]="AddFriend",e[e.Arrow=71]="Arrow",e[e.DropdownArrow=72]="DropdownArrow",e[e.FlsLocked=73]="FlsLocked",e[e.LinkArticle=74]="LinkArticle",e[e.UnlinkArticle=75]="UnlinkArticle",e[e.CopyLink=76]="CopyLink",e[e.EmailLink=77]="EmailLink",e[e.Share=78]="Share",e[e.Assign=79]="Assign",e[e.Connect=80]="Connect",e[e.Opportunity=81]="Opportunity",e[e.Appointment=82]="Appointment",e[e.Task=83]="Task",e[e.Case=84]="Case",e[e.PhoneCallIncoming=85]="PhoneCallIncoming",e[e.PhoneCallOutgoing=86]="PhoneCallOutgoing",e[e.EmailIncoming=87]="EmailIncoming",e[e.EmailOutgoing=88]="EmailOutgoing",e[e.SendEmail=89]="SendEmail",e[e.ApplyTemplate=90]="ApplyTemplate",e[e.InsertKbArticle=91]="InsertKbArticle",e[e.SendSelected=92]="SendSelected",e[e.SaveAndClose=93]="SaveAndClose",e[e.ReplyEmail=94]="ReplyEmail",e[e.ReplyAllEmail=95]="ReplyAllEmail",e[e.ForwardEmail=96]="ForwardEmail",e[e.Close=97]="Close",e[e.Activate=98]="Activate",e[e.DeActivate=99]="DeActivate",e[e.DeleteBulk=100]="DeleteBulk",e[e.SocialActivityIncoming=101]="SocialActivityIncoming",e[e.SocialActivityOutgoing=102]="SocialActivityOutgoing",e[e.CustomActivity=103]="CustomActivity",e[e.SystemPost=104]="SystemPost",e[e.Convert=105]="Convert",e[e.MarkAsWon=106]="MarkAsWon",e[e.MarkAsLost=107]="MarkAsLost",e[e.SetRegarding=108]="SetRegarding",e[e.SaveAsComplete=109]="SaveAsComplete",e[e.SwitchProcess=110]="SwitchProcess",e[e.Recalculate=111]="Recalculate",e[e.SendDirectEmail=112]="SendDirectEmail",e[e.OpenMailbox=113]="OpenMailbox",e[e.ReOpenOpportunity=114]="ReOpenOpportunity",e[e.ReactivateLead=115]="ReactivateLead",e[e.Disqualify=116]="Disqualify",e[e.Qualify=117]="Qualify",e[e.SelectView=118]="SelectView",e[e.SelectChart=119]="SelectChart",e[e.OpenInBrowser=120]="OpenInBrowser",e[e.NewAppointment=121]="NewAppointment",e[e.NewRecurringAppointment=122]="NewRecurringAppointment",e[e.NewPhoneCall=123]="NewPhoneCall",e[e.NewTask=124]="NewTask",e[e.NewEmail=125]="NewEmail",e[e.AddExisting=126]="AddExisting",e[e.SaveAndEdit=127]="SaveAndEdit",e[e.Default=128]="Default",e[e.ScrollRight=129]="ScrollRight",e[e.ScrollLeft=130]="ScrollLeft",e[e.SaveAndRunRoutingRule=131]="SaveAndRunRoutingRule",e[e.RunRoutingRule=132]="RunRoutingRule",e[e.ResolveCase=133]="ResolveCase",e[e.CancelCase=134]="CancelCase",e[e.ReactivateCase=135]="ReactivateCase",e[e.AddToQueue=136]="AddToQueue",e[e.CreateChildCase=137]="CreateChildCase",e[e.QueueItemRoute=138]="QueueItemRoute",e[e.QueueItemRelease=139]="QueueItemRelease",e[e.QueueItemRemove=140]="QueueItemRemove",e[e.QueueItemPick=141]="QueueItemPick",e[e.Drilldown=142]="Drilldown",e[e.PopOverButton=143]="PopOverButton",e[e.ExitButton=144]="ExitButton",e[e.ExportToExcel=145]="ExportToExcel",e[e.WordTemplates=146]="WordTemplates",e[e.DocumentTemplates=147]="DocumentTemplates",e[e.OpenInPowerBI=148]="OpenInPowerBI",e[e.OpenPowerBIReport=149]="OpenPowerBIReport",e[e.OpenDelve=150]="OpenDelve",e[e.ArticleLink=151]="ArticleLink",e[e.ArchiveArticle=152]="ArchiveArticle",e[e.ApproveArticle=153]="ApproveArticle",e[e.DiscardArticle=154]="DiscardArticle",e[e.Minor=155]="Minor",e[e.Major=156]="Major",e[e.PublishKnowledgeArticle=157]="PublishKnowledgeArticle",e[e.RelateArticle=158]="RelateArticle",e[e.RelateProduct=159]="RelateProduct",e[e.RestoreArticle=160]="RestoreArticle",e[e.RevertToDraftArticle=161]="RevertToDraftArticle",e[e.Translate=162]="Translate",e[e.UpdateArticle=163]="UpdateArticle",e[e.RemoveFilter=164]="RemoveFilter",e[e.Article=165]="Article",e[e.Graph=166]="Graph",e[e.CSR=167]="CSR",e[e.MembersIcon=168]="MembersIcon",e[e.QueueIcon=169]="QueueIcon",e[e.SiteMap=170]="SiteMap",e[e.NormalPriority=171]="NormalPriority",e[e.LowPriority=172]="LowPriority",e[e.ViewIcon=173]="ViewIcon",e[e.RecentCases=174]="RecentCases",e[e.KBRecords=175]="KBRecords",e[e.NumberOfViews=176]="NumberOfViews",e[e.ResizeHandle=177]="ResizeHandle",e[e.TaskBasedFlow=178]="TaskBasedFlow",e[e.InformationIcon=179]="InformationIcon",e[e.PencilIcon=180]="PencilIcon",e[e.ErrorIcon=181]="ErrorIcon",e[e.SuccessIcon=182]="SuccessIcon",e[e.OptionsetIcon=183]="OptionsetIcon",e[e.NotificationIcon=184]="NotificationIcon",e[e.PanelHeaderImportDataIcon=185]="PanelHeaderImportDataIcon",e[e.SidePanelUpload=186]="SidePanelUpload",e[e.New=187]="New",e[e.DetailsPageClose=188]="DetailsPageClose",e[e.SettingsListIcon=189]="SettingsListIcon",e[e.ListIcon=190]="ListIcon",e[e.ForwardDisable=191]="ForwardDisable",
e[e.PdfIconFile=192]="PdfIconFile",e[e.PresentationFile=193]="PresentationFile",e[e.OneNoteFile=194]="OneNoteFile",e[e.AccessFile=195]="AccessFile",e[e.VisioFile=196]="VisioFile",e[e.ProjectFile=197]="ProjectFile",e[e.Plus=198]="Plus",e[e.ChevronUp=199]="ChevronUp",e[e.ChevronDown=200]="ChevronDown",e[e.HappySmiley=201]="HappySmiley",e[e.SadSmiley=202]="SadSmiley",e[e.CaseResolution=203]="CaseResolution",e[e.CampaignResolution=204]="CampaignResolution",e[e.ServiceActivity=205]="ServiceActivity",e[e.Notes=206]="Notes",e[e.Audio=207]="Audio",e[e.Camera=208]="Camera",e[e.Video=209]="Video",e[e.Image=210]="Image",e[e.Html=211]="Html",e[e.SharePointEditDocument=212]="SharePointEditDocument",e[e.SharePointDeleteDocument=213]="SharePointDeleteDocument",e[e.SharePointCheckoutDocument=214]="SharePointCheckoutDocument",e[e.SharePointCheckinDocument=215]="SharePointCheckinDocument",e[e.SharePointEditDocumentProperties=216]="SharePointEditDocumentProperties",e[e.SharePointDiscardCheckoutDocument=217]="SharePointDiscardCheckoutDocument",e[e.SharePointNewDocument=218]="SharePointNewDocument",e[e.SharePointNewWordDocument=219]="SharePointNewWordDocument",e[e.SharePointNewExcelDocument=220]="SharePointNewExcelDocument",e[e.SharePointNewPowerPointDocument=221]="SharePointNewPowerPointDocument",e[e.SharePointNewOneNoteDocument=222]="SharePointNewOneNoteDocument",e[e.SharePointUploadDocument=223]="SharePointUploadDocument",e[e.SharePointChangeLocation=224]="SharePointChangeLocation",e[e.SharePointAddDocumentLocation=225]="SharePointAddDocumentLocation",e[e.SharePointEditLocation=226]="SharePointEditLocation",e[e.SharePointOpenLocation=227]="SharePointOpenLocation",e[e.SharePointOpenDocument=228]="SharePointOpenDocument",e[e.SendByEmail=229]="SendByEmail",e[e.CreateQuote=230]="CreateQuote",e[e.Reply=231]="Reply",e[e.Warning=232]="Warning",e[e.Play=233]="Play",e[e.ExpandButton=234]="ExpandButton",e[e.AssociatedArticle=235]="AssociatedArticle",e[e.DisassociatedArticle=236]="DisassociatedArticle",e[e.FormDesign=237]="FormDesign",e[e.GlobalFilterClearAll=238]="GlobalFilterClearAll",e[e.GlobalFilterExpandedRow=239]="GlobalFilterExpandedRow",e[e.GlobalFilterCollapsedRow=240]="GlobalFilterCollapsedRow",e[e.RelationshipAssistant=241]="RelationshipAssistant",e[e.AutomaticSuggestions=242]="AutomaticSuggestions",e[e.SemanticZoom=243]="SemanticZoom",e[e.SemanticZoomMirrored=244]="SemanticZoomMirrored",e[e.BackwardButton=245]="BackwardButton",e[e.MultiSelect=246]="MultiSelect",e[e.MultiSelectMirrored=247]="MultiSelectMirrored",e[e.Spinning=248]="Spinning",e[e.RetireProduct=249]="RetireProduct",e[e.AddProduct=250]="AddProduct",e[e.OfflineStatus=251]="OfflineStatus",e[e.Abandon=252]="Abandon",e[e.Reactivate=253]="Reactivate",e[e.FinishStage=254]="FinishStage",e[e.SortButton=255]="SortButton",e[e.SelectButton=256]="SelectButton",e[e.SelectButtonRTL=257]="SelectButtonRTL",e[e.Flows=258]="Flows",e[e.OpenEntityRecord=259]="OpenEntityRecord",e[e.View=260]="View",e[e.CreateView=261]="CreateView",e[e.EditView=262]="EditView",e[e.GuestUser=263]="GuestUser",e[e.History=264]="History",e[e.ReassignRecords=265]="ReassignRecords",e[e.ManageRoles=266]="ManageRoles",e[e.JoinTeams=267]="JoinTeams",e[e.ChangeManager=268]="ChangeManager",e[e.AddMembers=269]="AddMembers",e[e.RemoveMembers=270]="RemoveMembers",e[e.Download=271]="Download",e[e.SetAsDefaultView=272]="SetAsDefaultView",e[e.Pinned=273]="Pinned",e[e.DistributionList=274]="DistributionList",e[e.MergeRecords=275]="MergeRecords",e[e.AssociateChildCase=276]="AssociateChildCase",e[e.SetAsDefault=277]="SetAsDefault",e[e.ConvertKnowledgeArticle=278]="ConvertKnowledgeArticle",e[e.Messenger=279]="Messenger",e[e.AssociateCategory=280]="AssociateCategory",e[e.OfficeWaffle=281]="OfficeWaffle",e[e.TripleColumn=282]="TripleColumn",e[e.Tiles=283]="Tiles",e[e.HideVisualFilter=284]="HideVisualFilter",e[e.InteractiveDashboard=285]="InteractiveDashboard",e[e.Dynamics365=286]="Dynamics365",e[e.SalesLiterature=287]="SalesLiterature",e[e.Checkbox=288]="Checkbox",e[e.CheckboxComposite=289]="CheckboxComposite"}(t=e.MicrosoftIconSymbol||(e.MicrosoftIconSymbol={}))}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(i,o,r,n){void 0===r&&(r=!1),void 0===n&&(n=e.DataSetOperation.Refresh);var s=t.call(this)||this;return s.dataSet=i,s.handlerObject=o,s.dsOperation=n,s.restoreState=r,s}return __extends(i,t),Object.defineProperty(i.prototype,"gridDataSet",{get:function(){return this.dataSet},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"handler",{get:function(){return this.handlerObject},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"operation",{get:function(){return this.dsOperation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasDedicatedHandler",{get:function(){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.handler)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasDataSet",{get:function(){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shouldRestoreState",{get:function(){return this.restoreState},enumerable:!0,configurable:!0}),i.getRefreshCurrentDataSetArgs=function(t,o){return void 0===t&&(t=!1),void 0===o&&(o=e.DataSetOperation.Refresh),new i(null,null,t,o)},i}(wijmo.EventArgs);e.GridDataSetOperationRequestedArgs=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i){var o=e.call(this)||this;return o.hasError=t,o.hasDirtyRecord=i,o}return __extends(t,e),Object.defineProperty(t.prototype,"gridHasError",{get:function(){return this.hasError},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gridHasDirtyRecord",{get:function(){return this.hasDirtyRecord},enumerable:!0,configurable:!0}),t}(wijmo.EventArgs);e.GridErrorEventArgs=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i){var o=e.call(this)||this;return o.dataSet=t,o.view=i,o}return __extends(t,e),Object.defineProperty(t.prototype,"gridDataSet",{get:function(){return this.dataSet},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gridView",{get:function(){return this.view},enumerable:!0,configurable:!0}),t}(wijmo.EventArgs);e.GridRenderingEventArgs=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i){var o=e.call(this)||this;return o.groupByName=t,o.collectionView=i,o}return __extends(t,e),t}(wijmo.EventArgs);e.GroupingRequestedEventArgs=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t){var i=e.call(this)||this;return i.isServerGroupedBy=t,i}return __extends(t,e),t}(wijmo.EventArgs);e.GroupingTypeEventArgs=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t,i,o){var r=e.call(this)||this;return r.id=t,r.moreInQueue=i,r.isSuccessfulSave=o,r}return __extends(t,e),Object.defineProperty(t.prototype,"recordId",{get:function(){return this.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"moreItemsInQueue",{get:function(){return this.moreInQueue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isRecordSavedSuccessfully",{get:function(){return this.isSuccessfulSave},enumerable:!0,configurable:!0}),t}(wijmo.EventArgs);e.RecordSaveEventArgs=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,i,o,r){this._rowId=e,this._columnName=t,this._row=i,this._column=o,this._cellType=r}return Object.defineProperty(e.prototype,"rowId",{get:function(){return this._rowId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnName",{get:function(){return this._columnName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellType",{get:function(){return this._cellType},enumerable:!0,configurable:!0}),e.buildFromEventArgs=function(t){var i=t.panel.cellType,o=t.row>=0&&i===wijmo.grid.CellType.Cell?t.panel.grid.getCellData(t.row,0,!1):null,r=t.panel.columns,n=t.col>=0&&i===wijmo.grid.CellType.Cell&&t.col<r.length?r[t.col].binding:null,s=t.row,a=t.col;return new e(o,n,s,a,i)},e}();e.CellRangeArgumentsModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.isRequired=function(){return 2===this.requiredLevel||1===this.requiredLevel},e.prototype.isRecommended=function(){return 3===this.requiredLevel},e.getDefault=function(){var t=new e;return t.isEditable=!1,t.isSecured=!1,t.isReadable=!0,t.requiredLevel=0,t},e}();e.FieldAccessModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e}();e.FilteringResultModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e}();e.FilterStateModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o,r,n,s){var a=t.call(this,e,i,o,r,n)||this;return a._cell=s,a}return __extends(i,t),Object.defineProperty(i.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),i.buildFromEventArgs=function(t){var o=e.CellRangeArgumentsModel.buildFromEventArgs(t),r=t.cell;return new i(o.rowId,o.columnName,o.row,o.column,o.cellType,r)},i}(e.CellRangeArgumentsModel);e.FormatItemArgumentsModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t){this.cancel=e,this.refreshRequired=t}return e}();e.OperationResultModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){this.filter=e}return e.prototype.getOriginalGridFilter=function(){return this.filter},e.prototype.setFilterType=function(e){this.filter.filterType=e},e.prototype.setValueFilter=function(e){this.filter.valueFilter.uniqueValues=e},Object.defineProperty(e.prototype,"dataMap",{get:function(){return this.filter.column.dataMap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActive",{get:function(){return this.filter.isActive},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isConditionFilter",{get:function(){return this.filter.conditionFilter.isActive},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValueFilter",{get:function(){return this.filter.valueFilter.isActive},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return this.filter.column.dataType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binding",{get:function(){return this.filter.column.binding},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conditionFilter",{get:function(){return this.filter.conditionFilter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueFilter",{get:function(){return this.filter.valueFilter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filterType",{get:function(){return this.filter.filterType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMultiSelectOptionSetFilter",{get:function(){return this.isMultiSelectOptionSetTypeFilter},set:function(e){this.isMultiSelectOptionSetTypeFilter=e},enumerable:!0,configurable:!0}),e}();e.GridColumnFilterModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t){this.Id=e,this.LogicalName=t}return e}();e.GridEntityReferenceModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e}();e.GridRowDetail=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e}();e.RecordItemModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o,r,n,s,a,l,c,d){void 0===d&&(d=!1);var u=t.call(this,e,i,o,r,n)||this;return u._selectedRows=s,u._isRangeSelection=a,u._isValidEvent=l,u._isKeyboardNavigation=d,u._selectionEvent=c,u}return __extends(i,t),i.prototype.isRangeSelect=function(){return this._isRangeSelection},Object.defineProperty(i.prototype,"isMultiSelection",{get:function(){return this.isRangeSelect()||this._selectedRows.length>(this.hasSelectionChanged?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasSelectionChanged",{get:function(){return this._selectedRows.indexOf(this.rowId)>=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isValidEvent",{get:function(){return this._isValidEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isKeyboardNavigation",{get:function(){return this._isKeyboardNavigation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isRecordRowSelection",{get:function(){return this.row>=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isRecordColumnSelection",{get:function(){return this.column>=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isClearSelection",{get:function(){return this.row<0&&this.column<0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionEvent",{get:function(){return this._selectionEvent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCellSelection",{get:function(){return this.column>0&&this.row>=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isRowHeaderSelected",{get:function(){return 0===this.column||this.cellType===wijmo.grid.CellType.RowHeader},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCurrentRowSelected",{get:function(){var e=this;return new MscrmCommon.ArrayQuery(this.selectedRows).contains(function(t){return t===e.rowId})},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedRows",{get:function(){return this._selectedRows},enumerable:!0,configurable:!0}),i.buildFromEventArgs=function(t,o){var r="undefined"!=typeof event?event:null,n=t.panel.grid._mouseHdl,s=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n._htDown);s&&(r=n._eMouse);var a=r&&r.target?r.target[e.WijmoConstants.cellIndexKey]:null,l=a?new wijmo.grid.CellRangeEventArgs(t.panel.grid.cells,new wijmo.grid.CellRange(t.row,a.col)):t,c=e.CellRangeArgumentsModel.buildFromEventArgs(l),d=MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)||this.isKeyboardEvent(r),u=this.isValidCellType(c.cellType,o),m=t.range.row!==t.range.row2,p=e.WijmoGridComponent.selectedRows(t.panel.grid);return new i(c.rowId,c.columnName,c.row,c.column,c.cellType,p,m,u,r,d)},i.buildFromEvent=function(e,t,o){var r=t.hitTest(e),n=r.row>=0?t.getCellData(r.row,0,!1):null,s=t.selection.row!==t.selection.row2,a=this.isValidEvent(e,r,o),l=t.selectedRows;return new i(n,t.getColumnName(r.col),r.row,r.col,r.cellType,l,s,a,e)},i.isValidEvent=function(e,t,i){return this.isValidEventType(e)&&this.isValidCellType(t.cellType,i)},i.isValidCellType=function(e,t){return e===wijmo.grid.CellType.Cell||e===wijmo.grid.CellType.RowHeader||t&&e===wijmo.grid.CellType.TopLeft},i.isValidEventType=function(e){var t=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e);return t&&(this.isMouseEvent(e)||this.isKeyboardEvent(e)||"undefined"!=typeof TouchEvent&&e instanceof TouchEvent)},i.isMouseEvent=function(e){return e instanceof MouseEvent||"undefined"!=typeof MSEventObj&&e instanceof MSEventObj&&-1!==e.type.indexOf("mouse")},i.isKeyboardEvent=function(e){return e instanceof KeyboardEvent||"undefined"!=typeof MSEventObj&&e instanceof MSEventObj&&-1!==e.type.indexOf("key")},i.isEventExists=function(e){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)},i}(e.CellRangeArgumentsModel);e.SelectionArgumentsModel=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return Object.defineProperty(t,"firstInformativeColumnIndex",{get:function(){return t.firstInformativeColumnIdx},set:function(e){t.firstInformativeColumnIdx=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isForcedUpdate",{get:function(){return t._isForceUpdate},set:function(e){t._isForceUpdate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isDetail",{get:function(){return t._isDetail},set:function(e){t._isDetail=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isNestedGridConfigured",{get:function(){return t._isNestedGridConfigured},set:function(e){t._isNestedGridConfigured=e},enumerable:!0,configurable:!0}),t.isTreeView=function(t){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.columns))for(var i=t.columns,o=0;o<i.length;o++)if(i[o].alias==e.GridDataSetPropertyNames.ParentIdName)return!0;return!1},t.getGridState=function(i){var o=new e.GridControlState;return o.isTreeView=t.isTreeView(i),o},t.isLinkedEntityColumn=function(e){return-1!==e.indexOf(".")},t.isTouchScreenDevice=function(e){return e.userAgent.isIos||e.userAgent.isAndroid||e.userAgent.isAndroidModern},t.isBtnHeaderColumn=function(t){return t===e.GridConstants.btnHeaderColumnName},t.isSelectAllBtnHeaderColumn=function(t){return t===e.GridConstants.btnHeaderSelectColumnName},t.isSummaryColumn=function(t){return t===e.GridConstants.summaryHeaderColumnName},t.debounce=function(e,t){void 0===t&&(t=100);var i=null;return function(){var o=this,r=arguments;clearTimeout(i),i=setTimeout(function(){e.apply(o,r)},t)}.bind(this)},t.hasSubGridParentId=function(t){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t[e.SubGridDataSetPropertyNames.SubGridParentIdName])},t.getSubGridFilterValue=function(e){var i=e.filtering,o=i.getFilter(),r=t.findSubGridFilter(o);return r?r.value:null},t.findSubGridFilter=function(i){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.conditions)&&i.conditions.length>0)for(var o=0;o<i.conditions.length;o++)if(i.conditions[o].attributeName===e.SubGridDataSetPropertyNames.SubGridParentIdName)return i.conditions[o];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.filters)&&i.filters.length>0)for(var r=0;r<i.filters.length;r++){var n=t.findSubGridFilter(i.filters[r]);if(null!=n)return n}return null},t.replaceSubGridFilterValue=function(t,i){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)){var o=t.filtering,r={filterOperator:0,conditions:[{attributeName:e.SubGridDataSetPropertyNames.SubGridParentIdName,conditionOperator:0,value:i}]},n={filterOperator:0,conditions:null,filters:[r]};o.setFilter(n)}},t.getDatasetColumnByName=function(e,t){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e))for(var i=0;i<e.length;i++)if(e[i].name===t)return e[i];return null},t.getDatasetColumnByAlias=function(e,t){return new MscrmCommon.ArrayQuery(e).firstOrDefault(function(e){return e.alias==t})},t.getOptionsFromAttributes=function(i){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)){var o=[];if(t.isLinkedEntityColumn(i.name))return o;if(i.attributes.type===e.MscrmDataTypes.twoOptions||i.attributes.type===e.MscrmDataTypes.optionset||t.isStatusOptionSet(i)||i.attributes.type===e.MscrmDataTypes.multiSelectOptionset){var r=i.attributes.type===e.MscrmDataTypes.optionset&&-1===i.attributes.defaultValue;r&&o.push({Value:-1,Label:e.GridConstants.nonBreakingSpace,Color:""});var n=i.attributes.options;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n))for(var s=0,a=n;s<a.length;s++){var l=a[s];o.push({Value:l.Value.toString(),Label:l.Label,Color:l.Color})}return o}if(t.isWholeOptionSet(i)){var n;i.dataType==e.MscrmDataTypes.dataTypeWholeTimezone?n=null==i.attributes.timezonebycode?i.attributes.TimeZoneByCode:i.attributes.timezonebycode:i.dataType==e.MscrmDataTypes.dataTypeWholeLanguage&&(n=null==i.attributes.languagebycode?i.attributes.LanguageByCode:i.attributes.languagebycode),o.push({Value:-1,Label:e.GridConstants.nonBreakingSpace,Color:""});for(var c in n)o.push({Value:parseInt(c),Label:n[c],Color:""});return o}}return null},t.columnRequired=function(e){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.attributes)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.attributes.requiredLevel)){var t=e.attributes.requiredLevel,i=1==t||2==t;return i}return!1},t.columnHasDefaultValue=function(e){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.attributes)&&"defaultValue"in e.attributes},t.shouldRender=function(e){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)&&(Mscrm.UpdateEvents.hasEvent(e,Mscrm.UpdateEventType.DataSet)||Mscrm.UpdateEvents.hasEvent(e,Mscrm.UpdateEventType.Activation))},t.isPopUpRootNodeEvent=function(e){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)&&new MscrmCommon.ArrayQuery(e).contains(function(e){return"popupRootNodes"===e})},t.containsKey=function(e,t){return e.findIndex(function(e){return e===t})>=0},t.isWholeOptionSet=function(t){return!(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)||t.dataType!==e.MscrmDataTypes.dataTypeWholeTimezone&&t.dataType!==e.MscrmDataTypes.dataTypeWholeLanguage)},t.isStatusOptionSet=function(t){return!(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.attributes)||t.attributes.type!==e.MscrmDataTypes.state&&t.attributes.type!==e.MscrmDataTypes.status)},t.isWholeDuration=function(t){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)&&t.dataType===e.MscrmDataTypes.dataTypeWholeDuration},t.formatEntityRecords=function(e){var t="";if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e))for(var i=0;i<e.length;++i){var o=e[i],r=o.fields;MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.partyid)||(t=0==i?r.partyid.name:MscrmCommon.ControlUtils.String.Format("{0}; {1}",t,r.partyid.name))}return t},t.isDesktop=function(e){return e===(t.isUci()?1:3)},t.isPhone=function(e){return e===(t.isUci()?3:2)},t.supportMultiSelection=function(e){return!0},t.buildLayoutDictionary=function(e){var t={},i=JSON.parse(e);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.columns))for(var o=i.columns,r=0;r<o.length;++r){var n=o[r];t[n.binding]=n}return t},t.buildProcessedDescriptions=function(e,t){var i=[];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t))for(var o=0;o<t.length;++o){var r=t[o];MscrmCommon.ControlUtils.Object.isNullOrUndefined(e[r.propertyName])||i.push(r)}return i},t.isLookupType=function(t){if(MscrmCommon.ControlUtils.String.EqualsIgnoreCase(t,e.MscrmDataTypes.dataTypeLookupSimple)||MscrmCommon.ControlUtils.String.EqualsIgnoreCase(t,e.MscrmDataTypes.lookup))return!0;var i="lookup.";return!(i.length>t.length)&&(0!=i.length&&0!=t.length&&(t=t.toLowerCase(),i=i.toLowerCase(),t.substr(0,i.length)==i))},t.click=function(e){var t=$(e),i=t.offset(),o=i.left+t.width()/2,r=i.top+t.height()/2;e.dispatchEvent(this.generateMouseEvent("mousedown",o,r)),e.dispatchEvent(this.generateMouseEvent("mouseup",o,r))},t.isRestorableFilterType=function(e,t){return"condition"===t||"value"===t&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.dataMap)},t.determineViewType=function(i,o,r){var n=e.ViewType.Grid;return i||(o===e.ReflowBehavior.ListOnly?n=e.ViewType.List:o===e.ReflowBehavior.Reflow&&(n=t.viewTypeByReflowCriteria(r))),n},t.getValueOrNull=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)||""===e?null:e},t.getValueOrDefault=function(t){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)||""===t?e.WijmoConstants.undefinedString:t},t.viewTypeByReflowCriteria=function(i){return t.isReflowByWidth(i)?e.ViewType.List:e.ViewType.Grid},t.isReflowByWidth=function(t){return t<e.WijmoConstants.listViewModeThreshold&&t>0},t.generateMouseEvent=function(e,t,i){var o=document.createEvent("MouseEvent");return o.initMouseEvent(e,!0,!0,window,null,0,0,t,i,!1,!1,!1,!1,0,null),o},t.parsePropertyOrDefault=function(e,t,i){var o;return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.raw)||(o=t(e.raw)),MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)&&(o=i),o},t.isUci=function(){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.memoizedIsUci)){var e=window;MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm.Internal)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm.Internal.isUci)||(t.memoizedIsUci=e.Xrm.Internal.isUci())}return t.memoizedIsUci},t.isEditableGridOnLegacyClient=function(e){return e&&!t.isUci()},t.isDeleteButtonEnabled=function(){if(t.isUci())return!1;var e=window,i=MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm.Page)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm.Page.ui)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.Xrm.Page.ui.getFormType)||0==e.Xrm.Page.ui.getFormType();return!i},t.createCellAccessibilityMessage=function(i,o,r){var n=document.createElement("span");return n.tabIndex=-1,n.id=r,n.innerText=i,n.style.position="absolute",n.style.top="-5000",n.style.left="-5000",n.style.width="0px",n.style.height="0px",n.style.overflow="hidden",o.appendChild(n),t.setOrAppendAttributeValue(o,e.GridConstants.ariaDescribedBy,r),n},t.setOrAppendAttributeValue=function(e,t,i,o){if(void 0===o&&(o=!1),!e.hasAttribute(t))return void e.setAttribute(t,i);var r=e.getAttribute(t);!o&&r.indexOf(i)>=0||(i=i+" "+e.getAttribute(t),e.setAttribute(t,i))},t.getFetchAttributes=function(e,t){var i=e,o="";if(e&&e.indexOf(".")>0){var r=e.split("."),n=r[0];i=r[1],o=n}return t===wijmo.DataType.Object&&(i+="name"),{attributeName:i,entityAliasName:o}},t.calculateColumnWidth=function(t,i,o,r,n,s){var a=t.columns.find(function(e){return e.imageProviderFunctionName&&e.imageProviderWebresource&&e.isPrimary}),l=a?e.WijmoConstants.selectButtonWithConditionalImageMinimumWidth:e.WijmoConstants.selectButtonMinimumWidth,c=s?0:e.WijmoConstants.scrollBarWidth,d=i-o-l-c,u=d/r;0>u&&(u=0);var m={};for(var p in n)m[p]=n[p]-e.WijmoConstants.columnSeparatorWidth+u;return m},t.calculateConfiguredGridColumnWidth=function(e){for(var t=0,i=0,o={},r=0;r<e.length;r++){var n=e[r];n.isHidden||-1===n.visualSizeFactor||(t+=n.visualSizeFactor,o[n.name]=n.visualSizeFactor,i++)}return{totalWidth:t,columnCount:i,columnWidths:o}},t.getSelectColumnWidthIncrement=function(){return parseFloat(e.WijmoConstants.normalFontSize)*parseFloat(e.WijmoConstants.themingMeasure300)},t.getHeaderSelectColumnWidth=function(i){return t.isNestedGridConfigured&&i.name==e.GridConstants.btnHeaderSelectColumnName&&(i.width=i.width+t.getSelectColumnWidthIncrement(),i.width=t.isDetail?i.width:i.width+10),i.width},t.getHeaderColumnWidth=function(i){return t.isNestedGridConfigured&&i.name==e.GridConstants.btnHeaderColumnName&&(i.minWidth=i.minWidth-t.getSelectColumnWidthIncrement(),t.isDetail||(i.minWidth=i.minWidth-10)),i.minWidth},t.memoizedIsUci=null,t.firstInformativeColumnIdx=2,t._isForceUpdate=!1,t._isDetail=!1,t._isNestedGridConfigured=!1,t}();e.GridUtils=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.isCustomDropDownEditorColumn=function(e,i){return t.isWholeDropDownEditorColumn(e,i)||t.isBooleanDropDownEditorColumn(e,i)},t.isWholeDropDownEditorColumn=function(t,i){return t.dataType===wijmo.DataType.Number&&e.GridUtils.isWholeOptionSet(i)},t.isBooleanDropDownEditorColumn=function(t,i){return t.dataType===wijmo.DataType.String&&i.attributes.type===e.MscrmDataTypes.twoOptions},t.isOptionSetDropDownEditorColumn=function(t,i){return t.dataType===wijmo.DataType.String&&i.attributes.type===e.MscrmDataTypes.optionset},t.hideOriginalEditor=function(e){var i=t.getOriginalEditor(e);i&&i.style&&(i.style.display="none"),t.removeOptionsetDropDown(e)},t.removeOptionsetDropDown=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(MscrmCommon.ControlUtils.String.EqualsIgnoreCase(i.nodeName,"div")&&"wj-dropdown"in i.attributes){i.style.display="none";break}}},t.getOriginalEditor=function(e){for(var t=e.childNodes,i=0;i<t.length;i++)if(MscrmCommon.ControlUtils.String.EqualsIgnoreCase(t[i].nodeName,"input"))return t[i];return null},t}();e.EditorsUtils=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.isDate=function(t){return Object.prototype.toString.call(t).match(/\[object (.*)\]/)[1]===e.DateConstructorFunctionName},e.isString=function(t){return typeof t===e.StringTypeName},e.isOptionMetadata=function(e){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)&&e.get_ValueString&&e.getValue&&e.get_Label},e.stopEventPropagation=function(e){MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.stopPropagation)?e.cancelBubble=!0:e.stopPropagation()},e.preventDefault=function(e){MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.preventDefault)?e.returnValue=!1:e.preventDefault()},e.isKeyCode=function(e,t){return e.keyCode===t||e.which===t},e.removeEmptyElements=function(e){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(e))return[];for(var t=0;t<e.length;t++)MscrmCommon.ControlUtils.String.isNullOrWhitespace(e[t])&&(e.splice(t,1),t--);return e},e.DateConstructorFunctionName="Date",e.StringTypeName="string",e}();e.TypeUtils=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.filterRecordItem=function(e,t,i){for(var o=!1,r=0;r<t.length;++r){var n=t[r].name;try{var s=i.getColumnFilter(n);if(s){var a=this.evaluateFlexColumnFilter(e,s);if(!a){o=!0;break}}}catch(l){continue}}return o},e.evaluateFlexColumnFilter=function(e,t){var i=!0;return t.isActive&&(t.filterType==wijmo.grid.filter.FilterType.Condition?i=this.evaluateConditionFilter(e,t.conditionFilter):t.filterType==wijmo.grid.filter.FilterType.Value?i=this.evaluateValueFilter(e,t.valueFilter):t.filterType==wijmo.grid.filter.FilterType.Both&&(i=this.evaluateConditionFilter(e,t.conditionFilter)&&this.evaluateValueFilter(e,t.valueFilter))),i},e.evaluateConditionFilter=function(e,t){var i=t.and,o=!0;return t.isActive&&(o=i?this.evaluateCondition(e,t.condition1)&&this.evaluateCondition(e,t.condition2):this.evaluateCondition(e,t.condition1)||this.evaluateCondition(e,t.condition2)),
o},e.evaluateValueFilter=function(e,t){var i=!0;return t.isActive&&(i=t.apply(e)),i},e.evaluateCondition=function(e,t){return t.apply(e)},e}();e.WijmoGridFilterUtils=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return Object.defineProperty(t.prototype,"EventName",{set:function(t){this.eventName=e.GridConstants.componentName+t},enumerable:!0,configurable:!0}),t}(),i=function(){function i(e){this.defaultProperties=["EnableEditing","EnableGroupBy","EnableFiltering","ReflowBehavior","useSkypeProtocol"],this.reporting=e,this.defaultParams=new Array}return i.prototype.setDefaultEventParams=function(e){try{for(var t=0,i=this.defaultProperties;t<i.length;t++){var o=i[t];if(e.hasOwnProperty(o)){var r=e[o];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.raw)){var n={name:o,value:r.raw};this.defaultParams.push(n)}}}this.defaultParams.push({name:"EntityName",value:e.Grid.getTargetEntityType()})}catch(s){}},i.prototype.reportFailure=function(t,i,o,r){try{if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.reporting)){var n=e.GridConstants.componentName+"."+t,s=void 0;s=MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)?this.defaultParams:this.defaultParams.concat(r),this.reporting.reportFailure(n,i,o,s)}}catch(a){}},i.prototype.reportEvent=function(e,i){try{if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.reporting))return;var o=MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)?this.defaultParams:this.defaultParams.concat(i),r=new t;r.EventName=e,r.eventParameters=o,this.reporting.reportEvent(r)}catch(n){}},i.prototype.dispose=function(){this.reporting=null,this.defaultParams=null},i}();e.GridTelemetry=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.onSelectionChanged=function(e){},e.prototype.sendPoliteMessage=function(e){},e.prototype.sendAssertiveMessage=function(e){},e.prototype.sendPoliteCellValueMessage=function(e,t){},e.prototype.sendAssertiveCellValueMessage=function(e,t){},e.prototype.dispose=function(){},e}();e.BaseAriaLiveRegionService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o){var r=t.call(this)||this;return r.component=e,r.dataSetService=i,r.typeProcessorService=o,r}return __extends(i,t),i.prototype.sendPoliteMessage=function(e){this.component.sendPoliteMessage(e)},i.prototype.sendAssertiveMessage=function(e){this.component.sendAssertiveMessage(e)},i.prototype.sendPoliteCellValueMessage=function(e,t){var i=this.getCellValueMessage(e,t);this.component.sendPoliteMessage(i)},i.prototype.sendAssertiveCellValueMessage=function(e,t){var i=this.getCellValueMessage(e,t);this.component.sendAssertiveMessage(i)},i.prototype.onSelectionChanged=function(t){if(!t.isMultiSelection&&t.isCellSelection){var i=this.dataSetService.getRecordById(t.rowId),o=e.GridUtils.getDatasetColumnByName(this.dataSetService.columns,t.columnName);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)){var r=o.displayName,n=this.getAriaFormattedValue(i,o);this.sendAssertiveCellValueMessage(n,r)}}},i.prototype.getAriaFormattedValue=function(t,i){var o=this.typeProcessorService.getValue(t,i,null,!0);return MscrmCommon.ControlUtils.String.isNullUndefinedOrWhitespace(o)?e.GridLocale.emptyCellAriaLabel:o},i.prototype.getCellValueMessage=function(t,i){return MscrmCommon.ControlUtils.String.Format(e.GridLocale.cellTemplateAriaLabel,t,i)},i.prototype.dispose=function(){this.component=null},i}(e.BaseAriaLiveRegionService);e.AriaLiveRegionService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){var e=this;this.evaluateState=function(t,i){var o=e.previousState,r=e.isInCriticalRegion;o!==r&&(e.previousState=r,r?e.enteringCriticalRegionEvent.raise(e):e.leftCriticalRegionEvent.raise(e))},this.dataSetServices={},this.errorHandlingServices={},this.gridComponents={},this.previousState=!1,this.enteringCriticalRegionEvent=new wijmo.Event,this.leftCriticalRegionEvent=new wijmo.Event}return Object.defineProperty(e.prototype,"enteringCriticalRegion",{get:function(){return this.enteringCriticalRegionEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftCriticalRegion",{get:function(){return this.leftCriticalRegionEvent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInCriticalRegion",{get:function(){for(var e=!1,t=0,i=Object.keys(this.dataSetServices);t<i.length;t++){var o=i[t];e=e||this.dataSetServices[o].hasDirtyRecord}for(var r=0,n=Object.keys(this.errorHandlingServices);r<n.length;r++){var o=n[r];e=e||this.errorHandlingServices[o].hasGridError}return e},enumerable:!0,configurable:!0}),e.prototype.onDataSetRefresh=function(){this.evaluateState(this,null)},e.prototype.prepareForRiskyOperation=function(){for(var e=!1,t=0,i=Object.keys(this.gridComponents);t<i.length;t++){var o=i[t];this.gridComponents[o].finishEdit(),this.gridComponents[o].cancelSelection(),e=e||!this.gridComponents[o].isEditable}return e||!this.isInCriticalRegion},e.prototype.register=function(e,t,i,o){this.dataSetServices[e]=t,this.errorHandlingServices[e]=i,this.gridComponents[e]=o,o.cellEditProcessed.addHandler(this.evaluateState),t.saved.addHandler(this.evaluateState),t.gridError.addHandler(this.evaluateState)},e.prototype.unregister=function(e){var t=this.dataSetServices[e],i=(this.errorHandlingServices[e],this.gridComponents[e]);try{i.cellEditProcessed.removeHandler(this.evaluateState),t.saved.removeHandler(this.evaluateState),t.gridError.removeHandler(this.evaluateState)}catch(o){}delete this.dataSetServices[e],delete this.gridComponents[e],delete this.errorHandlingServices[e],this.evaluateState(this,null)},e.prototype.dispose=function(){this.enteringCriticalRegionEvent.removeAllHandlers(),this.leftCriticalRegionEvent.removeAllHandlers(),this.enteringCriticalRegionEvent=null,this.leftCriticalRegionEvent=null,this.dataSetServices=null,this.gridComponents=null},e}();e.CriticalRegionService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r,n,s,a){if(this.html="",this.learningPathService=null,this._maxHeight=-1,this._maxWidth=-1,MscrmCommon.ControlUtils.Object.isNullOrUndefined(e))throw new Error("Id for container not set.");this.containerId=e,this.gridControlState=t,this._maxWidth=i,this._maxHeight=o,this.hasGroupBy=r,this.container=n,this.client=s,this.learningPathService=a}return Object.defineProperty(t.prototype,"maxWidth",{get:function(){return-1===this._maxWidth&&(this._maxWidth=this.container.clientWidth),this._maxWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxHeight",{get:function(){return-1===this._maxHeight&&(this._maxHeight=this.container.clientHeight),this._maxHeight},enumerable:!0,configurable:!0}),t.prototype.buildSearchPlaceholder=function(){var t='<div id="{0}"></div>';this.html+=MscrmCommon.ControlUtils.String.Format(t,this.containerId+e.GridConstants.searchPlaceholderPostfix)},t.prototype.buildErrorArea=function(t){void 0===t&&(t="");var i='<div id="{0}" {2}></div> <div id="{1}" {2}></div>',o='style="display: flex;"';this.html+=MscrmCommon.ControlUtils.String.Format(i,this.containerId+e.GridConstants.genericErrorPostfix+t,this.containerId+e.GridConstants.updateErrorPostfix+t,e.GridUtils.isEditableGridOnLegacyClient(this.isEditable)?null:o)},t.prototype.getGridStyle=function(){if(e.GridUtils.isEditableGridOnLegacyClient(this.isEditable)){var t=this.calcGridHeightFromControlHeight(this.maxHeight);return MscrmCommon.ControlUtils.String.Format('style = "width: {0}px; height: {1}px;"',this.maxWidth.toString(),t.toString())}var i=this.client.userAgent.isBrowserIE;return'style = "width:100%;display:flex;'+(i?"flex-basis:100%;":"")+'"'},t.prototype.buildGrid=function(t){var i="";if(!t)if(i=this.getGridStyle(),e.GridUtils.isEditableGridOnLegacyClient(this.isEditable)){var o=this.calcGridHeightFromControlHeight(this.maxHeight);this.html+=MscrmCommon.ControlUtils.String.Format('<div style="position:relative;height:{0}px;min-height:250px;">',o)}else this.html+='<div style="position:relative;display:flex;width:100%;flex:1 1 auto;">';var r='<div id="{0}" aria-label="{1}" class="editableGrid {2}" {3}></div>';r=this.learningPathService.addLearningPathId(r,e.GridConstants.lpGridId),this.html+=MscrmCommon.ControlUtils.String.Format(r,this.getHostId(),e.GridLocale.editableGridAriaLabel,t?e.GridConstants.nestedGridDetailClass:MscrmCommon.ControlUtils.String.Empty,i),this.html+=this.buildProgressIndicator(),this.html+=MscrmCommon.ControlUtils.String.Format('<div id="{0}{1}" class="{2}" style="display:none">{3}</div>',this.containerId,e.GridConstants.noRecordsPostfix,e.GridUtils.isUci()?e.GridConstants.noRecordsContainerClass:e.GridConstants.noRecordsLabelClass,e.GridLocale.noRecordsText),t||(this.html+="</div>")},t.prototype.buildProgressIndicator=function(){return MscrmCommon.ControlUtils.String.Format('<div id="{0}{1}" class="{2}" style="width:100%;position:absolute;display:none;"></div>',this.containerId,e.GridConstants.progressIndicatorPostfix,e.GridConstants.gridProgressIndicatorClass)},t.prototype.buildFooter=function(t){void 0===t&&(t=!0);var i="",o="",r=e.GridUtils.isUci()?'<span class="symbolFont FirstPageButton-symbol"></span>':'<span class="symbolFont BackButton-symbol"></span><span class="symbolFont BackButton-symbol"></span>';o+='<div class="cc-grid-pager"><div class="wj-control wj-content wj-pager" id= "{1}"><div class="wj-input-group">',o+='<span class="wj-input-group-btn">     <button id={2} title={3} aria-label="{3}" type="button" class="wj-btn wj-btn-default" tabindex="0">    {4}    </button>    </span>',o+='<span class="wj-input-group-btn">    <button id="{5}" title="{6}" aria-label="{6}" type="button" class="wj-btn wj-btn-default" tabindex="0">    <span class="symbolFont BackButton-symbol"></span>    </button>    </span>',o+='<span class="wj-input-group-btn">    <span class="cc-grid-paging-current" title="{7}"></span>  </span>',o+='<span class="wj-input-group-btn">    <button id="{8}" title="{9}" aria-label="{9}" type="button" class="wj-btn wj-btn-default" tabindex="0">    <span class="symbolFont Forward-symbol"></span>   </button>    </span>',o+="</div></div></div>",o=this.learningPathService.addLearningPathId(o,e.GridConstants.lpGridFooterPagerId),i+=t?'<div class="cc-grid-footer"><div id={0} class="cc-grid-status-area"></div>':'<div class="cc-grid-footer" style="display:none;"><div id={0} class="cc-grid-status-area"></div>',i+=o,i+="</div>",i=this.learningPathService.addLearningPathId(i,e.GridConstants.lpGridFooterId),this.html+=MscrmCommon.ControlUtils.String.Format(i,this.containerId+e.GridConstants.statusAreaPostfix,this.containerId+e.GridConstants.pagerPostfix,this.containerId+e.GridConstants.firstPagePostfix,e.GridLocale.firstPageTooltipLabel,r,this.containerId+e.GridConstants.previousPagePostfix,e.GridLocale.previousPageTooltipLabel,e.GridLocale.currentPageTooltipLabel,this.containerId+e.GridConstants.nextPagePostfix,e.GridLocale.nextPageTooltipLabel)},t.prototype.buildGroupBy=function(){var t='<label class="label" for="{0}" id="{1}">{2}</label>';t=this.learningPathService.addLearningPathId(t,"cc-grid-groupby|label");var i='<div class="cc-grid-groupby" style="display:flex;min-height: 30px;">'+t+'<select id="{0}" tabindex="0"></select></div>';i=this.learningPathService.addLearningPathId(i,"cc-grid-groupby"),this.html+=i;var o=this.containerId+e.GridConstants.groupBySelectPostfix,r=o+e.GridConstants.labelPostfix;this.html=MscrmCommon.ControlUtils.String.Format(this.html,o,r,e.GridLocale.groupByMenuHeaderLabel)},t.prototype.buildAriaLiveNotificationArea=function(){this.html+='<span id="{0}" class="cc-grid-accessibility-cue" aria-live="polite" role="status"></span>',this.html+='<span id="{1}" class="cc-grid-accessibility-cue" aria-live="assertive" role="alert"></span>',this.html=MscrmCommon.ControlUtils.String.Format(this.html,this.containerId+e.GridConstants.ariaPoliteLiveRegionPostfix,this.containerId+e.GridConstants.ariaAssertiveLiveRegionPostfix)},t.prototype.build=function(t,i,o){void 0===o&&(o=!0),this.isEditable=i,this.hasGroupBy&&this.gridControlState.isGroupByEnabled&&this.buildGroupBy(),this.buildSearchPlaceholder(),this.buildErrorArea(),this.buildGrid(t),i&&(this.buildFooter(o),this.buildAriaLiveNotificationArea());var r=MscrmCommon.ControlUtils.String.Format('style="width: 100%; height: auto; display: flex;"');!t&&e.GridUtils.isEditableGridOnLegacyClient(i)&&(r=MscrmCommon.ControlUtils.String.Format('style="width: {0}px; height: auto;"',this.maxWidth.toString()));var n="cc-grid";!e.GridUtils.isUci()&&e.GridUtils.isDesktop(this.client.formFactor)&&(n+=" cc-grid-desktop"),this.client.isRTL&&(n+=" cc-grid-rtl"),this.html=MscrmCommon.ControlUtils.String.Format('<div id="{0}" class="{1}" {2}>{3}</div>',this.containerId+e.GridConstants.controlDivPostfix,n,r,this.html),this.html=this.learningPathService.addLearningPathId(this.html,e.GridConstants.lpGridContainerId),Object.assign(this.container.style,{display:"flex"}),this.container.innerHTML=this.html,this.setNavigationButtons(this.container),this.setNoRecordsDiv(this.container),this.setScrollIndicatorsDiv(this.container)},t.prototype.resizeControl=function(t,i,o){if(t===this.maxHeight&&i===this.maxWidth)return!1;if(this._maxHeight=t,this._maxWidth=i,o){var r=document.getElementById(this.containerId+e.GridConstants.controlDivPostfix);r.setAttribute("style",MscrmCommon.ControlUtils.String.Format("height: {0}px; width: {1}px",this.maxHeight,this.maxWidth)),this.adjustGridHeight(this.maxHeight)}return!0},t.prototype.adjustGridHeight=function(t){if(e.GridUtils.isEditableGridOnLegacyClient(this.isEditable)){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)){var i=document.getElementById(this.containerId+e.GridConstants.controlDivPostfix);t=i.clientHeight}var o=this.calcGridHeightFromControlHeight(t),r=document.getElementById(this.getHostId()),n=r.parentElement;r.setAttribute("style",MscrmCommon.ControlUtils.String.Format("height: {0}px",o)),n.setAttribute("style",MscrmCommon.ControlUtils.String.Format("height: {0}px; position: relative;",o))}},t.prototype.getContainerId=function(){return this.containerId},t.prototype.getHostId=function(){return this.containerId+e.GridConstants.componentDivPostfix},Object.defineProperty(t.prototype,"previousPageButton",{get:function(){return this.prevPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextPageButton",{get:function(){return this.nextPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstPageButton",{get:function(){return this.firstPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentPageElement",{get:function(){return this.currentPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"noRecordsDiv",{get:function(){return this.noRecords},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"progressIndicatorDiv",{get:function(){return this.progressIndicator},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groupByHeight",{get:function(){var t=document.getElementById(this.containerId+e.GridConstants.groupBySelectPostfix);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)?0:t.parentElement.clientHeight},enumerable:!0,configurable:!0}),t.prototype.calcGridHeightFromControlHeight=function(t){var i=this.hasGroupBy?this.groupByHeight:0,o=i+e.WijmoConstants.pagerHeight+this.getErrorContainerHeight(e.GridConstants.updateErrorPostfix)+this.getErrorContainerHeight(e.GridConstants.genericErrorPostfix),r=t-o;return e.GridUtils.isUci()||!e.GridUtils.isDesktop(this.client.formFactor)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.client.adjustDataAreaHeight)||(r=this.client.adjustDataAreaHeight(this.container.id,r,e.WijmoConstants.defaultMinRowHeightWeb,o)),r},t.prototype.getErrorContainerHeight=function(e){var t=document.getElementById(this.getContainerId()+e);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)||MscrmCommon.ControlUtils.String.isNullUndefinedOrWhitespace(t.innerHTML)?0:t.clientHeight},t.prototype.setNavigationButtons=function(e){var t=e.getElementsByTagName("button");this.currentPage=e.querySelector(".cc-grid-paging-current"),this.firstPage=t.item(0),this.prevPage=t.item(1),this.nextPage=t.item(2)},t.prototype.setNoRecordsDiv=function(t){this.noRecords=t.getElementsByClassName(e.GridUtils.isUci()?e.GridConstants.noRecordsContainerClass:e.GridConstants.noRecordsLabelClass).item(0)},t.prototype.setScrollIndicatorsDiv=function(t){this.progressIndicator=t.getElementsByClassName(e.GridConstants.gridProgressIndicatorClass).item(0)},t.prototype.calculateGridHeightInPercentages=function(){var t=100,i=100*e.WijmoConstants.pagerHeight/e.WijmoConstants.maxSubGridHeight,o=100*this.getErrorContainerHeight(e.GridConstants.updateErrorPostfix)/e.WijmoConstants.maxSubGridHeight,r=100*this.getErrorContainerHeight(e.GridConstants.genericErrorPostfix)/e.WijmoConstants.maxSubGridHeight;if(this.hasGroupBy){var n=100*this.groupByHeight/e.WijmoConstants.maxSubGridHeight;t-=n}return t-i-o-r},t.prototype.dispose=function(){this.containerId=null,this._maxWidth=null,this._maxHeight=null,this.html=null,this.prevPage=null,this.nextPage=null,this.container=null,this.client=null},t}();e.ContainerService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r){this.rollupColumnsCollection=[],this.persistingRecords=[],this.multiSelectOptionSetColumns=[],this.onDataSetRecordChangeHandlers=[],this.onDataSetUpdatedHandlers=[],this.perfTool=o,this.gridTelemetry=r,this.rollupColumnsCollection=null,this.gridDataSet=t,this.notifyOutputChanged=i,this.loggingService=e,this.savingEvent=new wijmo.Event,this.savedEvent=new wijmo.Event,this.errorEvent=new wijmo.Event,this.getMultiSelectOptionSetColumns()}return t.prototype.getMultiSelectOptionSetColumns=function(){var t=this;this.dataSet.columns.forEach(function(i){var o=i.dataType?i.dataType.toLowerCase():null;o===e.MscrmDataTypes.multiSelectOptionset&&t.multiSelectOptionSetColumns.push(i)})},t.prototype.getTargetEntityType=function(){return e.GridUtils.isUci()?this.dataSet.getTargetEntityType():null},t.prototype.getCurrentRecord=function(){return this.dataSet.getSelectedRecord()},t.prototype.getRecordById=function(e){return this.gridDataSet.records[e]},Object.defineProperty(t.prototype,"records",{get:function(){return this.gridDataSet.records},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.gridDataSet.columns},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataSet",{get:function(){return this.gridDataSet},set:function(e){this.removeDataSetEventHandlers(),this.gridDataSet=e,this.restoreDataSetEventHandlers()},enumerable:!0,configurable:!0}),t.prototype.add_OnDataSetRecordChange=function(e){this.onDataSetRecordChangeHandlers.push(e),this.dataSet.add_OnDataSetRecordChange(e)},t.prototype.remove_OnDataSetRecordChange=function(e){this.dataSet.remove_OnDataSetRecordChange(e),this.onDataSetRecordChangeHandlers.filter(function(t){return t!=e})},t.prototype.addOnDataSetUpdated=function(e){this.onDataSetUpdatedHandlers.push(e),this.dataSet.addOnDataSetUpdated(e)},t.prototype.removeOnDataSetUpdated=function(e){this.dataSet.removeOnDataSetUpdated(e),this.onDataSetUpdatedHandlers.filter(function(t){return t!=e})},Object.defineProperty(t.prototype,"rollupColumns",{get:function(){if(null==this.rollupColumnsCollection){this.rollupColumnsCollection=[];for(var e=0;e<this.columns.length;e++)MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.columns[e].attributes)||this.columns[e].attributes.sourcetype!==Mscrm.AttributeSourceType.Rollup||this.rollupColumnsCollection.push(this.columns[e].name)}return this.rollupColumnsCollection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasDirtyRecord",{get:function(){for(var e=0,t=this.dataSet.sortedRecordIds;e<t.length;e++){var i=t[e];if(this.dataSet.records[i].isDirty())return!0}return!1},enumerable:!0,configurable:!0}),t.prototype.beginRecordSave=function(){var t=this,i=this.dataSet.getSelectedRecord();return!(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||!i.isDirty()||!i.isRecordValid())&&(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridTelemetry)||this.addTelemetryMultiSelectOptionSetSelection(i),this.addToPersistingList(i.getRecordId()),i.save?i.save().then(function(){return t.endRecordSave({recordId:i.getRecordId(),affectedColumns:[],errorStatus:null,fieldErrorMessages:{},isRecordSavedSuccessfully:!0,isSuccessful:!0,resultType:10})}):this.notifyOutputChanged(!0),this.perfTool.tryStart(e.GridPerformanceStopwatch.DataSetUpdate),!0)},t.prototype.addTelemetryMultiSelectOptionSetSelection=function(e){for(var t=0;t<this.multiSelectOptionSetColumns.length;t++){var i=0,o=0,r=this.multiSelectOptionSetColumns[t];MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.getValue(r.name))||(i=e.getValue(r.name).length),MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.attributes.options)||(o=r.attributes.options.length);var n=[{name:"selectCount",value:i},{name:"availableCount",value:o},{name:"optionSetName",value:r.name}];this.gridTelemetry.reportEvent("editablegrid_multiselectoptionsetselection",n)}},t.prototype.endRecordSave=function(t){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.persistingRecords)){var i=this.persistingRecords.indexOf(t.recordId);-1!==i&&this.persistingRecords.splice(i,1),this.raiseSavedEvent(t.recordId,0!==this.persistingRecords.length,t.isRecordSavedSuccessfully),this.perfTool.tryStop(e.GridPerformanceStopwatch.DataSetUpdate)}},t.prototype.submitValue=function(e,t,i){var o=this.gridDataSet.records[e];return MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)?void this.loggingService.logError(MscrmCommon.ControlUtils.String.Format("Could not find record {0} inside dataset.",e)):this.records[e].setValue(t,i)},t.prototype.notifyOnError=function(t){this.errorEvent.hasHandlers&&this.errorEvent.raise(this,new e.GridErrorEventArgs(t,this.hasDirtyRecord))},Object.defineProperty(t.prototype,"saving",{get:function(){return this.savingEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"saved",{get:function(){return this.savedEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gridError",{get:function(){return this.errorEvent},enumerable:!0,configurable:!0}),t.prototype.removeDataSetEventHandlers=function(){var e=this;MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet)||(this.onDataSetRecordChangeHandlers.length>0&&this.onDataSetRecordChangeHandlers.forEach(function(t){e.dataSet.remove_OnDataSetRecordChange(t)}),this.onDataSetUpdatedHandlers.length>0&&this.onDataSetUpdatedHandlers.forEach(function(t){e.dataSet.removeOnDataSetUpdated(t)}))},t.prototype.restoreDataSetEventHandlers=function(){var e=this;this.onDataSetRecordChangeHandlers.length>0&&this.onDataSetRecordChangeHandlers.forEach(function(t){e.dataSet.add_OnDataSetRecordChange(t)}),this.onDataSetUpdatedHandlers.length>0&&this.onDataSetUpdatedHandlers.forEach(function(t){e.dataSet.addOnDataSetUpdated(t)})},t.prototype.addToPersistingList=function(e){-1===this.persistingRecords.indexOf(e)&&(this.persistingRecords.push(e),this.raiseSavingEvent(e))},t.prototype.raiseSavingEvent=function(t){this.savingEvent.hasHandlers&&this.savingEvent.raise(this,new e.RecordSaveEventArgs(t,!0,!1))},t.prototype.raiseSavedEvent=function(t,i,o){this.savedEvent.hasHandlers&&this.savedEvent.raise(this,new e.RecordSaveEventArgs(t,i,o))},t.prototype.dispose=function(){this.removeDataSetEventHandlers(),this.loggingService=null,this.gridDataSet=null,this.notifyOutputChanged=null,this.rollupColumnsCollection=null,this.persistingRecords=null,this.perfTool=null,this.gridTelemetry=null},t}();e.DataSetService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r){this.containerService=e,this.datasetService=t,this.ariaLiveRegionService=i,this.htmlEncode=o,this.troubledRecords=[],this.isEditable=r}return t.prototype.update=function(t){var i=this.troubledRecords.indexOf(t.getRecordId());i>-1&&t.isRecordValid()?(this.troubledRecords.splice(i,1),0===this.troubledRecords.length&&this.showUpdateError("")):-1!==i||t.isRecordValid()||(this.troubledRecords.push(t.getRecordId()),this.showUpdateError(e.GridLocale.genericUpdateError)),this.datasetService.notifyOnError(0!==this.troubledRecords.length)},t.prototype.clearTroubledRecords=function(){this.troubledRecords=[]},t.prototype.clearUpdateError=function(){this.showUpdateError("")},Object.defineProperty(t.prototype,"hasGridError",{get:function(){return 0!==this.troubledRecords.length},enumerable:!0,configurable:!0}),t.prototype.hasError=function(e,t){var i=this.datasetService.records[e];return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&!i.isValid(t)},t.prototype.hasRecordError=function(e){var t=this.datasetService.records[e];return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)&&!t.isRecordValid()},t.prototype.getError=function(e,t){return this.hasError(e,t)?this.datasetService.records[e].getNotification(t):null},t.prototype.getRecordError=function(e){return this.hasRecordError(e)?this.datasetService.records[e].getErrorMessage():null},t.prototype.getCellEncodedErrorMessage=function(t,i,o){var r=this.htmlEncode(this.getRecordError(t)),n=this.htmlEncode(this.getError(t,i)),s=this.hasRecordError(t)&&!MscrmCommon.ControlUtils.String.isNullUndefinedOrWhitespace(r)&&o&&r!=e.GridLocale.genericUpdateError,a=this.hasError(t,i)&&!MscrmCommon.ControlUtils.String.isNullUndefinedOrWhitespace(n);return s&&a?MscrmCommon.ControlUtils.String.Format("<p>{0}</p><p>{1}</p>",r,n):s?r:a?n:null},t.prototype.showUpdateError=function(t){this.isEditable&&(this.updateErrorArea=this.setErrorContainer(e.GridConstants.updateErrorPostfix,t),MscrmCommon.ControlUtils.String.isNullUndefinedOrWhitespace(t)||this.ariaLiveRegionService.sendPoliteMessage(t))},t.prototype.setErrorContainer=function(t,i){var o=document.getElementById(this.containerService.getContainerId()+t);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||(!MscrmCommon.ControlUtils.String.isNullOrEmpty(i)&&i.trim().length>0?(o.tabIndex=0,o.innerHTML=MscrmCommon.ControlUtils.String.Format('<div class="cc-grid-errorIndicator"></div> {0}',this.htmlEncode(i))):(o.removeAttribute(e.GridConstants.tabIndex),o.innerHTML=""),this.containerService.adjustGridHeight()),o},t.prototype.dispose=function(){this.updateErrorArea=null,this.containerService=null},t}();e.ErrorHandlingService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.perfTool=t,this.fieldAccessComponent=e,this.fieldAccessCache={}}return t.prototype.isEditable=function(t){if(t.cellType==wijmo.grid.CellType.Cell&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.row)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.column)){var i=this.tryGetCachedFieldAccess(t.rowId,t.columnName);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)?e.IsEditable.Unknown:i.isEditable?e.IsEditable.Yes:e.IsEditable.No}},t.prototype.deferStartEditing=function(e,t){var i=this;this.getFieldAccess(e.rowId,e.columnName).then(function(o){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)){var r=o.isEditable,n=t.getSelectedState(e.row,e.column)==wijmo.grid.SelectedState.Cursor,s=i.hasCachedFieldAccess(e.rowId,e.columnName);(r&&n&&s||!r&&t.getColumnByName(e.columnName).dataType==wijmo.DataType.Array&&n&&s)&&t.startEditing(!1,e.row,e.column)}})},t.prototype.redrawCell=function(e){if(e.cellType==wijmo.grid.CellType.Cell&&e.row==this.fieldAccessComponent.selectedRow){var t=this.getFieldAccess(e.rowId,e.columnName);this.fieldAccessComponent.applyStyles(e.row,e.column,t)}},t.prototype.redraw=function(e,t){void 0===t&&(t=!1);var i=e.row==this.fieldAccessComponent.selectedRow&&e.isCurrentRowSelected;e.cellType!=wijmo.grid.CellType.Cell||i&&!t||(this.fieldAccessComponent.clearSelectedRowFieldAccess(this.columns),e.isRecordRowSelection&&e.isCurrentRowSelected&&(this.setSelectedRowNumber(e.row),this.redrawRow(e.rowId,this.columns)))},t.prototype.redrawSelectedRow=function(){var e=this.fieldAccessComponent.selectedRowId;MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)||(this.fieldAccessComponent.isRecordSelected(e)?this.redrawRow(e,this.columns):this.clearSelectedRow())},t.prototype.setSelectedRowNumber=function(e){e>-1&&(this.fieldAccessComponent.selectedRow=e)},t.prototype.updateRow=function(e,t){this.fieldAccessCache[e]=null,this.redrawRow(e,t,!0)},t.prototype.clearSelectedRow=function(){this.fieldAccessComponent.clearSelectedRowFieldAccess(this.columns)},t.prototype.redrawRow=function(e,t,i){void 0===i&&(i=!1);for(var o=0;o<this.columns.length;o++){var r=this.columns[o].name,n=this.fieldAccessComponent.getColumnIndex(this.columns[o].name),s=this.fieldAccessComponent.isColumnVisible(this.columns[o].name);if(!(0>n)&&s){var a=this.getFieldAccess(e,r,i);this.fieldAccessComponent.applyStyles(this.fieldAccessComponent.selectedRow,n,a)}}},t.prototype.refreshDataSet=function(e){this.fieldAccessCache={},this.records=e.records,this.columns=e.columns},t.prototype.getFieldAccess=function(t,i,o){var r=this;if(void 0===o&&(o=!1),this.hasCachedFieldAccess(t,i))return Promise.resolve(this.fieldAccessCache[t][i]);var n=e.FieldAccessModel.getDefault(),s=[this.getIsReadable(t,i,n),this.getIsEditable(t,i,n),this.getIsSecured(t,i,n),this.getRequiredLevel(t,i,n)];return this.perfTool.tryStart(e.GridPerformanceStopwatch.FieldAccess),Promise.all(s).then(function(){return r.perfTool.tryStop(e.GridPerformanceStopwatch.FieldAccess),o&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.fieldAccessCache)?(r.cacheFieldAccess(t,i,n),Promise.resolve(r.fieldAccessCache[t][i])):r.hasCachedFieldAccess(t,i)?Promise.resolve(r.fieldAccessCache[t][i]):(MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.fieldAccessCache)||r.cacheFieldAccess(t,i,n),Promise.resolve(n))})},t.prototype.tryGetCachedFieldAccess=function(e,t){return this.hasCachedFieldAccess(e,t)?this.fieldAccessCache[e][t]:null},t.prototype.hasCachedFieldAccess=function(e,t){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.fieldAccessCache[e])&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.fieldAccessCache[e][t])},t.prototype.cacheFieldAccess=function(e,t,i){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.fieldAccessCache[e])&&(this.fieldAccessCache[e]={}),this.fieldAccessCache[e][t]=i},t.prototype.getIsEditable=function(t,i,o){var r=this;return new Promise(function(n,s){(MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.records)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.records[t]))&&s(new Error("No records found"));var a=[];a.push(r.getIsFieldEditable(t,i)),e.GridUtils.isUci()&&a.push(r.getIsRecordEditable(t)),Promise.all(a).then(function(e){var t=!0;e.forEach(function(e){t=t&&e}),o.isEditable=t,n(t)})})},t.prototype.getIsRecordEditable=function(e){var t=this;return new Promise(function(i,o){t.records[e].isEditable(null).then(function(e){i(e)},function(e){o(e)})})},t.prototype.getIsFieldEditable=function(e,t){var i=this;return new Promise(function(o,r){i.records[e].isEditable(t).then(function(e){o(e)},function(e){r(e)})})},t.prototype.getIsSecured=function(e,t,i){var o=this;return new Promise(function(r,n){
(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.records)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.records[e]))&&n(new Error("No records found")),o.records[e].isSecured(t).then(function(e){i.isSecured=e,r(e)},function(e){n(e)})})},t.prototype.getIsReadable=function(e,t,i){var o=this;return new Promise(function(r,n){(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.records)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.records[e]))&&n(new Error("No records found")),o.records[e].isReadable(t).then(function(e){i.isReadable=e,r(e)},function(e){n(e)})})},t.prototype.getRequiredLevel=function(e,t,i){var o=this;return new Promise(function(r,n){(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.records)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.records[e]))&&n(new Error("No records found")),o.records[e].getFieldRequiredLevel(t).then(function(e){i.requiredLevel=e,r(e)},function(e){n(e)})})},t.prototype.dispose=function(){this.fieldAccessCache=null,this.records=null,this.columns=null,this.fieldAccessComponent=null},t}();e.FieldAccessService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){this.dataSetService=e}return e.prototype.setSelectedRecords=function(e){},e.prototype.clearSelectedRecord=function(){return this.dataSetService.dataSet.clearSelectedRecord()},Object.defineProperty(e.prototype,"IsMultiSelectionSupported",{get:function(){return this.isMultiSelectionSupported},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.dataSetService=null},e}();e.SelectionService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t){var i=e.call(this,t)||this;return i.isMultiSelectionSupported=!1,i}return __extends(t,e),t.prototype.setSelectedRecords=function(e){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.rowId)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.columnName)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.rowId)&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.columnName))if(e.isValidEvent&&e.isRecordRowSelection&&e.isRecordColumnSelection&&!e.isMultiSelection){var t=this.dataSetService.dataSet.records[e.rowId];MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)||this.dataSetService.dataSet.setSelectedRecordId(e.rowId,e.isRowHeaderSelected)}else e.isRecordRowSelection||this.clearSelectedRecord()},t}(e.SelectionService);e.SingleSelectionService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o){this.gridComponent=e,this.dataSetService=t,this.filteringContext=i,this.filterTypeCache={},this.perfTool=o}return t.prototype.applyState=function(t){var i=this.dataSetService.dataSet.filtering.getFilter(),o=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.conditions)||!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.filters)&&i.filters.length>0);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t[e.WijmoStateKey.filter])&&!o){var r=t[e.WijmoStateKey.filter],n=this.gridComponent.restoreFilters(e.GridUtils.isRestorableFilterType,r.filterDefinition);MscrmCommon.ControlUtils.Object.isNullOrUndefined(r.filterTypeCache)?this.buildGridFilterStateCache():this.filterTypeCache=r.filterTypeCache,this.restoreGridFilterStateCache();var i=this.dataSetService.dataSet.filtering.getFilter();if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)&&n.length>0){for(var s=0;s<n.length;s++){var a=this.filteringContext.compose(n[s]);i=this.filteringContext.combine(a,i)}return this.dataSetService.dataSet.filtering.setFilter(i),!0}}return!1},t.prototype.saveState=function(t){var i=new e.FilterStateModel;i.filterDefinition=this.gridComponent.getFilterDefinition(),i.filterTypeCache=this.filterTypeCache,t[e.WijmoStateKey.filter]=i},t.prototype.configureFilter=function(t){var i=this.gridComponent.getColumnFilter(t),o=e.GridUtils.getDatasetColumnByName(this.dataSetService.dataSet.columns,i.binding),r=o.attributes.type;if(r!==e.MscrmDataTypes.twoOptions&&r!==e.MscrmDataTypes.optionset&&!e.GridUtils.isStatusOptionSet(o)&&!e.GridUtils.isWholeOptionSet(o)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.dataMap)){if(r===e.MscrmDataTypes.multiSelectOptionset){var n=this.gridComponent.msosDataMap[i.binding];MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)||i.setValueFilter(e.TypeUtils.removeEmptyElements(n.getDisplayValues()))}}else i.setValueFilter(e.TypeUtils.removeEmptyElements(i.dataMap.getDisplayValues()))},t.prototype.buildGridFilterStateCache=function(){for(var t=this.dataSetService.dataSet.columns,i=0;i<t.length;++i){var o=t[i];if(-1!==o.order&&!o.isHidden){var r=this.gridComponent.getColumnFilter(o.name),n=o.attributes.type;switch(r.dataType){case wijmo.DataType.String:if(n===e.MscrmDataTypes.twoOptions||n===e.MscrmDataTypes.optionset||e.GridUtils.isStatusOptionSet(o)||n===e.MscrmDataTypes.multiSelectOptionset||e.GridUtils.isWholeOptionSet(o)){this.filterTypeCache[o.name]=wijmo.grid.filter.FilterType.Value;break}case wijmo.DataType.Date:case wijmo.DataType.Number:this.filterTypeCache[o.name]=wijmo.grid.filter.FilterType.Condition;break;case wijmo.DataType.Array:n===e.MscrmDataTypes.multiSelectOptionset&&(this.filterTypeCache[o.name]=wijmo.grid.filter.FilterType.Value);break;case wijmo.DataType.Object:e.GridUtils.isLookupType(o.dataType)?this.filterTypeCache[o.name]=wijmo.grid.filter.FilterType.Condition:MscrmCommon.ControlUtils.String.EqualsIgnoreCase(o.dataType,e.MscrmDataTypes.dataTypeLookupPartyList)&&(this.filterTypeCache[o.name]=wijmo.grid.filter.FilterType.None)}}}},t.prototype.restoreGridFilterStateCache=function(){var t=this.gridComponent.getColumnFilter(e.GridConstants.btnHeaderColumnName);t.setFilterType(wijmo.grid.filter.FilterType.None);var i=this.gridComponent.getColumnFilter(e.GridConstants.btnHeaderSelectColumnName);i.setFilterType(wijmo.grid.filter.FilterType.None);for(var o=this.dataSetService.dataSet.columns,r=0;r<o.length;++r){var n=o[r];if(-1!==n.order&&!n.isHidden){var t=this.gridComponent.getColumnFilter(n.name),s=this.filterTypeCache[n.name];if(s===wijmo.grid.filter.FilterType.Value){var a=t.valueFilter.showValues;t.setFilterType(this.filterTypeCache[n.name]),this.excludeFilterApplied(t.binding,n)?t.valueFilter.showValues={showNoOptions:!0}:t.valueFilter.showValues=a}else t.setFilterType(this.filterTypeCache[n.name])}}},t.prototype.applyFilter=function(t){var i=new e.FilteringResultModel;this.gridComponent.saveCurrentFilter();var o=this.gridComponent.getColumnFilter(t),r=this.dataSetService.dataSet.filtering.getFilter(),n=e.GridUtils.getFetchAttributes(o.binding,o.dataType),s=n.attributeName,a=n.entityAliasName;if(this.perfTool.tryStart(e.GridPerformanceStopwatch.Filtering),o.isActive||MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)){i.cancel=!0,MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)||this.filteringContext.remove(r,s,a),this.filterIsMultiSelectOptionset(s)&&(o.isMultiSelectOptionSetFilter=!0);var l=this.filteringContext.compose(o);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(l)||!o.isMultiSelectOptionSetFilter&&!this.filterIsOptionset(t,s)||(l=this.verifyEmptyExpression(l,o)),!MscrmCommon.ControlUtils.Object.isNullOrUndefined(l)){var c=this.filteringContext.combine(l,r);this.dataSetService.dataSet.filtering.setFilter(c),i.refreshRequired=!0}}else this.filteringContext.remove(r,s,a)&&(this.dataSetService.dataSet.filtering.setFilter(r),i.refreshRequired=!0);return i},t.prototype.excludeFilterApplied=function(e,t){var i=this.dataSetService.dataSet.filtering.getFilter();if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i))return!1;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSetService.dataSet.filtering.getFilter()))return!1;var o=this.dataSetService.dataSet.filtering.getFilter().conditions;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||0==o.length)return!1;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.attributes)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.attributes.options))return!1;if(t.attributes.options.length!==o.length)return!1;for(var r=0;r<o.length;r++)if(o[r].attributeName!==e||1!==o[r].conditionOperator)return!1;return!0},t.prototype.filterIsOptionset=function(t,i){for(var o=this.gridComponent.getColumnFilter(t),r=null,n=0;n<this.dataSetService.columns.length;n++)if(this.dataSetService.columns[n].name===i){r=this.dataSetService.columns[n];break}return null!==r&&(o.dataType===wijmo.DataType.String&&!(r.attributes.type!==e.MscrmDataTypes.optionset&&!e.GridUtils.isStatusOptionSet(r)&&r.attributes.type!==e.MscrmDataTypes.multiSelectOptionset&&r.attributes.type!==e.MscrmDataTypes.twoOptions&&!e.GridUtils.isWholeOptionSet(r)))},t.prototype.filterIsMultiSelectOptionset=function(t){for(var i=null,o=0;o<this.dataSetService.columns.length;o++)if(this.dataSetService.columns[o].name===t){i=this.dataSetService.columns[o];break}return null!==i&&i.attributes.type===e.MscrmDataTypes.multiSelectOptionset},t.prototype.verifyEmptyExpression=function(e,t){var i=!1;if(e.filters=e.filters||[],0===e.filters.length&&0===e.conditions.length&&(i=!0),1===e.filters.length&&0===e.filters[0].conditions.length&&(i=!0),i){t.valueFilter.showValues={};for(var o=0;o<t.valueFilter.uniqueValues.length;o++)t.valueFilter.showValues[t.valueFilter.uniqueValues[o]]=!0;e=this.filteringContext.composeExclude(t)}return e},t.prototype.dispose=function(){this.filteringContext.dispose(),this.gridComponent=null,this.dataSetService=null,this.filteringContext=null,this.filterTypeCache={}},t}();e.FilteringService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i){this.perfTool=i,this._dataSet=e,this.groupingService=t,this.sortingChangedEvent=new wijmo.Event}return Object.defineProperty(t.prototype,"sortingChanged",{get:function(){return this.sortingChangedEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataSet",{get:function(){return this._dataSet},enumerable:!0,configurable:!0}),t.prototype.applySorting=function(e,t){return void 0===t&&(t=!1),this.applyServerSorting(e,t)},t.prototype.applyState=function(t){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t[e.WijmoStateKey.sort])){var i=t[e.WijmoStateKey.sort];if(i.length>0){if(this.sortingAlreadyApplied(i,this._dataSet.sorting))return!1;var o=this._dataSet.sorting;o.length=0;for(var r=0;r<i.length;++r){var n=new MscrmCommon.DataSetColumnSortStatus;n.name=i[r].propertyName,n.sortDirection=i[r].sortDirection,o.push(n)}return!0}}return!1},t.prototype.saveState=function(t){for(var i=[],o=this._dataSet.sorting,r=0;r<o.length;++r){var n=o[r];i.push({propertyName:n.name,sortDirection:n.sortDirection})}t[e.WijmoStateKey.sort]=i},Object.defineProperty(t.prototype,"isServerGrouped",{get:function(){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.groupingService)&&this.groupingService.isServerGrouped},enumerable:!0,configurable:!0}),t.prototype.sortingAlreadyApplied=function(e,t){if(e.length!==t.length)return!1;var i=e.every(function(e){var i=t.find(function(t){return t.name===e.propertyName&&t.sortDirection===e.sortDirection});return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)});return i},t.prototype.applyServerSorting=function(t,i){this.perfTool.tryStart(e.GridPerformanceStopwatch.Sorting);var o=new MscrmCommon.DataSetColumnSortStatus;o.name=t;var r=this._dataSet.sorting,n=0;if(this.isServerGrouped&&r.length>0&&r[0].name!==o.name&&(n=1),i){for(var s=-1,a=0;a<r.length;a++)if(r[a].name===o.name){r[a].sortDirection=0===r[a].sortDirection?1:0,s=a;break}-1===s&&(o.sortDirection=0,r.push(o))}else{if(r.length>n&&r[n].name===o.name?o.sortDirection=0===r[n].sortDirection?1:0:o.sortDirection=0,r.length>n&&r[n].name===o.name&&r[n].sortDirection===o.sortDirection)return!1;r.length=n,r.push(o)}return this.sortingChangedEvent.raise(this,wijmo.EventArgs.empty),!0},t.prototype.dispose=function(){this._dataSet=null},t}();e.SortingService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i,o){var r=this;this.getGroupHeaderName=function(t,i){var o=new MscrmCommon.ArrayQuery(r.dataSetService.dataSet.columns).firstOrDefault(function(e){return e.name===i}),n=r.typeProcessorService.getValue(r.dataSetService.dataSet.records[t.recId],o,i,!0);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)||e.TypeUtils.isString(n)||(n=n.toString()),MscrmCommon.ControlUtils.String.isNullUndefinedOrWhitespace(n)&&(n=e.WijmoConstants.undefinedString),n},this.gridComponent=t,this.dataSetService=i,this.groupingRequestedEvent=new wijmo.Event,this.isServerGroupedBy=!1,this.typeProcessorService=o}return Object.defineProperty(t.prototype,"groupingRequested",{get:function(){return this.groupingRequestedEvent},enumerable:!0,configurable:!0}),t.prototype.updateView=function(e){this.collectionView=e},t.prototype.applyState=function(t){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t[e.WijmoStateKey.groupby])&&t[e.WijmoStateKey.groupby].length>0)for(var i=t[e.WijmoStateKey.groupby][0].propertyName,o=0,r=this.dataSetService.columns;o<r.length;o++){var n=r[o];if(n.name===i)return this.groupingRequestedEvent.hasHandlers&&this.groupingRequestedEvent.raise(this,new e.GroupingRequestedEventArgs(i,this.collectionView)),!0}return!1},t.prototype.saveState=function(t){var i=[],o=this.gridComponent.getCollectionDataView();if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(o))for(var r=o.groupDescriptions,n=0,s=r;n<s.length;n++){var a=s[n];i.push({propertyName:a.propertyName})}t[e.WijmoStateKey.groupby]=i},t.prototype.applyColumnState=function(e){if(this.isServerGroupedBy&&this.dataSetService.dataSet.sorting.length>0){var t=this.dataSetService.dataSet.sorting[0],i=t.name;this.applyGrouping(i,e)}},Object.defineProperty(t.prototype,"isServerGrouped",{get:function(){return this.isServerGroupedBy},enumerable:!0,configurable:!0}),t.prototype.applyGroupBy=function(e,t){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)&&(t=this.gridComponent.getCollectionDataView()),!!this.isGroupingRequired(e,t)&&(this.applyServerGroupBy(e,t),!0)},t.prototype.applyServerGroupBy=function(e,t){if(this.dataSetService.dataSet.sorting.length=0,e){this.isServerGroupedBy=!0;var i=new MscrmCommon.DataSetColumnSortStatus;i.name=e,i.sortDirection=0,this.dataSetService.dataSet.sorting.push(i)}else this.isServerGroupedBy=!1;this.applyGrouping(e,t)},t.prototype.applyGrouping=function(e,t){t.groupDescriptions.clear(),this.isEmpty(e)||t.groupDescriptions.push(new wijmo.collections.PropertyGroupDescription(e,this.getGroupHeaderName))},t.prototype.isGroupingRequired=function(e,t){return this.isEmpty(e)||this.isColumnExist(e)&&!this.isAlreadyGrouped(e,t)},t.prototype.isAlreadyGrouped=function(e,t){var i=t.groupDescriptions;return i.length>0&&i[0].propertyName===e},t.prototype.isEmpty=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)||""===e},t.prototype.isColumnExist=function(e){for(var t=0,i=this.dataSetService.columns;t<i.length;t++){var o=i[t];if(o.name===e)return!0}return!1},t.prototype.dispose=function(){this.gridComponent=null,this.dataSetService=null,this.collectionView=null},t}();e.GroupingService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e){this.log=e}return t.prototype.logError=function(t){this.log(e.GridConstants.controlName,t,Mscrm.TraceLevel.Error)},t.prototype.logInfo=function(t){this.log(e.GridConstants.controlName,t,Mscrm.TraceLevel.Info)},t.prototype.logWarning=function(t){this.log(e.GridConstants.controlName,t,Mscrm.TraceLevel.Warning)},t.prototype.dispose=function(){this.log=null},t}();e.LoggingService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){this.learningPath=null,this.isDisabled=!1,MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)?this.isDisabled=!0:this.learningPath=e}return e.prototype.addLearningPathId=function(e,t){if(this.isDisabled)return e;var i=e,o=$.parseHTML(e),r=$(o);return r&&r.length>0&&(r.attr(this.learningPath.DOMAttributeName,this.learningPath.baseControlId+"|"+t),i=r.get(0).outerHTML),i},e.prototype.addLearningPathIdToHtmlElement=function(e,t){this.isDisabled||e.setAttribute(this.learningPath.DOMAttributeName,this.learningPath.baseControlId+"|"+t)},e.prototype.dispose=function(){this.learningPath=null},e}();e.LearningPathService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(e){function t(t){var i=e.call(this,t)||this;return i.isMultiSelectionSupported=!0,i}return __extends(t,e),t.prototype.setSelectedRecords=function(e){if(e.isValidEvent&&(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.rowId)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.columnName)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.rowId)&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.columnName))&&(e.isRecordRowSelection||e.isClearSelection)){for(var t=[],i=0;i<e.selectedRows.length;i++){var o=this.dataSetService.dataSet.records[e.selectedRows[i]];MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||t.push(e.selectedRows[i])}t.length>0?this.dataSetService.dataSet.setSelectedRecords(t):this.clearSelectedRecord()}},t}(e.SelectionService);e.MultiSelectionService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r,n,s){this.isOffline=!1,this.navigation=e,this.stateService=t,this.criticalRegionService=i,this.utils=o,this.dataSetService=r,this.formFactor=n,this.isOffline=s}return t.prototype.navigateToEntityForm=function(t){var i=this;if(this.criticalRegionService.prepareForRiskyOperation()&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(t))if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.formFactor)||e.GridUtils.isUci()||!e.GridUtils.isDesktop(this.formFactor))this.utils.getEntityMetadata(t.LogicalName).then(function(e){if(e&&e.IsBPFEntity){if(!i.isOffline){var o="Mscrm.HomepageGrid."+t.LogicalName+".OpenActiveStage",r={CommandButtonId:o};i.dataSetService.dataSet.openDatasetItem(t,r)}}else i.dataSetService.dataSet.openDatasetItem(t,null)},function(e){i.dataSetService.dataSet.openDatasetItem(t,null)});else{var o={entityName:t.LogicalName,entityId:t.Id?t.Id.toString():t.id?t.id.toString():null};this.navigation.openForm(o)}},t.prototype.createEntityReferenceModel=function(t){return new e.GridEntityReferenceModel(t.getRecordId(),t.getPrimaryEntityLogicalName())},t.prototype.dispose=function(){this.navigation=null,this.stateService=null,this.criticalRegionService=null,this.dataSetService=null},t}();e.NavigationService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o){this.gridComponent=e,this.dataSetService=t,this.pagingComponent=i,this.perfTool=o}return t.prototype.movePreviousPage=function(){var t=!1;this.gridComponent.finishEdit();var i=this.gridComponent.getCollectionDataView();return MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||(i.pageIndex>0?(i.moveToPreviousPage(),i.currentItem=null):this.dataSetService.dataSet.paging.hasPreviousPage&&(this.perfTool.tryStart(e.GridPerformanceStopwatch.PagingLoad),t=!0,this.pagingComponent.markAsLoadingPreviousPage())),this.pagingComponent.setPaginationButtonsState(this.dataSetService.dataSet),t},t.prototype.moveNextPage=function(){var t=!1;this.gridComponent.finishEdit();var i=this.gridComponent.getCollectionDataView();return MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||(i.pageIndex<i.pageCount-1?(i.moveToNextPage(),i.currentItem=null):this.dataSetService.dataSet.paging.hasNextPage&&(this.perfTool.tryStart(e.GridPerformanceStopwatch.PagingLoad),t=!0,this.pagingComponent.markAsLoadingNextPage())),this.pagingComponent.setPaginationButtonsState(this.dataSetService.dataSet),t},t.prototype.moveFirstPage=function(){var t=!1;this.gridComponent.finishEdit();var i=this.gridComponent.getCollectionDataView();return MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||(i.pageIndex>0?(i.moveToFirstPage(),i.currentItem=null):this.dataSetService.dataSet.paging.hasPreviousPage&&(this.perfTool.tryStart(e.GridPerformanceStopwatch.PagingLoad),t=!0,this.pagingComponent.markAsLoadingFirstPage())),this.pagingComponent.setPaginationButtonsState(this.dataSetService.dataSet),t},t.prototype.dispose=function(){this.gridComponent=null,this.dataSetService=null,this.pagingComponent=null,this.perfTool=null},t}();e.PagingService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r){this.MAX_PAGES=3,this.SEND_PAGING_INFO_TO_PAGING_CONTROL="sendpaginginfotopagingcontrol",this._scrollHitTop=!1,this._scrollHitBottom=!1,this._disablePagination=!1,this._firstPageInRange=1,this._lastPageInRange=1,this._currentPageNumber=1,this._newPageNumber=null,this._notDisplayedPageCount=0,this._isGridScrolledToBottom=!1,this._pageShift=0,this._isFullPageLoaded=!1,this._shouldRestoreScrollPosition=!1,this.perfTool=r,this.gridComponent=e,this.componentDataSet=t,this.pagingComponent=o,this._utils=i,this.sendPagingInfo()}return t.prototype.resetPreviousRecords=function(){this.previousRecords=null},t.prototype.setDataSet=function(e){this.componentDataSet=e,this.previousRecords=e.selectedRecordIds},Object.defineProperty(t.prototype,"disablePagination",{set:function(e){this._disablePagination=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageSize",{get:function(){return this.componentDataSet.paging.pageSize},enumerable:!0,configurable:!0}),t.prototype.bumpNext=function(){if(!this._scrollHitBottom){if(this._scrollHitBottom=!0,this.appendNewRecords(this.componentDataSet.paging,this.previousRecords))return this._scrollHitBottom=!1,!1;if(this.componentDataSet.paging.hasNextPage)return this.gridComponent.setProgressIndicator(e.ProgressIndicatorPosition.Bottom),!0;this._scrollHitBottom=!1}return!1},t.prototype.bumpPrevious=function(){if(!this._scrollHitTop){if(this._scrollHitTop=!0,this.appendNewRecords(this.componentDataSet.paging,this.previousRecords))return this._scrollHitTop=!1,!1;if(this.componentDataSet.paging.hasPreviousPage)return this.perfTool.tryStart(e.GridPerformanceStopwatch.PagingLoad),this.gridComponent.setProgressIndicator(e.ProgressIndicatorPosition.Top),!0;this._scrollHitTop=!1}return!1},t.prototype.didPerformBumpNext=function(){return this._scrollHitBottom},t.prototype.didPerformBumpPrevious=function(){return this._scrollHitTop},t.prototype.clearBumpScrollFlag=function(){this._scrollHitBottom=!1,this._scrollHitTop=!1},t.prototype.notifyPagingInfoChanged=function(){var e=this.calculateCurrentPage();this._isGridScrolledToBottom=this.isScrolledToBottom(),this._currentPageNumber!==e&&(this._currentPageNumber=e,this.sendPagingInfo())},t.prototype.sendPagingInfo=function(e){e||(e=this._newPageNumber>0?this._newPageNumber:this._currentPageNumber),this._utils.fireEvent(this.SEND_PAGING_INFO_TO_PAGING_CONTROL,{currentPageNumber:e,firstPageNumber:this._firstPageInRange,lastPageNumber:this._lastPageInRange,pageShift:this._pageShift,isGridScrolledToBottom:this._isGridScrolledToBottom})},t.prototype.calculateCurrentPage=function(){var e=this.pagingComponent.getScrollTop(),t=this.pagingComponent.getRowHeight(),i=this._pageShift*t;return Math.max(Math.floor((e+i)/t/this.componentDataSet.paging.pageSize)+1+this._notDisplayedPageCount,1)},t.prototype.setNextPage=function(e){this._newPageNumber=e},t.prototype.isPageNumberChanged=function(){return this._newPageNumber&&this._newPageNumber!==this._currentPageNumber},t.prototype.isNextPageRequested=function(){return!!this._newPageNumber&&this._newPageNumber>this._currentPageNumber},t.prototype.isScrollDown=function(){return this._scrollHitBottom||this.isNextPageRequested()},t.prototype.forcePageNumberUpdate=function(){var e=this.calculateCurrentPage();this.sendPagingInfo(e)},t.prototype.isPageDataSame=function(e,t){return e&&t&&!this.isPageNumberChanged()},t.prototype.isFirstPageTop=function(){return this._scrollHitTop&&1===this._currentPageNumber&&0===this._pageShift},t.prototype.isLastPageBottom=function(e){return this._scrollHitBottom&&this._currentPageNumber===this._lastPageInRange&&e},t.prototype.appendNewRecords=function(t,i){this.previousRecords=i;var o=t.pageSize,r=o*this.MAX_PAGES;if(this._shouldRestoreScrollPosition=!1,!i||!i.length)return!1;var n=this.gridComponent.getSourceCollectionIds(),s=n.length,a=!1,l=!1;if(n.length&&(a=i.length>r&&this._scrollHitBottom?i[i.length-r]===n[0]:i[0]===n[0],l=i[i.length-1]===n[n.length-1]),this.isPageDataSame(a,l)||this.isFirstPageTop()||this.isLastPageBottom(l))return!1;var c=this._currentPageNumber===Math.floor(t.totalResultCount/this.pageSize);if(c&&this.isScrolledToBottom()&&this.isNextPageRequested())return this.forcePageNumberUpdate(),!1;var d=this.isPageAlreadyLoaded(n,i);if(d?this._shouldRestoreScrollPosition=!0:this._scrollHitBottom||this._newPageNumber>this._currentPageNumber?(this.appendRecordsToCollectionView(n,i,r,o),this.isPageNumberChanged()&&(this.gridComponent instanceof e.ListComponent&&r>s?this.restoreScrollPosition():this._shouldRestoreScrollPosition=!0)):this.prependRecordsToCollectionView(n,i,r,o),s>=r){var u=!this._isFullPageLoaded&&!d||l&&this.isScrollDown();this.setScrollPosition(u?this.forcePageNumberUpdate.bind(this):null),this.gridComponent instanceof e.ListComponent||this.notifyPagingInfoChanged(),u&&this.forcePageNumberUpdate(),0!==this._pageShift&&!this._isFullPageLoaded&&this._scrollHitTop&&(this._pageShift=0,this._lastPageInRange=this.MAX_PAGES,this.sendPagingInfo()),this.gridComponent instanceof e.ListComponent&&this._newPageNumber&&this.resetNewPage(),this._shouldRestoreScrollPosition=!0}else this.gridComponent instanceof e.ListComponent&&this._newPageNumber&&d&&this.setScrollPosition(),this.clearBumpScrollFlag();return this.gridComponent.setProgressIndicator(e.ProgressIndicatorPosition.None),!0},t.prototype.isPageAlreadyLoaded=function(e,t){var i=e[0],o=t.indexOf(i);if(-1===o)return!1;var r=Math.floor(o/this.pageSize)+1,n=e.length/this.pageSize;return r<=this._newPageNumber&&this._newPageNumber<r+n},Object.defineProperty(t.prototype,"shouldRestoreScrollPosition",{get:function(){return this._shouldRestoreScrollPosition},enumerable:!0,configurable:!0}),t.prototype.scrollUpFromBottom=function(e,t,i,o){e.scrollTop(t-i-o)},t.prototype.setScrollPosition=function(t){var i=this,o=this._isFullPageLoaded?0:this._pageShift,r=$(this.gridComponent.getScrollableElement()),n=r.prop("offsetHeight"),s=r.prop("scrollHeight"),a=this.pagingComponent.getRowHeight(),l=this.pageSize*a;if(this.gridComponent instanceof e.ListComponent)return this._scrollHitBottom&&setTimeout(function(){o>0?i.scrollUpFromBottom(r,s,o*a,n):(i.scrollUpFromBottom(r,s,l/2,n),setTimeout(function(){i.scrollUpFromBottom(r,s,l,n)},0))},0),void(this._scrollHitTop&&setTimeout(function(){return i._isFullPageLoaded?(r.scrollTop(l/2),void setTimeout(function(){r.scrollTop(l)},0)):void r.scrollTop(a*o)},0));if(this.isScrollDown())if(this._scrollHitBottom)o>0?this.scrollUpFromBottom(r,s,o*a,n):this.scrollUpFromBottom(r,s,l,n);else if(this.gridComponent instanceof e.ListComponent){var c=this._newPageNumber,d=this._notDisplayedPageCount;setTimeout(function(){r.scrollTop(l*(c-d-1)),i.notifyPagingInfoChanged(),t&&t()},0)}else r.scrollTop(l*(this._newPageNumber-this._notDisplayedPageCount-1));else this._scrollHitTop?o>0?r.scrollTop(o*a):r.scrollTop(this.gridComponent instanceof e.ListComponent?1:l):r.scrollTop(l*(this._newPageNumber-this._notDisplayedPageCount-1))},t.prototype.restoreScrollPosition=function(){this.setScrollPosition(),this.clearBumpScrollFlag(),this._shouldRestoreScrollPosition=!1,this._newPageNumber&&this.resetNewPage()},t.prototype.resetNewPage=function(){this._newPageNumber&&(this._currentPageNumber=this._newPageNumber),this._newPageNumber=null},t.prototype.appendRecordsToCollectionView=function(e,t,i,o){var r=e.length;if(r>0&&t[r]&&t[r]!==e[r-1]){r=-1;for(var n=0;n<t.length;n++)if(t[n]===e[e.length-1]){r=n;break}}else r=-1;for(var s=!1,a=r+1,l=0;a<t.length&&o>l;a++,l++)s=!0,e.push(t[a]),e.length>i&&e.shift();s&&(this._isFullPageLoaded=t.length-r-1>=o,this._lastPageInRange++,this._lastPageInRange-this._firstPageInRange===this.MAX_PAGES&&(this._isFullPageLoaded?(this._firstPageInRange++,this._notDisplayedPageCount++):this._pageShift=t.length-r-1),this.sendPagingInfo()),this.gridComponent.updateSourceCollection(e)},t.prototype.prependRecordsToCollectionView=function(e,t,i,o){var r=o;r=t.length;for(var n=0;n<t.length;n++)if(t[n]===e[0]){r=n;break}for(var s=!1,a=0,l=1===this._newPageNumber&&this._currentPageNumber-this._newPageNumber>1,n=r-1;n>=0&&(o>a||l);n--,a++)s=!0,e.unshift(t[n]),e.length>i&&e.pop();this._isFullPageLoaded=a>=o,l?(this._notDisplayedPageCount=0,this._pageShift=0,this._firstPageInRange=1,this._lastPageInRange>this.MAX_PAGES&&(this._lastPageInRange=this.MAX_PAGES),this.sendPagingInfo()):s&&this._firstPageInRange>1&&(this._firstPageInRange--,this._pageShift>0&&this._lastPageInRange===Math.floor(t.length/o+1)&&this._lastPageInRange--,this._lastPageInRange-this._firstPageInRange==this.MAX_PAGES&&(this._notDisplayedPageCount--,this._lastPageInRange--),this.sendPagingInfo()),this.gridComponent.updateSourceCollection(e)},t.prototype.isScrolledToBottom=function(){var e=this.pagingComponent.getClientHeight(),t=this.pagingComponent.getScrollTop(),i=this.pagingComponent.getScrollHeight();return Math.round(i-t)===Math.round(e)},Object.defineProperty(t.prototype,"isPagingInfoDirty",{get:function(){return 0!==this._pageShift||1!==this._firstPageInRange||1!==this._lastPageInRange||0!==this._notDisplayedPageCount},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.gridComponent=null,this.componentDataSet=null,this.pagingComponent=null},t.prototype.reset=function(){this.isPagingInfoDirty&&(this._pageShift=0,this._currentPageNumber=1,this._firstPageInRange=1,this._lastPageInRange=1,this._notDisplayedPageCount=0,this.sendPagingInfo(),$(this.gridComponent.getScrollableElement()).scrollTop(0))},t}();e.EnhancedPagingService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){this.getUserTimeZoneUtcOffset=e}return e.prototype.utcToBrowserTimeZone=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)?e:new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())},e.prototype.browserTimeZoneToUtc=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)?e:new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))},e.prototype.utcToUserLocal=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)?e:new Date(e.getTime()+6e4*(this.getUserTimeZoneUtcOffset(e)+e.getTimezoneOffset()))},e.prototype.userLocalToUtc=function(e){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)?e:new Date(e.getTime()-6e4*(this.getUserTimeZoneUtcOffset(e)+e.getTimezoneOffset()))},e.prototype.dispose=function(){delete this.getUserTimeZoneUtcOffset},e}();e.TimeZoneService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){
function t(e,t,i,o){this.loggingService=e,this.typeProcessorService=t,this.errorHandlingService=i,this.communicationChannel=o}return t.prototype.getGridRecordItems=function(t){this.communicationChannel&&this.communicationChannel.isPresenceEnabled(t.getTargetEntityType())&&(t=this.updateDataSetForPresence(t));var i=this.getAllRecordItems(t);this.allRecordItemsFlatList=i,e.GridUtils.isTreeView(t)&&(i=this.createTree(i));var o=new wijmo.collections.CollectionView(i);return o.pageSize=t.paging.pageSize,o.moveCurrentToPosition(-1),o},t.prototype.getGridRecordItemsOnRecordUpdate=function(t,i,o,r){var n=this.allRecordItemsFlatList,s=new MscrmCommon.ArrayQuery(this.allRecordItemsFlatList).firstOrDefault(function(e){return e.recId===i.getRecordId()}),a=e.WijmoGridFilterUtils.filterRecordItem(s,t.columns,o);if(a){var l=n.indexOf(s);n.splice(l,1)}var c=null;return(a||r)&&(n=this.createTree(n),c=new wijmo.collections.CollectionView(n),c.pageSize=t.paging.pageSize),c},t.prototype.refreshRecordItems=function(e){for(var t=e.columns,i=0,o=this.allRecordItemsFlatList;i<o.length;i++)for(var r=o[i],n=0,s=t;n<s.length;n++){var a=s[n];r[a.name]=this.typeProcessorService.getValue(e.records[r.recId],a,null,!1)}},t.prototype.createTree=function(e){for(var t=e.slice(0),i=0;i<e.length;i++)e[i].children=new MscrmCommon.ArrayQuery(e).where(function(o){var r=o.parentID,n=e[i].parentID,s=e[i].recId.toLowerCase(),a=o.recId.toLowerCase();return MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)||!MscrmCommon.ControlUtils.String.EqualsIgnoreCase(r.Id.toString(),s)||!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)&&MscrmCommon.ControlUtils.String.EqualsIgnoreCase(n.Id.toString(),a)?void 0:(t.splice(t.indexOf(o),1),!0)}).items();return t},t.prototype.getGridRecordItem=function(t,i,o,r){var n,s={};s.recId=t.getRecordId(),s.logicalName=t.getPrimaryEntityLogicalName(),s.isSelected=o,this.communicationChannel&&this.communicationChannel.getPresenceMappedField(s.logicalName)&&(n=this.communicationChannel.getPresenceMappedField(s.logicalName)),e.GridUtils.hasSubGridParentId(t)&&(s[e.SubGridDataSetPropertyNames.SubGridParentIdName]=t[e.SubGridDataSetPropertyNames.SubGridParentIdName]);for(var a=0;a<i.length;a++){var l=i[a],c=l.name;s[c]=this.typeProcessorService.getValue(t,l,null,!1),n==l.name&&(s.sipValue=s[c])}return s.parentID=t.ParentId,s},t.prototype.getAllRecordItems=function(e){var t=[],i=e.sortedRecordIds,o=e.selectedRecordIds,r=e.records;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(r))return t;for(var n=0;n<i.length;n++){var s=!!o&&o.findIndex(function(e){return e==i[n]})>=0;t[n]=this.getGridRecordItem(r[i[n]],e.columns,s,!1)}return t},t.prototype.updateGridRecordItem=function(e,t){var i=new MscrmCommon.ArrayQuery(this.allRecordItemsFlatList).firstOrDefault(function(t){return t.recId===e.getRecordId()});if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)){var o=this.allRecordItemsFlatList.map(function(e){return e.recId});return void this.loggingService.logError(MscrmCommon.ControlUtils.String.Format("Could not find record {0} inside this.flatRecordItemsList ({1})",e.getRecordId(),JSON.stringify(o)))}return this.internalUpdateGridRecordItem(i,e,t)},t.prototype.generateGridRecordItem=function(e,t,i){var o={};return this.internalUpdateGridRecordItem(o,e,t),o},t.prototype.internalUpdateGridRecordItem=function(t,i,o){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i))throw new Error("Missing argument : gridDataSetRecord");t.recId=i.getRecordId();var r=t.parentID!==i.ParentId;t.parentID=i.ParentId,e.GridUtils.hasSubGridParentId(i)&&(t[e.SubGridDataSetPropertyNames.SubGridParentIdName]=i[e.SubGridDataSetPropertyNames.SubGridParentIdName]);for(var n=0;n<o.length;n++){var s=o[n],a=s.name;this.areSame(t[a],i.getValue(a))||(t[a]=this.typeProcessorService.getValue(i,s,null,!1))}return r},t.prototype.updateDataSetForPresence=function(e){for(var t=!1,i=this.communicationChannel.getPresenceMappedField(e.getTargetEntityType()),o=0;o<e.columns.length;o++)e.columns[o].alias==i&&(t=!0);return t||(e.addColumn(i),e.refresh()),e},t.prototype.areSame=function(t,i){return e.TypeUtils.isDate(t)&&e.TypeUtils.isDate(i)?t.getTime()===i.getTime():t===i},t.prototype.dispose=function(){this.errorHandlingService=null,this.typeProcessorService=null,this.loggingService=null},t}();e.WijmoDataAdapterService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){var i=this;this.stateChangedHandler=function(e,t){e.saveState(i.state),i.saveCallback(i.state)},this.statefulControls=[],this.state=MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)?{}:t,this.saveCallback=e}return t.prototype.setServerLayout=function(e){this.currentServerLayout=e},t.prototype.register=function(e){-1===this.statefulControls.indexOf(e)&&(this.statefulControls.push(e),e.stateChanged.addHandler(this.stateChangedHandler))},t.prototype.isStateEmpty=function(){return this.state==={}||null===this.state},t.prototype.saveState=function(e){this.saveDataState(),this.saveLayout(e),this.saveCallback(this.state)},t.prototype.restoreState=function(e){this.hasServerLayoutChanged(e)&&this.tryRestoreState(e);var t=this.updateDataState();return this.restoreLayout(e),t},t.prototype.saveLayout=function(t){this.state[e.WijmoStateKey.clientLayout]=t.columnLayout},t.prototype.saveDataState=function(){for(var e=0,t=this.statefulControls;e<t.length;e++){var i=t[e];i.saveState(this.state)}},t.prototype.updateDataState=function(){for(var e=!1,t=0,i=this.statefulControls;t<i.length;t++){var o=i[t];e=o.applyState(this.state)||e}return e},t.prototype.restoreLayout=function(t){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.state[e.WijmoStateKey.clientLayout])||(t.columnLayout=this.state[e.WijmoStateKey.clientLayout])},t.prototype.hasServerLayoutChanged=function(t){var i=this.state[e.WijmoStateKey.serverLayout];return i!==this.currentServerLayout},t.prototype.tryRestoreState=function(t){for(var i=e.GridUtils.buildLayoutDictionary(t.columnLayout),o={},r=0,n=this.statefulControls;r<n.length;r++){var s=n[r];o[s.stateKey]=e.GridUtils.buildProcessedDescriptions(i,this.state[s.stateKey])}this.state={};for(var a=0,l=this.statefulControls;a<l.length;a++){var s=l[a];this.state[s.stateKey]=o[s.stateKey]}this.state[e.WijmoStateKey.serverLayout]=this.currentServerLayout},t.prototype.dispose=function(){for(var e=0;e<this.statefulControls.length;++e)this.statefulControls[e].stateChanged.removeHandler(this.stateChangedHandler);this.statefulControls=[]},t}();e.WijmoStateService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,o,r){this.timeZoneConverter=e,this.wijmoColumnCache=null,this.client=t,this.gridTelemetry=i,this.allowMsosEditingInGrid=o,this.entityTypeName=r}return t.prototype.generateColumnConfiguration=function(t,i,o,r,n){var s=[];if(t){var a=new wijmo.grid.Column;a.binding="recId",a.name="recId",a.visible=!1,a.dataType=wijmo.DataType.Object,s.push(a);var l=0,c=this.client.allocatedWidth-e.WijmoConstants.specialColumnsWidth;if(e.GridUtils.isPhone(this.client.formFactor))for(var d=0;d<t.length;d++)l+=t[d].visualSizeFactor;for(var u=0>=l?0:c/(l/100),m=0,p=!1,h=0;h<t.length;h++){var g=t[h];if(g.isPrimary&&(p=g.imageProviderWebresource&&!!g.imageProviderFunctionName),-1!==g.order&&!g.isHidden){var f=new wijmo.grid.Column;if(f.header=g.displayName||g.name,f.binding=g.name,e.GridUtils.isDesktop(this.client.formFactor))f.width=g.visualSizeFactor;else if(e.GridUtils.isPhone(this.client.formFactor))f.minWidth=e.WijmoConstants.defaultMinWidth,f.width=u*this.getSizeFactor(g);else{var C=this.getSizeFactor(g);i?(f.minWidth=g.visualSizeFactor>0?g.visualSizeFactor/2:e.WijmoConstants.defaultMinWidth,f.width=t.length>e.WijmoConstants.maxColumnForDynamicSizing||0===C?g.visualSizeFactor:C.toString()+"*"):(f.minWidth=g.visualSizeFactor>0?g.visualSizeFactor:e.WijmoConstants.defaultMinWidth,f.width=g.visualSizeFactor)}if(f.visible=!g.isHidden,f.allowSorting=!g.disableSorting,f.allowDragging=o,g.attributes.type===e.MscrmDataTypes.multiSelectOptionset&&(f.allowSorting=!1,m++),r){var v=r[g.name];v&&(f.width=v,f.size=v)}this.buildWijmoColumn(g.attributes.type,g,f),s.push(f)}}if(m>0){var y=[{name:"editablegrid_multiSelectControlcount",value:m}];this.gridTelemetry.reportEvent("multiselectoptionsetcontrolusage",y)}this.generateAdditionalColumnConfiguration(s,o,p,n)}return this.wijmoColumnCache=s,s},t.prototype.buildWijmoColumn=function(t,i,o){switch(t){case e.MscrmDataTypes.twoOptions:o.dataType=wijmo.DataType.String;break;case e.MscrmDataTypes.dateAndTime:o.dataType=wijmo.DataType.Date,i.attributes.format.toLowerCase()===e.MscrmDataTypes.formatDateAndTime?o.format=this.client.dateFormattingInfo.FullDateTimePattern:o.format=this.client.dateFormattingInfo.ShortDatePattern.replace(/\//g,this.client.dateFormattingInfo.DateSeparator);break;case e.MscrmDataTypes.decimal:case e.MscrmDataTypes.fp:case e.MscrmDataTypes["double"]:case e.MscrmDataTypes.whole:o.dataType=wijmo.DataType.Number,e.GridUtils.isWholeDuration(i)&&(o.minWidth=e.WijmoConstants.durationEditorMinWidth);break;case e.MscrmDataTypes.currency:o.dataType=wijmo.DataType.Number,MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.attributes.format)||""===i.attributes.format?o.format="C4":o.format=i.attributes.format;break;case e.MscrmDataTypes.optionset:o.dataType=wijmo.DataType.String,e.GridUtils.isWholeOptionSet(i)||(o.format="D");break;case e.MscrmDataTypes.multiSelectOptionset:this.allowMsosEditingInGrid||(o.isReadOnly=!0),o.dataType=wijmo.DataType.Array;break;case e.MscrmDataTypes.lookup:case e.MscrmDataTypes.owner:case e.MscrmDataTypes.customer:case e.MscrmDataTypes.partyList:o.dataType=wijmo.DataType.Object,(i.dataType.toLowerCase()!==e.MscrmDataTypes.dataTypeLookupSimple.toLowerCase()||this._shouldConnectionColumnReadOnly(this.entityTypeName,i))&&(o.isReadOnly=!0);break;case e.MscrmDataTypes.singleLine:switch(o.dataType=wijmo.DataType.String,i.attributes.format){case e.MscrmDataTypes.formatEmail:o.inputType="email";break;case e.MscrmDataTypes.formatURL:o.inputType="url"}break;case e.MscrmDataTypes.multiple:o.dataType=wijmo.DataType.String;break;case e.MscrmDataTypes.state:case e.MscrmDataTypes.status:case e.MscrmDataTypes.entityName:case e.MscrmDataTypes.uniqueIdentifier:o.isReadOnly=!0;default:o.dataType=wijmo.DataType.String,o.isReadOnly=!0}},t.prototype.generateColumnUpdate=function(e){for(var t={},i=0;i<e.length;i++){var o=e[i],r={validations:{},format:null,dataMap:null,inputType:null};this.buildAdditionalAttributes(o.attributes.type,o,r),t[o.name]=r}return t},t.prototype.buildAdditionalAttributes=function(t,i,o){switch(t){case e.MscrmDataTypes.decimal:case e.MscrmDataTypes.fp:case e.MscrmDataTypes["double"]:o.validations.max=i.attributes.maxValue,o.validations.min=i.attributes.minValue,o.format=MscrmCommon.ControlUtils.String.Format("N{0}",i.attributes.precision);break;case e.MscrmDataTypes.whole:e.GridUtils.isWholeOptionSet(i)?this.buildAdditionalAttributes(e.MscrmDataTypes.optionset,i,o):i.attributes.format.toLowerCase()===e.MscrmDataTypes.formatLanguage&&i.attributes.format.toLowerCase()===e.MscrmDataTypes.formatTimeZone||(o.validations.max=i.attributes.maxValue,o.validations.min=i.attributes.minValue,o.format="N0");break;case e.MscrmDataTypes.currency:o.validations.max=i.attributes.maxValue,o.validations.min=i.attributes.minValue,o.format=MscrmCommon.ControlUtils.String.Format("N{0}",i.attributes.precision);break;case e.MscrmDataTypes.twoOptions:case e.MscrmDataTypes.optionset:case e.MscrmDataTypes.state:case e.MscrmDataTypes.status:case e.MscrmDataTypes.multiSelectOptionset:var r=e.GridUtils.getOptionsFromAttributes(i),n=new wijmo.grid.DataMap(r,e.GridConstants.OptionSetValue,e.GridConstants.OptionSetLabel);MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)||(o.dataMap=n);break;case e.MscrmDataTypes.singleLine:o.validations.maxLength=i.attributes.maxLength,i.attributes.format.toLowerCase()===e.MscrmDataTypes.formatTextArea&&(o.inputType="hidden");break;case e.MscrmDataTypes.multiple:o.inputType="hidden",o.validations.maxLength=i.attributes.maxLength}},t.prototype.useOriginalEditor=function(t){var i=!0;switch(t.attributes.type){case e.MscrmDataTypes.twoOptions:case e.MscrmDataTypes.dateAndTime:case e.MscrmDataTypes.decimal:case e.MscrmDataTypes.fp:case e.MscrmDataTypes["double"]:case e.MscrmDataTypes.currency:case e.MscrmDataTypes.multiple:case e.MscrmDataTypes.lookup:case e.MscrmDataTypes.whole:case e.MscrmDataTypes.multiSelectOptionset:i=!1;break;case e.MscrmDataTypes.singleLine:t.attributes.format.toLowerCase()===e.MscrmDataTypes.formatTextArea&&(i=!1)}return i&&!e.GridUtils.isWholeOptionSet(t)},t.prototype.getValue=function(t,i,o,r){var n=o,s=null,a=e.WijmoConstants.undefinedString;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t))return a;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)&&(n=i.name),MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.attributes)||(s=i.attributes),e.GridUtils.isWholeDuration(i)&&r)a=t.reformatValue(n);else if(e.GridUtils.isWholeOptionSet(i)&&r){var l=void 0;i.dataType===e.MscrmDataTypes.dataTypeWholeLanguage?l=null==s.languagebycode?s.LanguageByCode:s.languagebycode:i.dataType===e.MscrmDataTypes.dataTypeWholeTimezone&&(l=null==s.timezonebycode?s.TimeZoneByCode:s.timezonebycode);var c=t.getValue(n);a=MscrmCommon.ControlUtils.Object.isNullOrUndefined(l)?c:l[c]}else if("MultiSelectOptionSet"===i.dataType||"MultiSelectPicklist"===i.dataType)r?(a=t.getFormattedValue(n),(MscrmCommon.ControlUtils.Object.isNullOrUndefined(a)||0==a.length)&&(a=e.WijmoConstants.undefinedString)):(a=t.getValue(n),MscrmCommon.ControlUtils.Object.isNullOrUndefined(a)&&(a=[]));else{var d=t.getValue(n);if(i.dataType===e.MscrmDataTypes.dataTypeOptionSet&&e.TypeUtils.isOptionMetadata(d)&&(d=d.getValue("value")),(r||MscrmCommon.ControlUtils.Object.isNullOrUndefined(d))&&(d=t.getFormattedValue(n)),MscrmCommon.ControlUtils.Object.isNullOrUndefined(d)||"object"!=typeof d)a=d;else if(e.TypeUtils.isDate(d)&&s){var u=parseInt(s.behavior);a=2===u||3===u?this.timeZoneConverter.utcToBrowserTimeZone(d):1==u?this.timeZoneConverter.utcToUserLocal(d):d}else if(e.MscrmDataTypes.compare(d,e.MscrmDataTypes.guid))a=d.toString();else if(e.MscrmDataTypes.compare(d,e.MscrmDataTypes.optionSetObject))a=d.get_ValueString();else if(e.MscrmDataTypes.compare(d,e.MscrmDataTypes.xrmEntityReference)||e.MscrmDataTypes.compare(d,e.MscrmDataTypes.entityReference))a=r?d.Name:d;else if(e.MscrmDataTypes.compare(d,e.MscrmDataTypes.entityCollection)){if(a="",!MscrmCommon.ControlUtils.Object.isNullOrUndefined(d)){var m=d.getObjectData(),p=m.entities;a=e.GridUtils.formatEntityRecords(p)}}else a="*unhandled*"}return e.GridUtils.getValueOrNull(a)},t.prototype.buildDatasetValue=function(t,i,o){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o))return null;switch(t){case e.MscrmDataTypes.twoOptions:return o=parseInt(o),1===o;case e.MscrmDataTypes.optionset:return o=parseInt(o),-1===o?null:o;case e.MscrmDataTypes.dateAndTime:return 2===i.attributes.behavior||3===i.attributes.behavior?this.timeZoneConverter.browserTimeZoneToUtc(o):1===i.attributes.behavior?this.timeZoneConverter.userLocalToUtc(o):o;case e.MscrmDataTypes.whole:if(e.GridUtils.isWholeOptionSet(i))return this.buildDatasetValue(e.MscrmDataTypes.optionset,i,o);default:return o}},t.prototype.createButtonColumn=function(e){var t=new wijmo.grid.Column;return t.binding=e,t.name=e,t.header=" ",t.allowSorting=!1,t.allowResizing=!1,t.isReadOnly=!0,t.allowDragging=!1,t.dataType=wijmo.DataType.Object,t.align=this.client.isRTL?"right":"left",t},t.prototype.generateAdditionalColumnConfiguration=function(t,i,o,r){var n=this.createButtonColumn(e.GridConstants.btnHeaderSelectColumnName);if(n.width=o?e.WijmoConstants.selectButtonWithConditionalImageMinimumWidth:e.WijmoConstants.selectButtonMinimumWidth,t.splice(1,0,n),i){var s=this.createButtonColumn(e.GridConstants.btnHeaderColumnName);e.GridUtils.isTouchScreenDevice(this.client)&&e.GridUtils.isReflowByWidth(r)?(s.width=e.WijmoConstants.navigateButtonMinimumWidth,t.splice(2,0,s)):(s.width="*",s.minWidth=2*e.WijmoConstants.navigateButtonMinimumWidth+15,t.push(s))}},t.prototype.getSizeFactor=function(e){return e.visualSizeFactor>0?e.visualSizeFactor/100:e.visualSizeFactor},t.prototype._shouldConnectionColumnReadOnly=function(t,i){return this.entityTypeName===e.GridConstants.connectionEntityName&&i&&i.name===e.GridConstants.connectionReadOnlyColumnName},t.prototype.dispose=function(){this.gridTelemetry=null},t}();e.WijmoTypeProcessorService=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict"}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e){this.timeZoneConverter=e}return t.prototype.compose=function(e){return this.composeConditionFilterExpression(e)},t.prototype.composeExclude=function(e){throw new Error("'composeExclude' should invoke on value filter composer")},t.prototype.dispose=function(){this.timeZoneConverter=null},t.prototype.composeConditionFilterExpression=function(e){var t=e.conditionFilter,i=this.composeFilterCondition(e,t.condition1),o=this.composeFilterCondition(e,t.condition2);MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&(i=o,o=null);var r=new MscrmCommon.FilterExpression;if(r.filterOperator=t.and?0:1,!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)){var n=new MscrmCommon.FilterExpression;if(n.filterOperator=0,n.conditions=i,r.filters=[n],!MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)){var s=new MscrmCommon.FilterExpression;s.filterOperator=0,s.conditions=o,r.filters.push(s)}return r}return null},t.prototype.composeFilterCondition=function(t,i){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.operator)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.value)){var o=new MscrmCommon.ConditionExpression,r=e.GridUtils.getFetchAttributes(t.binding,t.dataType),n=r.attributeName,s=r.entityAliasName;if(o.attributeName=n,o.entityAliasName=s,o.conditionOperator=this.convertConditionOperator(i.operator),t.dataType===wijmo.DataType.Date){var a=this.timeZoneConverter.userLocalToUtc(i.value);if(o.value=a.toISOString(),0===this.convertConditionOperator(i.operator)){o.conditionOperator=27;var l=new MscrmCommon.ConditionExpression;return l.attributeName=n,l.entityAliasName=s,l.conditionOperator=26,l.value=o.value,[o,l]}}else if(t.dataType===wijmo.DataType.String||t.dataType===wijmo.DataType.Object)switch(i.operator){case wijmo.grid.filter.Operator.BW:o.value=i.value+"%";break;case wijmo.grid.filter.Operator.EW:o.value="%"+i.value;break;case wijmo.grid.filter.Operator.CT:o.value="%"+i.value+"%";break;default:o.value=i.value}else o.value=i.value;return[o]}return null},t.prototype.convertConditionOperator=function(e){var t;switch(e){case wijmo.grid.filter.Operator.EQ:t=0;break;case wijmo.grid.filter.Operator.NE:t=1;break;case wijmo.grid.filter.Operator.GT:t=2;break;case wijmo.grid.filter.Operator.GE:t=4;break;case wijmo.grid.filter.Operator.LT:t=3;break;case wijmo.grid.filter.Operator.LE:t=5;break;case wijmo.grid.filter.Operator.CT:t=6;break;case wijmo.grid.filter.Operator.BW:t=6;break;case wijmo.grid.filter.Operator.EW:t=6;break;case wijmo.grid.filter.Operator.NC:t=1;break;default:t=-1}return t},t}();e.ConditionFilterComposer=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.compose=function(e){return this.composeValueFilterExpression(e,1,0)},t.prototype.composeExclude=function(e){return this.composeValueFilterExpression(e,0,1)},t.prototype.dispose=function(){},t.prototype.composeValueFilterExpression=function(t,i,o){var r=t.dataMap,n=e.GridUtils.getFetchAttributes(t.binding,t.dataType),s=n.attributeName,a=n.entityAliasName;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)){var l=new MscrmCommon.FilterExpression;l.filterOperator=i,l.conditions=[],l.filters=[];var c=t.valueFilter.showValues;for(var d in c)if(c.hasOwnProperty(d)){var u=r.getKeyValue(d),m=new MscrmCommon.ConditionExpression;m.attributeName=s,m.entityAliasName=a,m.conditionOperator=o,m.value=u,l.conditions.push(m)}return l}return null},t}();e.ValueFilterComposer=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e){this.dataMap=e}return t.prototype.compose=function(e){return this.composeFilterExpression(e)},t.prototype.composeExclude=function(e){return this.composeExcludeFilterExpression(e)},t.prototype.dispose=function(){},t.prototype.composeExcludeFilterExpression=function(e){var t=new MscrmCommon.FilterExpression;t.filterOperator=0,t.conditions=[];var i=new MscrmCommon.ConditionExpression;return i.attributeName=e.binding,i.conditionOperator=12,t.conditions.push(i),t},t.prototype.composeFilterExpression=function(t){var i=e.GridUtils.getFetchAttributes(t.binding,t.dataType),o=i.attributeName,r=i.entityAliasName;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataMap)){var n=new MscrmCommon.FilterExpression;n.filterOperator=0,n.conditions=[],n.filters=[];var s=new MscrmCommon.ConditionExpression;s.value=[],s.attributeName=o,s.entityAliasName=r,s.conditionOperator=87;var a=t.valueFilter.showValues;for(var l in a)if(a.hasOwnProperty(l)){var c=this.dataMap.getKeyValue(l);s.value.push(c)}return s.value.length>0&&n.conditions.push(s),n}return null},t}();e.MultiselectFilterComposer=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.timeZoneConverter=e,this.gridComponent=t}return t.prototype.getComposer=function(t){return t.isConditionFilter?new e.ConditionFilterComposer(this.timeZoneConverter):t.isValueFilter?t.isMultiSelectOptionSetFilter?new e.MultiselectFilterComposer(this.gridComponent.msosDataMap[t.binding]):new e.ValueFilterComposer:null},t.prototype.compose=function(e){var t=this.getComposer(e);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t))return null;var i=t.compose(e);return t.dispose(),i},t.prototype.composeExclude=function(t){var i=this.getComposer(t);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i))return null;if(!(i instanceof e.ValueFilterComposer||i instanceof e.MultiselectFilterComposer))return null;var o=i.composeExclude(t);return i.dispose(),o},t.prototype.combine=function(e,t){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t))t=new MscrmCommon.FilterExpression,t.conditions=null,t.filterOperator=0,t.filters=[],t.filters.push(e);else{t.filters=t.filters||[];var i=-1;MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.conditions)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.conditions[0])||(i=this.getChildFilterIdx(t,e.conditions[0].attributeName,e.conditions[0].entityAliasName)),-1===i?MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)||t.filters.push(e):t.filters[i]=e}return t},t.prototype.remove=function(e,t,i){e.filters=e.filters||[];var o=this.getChildFilterIdx(e,t,i);return-1!==o&&(e.filters.splice(o,1),!0)},t.prototype.getChildFilterIdx=function(e,t,i){for(var o=-1,r=0;r<e.filters.length;r++){if(e.filters[r].filters.length)for(var n=0;n<e.filters[r].filters.length;n++)if(this.filterMatchName(e.filters[r].filters[n],t,i))return r;if(this.filterMatchName(e.filters[r],t,i))return r}return o},t.prototype.filterMatchName=function(e,t,i){return!(MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.conditions)||!e.conditions.length||MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.conditions[0]))&&(e.conditions[0].attributeName===t&&e.conditions[0].entityAliasName===i)},t.prototype.dispose=function(){this.timeZoneConverter=null},t}();e.FilteringContext=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(e){this.criticalRegionService=e,this.refreshRequestedEvent=new wijmo.Event,this.stateChangedEvent=new wijmo.Event,this.isOffline=!1}return t.prototype.initialize=function(e){},Object.defineProperty(t.prototype,"isOfflineMode",{get:function(){return this.isOffline},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInCriticalRegion",{get:function(){return this.criticalRegionService&&this.criticalRegionService.isInCriticalRegion},enumerable:!0,configurable:!0}),t.prototype.networkStatusChanged=function(e){this.isOffline=e},t.prototype.rendering=function(e){},t.prototype.stateRestored=function(e){},t.prototype.sizeChange=function(e){},t.prototype.rendered=function(e){},t.prototype.enteringCriticalRegion=function(){},t.prototype.saving=function(e){this.isSaveInProgress=!0},t.prototype.saved=function(e){this.isSaveInProgress=e.moreItemsInQueue},t.prototype.leftCriticalRegion=function(){},t.prototype.onError=function(e){this.hasError=e.gridHasError},Object.defineProperty(t.prototype,"refreshRequested",{get:function(){return this.refreshRequestedEvent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateChanged",{get:function(){return this.stateChangedEvent},enumerable:!0,configurable:!0}),t.prototype.getCurrentRecord=function(){return null},t.prototype.hasState=function(){return!1},t.prototype.requestRefresh=function(t){if(void 0===t&&(t=null),this.refreshRequestedEvent.hasHandlers){var i=null===t?e.GridDataSetOperationRequestedArgs.getRefreshCurrentDataSetArgs():t;this.refreshRequestedEvent.raise(this,i)}},t.prototype.raiseStateChanged=function(){this.refreshRequestedEvent.hasHandlers&&this.stateChangedEvent.raise(this,wijmo.EventArgs.empty)},t.prototype.dispose=function(){},t}();e.GridFeature=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(i,o,r,n,s,a,l,c,d,u,m,p,h){var g=t.call(this,p)||this;return g.doubleTap=!1,g.columnWidthByConfiguration={},g.dblClickHandler=function(t,i){if(!(i.target&&i.target instanceof HTMLAnchorElement)){var o=e.SelectionArgumentsModel.buildFromEvent(i,g.gridComponent,!1);if(-1===o.column){var r=g.dataSetService.dataSet.sortedRecordIds[0],n=g.dataSetService.dataSet.records[r];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)){var s=g.navigationService.createEntityReferenceModel(n);return void g.navigationService.navigateToEntityForm(s)}}if(o.isRecordRowSelection&&o.isValidEvent){var n=g.dataSetService.dataSet.records[o.rowId];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)){var s=g.navigationService.createEntityReferenceModel(n);g.navigationService.navigateToEntityForm(s)}}}},g.formatItemHandler=function(t,i){var o=e.FormatItemArgumentsModel.buildFromEventArgs(i),r=i.panel.columns[i.col],n=e.GridUtils.getDatasetColumnByName(g.dataSetService.dataSet.columns,r.binding);MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)&&e.GridUtils.isSelectAllBtnHeaderColumn(r.name)&&i.panel.cellType===wijmo.grid.CellType.ColumnHeader&&(g.gridComponent.applySelectAllButtonAreaHeader(t,o),g.gridComponent.applyNonSelectableCellStyleFormat(t,i)),g.gridComponent.formatCellDisplayValue(i,r),g.gridComponent.applyCellStyleFormat(t,i),g.gridComponent.applyColumnHeaderFormat(t,i),g.gridComponent.applyColumnHeaderSortingStyle(i),g.gridComponent.fixWordWrapColumnHeaderStyle(i),g.gridComponent.addLearningPathIDs(i),g.dataSetService.rollupColumns.length>0&&g.gridComponent.applyRollupColumnsFormat(t,i),t.selection.isValid||i.panel.cellType===wijmo.grid.CellType.ColumnHeader||0!==i.row||i.col!==e.GridUtils.firstInformativeColumnIndex||(i.cell.tabIndex=0)},g.loadedRowsHandler=function(t){var i=t.cells.hostElement,o=g.dataSetService.records?""+Object.keys(g.dataSetService.records).length:"0",r=g.dataSetService.columns?""+g.dataSetService.dataSet.columns.filter(function(e){return e.isHidden===!1}).length:"0";i.hasAttribute(e.GridConstants.dataId)||i.setAttribute(e.GridConstants.dataId,e.GridConstants.cellsDataIdAttributeName),i.setAttribute(e.GridConstants.ariaLabel,g.dataSetService.dataSet.getTitle()),i.setAttribute(e.GridConstants.dataRowCount,o),i.setAttribute(e.GridConstants.dataColumnCount,r)},g.scrollPositionChangedHandler=function(){var e=g.gridComponent;e.hideHighlightedRow()},g.lostFocusHandler=function(){setTimeout(function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(g.selectionService)||g.selectionService.IsMultiSelectionSupported||g.gridComponent.containsFocus()||g.gridComponent.cancelSelection()},100)},g.clickHandler=function(t,i,o){void 0===o&&(o=!1);var r=i.target;if(r&&r instanceof HTMLAnchorElement)r.open&&r.open(i);else if(r&&r.firstChild){var n=r.firstChild;if(n instanceof HTMLAnchorElement&&n.open)for(var s=e.SelectionArgumentsModel.buildFromEvent(i,t),a=t.dataSetService.columns,l=0;l<a.length;l++)if(a[l].isPrimary){a[l].name===s.columnName&&n.open(i);break}}},g.focusEventTarget=function(e){e.target.parentElement.focus(),e.stopPropagation(),e.preventDefault()},g.keyDownHandler=function(t,i){var o=g.gridComponent.selection,r=i.keyCode;if(o.row>-1&&o.col>-1){var n=g.gridComponent.findCellHtml(o.row,o.col);if(n&&n.selectPrevItem&&(r==e.GridConstants.kbArrowLeftCode?n.isFirsItemSelected()?g.focusEventTarget(i):n.selectPrevItem(i):r==e.GridConstants.kbArrowRightCode&&(n.isLastItemSelected()?g.focusEventTarget(i):n.selectNextItem(i))),n&&r==e.GridConstants.kbEnterCode){var s=n.firstChild;if(s&&s.open)s.open(i);else{var a=g.gridComponent.row(o.row).dataItem.recId,l=g.dataSetService.dataSet.records[a];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(l)){var c=g.navigationService.createEntityReferenceModel(l);g.dataSetService.dataSet.openDatasetItem(c)}}}}},g.clearTimer=function(){g.timer&&(clearTimeout(g.timer),g.timer=null)},g.tapHold=function(t,i,o){switch(g.clearTimer(),o.cellType){case wijmo.grid.CellType.RowHeader:case wijmo.grid.CellType.TopLeft:e.GridUtils.click(i.target)}g.gridComponent.showDetailGrid(g.gridComponent.row(o.row)),g.clickHandler(t,i,!0),i.preventDefault()},g.tap=function(e,t){g.clearTimer(),g.dblClickHandler(e,t),t.preventDefault()},g.touchStartHandler=function(t,i){var o=e.SelectionArgumentsModel.buildFromEvent(i,g.gridComponent);return o.isRowHeaderSelected?void(g.timer=setTimeout(function(){return g.tapHold(t,i,o)},e.WijmoConstants.tapHoldThreshold)):void(g.client&&g.client.userAgent&&g.client.userAgent.isIos&&(g.doubleTap?g.tap(t,i):(g.doubleTap=!0,setTimeout(function(){return g.doubleTap=!1},e.GridConstants.doubleTapThreshold))))},g.touchEndHandler=function(e,t){g.timer&&g.tap(e,t)},g.touchMoveHandler=function(e,t){g.clearTimer()},g.selectionChangedHandler=function(t,i){var o=e.SelectionArgumentsModel.buildFromEventArgs(i,g.selectionService.IsMultiSelectionSupported),r=o.selectionEvent?o.selectionEvent.target:null;return r&&r instanceof HTMLAnchorElement?void(i.cancel=!0):(g.selectionService.setSelectedRecords(o),void g.gridComponent.applyCellsSelectionStyle())},g.gridComponent=i,g.typeProcessorService=o,g.parentFieldAccessService=r,g.selectionService=n,g.dataSetService=s,g.navigationService=a,
g.containerService=l,g.mode=d,g.dataAdapterService=u,g.ariaLiveRegionService=m,g.fieldFactory=h,g.client=c,g}return __extends(i,t),i.prototype.initialize=function(t){var i=t.parameters;this.gridComponent.isEditable=!1,e.GridUtils.firstInformativeColumnIndex=2,this.gridComponent.init(),this.gridComponent.disableDefaultEnterHandler(),this.gridComponent.formatItem.addHandler(this.formatItemHandler),this.gridComponent.loadedRows.addHandler(this.loadedRowsHandler),this.gridComponent.click.addHandler(this.clickHandler),this.gridComponent.touchStart.addHandler(this.touchStartHandler),this.gridComponent.touchEnd.addHandler(this.touchEndHandler),this.gridComponent.touchMove.addHandler(this.touchMoveHandler),this.gridComponent.dblClick.addHandler(this.dblClickHandler),this.gridComponent.scrollPositionChanged.addHandler(this.scrollPositionChangedHandler),this.gridComponent.lostFocus.addHandler(this.lostFocusHandler),this.gridComponent.selectionChanged.addHandler(this.selectionChangedHandler),this.gridComponent.keyDown.addHandler(this.keyDownHandler),e.GridUtils.isTreeView(i.Grid)&&(this.gridComponent.enableTreeView(),this.gridComponent.loadedRows.addHandler(this.loadedRowsHandler)),this.selectionService.IsMultiSelectionSupported?this.gridComponent.enableMultiSelection():this.gridComponent.disableMultiSelection(),this.initializeColumns()},i.prototype.initializeColumns=function(){var t=this.containerService.maxWidth;this.maxWidth=Math.floor(t),this.cacheConfiguredGridColumnWidth(this.dataSetService.columns);var i=e.GridUtils.calculateColumnWidth(this.dataSetService,this.maxWidth,this.totalConfiguredWidth,this.visibleColumnCount,this.columnWidthByConfiguration,e.GridUtils.isTouchScreenDevice(this.client)),o=this.typeProcessorService.generateColumnConfiguration(this.dataSetService.columns,!1,this.gridComponent.isEditable,i);this.gridComponent.initializeColumns(o)},i.prototype.getCurrentRecord=function(){var t=this.dataSetService.getCurrentRecord();if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)||!t.isDirty())return null;var i=new e.RecordDefenition;return i.name="Grid",i.value=t,i},i.prototype.cacheConfiguredGridColumnWidth=function(t){var i=e.GridUtils.calculateConfiguredGridColumnWidth(t),o=i.totalWidth,r=i.columnCount,n=i.columnWidths;this.totalConfiguredWidth=o,this.visibleColumnCount=r,this.columnWidthByConfiguration=n},i.prototype.stateRestored=function(t){var i=this.containerService.maxWidth;if(this.maxWidth!==i){this.maxWidth=Math.floor(i);var o=e.GridUtils.calculateColumnWidth(this.dataSetService,this.maxWidth,this.totalConfiguredWidth,this.visibleColumnCount,this.columnWidthByConfiguration,e.GridUtils.isTouchScreenDevice(this.client));this.gridComponent.setWijmoColumnWidth(o)}},i.prototype.dispose=function(){this.gridComponent.formatItem.removeHandler(this.formatItemHandler),this.gridComponent.loadedRows.removeHandler(this.loadedRowsHandler),this.gridComponent.click.removeHandler(this.clickHandler),this.gridComponent.touchStart.removeHandler(this.touchStartHandler),this.gridComponent.touchEnd.removeHandler(this.touchEndHandler),this.gridComponent.touchMove.removeHandler(this.touchMoveHandler),this.gridComponent.dblClick.removeHandler(this.dblClickHandler),this.gridComponent.scrollPositionChanged.removeHandler(this.scrollPositionChangedHandler),this.gridComponent.lostFocus.removeHandler(this.lostFocusHandler),this.gridComponent.selectionChanged.removeHandler(this.selectionChangedHandler),this.gridComponent.keyDown.removeHandler(this.keyDownHandler),this.gridComponent=null,this.typeProcessorService=null,this.parentFieldAccessService=null,this.selectionService=null,this.dataSetService=null,this.navigationService=null},i}(e.GridFeature);e.ReadOnly=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(i,o,r,n,s,a,l,c,d,u,m,p,h,g,f){var C=t.call(this,h)||this;return C.datasetUpdateHandler=function(t){C.perfTool.tryStop(e.GridPerformanceStopwatch.DataSetUpdate),MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.record)||(C.dataSetService.records[t.recordId]=t.record);var i=C.dataSetService.getRecordById(t.recordId);if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)){var o=MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.affectedColumns)?[]:C.dataSetService.columns.filter(function(e){return-1!==t.affectedColumns.indexOf(e.name)});switch(t.resultType){case 1:C.gridComponent.renderUpdatedRecord(t,i,o);break;case 3:case 2:C.parentFieldAccessService.updateRow(t.recordId,o);break;case 10:C.dataSetService.endRecordSave(t),t.isRecordSavedSuccessfully&&!i.isRecordValid()&&i.validateAllColumns();case 4:C.errorHandlingService.update(i),C.gridComponent.refresh()}}},C.loadedRowsHandler=function(e,t){C.gridComponent.enableTreeViewEditing()},C.dblClickHandler=function(t,i){var o=e.SelectionArgumentsModel.buildFromEvent(i,C.gridComponent,!1);if(-1===o.column){var r=C.dataSetService.dataSet.sortedRecordIds[0],n=C.dataSetService.dataSet.records[r];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)){var s=C.navigationService.createEntityReferenceModel(n);return void C.navigationService.navigateToEntityForm(s)}}if(o.isRecordRowSelection&&o.isValidEvent){var n=C.dataSetService.dataSet.records[o.rowId];if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)){var s=C.navigationService.createEntityReferenceModel(n);C.navigationService.navigateToEntityForm(s)}}},C.formatItemHandler=function(t,i){var o=e.FormatItemArgumentsModel.buildFromEventArgs(i),r=i.panel.columns[i.col],n=e.GridUtils.getDatasetColumnByName(C.dataSetService.dataSet.columns,r.binding);return MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)&&e.GridUtils.isBtnHeaderColumn(r.name)?(C.gridComponent.applyNonSelectableCellStyleFormat(t,i),void C.rowButtonManager.handleFormatItem(o)):(MscrmCommon.ControlUtils.Object.isNullOrUndefined(n)&&e.GridUtils.isSelectAllBtnHeaderColumn(r.name)&&i.panel.cellType===wijmo.grid.CellType.ColumnHeader&&(C.gridComponent.applySelectAllButtonAreaHeader(t,o),C.gridComponent.applyNonSelectableCellStyleFormat(t,i)),n&&r&&e.EditorsUtils.isCustomDropDownEditorColumn(r,n)&&e.EditorsUtils.removeOptionsetDropDown(i.cell),C.gridComponent.formatCellDisplayValue(i,r),C.gridComponent.applyCellStyleFormat(t,i),C.gridComponent.applyColumnHeaderFormat(t,i),C.gridComponent.applyColumnHeaderSortingStyle(i),C.gridComponent.fixWordWrapColumnHeaderStyle(i),C.dataSetService.rollupColumns.length>0&&C.gridComponent.applyRollupColumnsFormat(t,i),C.gridComponent.cellEditorHandler(i,r,n,C.client),C.gridComponent.displayCellEditErrorHandler(i,r),void(t.selection.isValid||i.panel.cellType===wijmo.grid.CellType.ColumnHeader||0!==i.row||i.col!==e.GridUtils.firstInformativeColumnIndex||(i.cell.tabIndex=0)))},C.selectionChangingHandler=function(e,t){var i=C.gridComponent.selection,o=t.range.row==i.row&&t.range.row2==i.row2;o||C.parentFieldAccessService.clearSelectedRow()},C.scrollPositionChangedHandler=function(){var e=C.gridComponent;e.finishEdit(),e.hideHighlightedRow(),C.rowButtonManager.handleScrollPositionChanged()},C.lostFocusHandler=function(){setTimeout(function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(C.selectionService)||C.selectionService.IsMultiSelectionSupported||C.gridComponent.containsFocus()||C.gridComponent.cancelSelection()},100)},C.clickHandler=function(t,i,o){if(void 0===o&&(o=!1),!C.selectionService.IsMultiSelectionSupported||o){var r=e.SelectionArgumentsModel.buildFromEvent(i,C.gridComponent);if(!r.isRecordRowSelection)return void C.gridComponent.cancelSelection();r.isRowHeaderSelected&&C.dataSetService.beginRecordSave(),C.selectionService.setSelectedRecords(r),C.parentFieldAccessService.redraw(r)}},C.clearTimer=function(){C.timer&&(clearTimeout(C.timer),C.timer=null)},C.tapHold=function(t,i,o){switch(C.clearTimer(),o.cellType){case wijmo.grid.CellType.RowHeader:case wijmo.grid.CellType.TopLeft:e.GridUtils.click(i.target)}C.gridComponent.showDetailGrid(C.gridComponent.row(o.row)),C.clickHandler(t,i,!0),i.preventDefault()},C.tap=function(e,t){C.clearTimer(),C.dblClickHandler(e,t),t.preventDefault()},C.touchStartHandler=function(t,i){var o=e.SelectionArgumentsModel.buildFromEvent(i,C.gridComponent);o.isRowHeaderSelected&&(C.timer=setTimeout(function(){return C.tapHold(t,i,o)},e.WijmoConstants.tapHoldThreshold))},C.touchEndHandler=function(e,t){C.timer&&C.tap(e,t)},C.touchMoveHandler=function(e,t){C.clearTimer()},C.keyDownHandler=function(t,i){i.ctrlKey&&i.keyCode==e.GridConstants.kbSCode&&(e.TypeUtils.stopEventPropagation(i),MscrmCommon.ControlUtils.Object.isNullOrUndefined(C.dataSetService)||(C.gridComponent.isEditing&&C.gridComponent.finishEdit(),C.dataSetService.beginRecordSave()))},C.selectionChangedHandler=function(t,i){var o=e.SelectionArgumentsModel.buildFromEventArgs(i,C.selectionService.IsMultiSelectionSupported),r=C.dataSetService.dataSet.getSelectedRecord(),n=!1;MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)||r.getRecordId()===o.rowId&&o.isCurrentRowSelected||(n=C.dataSetService.beginRecordSave()),C.parentFieldAccessService.setSelectedRowNumber(C.gridComponent.selection.row),C.selectionService.setSelectedRecords(o),C.parentFieldAccessService.redrawSelectedRow(),C.gridComponent.applyCellsSelectionStyle();var s=o.isRecordRowSelection&&o.isValidEvent&&o.isCellSelection&&!o.isMultiSelection&&o.isCurrentRowSelected,a=C.gridComponent.selectedRows.length,l=C.gridComponent.totalRowsCount;if(setTimeout(function(){var t=$(".wj-topleft > div");a===l?t.addClass(e.GridConstants.rowSelectedClass):t.removeClass(e.GridConstants.rowSelectedClass)},300),s)MscrmCommon.ControlUtils.Object.isNullOrUndefined(o.selectionEvent)||o.isRecordRowSelection&&o.isValidEvent&&(!o.isCellSelection||o.isMultiSelection||o.isKeyboardNavigation||C.deferStartEditing(o),e.TypeUtils.stopEventPropagation(o.selectionEvent));else if(!n){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(r)&&r.getRecordId()===o.rowId)return;C.dataSetService.beginRecordSave()}},C.beginningEditHandler=function(t,i){C.parentFieldAccessService.redrawSelectedRow();var o=e.CellRangeArgumentsModel.buildFromEventArgs(i);1===C.gridComponent.selectedRows.length&&C.gridComponent.selectedRows[0]===o.rowId||(C.gridComponent.cancelSelection(),C.gridComponent.select(i.range));var r=C.parentFieldAccessService.isEditable(o);r===e.IsEditable.Unknown&&C.parentFieldAccessService.deferStartEditing(o,C.gridComponent),C.gridComponent.isControlDisabled=!1;var n=C.gridComponent.getCellData(i.row,i.col,!1);r==e.IsEditable.No&&C.gridComponent.getColumnByName(o.columnName).dataType==wijmo.DataType.Array&&n&&n.length>0?C.gridComponent.isControlDisabled=!0:r!==e.IsEditable.Yes&&(i.cancel=!0),C.gridComponent.beginningEditHandler(t,i)},C.cellEditEndingHandler=function(e,t){C.gridComponent.cellEditEndingHandler(e,t)},C.cellEditEndedHandler=function(e,t){},C.perfTool=f,C.gridComponent=i,C.typeProcessorService=o,C.parentFieldAccessService=r,C.selectionService=n,C.dataSetService=s,C.errorHandlingService=a,C.navigationService=l,C.containerService=c,C.client=d,C.mode=u,C.dataAdapterService=m,C.ariaLiveRegionService=p,C.rowButtonManager=g,C.shouldRefreshGridRecords=!1,C}return __extends(i,t),i.prototype.initialize=function(t){var i=t.parameters;e.GridUtils.isNestedGridConfigured=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.SubGrid),e.GridUtils.firstInformativeColumnIndex=this.gridComponent.isEditable&&e.GridUtils.isTouchScreenDevice(t.client)&&e.GridUtils.isReflowByWidth(this.containerService.maxWidth)?3:2,this.gridComponent.init(),this.gridComponent.initializeColumns(this.typeProcessorService.generateColumnConfiguration(i.Grid.columns,!1,this.gridComponent.isEditable,null,this.containerService.maxWidth)),this.gridComponent.formatItem.addHandler(this.formatItemHandler),this.gridComponent.click.addHandler(this.clickHandler),this.gridComponent.beginningEdit.addHandler(this.beginningEditHandler),this.gridComponent.cellEditEnding.addHandler(this.cellEditEndingHandler),this.gridComponent.cellEditEnded.addHandler(this.cellEditEndedHandler),this.gridComponent.selectionChanged.addHandler(this.selectionChangedHandler),this.gridComponent.keyDown.addHandler(this.keyDownHandler),this.dataSetService.add_OnDataSetRecordChange(this.datasetUpdateHandler),this.gridComponent.touchStart.addHandler(this.touchStartHandler),this.gridComponent.touchEnd.addHandler(this.touchEndHandler),this.gridComponent.touchMove.addHandler(this.touchMoveHandler),this.gridComponent.dblClick.addHandler(this.dblClickHandler),this.gridComponent.scrollPositionChanged.addHandler(this.scrollPositionChangedHandler),this.gridComponent.selectionChanging.addHandler(this.selectionChangingHandler),this.gridComponent.lostFocus.addHandler(this.lostFocusHandler),e.GridUtils.isTreeView(i.Grid)&&(this.gridComponent.enableTreeView(),this.gridComponent.loadedRows.addHandler(this.loadedRowsHandler)),this.selectionService.IsMultiSelectionSupported?this.gridComponent.enableMultiSelection():this.gridComponent.disableMultiSelection()},i.prototype.rendering=function(e){this.parentFieldAccessService.refreshDataSet(e.gridDataSet)},i.prototype.stateRestored=function(t){var i=this;this.perfTool.tryStart(e.GridPerformanceStopwatch.AdditionalAttributes),t.gridDataSet.generateAdditionalAttributes().done(function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.gridComponent)||(i.perfTool.tryStop(e.GridPerformanceStopwatch.AdditionalAttributes),i.gridComponent.updateColumns(i.typeProcessorService.generateColumnUpdate(t.gridDataSet.columns)),i.sizeChange(t),i.shouldRefreshGridRecords||(i.dataAdapterService.refreshRecordItems(t.gridDataSet),i.gridComponent.refresh(),i.shouldRefreshGridRecords=!0))}).fail(function(){i.perfTool.tryStop(e.GridPerformanceStopwatch.AdditionalAttributes)})},i.prototype.sizeChange=function(t){if(e.GridUtils.isUci()){var i=e.GridUtils.calculateConfiguredGridColumnWidth(this.dataSetService.columns),o=i.totalWidth,r=i.columnCount,n=i.columnWidths,s=e.GridUtils.isTouchScreenDevice(this.client),a=this.containerService.maxWidth;a-=s&&e.GridUtils.isReflowByWidth(this.containerService.maxWidth)?e.WijmoConstants.navigateButtonMinimumWidth:e.WijmoConstants.specialColumnWithConditionalImageWidth;var l=e.GridUtils.calculateColumnWidth(this.dataSetService,Math.floor(a),o,r,n,s);this.gridComponent.setWijmoColumnWidth(l)}},i.prototype.rendered=function(e){},i.prototype.saving=function(e){t.prototype.saving.call(this,e),this.handleSave(e)},i.prototype.saved=function(e){t.prototype.saved.call(this,e),this.handleSave(e)},i.prototype.getCurrentRecord=function(){var t=this.dataSetService.getCurrentRecord();if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t)||!t.isDirty())return null;var i=new e.RecordDefenition;return i.name="Grid",i.value=t,i},Object.defineProperty(i.prototype,"isEditable",{set:function(e){this.gridComponent.isEditable=e},enumerable:!0,configurable:!0}),i.prototype.handleSave=function(e){this.gridComponent.setRefreshBtnDisabled(this.isSaveInProgress)},i.prototype.deferStartEditing=function(e){var t=this;setTimeout(function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.gridComponent)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.gridComponent.selection)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.gridComponent.selection.col)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(t.gridComponent.selection.row)||t.gridComponent.selection.row!==e.row||t.gridComponent.selection.col!==e.column||t.gridComponent.startEditing(!0,e.row,e.column)},25)},i.prototype.dispose=function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.gridComponent)||(this.gridComponent.formatItem.removeHandler(this.formatItemHandler),this.gridComponent.loadedRows.removeHandler(this.loadedRowsHandler),this.gridComponent.beginningEdit.removeHandler(this.beginningEditHandler),this.gridComponent.cellEditEnding.removeHandler(this.cellEditEndingHandler),this.gridComponent.cellEditEnded.removeHandler(this.cellEditEndedHandler),this.gridComponent.selectionChanged.removeHandler(this.selectionChangedHandler),this.gridComponent.lostFocus.removeHandler(this.lostFocusHandler),this.gridComponent.click.removeHandler(this.clickHandler),this.gridComponent.touchStart.removeHandler(this.touchStartHandler),this.gridComponent.touchEnd.removeHandler(this.touchEndHandler),this.gridComponent.touchMove.removeHandler(this.touchMoveHandler),this.gridComponent.dblClick.removeHandler(this.dblClickHandler),this.gridComponent.scrollPositionChanged.removeHandler(this.scrollPositionChangedHandler),this.gridComponent.selectionChanging.removeHandler(this.selectionChangingHandler),this.gridComponent.keyDown.removeHandler(this.keyDownHandler)),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSetService)||this.dataSetService.remove_OnDataSetRecordChange(this.datasetUpdateHandler),this.gridComponent=null,this.typeProcessorService=null,this.parentFieldAccessService=null,this.selectionService=null,this.dataSetService=null,this.errorHandlingService=null,this.navigationService=null,this.containerService=null,this.rowButtonManager=null},i}(e.GridFeature);e.EditableGrid=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(i,o,r){var n=t.call(this,r)||this;return n.filterChangingHandler=function(e,t){return!n.criticalRegionService.prepareForRiskyOperation()||n.isOfflineMode?void(t.cancel=!0):void n.filteringService.configureFilter(t.col)},n.filterChangedHandler=function(t,i){if(!n.criticalRegionService.prepareForRiskyOperation()||n.isOfflineMode)return void(i.cancel=!0);var o=n.filteringService.applyFilter(i.col);i.cancel=o.cancel;var r=e.GridDataSetOperationRequestedArgs.getRefreshCurrentDataSetArgs(!0);n.raiseStateChanged(),o.refreshRequired&&n.requestRefresh(r),n.gridComponent.closeFilterEditor()},n.gridComponent=i,n.filteringService=o,n}return __extends(i,t),i.prototype.initialize=function(e){this.gridComponent.initializeFiltering(),this.gridComponent.filterChanging.addHandler(this.filterChangingHandler),this.gridComponent.filterChanged.addHandler(this.filterChangedHandler),this.filteringService.buildGridFilterStateCache()},Object.defineProperty(i.prototype,"stateKey",{get:function(){return e.WijmoStateKey.filter},enumerable:!0,configurable:!0}),i.prototype.saveState=function(e){this.filteringService.saveState(e)},i.prototype.applyState=function(e){return this.filteringService.applyState(e)},i.prototype.hasState=function(){return!0},i.prototype.rendered=function(e){this.filteringService.restoreGridFilterStateCache(),this.gridComponent.restoreAllFilters()},i.prototype.dispose=function(){this.gridComponent.filterChanging.removeHandler(this.filterChangingHandler),this.gridComponent.filterChanged.removeHandler(this.filterChangedHandler),this.gridComponent=null,this.filteringService=null},i}(e.GridFeature);e.Filtering=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o){var r=t.call(this,o)||this;return r.groupingRequestedHandler=function(e,t){r.criticalRegionService.prepareForRiskyOperation()&&(r.groupingComponent.applyGroupBy(t.groupByName),r.groupingService.applyGroupBy(t.groupByName,t.collectionView)&&r.requestRefresh())},r.groupingService=e,r.groupingComponent=i,r}return __extends(i,t),i.prototype.initialize=function(e){this.groupingComponent.initialize(),this.groupingComponent.groupingRequested.addHandler(this.groupingRequestedHandler),this.groupingService.groupingRequested.addHandler(this.groupingRequestedHandler)},Object.defineProperty(i.prototype,"stateKey",{get:function(){return e.WijmoStateKey.groupby},enumerable:!0,configurable:!0}),i.prototype.networkStatusChanged=function(e){t.prototype.networkStatusChanged.call(this,e),this.groupingComponent.disableGroupMenu=this.shouldDisableGrouping},i.prototype.rendering=function(e){this.groupingService.updateView(e.gridView),this.groupingService.applyColumnState(e.gridView)},i.prototype.rendered=function(e){},i.prototype.saveState=function(e){this.groupingService.saveState(e)},i.prototype.applyState=function(e){return this.groupingService.applyState(e)},i.prototype.enteringCriticalRegion=function(){t.prototype.enteringCriticalRegion.call(this),this.groupingComponent.disableGroupMenu=this.shouldDisableGrouping},i.prototype.leftCriticalRegion=function(){t.prototype.leftCriticalRegion.call(this),this.groupingComponent.disableGroupMenu=this.shouldDisableGrouping},i.prototype.hasState=function(){return!0},Object.defineProperty(i.prototype,"shouldDisableGrouping",{get:function(){return this.isOfflineMode||this.isInCriticalRegion},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.groupingComponent.groupingRequested.removeHandler(this.groupingRequestedHandler),this.groupingService.groupingRequested.removeHandler(this.groupingRequestedHandler)},i}(e.GridFeature);e.Grouping=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(i,o,r){var n=t.call(this,r)||this;return n.currentPageNumber=0,n.firstPageClickHandler=function(){n.setCurrentPageNumber(),n.criticalRegionService.prepareForRiskyOperation()&&n.paginationService.moveFirstPage()&&n.requestRefresh(e.GridDataSetOperationRequestedArgs.getRefreshCurrentDataSetArgs(!1,e.DataSetOperation.LoadFirstPage))},n.previousPageClickHandler=function(){n.setCurrentPageNumber(),n.criticalRegionService.prepareForRiskyOperation()&&n.paginationService.movePreviousPage()&&n.requestRefresh(e.GridDataSetOperationRequestedArgs.getRefreshCurrentDataSetArgs(!1,e.DataSetOperation.LoadPreviousPage))},n.nextPageClickHandler=function(){n.setCurrentPageNumber(),n.criticalRegionService.prepareForRiskyOperation()&&n.paginationService.moveNextPage()&&n.requestRefresh(e.GridDataSetOperationRequestedArgs.getRefreshCurrentDataSetArgs(!1,e.DataSetOperation.LoadNextPage))},n.paginationService=i,n.paginationComponent=o,n}return __extends(i,t),i.prototype.initialize=function(e){this.paginationComponent.addPreviousPageClicked(this.previousPageClickHandler),this.paginationComponent.addNextPageClicked(this.nextPageClickHandler),this.paginationComponent.addFirstPageClicked(this.firstPageClickHandler)},i.prototype.networkStatusChanged=function(e){t.prototype.networkStatusChanged.call(this,e),this.paginationComponent.disablePagination=this.shouldDisablePagination},i.prototype.rendered=function(e){this.paginationComponent.ensureCorrectPage(e.gridView),this.paginationComponent.setPaginationButtonsState(e.gridDataSet)},i.prototype.stateRestored=function(e){var t=e.gridView;t.pageCount>=this.currentPageNumber&&t.moveToPage(this.currentPageNumber)},i.prototype.enteringCriticalRegion=function(){t.prototype.enteringCriticalRegion.call(this),this.paginationComponent.disablePagination=this.shouldDisablePagination},i.prototype.leftCriticalRegion=function(){t.prototype.leftCriticalRegion.call(this),this.paginationComponent.disablePagination=this.shouldDisablePagination},Object.defineProperty(i.prototype,"shouldDisablePagination",{get:function(){return this.isOfflineMode||this.isInCriticalRegion},enumerable:!0,configurable:!0}),i.prototype.setCurrentPageNumber=function(){this.currentPageNumber=this.paginationComponent.getCurrentPageNumber()},i.prototype.dispose=function(){this.paginationComponent.removePreviousPageClicked(this.previousPageClickHandler),this.paginationComponent.removeNextPageClicked(this.nextPageClickHandler),this.paginationComponent.removeFirstPageClicked(this.firstPageClickHandler)},i}(e.GridFeature);e.Pagination=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(i,o){var r=t.call(this,null)||this;return r._isScrolledAfterBump=!1,r.addScrollListener=function(){r.paginationComponent.addGridScrolledListener(r.gridScrollHandler)},r.gridScrollHandler=function(){setTimeout(function(){var t=r.paginationComponent.getClientHeight(),i=r.paginationComponent.getScrollTop(),o=r.paginationComponent.getScrollHeight();if(r.paginationService.notifyPagingInfoChanged(),Math.round(o-i)<=Math.round(t)+1&&r._isScrolledAfterBump){if(r.paginationService.bumpNext())return r.requestRefresh(e.GridDataSetOperationRequestedArgs.getRefreshCurrentDataSetArgs(!1,e.DataSetOperation.LoadNextPage)),void(r._isScrolledAfterBump=!1)}else if(0===i&&r._isScrolledAfterBump&&r.paginationService.bumpPrevious())return r.requestRefresh(e.GridDataSetOperationRequestedArgs.getRefreshCurrentDataSetArgs(!1,e.DataSetOperation.LoadPreviousPage)),void(r._isScrolledAfterBump=!1);r._isScrolledAfterBump=!0},0)},r.paginationService=i,r.paginationComponent=o,r}return __extends(i,t),i.prototype.initialize=function(e){this.addScrollListener()},i.prototype.removeScrollListener=function(){this.paginationComponent.removeGridScrolledListener(this.gridScrollHandler)},i.prototype.networkStatusChanged=function(e){t.prototype.networkStatusChanged.call(this,e)},i.prototype.enteringCriticalRegion=function(){t.prototype.enteringCriticalRegion.call(this),this.paginationService.disablePagination=this.shouldDisablePagination},i.prototype.leftCriticalRegion=function(){t.prototype.leftCriticalRegion.call(this),this.paginationService.disablePagination=this.shouldDisablePagination},Object.defineProperty(i.prototype,"shouldDisablePagination",{get:function(){return this.isOfflineMode||this.isInCriticalRegion},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.paginationService.dispose(),this.removeScrollListener(),this.paginationComponent.dispose()},i}(e.GridFeature);e.EnhancedPagination=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o){var r=t.call(this,o)||this;return r.multiColumnKey="shiftKey",r.sortingHandler=function(e,t){if(t.cancel=!0,r.criticalRegionService.prepareForRiskyOperation()&&!r.shouldDisableSorting){var i=e.columns[t.col].binding;if(e.columns[t.col].allowSorting){var o=MscrmCommon.ControlUtils.Object.isNullOrUndefined(e._mouseHdl._eMouse)?null:e._mouseHdl._eMouse[r.multiColumnKey];r.sortingService.applySorting(i,o)&&r.requestRefresh()}r.gridComponent.onSortedColumn(t)}},r.sortingChangedHandler=function(e,t){r.criticalRegionService.prepareForRiskyOperation()&&!r.shouldDisableSorting&&r.raiseStateChanged()},r.gridComponent=e,r.sortingService=i,r}return __extends(i,t),i.prototype.initialize=function(e){this.gridComponent.sortingColumn.addHandler(this.sortingHandler),this.sortingService.sortingChanged.addHandler(this.sortingChangedHandler)},Object.defineProperty(i.prototype,"stateKey",{get:function(){return e.WijmoStateKey.sort},enumerable:!0,configurable:!0}),i.prototype.saveState=function(e){this.sortingService.saveState(e)},i.prototype.applyState=function(e){return this.sortingService.applyState(e)},i.prototype.hasState=function(){return!0},Object.defineProperty(i.prototype,"shouldDisableSorting",{get:function(){return this.isOfflineMode&&!this.gridComponent.isOfflineFeatureAvailable()||this.isInCriticalRegion},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.gridComponent.sortingColumn.removeHandler(this.sortingHandler),this.sortingService.sortingChanged.removeHandler(this.sortingChangedHandler),this.gridComponent=null,this.sortingService=null},i}(e.GridFeature);e.Sorting=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(e,i,o,r){var n=t.call(this,o)||this;return n.parentGridComponent=e,n.gridBuilder=i,n.details=[],n.perfTool=r,n}return __extends(i,t),i.prototype.initialize=function(t){this.context=t;var i=t.parameters;if(this.inputBag=i,!MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.SubGrid)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.GridUtils.getDatasetColumnByAlias(i.SubGrid.columns,e.SubGridDataSetPropertyNames.SubGridParentIdName))){if(this.dataSet=i.SubGrid,!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.dataSet)&&!this.dataSet.hasError){var o=this.dataSet.filtering,r={filterOperator:0,conditions:[{attributeName:e.SubGridDataSetPropertyNames.SubGridParentIdName,conditionOperator:0,value:"00000000-0000-0000-0000-000000000000"}]},n={filterOperator:0,conditions:null,filters:[r]};o.setFilter(n)}this.parentGridComponent.createGridDetail(this.createDetailGrid.bind(this),this.isRowHasDetail.bind(this),this.disposeDetailGrid.bind(this))}},i.prototype.getCurrentRecord=function(){if(0===this.details.length)return null;var t=this.details[this.details.length-1],i=t.root.getService(e.Services.dataSetService),o=i.getCurrentRecord();if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||!o.isDirty())return null;var r=new e.RecordDefenition;return r.name="SubGrid",r.value=o,r},i.prototype.createDetailGrid=function(t){var i,o=t.dataItem.recId.toLowerCase(),r=!1;for(i=0;i<this.details.length;i++)if(o===this.details[i].recId){r=!0;break}if(!r){var n=document.createElement("div");if(this.dataSet.hasError)return n.innerText=this.dataSet.errorMessage,n;n.setAttribute(e.GridConstants.parentRecordIdAttributeName,o);var s=e.HideNestedGridColumnHeader.No;s=e.GridUtils.parsePropertyOrDefault(this.inputBag.HideNestedGridColumnHeader,e.HideNestedGridColumnHeaderUtil.parseValue,e.HideNestedGridColumnHeader.No);var a=this.gridBuilder.build(n,this.dataSet,!0,this.criticalRegionService,this.perfTool,s);e.GridUtils.isDetail=!0;var l=a.gridFeatures,c=a.gridComponent;c.parentComponent=this.parentGridComponent;var d=a.getService(e.Services.dataAdapter),u=a.getService(e.Services.stateService),m=a.getService(e.Services.dataSetService),p=a.getService(e.Services.errorHandlingService);c.hideNestedGridColumnHeader=s;var h=new e.SubGridCoordinator(this.parentGridComponent,l,c,d,u,m,this.criticalRegionService,p,this.requestRefresh.bind(this),this.perfTool);this.context.parameters.Grid=this.context.parameters.SubGrid,h.initialize(this.context);var g=new e.GridRowDetail;g.coordinator=h,g.root=a,g.recId=o,g.rootElement=n,this.details.push(g),i=this.details.length-1;var f=g.coordinator.showSubGrid(t);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(f))return}return this.details.length>i?this.details[i].rootElement:null},i.prototype.isRowHasDetail=function(e){return!MscrmCommon.ControlUtils.Object.isNullOrUndefined(e.dataItem.recId)||this.dataSet.hasError},i.prototype.disposeDetailGrid=function(t){var i,o=t;if(o.detail.hasAttribute(e.GridConstants.parentRecordIdAttributeName)&&(i=o.detail.getAttribute(e.GridConstants.parentRecordIdAttributeName)),!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.details)){var r,n=null;for(r=0;r<this.details.length;r++)if(i===this.details[r].recId){n=this.details[r];break}n&&(this.details.splice(r,1),n.coordinator.dispose(),n.root.dispose())}},i.prototype.disposeRowDetail=function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t];MscrmCommon.ControlUtils.Object.isNullOrUndefined(o)||(o.coordinator.dispose(),o.root.dispose())}},i.prototype.dispose=function(){this.disposeRowDetail(this.details),this.details=null},i}(e.GridFeature);e.SubGrid=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(t){function i(i,o,r,n,s,a,l){var c=t.call(this,a)||this;return c.hasPaging=!1,c.keyboardNavigationHandler=function(t,i){var o=!1;!e.TypeUtils.isKeyCode(i,e.GridConstants.kbTabCode)||document.activeElement.id!==c.containerService.getHostId()||i.ctrlKey||i.shiftKey||i.altKey||i.metaKey||-1!==c.gridComponent.selection.col||-1!==c.gridComponent.selection.col2||-1!==c.gridComponent.selection.row||-1!==c.gridComponent.selection.row2||(c.gridComponent.select(0,1),window.setTimeout(function(){var e=document.getElementById(c.containerService.getHostId());MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)||e.focus();
},0),o=!0),e.TypeUtils.isKeyCode(i,e.GridConstants.kbPageUpCode)&&c.hasPaging&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(c.gridComponent.activeEditor)&&(c.pagingComponent.clickPreviousPage(),o=!0),e.TypeUtils.isKeyCode(i,e.GridConstants.kbPageDownCode)&&c.hasPaging&&MscrmCommon.ControlUtils.Object.isNullOrUndefined(c.gridComponent.activeEditor)&&(c.pagingComponent.clickNextPage(),o=!0),i.ctrlKey&&i.keyCode===e.GridConstants.kbSCode&&(e.TypeUtils.preventDefault(i),o=!0),e.TypeUtils.isKeyCode(i,e.GridConstants.kbSpaceCode)&&i.target.tagName===e.GridConstants.divNodeTagName&&e.TypeUtils.preventDefault(i),c.gridComponent.handleKeyboardNavigation(i),o&&c.fieldAccessService.redrawSelectedRow()},c.setupEscapeFromCellHandler=function(e,t){c.gridComponent.keyDown.removeHandler(c.escapeFromCellHandler),1===t.range.col&&0===t.range.row&&window.setTimeout(function(){MscrmCommon.ControlUtils.Object.isNullOrUndefined(c.gridComponent)||c.gridComponent.keyDown.addHandler(c.escapeFromCellHandler)},50)},c.escapeFromCellHandler=function(t,i){!e.TypeUtils.isKeyCode(i,e.GridConstants.kbTabCode)||i.ctrlKey||!i.shiftKey||i.altKey||i.metaKey||1!==c.gridComponent.selection.col||1!==c.gridComponent.selection.col2||0!==c.gridComponent.selection.row||0!==c.gridComponent.selection.row2||(c.gridComponent.cancelSelection(),c.selectionService.clearSelectedRecord(),c.gridComponent.keyDown.removeHandler(c.escapeFromCellHandler))},c.groupbyKeyboardHandler=function(t,i){var o=c.groupingComponent.getItemCount();e.TypeUtils.isKeyCode(i,e.GridConstants.kbArrowDownCode)&&(c.groupingComponent.selectedIndex=(c.groupingComponent.selectedIndex+1)%o),e.TypeUtils.isKeyCode(i,e.GridConstants.kbArrowUpCode)&&(c.groupingComponent.selectedIndex=(c.groupingComponent.selectedIndex-1+o)%o),e.TypeUtils.isKeyCode(i,e.GridConstants.kbSpaceCode)&&(c.groupingComponent.isDroppedDown=!c.groupingComponent.isDroppedDown),e.TypeUtils.isKeyCode(i,e.GridConstants.kbEnterCode)&&(c.groupingComponent.selectedValue=c.groupingComponent.getValue(c.groupingComponent.selectedIndex),c.groupingComponent.itemClicked.raise(c.groupingComponent,null))},c.gridComponent=i,c.groupingComponent=o,c.pagingComponent=r,c.hasPaging=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(c.pagingComponent),c.containerService=n,c.selectionService=s,c.fieldAccessService=l,c}return __extends(i,t),i.prototype.initialize=function(){this.gridComponent.keyDown.addHandler(this.keyboardNavigationHandler),this.gridComponent.selectionChanged.addHandler(this.setupEscapeFromCellHandler),this.gridComponent.enableKeyboardSupport(),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.groupingComponent)||this.groupingComponent.keyDown.addHandler(this.groupbyKeyboardHandler)},i.prototype.dispose=function(){this.gridComponent.keyDown.removeHandler(this.keyboardNavigationHandler),this.gridComponent.keyDown.removeHandler(this.escapeFromCellHandler),this.gridComponent.selectionChanged.removeHandler(this.setupEscapeFromCellHandler),MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.groupingComponent)||this.groupingComponent.keyDown.removeHandler(this.groupbyKeyboardHandler),this.gridComponent=null,this.groupingComponent=null,this.containerService=null,this.selectionService=null,this.fieldAccessService=null,t.prototype.dispose.call(this)},i}(e.GridFeature);e.KeyboardNavigation=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){this.id=e,this.errorMessages={},this.lastAttemptDisplayValue={},this.lastAttemptDataValue={}}return e.prototype.addLastAttemptValue=function(e,t,i){this.lastAttemptDisplayValue[e]=t,this.lastAttemptDataValue[e]=i},e.prototype.hasErrorAt=function(e){return e in this.errorMessages},e.prototype.hasError=function(){return this.errorMessages!=={}},e.prototype.getErrorMessage=function(e){return this.errorMessages[e]},e.prototype.getLastAttemptDisplayValue=function(e){return this.lastAttemptDisplayValue[e]},e.prototype.getLastAttemptDataValue=function(e){return this.lastAttemptDataValue[e]},e.prototype.hasLastAttemptValue=function(e){return e in this.lastAttemptDisplayValue},e.prototype.restoreLastAttempts=function(e){for(var t in this.lastAttemptDataValue)e.setValue(t,this.lastAttemptDataValue[t])},e.prototype.processUpdateResult=function(e){MscrmCommon.ControlUtils.Object.isNullOrUndefined(e)||(this.errorMessages=e.fieldErrorMessages,e.isSuccessful&&(this.lastAttemptDisplayValue={},this.lastAttemptDataValue={}))},e}();e.UpdateErrorRows=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){var t=function(){function t(e,t){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(e))throw new Error("Missing argument : dataSet");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(t))throw new Error("Missing argument : columns");this.dataSet=e,this.columns=t,this.setSorting()}return t.prototype.setSorting=function(){this.dataSet.sorting.splice(0);for(var e=0;e<this.columns.length;e++)this.dataSet.sorting.push({name:this.columns[e].name,sortDirection:0})},t.prototype.setFilter=function(t){t=t.replace(/\\/g,"");var i=this.dataSet.filtering.getFilter();if(!e.GridUtils.isUci()||MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)||!this.isSystemConditionPresent(i)){for(var o=[],r=0;r<this.columns.length;r++){var n={attributeName:this.columns[r].name,conditionOperator:6,value:MscrmCommon.ControlUtils.String.Format("%{0}%",t)};o.push(n)}var s={conditions:o,filterOperator:1};this.dataSet.filtering.clearFilter(),this.dataSet.filtering.setFilter(s)}},t.prototype.clearFilter=function(){var t=this.dataSet.filtering.getFilter();e.GridUtils.isUci()&&this.isSystemConditionPresent(t)||this.dataSet.filtering.clearFilter()},t.prototype.isSystemConditionPresent=function(e){var t=!1;if(null!=e){var i=e.conditions;i.forEach(function(e){var i=this.columns.find(function(t){return t.name===e.attributeName});t=MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)}.bind(this))}return t},t}();e.LookupFilterManager=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){var t=function(){function t(e,t){this.htmlEncode=e,this.columns=t}return t.prototype.withAllowFilterOff=function(e){return this.allowFilterOff=e,this},t.prototype.withIsFilterEnabled=function(e){return this.isFilterEnabled=e,this},t.prototype.withRecords=function(e,t){return this.sortedRecordIds=e,this.records=t,this},t.prototype.build=function(){var i=this,o=this.buildPrefixOptions(),r=[];return this.validateInputData(),new MscrmCommon.ArrayQuery(this.sortedRecordIds).each(function(o){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(i.records[o]))throw t.ErrorInvalidRecordId;var n=e.LookupOption.buildRegularOption(i.records[o],i.columns,i.htmlEncode);r.push(n)}),o.concat(r)},t.prototype.buildPrefixOptions=function(){var t,i=[];return this.allowFilterOff&&(t=this.isFilterEnabled?e.LookupOptionType.DisableFilter:e.LookupOptionType.EnableFilter,i.push(e.LookupOption.buildSpecialOption(t))),i},t.prototype.validateInputData=function(){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.records))throw MscrmCommon.ControlUtils.String.Format(t.ErrorInvalidParameter,"records");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.sortedRecordIds))throw MscrmCommon.ControlUtils.String.Format(t.ErrorInvalidParameter,"sortedRecordIds");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.columns))throw MscrmCommon.ControlUtils.String.Format(t.ErrorInvalidParameter,"columns")},t.ErrorInvalidParameter="Invalid input parameter building the itemsSource collection: {0}",t.ErrorInvalidRecordId="Invalid record ID was found while building the itemsSource collection.",t}();e.LookupItemsCollectionBuilder=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function t(t){this.politeLiveRegionId=t+e.GridConstants.ariaPoliteLiveRegionPostfix,this.assertiveLiveRegionId=t+e.GridConstants.ariaAssertiveLiveRegionPostfix}return t.prototype.sendPoliteMessage=function(e){var t=document.getElementById(this.politeLiveRegionId);t&&(t.textContent=e)},t.prototype.sendAssertiveMessage=function(e){var t=document.getElementById(this.assertiveLiveRegionId);t&&(t.textContent=e)},t.prototype.dispose=function(){this.politeLiveRegionId=null,this.assertiveLiveRegionId=null},t}();e.AriaLiveRegionComponent=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t;!function(e){e[e.No=0]="No",e[e.Yes=1]="Yes"}(t=e.HideNestedGridColumnHeader||(e.HideNestedGridColumnHeader={}));var i=function(){function e(){}return Object.defineProperty(e,"YesString",{get:function(){return"yes"},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NoString",{get:function(){return"no"},enumerable:!0,configurable:!0}),e.parseValue=function(i){var i=MscrmCommon.ControlUtils.Object.isNullOrUndefined(i)?e.NoString:i.toLowerCase();switch(i){case e.YesString:return t.Yes;case e.NoString:return t.No;default:return null}},e}();e.HideNestedGridColumnHeaderUtil=i}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));var MscrmControls;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.groupByMenuHeader="CustomControl_Grid_GroupBy_MenuHeader",e.chooseColumnsMenuHeader="CustomControl_Grid_ChooseColumns_MenuHeader",e.groupByItemsCount="CustomControl_Grid_GroupBy_Items",e.noGroupingOption="CustomControl_Grid_NoGrouping",e.firstPageTooltip="CustomControl_Grid_Paging_First",e.nextPageTooltip="CustomControl_Grid_Paging_Next",e.currentPageTooltip="CustomControl_Grid_Paging_Current",e.previousPageTooltip="CustomControl_Grid_Paging_Previous",e.rollupFieldLastUpdatedLabel="RollupFieldLastUpdatedLabel",e.durationHoursText="L_DurationScrollerItem.Hours_Text",e.durationMinutesText="L_DurationScrollerItem.Minutes_Text",e.durationDaysText="L_DurationScrollerItem.Days_Text",e.durationHourText="L_DurationScrollerItem.Hour_Text",e.durationMinuteText="L_DurationScrollerItem.Minute_Text",e.durationDayText="L_DurationScrollerItem.Day_Text",e.noRecordsText="L_List_No_Records_Text",e.enableLookupFilter="CustomControl_Grid_Lookup_Enable_Filter",e.disableLookupFilter="CustomControl_Grid_Lookup_Disable_Filter",e}();e.GridLocaleLabelIds=t}(t=e.Grid||(e.Grid={}))}(MscrmControls||(MscrmControls={}));
//# sourceMappingURL=E:\VSO_Agent_001\Work_01\8\s\target\Release\amd64\package\Controls\\SharedGrid\SharedGrid.js.map