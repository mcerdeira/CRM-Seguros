!function(){function e(t,n,i){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(r)return r(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}return e}()({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../ISurveyInfo");n.ISurveyInfo=i;var o=e("./IActivityListener");n.IActivityListener=o;var r=e("./IFloodgateSettingIdMap");n.IFloodgateSettingIdMap=r;var a=e("./IFloodgateStorageProvider");n.IFloodgateStorageProvider=a;var s=e("./IFloodgateStringProvider");n.IFloodgateStringProvider=s;var u=e("./ISurvey");n.ISurvey=u;var l=e("./ISurveyComponent");n.ISurveyComponent=l},{"./../ISurveyInfo":8,"./IActivityListener":2,"./IFloodgateSettingIdMap":3,"./IFloodgateStorageProvider":4,"./IFloodgateStringProvider":5,"./ISurvey":6,"./ISurveyComponent":7}],2:[function(e,t,n){"use strict";var i;!function(e){var t=function(){function e(){}return e.AppLaunch="AppLaunch",e.AppUsageTime="AppUsageTime",e.AppResume="AppResume",e}();e.ActivityName=t}(i||(i={})),t.exports=i},{}],3:[function(e,t,n){"use strict";var i;!function(e){e.RoamingSettingIdMap={CampaignStates:1258,GovernedChannelStates:1257,SurveyActivationStats:1259}}(i||(i={})),t.exports=i},{}],4:[function(e,t,n){"use strict";var i;!function(e){var t;!function(e){e[e.FloodgateSettings=0]="FloodgateSettings",e[e.SurveyActivationStats=1]="SurveyActivationStats",e[e.SurveyEventActivityStats=2]="SurveyEventActivityStats",e[e.CampaignDefinitions=3]="CampaignDefinitions",e[e.CampaignStates=4]="CampaignStates",e[e.GovernedChannelStates=5]="GovernedChannelStates"}(t=e.FileType||(e.FileType={}))}(i||(i={})),t.exports=i},{}],5:[function(e,t,n){"use strict";var i;!function(e){var t;!function(e){e[e.NpsPromptTitle=0]="NpsPromptTitle",e[e.NpsPromptQuestion=1]="NpsPromptQuestion",e[e.NpsPromptYesLabel=2]="NpsPromptYesLabel",e[e.NpsPromptNotNowLabel=3]="NpsPromptNotNowLabel",e[e.NpsRatingQuestion=4]="NpsRatingQuestion",e[e.Nps11RatingValue0=5]="Nps11RatingValue0",e[e.Nps11RatingValue1=6]="Nps11RatingValue1",e[e.Nps11RatingValue2=7]="Nps11RatingValue2",e[e.Nps11RatingValue3=8]="Nps11RatingValue3",e[e.Nps11RatingValue4=9]="Nps11RatingValue4",e[e.Nps11RatingValue5=10]="Nps11RatingValue5",e[e.Nps11RatingValue6=11]="Nps11RatingValue6",e[e.Nps11RatingValue7=12]="Nps11RatingValue7",e[e.Nps11RatingValue8=13]="Nps11RatingValue8",e[e.Nps11RatingValue9=14]="Nps11RatingValue9",e[e.Nps11RatingValue10=15]="Nps11RatingValue10",e[e.Nps5RatingValue1=16]="Nps5RatingValue1",e[e.Nps5RatingValue2=17]="Nps5RatingValue2",e[e.Nps5RatingValue3=18]="Nps5RatingValue3",e[e.Nps5RatingValue4=19]="Nps5RatingValue4",e[e.Nps5RatingValue5=20]="Nps5RatingValue5",e[e.NpsCommentQuestion=21]="NpsCommentQuestion",e[e.PsatPromptTitle=22]="PsatPromptTitle",e[e.PsatPromptQuestion=23]="PsatPromptQuestion",e[e.PsatPromptYesLabel=24]="PsatPromptYesLabel",e[e.PsatPromptNotNowLabel=25]="PsatPromptNotNowLabel",e[e.PsatRatingQuestion=26]="PsatRatingQuestion",e[e.PsatRatingValue1=27]="PsatRatingValue1",e[e.PsatRatingValue2=28]="PsatRatingValue2",e[e.PsatRatingValue3=29]="PsatRatingValue3",e[e.PsatRatingValue4=30]="PsatRatingValue4",e[e.PsatRatingValue5=31]="PsatRatingValue5",e[e.PsatCommentQuestion=32]="PsatCommentQuestion",e[e.BpsPromptTitle=33]="BpsPromptTitle",e[e.BpsPromptQuestion=34]="BpsPromptQuestion",e[e.BpsPromptYesLabel=35]="BpsPromptYesLabel",e[e.BpsPromptNotNowLabel=36]="BpsPromptNotNowLabel",e[e.BpsRatingQuestion=37]="BpsRatingQuestion",e[e.BpsRatingValue1=38]="BpsRatingValue1",e[e.BpsRatingValue2=39]="BpsRatingValue2",e[e.BpsCommentQuestion=40]="BpsCommentQuestion"}(t=e.StringType||(e.StringType={}))}(i||(i={})),t.exports=i},{}],6:[function(e,t,n){"use strict";var i;!function(e){var t;!function(e){e[e.Feedback=0]="Feedback",e[e.Nps=1]="Nps",e[e.Psat=2]="Psat",e[e.Bps=3]="Bps",e[e.Fps=4]="Fps",e[e.Nlqs=5]="Nlqs"}(t=e.Type||(e.Type={})),e.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey",e.DOM_NPS_TAGNAME="Nps",e.DOM_PSAT_TAGNAME="Psat",e.DOM_BPS_TAGNAME="Bps",e.DOM_FPS_TAGNAME="Fps",e.DOM_NLQS_TAGNAME="Nlqs"}(i||(i={})),t.exports=i},{}],7:[function(e,t,n){"use strict";var i;!function(e){var t;!function(e){e[e.Prompt="Prompt"]="Prompt",e[e.Comment="Comment"]="Comment",e[e.Rating="Rating"]="Rating",e[e.MultipleChoice="MultipleChoice"]="MultipleChoice"}(t=e.Type||(e.Type={})),e.DOM_PROMPT_TAGNAME="Prompt",e.DOM_COMMENT_TAGNAME="Comment",e.DOM_RATING_TAGNAME="Rating",e.DOM_MULTIPLECHOICE_TAGNAME="MultipleChoice",e.JSON_PROMPT_KEYNAME="prompt",e.JSON_COMMENT_KEYNAME="comment",e.JSON_RATING_KEYNAME="rating",e.JSON_MULTIPLECHOICE_KEYNAME="multipleChoice",e.JSON_APPLICATION_KEYNAME="application",e.JSON_EXTENDEDMANIFESTDATA_KEYNAME="extendedManifestData"}(i||(i={})),t.exports=i},{}],8:[function(e,t,n){"use strict";var i;!function(e){var t;!function(e){e[e.Default="Default"]="Default",e[e.Notification="Notification"]="Notification",e[e.Modal="Modal"]="Modal"}(t=e.LaunchType||(e.LaunchType={}));var n;!function(e){e[e.EmailAddress=0]="EmailAddress"}(n=e.AdditionalDataType||(e.AdditionalDataType={})),e.DOM_TYPE_TAGNAME="Type",e.DOM_TYPE_VALUE="Survey",e.DOM_ID_TAGNAME="SurveyID",e.JSON_SURVEY_KEYNAME="survey",e.JSON_ID_KEYNAME="surveyId"}(i||(i={})),t.exports=i},{}],9:[function(e,t,n){(function(i,o){!function(e,i){"object"==typeof n&&"undefined"!=typeof t?t.exports=i():"function"==typeof define&&define.amd?define(i):e.ES6Promise=i()}(this,function(){"use strict";function t(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function n(e){return"function"==typeof e}function r(e){Q=e}function a(e){q=e}function s(){return function(){return i.nextTick(p)}}function u(){return"undefined"!=typeof z?function(){z(p)}:d()}function l(){var e=0,t=new X(p),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function c(){var e=new MessageChannel;return e.port1.onmessage=p,function(){return e.port2.postMessage(0)}}function d(){var e=setTimeout;return function(){return e(p,1)}}function p(){for(var e=0;e<j;e+=2){var t=$[e],n=$[e+1];t(n),$[e]=void 0,$[e+1]=void 0}j=0}function f(){try{var e=Function("return this")().require("vertx");return z=e.runOnLoop||e.runOnContext,u()}catch(e){return d()}}function h(e,t){var n=this,i=new this.constructor(m);void 0===i[te]&&N(i);var o=n._state;if(o){var r=arguments[o-1];q(function(){return k(o,i,r,n._result)})}else E(n,i,e,t);return i}function g(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var n=new t(m);return C(n,e),n}function m(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function b(){return new TypeError("A promises callback cannot return that same promise.")}function y(e){try{return e.then}catch(e){return re.error=e,re}}function T(e,t,n,i){try{e.call(t,n,i)}catch(e){return e}}function I(e,t,n){q(function(e){var i=!1,o=T(n,t,function(n){i||(i=!0,t!==n?C(e,n):x(e,n))},function(t){i||(i=!0,A(e,t))},"Settle: "+(e._label||" unknown promise"));!i&&o&&(i=!0,A(e,o))},e)}function w(e,t){t._state===ie?x(e,t._result):t._state===oe?A(e,t._result):E(t,void 0,function(t){return C(e,t)},function(t){return A(e,t)})}function S(e,t,i){t.constructor===e.constructor&&i===h&&t.constructor.resolve===g?w(e,t):i===re?(A(e,re.error),re.error=null):void 0===i?x(e,t):n(i)?I(e,t,i):x(e,t)}function C(e,n){e===n?A(e,v()):t(n)?S(e,n,y(n)):x(e,n)}function F(e){e._onerror&&e._onerror(e._result),B(e)}function x(e,t){e._state===ne&&(e._result=t,e._state=ie,0!==e._subscribers.length&&q(B,e))}function A(e,t){e._state===ne&&(e._state=oe,e._result=t,q(F,e))}function E(e,t,n,i){var o=e._subscribers,r=o.length;e._onerror=null,o[r]=t,o[r+ie]=n,o[r+oe]=i,0===r&&e._state&&q(B,e)}function B(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var i=void 0,o=void 0,r=e._result,a=0;a<t.length;a+=3)i=t[a],o=t[a+n],i?k(n,i,o,r):o(r);e._subscribers.length=0}}function _(e,t){try{return e(t)}catch(e){return re.error=e,re}}function k(e,t,i,o){var r=n(i),a=void 0,s=void 0,u=void 0,l=void 0;if(r){if(a=_(i,o),a===re?(l=!0,s=a.error,a.error=null):u=!0,t===a)return void A(t,b())}else a=o,u=!0;t._state!==ne||(r&&u?C(t,a):l?A(t,s):e===ie?x(t,a):e===oe&&A(t,a))}function O(e,t){try{t(function(t){C(e,t)},function(t){A(e,t)})}catch(t){A(e,t)}}function D(){return ae++}function N(e){e[te]=ae++,e._state=void 0,e._result=void 0,e._subscribers=[]}function L(){return new Error("Array Methods must be provided an Array")}function M(e){return new se(this,e).promise}function R(e){var t=this;return new t(H(e)?function(n,i){for(var o=e.length,r=0;r<o;r++)t.resolve(e[r]).then(n,i)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function P(e){var t=this,n=new t(m);return A(n,e),n}function U(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function V(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function W(){var e=void 0;if("undefined"!=typeof o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=ue}var G=void 0;G=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var H=G,j=0,z=void 0,Q=void 0,q=function(e,t){$[j]=e,$[j+1]=t,j+=2,2===j&&(Q?Q(p):ee())},Z="undefined"!=typeof window?window:void 0,K=Z||{},X=K.MutationObserver||K.WebKitMutationObserver,Y="undefined"==typeof self&&"undefined"!=typeof i&&"[object process]"==={}.toString.call(i),J="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$=new Array(1e3),ee=void 0;ee=Y?s():X?l():J?c():void 0===Z&&"function"==typeof e?f():d();var te=Math.random().toString(36).substring(2),ne=void 0,ie=1,oe=2,re={error:null},ae=0,se=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(m),this.promise[te]||N(this.promise),H(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&x(this.promise,this._result))):A(this.promise,L())}return e.prototype._enumerate=function(e){for(var t=0;this._state===ne&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,i=n.resolve;if(i===g){var o=y(e);if(o===h&&e._state!==ne)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===ue){var r=new n(m);S(r,e,o),this._willSettleAt(r,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(i(e),t)},e.prototype._settledAt=function(e,t,n){var i=this.promise;i._state===ne&&(this._remaining--,e===oe?A(i,n):this._result[t]=n),0===this._remaining&&x(i,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;E(e,void 0,function(e){return n._settledAt(ie,t,e)},function(e){return n._settledAt(oe,t,e)})},e}(),ue=function(){function e(t){this[te]=D(),this._result=this._state=void 0,this._subscribers=[],m!==t&&("function"!=typeof t&&U(),this instanceof e?O(this,t):V())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this,i=t.constructor;return n(e)?t.then(function(t){return i.resolve(e()).then(function(){return t})},function(t){return i.resolve(e()).then(function(){throw t})}):t.then(e,e)},e}();return ue.prototype.then=h,ue.all=M,ue.race=R,ue.resolve=g,ue.reject=P,ue._setScheduler=r,ue._setAsap=a,ue._asap=q,ue.polyfill=W,ue.Promise=ue,ue})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:10}],10:[function(e,t,n){function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(e){if(d===setTimeout)return setTimeout(e,0);if((d===i||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function a(e){if(p===clearTimeout)return clearTimeout(e);if((p===o||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function s(){m&&h&&(m=!1,h.length?g=h.concat(g):v=-1,g.length&&u())}function u(){if(!m){var e=r(s);m=!0;for(var t=g.length;t;){for(h=g,g=[];++v<t;)h&&h[v].run();v=-1,t=g.length}h=null,m=!1,a(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var d,p,f=t.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:i}catch(e){d=i}try{p="function"==typeof clearTimeout?clearTimeout:o}catch(e){p=o}}();var h,g=[],m=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];g.push(new l(e,t)),1!==g.length||m||r(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],11:[function(e,t,n){"use strict";function i(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}function o(e){return new g.Promise(function(t,n){var i=document.createElement("script");i.async=!0,i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,t())}:i.onload=function(){t()},i.onerror=function(){n()},i.src=e;var o=window.origin;o&&"null"!==o&&(i.crossOrigin="anonymous");var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(i,r)})}function r(e){f.initialize(e.environment,m,c.default,e.telemetryGroup?e.telemetryGroup.audienceGroup:void 0,e.appId.toString(),e.sessionId,e.build),h.initialize(e.primaryColour,e.secondaryColour)}function a(e){l.setUIStrings(e)}function s(){return new g.Promise(function(e,t){if(v)e();else{if(!p.get().OfficeBrowserFeedback.initOptions)return void t("Window.OfficeBrowserFeedback.initOptions not set");p.get().OfficeBrowserFeedback.sdkVersion=c.default,d.get().setCommonInitOptions(p.get().OfficeBrowserFeedback.initOptions);var n=d.get().getCommonInitOptions();i(n.stylesUrl);var a=n.intlUrl+n.locale.toLowerCase()+"/"+n.intlFilename;o(a).then(function(){return l.getUIStrings()?(r(n),v=!0,void e()):void t("UiStrings were not loaded from "+a)}).catch(function(e){t("Script load failed for "+a)})}})}function u(){v=!1}n.__esModule=!0;var l=e("./UIStrings/UIStrings"),c=e("./Version"),d=e("./Configuration/Configuration"),p=e("./Window/Window"),f=e("./Logging/Logging"),h=e("./Theme"),g=e("es6-promise"),m="OfficeFeedbackSDK",v=!1;n.initialize=s,n.reset=u,p.setSetUiStrings(a)},{"./Configuration/Configuration":13,"./Logging/Logging":17,"./Theme":23,"./UIStrings/UIStrings":28,"./Version":48,"./Window/Window":50,"es6-promise":9}],12:[function(e,t,n){"use strict";function i(){return new p.Promise(function(e,t){f?e():s.initialize().then(function(){return d.get().OfficeBrowserFeedback.initOptions?(u.get().setInAppFeedbackInitOptions(d.get().OfficeBrowserFeedback.initOptions),f=!0,void e()):void t("Window.OfficeBrowserFeedback.initOptions not set")}).catch(function(e){t("Initialization failed: {"+e+"}")})})}function o(e){return new p.Promise(function(t,n){return h?void n("Control already open"):void i().then(function(){u.get().setInAppFeedbackLaunchOptions(e),c.createBellyBandMulti(function(){h=!1}),l.getLogger().logEvent(l.EventIds.InApp.UI.Picker.Shown.VALUE,{IsBugEnabled:u.get().getInAppFeedbackInitOptions().bugForm,IsIdeaEnabled:void 0!==u.get().getInAppFeedbackInitOptions().userVoice}),h=!0,t()}).catch(function(e){n("Initialization failed: {"+e+"}")})})}function r(e,t){return new p.Promise(function(n,o){if(h)return void o("Control already open");var r=u.validateFeedbackType(e);i().then(function(){u.get().setInAppFeedbackLaunchOptions(t),c.createBellyBandSingle(function(){h=!1},r),l.getLogger().logEvent(l.EventIds.InApp.UI.Form.Shown.VALUE,{FeedbackType:r}),h=!0,n()}).catch(function(e){o("Initialization failed: {"+e+"}")})})}function a(){s.reset(),f=!1,h=!1}n.__esModule=!0;var s=e("./App_Common"),u=e("./Configuration/Configuration"),l=e("./Logging/Logging"),c=e("./UI/UI"),d=e("./Window/Window"),p=e("es6-promise"),f=!1;n.initialize=i;var h=!1;n.multiFeedback=o,n.singleFeedback=r,n.reset=a,d.setMultiFeedback(o),d.setSingleFeedback(r)},{"./App_Common":11,"./Configuration/Configuration":13,"./Logging/Logging":17,"./UI/UI":45,"./Window/Window":50,"es6-promise":9}],13:[function(e,t,n){"use strict";function i(){return l}function o(e){if(r.expectString(e,"feedbackType"),e===a.FeedbackType[a.FeedbackType.Smile])return a.FeedbackType.Smile;if(e===a.FeedbackType[a.FeedbackType.Frown])return a.FeedbackType.Frown;if(e===a.FeedbackType[a.FeedbackType.Bug])return a.FeedbackType.Bug;throw"feedbackType should be one of Smile, Frown or Bug"}n.__esModule=!0;var r=e("./../Utils"),a=e("./../Constants"),s=e("./../Localization"),u=function(){function e(){}return e.validateCategoryOptions=function(e){if(!e)return{show:!1};if(r.expectBoolean(e.show,"categories.show"),e.customCategories){r.expectArray(e.customCategories,"categories.customCategories");for(var t=0,n=e.customCategories;t<n.length;t++){var i=n[t];if(r.expectString(i,"custom category '"+i+"'"),i.length>20)throw"custom category '"+i+"' too long, max 20 characters."}}return e},e.prototype.getCommonInitOptions=function(){return this.commonInitOptions},e.prototype.getInAppFeedbackInitOptions=function(){return this.inAppFeedbackInitOptions},e.prototype.getInAppFeedbackLaunchOptions=function(){return this.inAppFeedbackLaunchOptions},e.prototype.getFloodgateInitOptions=function(){return this.floodgateInitOptions},e.prototype.getFloodgateSurvey=function(){return this.floodgateSurvey},e.prototype.setCommonInitOptions=function(e){r.expectObject(e,"passedInitOptions");var t={appId:e.appId,applicationGroup:e.applicationGroup||{},build:e.build,cid:e.cid,environment:e.environment,intlFilename:e.intlFilename,intlUrl:e.intlUrl,locale:e.locale,onError:e.onError,originalLocale:e.locale,primaryColour:e.primaryColour,secondaryColour:e.secondaryColour,sessionId:e.sessionId,stylesUrl:e.stylesUrl,telemetryGroup:e.telemetryGroup||{},userEmail:e.userEmail,userEmailConsentDefault:e.userEmailConsentDefault,webGroup:e.webGroup||{}};if(r.expectNumber(t.appId,"initOptions.appId"),!(t.appId%1===0&&t.appId>0))throw"initOptions.appId is not a positive integer: "+t.appId;if(r.expectString(t.stylesUrl,"initOptions.stylesUrl"),r.expectString(t.intlUrl,"initOptions.intlUrl"),void 0!==t.intlFilename?r.expectString(t.intlFilename,"initOptions.intlFilename"):t.intlFilename="officebrowserfeedbackstrings.js",r.expectNumber(t.environment,"initOptions.environment"),1!==t.environment&&0!==t.environment)throw"initOptions.environment has a bad value: "+t.environment;if(void 0!==t.userEmail&&r.expectString(t.userEmail,"initOptions.userEmail"),void 0!==t.userEmailConsentDefault&&r.expectBoolean(t.userEmailConsentDefault,"initOptions.userEmailConsentDefault"),void 0!==t.sessionId?r.expectString(t.sessionId,"initOptions.sessionId"):t.sessionId="00000000-0000-0000-0000-000000000000",t.telemetryGroup.processSessionId=t.sessionId,void 0!==t.cid&&(r.expectString(t.cid,"initOptions.cid"),t.applicationGroup.extendedManifestData=JSON.stringify({cid:t.cid})),void 0!==t.build){r.expectString(t.build,"initOptions.build");var n="^[0-9]{1,9}(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?(\\.[0-9]{1,9})?$";new RegExp(n).test(t.build)||(t.build="0.0.0.0")}else t.build="0.0.0.0";t.telemetryGroup.officeBuild=t.build;var i=new RegExp("^#[0-9a-f]{3}([0-9a-f]{3})?$","i");void 0!==t.primaryColour&&(i.test(t.primaryColour)||(t.primaryColour=void 0)),void 0!==t.secondaryColour&&(i.test(t.secondaryColour)||(t.secondaryColour=void 0)),void 0!==t.locale?(r.expectString(t.locale,"initOptions.locale"),t.locale=s.validate(t.locale)):t.locale="en",void 0===t.onError&&(t.onError=function(e){}),this.commonInitOptions=t},e.prototype.setInAppFeedbackInitOptions=function(e){r.expectObject(e,"passedInitOptions");var t={bugForm:e.bugForm,onDismiss:e.onDismiss,screenshot:e.screenshot,userEmail:e.userEmail,userVoice:void 0!==e.userVoice?{url:e.userVoice.url}:void 0};void 0===t.onDismiss&&(t.onDismiss=function(e){}),void 0!==t.bugForm?r.expectBoolean(t.bugForm,"initOptions.bugForm"):t.bugForm=!1,void 0!==t.userEmail&&r.expectString(t.userEmail,"initOptions.userEmail"),void 0!==t.screenshot?r.expectBoolean(t.screenshot,"initOptions.screenshot"):t.screenshot=!0,void 0!==t.userVoice&&(r.expectObject(t.userVoice,"initOptions.userVoice"),r.expectString(t.userVoice.url,"initOptions.userVoice.url")),this.inAppFeedbackInitOptions=t},e.prototype.setInAppFeedbackLaunchOptions=function(t){if(!this.commonInitOptions)throw"commonInitOptions not set";t||(t={}),this.commonInitOptions.applicationGroup=r.overrideValues(t.applicationGroup,this.commonInitOptions.applicationGroup),this.commonInitOptions.telemetryGroup=r.overrideValues(t.telemetryGroup,this.commonInitOptions.telemetryGroup),this.commonInitOptions.webGroup=r.overrideValues(t.webGroup,this.commonInitOptions.webGroup),t.categories=e.validateCategoryOptions(t.categories),this.inAppFeedbackLaunchOptions=t},e.prototype.setFloodgateInitOptions=function(e){r.expectObject(e,"passedInitOptions");var t={autoDismiss:e.autoDismiss,campaignDefinitions:e.campaignDefinitions,onDismiss:e.onDismiss,onSurveyActivatedCallback:e.onSurveyActivatedCallback,settingStorageCallback:e.settingStorageCallback,uIStringGetter:e.uIStringGetter};if(void 0===t.autoDismiss&&(t.autoDismiss=a.AutoDismissValues.NoAutoDismiss),void 0===t.onDismiss&&(t.onDismiss=function(e,t){}),void 0===t.onSurveyActivatedCallback){var n={onSurveyActivated:function(e){e.launch()}};t.onSurveyActivatedCallback=n}void 0===t.uIStringGetter&&(t.uIStringGetter=function(e){return e}),this.floodgateInitOptions=t},e.prototype.setFloodgateSurvey=function(e){this.floodgateSurvey=e},e}();n.Configuration=u;var l=new u;n.get=i,n.validateFeedbackType=o},{"./../Constants":14,"./../Localization":15,"./../Utils":47}],14:[function(e,t,n){"use strict";n.__esModule=!0;var i=function(){function e(){}return e.AriaLabel="aria-label",e.Class="class",e.DataHtml2CanvasIgnore="data-html2canvas-ignore",e.Disabled="disabled",e.Fill="fill",e.For="for",e.Form="form",e.Height="height",e.HRef="href",e.Id="id",e.MaxLength="maxlength",e.Name="name",e.Placeholder="placeholder",e.Points="points",e.Rel="rel",e.Role="role",e.Source="src",e.Stroke="stroke",e.TabIndex="tabindex",e.Target="target",e.Transform="transform",e.Type="type",e.Value="value",e.ViewBox="viewBox",e.Width="width",e.xlinkHref="xlink:href",e.X="x",e.Y="y",e}();n.AttributeName=i;var o=function(){function e(){}return e.BlankWindow="_blank",e.Button="button",e.Checkbox="checkbox",e.Checked="checked",e.False="false",e.Zero="0",e.Polite="polite",e.Radio="radio",e.Submit="submit",e.Text="text",e.TextAreaMaxLength="1000",e.True="true",e.Unchecked="unchecked",e.NoReferrer="noreferrer",e}();n.AttributeValue=o;var r=function(){function e(){}return e.CLCID="CLCID",e}();n.UrlParameters=r;var a=function(){function e(){}return e.CheckBox="obf-CheckBox",e.FontSubtitle="obf-FontSubtitle",e.FontText="obf-FontText",e.FontSubText="obf-FontSubText",e.FontSubSubText="obf-FontSubSubText",e.Hidden="obf-Hidden",e.Link="obf-Link",e.MarginLeft60px="obf-MarginLeft60px",e.NarrowLayout="obf-NarrowLayout",e.PrivacyStatementLinkDiv="obf-PrivacyStatementLinkDiv",e.Rtl="obf-Rtl",e.Spinner="obf-Spinner",e.SpinnerCircle="obf-SpinnerCircle",e.SubmitButton="obf-SubmitButton",e.TextInput="obf-TextInput",e.Visible="obf-Visible",e.Rating="obf-Rating",e.RatingGraphic="obf-RatingGraphic",e.RatingGraphicFilled="obf-RatingGraphic-Filled",e.ChoiceGroup="obf-ChoiceGroup",e.ChoiceGroupIcon="obf-ChoiceGroupIcon",e.OverallAnchor="obf-OverallAnchor",e.OverallAnchorActive="obf-OverallAnchorActive",e.OverallImage="obf-OverallImage",e.OverallText="obf-OverallText",e.SingleLayout="obf-SingleLayout",e.ShowRightBorder="obf-ShowRightBorder",e.SlideLeft="obf-slideLeft",e.TextAlignLeft="obf-TextAlignLeft",e.FormContainer="obf-FormContainer",e.FormQuestionMiddleText="obf-FormQuestionMiddleText",e.FormMiddleText="obf-FormMiddleText",e.FormCategoriesDropdown="obf-FormCategoriesDropdown",e.FormComment="obf-FormComment",e.FormRatingContainer="obf-FormRatingContainer",e.FormRatingLabel="obf-FormRatingLabel",e.FormRating="obf-FormRating",e.FormEmailInput="obf-FormEmailInput",e.FormBottomContainer="obf-FormBottomContainer",e.FormSubmitButtonContainer="obf-FormSubmitButtonContainer",e.FormScreenshotContainer="obf-FormScreenshotContainer",e.FormScreenshotLabel="obf-FormScreenshotLabel",e.FormScreenshotCheckbox="obf-FormScreenshotCheckbox",e.TFormEmailCheckbox="obf-TFormEmailCheckbox",e.TFormEmailLabel="obf-TFormEmailLabel ",e.EmailCheckBoxLabel="obf-EmailCheckBoxLabel",e.Toast="obf-Toast",e}();n.Classes=a;var s=function(){function e(){}return e.ColumnSeparatorDiv="obf-ColumnSeparatorDiv",e.OverallAnchorsContainer="obf-OverallAnchorsContainer",e.OverallFrownAnchor="obf-OverallFrownAnchor",e.OverallFrownDiv="obf-OverallFrownDiv",e.OverallFrownImage="obf-OverallFrownImage",e.OverallFrownText="obf-OverallFrownText",e.OverallSmileAnchor="obf-OverallSmileAnchor",e.OverallSmileDiv="obf-OverallSmileDiv",e.OverallSmileImage="obf-OverallSmileImage",e.OverallSmileText="obf-OverallSmileText",e.OverallIdeaAnchor="obf-OverallIdeaAnchor",e.OverallIdeaDiv="obf-OverallIdeaDiv",e.OverallIdeaImage="obf-OverallIdeaImage",e.OverallIdeaText="obf-OverallIdeaText",e.OverallBugAnchor="obf-OverallBugAnchor",e.OverallBugDiv="obf-OverallBugDiv",e.OverallBugImage="obf-OverallBugImage",e.OverallBugText="obf-OverallBugText",e.QuestionLeftText="obf-QuestionLeftText",e.LeftFormContainer="obf-LeftFormContainer",e.MainContainer="obf-MainContainer",e.MainContentHolder="obf-MainContentHolder",e.MiddleFormContainer="obf-MiddleFormContainer",e.OverlayBackground="obf-OverlayBackground",e.PrivacyStatementLink="obf-PrivacyStatementLink",e.FirstTabbable="obf-FirstTabbable",e.LastTabbable="obf-LastTabbable",e.SingleFormContainer="obf-SingleFormContainer",e.SingleFormQuestionMiddleText="obf-SingleFormQuestionMiddleText",e.SingleFormCategoriesDropdown="obf-SingleFormCategoriesDropdown",e.SingleFormComment="obf-SingleFormComment",e.SingleFormEmailInput="obf-SingleFormEmailInput",e.SingleFormRating="obf-SingleFormRating",e.SingleFormScreenshotCheckbox="obf-SingleFormScreenshotCheckbox",e.SingleFormSubmitButton="obf-SingleFormSubmitButton",e.SingleFormSubmitButtonSpinner="obf-SingleFormSubmitButtonSpinner",e.BasicFormContainer="obf-BasicFormContainer",e.BasicFormQuestionMiddleText="obf-BasicFormQuestionMiddleText",e.BasicFormCategoriesDropdown="obf-BasicFormCategoriesDropdown",e.BasicFormComment="obf-BasicFormComment",e.BasicFormEmailInput="obf-BasicFormEmailInput",e.BasicFormRating="obf-BasicFormRating",e.BasicFormScreenshotCheckbox="obf-BasicFormScreenshotCheckbox",e.BasicFormSubmitButton="obf-BasicFormSubmitButton",e.BasicFormSubmitButtonSpinner="obf-BasicFormSubmitButtonSpinner",e.UserVoiceFormContainer="obf-UserVoiceFormContainer",e.UserVoiceFormGoButton="obf-UserVoiceFormGoButton",e.ToastContainer="obf-ToastContainer",e.ToastCancel="obf-ToastCancel",e.TPromptContainer="obf-TPromptContainer",e.TPromptTitle="obf-TPromptTitle",e.TPromptText="obf-TPromptText",e.TFormContainer="obf-TFormContainer",e.TFormTitle="obf-TFormTitle",e.TFormRating="obf-TFormRating",e.TFormComment="obf-TFormComment",e.TFormEmailTextBox="obf-TFormEmailTextBox",e.TFormEmailCheckBox="obf-TFormEmailCheckBox",e.TFormEmailLabel="obf-TFormEmailLabel",e.TFormSubmitButton="obf-TFormSubmitButton",e.TFormSubmitButtonSpinner="obf-TFormSubmitButtonSpinner",e.TFormSubmitButtonContainer="obf-TFormSubmitButtonContainer",e}();n.IDs=s;var u=function(){function e(){}return e.Esc=27,e.Tab=9,e}();n.Keys=u;var l;!function(e){e[e.Smile=0]="Smile",e[e.Frown=1]="Frown",e[e.Idea=2]="Idea",e[e.Bug=3]="Bug"}(l=n.FeedbackType||(n.FeedbackType={}));var c;!function(e){e[e.Production=0]="Production",e[e.Int=1]="Int"}(c=n.Environment||(n.Environment={}));var d;!function(e){e[e.NoAutoDismiss=0]="NoAutoDismiss",e[e.SevenSeconds=1]="SevenSeconds",e[e.FourteenSeconds=2]="FourteenSeconds",e[e.TwentyOneSeconds=3]="TwentyOneSeconds",e[e.TwentyEightSeconds=4]="TwentyEightSeconds"}(d=n.AutoDismissValues||(n.AutoDismissValues={}));var p=function(){function e(){}return e.Anchor="A",e.Button="button",e.Defs="defs",e.Div="div",e.FieldSet="fieldset",e.Form="form",e.Img="img",e.Input="input",e.Label="label",e.Legend="legend",e.Option="option",e.Polygon="polygon",e.Select="select",e.Span="span",e.Svg="svg",e.TextArea="textarea",e.Use="use",e}();n.Tags=p;var f=function(){function e(){}return e.PrivacyStatementLink="http://go.microsoft.com/fwlink/?LinkID=390004",e}();n.Urls=f},{}],15:[function(e,t,n){"use strict";function i(e){var t=e.toLocaleUpperCase();if(t in r)return r[t];for(var n=0,i=o;n<i.length;n++){var a=i[n];if(a.toUpperCase()===t)return a}for(var s=t.split("-")[0],u=0,l=o;u<l.length;u++){var a=l[u];if(a.toUpperCase()===s)return a}return"en"}n.__esModule=!0;var o=["af","am","ar","as","az","be","bg","bn-BD","bn-IN","bs","ca","ca-Es-VALENCIA","chr-Cher","cs","cy","da","de","el","en-GB","es","es-MX","et","eu","fa","fi","fil","fr","fr-CA","ga","gd","gl","gu","ha-Latn-NG","he","hi","hr","hu","hy","id","is","it","ja","ka","kk","km-KH","kn","ko","kok","ky","lb","lo","lt","lv","mi","mk","ml","mn","mr","ms","mt","nb-NO","ne","nl","nn-NO","or","pa","pl","prs","pt-BR","pt-PT","quz","ro","ru","sd","si","sk","sl","sq","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv","sw","ta","te","th","tk","tr","tt","ug","uk","ur","uz-Latn-UZ","vi","zh-Hans","zh-Hant"],r={"ZH-CN":"zh-Hans","ZH-HK":"zh-Hant","ZH-MO":"zh-Hant","ZH-SG":"zh-Hans","ZH-TW":"zh-Hant"};n.validate=i},{}],16:[function(e,t,n){"use strict";n.__esModule=!0;var i=function(){function e(){}var t,n,i,o,r,a,s,u,l,c,d,p,f,h,g,m,v,b,y,T,I,w,S,C,F,x,A,E,B,_,k,O,D,N;return e.InApp=(t=function(){function e(){}return e}(),t.UI=(n=function(){function e(){}return e}(),n.Picker=(i=function(){function e(){}return e}(),i.Shown=(o=function(){function e(){}return e}(),o.VALUE={name:"InApp_UI_Picker_Shown"},o),i),n.Form=(r=function(){function e(){}return e}(),r.Shown=(a=function(){function e(){}return e}(),a.VALUE={name:"InApp_UI_Form_Shown"},a),r.Submit=(s=function(){function e(){}return e}(),s.VALUE={name:"InApp_UI_Form_Submit"},s),r),n),t),e.Survey=(u=function(){function e(){}return e}(),u.UI=(l=function(){function e(){}return e}(),l.Prompt=(c=function(){function e(){}return e}(),c.Shown=(d=function(){function e(){}return e}(),d.VALUE={name:"Survey_UI_Prompt_Shown"},d),c),l.Form=(p=function(){function e(){}return e}(),p.Shown=(f=function(){function e(){}return e}(),f.VALUE={name:"Survey_UI_Form_Shown"},f),p.Submit=(h=function(){function e(){}return e}(),h.VALUE={name:"Survey_UI_Form_Submit"},h),p),l),u.Floodgate=(g=function(){function e(){}return e}(),g.TriggerMet=(m=function(){function e(){}return e}(),m.VALUE={name:"Survey_Floodgate_TriggerMet"},m),
g.UserSelected=(v=function(){function e(){}return e}(),v.VALUE={name:"Survey_Floodgate_UserSelected"},v),g.CampaignLoad=(b=function(){function e(){}return e}(),b.Failed=(y=function(){function e(){}return e}(),y.VALUE={name:"Survey_Floodgate_CampaignLoad_Failed"},y),b),g.FileWrite=(T=function(){function e(){}return e}(),T.Failed=(I=function(){function e(){}return e}(),I.VALUE={name:"Survey_Floodgate_FileWrite_Failed"},I),T),g.FileRead=(w=function(){function e(){}return e}(),w.Failed=(S=function(){function e(){}return e}(),S.VALUE={name:"Survey_Floodgate_FileRead_Failed"},S),w),g),u),e.Shared=(C=function(){function e(){}return e}(),C.Upload=(F=function(){function e(){}return e}(),F.Failed=(x=function(){function e(){}return e}(),x.VALUE={name:"Shared_Upload_Failed"},x),F),C.Screenshot=(A=function(){function e(){}return e}(),A.Render=(E=function(){function e(){}return e}(),E.Failed=(B=function(){function e(){}return e}(),B.VALUE={name:"Shared_Screenshot_Render_Failed"},B),E.Success=(_=function(){function e(){}return e}(),_.VALUE={name:"Shared_Screenshot_Render_Success"},_),E),A.GetContent=(k=function(){function e(){}return e}(),k.Failed=(O=function(){function e(){}return e}(),O.DefaultImage=(D=function(){function e(){}return e}(),D.Returned=(N=function(){function e(){}return e}(),N.VALUE={name:"Shared_Screenshot_GetContent_Failed_DefaultImage_Returned"},N),D),O),k),A),C),e}();n.EventIds=i},{}],17:[function(e,t,n){"use strict";function i(e,t,n,i,o,r,l){c=new p(u.default.create(f.getTenantToken(e),d,new a.App(t,n),new a.Session(s.guid()),new a.Host(o,r,l),new a.Release(i)))}function o(){return c}n.__esModule=!0;var r=e("./../Constants"),a=e("./Telemetry/Contracts"),s=e("./../Utils"),u=e("./Telemetry/TelemetryLoggerFactory"),l=e("./Constants");n.EventIds=l.EventIds;var c,d="Office_Feedback";n.initialize=i,n.getLogger=o;var p=function(){function e(e){if(!e)throw new Error("telemetryLogger must not be null");this.telemetryLogger=e}return e.prototype.logEvent=function(t,n){if(!t)throw new Error("eventId must not be null");n=n||{},n[e.EVENT_ID]=t.name,this.telemetryLogger.logEvent(e.EVENT_NAME,n)},e.EVENT_NAME="SDK",e.EVENT_ID="EventId",e}();n.Logger=p;var f=function(){function e(){}return e.getTenantToken=function(t){return t===r.Environment.Production?e.TENANT_TOKEN_PRODUCTION:e.TENANT_TOKEN_PRE_PRODUCTION},e.TENANT_TOKEN_PRODUCTION="d79e824386c4441cb8c1d4ae15690526-bd443309-5494-444a-aba9-0af9eef99f84-7360",e.TENANT_TOKEN_PRE_PRODUCTION="2bf6a2ffddca4a80a892a0b182132961-625cb102-8b0c-480e-af53-92e48695d08d-7736",e}()},{"./../Constants":14,"./../Utils":47,"./Constants":16,"./Telemetry/Contracts":20,"./Telemetry/TelemetryLoggerFactory":21}],18:[function(e,t,n){"use strict";function i(){return o.AWT}n.__esModule=!0;var o=e("./../../thirdparty/aria-webjs-compact-sdk-1.2.2");n.AWT=i},{"./../../thirdparty/aria-webjs-compact-sdk-1.2.2":51}],19:[function(e,t,n){"use strict";n.__esModule=!0;var i=e("./Aria"),o=e("./Contracts"),r=function(){function e(e,t,n,o,r,a){if(!e)throw new Error("tenantToken must not be null");if(!t)throw new Error("namespace must not be null");if(!n)throw new Error("app must not be null");if(!o)throw new Error("session must not be null");i.AWT().initialize(e),this.namespace=t,this.oesApp=n,this.oesSession=o,this.oesHost=r,this.oesRelease=a,this.sequence=1}return e.setApp=function(e,t){e["App.Name"]=t.getName(),e["App.Platform"]=t.getPlatform(),e["App.Version"]=t.getVersion()},e.setSession=function(e,t){e["Session.Id"]=t.getId()},e.setHost=function(e,t){t&&(e["Host.Id"]=t.getId(),e["Host.Version"]=t.getVersion())},e.setEvent=function(e,t){e["Event.Name"]=t.getName(),e["Event.Id"]=t.getId(),e["Event.Source"]=t.getSource(),e["Event.SchemaVersion"]=t.getSchemaVersion(),e["Event.Sequence"]=t.getSequence()},e.setRelease=function(e,t){t&&(e["Release.AudienceGroup"]=t.getAudienceGroup())},e.prototype.logEvent=function(t,n){if(!t)throw new Error("eventName must not be null");var r=new o.Event(this.namespace+e.EVENT_NAME_DELIMITER+t,this.oesSession.getId(),this.sequence),a={};if(null!=n)for(var s in n)n.hasOwnProperty(s)&&(a[e.CUSTOM_PROPERTIES_FIELD_PREFIX+s]=n[s]);e.setApp(a,this.oesApp),e.setSession(a,this.oesSession),e.setHost(a,this.oesHost),e.setRelease(a,this.oesRelease),e.setEvent(a,r),i.AWT().logEvent({name:r.getName(),properties:a}),this.sequence++},e.EVENT_NAME_DELIMITER="_",e.CUSTOM_PROPERTIES_FIELD_PREFIX="Data.",e}();n.default=r},{"./Aria":18,"./Contracts":20}],20:[function(e,t,n){"use strict";n.__esModule=!0;var i=function(){function e(e,t){if(!e)throw new Error("name must not be null");if(!t)throw new Error("version must not be null");this.name=e,this.version=t}return e.prototype.getName=function(){return this.name},e.prototype.getPlatform=function(){return e.PLATFORM},e.prototype.getVersion=function(){return this.version},e.PLATFORM="Web",e}();n.App=i;var o=function(){function e(e){if(!e)throw new Error("id must not be null");this.id=e}return e.prototype.getId=function(){return this.id},e}();n.Session=o;var r=function(){function e(e,t,n){this.id=e,this.sessionId=t,this.version=n}return e.prototype.getId=function(){return this.id},e.prototype.getSessionId=function(){return this.sessionId},e.prototype.getVersion=function(){return this.version},e}();n.Host=r;var a=function(){function e(t,n,i){if(!t)throw new Error("name must not be null");if(!n)throw new Error("sessionId must not be null");if(!i&&0!==i||i<0)throw new Error("sequence must not be negative");this.name=t,this.id=n+e.ID_DELIMITER+i,this.sequence=i}return e.prototype.getName=function(){return this.name},e.prototype.getId=function(){return this.id},e.prototype.getSource=function(){return e.SOURCE},e.prototype.getSchemaVersion=function(){return e.SCHEMA_VERSION},e.prototype.getSequence=function(){return this.sequence},e.ID_DELIMITER=".",e.SOURCE="MsoThin",e.SCHEMA_VERSION=1,e}();n.Event=a;var s=function(){function e(e){this.audienceGroup=e}return e.prototype.getAudienceGroup=function(){return this.audienceGroup},e}();n.Release=s},{}],21:[function(e,t,n){"use strict";n.__esModule=!0;var i=e("./AriaTelemetryLogger"),o=function(){function e(){}return e.create=function(e,t,n,o,r,a){return new i.default(e,t,n,o,r,a)},e}();n.default=o},{"./AriaTelemetryLogger":19}],22:[function(e,t,n){"use strict";function i(){var e=o.get().OfficeBrowserFeedback.html2canvas();return e(document.body,{background:"#ffffff"})}n.__esModule=!0;var o=e("./Window/Window");n.createScreenShot=i},{"./Window/Window":50}],23:[function(e,t,n){"use strict";function i(e,t){void 0===e&&(e=void 0),void 0===t&&(t=void 0),e||(e=r),t||(t=a);var n=document.createElement("style");n.textContent="."+o.Classes.OverallAnchor+":hover { background-color: "+t+" } "+("."+o.Classes.OverallAnchorActive+" { background-color: "+e+" } ")+("."+o.Classes.SpinnerCircle+" { background-color: "+e+" } ")+("."+o.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+o.Classes.ChoiceGroupIcon+" { border-color: "+e+" } ")+("."+o.Classes.ChoiceGroup+" input[type=radio]:hover+label>."+o.Classes.ChoiceGroupIcon+" { border-color: "+t+" } ")+("."+o.Classes.ChoiceGroup+" input[type=radio]:checked+label>."+o.Classes.ChoiceGroupIcon+">span { background-color: "+e+" } ")+("."+o.Classes.SubmitButton+" { background-color: "+e+" } ")+("."+o.Classes.SubmitButton+":hover { background-color: "+t+" } ")+("."+o.Classes.Link+" { color: "+e+" } ")+("."+o.Classes.Link+":hover { color: "+t+" } ")+("#"+o.IDs.TPromptTitle+" { color: "+e+" } ")+("#"+o.IDs.TFormTitle+" { color: "+e+" } "),document.body.appendChild(n)}n.__esModule=!0;var o=e("./Constants"),r="#0167B0",a="#194789";n.initialize=i},{"./Constants":14}],24:[function(e,t,n){"use strict";function i(e){return"Survey"===e?e:o.FeedbackType[e]}n.__esModule=!0;var o=e("./../../Constants"),r=e("./../../Utils"),a=function(){function e(e,t,n,o,r,a,s,u){this.manifestData={appId:t,application:a,clientFeedbackId:r,manifestType:e,source:"Client",submitTime:n,telemetry:s,type:i(o),web:u}}return e.prototype.setComment=function(e){this.manifestData.comment=e},e.prototype.setEmail=function(e){this.manifestData.email=e},e.prototype.setCategory=function(e){this.manifestData.telemetry=this.manifestData.telemetry||{},this.manifestData.telemetry.featureArea=e},e.prototype.setValues=function(e){if(e)for(var t in e)e.hasOwnProperty(t)&&(this.manifestData.hasOwnProperty(t)?this.manifestData[t]=r.overrideValues(e[t],this.manifestData[t]):this.manifestData[t]=e[t])},e.prototype.getContent=function(){return new Blob([JSON.stringify(this.manifestData)],{type:"application/json"})},e}();n.Manifest=a},{"./../../Constants":14,"./../../Utils":47}],25:[function(e,t,n){"use strict";n.__esModule=!0;var i=e("./../../Logging/Logging"),o=function(){function e(e){this.screenshot=e}return e.prototype.getContent=function(){var e;try{e=this.screenshot.toDataURL("image/jpeg").split(",")[1]}catch(t){i.getLogger().logEvent(i.EventIds.Shared.Screenshot.GetContent.Failed.DefaultImage.Returned.VALUE,{ErrorMessage:t.toString()}),e="iVBORw0KGgoAAAANSUhEUgAAAN0AAAA+AQMAAACV2ox1AAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAA////pdmf3QAAAAlwSFlzAAAOwgAADsIBFShKgAAAAjtJREFUSMfV1M1rE0EUAHDBa5r8A9vkL6giFiI0JH+Ih9KLx8TaukkJugShHgrJzYvkVPQkUqgwSePLEELaU+zBg8JKVvSQQNydlsadwCQzziRZ82ETxYMfc3gD8+MxjzcfV8T80f0vkQ8i68tAPSMSQ0PkI6QDpEPkZBHy1Wp1/zjni2lrZq2T2uikDG17A54Hr0vsvwXIl3WXt02zeIHQBSq3DxHk7VO55zIFgLLrcmaaQBGiqCwQArBVQTbNZODNBB5Ee2EEr5eGiDG4k5mcqcy+Ksh+N8K2+bRI1Z68fRMVoV+XmcFwpQJZGohpkds1WtjppGLaq51a2b8yp310UW9/H8VfRj68CIKRsWCFPCCEM419S4bSAOmPmdb3TBrQ4lmnt9n4/Hiv5fTunsOzXbJfLR2rU3Fd5ugOe9mw0lvNOCNxyDdIHkpHCv0S3a+MS0yT+4wkAKx1gBJeVxeMRhSeNZpXJfY+zqAVl+g0mCFRJMgs6oy9+MCMrWZaJJwiWFjuWcIShf+Wk2W9e59OHu21WPdsswZNLKs9wV77mJiaMVbBQ+/1jGZDofFLuOBU/jzG6OQKnkLOZ5EvwolMX2Q19TAX9MWyy/aNarewfZptechdLn8B3TatB/YXB2j4MKw3jTHKX4AO0CbqaSddMokHUbr0PpSXmFG4O4WIu86asCVihfoM6nUmse5gGkbJOyThVesX4UI0d00LBYMr55VuIZl8MkY1uOiTy9v3c+ShuXj5+NdQdL8B+5gmw8WZuREAAAAASUVORK5CYII="}for(var t=atob(e),n=[],o=0;o<t.length;o++)n.push(t.charCodeAt(o));var r=new Blob([new Uint8Array(n)],{type:"image/jpeg"});return r},e}();n.Screenshot=o},{"./../../Logging/Logging":17}],26:[function(e,t,n){"use strict";function i(e,t,n,i,o){var s=function(i){return new r.Promise(function(r,u){var l=new XMLHttpRequest;l.open(e,t,!0),l.timeout=a,l.onload=function(){o(l,r,u)},l.ontimeout=function(){i>0?s(i-1).then(r,u):u(new Error("Request to '"+t+"' timed out. timeout: "+a))},l.onerror=function(){i>0?s(i-1).then(r,u):u(new Error("Request to '"+t+"' errored. "+l.status+": "+l.responseText))},l.send(n)})};return s(i)}function o(e,t,n,o){if(void 0===t)return r.Promise.reject(new Error("Manifest cannot be undefined"));var a=new FormData;return a.append("Manifest",t),n&&a.append("Screenshot",n),o&&a.append("Diagnostics",o),i("POST",e?u:s,a,2,function(e,t,n){200!==e.status&&n(new Error("Non-200 response with status code: "+e.status+", response: "+e.responseText)),t()})}n.__esModule=!0;var r=e("es6-promise"),a=4e3,s="https://petrol-int.office.microsoft.com/v1/feedback",u="https://petrol.office.microsoft.com/v1/feedback";n.send=o},{"es6-promise":9}],27:[function(e,t,n){"use strict";n.__esModule=!0;var i=e("./../Constants"),o=e("./../Utils"),r=e("./../Logging/Logging"),a=e("./Petrol"),s=e("./Files/Screenshot"),u=e("../Configuration/Configuration"),l=e("./Files/Manifest"),c=function(){function e(e,t,n,i,r,a,s){this.manifest=new l.Manifest(t,n,(new Date).toISOString(),i,o.guid(),r,a,s),this.environment=e}return e.prototype.setComment=function(e){this.manifest.setComment(e)},e.prototype.setEmail=function(e){this.manifest.setEmail(e)},e.prototype.setCategory=function(e){this.manifest.setCategory(e)},e.prototype.setScreenshot=function(e){this.screenshot=new s.Screenshot(e)},e.prototype.setManifestValues=function(e){this.manifest.setValues(e)},e.prototype.submit=function(){var e=this.manifest.getContent(),t=void 0;return this.screenshot&&(t=this.screenshot.getContent()),a.send(this.environment===i.Environment.Production,e,t).catch(function(e){u.get().getCommonInitOptions().onError("Payload submission failed: "+e.message),r.getLogger().logEvent(r.EventIds.Shared.Upload.Failed.VALUE,{ErrorMessage:e.message})})},e}();n.Transporter=c},{"../Configuration/Configuration":13,"./../Constants":14,"./../Logging/Logging":17,"./../Utils":47,"./Files/Manifest":24,"./Files/Screenshot":25,"./Petrol":26}],28:[function(e,t,n){"use strict";function i(e){r=e}function o(){return r}n.__esModule=!0;var r;n.setUIStrings=i,n.getUIStrings=o},{}],29:[function(e,t,n){"use strict";function i(e){var t={};t[u.FeedbackType.Smile]=h,t[u.FeedbackType.Frown]=h,m.get().getInAppFeedbackInitOptions().userVoice&&"en"===m.get().getCommonInitOptions().locale?t[u.FeedbackType.Idea]=g:t[u.FeedbackType.Idea]=h,m.get().getInAppFeedbackInitOptions().bugForm&&(t[u.FeedbackType.Bug]=h),r(d.elementFromJson(c.generateMulti(t)));var n=f.isNarrow();l.registerMulti(t,n,function(t){p.setElementVisibility(u.IDs.OverlayBackground,!1),p.deleteElementById(u.IDs.OverlayBackground),m.get().getInAppFeedbackInitOptions().onDismiss(t),e()}),n&&p.addClassById(u.IDs.OverlayBackground,u.Classes.NarrowLayout)}function o(e,t){r(d.elementFromJson(c.generateSingle())),l.registerSingle(t,function(t){p.setElementVisibility(u.IDs.OverlayBackground,!1),p.deleteElementById(u.IDs.OverlayBackground),m.get().getInAppFeedbackInitOptions().onDismiss(t),e()}),p.addClassById(u.IDs.OverlayBackground,u.Classes.SingleLayout)}function r(e){document.body.insertBefore(e,document.body.firstChild),p.setElementVisibility(u.IDs.OverlayBackground,!0),p.getInternetExplorerVersion()>9||p.getInternetExplorerVersion()===-1?setTimeout(a,900):a()}function a(){p.setElementVisibility(u.IDs.MainContentHolder,!0),document.getElementById(u.IDs.OverallSmileAnchor)?document.getElementById(u.IDs.OverallSmileAnchor).focus():document.getElementById(u.IDs.SingleFormComment)&&document.getElementById(u.IDs.SingleFormComment).focus()}function s(){}n.__esModule=!0;var u=e("./../../Constants"),l=e("./Events"),c=e("./Layout"),d=e("./../Renderer"),p=e("./../Utils"),f=e("./../../WindowProperties"),h=e("./FormTemplates/BasicFormTemplate"),g=e("./FormTemplates/UserVoiceFormTemplate"),m=e("./../../Configuration/Configuration");n.createMulti=i,n.createSingle=o,n.dismiss=s},{"./../../Configuration/Configuration":13,"./../../Constants":14,"./../../WindowProperties":49,"./../Renderer":40,"./../Utils":46,"./Events":30,"./FormTemplates/BasicFormTemplate":31,"./FormTemplates/UserVoiceFormTemplate":34,"./Layout":35}],30:[function(e,t,n){"use strict";function i(e){l(),S(e)}function o(e,t,n){k.registerListener(e,t,n),L.push({event:t,id:e,listener:n})}function r(){for(var e=0,t=L;e<t.length;e++){var n=t[e];k.unregisterListener(n.id,n.event,n.listener)}L=[]}function a(e,t){void 0===t&&(t=function(e){}),N=e,o(A.IDs.SingleFormSubmitButton,"click",I(A.IDs.SingleFormSubmitButton,A.IDs.SingleFormSubmitButtonSpinner,A.IDs.SingleFormComment,A.IDs.SingleFormEmailInput,A.IDs.SingleFormScreenshotCheckbox,A.IDs.SingleFormCategoriesDropdown)),u(t)}function s(e,t,n){void 0===n&&(n=function(e){}),D=t,C=e,o(A.IDs.OverallSmileAnchor,"click",m),o(A.IDs.OverallFrownAnchor,"click",v),o(A.IDs.OverallIdeaAnchor,"click",b),o(A.IDs.OverallBugAnchor,"click",y),o(A.IDs.BasicFormSubmitButton,"click",I(A.IDs.BasicFormSubmitButton,A.IDs.BasicFormSubmitButtonSpinner,A.IDs.BasicFormComment,A.IDs.BasicFormEmailInput,A.IDs.BasicFormScreenshotCheckbox,A.IDs.BasicFormCategoriesDropdown)),o(A.IDs.UserVoiceFormGoButton,"click",w),u(n)}function u(e){S=e,k.addEventListenerHelper(window,"keyup",d),o(A.IDs.OverlayBackground,"click",p),o(A.IDs.MainContainer,"click",f),o(A.IDs.MainContainer,"keyup",c),o(A.IDs.PrivacyStatementLink,"click",h)}function l(){k.removeEventListenerHelper(window,"keyup",d),r()}function c(e){var t=e.keyCode||e.which;t===A.Keys.Tab&&(document.activeElement.id===A.IDs.FirstTabbable&&e.shiftKey||document.activeElement.id===A.IDs.LastTabbable&&!e.shiftKey)&&(e.stopPropagation(),O.cycleTabFocus(document.activeElement))}function d(e){e.keyCode===A.Keys.Esc&&(e.preventDefault(),e.stopPropagation(),i(!1))}function p(e){e.preventDefault(),e.stopPropagation(),i(!1)}function f(e){e.stopPropagation()}function h(e){e.stopPropagation()}function g(e,t){e.preventDefault(),e.stopPropagation(),k.replaceClassesById(A.IDs.OverallSmileAnchor,A.Classes.OverallAnchorActive),k.replaceClassesById(A.IDs.OverallFrownAnchor,A.Classes.OverallAnchorActive),k.replaceClassesById(A.IDs.OverallIdeaAnchor,A.Classes.OverallAnchorActive),k.replaceClassesById(A.IDs.OverallBugAnchor,A.Classes.OverallAnchorActive),k.addClassById(t,A.Classes.OverallAnchorActive),E.getLogger().logEvent(E.EventIds.InApp.UI.Form.Shown.VALUE,{FeedbackType:N});var n=C[N];T(n.containerId),n.onSelect(N)}function m(e){N=A.FeedbackType.Smile,g(e,A.IDs.OverallSmileAnchor)}function v(e){N=A.FeedbackType.Frown,g(e,A.IDs.OverallFrownAnchor)}function b(e){N=A.FeedbackType.Idea,g(e,A.IDs.OverallIdeaAnchor)}function y(e){N=A.FeedbackType.Bug,g(e,A.IDs.OverallBugAnchor)}function T(e){for(var t in C)C.hasOwnProperty(t)&&k.setElementVisibility(C[t].containerId,!1);D?(k.setElementVisibility(A.IDs.LeftFormContainer,!1),k.setElementVisibility(A.IDs.MiddleFormContainer,!0),k.setElementVisibility(e,!0)):(k.addClassById(A.IDs.ColumnSeparatorDiv,A.Classes.ShowRightBorder),k.setElementVisibility(A.IDs.MiddleFormContainer,!0),k.setElementVisibility(e,!0),k.addClassById(A.IDs.LeftFormContainer,A.Classes.SlideLeft),k.addClassById(A.IDs.MiddleFormContainer,A.Classes.SlideLeft))}function I(e,t,n,o,r,a){return function(s){s.preventDefault(),s.stopPropagation(),k.setElementVisibility(e,!1);var u=new _.Spinner(t),l=new F.Transporter(x.get().getCommonInitOptions().environment,"Sas",x.get().getCommonInitOptions().appId,N,x.get().getCommonInitOptions().applicationGroup,x.get().getCommonInitOptions().telemetryGroup,x.get().getCommonInitOptions().webGroup),c=document.getElementById(n),d=c&&!!c.value;d&&l.setComment(c.value);var p=document.getElementById(o),f=p&&!!p.value;f&&l.setEmail(p.value);var h=document.getElementById(r),g=h&&h.checked,m=document.getElementById(a),v=m&&m.selectedIndex>0;if(v&&l.setCategory(m.value),E.getLogger().logEvent(E.EventIds.InApp.UI.Form.Submit.VALUE,{FeedbackType:N,IsEmailIncluded:f,IsScreenshotIncluded:g}),g){var b=performance.now();B.createScreenShot().then(function(e){var t=performance.now();E.getLogger().logEvent(E.EventIds.Shared.Screenshot.Render.Success.VALUE,{TimeMilliseconds:t-b}),l.setScreenshot(e),l.submit()}).catch(function(e){var t=performance.now();E.getLogger().logEvent(E.EventIds.Shared.Screenshot.Render.Failed.VALUE,{ErrorMessage:e,TimeMilliseconds:t-b}),l.submit()})}else l.submit();u.destroy(),i(!0)}}function w(e){e.preventDefault(),e.stopPropagation(),window.open(document.getElementById(A.IDs.UserVoiceFormGoButton).getAttribute(A.AttributeName.Source)),i(!1)}n.__esModule=!0;var S,C,F=e("./../../Transport/Transport"),x=e("./../../Configuration/Configuration"),A=e("./../../Constants"),E=e("./../../Logging/Logging"),B=e("./../../Screenshot"),_=e("./../SpinnerControl"),k=e("./../Utils"),O=e("./TabFocus"),D=!1,N=void 0,L=[];n.registerSingle=a,n.registerMulti=s},{"./../../Configuration/Configuration":13,"./../../Constants":14,"./../../Logging/Logging":17,"./../../Screenshot":22,"./../../Transport/Transport":27,"./../SpinnerControl":41,"./../Utils":46,"./TabFocus":36}],31:[function(e,t,n){"use strict";function i(){var e=c.get().getInAppFeedbackLaunchOptions().categories,t={children:[{attributes:[{name:l.AttributeName.For,value:l.IDs.BasicFormComment}],classes:[l.Classes.FontSubtitle,l.Classes.TextAlignLeft,l.Classes.FormQuestionMiddleText],id:l.IDs.BasicFormQuestionMiddleText,tag:l.Tags.Label},{attributes:[{name:l.AttributeName.Id,value:l.IDs.BasicFormCategoriesDropdown}],brs:e.show,children:s.generate(e?e.customCategories:null),classes:[l.Classes.FontSubText,l.Classes.FormCategoriesDropdown,l.Classes.TextInput],tag:l.Tags.Select},{attributes:[{name:l.AttributeName.Placeholder,value:r.getUIStrings().Form.CommentPlaceholder},{name:l.AttributeName.MaxLength,value:l.AttributeValue.TextAreaMaxLength}],classes:[l.Classes.FontSubText,l.Classes.FormComment,l.Classes.TextInput],id:l.IDs.BasicFormComment,tag:l.Tags.TextArea},{brs:!1,children:[{attributes:[{name:l.AttributeName.For,value:l.IDs.BasicFormRating}],classes:[l.Classes.FontText,l.Classes.TextAlignLeft,l.Classes.FormRatingLabel],innerText:r.getUIStrings().Form.RatingLabel,tag:l.Tags.Label},u.generate(l.IDs.BasicFormRating)],classes:[l.Classes.FormRatingContainer]},{attributes:[{name:l.AttributeName.Type,value:l.AttributeValue.Text},{name:l.AttributeName.Placeholder,value:r.getUIStrings().Form.EmailPlaceholder},{name:l.AttributeName.AriaLabel,value:r.getUIStrings().Form.EmailPlaceholder},{name:l.AttributeName.Name,value:l.IDs.BasicFormEmailInput},{name:l.AttributeName.MaxLength,value:l.AttributeValue.TextAreaMaxLength},{name:l.AttributeName.Value,value:c.get().getInAppFeedbackInitOptions().userEmail?c.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[l.Classes.FontSubText,l.Classes.FormEmailInput,l.Classes.TextInput],id:l.IDs.BasicFormEmailInput,tag:l.Tags.Input},{children:[{children:[{attributes:[{name:l.AttributeName.Type,value:l.AttributeValue.Checkbox},{name:l.AttributeName.Value,value:l.AttributeValue.Unchecked}],brs:c.get().getInAppFeedbackInitOptions().screenshot,classes:[l.Classes.FormScreenshotCheckbox,l.Classes.CheckBox],id:l.IDs.BasicFormScreenshotCheckbox,tag:l.Tags.Input},{attributes:[{name:l.AttributeName.For,value:l.IDs.BasicFormScreenshotCheckbox}],brs:c.get().getInAppFeedbackInitOptions().screenshot,classes:[l.Classes.FontText,l.Classes.TextAlignLeft,l.Classes.FormScreenshotLabel],innerText:r.getUIStrings().Form.ScreenshotLabel,tag:l.Tags.Label}],classes:[l.Classes.FormScreenshotContainer]},{children:[{classes:[l.Classes.FontSubText,l.Classes.SubmitButton],id:l.IDs.BasicFormSubmitButton,innerText:r.getUIStrings().Form.Submit,tag:l.Tags.Button},{classes:[l.Classes.Spinner,l.Classes.Hidden],id:l.IDs.BasicFormSubmitButtonSpinner,tag:l.Tags.Div}],classes:[l.Classes.FormSubmitButtonContainer]}],classes:[l.Classes.FormBottomContainer]}],classes:[l.Classes.Hidden,l.Classes.MarginLeft60px],id:n.containerId};return t}function o(e){switch(e){case l.FeedbackType.Smile:document.getElementById(l.IDs.BasicFormQuestionMiddleText).textContent=r.getUIStrings().SmileForm.Title;break;case l.FeedbackType.Frown:document.getElementById(l.IDs.BasicFormQuestionMiddleText).textContent=r.getUIStrings().FrownForm.Title;break;case l.FeedbackType.Idea:document.getElementById(l.IDs.BasicFormQuestionMiddleText).textContent=r.getUIStrings().IdeaForm.Title;break;case l.FeedbackType.Bug:document.getElementById(l.IDs.BasicFormQuestionMiddleText).textContent=r.getUIStrings().BugForm.Title}document.getElementById(l.IDs.BasicFormComment).focus()}n.__esModule=!0;var r=e("./../../../UIStrings/UIStrings"),a=e("./FormTemplateType"),s=e("./../../CategoriesDropdown"),u=e("./../../RatingControl"),l=e("./../../../Constants"),c=e("./../../../Configuration/Configuration");n.generate=i,n.containerId=l.IDs.BasicFormContainer,n.onSelect=o,n.type=a.FormTemplateType.Basic},{"./../../../Configuration/Configuration":13,"./../../../Constants":14,"./../../../UIStrings/UIStrings":28,"./../../CategoriesDropdown":37,"./../../RatingControl":39,"./FormTemplateType":32}],32:[function(e,t,n){"use strict";n.__esModule=!0;var i;!function(e){e[e.Single=0]="Single",e[e.Basic=1]="Basic",e[e.UserVoice=2]="UserVoice"}(i=n.FormTemplateType||(n.FormTemplateType={}))},{}],33:[function(e,t,n){"use strict";function i(){var e=l.get().getInAppFeedbackLaunchOptions().categories,t={children:[{attributes:[{name:c.AttributeName.For,value:c.IDs.SingleFormComment}],classes:[c.Classes.FontSubtitle,c.Classes.TextAlignLeft,c.Classes.FormQuestionMiddleText],id:c.IDs.SingleFormQuestionMiddleText,innerText:r.getUIStrings().SingleForm.Title,tag:c.Tags.Label},{attributes:[{name:c.AttributeName.Id,value:c.IDs.SingleFormCategoriesDropdown}],brs:e.show,children:s.generate(e?e.customCategories:null),classes:[c.Classes.FontSubText,c.Classes.FormCategoriesDropdown,c.Classes.TextInput],tag:c.Tags.Select},{attributes:[{name:c.AttributeName.Placeholder,value:r.getUIStrings().Form.CommentPlaceholder},{name:c.AttributeName.MaxLength,value:c.AttributeValue.TextAreaMaxLength}],classes:[c.Classes.FontSubText,c.Classes.FormComment,c.Classes.TextInput],id:c.IDs.SingleFormComment,tag:c.Tags.TextArea},{brs:!1,children:[{attributes:[{name:c.AttributeName.For,value:c.IDs.SingleFormRating}],classes:[c.Classes.FontSubText,c.Classes.TextAlignLeft,c.Classes.FormRatingLabel],innerText:r.getUIStrings().Form.RatingLabel,tag:c.Tags.Label},u.generate(c.IDs.SingleFormRating)],classes:[c.Classes.FormRatingContainer]},{attributes:[{name:c.AttributeName.Type,value:c.AttributeValue.Text},{name:c.AttributeName.Placeholder,value:r.getUIStrings().Form.EmailPlaceholder},{name:c.AttributeName.AriaLabel,value:r.getUIStrings().Form.EmailPlaceholder},{name:c.AttributeName.Name,value:c.IDs.SingleFormEmailInput},{name:c.AttributeName.MaxLength,value:c.AttributeValue.TextAreaMaxLength},{name:c.AttributeName.Value,value:l.get().getInAppFeedbackInitOptions().userEmail?l.get().getInAppFeedbackInitOptions().userEmail:""}],classes:[c.Classes.FontSubText,c.Classes.FormEmailInput,c.Classes.TextInput],id:c.IDs.SingleFormEmailInput,tag:c.Tags.Input},{children:[{attributes:[{name:c.AttributeName.HRef,value:c.Urls.PrivacyStatementLink},{name:c.AttributeName.Target,value:c.AttributeValue.BlankWindow},{name:c.AttributeName.Rel,value:c.AttributeValue.NoReferrer}],classes:[c.Classes.Link],id:c.IDs.PrivacyStatementLink,innerText:r.getUIStrings().PrivacyStatement,tag:c.Tags.Anchor}],classes:[c.Classes.FontSubSubText,c.Classes.TextAlignLeft,c.Classes.PrivacyStatementLinkDiv]},{children:[{children:[{attributes:[{name:c.AttributeName.Type,value:c.AttributeValue.Checkbox},{name:c.AttributeName.Value,value:c.AttributeValue.Unchecked}],brs:l.get().getInAppFeedbackInitOptions().screenshot,classes:[c.Classes.FormScreenshotCheckbox,c.Classes.CheckBox],id:c.IDs.SingleFormScreenshotCheckbox,tag:c.Tags.Input},{attributes:[{name:c.AttributeName.For,value:c.IDs.SingleFormScreenshotCheckbox}],brs:l.get().getInAppFeedbackInitOptions().screenshot,classes:[c.Classes.FontText,c.Classes.TextAlignLeft,c.Classes.FormScreenshotLabel],innerText:r.getUIStrings().Form.ScreenshotLabel,tag:c.Tags.Label}],classes:[c.Classes.FormScreenshotContainer]},{children:[{classes:[c.Classes.FontSubText,c.Classes.SubmitButton],id:c.IDs.SingleFormSubmitButton,innerText:r.getUIStrings().Form.Submit,tag:c.Tags.Button},{classes:[c.Classes.Spinner,c.Classes.Hidden],id:c.IDs.SingleFormSubmitButtonSpinner,tag:c.Tags.Div}],classes:[c.Classes.FormSubmitButtonContainer]}],classes:[c.Classes.FormBottomContainer]}],id:n.containerId};return t}function o(e){document.getElementById(c.IDs.SingleFormComment).focus()}n.__esModule=!0;var r=e("./../../../UIStrings/UIStrings"),a=e("./FormTemplateType"),s=e("./../../CategoriesDropdown"),u=e("./../../RatingControl"),l=e("./../../../Configuration/Configuration"),c=e("./../../../Constants");n.generate=i,n.containerId=c.IDs.SingleFormContainer,n.onSelect=o,n.type=a.FormTemplateType.Single},{"./../../../Configuration/Configuration":13,"./../../../Constants":14,"./../../../UIStrings/UIStrings":28,"./../../CategoriesDropdown":37,"./../../RatingControl":39,"./FormTemplateType":32}],34:[function(e,t,n){"use strict";function i(){var e=u.get().getInAppFeedbackInitOptions().userVoice,t={children:[{classes:[s.Classes.FontSubtitle,s.Classes.TextAlignLeft,s.Classes.FormQuestionMiddleText],innerText:r.getUIStrings().UserVoiceForm.Title},{classes:[s.Classes.FontText,s.Classes.TextAlignLeft,s.Classes.FormMiddleText],innerText:r.getUIStrings().UserVoiceForm.Text},{children:[{children:[{attributes:[{name:s.AttributeName.Source,value:e.url}],classes:[s.Classes.SubmitButton,s.Classes.FontSubText],id:s.IDs.UserVoiceFormGoButton,innerText:r.getUIStrings().UserVoiceForm.Button,tag:s.Tags.Button}],classes:[s.Classes.FormSubmitButtonContainer]}],classes:[s.Classes.FormBottomContainer]}],classes:[s.Classes.Hidden,s.Classes.MarginLeft60px],id:n.containerId};return t}function o(e){document.getElementById(s.IDs.UserVoiceFormGoButton).focus()}n.__esModule=!0;var r=e("./../../../UIStrings/UIStrings"),a=e("./FormTemplateType"),s=e("./../../../Constants"),u=e("./../../../Configuration/Configuration");n.generate=i,n.containerId=s.IDs.UserVoiceFormContainer,n.onSelect=o,n.type=a.FormTemplateType.UserVoice},{"./../../../Configuration/Configuration":13,"./../../../Constants":14,"./../../../UIStrings/UIStrings":28,"./FormTemplateType":32}],35:[function(e,t,n){"use strict";function i(e){var t={attributes:[{name:u.AttributeName.DataHtml2CanvasIgnore,value:u.AttributeValue.True}],children:[{attributes:[{name:u.AttributeName.Role,value:"dialog"},{name:"aria-modal",value:"true"},{name:"aria-describedby",value:u.IDs.QuestionLeftText}],children:[{attributes:[{name:u.AttributeName.TabIndex,value:u.AttributeValue.Zero}],id:u.IDs.FirstTabbable},{children:[{children:[{classes:[u.Classes.FontSubtitle,u.Classes.TextAlignLeft],id:u.IDs.QuestionLeftText,innerText:l.getUIStrings().FeedbackSubtitle},{children:[{children:a(e),id:u.IDs.OverallAnchorsContainer}],id:u.IDs.ColumnSeparatorDiv},{children:[{attributes:[{name:u.AttributeName.HRef,value:u.Urls.PrivacyStatementLink},{name:u.AttributeName.Target,value:u.AttributeValue.BlankWindow},{name:u.AttributeName.Rel,value:u.AttributeValue.NoReferrer}],classes:[u.Classes.Link],id:u.IDs.PrivacyStatementLink,innerText:l.getUIStrings().PrivacyStatement,tag:u.Tags.Anchor}],classes:[u.Classes.FontSubSubText,u.Classes.TextAlignLeft,u.Classes.PrivacyStatementLinkDiv]}],classes:[u.Classes.FormContainer],id:u.IDs.LeftFormContainer},{children:r(e),classes:[u.Classes.FormContainer,u.Classes.Hidden],id:u.IDs.MiddleFormContainer}],classes:[u.Classes.Hidden],id:u.IDs.MainContentHolder,tag:u.Tags.Form},{attributes:[{name:u.AttributeName.TabIndex,value:u.AttributeValue.Zero}],id:u.IDs.LastTabbable}],id:u.IDs.MainContainer}],classes:[c.isRightToLeft()?u.Classes.Rtl:""],id:u.IDs.OverlayBackground};return t}function o(){var e={attributes:[{name:u.AttributeName.DataHtml2CanvasIgnore,value:u.AttributeValue.True}],children:[{children:[{attributes:[{name:u.AttributeName.TabIndex,value:u.AttributeValue.Zero}],id:u.IDs.FirstTabbable},{children:[{children:[d.generate()],classes:[u.Classes.FormContainer],id:u.IDs.MiddleFormContainer}],classes:[u.Classes.Hidden],id:u.IDs.MainContentHolder,tag:u.Tags.Form},{attributes:[{name:u.AttributeName.TabIndex,value:u.AttributeValue.Zero}],id:u.IDs.LastTabbable}],id:u.IDs.MainContainer}],classes:[u.Classes.SingleLayout,c.isRightToLeft()?u.Classes.Rtl:""],id:u.IDs.OverlayBackground};return e}function r(e){var t={children:[]},n={};for(var i in e)if(e.hasOwnProperty(i)){var o=!(e[i].containerId in n);o&&(t.children.push(e[i].generate()),n[e[i].containerId]=!0)}return t.children}function a(e){var t={children:[]};return u.FeedbackType.Smile in e&&t.children.push(s(u.IDs.OverallSmileAnchor,u.IDs.OverallSmileImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM36 58.6c-8.5 0-16-4.1-20.9-10.4l3.5-3.6c3.5 4.5 9.9 7.6 17.4 7.6 7.4 0 13.9-3.1 17.4-7.6l3.6 3.6C52.1 54.4 44.4 58.6 36 58.6Z"/></svg>',u.IDs.OverallSmileText,l.getUIStrings().SmileForm.Anchor)),u.FeedbackType.Frown in e&&t.children.push(s(u.IDs.OverallFrownAnchor,u.IDs.OverallFrownImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M36 1C16.7 1 1 16.7 1 36s15.7 35 35 35c19.3 0 35-15.7 35-35S55.3 1 36 1ZM49.3 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C45.1 21 47 18.3 49.3 18.3ZM22.9 18.3c2.3 0 4.2 2.7 4.2 6 0 3.3-1.9 6-4.2 6 -2.3 0-4.2-2.7-4.2-6C18.7 21 20.6 18.3 22.9 18.3ZM52.8 57.9c-3.3-4.4-9.6-7.3-16.7-7.3 -7.2 0-13.4 3-16.7 7.3l-3.4-3.4c4.7-6.1 11.9-10 20.1-10 8.2 0 15.5 4 20.2 10L52.8 57.9Z"/></svg>',u.IDs.OverallFrownText,l.getUIStrings().FrownForm.Anchor)),
u.FeedbackType.Idea in e&&t.children.push(s(u.IDs.OverallIdeaAnchor,u.IDs.OverallIdeaImage,'<svg viewBox="0 0 72 72" width="24px" height="24px" focusable="false"><path d="M42.3 62H29.2c-1.1 0-2 0.9-2 2s1.9 2 3 2h11.1c1.1 0 3-0.9 3-2S43.4 62 42.3 62ZM36 1.1C25 1.1 14.8 7 14.8 20.6c0 2.2 0.8 4.4 0.7 4.1 1.2 2.9 2.7 5.6 6.3 10.9 4.2 6.3 4.7 7.6 4.8 11.1v1.3c0 1.3 1 3 2.7 3h13.5c1.7 0 2.8-1.7 2.8-3v-1.5c0.1-3.5 0.1-4.7 4.2-10.9 3.6-5.4 5.7-8.4 6.8-11 0 0 0.6-1.6 0.6-4.1C57.2 6.9 47 1.1 36 1.1ZM31.9 11.9c-3.2 0-5.6 4.2-5.5 6.2 0.2 4-4.4 3.8-4.4 0.6 0-5.3 2.8-10.3 8.5-10.9C34.6 7.3 34.6 11.9 31.9 11.9ZM43.6 55h-15c-1.1 0-2 0.9-2 2v1c0 1.1 0.9 2 2 2h15c1.1 0 2-0.9 2-2v-1C45.6 55.9 44.7 55 43.6 55ZM39.1 68h-6c-0.8 0-1.5 0.7-1.5 1.5s1.2 1.5 2 1.5h5c0.8 0 2-0.7 2-1.5S39.9 68 39.1 68Z"/></svg>',u.IDs.OverallIdeaText,l.getUIStrings().IdeaForm.Anchor)),u.FeedbackType.Bug in e&&t.children.push(s(u.IDs.OverallBugAnchor,u.IDs.OverallBugImage,'<svg viewBox="150 100 1748 1748" width="24px" height="24px" focusable="false"><path d="M1824 1088q0 26-19 45t-45 19h-224q0 171-67 290l208 209q19 19 19 45t-19 45q-18 19-45 19t-45-19l-198-197q-5 5-15 13t-42 28.5-65 36.5-82 29-97 13v-896h-128v896q-51 0-101.5-13.5t-87-33-66-39-43.5-32.5l-15-14-183 207q-20 21-48 21-24 0-43-16-19-18-20.5-44.5t15.5-46.5l202-227q-58-114-58-274h-224q-26 0-45-19t-19-45 19-45 45-19h224v-294l-173-173q-19-19-19-45t19-45 45-19 45 19l173 173h844l173-173q19-19 45-19t45 19 19 45-19 45l-173 173v294h224q26 0 45 19t19 45zm-480-576h-640q0-133 93.5-226.5t226.5-93.5 226.5 93.5 93.5 226.5z"/></svg>',u.IDs.OverallBugText,l.getUIStrings().BugForm.Anchor)),t.children}function s(e,t,n,i,o){return{attributes:[{name:u.AttributeName.Type,value:u.AttributeValue.Button}],children:[{classes:[u.Classes.OverallImage],id:t,innerHTML:n,tag:u.Tags.Div},{classes:[u.Classes.FontSubtitle,u.Classes.OverallText],id:i,innerText:o}],classes:[u.Classes.OverallAnchor,u.Classes.TextAlignLeft],id:e,tag:u.Tags.Button}}n.__esModule=!0;var u=e("./../../Constants"),l=e("./../../UIStrings/UIStrings"),c=e("./../Utils"),d=e("./FormTemplates/SingleFormTemplate");n.generateMulti=i,n.generateSingle=o},{"./../../Constants":14,"./../../UIStrings/UIStrings":28,"./../Utils":46,"./FormTemplates/SingleFormTemplate":33}],36:[function(e,t,n){"use strict";function i(e){var t=o();if(e.id===a.IDs.LastTabbable)for(var n=0;n<t.length;n++){var i=t[n];if(i.id!==a.IDs.FirstTabbable&&r(i))return void i.focus()}else if(e.id===a.IDs.FirstTabbable)for(var n=t.length-1;n>=0;n--){var i=t[n];if(i.id!==a.IDs.LastTabbable&&r(i))return void i.focus()}}function o(){var e="a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']), select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex ='-1']), object, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]";return document.getElementById(a.IDs.MainContainer).querySelectorAll(e)}function r(e){if(!e.parentElement)return!1;if(/\S/.test(e.parentElement.id)){if(e.parentElement.className.indexOf(a.Classes.Visible)>=0)return!0;if(e.parentElement.className.indexOf(a.Classes.Hidden)>=0)return!1}return r(e.parentElement)}n.__esModule=!0;var a=e("./../../Constants");n.cycleTabFocus=i},{"./../../Constants":14}],37:[function(e,t,n){"use strict";function i(e){for(var t=e?e:[],n=[{attributes:[{name:"selected",value:"true"}],innerText:o.getUIStrings().Form.CategoryPlaceholder,tag:r.Tags.Option}],i=0,a=t;i<a.length;i++){var s=a[i];n.push({innerText:s,tag:r.Tags.Option})}return n}n.__esModule=!0;var o=e("./../UIStrings/UIStrings"),r=e("./../Constants");n.generate=i},{"./../Constants":14,"./../UIStrings/UIStrings":28}],38:[function(e,t,n){"use strict";function i(e,t,n){for(var i={children:[{classes:[r.Classes.FontSubText],innerText:t,tag:r.Tags.Legend}],tag:r.Tags.FieldSet},a=0,s=n;a<s.length;a++){var u=s[a];Array.prototype.push.apply(i.children,o(u[0].toString(),u[1],e))}return{children:[i],classes:[r.Classes.ChoiceGroup],id:e}}function o(e,t,n){return[{attributes:[{name:r.AttributeName.Type,value:r.AttributeValue.Radio},{name:r.AttributeName.Value,value:e},{name:r.AttributeName.Name,value:n}],id:e,tag:r.Tags.Input},{attributes:[{name:r.AttributeName.For,value:e}],children:[{children:[{tag:r.Tags.Span}],classes:[r.Classes.ChoiceGroupIcon],tag:r.Tags.Span},{classes:["obf-ChoiceGroupLabel"],innerHTML:t,tag:r.Tags.Span}],classes:[r.Classes.FontSubText],tag:r.Tags.Label}]}n.__esModule=!0;var r=e("./../Constants");n.generateRadioGroup=i},{"./../Constants":14}],39:[function(e,t,n){"use strict";function i(e){return{children:[p,{attributes:[{name:o.AttributeName.Type,value:"radio"},{name:o.AttributeName.Name,value:e},{name:o.AttributeName.Value,value:"1"}],tag:o.Tags.Input},f,{attributes:[{name:o.AttributeName.Type,value:"radio"},{name:o.AttributeName.Name,value:e},{name:o.AttributeName.Value,value:"2"}],tag:o.Tags.Input},h,{attributes:[{name:o.AttributeName.Type,value:"radio"},{name:o.AttributeName.Name,value:e},{name:o.AttributeName.Value,value:"3"}],tag:o.Tags.Input},g,{attributes:[{name:o.AttributeName.Type,value:"radio"},{name:o.AttributeName.Name,value:e},{name:o.AttributeName.Value,value:"4"}],tag:o.Tags.Input},m,{attributes:[{name:o.AttributeName.Type,value:"radio"},{name:o.AttributeName.Name,value:e},{name:o.AttributeName.Value,value:"5"}],tag:o.Tags.Input},v],classes:[o.Classes.Rating],id:e,tag:o.Tags.Span}}n.__esModule=!0;var o=e("./../Constants"),r="obf-star",a={children:[{attributes:[{name:o.AttributeName.Id,value:r},{name:o.AttributeName.X,value:"0"},{name:o.AttributeName.Y,value:"0"},{name:o.AttributeName.Width,value:"105"},{name:o.AttributeName.Height,value:"100"},{name:o.AttributeName.Points,value:"52.5, 80.3 84, 100 76.3, 63 105, 38 67.2, 35 52.5, 0 37.8, 35 0, 38 28.7, 63 20, 100 52.5, 80.3"}],id:r,tag:o.Tags.Polygon}],tag:o.Tags.Defs},s={attributes:[{name:o.AttributeName.xlinkHref,value:"#"+r}],tag:o.Tags.Use},u={attributes:[{name:o.AttributeName.xlinkHref,value:"#"+r},{name:o.AttributeName.Transform,value:"translate(105 0)"}],tag:o.Tags.Use},l={attributes:[{name:o.AttributeName.xlinkHref,value:"#"+r},{name:o.AttributeName.Transform,value:"translate(210 0)"}],tag:o.Tags.Use},c={attributes:[{name:o.AttributeName.xlinkHref,value:"#"+r},{name:o.AttributeName.Transform,value:"translate(315 0)"}],tag:o.Tags.Use},d={attributes:[{name:o.AttributeName.xlinkHref,value:"#"+r},{name:o.AttributeName.Transform,value:"translate(420 0)"}],tag:o.Tags.Use},p={attributes:[{name:o.AttributeName.ViewBox,value:"0 0 525 100"}],children:[a,s,u,l,c,d],classes:[o.Classes.RatingGraphic],tag:o.Tags.Svg},f={attributes:[{name:o.AttributeName.ViewBox,value:"0 0 105 100"}],children:[a,s],classes:[o.Classes.RatingGraphic,o.Classes.RatingGraphicFilled],tag:o.Tags.Svg},h={attributes:[{name:o.AttributeName.ViewBox,value:"0 0 210 100"}],children:[a,s,u],classes:[o.Classes.RatingGraphic,o.Classes.RatingGraphicFilled],tag:o.Tags.Svg},g={attributes:[{name:o.AttributeName.ViewBox,value:"0 0 315 100"}],children:[a,s,u,l],classes:[o.Classes.RatingGraphic,o.Classes.RatingGraphicFilled],tag:o.Tags.Svg},m={attributes:[{name:o.AttributeName.ViewBox,value:"0 0 420 100"}],children:[a,s,u,l,c],classes:[o.Classes.RatingGraphic,o.Classes.RatingGraphicFilled],tag:o.Tags.Svg},v={attributes:[{name:o.AttributeName.ViewBox,value:"0 0 525 100"}],children:[a,s,u,l,c,d],classes:[o.Classes.RatingGraphic,o.Classes.RatingGraphicFilled],tag:o.Tags.Svg};n.generate=i},{"./../Constants":14}],40:[function(e,t,n){"use strict";function i(e,t){if("undefined"==typeof e.brs&&(e.brs=!0),!e.brs)return null;e.tag||(e.tag=o.Tags.Div);var n;if(e.tag===o.Tags.Svg&&(t=!0),n=t?document.createElementNS("http://www.w3.org/2000/svg",e.tag):document.createElement(e.tag),e.attributes)for(var r=void 0,a=0;a<e.attributes.length;a++)r=e.attributes[a],r.name===o.AttributeName.xlinkHref?n.setAttributeNS("http://www.w3.org/1999/xlink",o.AttributeName.HRef,r.value):n.setAttribute(r.name,r.value);if(e.id&&(n.id=e.id),e.classes){var s=e.classes.join(" ");t?n.setAttribute(o.AttributeName.Class,s):n.className=s}if(e.innerText&&!t&&(n.textContent=e.innerText),e.innerHTML&&!t&&(n.innerHTML=e.innerHTML),e.children)for(var a=0;a<e.children.length;a++){var u=e.children[a];if(u){var l=i(u,t);l&&n.appendChild(l)}}return n}n.__esModule=!0;var o=e("./../Constants");n.elementFromJson=i},{"./../Constants":14}],41:[function(e,t,n){"use strict";function i(e){var t=o(e.element)-f;t<=0&&(t=1),r(e.element,t)}function o(e){return parseFloat(window.getComputedStyle(e).getPropertyValue("opacity"))}function r(e,t){e.style.opacity=t.toString()}function a(){var e=document.createElement("div");return e.classList.add(s.Classes.SpinnerCircle),e.style.width=e.style.height=p*d+"px",e}n.__esModule=!0;var s=e("./../Constants"),u=e("./Utils"),l=90,c=8,d=.2,p=34,f=1/c,h=function(){function e(e){this.circleObjects=[],this.spinnerId=e,this.spinner=document.getElementById(this.spinnerId),this.createCirclesAndArrange(),this.initializeOpacities(),this.start(),u.setElementVisibility(e,!0)}return e.prototype.destroy=function(){u.setElementVisibility(this.spinnerId,!1),this.stop()},e.prototype.start=function(){var e=this;this.stop(),this.interval=setInterval(function(){for(var t=e.circleObjects.length;t--;)i(e.circleObjects[t])},l)},e.prototype.stop=function(){clearInterval(this.interval)},e.prototype.createCirclesAndArrange=function(){for(var e,t=0,n=p*d,i=2*Math.PI/c,o=c,r=.5*(p-n);o--;){var s=a(),u=Math.round(.5*p+r*Math.cos(t)-.5*s.clientWidth)-.5*n,l=Math.round(.5*p+r*Math.sin(t)-.5*s.clientHeight)-.5*n;this.spinner.appendChild(s),s.style.left=u+"px",s.style.top=l+"px",t+=i,e={element:s,j:o},this.circleObjects.push(e)}},e.prototype.initializeOpacities=function(){var e,t=0,n=1;for(t;t<c;t++){var i=this.circleObjects[t];e=f*n++,r(i.element,e)}},e}();n.Spinner=h},{"./../Constants":14,"./Utils":46}],42:[function(e,t,n){"use strict";function i(e){o(),g(e)}function o(){a()}function r(e,t,n){y.registerListener(e,t,n),C.push({event:t,id:e,listener:n})}function a(){for(var e=0,t=C;e<t.length;e++){var n=t[e];y.unregisterListener(n.id,n.event,n.listener)}C=[]}function s(e){void 0===e&&(e=function(e){}),g=e,m=!0,r(b.IDs.ToastContainer,"keyup",l),r(b.IDs.ToastCancel,"click",c),r(b.IDs.TPromptContainer,"click",d),r(b.IDs.TFormSubmitButton,"click",h),r(b.IDs.TFormEmailCheckBox,"click",u),u(null);for(var t=document.querySelectorAll('input[name="'+b.IDs.TFormRating+'"]'),n=0;n<t.length;++n)y.registerListenerToElement(t[n],"click",f);w.get().getFloodgateSurvey().showPrompt?I.getLogger().logEvent(I.EventIds.Survey.UI.Prompt.Shown.VALUE,{CampaignId:w.get().getFloodgateSurvey().getCampaignId(),SurveyId:w.get().getFloodgateSurvey().getId(),SurveyType:w.get().getFloodgateSurvey().getSurveyType()}):p();var o=w.get().getFloodgateInitOptions().autoDismiss;if(o!==b.AutoDismissValues.NoAutoDismiss){var a=void 0;switch(o){case b.AutoDismissValues.SevenSeconds:a=7e3;break;case b.AutoDismissValues.FourteenSeconds:a=14e3;break;case b.AutoDismissValues.TwentyOneSeconds:a=21e3;break;case b.AutoDismissValues.TwentyEightSeconds:a=28e3}void 0!==a&&setTimeout(function(){m&&i(!1)},a)}}function u(e){var t=document.getElementById(b.IDs.TFormEmailCheckBox);if(t){var n=document.getElementById(b.IDs.TFormEmailTextBox);n.value=t.checked?w.get().getCommonInitOptions().userEmail:null,n.disabled=!t.checked}}function l(e){e.keyCode===b.Keys.Esc&&(e.preventDefault(),e.stopPropagation(),i(!1))}function c(e){e.preventDefault(),e.stopPropagation(),i(!1)}function d(e){e.preventDefault(),e.stopPropagation(),p()}function p(){m=!1,y.setElementVisibility(b.IDs.TPromptContainer,!1),y.setElementVisibility(b.IDs.TFormContainer,!0),I.getLogger().logEvent(I.EventIds.Survey.UI.Form.Shown.VALUE,{CampaignId:w.get().getFloodgateSurvey().getCampaignId(),SurveyId:w.get().getFloodgateSurvey().getId(),SurveyType:w.get().getFloodgateSurvey().getSurveyType()})}function f(e){document.getElementById(b.IDs.TFormSubmitButton).disabled=!1}function h(e){e.preventDefault(),e.stopPropagation(),y.setElementVisibility(b.IDs.TFormSubmitButton,!1);var t=new T.Spinner(b.IDs.TFormSubmitButtonSpinner),n=new v.Transporter(w.get().getCommonInitOptions().environment,S.ISurvey.Type[w.get().getFloodgateSurvey().getSurveyType()],w.get().getCommonInitOptions().appId,"Survey",w.get().getCommonInitOptions().applicationGroup,w.get().getCommonInitOptions().telemetryGroup,w.get().getCommonInitOptions().webGroup),o=document.getElementById(b.IDs.TFormComment),r=o&&!!o.value,a=document.querySelector('input[name="'+b.IDs.TFormRating+'"]:checked');w.get().getFloodgateSurvey().setValues(Number(a.value),r?o.value:""),n.setManifestValues(w.get().getFloodgateSurvey().getJsonElements());var s=document.getElementById(b.IDs.TFormEmailCheckBox),u=document.getElementById(b.IDs.TFormEmailTextBox);s&&s.checked&&""!==u.value&&n.setEmail(u.value),n.submit(),t.destroy(),i(!0),I.getLogger().logEvent(I.EventIds.Survey.UI.Form.Submit.VALUE,{CampaignId:w.get().getFloodgateSurvey().getCampaignId(),SurveyId:w.get().getFloodgateSurvey().getId(),SurveyType:w.get().getFloodgateSurvey().getSurveyType()})}n.__esModule=!0;var g,m,v=e("./../../Transport/Transport"),b=e("./../../Constants"),y=e("./../Utils"),T=e("./../SpinnerControl"),I=e("./../../Logging/Logging"),w=e("./../../Configuration/Configuration"),S=e("@ms-ofb/officefloodgatecore/dist/src/Api/Api"),C=[];n.register=s},{"./../../Configuration/Configuration":13,"./../../Constants":14,"./../../Logging/Logging":17,"./../../Transport/Transport":27,"./../SpinnerControl":41,"./../Utils":46,"@ms-ofb/officefloodgatecore/dist/src/Api/Api":1}],43:[function(e,t,n){"use strict";function i(){var e={attributes:[{name:c.AttributeName.DataHtml2CanvasIgnore,value:c.AttributeValue.True},{name:c.AttributeName.Role,value:"dialog"},{name:"aria-labelledby",value:c.IDs.TPromptTitle},{name:"aria-describedby",value:c.IDs.TPromptText}],children:[{attributes:[{name:c.AttributeName.Type,value:c.AttributeValue.Button},{name:c.AttributeName.AriaLabel,value:d.getUIStrings().CloseLabel}],id:c.IDs.ToastCancel,innerHTML:'<svg viewBox="4 4 16 16" width="16px" height="16px" focusable="false"><path d="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z" fill="#000"/></svg>',tag:c.Tags.Button},o(),a()],classes:[c.Classes.Toast,p.isRightToLeft()?c.Classes.Rtl:""],id:c.IDs.ToastContainer};return e}function o(){var e={attributes:[{name:"aria-labelledby",value:c.IDs.TPromptTitle}],children:[{classes:[c.Classes.FontText,c.Classes.TextAlignLeft],id:c.IDs.TPromptTitle,innerText:l.get().getFloodgateSurvey().getTitle()},{classes:[c.Classes.FontSubText,c.Classes.TextAlignLeft],id:c.IDs.TPromptText,innerText:l.get().getFloodgateSurvey().getPromptQuestion()}],id:c.IDs.TPromptContainer,tag:c.Tags.Button};return e}function r(){var e=l.get().getCommonInitOptions().userEmailConsentDefault;return e?f.AttributeValue.Checked:f.AttributeValue.Unchecked}function a(){var e={children:[{classes:[c.Classes.FontText,c.Classes.TextAlignLeft],id:c.IDs.TFormTitle,innerText:l.get().getFloodgateSurvey().getTitle()},s(),{attributes:[{name:c.AttributeName.Placeholder,value:l.get().getFloodgateSurvey().getCommentQuestion()},{name:c.AttributeName.AriaLabel,value:l.get().getFloodgateSurvey().getCommentQuestion()},{name:c.AttributeName.MaxLength,value:c.AttributeValue.TextAreaMaxLength}],classes:[c.Classes.FontSubText,c.Classes.TextInput],id:c.IDs.TFormComment,tag:c.Tags.TextArea},{brs:l.get().getFloodgateSurvey().showEmailRequest,children:[{attributes:[{name:f.AttributeName.Type,value:f.AttributeValue.Checkbox},{name:r(),value:""}],classes:[f.Classes.TFormEmailCheckbox,f.Classes.CheckBox],id:f.IDs.TFormEmailCheckBox,tag:f.Tags.Input},{attributes:[{name:f.AttributeName.For,value:f.IDs.TFormEmailCheckBox}],classes:[f.Classes.FontSubText,f.Classes.TextAlignLeft,f.Classes.TFormEmailLabel],innerText:d.getUIStrings().Form.EmailCheckBoxLabel,tag:f.Tags.Label},{attributes:[{name:f.AttributeName.Type,value:f.AttributeValue.Text},{name:f.AttributeName.Placeholder,value:d.getUIStrings().Form.EmailPlaceholder},{name:f.AttributeName.AriaLabel,value:d.getUIStrings().Form.EmailPlaceholder},{name:f.AttributeName.Name,value:f.IDs.BasicFormEmailInput},{name:f.AttributeName.MaxLength,value:f.AttributeValue.TextAreaMaxLength},{name:f.AttributeName.Value,value:l.get().getCommonInitOptions().userEmailConsentDefault?l.get().getCommonInitOptions().userEmail:""}],classes:[f.Classes.FontSubText,f.Classes.FormEmailInput,f.Classes.TextInput],id:f.IDs.TFormEmailTextBox,tag:f.Tags.Input}]},{children:[{attributes:[{name:c.AttributeName.HRef,value:c.Urls.PrivacyStatementLink},{name:c.AttributeName.Target,value:c.AttributeValue.BlankWindow},{name:c.AttributeName.Rel,value:c.AttributeValue.NoReferrer}],classes:[c.Classes.Link],innerText:d.getUIStrings().PrivacyStatement,tag:c.Tags.Anchor}],classes:[c.Classes.FontSubSubText,c.Classes.TextAlignLeft,c.Classes.PrivacyStatementLinkDiv]},{children:[{attributes:[{name:c.AttributeName.Disabled,value:c.AttributeValue.True}],classes:[c.Classes.FontSubText,c.Classes.SubmitButton],id:c.IDs.TFormSubmitButton,innerText:d.getUIStrings().Form.Submit,tag:c.Tags.Button},{classes:[c.Classes.Spinner,c.Classes.Hidden],id:c.IDs.TFormSubmitButtonSpinner,tag:c.Tags.Div}],id:c.IDs.TFormSubmitButtonContainer}],classes:[c.Classes.Hidden],id:c.IDs.TFormContainer};return e}function s(){for(var e=[],t=l.get().getFloodgateSurvey().getRatingValuesAscending(),n=0,i=0,o=t;i<o.length;i++){var r=o[i];e.push([n,r]),n++}return u.generateRadioGroup(c.IDs.TFormRating,l.get().getFloodgateSurvey().getRatingQuestion(),e.reverse())}n.__esModule=!0;var u=e("./../ChoiceGroupControl"),l=e("./../../Configuration/Configuration"),c=e("./../../Constants"),d=e("./../../UIStrings/UIStrings"),p=e("./../Utils"),f=e("./../../Constants");n.generate=i},{"./../../Configuration/Configuration":13,"./../../Constants":14,"./../../UIStrings/UIStrings":28,"./../ChoiceGroupControl":38,"./../Utils":46}],44:[function(e,t,n){"use strict";function i(e){o(u.elementFromJson(s.generate())),a.register(function(t){l.setElementVisibility(r.IDs.ToastContainer,!1),l.deleteElementById(r.IDs.ToastContainer),c.get().getFloodgateInitOptions().onDismiss(c.get().getFloodgateSurvey().getCampaignId(),t),e()})}function o(e){document.body.insertBefore(e,document.body.firstChild),l.setElementVisibility(r.IDs.ToastContainer,!0)}n.__esModule=!0;var r=e("./../../Constants"),a=e("./Events"),s=e("./Layout"),u=e("./../Renderer"),l=e("./../Utils"),c=e("./../../Configuration/Configuration");n.createSurvey=i},{"./../../Configuration/Configuration":13,"./../../Constants":14,"./../Renderer":40,"./../Utils":46,"./Events":42,"./Layout":43}],45:[function(e,t,n){"use strict";n.__esModule=!0;var i=e("./BellyBand/BellyBand");n.createBellyBandMulti=i.createMulti;var o=e("./BellyBand/BellyBand");n.createBellyBandSingle=o.createSingle;var r=e("./Toast/Toast");n.createSurvey=r.createSurvey},{"./BellyBand/BellyBand":29,"./Toast/Toast":44}],46:[function(e,t,n){"use strict";function i(e,t){var n=t?m.Classes.Hidden:m.Classes.Visible,i=t?m.Classes.Visible:m.Classes.Hidden;s(e,n,i)}function o(e){var t=document.getElementById(e);null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t)}function r(e,t){var n=document.getElementById(e);n&&(n.className.match(new RegExp("\\b"+t+"\\b"))||(n.className=n.className+" "+t))}function a(e,t){var n=document.getElementById(e);n&&(n.className=n.className.split(new RegExp("\\b"+t+"\\b","i")).join(" "),n.className=n.className.split(/\s+/).join(" "))}function s(e,t,n){a(e,t),r(e,n)}function u(e,t,n){var i=document.getElementById(e);i&&i.setAttribute(t,n)}function l(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function c(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function d(e,t,n){var i=document.getElementById(e);i&&l(i,t,n)}function p(e,t,n){e&&l(e,t,n)}function f(e,t,n){var i=document.getElementById(e);i&&c(i,t,n)}function h(){var e=-1,t=window.navigator.userAgent;if(t.indexOf("Trident")>-1){var n=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})");null!=n.exec(t)&&(e=parseFloat(RegExp.$1),e+=4)}return e}function g(){return"rtl"===getComputedStyle(document.documentElement).direction}n.__esModule=!0;var m=e("./../Constants");n.setElementVisibility=i,n.deleteElementById=o,n.addClassById=r,n.deleteClassById=a,n.replaceClassesById=s,n.setAttributeOnHtmlElement=u,n.addEventListenerHelper=l,n.removeEventListenerHelper=c,n.registerListener=d,n.registerListenerToElement=p,n.unregisterListener=f,n.getInternetExplorerVersion=h,n.isRightToLeft=g},{"./../Constants":14}],47:[function(e,t,n){"use strict";function i(e){return"number"==typeof e}function o(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function r(e){return"string"==typeof e}function a(e){return!u(e)&&"object"==typeof e}function s(e){return"boolean"==typeof e}function u(e){return null==e}function l(e){return r(e)&&/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)}function c(e,t){if(!a(e))throw t+" is not an object: "+e}function d(e,t){if(!i(e))throw t+" is not a number: "+e}function p(e,t){if(!r(e))throw t+" is not a string: "+e}function f(e,t){if(!s(e))throw t+" is not a boolean: "+e}function h(e,t){if(!l(e))throw t+" is not a guid: "+e}function g(e,t){if(!Array.isArray(e))throw t+" is not an array: "+e}function m(){return(v()+v()+"-"+v()+"-4"+v().substr(0,3)+"-"+v()+"-"+v()+v()+v()).toLowerCase()}function v(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function b(e,t){if(!t)return t;var n=t;if(e)for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n}n.__esModule=!0,n.isInteger=o,n.isBoolean=s,n.expectObject=c,n.expectNumber=d,n.expectString=p,n.expectBoolean=f,n.expectGuid=h,n.expectArray=g,n.guid=m,n.overrideValues=b},{}],48:[function(e,t,n){"use strict";n.__esModule=!0,n.default="1.3.1"},{}],49:[function(e,t,n){"use strict";function i(){var e=800;return!window.innerWidth||window.innerWidth<e}n.__esModule=!0,n.isNarrow=i},{}],50:[function(e,t,n){"use strict";function i(){return window}function o(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.setUiStrings=e}function r(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.singleFeedback=e}function a(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.multiFeedback=e}function s(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.showSurvey=e}function u(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.showCustomSurvey=e}function l(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.initialize=e}function c(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.start=e}function d(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.stop=e}function p(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.getEngine=e}function f(e){window.OfficeBrowserFeedback=window.OfficeBrowserFeedback||{},window.OfficeBrowserFeedback.floodgate=window.OfficeBrowserFeedback.floodgate||{},window.OfficeBrowserFeedback.floodgate.getSettingIdMap=e}n.__esModule=!0,n.get=i,n.setSetUiStrings=o,n.setSingleFeedback=r,n.setMultiFeedback=a,n.setFloodgateShowSurvey=s,n.setFloodgateShowCustomSurvey=u,n.setFloodgateInitialize=l,n.setFloodgateStart=c,n.setFloodgateStop=d,n.setFloodgateGetEngine=p,n.getSettingIdMap=f},{}],51:[function(e,t,n){!function(e,i){if("object"==typeof n&&"object"==typeof t)t.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{var o=i();for(var r in o)("object"==typeof n?n:e)[r]=o[r]}}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=15)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.Int64=i;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e,10)}return e.prototype.Equals=function(t){var n=new e(t);return this.low===n.low&&this.high===n.high},e}();t.UInt64=o;var r=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt16=function(e){var t=(32768&e)<<16>>16;return 32767&e|t},e.ToInt32=function(e){var t=2147483648&e;return 2147483647&e|t},e.ToUInt8=function(e){return 255&e},e.ToUInt32=function(e){return 4294967295&e},e}();t.Number=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(i=t.AWTPiiKind||(t.AWTPiiKind={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(9),o=n(1),r=n(3),a=function(){function e(){}return e.getPayloadBlob=function(e,t){var n=new i.IO.MemoryStream,o=new i.CompactBinaryProtocolWriter(n);return o.WriteFieldBegin(i.BondDataType.BT_MAP,3),o.WriteMapContainerBegin(t,i.BondDataType.BT_STRING,i.BondDataType.BT_LIST),Object.keys(e).forEach(function(t){o.WriteString(t);var n=e[t];o.WriteContainerBegin(1,i.BondDataType.BT_STRUCT),o.WriteFieldBegin(i.BondDataType.BT_STRING,2),o.WriteString("act_default_source"),o.WriteFieldBegin(i.BondDataType.BT_STRING,5),o.WriteString(r.newGuid()),o.WriteFieldBegin(i.BondDataType.BT_INT64,6),o.WriteInt64(r.numberToBondInt64(Date.now())),o.WriteFieldBegin(i.BondDataType.BT_LIST,8),o.WriteContainerBegin(n.length,i.BondDataType.BT_STRUCT);for(var a=0;a<n.length;++a)o.WriteBlob(n[a]);o.WriteStructEnd(!1)}),o.WriteStructEnd(!1),n.GetBuffer()},e.getEventBlob=function(e){var t=new i.IO.MemoryStream,n=new i.CompactBinaryProtocolWriter(t);n.WriteFieldBegin(i.BondDataType.BT_STRING,1),n.WriteString(e.id),n.WriteFieldBegin(i.BondDataType.BT_INT64,3),n.WriteInt64(r.numberToBondInt64(e.timestamp)),n.WriteFieldBegin(i.BondDataType.BT_STRING,5),n.WriteString(e.type),n.WriteFieldBegin(i.BondDataType.BT_STRING,6),n.WriteString(e.name);var a=[],s=[];return Object.keys(e.properties).forEach(function(t){var n=e.properties[t];n.pii===o.AWTPiiKind.NotSet?a.push(t):s.push(t)}),a.length&&(n.WriteFieldBegin(i.BondDataType.BT_MAP,13),n.WriteMapContainerBegin(a.length,i.BondDataType.BT_STRING,i.BondDataType.BT_STRING),a.forEach(function(t){n.WriteString(t),n.WriteString(e.properties[t].value)})),s.length&&(n.WriteFieldBegin(i.BondDataType.BT_MAP,30),n.WriteMapContainerBegin(s.length,i.BondDataType.BT_STRING,i.BondDataType.BT_STRUCT),s.forEach(function(t){n.WriteString(t),n.WriteFieldBegin(i.BondDataType.BT_INT32,1),n.WriteInt32(1),n.WriteFieldBegin(i.BondDataType.BT_INT32,2),n.WriteInt32(e.properties[t].pii),n.WriteFieldBegin(i.BondDataType.BT_STRING,3),n.WriteString(e.properties[t].value),n.WriteStructEnd(!1)})),n.WriteStructEnd(!1),t.GetBuffer()},e.base64Encode=function(e){return i.Encoding.Base64.GetString(e)},e}();t.default=a},function(e,t,n){"use strict";function i(e){var t=new a.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t}function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(s,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}function r(e){return!isNaN(e)&&null!==e&&e>=0&&e<=13}Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=/[xy]/g;t.numberToBondInt64=i,t.newGuid=o,t.isPii=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Version="1.2.2",t.FullVersionString="AWT-Web-CJS-"+t.Version},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1);t.AWTPiiKind=i.AWTPiiKind;var o=n(13);t.AWT=o.default,t.AWT_COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",t.AWT_COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(i=t.BondDataType||(t.BondDataType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},e}();t.Utf8=o;var r=function(){function e(){}return e.GetString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=e.length%3,o=function(e){return[t.charAt(e>>18&63),t.charAt(e>>12&63),t.charAt(e>>6&63),t.charAt(63&e)].join("")},r=0,a=e.length-i;r<a;r+=3){var s=(e[r]<<16)+(e[r+1]<<8)+e[r+2];n.push(o(s))}switch(i){case 1:var s=e[e.length-1];n.push(t.charAt(s>>2)),n.push(t.charAt(s<<4&63)),n.push("==");break;case 2:var u=(e[e.length-2]<<8)+e[e.length-1];n.push(t.charAt(u>>10)),n.push(t.charAt(u>>4&63)),n.push(t.charAt(u<<2&63)),n.push("=")}return n.join("")},e}();t.Base64=r;var a=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();t.Varint=a;var s=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},e}();t.Varint64=s;var u=function(){function e(){}return e.EncodeZigzag32=function(e){return e=i.Number.ToInt32(e),e<<1^e>>31},e.EncodeZigzag64=function(e){var t=e.low,n=e.high,o=n<<1|t>>>31,r=t<<1;2147483648&n&&(o=~o,r=~r);var a=new i.UInt64("0");return a.low=r,a.high=o,a},e}();t.Zigzag=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=function(){function e(){this._buffer=[]}return e.prototype.WriteByte=function(e){
this._buffer.push(i.Number.ToByte(e))},e.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},e.prototype.GetBuffer=function(){return this._buffer},e}();t.MemoryStream=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6);t.BondDataType=i.BondDataType;var o=n(7);t.Encoding=o;var r=n(8);t.IO=r;var a=n(0);t.Int64=a.Int64,t.UInt64=a.UInt64,t.Number=a.Number;var s=function(){function e(e){this._stream=e}return e.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},e.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},e.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},e.prototype.WriteFieldBegin=function(e,t){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},e.prototype.WriteInt32=function(e){e=o.Zigzag.EncodeZigzag32(e),this.WriteUInt32(e)},e.prototype.WriteInt64=function(e){this.WriteUInt64(o.Zigzag.EncodeZigzag64(e))},e.prototype.WriteString=function(e){if(""===e)this.WriteUInt32(0);else{var t=o.Utf8.GetBytes(e);this.WriteUInt32(t.length),this._stream.Write(t,0,t.length)}},e.prototype.WriteStructEnd=function(e){this.WriteUInt8(e?i.BondDataType.BT_STOP_BASE:i.BondDataType.BT_STOP)},e.prototype.WriteUInt32=function(e){var t=o.Varint.GetBytes(a.Number.ToUInt32(e));this._stream.Write(t,0,t.length)},e.prototype.WriteUInt64=function(e){var t=o.Varint64.GetBytes(e);this._stream.Write(t,0,t.length)},e.prototype.WriteUInt8=function(e){this._stream.WriteByte(a.Number.ToUInt8(e))},e}();t.CompactBinaryProtocolWriter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=1e3,o=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){var n=this;if(e&&t)try{var o=e.split(",");if("this-request-only"===t)return o;var r=parseInt(t,10)*i;o.forEach(function(e){n._killedTokenDictionary[e]=Date.now()+r})}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){return void 0!==this._killedTokenDictionary[e]&&this._killedTokenDictionary[e]>Date.now()||(delete this._killedTokenDictionary[e],!1)},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=function(){function e(e,t){this._maxRequestSize=e,this._outboundQueue=t,this._currentBatch={},this._currentBatchSize=0}return e.prototype.addEventToBatch=function(e){var t=i.default.getEventBlob(e);t.length>this._maxRequestSize||(this._currentBatchSize+t.length>this._maxRequestSize?this.flushBatch():(void 0===this._currentBatch[e.tenantToken]&&(this._currentBatch[e.tenantToken]=[]),this._currentBatch[e.tenantToken].push(t),this._currentBatchSize+=t.length))},e.prototype.flushBatch=function(){this._currentBatchSize>0&&(this._outboundQueue.push(this._currentBatch),this._currentBatch={},this._currentBatchSize=0)},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=.8,o=1.2,r=3e3,a=12e4,s=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t=0,n=r*i,s=r*o,u=Math.floor(Math.random()*(s-n))+n;return t=Math.pow(4,e)*u,Math.min(t,a)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),o=n(14),r=n(3),a=n(4),s="allTkns",u=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,l=/\./g,c=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,d=function(){function e(){}return e.initialize=function(e,t){if(void 0===t&&(t={}),this._isInitialized)throw"Already Initialized";this._defaultTenantToken=e,this._overrideValuesFromConfig(t),o.default.initialize(this._config),this._isInitialized=!0},e.flush=function(e){this._isInitialized&&!this._isDestroyed&&o.default.flush(e)},e.flushAndTeardown=function(){this._isInitialized&&!this._isDestroyed&&(this._isDestroyed=!0,o.default.flushAndTeardown())},e.setContext=function(e,t,n){void 0===n&&(n=s),t=this._sanitizeProperty(e,t),null!==t&&(this._contextProperties[n]||(this._contextProperties[n]={}),this._contextProperties[n][e]=t)},e.logEvent=function(e){var t=this;if(this._isInitialized){if(!e.name||!e.properties)return;e.name=e.name.toLowerCase(),e.name.replace(l,"_");var n="";if(e.type?(e.type.toLowerCase(),n="custom."):e.type="custom",!u.test(e.name)||!u.test(e.type))return;if(e.type=n+e.type,isNaN(e.timestamp)&&(e.timestamp=(new Date).getTime()),e.tenantToken||(e.tenantToken=this._defaultTenantToken),e.id=r.newGuid(),Object.keys(e.properties).forEach(function(n){e.properties[n]=t._sanitizeProperty(n,e.properties[n]),null===e.properties[n]&&delete e.properties[n]}),this._addContextIfAbsent(e,e.tenantToken),this._addContextIfAbsent(e,s),0===Object.keys(e.properties).length)return;this._setDefaultProperty(e,"EventInfo.InitId",this._getInitId(e.tenantToken)),this._setDefaultProperty(e,"EventInfo.Sequence",this._getSequenceId(e.tenantToken)),this._setDefaultProperty(e,"EventInfo.SdkVersion",a.FullVersionString),this._setDefaultProperty(e,"EventInfo.Name",e.name),this._setDefaultProperty(e,"EventInfo.Time",new Date(e.timestamp).toISOString()),o.default.sendEvent(e)}},e._overrideValuesFromConfig=function(e){e.collectorUrl&&(this._config.collectorUrl=e.collectorUrl),e.sendingTimer>1e3&&(this._config.sendingTimer=e.sendingTimer)},e._getInitId=function(e){return void 0===this._initIdMap[e]&&(this._initIdMap[e]=r.newGuid()),this._initIdMap[e]},e._getSequenceId=function(e){return void 0===this._sequenceIdMap[e]&&(this._sequenceIdMap[e]=0),(++this._sequenceIdMap[e]).toString()},e._setDefaultProperty=function(e,t,n){e.properties[t]={value:n,pii:i.AWTPiiKind.NotSet}},e._addContextIfAbsent=function(e,t){if(this._contextProperties[t]){var n=this._contextProperties[t];Object.keys(n).forEach(function(t){e.properties[t]||(e.properties[t]=n[t])})}},e._sanitizeProperty=function(e,t){return"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t||(t={value:t}),c.test(e)&&void 0!==t&&null!==t&&null!==t.value&&void 0!==t.value&&""!==t.value?("undefined"==typeof t.pii&&(t.pii=i.AWTPiiKind.NotSet),t.value=t.value.toString(),r.isPii(t.pii)?t:null):null},e._isInitialized=!1,e._isDestroyed=!1,e._contextProperties={},e._sequenceIdMap={},e._initIdMap={},e._config={collectorUrl:"https://browser.pipe.aria.microsoft.com/Collector/3.0/",sendingTimer:1e3},e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),o=n(2),r=n(12),a=n(10),s=n(4),u=250,l=2936012,c=4,d=function(){function e(){}return e.initialize=function(e){this._inboundQueues.push([]),this._recordBatcher=new i.default(l,this._outboundQueue),this._newEventsAllowed=!0,"undefined"==typeof Uint8Array&&(this._urlString+="&content-encoding=base64"),this._sendingTimer=e.sendingTimer,this._urlString=e.collectorUrl+this._urlString+"&x-apikey="},e.sendEvent=function(e){var t=this;this._newEventsAllowed&&(this._inboundQueues[this._inboundQueues.length-1].push(e),!this._running&&this._timeout<0&&!this._isCurrentlyFlushing&&(this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer)))},e.flushAndTeardown=function(){this._newEventsAllowed=!1,this._batchAndSendEvents(!0)},e.flush=function(e){this._inboundQueues.push([]),this._isCurrentlyFlushing?this._flushQueue.push(e):(this._isCurrentlyFlushing=!0,this._flush(e))},e._batchAndSendEvents=function(e){for(this._running=!0;this._inboundQueues[0].length>0&&this._outboundQueue.length<1;)this._recordBatcher.addEventToBatch(this._inboundQueues[0].pop());0===this._outboundQueue.length&&this._recordBatcher.flushBatch(),this._sendRequest(this._outboundQueue.pop(),0,e)},e._retryRequestIfNeeded=function(e,t,n,i,o){var a=this,s=!0;if(e&&"undefined"!=typeof e.status){var u=this._killSwitch.setKillSwitchTenants(e.getResponseHeader("kill-tokens"),e.getResponseHeader("kill-duration-seconds"));u.forEach(function(e){delete t[e],n--}),(!r.default.shouldRetryForStatus(e.status)||n<=0)&&(s=!1)}s&&o<c?setTimeout(function(){return a._sendRequest(t,o+1,!1)},r.default.getMillisToBackoffForRetry(o)):this._handleRequestFinished(null)},e._sendRequest=function(e,t,n){var i=this;try{var r=new XMLHttpRequest,a=0,s="";if(Object.keys(e).forEach(function(t){i._killSwitch.isTenantKilled(t)?delete e[t]:(s.length>0&&(s+=","),s+=t,a++)}),r.open("POST",this._urlString+s,!n),n||(r.ontimeout=function(){i._retryRequestIfNeeded(r,e,a,s,t)},r.onerror=function(){i._retryRequestIfNeeded(r,e,a,s,t)},r.onload=function(){i._handleRequestFinished(r)}),a>0){var u=o.default.getPayloadBlob(e,a);"undefined"==typeof Uint8Array?r.send(o.default.base64Encode(u)):r.send(new Uint8Array(u))}else n&&this._handleRequestFinished(null)}catch(e){this._handleRequestFinished(null)}},e._handleRequestFinished=function(e){var t=this;e&&this._killSwitch.setKillSwitchTenants(e.getResponseHeader("kill-tokens"),e.getResponseHeader("kill-duration-seconds")),this._inboundQueues[0].length>0?this._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},this._sendingTimer):(this._timeout=-1,this._running=!1)},e._flush=function(e){var t=this;this._running||(this._timeout>-1&&(clearTimeout(this._timeout),this._timeout=-1),this._inboundQueues[0].length>0&&this._batchAndSendEvents(!1)),this._checkPrimaryInboundQueueEmpty(function(){t._inboundQueues.shift(),null!==e&&void 0!==e&&e(),t._flushQueue.length>0?setTimeout(function(){return t._flush(t._flushQueue.shift())},t._sendingTimer):(t._isCurrentlyFlushing=!1,t._inboundQueues[0].length>0&&(t._timeout=setTimeout(function(){return t._batchAndSendEvents(!1)},t._sendingTimer)))})},e._checkPrimaryInboundQueueEmpty=function(e){var t=this;0===this._inboundQueues[0].length?this._checkOutboundQueueEmptyAndSent(e):setTimeout(function(){return t._checkPrimaryInboundQueueEmpty(e)},u)},e._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._running?setTimeout(function(){return t._checkOutboundQueueEmptyAndSent(e)},u):e()},e._outboundQueue=[],e._inboundQueues=[],e._newEventsAllowed=!1,e._killSwitch=new a.default,e._isCurrentlyFlushing=!1,e._flushQueue=[],e._running=!1,e._timeout=-1,e._urlString="?qsp=true&content-type=application%2Fbond-compact-binary&client-id=NO_AUTH&sdk-version="+s.FullVersionString,e}();t.default=d},function(e,t,n){e.exports=n(5)}])})},{}],52:[function(e,t,n){(function(t){var n=e("es6-promise").Promise;!function(e){window.OfficeBrowserFeedback.html2canvas=e}(function(){var i;return function t(n,i,o){function r(s,u){if(!i[s]){if(!n[s]){var l="function"==typeof e&&e;if(!u&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[s]={exports:{}};n[s][0].call(d.exports,function(e){var t=n[s][1][e];return r(t?t:e)},d,d.exports,t,n,i,o)}return i[s].exports}for(var a="function"==typeof e&&e,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,n,o){(function(e){!function(t){function r(e){throw RangeError(N[e])}function a(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function s(e,t){return a(e.split(D),t).join(".")}function u(e){for(var t,n,i=[],o=0,r=e.length;o<r;)t=e.charCodeAt(o++),t>=55296&&t<=56319&&o<r?(n=e.charCodeAt(o++),56320==(64512&n)?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),o--)):i.push(t);return i}function l(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=R(e>>>10&1023|55296),e=56320|1023&e),t+=R(e)}).join("")}function c(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:S}function d(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function p(e,t,n){var i=0;for(e=n?M(e/A):e>>1,e+=M(e/t);e>L*F>>1;i+=S)e=M(e/L);return M(i+(L+1)*e/(e+x))}function f(e){var t,n,i,o,a,s,u,d,f,h,g=[],m=e.length,v=0,b=B,y=E;for(n=e.lastIndexOf(_),n<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&r("not-basic"),g.push(e.charCodeAt(i));for(o=n>0?n+1:0;o<m;){for(a=v,s=1,u=S;o>=m&&r("invalid-input"),d=c(e.charCodeAt(o++)),(d>=S||d>M((w-v)/s))&&r("overflow"),v+=d*s,f=u<=y?C:u>=y+F?F:u-y,!(d<f);u+=S)h=S-f,s>M(w/h)&&r("overflow"),s*=h;t=g.length+1,y=p(v-a,t,0==a),M(v/t)>w-b&&r("overflow"),b+=M(v/t),v%=t,g.splice(v++,0,b)}return l(g)}function h(e){var t,n,i,o,a,s,l,c,f,h,g,m,v,b,y,T=[];for(e=u(e),m=e.length,t=B,n=0,a=E,s=0;s<m;++s)g=e[s],g<128&&T.push(R(g));for(i=o=T.length,o&&T.push(_);i<m;){for(l=w,s=0;s<m;++s)g=e[s],g>=t&&g<l&&(l=g);for(v=i+1,l-t>M((w-n)/v)&&r("overflow"),n+=(l-t)*v,t=l,s=0;s<m;++s)if(g=e[s],g<t&&++n>w&&r("overflow"),g==t){for(c=n,f=S;h=f<=a?C:f>=a+F?F:f-a,!(c<h);f+=S)y=c-h,b=S-h,T.push(R(d(h+y%b,0))),c=M(y/b);T.push(R(d(c,0))),a=p(n,v,i==o),n=0,++i}++n,++t}return T.join("")}function g(e){return s(e,function(e){return k.test(e)?f(e.slice(4).toLowerCase()):e})}function m(e){return s(e,function(e){return O.test(e)?"xn--"+h(e):e})}var v="object"==typeof o&&o,b="object"==typeof n&&n&&n.exports==v&&n,y="object"==typeof e&&e;y.global!==y&&y.window!==y||(t=y);var T,I,w=2147483647,S=36,C=1,F=26,x=38,A=700,E=72,B=128,_="-",k=/^xn--/,O=/[^ -~]/,D=/\x2E|\u3002|\uFF0E|\uFF61/g,N={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},L=S-C,M=Math.floor,R=String.fromCharCode;if(T={version:"1.2.4",ucs2:{decode:u,encode:l},decode:f,encode:h,toASCII:m,toUnicode:g},"function"==typeof i&&"object"==typeof i.amd&&i.amd)i("punycode",function(){return T});else if(v&&!v.nodeType)if(b)b.exports=T;else for(I in T)T.hasOwnProperty(I)&&(v[I]=T[I]);else t.punycode=T}(this)}).call(this,"undefined"!=typeof t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,i){function o(e,t,n){!e.defaultView||t===e.defaultView.pageXOffset&&n===e.defaultView.pageYOffset||e.defaultView.scrollTo(t,n)}function r(e,t){try{t&&(t.width=e.width,t.height=e.height,t.getContext("2d").putImageData(e.getContext("2d").getImageData(0,0,e.width,e.height),0,0))}catch(t){u("Unable to copy canvas content from",e,t)}}function a(e,t){for(var n=3===e.nodeType?document.createTextNode(e.nodeValue):e.cloneNode(!1),i=e.firstChild;i;)t!==!0&&1===i.nodeType&&"SCRIPT"===i.nodeName||n.appendChild(a(i,t)),i=i.nextSibling;return 1===e.nodeType&&(n._scrollTop=e.scrollTop,n._scrollLeft=e.scrollLeft,"CANVAS"===e.nodeName?r(e,n):"TEXTAREA"!==e.nodeName&&"SELECT"!==e.nodeName||(n.value=e.value)),n}function s(e){if(1===e.nodeType){e.scrollTop=e._scrollTop,e.scrollLeft=e._scrollLeft;for(var t=e.firstChild;t;)s(t),t=t.nextSibling}}var u=e("./log");t.exports=function(e,t,i,r,u,l,c){var d=a(e.documentElement,u.javascriptEnabled),p=t.createElement("iframe");return p.className="html2canvas-container",p.style.visibility="hidden",p.style.position="fixed",p.style.left="-10000px",p.style.top="0px",p.style.border="0",p.width=i,p.height=r,p.scrolling="no",t.body.appendChild(p),new n(function(t){var n=p.contentWindow.document;p.contentWindow.onload=p.onload=function(){var e=setInterval(function(){n.body.childNodes.length>0&&(s(n.documentElement),clearInterval(e),"view"===u.type&&(p.contentWindow.scrollTo(l,c),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||p.contentWindow.scrollY===c&&p.contentWindow.scrollX===l||(n.documentElement.style.top=-c+"px",n.documentElement.style.left=-l+"px",n.documentElement.style.position="absolute")),t(p))},50)},n.open(),n.write("<!DOCTYPE html><html></html>"),o(e,l,c),n.replaceChild(n.adoptNode(d),n.documentElement),n.close()})}},{"./log":13}],3:[function(e,t,n){function i(e){this.r=0,this.g=0,this.b=0,this.a=null;this.fromArray(e)||this.namedColor(e)||this.rgb(e)||this.rgba(e)||this.hex6(e)||this.hex3(e)}i.prototype.darken=function(e){var t=1-e;return new i([Math.round(this.r*t),Math.round(this.g*t),Math.round(this.b*t),this.a])},i.prototype.isTransparent=function(){return 0===this.a},i.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},i.prototype.fromArray=function(e){return Array.isArray(e)&&(this.r=Math.min(e[0],255),this.g=Math.min(e[1],255),this.b=Math.min(e[2],255),e.length>3&&(this.a=e[3])),Array.isArray(e)};var o=/^#([a-f0-9]{3})$/i;i.prototype.hex3=function(e){var t=null;return null!==(t=e.match(o))&&(this.r=parseInt(t[1][0]+t[1][0],16),this.g=parseInt(t[1][1]+t[1][1],16),this.b=parseInt(t[1][2]+t[1][2],16)),null!==t};var r=/^#([a-f0-9]{6})$/i;i.prototype.hex6=function(e){var t=null;return null!==(t=e.match(r))&&(this.r=parseInt(t[1].substring(0,2),16),this.g=parseInt(t[1].substring(2,4),16),this.b=parseInt(t[1].substring(4,6),16)),null!==t};var a=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/;i.prototype.rgb=function(e){var t=null;return null!==(t=e.match(a))&&(this.r=Number(t[1]),this.g=Number(t[2]),this.b=Number(t[3])),null!==t};var s=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/;i.prototype.rgba=function(e){var t=null;return null!==(t=e.match(s))&&(this.r=Number(t[1]),this.g=Number(t[2]),this.b=Number(t[3]),this.a=Number(t[4])),null!==t},i.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},i.prototype.namedColor=function(e){e=e.toLowerCase();var t=u[e];if(t)this.r=t[0],this.g=t[1],this.b=t[2];else if("transparent"===e)return this.r=this.g=this.b=this.a=0,!0;return!!t},i.prototype.isColor=!0;var u={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};t.exports=i},{}],4:[function(e,t,o){function r(e,t){var i=C++;if(t=t||{},t.logging&&(b.options.logging=!0,b.options.start=Date.now()),t.async="undefined"==typeof t.async||t.async,t.allowTaint="undefined"!=typeof t.allowTaint&&t.allowTaint,t.removeContainer="undefined"==typeof t.removeContainer||t.removeContainer,t.javascriptEnabled="undefined"!=typeof t.javascriptEnabled&&t.javascriptEnabled,t.imageTimeout="undefined"==typeof t.imageTimeout?1e4:t.imageTimeout,t.renderer="function"==typeof t.renderer?t.renderer:h,t.strict=!!t.strict,"string"==typeof e){if("string"!=typeof t.proxy)return n.reject("Proxy must be used when rendering url");var o=null!=t.width?t.width:window.innerWidth,r=null!=t.height?t.height:window.innerHeight;return I(p(e),t.proxy,document,o,r,t).then(function(e){return s(e.contentWindow.document.documentElement,e,t,o,r)})}var u=(void 0===e?[document.documentElement]:e.length?e:[e])[0];return u.setAttribute(S+i,i),a(u.ownerDocument,t,u.ownerDocument.defaultView.innerWidth,u.ownerDocument.defaultView.innerHeight,i).then(function(e){return"function"==typeof t.onrendered&&(b("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),t.onrendered(e)),e})}function a(e,t,i,o,r){return T(e,e,i,o,t,e.defaultView.pageXOffset,e.defaultView.pageYOffset).then(function(a){b("Document cloned");var u=S+r,l="["+u+"='"+r+"']";e.querySelector(l).removeAttribute(u);var c=a.contentWindow,d=c.document.querySelector(l),p="function"==typeof t.onclone?n.resolve(t.onclone(c.document)):n.resolve(!0);return p.then(function(){return s(d,a,t,i,o)})})}function s(e,t,n,i,o){var r=t.contentWindow,a=new f(r.document),s=new g(n,a),p=w(e),h="view"===n.type?i:c(r.document),v="view"===n.type?o:d(r.document),y=new n.renderer(h,v,s,n,document),T=new m(e,y,a,s,n);return T.ready.then(function(){b("Finished rendering");var i;return i="view"===n.type?l(y.canvas,{width:y.canvas.width,height:y.canvas.height,top:0,left:0,x:0,y:0}):e===r.document.body||e===r.document.documentElement||null!=n.canvas?y.canvas:l(y.canvas,{width:null!=n.width?n.width:p.width,height:null!=n.height?n.height:p.height,top:p.top,left:p.left,x:0,y:0}),u(t,n),i})}function u(e,t){t.removeContainer&&(e.parentNode.removeChild(e),b("Cleaned up container"))}function l(e,t){var n=document.createElement("canvas"),i=Math.min(e.width-1,Math.max(0,t.left)),o=Math.min(e.width,Math.max(1,t.left+t.width)),r=Math.min(e.height-1,Math.max(0,t.top)),a=Math.min(e.height,Math.max(1,t.top+t.height));n.width=t.width,n.height=t.height;var s=o-i,u=a-r;return b("Cropping canvas at:","left:",t.left,"top:",t.top,"width:",s,"height:",u),b("Resulting crop with width",t.width,"and height",t.height,"with x",i,"and y",r),n.getContext("2d").drawImage(e,i,r,s,u,t.x,t.y,s,u),n}function c(e){return Math.max(Math.max(e.body.scrollWidth,e.documentElement.scrollWidth),Math.max(e.body.offsetWidth,e.documentElement.offsetWidth),Math.max(e.body.clientWidth,e.documentElement.clientWidth))}function d(e){return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}function p(e){var t=document.createElement("a");return t.href=e,t.href=t.href,t}var f=e("./support"),h=e("./renderers/canvas"),g=e("./imageloader"),m=e("./nodeparser"),v=e("./nodecontainer"),b=e("./log"),y=e("./utils"),T=e("./clone"),I=e("./proxy").loadUrlDocument,w=y.getBounds,S="data-html2canvas-node",C=0;r.CanvasRenderer=h,r.NodeContainer=v,r.log=b,r.utils=y;var F="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return n.reject("No canvas support")}:r;t.exports=F,"function"==typeof i&&i.amd&&i("html2canvas",[],function(){return F})},{"./clone":2,"./imageloader":11,"./log":13,"./nodecontainer":14,"./nodeparser":15,"./proxy":16,"./renderers/canvas":20,"./support":22,"./utils":26}],5:[function(e,t,i){function o(e){if(this.src=e,r("DummyImageContainer for",e),!this.promise||!this.image){r("Initiating DummyImageContainer"),o.prototype.image=new Image;var t=this.image;o.prototype.promise=new n(function(e,n){t.onload=e,t.onerror=n,t.src=a(),t.complete===!0&&e(t)})}}var r=e("./log"),a=e("./utils").smallImage;t.exports=o},{"./log":13,"./utils":26}],6:[function(e,t,n){function i(e,t){var n,i,r=document.createElement("div"),a=document.createElement("img"),s=document.createElement("span"),u="Hidden Text";r.style.visibility="hidden",r.style.fontFamily=e,r.style.fontSize=t,r.style.margin=0,r.style.padding=0,document.body.appendChild(r),a.src=o(),a.width=1,a.height=1,a.style.margin=0,a.style.padding=0,a.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin=0,s.style.padding=0,s.appendChild(document.createTextNode(u)),r.appendChild(s),r.appendChild(a),n=a.offsetTop-s.offsetTop+1,r.removeChild(s),r.appendChild(document.createTextNode(u)),r.style.lineHeight="normal",a.style.verticalAlign="super",i=a.offsetTop-r.offsetTop+1,document.body.removeChild(r),this.baseline=n,this.lineWidth=1,this.middle=i}var o=e("./utils").smallImage;t.exports=i},{"./utils":26}],7:[function(e,t,n){function i(){this.data={}}var o=e("./font");i.prototype.getMetrics=function(e,t){return void 0===this.data[e+"-"+t]&&(this.data[e+"-"+t]=new o(e,t)),this.data[e+"-"+t]},t.exports=i},{"./font":6}],8:[function(e,t,i){function o(t,i,o){this.image=null,this.src=t;var r=this,s=a(t);this.promise=(i?new n(function(e){"about:blank"===t.contentWindow.document.URL||null==t.contentWindow.document.documentElement?t.contentWindow.onload=t.onload=function(){e(t)}:e(t)}):this.proxyLoad(o.proxy,s,o)).then(function(t){var n=e("./core");return n(t.contentWindow.document.documentElement,{type:"view",width:t.width,height:t.height,proxy:o.proxy,javascriptEnabled:o.javascriptEnabled,removeContainer:o.removeContainer,allowTaint:o.allowTaint,imageTimeout:o.imageTimeout/2})}).then(function(e){return r.image=e})}var r=e("./utils"),a=r.getBounds,s=e("./proxy").loadUrlDocument;o.prototype.proxyLoad=function(e,t,n){var i=this.src;return s(i.src,e,i.ownerDocument,t.width,t.height,n)},t.exports=o},{"./core":4,"./proxy":16,"./utils":26}],9:[function(e,t,i){function o(e){this.src=e.value,this.colorStops=[],this.type=null,this.x0=.5,this.y0=.5,this.x1=.5,this.y1=.5,this.promise=n.resolve(!0)}o.TYPES={LINEAR:1,RADIAL:2},o.REGEXP_COLORSTOP=/^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i,t.exports=o},{}],10:[function(e,t,i){function o(e,t){this.src=e,this.image=new Image;var i=this;this.tainted=null,this.promise=new n(function(n,o){i.image.onload=n,i.image.onerror=o,t&&(i.image.crossOrigin="anonymous"),i.image.src=e,i.image.complete===!0&&n(i.image)})}t.exports=o},{}],11:[function(e,t,i){function o(e,t){this.link=null,this.options=e,this.support=t,this.origin=this.getOrigin(window.location.href)}var r=e("./log"),a=e("./imagecontainer"),s=e("./dummyimagecontainer"),u=e("./proxyimagecontainer"),l=e("./framecontainer"),c=e("./svgcontainer"),d=e("./svgnodecontainer"),p=e("./lineargradientcontainer"),f=e("./webkitgradientcontainer"),h=e("./utils").bind;o.prototype.findImages=function(e){var t=[];return e.reduce(function(e,t){switch(t.node.nodeName){case"IMG":return e.concat([{args:[t.node.src],method:"url"}]);case"svg":case"IFRAME":return e.concat([{args:[t.node],method:t.node.nodeName}])}return e},[]).forEach(this.addImage(t,this.loadImage),this),t},o.prototype.findBackgroundImage=function(e,t){return t.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(e,this.loadImage),this),e},o.prototype.addImage=function(e,t){return function(n){n.args.forEach(function(i){this.imageExists(e,i)||(e.splice(0,0,t.call(this,n)),r("Added image #"+e.length,"string"==typeof i?i.substring(0,100):i))},this)}},o.prototype.hasImageBackground=function(e){return"none"!==e.method},o.prototype.loadImage=function(e){if("url"===e.method){var t=e.args[0];return!this.isSVG(t)||this.support.svg||this.options.allowTaint?t.match(/data:image\/.*;base64,/i)?new a(t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),(!1)):this.isSameOrigin(t)||this.options.allowTaint===!0||this.isSVG(t)?new a(t,(!1)):this.support.cors&&!this.options.allowTaint&&this.options.useCORS?new a(t,(!0)):this.options.proxy?new u(t,this.options.proxy):new s(t):new c(t)}return"linear-gradient"===e.method?new p(e):"gradient"===e.method?new f(e):"svg"===e.method?new d(e.args[0],this.support.svg):"IFRAME"===e.method?new l(e.args[0],this.isSameOrigin(e.args[0].src),this.options):new s(e)},o.prototype.isSVG=function(e){return"svg"===e.substring(e.length-3).toLowerCase()||c.prototype.isInline(e)},o.prototype.imageExists=function(e,t){return e.some(function(e){return e.src===t})},o.prototype.isSameOrigin=function(e){return this.getOrigin(e)===this.origin},o.prototype.getOrigin=function(e){var t=this.link||(this.link=document.createElement("a"));return t.href=e,t.href=t.href,t.protocol+t.hostname+t.port},o.prototype.getPromise=function(e){return this.timeout(e,this.options.imageTimeout).catch(function(){var t=new s(e.src);return t.promise.then(function(t){e.image=t})})},o.prototype.get=function(e){var t=null;return this.images.some(function(n){return(t=n).src===e})?t:null},o.prototype.fetch=function(e){return this.images=e.reduce(h(this.findBackgroundImage,this),this.findImages(e)),this.images.forEach(function(e,t){e.promise.then(function(){r("Succesfully loaded image #"+(t+1),e)},function(n){r("Failed loading image #"+(t+1),e,n)})}),this.ready=n.all(this.images.map(this.getPromise,this)),r("Finished searching images"),this},o.prototype.timeout=function(e,t){var i,o=n.race([e.promise,new n(function(n,o){i=setTimeout(function(){r("Timed out loading image",e),o(e)},t)})]).then(function(e){return clearTimeout(i),e});return o.catch(function(){clearTimeout(i)}),o},t.exports=o},{"./dummyimagecontainer":5,"./framecontainer":8,"./imagecontainer":10,"./lineargradientcontainer":12,"./log":13,"./proxyimagecontainer":17,"./svgcontainer":23,"./svgnodecontainer":24,"./utils":26,"./webkitgradientcontainer":27}],12:[function(e,t,n){function i(e){o.apply(this,arguments),this.type=o.TYPES.LINEAR;var t=i.REGEXP_DIRECTION.test(e.args[0])||!o.REGEXP_COLORSTOP.test(e.args[0]);t?e.args[0].split(/\s+/).reverse().forEach(function(e,t){switch(e){case"left":this.x0=0,this.x1=1;break;case"top":this.y0=0,this.y1=1;break;case"right":this.x0=1,this.x1=0;break;case"bottom":this.y0=1,this.y1=0;break;case"to":var n=this.y0,i=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=i,this.y1=n;break;case"center":break;default:var o=.01*parseFloat(e,10);if(isNaN(o))break;0===t?(this.y0=o,this.y1=1-this.y0):(this.x0=o,this.x1=1-this.x0)}},this):(this.y0=0,this.y1=1),this.colorStops=e.args.slice(t?1:0).map(function(e){var t=e.match(o.REGEXP_COLORSTOP),n=+t[2],i=0===n?"%":t[3];return{color:new r(t[1]),stop:"%"===i?n/100:null}}),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(e,t){null===e.stop&&this.colorStops.slice(t).some(function(n,i){
return null!==n.stop&&(e.stop=(n.stop-this.colorStops[t-1].stop)/(i+1)+this.colorStops[t-1].stop,!0)},this)},this)}var o=e("./gradientcontainer"),r=e("./color");i.prototype=Object.create(o.prototype),i.REGEXP_DIRECTION=/^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i,t.exports=i},{"./color":3,"./gradientcontainer":9}],13:[function(e,t,n){var i=function(){i.options.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-i.options.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))};i.options={logging:!1},t.exports=i},{}],14:[function(e,t,n){function i(e,t){this.node=e,this.parent=t,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function o(e){var t=e.options[e.selectedIndex||0];return t?t.text||"":""}function r(e){if(e&&"matrix"===e[1])return e[2].split(",").map(function(e){return parseFloat(e.trim())});if(e&&"matrix3d"===e[1]){var t=e[2].split(",").map(function(e){return parseFloat(e.trim())});return[t[0],t[1],t[4],t[5],t[12],t[13]]}}function a(e){return e.toString().indexOf("%")!==-1}function s(e){return e.replace("px","")}function u(e){return parseFloat(e)}var l=e("./color"),c=e("./utils"),d=c.getBounds,p=c.parseBackgrounds,f=c.offsetBounds;i.prototype.cloneTo=function(e){e.visible=this.visible,e.borders=this.borders,e.bounds=this.bounds,e.clip=this.clip,e.backgroundClip=this.backgroundClip,e.computedStyles=this.computedStyles,e.styles=this.styles,e.backgroundImages=this.backgroundImages,e.opacity=this.opacity},i.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},i.prototype.assignStack=function(e){this.stack=e,e.children.push(this)},i.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},i.prototype.css=function(e){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[e]||(this.styles[e]=this.computedStyles[e])},i.prototype.prefixedCss=function(e){var t=["webkit","moz","ms","o"],n=this.css(e);return void 0===n&&t.some(function(t){return n=this.css(t+e.substr(0,1).toUpperCase()+e.substr(1)),void 0!==n},this),void 0===n?null:n},i.prototype.computedStyle=function(e){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,e)},i.prototype.cssInt=function(e){var t=parseInt(this.css(e),10);return isNaN(t)?0:t},i.prototype.color=function(e){return this.colors[e]||(this.colors[e]=new l(this.css(e)))},i.prototype.cssFloat=function(e){var t=parseFloat(this.css(e));return isNaN(t)?0:t},i.prototype.fontWeight=function(){var e=this.css("fontWeight");switch(parseInt(e,10)){case 401:e="bold";break;case 400:e="normal"}return e},i.prototype.parseClip=function(){var e=this.css("clip").match(this.CLIP);return e?{top:parseInt(e[1],10),right:parseInt(e[2],10),bottom:parseInt(e[3],10),left:parseInt(e[4],10)}:null},i.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=p(this.css("backgroundImage")))},i.prototype.cssList=function(e,t){var n=(this.css(e)||"").split(",");return n=n[t||0]||n[0]||"auto",n=n.trim().split(" "),1===n.length&&(n=[n[0],a(n[0])?"auto":n[0]]),n},i.prototype.parseBackgroundSize=function(e,t,n){var i,o,r=this.cssList("backgroundSize",n);if(a(r[0]))i=e.width*parseFloat(r[0])/100;else{if(/contain|cover/.test(r[0])){var s=e.width/e.height,u=t.width/t.height;return s<u^"contain"===r[0]?{width:e.height*u,height:e.height}:{width:e.width,height:e.width/u}}i=parseInt(r[0],10)}return o="auto"===r[0]&&"auto"===r[1]?t.height:"auto"===r[1]?i/t.width*t.height:a(r[1])?e.height*parseFloat(r[1])/100:parseInt(r[1],10),"auto"===r[0]&&(i=o/t.height*t.width),{width:i,height:o}},i.prototype.parseBackgroundPosition=function(e,t,n,i){var o,r,s=this.cssList("backgroundPosition",n);return o=a(s[0])?(e.width-(i||t).width)*(parseFloat(s[0])/100):parseInt(s[0],10),r="auto"===s[1]?o/t.width*t.height:a(s[1])?(e.height-(i||t).height)*parseFloat(s[1])/100:parseInt(s[1],10),"auto"===s[0]&&(o=r/t.height*t.width),{left:o,top:r}},i.prototype.parseBackgroundRepeat=function(e){return this.cssList("backgroundRepeat",e)[0]},i.prototype.parseTextShadows=function(){var e=this.css("textShadow"),t=[];if(e&&"none"!==e)for(var n=e.match(this.TEXT_SHADOW_PROPERTY),i=0;n&&i<n.length;i++){var o=n[i].match(this.TEXT_SHADOW_VALUES);t.push({color:new l(o[0]),offsetX:o[1]?parseFloat(o[1].replace("px","")):0,offsetY:o[2]?parseFloat(o[2].replace("px","")):0,blur:o[3]?o[3].replace("px",""):0})}return t},i.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var e=this.parseBounds(),t=this.prefixedCss("transformOrigin").split(" ").map(s).map(u);t[0]+=e.left,t[1]+=e.top,this.transformData={origin:t,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},i.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var e=this.prefixedCss("transform"),t=e?r(e.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=t?t:[1,0,0,1,0,0]}return this.transformMatrix},i.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?f(this.node):d(this.node))},i.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},i.prototype.getValue=function(){var e=this.node.value||"";return"SELECT"===this.node.tagName?e=o(this.node):"password"===this.node.type&&(e=Array(e.length+1).join("")),0===e.length?this.node.placeholder||"":e},i.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,i.prototype.TEXT_SHADOW_PROPERTY=/((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g,i.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,i.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,t.exports=i},{"./color":3,"./utils":26}],15:[function(e,t,i){function o(e,t,i,o,r){W("Starting NodeParser"),this.renderer=t,this.options=r,this.range=null,this.support=i,this.renderQueue=[],this.stack=new Z((!0),1,e.ownerDocument,null);var a=new H(e,null);if(r.background&&t.rectangle(0,0,t.width,t.height,new q(r.background)),e===e.ownerDocument.documentElement){var s=new H(a.color("backgroundColor").isTransparent()?e.ownerDocument.body:e.ownerDocument.documentElement,null);t.rectangle(0,0,t.width,t.height,s.color("backgroundColor"))}a.visibile=a.isElementVisible(),this.createPseudoHideStyles(e.ownerDocument),this.disableAnimations(e.ownerDocument),this.nodes=M([a].concat(this.getChildren(a)).filter(function(e){return e.visible=e.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new Q,W("Fetched nodes, total:",this.nodes.length),W("Calculate overflow clips"),this.calculateOverflowClips(),W("Start fetching images"),this.images=o.fetch(this.nodes.filter(E)),this.ready=this.images.ready.then(X(function(){return W("Images loaded, starting parsing"),W("Creating stacking contexts"),this.createStackingContexts(),W("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),W("Render queue created with "+this.renderQueue.length+" items"),new n(X(function(e){r.async?"function"==typeof r.async?r.async.call(this,this.renderQueue,e):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,e)):e():(this.renderQueue.forEach(this.paint,this),e())},this))},this))}function r(e){return e.parent&&e.parent.clip.length}function a(e){return e.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})}function s(){}function u(e,t,n,i){return e.map(function(o,r){if(o.width>0){var a=t.left,s=t.top,u=t.width,l=t.height-e[2].width;switch(r){case 0:l=e[0].width,o.args=p({c1:[a,s],c2:[a+u,s],c3:[a+u-e[1].width,s+l],c4:[a+e[3].width,s+l]},i[0],i[1],n.topLeftOuter,n.topLeftInner,n.topRightOuter,n.topRightInner);break;case 1:a=t.left+t.width-e[1].width,u=e[1].width,o.args=p({c1:[a+u,s],c2:[a+u,s+l+e[2].width],c3:[a,s+l],c4:[a,s+e[0].width]},i[1],i[2],n.topRightOuter,n.topRightInner,n.bottomRightOuter,n.bottomRightInner);break;case 2:s=s+t.height-e[2].width,l=e[2].width,o.args=p({c1:[a+u,s+l],c2:[a,s+l],c3:[a+e[3].width,s],c4:[a+u-e[3].width,s]},i[2],i[3],n.bottomRightOuter,n.bottomRightInner,n.bottomLeftOuter,n.bottomLeftInner);break;case 3:u=e[3].width,o.args=p({c1:[a,s+l+e[2].width],c2:[a,s],c3:[a+u,s+e[0].width],c4:[a+u,s+l]},i[3],i[0],n.bottomLeftOuter,n.bottomLeftInner,n.topLeftOuter,n.topLeftInner)}}return o})}function l(e,t,n,i){var o=4*((Math.sqrt(2)-1)/3),r=n*o,a=i*o,s=e+n,u=t+i;return{topLeft:d({x:e,y:u},{x:e,y:u-a},{x:s-r,y:t},{x:s,y:t}),topRight:d({x:e,y:t},{x:e+r,y:t},{x:s,y:u-a},{x:s,y:u}),bottomRight:d({x:s,y:t},{x:s,y:t+a},{x:e+r,y:u},{x:e,y:u}),bottomLeft:d({x:s,y:u},{x:s-r,y:u},{x:e,y:t+a},{x:e,y:t})}}function c(e,t,n){var i=e.left,o=e.top,r=e.width,a=e.height,s=t[0][0]<r/2?t[0][0]:r/2,u=t[0][1]<a/2?t[0][1]:a/2,c=t[1][0]<r/2?t[1][0]:r/2,d=t[1][1]<a/2?t[1][1]:a/2,p=t[2][0]<r/2?t[2][0]:r/2,f=t[2][1]<a/2?t[2][1]:a/2,h=t[3][0]<r/2?t[3][0]:r/2,g=t[3][1]<a/2?t[3][1]:a/2,m=r-c,v=a-f,b=r-p,y=a-g;return{topLeftOuter:l(i,o,s,u).topLeft.subdivide(.5),topLeftInner:l(i+n[3].width,o+n[0].width,Math.max(0,s-n[3].width),Math.max(0,u-n[0].width)).topLeft.subdivide(.5),topRightOuter:l(i+m,o,c,d).topRight.subdivide(.5),topRightInner:l(i+Math.min(m,r+n[3].width),o+n[0].width,m>r+n[3].width?0:c-n[3].width,d-n[0].width).topRight.subdivide(.5),bottomRightOuter:l(i+b,o+v,p,f).bottomRight.subdivide(.5),bottomRightInner:l(i+Math.min(b,r-n[3].width),o+Math.min(v,a+n[0].width),Math.max(0,p-n[1].width),f-n[2].width).bottomRight.subdivide(.5),bottomLeftOuter:l(i,o+y,h,g).bottomLeft.subdivide(.5),bottomLeftInner:l(i+n[3].width,o+y,Math.max(0,h-n[3].width),g-n[2].width).bottomLeft.subdivide(.5)}}function d(e,t,n,i){var o=function(e,t,n){return{x:e.x+(t.x-e.x)*n,y:e.y+(t.y-e.y)*n}};return{start:e,startControl:t,endControl:n,end:i,subdivide:function(r){var a=o(e,t,r),s=o(t,n,r),u=o(n,i,r),l=o(a,s,r),c=o(s,u,r),p=o(l,c,r);return[d(e,a,l,p),d(p,c,u,i)]},curveTo:function(e){e.push(["bezierCurve",t.x,t.y,n.x,n.y,i.x,i.y])},curveToReversed:function(i){i.push(["bezierCurve",n.x,n.y,t.x,t.y,e.x,e.y])}}}function p(e,t,n,i,o,r,a){var s=[];return t[0]>0||t[1]>0?(s.push(["line",i[1].start.x,i[1].start.y]),i[1].curveTo(s)):s.push(["line",e.c1[0],e.c1[1]]),n[0]>0||n[1]>0?(s.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(s),s.push(["line",a[0].end.x,a[0].end.y]),a[0].curveToReversed(s)):(s.push(["line",e.c2[0],e.c2[1]]),s.push(["line",e.c3[0],e.c3[1]])),t[0]>0||t[1]>0?(s.push(["line",o[1].end.x,o[1].end.y]),o[1].curveToReversed(s)):s.push(["line",e.c4[0],e.c4[1]]),s}function f(e,t,n,i,o,r,a){t[0]>0||t[1]>0?(e.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(e),i[1].curveTo(e)):e.push(["line",r,a]),(n[0]>0||n[1]>0)&&e.push(["line",o[0].start.x,o[0].start.y])}function h(e){return e.cssInt("zIndex")<0}function g(e){return e.cssInt("zIndex")>0}function m(e){return 0===e.cssInt("zIndex")}function v(e){return["inline","inline-block","inline-table"].indexOf(e.css("display"))!==-1}function b(e){return e instanceof Z}function y(e){return e.node.data.trim().length>0}function T(e){return/^(normal|none|0px)$/.test(e.parent.css("letterSpacing"))}function I(e){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(t){var n=e.css("border"+t+"Radius"),i=n.split(" ");return i.length<=1&&(i[1]=i[0]),i.map(D)})}function w(e){return e.nodeType===Node.TEXT_NODE||e.nodeType===Node.ELEMENT_NODE}function S(e){var t=e.css("position"),n=["absolute","relative","fixed"].indexOf(t)!==-1?e.css("zIndex"):"auto";return"auto"!==n}function C(e){return"static"!==e.css("position")}function F(e){return"none"!==e.css("float")}function x(e){return["inline-block","inline-table"].indexOf(e.css("display"))!==-1}function A(e){var t=this;return function(){return!e.apply(t,arguments)}}function E(e){return e.node.nodeType===Node.ELEMENT_NODE}function B(e){return e.isPseudoElement===!0}function _(e){return e.node.nodeType===Node.TEXT_NODE}function k(e){return function(t,n){return t.cssInt("zIndex")+e.indexOf(t)/e.length-(n.cssInt("zIndex")+e.indexOf(n)/e.length)}}function O(e){return e.getOpacity()<1}function D(e){return parseInt(e,10)}function N(e){return e.width}function L(e){return e.node.nodeType!==Node.ELEMENT_NODE||["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(e.node.nodeName)===-1}function M(e){return[].concat.apply([],e)}function R(e){var t=e.substr(0,1);return t===e.substr(e.length-1)&&t.match(/'|"/)?e.substr(1,e.length-2):e}function P(e){for(var t,n=[],i=0,o=!1;e.length;)U(e[i])===o?(t=e.splice(0,i),t.length&&n.push(G.ucs2.encode(t)),o=!o,i=0):i++,i>=e.length&&(t=e.splice(0,i),t.length&&n.push(G.ucs2.encode(t)));return n}function U(e){return[32,13,10,9,45].indexOf(e)!==-1}function V(e){return/[^\u0000-\u00ff]/.test(e)}var W=e("./log"),G=e("punycode"),H=e("./nodecontainer"),j=e("./textcontainer"),z=e("./pseudoelementcontainer"),Q=e("./fontmetrics"),q=e("./color"),Z=e("./stackingcontext"),K=e("./utils"),X=K.bind,Y=K.getBounds,J=K.parseBackgrounds,$=K.offsetBounds;o.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(e){if(E(e)){B(e)&&e.appendToDOM(),e.borders=this.parseBorders(e);var t="hidden"===e.css("overflow")?[e.borders.clip]:[],n=e.parseClip();n&&["absolute","fixed"].indexOf(e.css("position"))!==-1&&t.push([["rect",e.bounds.left+n.left,e.bounds.top+n.top,n.right-n.left,n.bottom-n.top]]),e.clip=r(e)?e.parent.clip.concat(t):t,e.backgroundClip="hidden"!==e.css("overflow")?e.clip.concat([e.borders.clip]):e.clip,B(e)&&e.cleanDOM()}else _(e)&&(e.clip=r(e)?e.parent.clip:[]);B(e)||(e.bounds=null)},this)},o.prototype.asyncRenderer=function(e,t,n){n=n||Date.now(),this.paint(e[this.renderIndex++]),e.length===this.renderIndex?t():n+20>Date.now()?this.asyncRenderer(e,t,n):setTimeout(X(function(){this.asyncRenderer(e,t)},this),0)},o.prototype.createPseudoHideStyles=function(e){this.createStyles(e,"."+z.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+z.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},o.prototype.disableAnimations=function(e){this.createStyles(e,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},o.prototype.createStyles=function(e,t){var n=e.createElement("style");n.innerHTML=t,e.body.appendChild(n)},o.prototype.getPseudoElements=function(e){var t=[[e]];if(e.node.nodeType===Node.ELEMENT_NODE){var n=this.getPseudoElement(e,":before"),i=this.getPseudoElement(e,":after");n&&t.push(n),i&&t.push(i)}return M(t)},o.prototype.getPseudoElement=function(e,t){var n=e.computedStyle(t);if(!n||!n.content||"none"===n.content||"-moz-alt-content"===n.content||"none"===n.display)return null;for(var i=R(n.content),o="url"===i.substr(0,3),r=document.createElement(o?"img":"html2canvaspseudoelement"),s=new z(r,e,t),u=n.length-1;u>=0;u--){var l=a(n.item(u));r.style[l]=n[l]}if(r.className=z.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+z.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,o)return r.src=J(i)[0].args[0],[s];var c=document.createTextNode(i);return r.appendChild(c),[s,new j(c,s)]},o.prototype.getChildren=function(e){return M([].filter.call(e.node.childNodes,w).map(function(t){var n=[t.nodeType===Node.TEXT_NODE?new j(t,e):new H(t,e)].filter(L);return t.nodeType===Node.ELEMENT_NODE&&n.length&&"TEXTAREA"!==t.tagName?n[0].isElementVisible()?n.concat(this.getChildren(n[0])):[]:n},this))},o.prototype.newStackingContext=function(e,t){var n=new Z(t,e.getOpacity(),e.node,e.parent);e.cloneTo(n);var i=t?n.getParentStack(this):n.parent.stack;i.contexts.push(n),e.stack=n},o.prototype.createStackingContexts=function(){this.nodes.forEach(function(e){E(e)&&(this.isRootElement(e)||O(e)||S(e)||this.isBodyWithTransparentRoot(e)||e.hasTransform())?this.newStackingContext(e,!0):E(e)&&(C(e)&&m(e)||x(e)||F(e))?this.newStackingContext(e,!1):e.assignStack(e.parent.stack)},this)},o.prototype.isBodyWithTransparentRoot=function(e){return"BODY"===e.node.nodeName&&e.parent.color("backgroundColor").isTransparent()},o.prototype.isRootElement=function(e){return null===e.parent},o.prototype.sortStackingContexts=function(e){e.contexts.sort(k(e.contexts.slice(0))),e.contexts.forEach(this.sortStackingContexts,this)},o.prototype.parseTextBounds=function(e){return function(t,n,i){if("none"!==e.parent.css("textDecoration").substr(0,4)||0!==t.trim().length){if(this.support.rangeBounds&&!e.parent.hasTransform()){var o=i.slice(0,n).join("").length;return this.getRangeBounds(e.node,o,t.length)}if(e.node&&"string"==typeof e.node.data){var r=e.node.splitText(t.length),a=this.getWrapperBounds(e.node,e.parent.hasTransform());return e.node=r,a}}else this.support.rangeBounds&&!e.parent.hasTransform()||(e.node=e.node.splitText(t.length));return{}}},o.prototype.getWrapperBounds=function(e,t){var n=e.ownerDocument.createElement("html2canvaswrapper"),i=e.parentNode,o=e.cloneNode(!0);n.appendChild(e.cloneNode(!0)),i.replaceChild(n,e);var r=t?$(n):Y(n);return i.replaceChild(o,n),r},o.prototype.getRangeBounds=function(e,t,n){var i=this.range||(this.range=e.ownerDocument.createRange());return i.setStart(e,t),i.setEnd(e,t+n),i.getBoundingClientRect()},o.prototype.parse=function(e){var t=e.contexts.filter(h),n=e.children.filter(E),i=n.filter(A(F)),o=i.filter(A(C)).filter(A(v)),r=n.filter(A(C)).filter(F),a=i.filter(A(C)).filter(v),u=e.contexts.concat(i.filter(C)).filter(m),l=e.children.filter(_).filter(y),c=e.contexts.filter(g);t.concat(o).concat(r).concat(a).concat(u).concat(l).concat(c).forEach(function(e){this.renderQueue.push(e),b(e)&&(this.parse(e),this.renderQueue.push(new s))},this)},o.prototype.paint=function(e){try{e instanceof s?this.renderer.ctx.restore():_(e)?(B(e.parent)&&e.parent.appendToDOM(),this.paintText(e),B(e.parent)&&e.parent.cleanDOM()):this.paintNode(e)}catch(e){if(W(e),this.options.strict)throw e}},o.prototype.paintNode=function(e){b(e)&&(this.renderer.setOpacity(e.opacity),this.renderer.ctx.save(),e.hasTransform()&&this.renderer.setTransform(e.parseTransform())),"INPUT"===e.node.nodeName&&"checkbox"===e.node.type?this.paintCheckbox(e):"INPUT"===e.node.nodeName&&"radio"===e.node.type?this.paintRadio(e):this.paintElement(e)},o.prototype.paintElement=function(e){var t=e.parseBounds();this.renderer.clip(e.backgroundClip,function(){this.renderer.renderBackground(e,t,e.borders.borders.map(N))},this),this.renderer.clip(e.clip,function(){this.renderer.renderBorders(e.borders.borders)},this),this.renderer.clip(e.backgroundClip,function(){switch(e.node.nodeName){case"svg":case"IFRAME":var n=this.images.get(e.node);n?this.renderer.renderImage(e,t,e.borders,n):W("Error loading <"+e.node.nodeName+">",e.node);break;case"IMG":var i=this.images.get(e.node.src);i?this.renderer.renderImage(e,t,e.borders,i):W("Error loading <img>",e.node.src);break;case"CANVAS":this.renderer.renderImage(e,t,e.borders,{image:e.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(e)}},this)},o.prototype.paintCheckbox=function(e){var t=e.parseBounds(),n=Math.min(t.width,t.height),i={width:n-1,height:n-1,top:t.top,left:t.left},o=[3,3],r=[o,o,o,o],a=[1,1,1,1].map(function(e){return{color:new q("#A5A5A5"),width:e}}),s=c(i,r,a);this.renderer.clip(e.backgroundClip,function(){this.renderer.rectangle(i.left+1,i.top+1,i.width-2,i.height-2,new q("#DEDEDE")),this.renderer.renderBorders(u(a,i,s,r)),e.node.checked&&(this.renderer.font(new q("#424242"),"normal","normal","bold",n-3+"px","arial"),this.renderer.text("",i.left+n/6,i.top+n-1))},this)},o.prototype.paintRadio=function(e){var t=e.parseBounds(),n=Math.min(t.width,t.height)-2;this.renderer.clip(e.backgroundClip,function(){this.renderer.circleStroke(t.left+1,t.top+1,n,new q("#DEDEDE"),1,new q("#A5A5A5")),e.node.checked&&this.renderer.circle(Math.ceil(t.left+n/4)+1,Math.ceil(t.top+n/4)+1,Math.floor(n/2),new q("#424242"))},this)},o.prototype.paintFormValue=function(e){var t=e.getValue();if(t.length>0){var n=e.node.ownerDocument,i=n.createElement("html2canvaswrapper"),o=["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"];o.forEach(function(t){try{i.style[t]=e.css(t)}catch(e){W("html2canvas: Parse: Exception caught in renderFormValue: "+e.message)}});var r=e.parseBounds();i.style.position="fixed",i.style.left=r.left+"px",i.style.top=r.top+"px",i.textContent=t,n.body.appendChild(i),this.paintText(new j(i.firstChild,e)),n.body.removeChild(i)}},o.prototype.paintText=function(e){e.applyTextTransform();var t=G.ucs2.decode(e.node.data),n=this.options.letterRendering&&!T(e)||V(e.node.data)?t.map(function(e){return G.ucs2.encode([e])}):P(t),i=e.parent.fontWeight(),o=e.parent.css("fontSize"),r=e.parent.css("fontFamily"),a=e.parent.parseTextShadows();this.renderer.font(e.parent.color("color"),e.parent.css("fontStyle"),e.parent.css("fontVariant"),i,o,r),a.length?this.renderer.fontShadow(a[0].color,a[0].offsetX,a[0].offsetY,a[0].blur):this.renderer.clearShadow(),this.renderer.clip(e.parent.clip,function(){n.map(this.parseTextBounds(e),this).forEach(function(t,i){t&&(this.renderer.text(n[i],t.left,t.bottom),this.renderTextDecoration(e.parent,t,this.fontMetrics.getMetrics(r,o)))},this)},this)},o.prototype.renderTextDecoration=function(e,t,n){switch(e.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(t.left,Math.round(t.top+n.baseline+n.lineWidth),t.width,1,e.color("color"));break;case"overline":this.renderer.rectangle(t.left,Math.round(t.top),t.width,1,e.color("color"));break;case"line-through":this.renderer.rectangle(t.left,Math.ceil(t.top+n.middle+n.lineWidth),t.width,1,e.color("color"))}};var ee={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};o.prototype.parseBorders=function(e){var t=e.parseBounds(),n=I(e),i=["Top","Right","Bottom","Left"].map(function(t,n){var i=e.css("border"+t+"Style"),o=e.color("border"+t+"Color");"inset"===i&&o.isBlack()&&(o=new q([255,255,255,o.a]));var r=ee[i]?ee[i][n]:null;return{width:e.cssInt("border"+t+"Width"),color:r?o[r[0]](r[1]):o,args:null}}),o=c(t,n,i);return{clip:this.parseBackgroundClip(e,o,i,n,t),borders:u(i,t,o,n)}},o.prototype.parseBackgroundClip=function(e,t,n,i,o){var r=e.css("backgroundClip"),a=[];switch(r){case"content-box":case"padding-box":f(a,i[0],i[1],t.topLeftInner,t.topRightInner,o.left+n[3].width,o.top+n[0].width),f(a,i[1],i[2],t.topRightInner,t.bottomRightInner,o.left+o.width-n[1].width,o.top+n[0].width),f(a,i[2],i[3],t.bottomRightInner,t.bottomLeftInner,o.left+o.width-n[1].width,o.top+o.height-n[2].width),f(a,i[3],i[0],t.bottomLeftInner,t.topLeftInner,o.left+n[3].width,o.top+o.height-n[2].width);break;default:f(a,i[0],i[1],t.topLeftOuter,t.topRightOuter,o.left,o.top),f(a,i[1],i[2],t.topRightOuter,t.bottomRightOuter,o.left+o.width,o.top),f(a,i[2],i[3],t.bottomRightOuter,t.bottomLeftOuter,o.left+o.width,o.top+o.height),f(a,i[3],i[0],t.bottomLeftOuter,t.topLeftOuter,o.left,o.top+o.height)}return a},t.exports=o},{"./color":3,"./fontmetrics":7,"./log":13,"./nodecontainer":14,"./pseudoelementcontainer":18,"./stackingcontext":21,"./textcontainer":25,"./utils":26,punycode:1}],16:[function(e,t,i){function o(e,t,i){var o="withCredentials"in new XMLHttpRequest;if(!t)return n.reject("No proxy configured");var r=s(o),l=u(t,e,r);return o?d(l):a(i,l,r).then(function(e){return g(e.content)})}function r(e,t,i){var o="crossOrigin"in new Image,r=s(o),l=u(t,e,r);return o?n.resolve(l):a(i,l,r).then(function(e){return"data:"+e.type+";base64,"+e.content})}function a(e,t,i){return new n(function(n,o){var r=e.createElement("script"),a=function(){delete window.OfficeBrowserFeedback.html2canvas.proxy[i],e.body.removeChild(r)};window.OfficeBrowserFeedback.html2canvas.proxy[i]=function(e){a(),n(e)},r.src=t,r.onerror=function(e){a(),o(e)},e.body.appendChild(r)})}function s(e){return e?"":"html2canvas_"+Date.now()+"_"+ ++m+"_"+Math.round(1e5*Math.random())}function u(e,t,n){return e+"?url="+encodeURIComponent(t)+(n.length?"&callback=html2canvas.proxy."+n:"")}function l(e){return function(t){var n,i=new DOMParser;try{n=i.parseFromString(t,"text/html")}catch(e){f("DOMParser not supported, falling back to createHTMLDocument"),n=document.implementation.createHTMLDocument("");try{n.open(),n.write(t),n.close()}catch(e){f("createHTMLDocument write not supported, falling back to document.body.innerHTML"),n.body.innerHTML=t}}var o=n.querySelector("base");if(!o||!o.href.host){var r=n.createElement("base");r.href=e,n.head.insertBefore(r,n.head.firstChild)}return n}}function c(e,t,n,i,r,a){return new o(e,t,window.document).then(l(e)).then(function(e){return h(e,n,i,r,a,0,0)})}var d=e("./xhr"),p=e("./utils"),f=e("./log"),h=e("./clone"),g=p.decode64,m=0;i.Proxy=o,i.ProxyURL=r,i.loadUrlDocument=c},{"./clone":2,"./log":13,"./utils":26,"./xhr":28}],17:[function(e,t,i){function o(e,t){var i=document.createElement("a");i.href=e,e=i.href,this.src=e,this.image=new Image;var o=this;this.promise=new n(function(n,i){o.image.crossOrigin="Anonymous",o.image.onload=n,o.image.onerror=i,new r(e,t,document).then(function(e){o.image.src=e}).catch(i)})}var r=e("./proxy").ProxyURL;t.exports=o},{"./proxy":16}],18:[function(e,t,n){function i(e,t,n){o.call(this,e,t),this.isPseudoElement=!0,this.before=":before"===n}var o=e("./nodecontainer");i.prototype.cloneTo=function(e){i.prototype.cloneTo.call(this,e),e.isPseudoElement=!0,e.before=this.before},i.prototype=Object.create(o.prototype),i.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),this.parent.node.className+=" "+this.getHideClass()},i.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},i.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},i.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",i.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",t.exports=i},{"./nodecontainer":14}],19:[function(e,t,n){function i(e,t,n,i,o){this.width=e,this.height=t,this.images=n,this.options=i,this.document=o}var o=e("./log");i.prototype.renderImage=function(e,t,n,i){var o=e.cssInt("paddingLeft"),r=e.cssInt("paddingTop"),a=e.cssInt("paddingRight"),s=e.cssInt("paddingBottom"),u=n.borders,l=t.width-(u[1].width+u[3].width+o+a),c=t.height-(u[0].width+u[2].width+r+s);this.drawImage(i,0,0,i.image.width||l,i.image.height||c,t.left+o+u[3].width,t.top+r+u[0].width,l,c)},i.prototype.renderBackground=function(e,t,n){t.height>0&&t.width>0&&(this.renderBackgroundColor(e,t),this.renderBackgroundImage(e,t,n))},i.prototype.renderBackgroundColor=function(e,t){var n=e.color("backgroundColor");n.isTransparent()||this.rectangle(t.left,t.top,t.width,t.height,n)},i.prototype.renderBorders=function(e){e.forEach(this.renderBorder,this)},i.prototype.renderBorder=function(e){e.color.isTransparent()||null===e.args||this.drawShape(e.args,e.color)},i.prototype.renderBackgroundImage=function(e,t,n){var i=e.parseBackgroundImages();i.reverse().forEach(function(i,r,a){switch(i.method){case"url":var s=this.images.get(i.args[0]);s?this.renderBackgroundRepeating(e,t,s,a.length-(r+1),n):o("Error loading background-image",i.args[0]);break;case"linear-gradient":case"gradient":var u=this.images.get(i.value);u?this.renderBackgroundGradient(u,t,n):o("Error loading background-image",i.args[0]);break;case"none":break;default:o("Unknown background-image type",i.args[0])}},this)},i.prototype.renderBackgroundRepeating=function(e,t,n,i,o){var r=e.parseBackgroundSize(t,n.image,i),a=e.parseBackgroundPosition(t,n.image,i,r),s=e.parseBackgroundRepeat(i);switch(s){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(n,a,r,t,t.left+o[3],t.top+a.top+o[0],99999,r.height,o);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(n,a,r,t,t.left+a.left+o[3],t.top+o[0],r.width,99999,o);break;case"no-repeat":this.backgroundRepeatShape(n,a,r,t,t.left+a.left+o[3],t.top+a.top+o[0],r.width,r.height,o);break;default:this.renderBackgroundRepeat(n,a,r,{top:t.top,left:t.left},o[3],o[0])}},t.exports=i},{"./log":13}],20:[function(e,t,n){function i(e,t){r.apply(this,arguments),this.canvas=this.options.canvas||this.document.createElement("canvas"),this.options.canvas||(this.canvas.width=e,this.canvas.height=t),this.ctx=this.canvas.getContext("2d"),this.taintCtx=this.document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},s("Initialized CanvasRenderer with size",e,"x",t)}function o(e){return e.length>0}var r=e("../renderer"),a=e("../lineargradientcontainer"),s=e("../log");i.prototype=Object.create(r.prototype),i.prototype.setFillStyle=function(e){return this.ctx.fillStyle="object"==typeof e&&e.isColor?e.toString():e,this.ctx},i.prototype.rectangle=function(e,t,n,i,o){this.setFillStyle(o).fillRect(e,t,n,i)},i.prototype.circle=function(e,t,n,i){this.setFillStyle(i),this.ctx.beginPath(),this.ctx.arc(e+n/2,t+n/2,n/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},i.prototype.circleStroke=function(e,t,n,i,o,r){this.circle(e,t,n,i),this.ctx.strokeStyle=r.toString(),this.ctx.stroke()},i.prototype.drawShape=function(e,t){this.shape(e),this.setFillStyle(t).fill()},i.prototype.taints=function(e){if(null===e.tainted){this.taintCtx.drawImage(e.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),e.tainted=!1}catch(t){this.taintCtx=document.createElement("canvas").getContext("2d"),e.tainted=!0}}return e.tainted},i.prototype.drawImage=function(e,t,n,i,o,r,a,s,u){this.taints(e)&&!this.options.allowTaint||this.ctx.drawImage(e.image,t,n,i,o,r,a,s,u)},i.prototype.clip=function(e,t,n){this.ctx.save(),e.filter(o).forEach(function(e){this.shape(e).clip()},this),t.call(n),this.ctx.restore()},i.prototype.shape=function(e){return this.ctx.beginPath(),e.forEach(function(e,t){"rect"===e[0]?this.ctx.rect.apply(this.ctx,e.slice(1)):this.ctx[0===t?"moveTo":e[0]+"To"].apply(this.ctx,e.slice(1))},this),this.ctx.closePath(),this.ctx},i.prototype.font=function(e,t,n,i,o,r){this.setFillStyle(e).font=[t,n,i,o,r].join(" ").split(",")[0]},i.prototype.fontShadow=function(e,t,n,i){this.setVariable("shadowColor",e.toString()).setVariable("shadowOffsetY",t).setVariable("shadowOffsetX",n).setVariable("shadowBlur",i)},i.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},i.prototype.setOpacity=function(e){this.ctx.globalAlpha=e},i.prototype.setTransform=function(e){this.ctx.translate(e.origin[0],e.origin[1]),this.ctx.transform.apply(this.ctx,e.matrix),this.ctx.translate(-e.origin[0],-e.origin[1])},i.prototype.setVariable=function(e,t){return this.variables[e]!==t&&(this.variables[e]=this.ctx[e]=t),this},i.prototype.text=function(e,t,n){this.ctx.fillText(e,t,n)},i.prototype.backgroundRepeatShape=function(e,t,n,i,o,r,a,s,u){var l=[["line",Math.round(o),Math.round(r)],["line",Math.round(o+a),Math.round(r)],["line",Math.round(o+a),Math.round(s+r)],["line",Math.round(o),Math.round(s+r)]];this.clip([l],function(){this.renderBackgroundRepeat(e,t,n,i,u[3],u[0]);
},this)},i.prototype.renderBackgroundRepeat=function(e,t,n,i,o,r){var a=Math.round(i.left+t.left+o),s=Math.round(i.top+t.top+r);this.setFillStyle(this.ctx.createPattern(this.resizeImage(e,n),"repeat")),this.ctx.translate(a,s),this.ctx.fill(),this.ctx.translate(-a,-s)},i.prototype.renderBackgroundGradient=function(e,t){if(e instanceof a){var n=this.ctx.createLinearGradient(t.left+t.width*e.x0,t.top+t.height*e.y0,t.left+t.width*e.x1,t.top+t.height*e.y1);e.colorStops.forEach(function(e){n.addColorStop(e.stop,e.color.toString())}),this.rectangle(t.left,t.top,t.width,t.height,n)}},i.prototype.resizeImage=function(e,t){var n=e.image;if(n.width===t.width&&n.height===t.height)return n;var i,o=document.createElement("canvas");return o.width=t.width,o.height=t.height,i=o.getContext("2d"),i.drawImage(n,0,0,n.width,n.height,0,0,t.width,t.height),o},t.exports=i},{"../lineargradientcontainer":12,"../log":13,"../renderer":19}],21:[function(e,t,n){function i(e,t,n,i){o.call(this,n,i),this.ownStacking=e,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*t}var o=e("./nodecontainer");i.prototype=Object.create(o.prototype),i.prototype.getParentStack=function(e){var t=this.parent?this.parent.stack:null;return t?t.ownStacking?t:t.getParentStack(e):e.stack},t.exports=i},{"./nodecontainer":14}],22:[function(e,t,n){function i(e){this.rangeBounds=this.testRangeBounds(e),this.cors=this.testCORS(),this.svg=this.testSVG()}i.prototype.testRangeBounds=function(e){var t,n,i,o,r=!1;return e.createRange&&(t=e.createRange(),t.getBoundingClientRect&&(n=e.createElement("boundtest"),n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n),i=t.getBoundingClientRect(),o=i.height,123===o&&(r=!0),e.body.removeChild(n))),r},i.prototype.testCORS=function(){return"undefined"!=typeof(new Image).crossOrigin},i.prototype.testSVG=function(){var e=new Image,t=document.createElement("canvas"),n=t.getContext("2d");e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{n.drawImage(e,0,0),t.toDataURL()}catch(e){return!1}return!0},t.exports=i},{}],23:[function(e,t,i){function o(e){this.src=e,this.image=null;var t=this;this.promise=this.hasFabric().then(function(){return t.isInline(e)?n.resolve(t.inlineFormatting(e)):r(e)}).then(function(e){return new n(function(n){window.OfficeBrowserFeedback.html2canvas.svg.fabric.loadSVGFromString(e,t.createCanvas.call(t,n))})})}var r=e("./xhr"),a=e("./utils").decode64;o.prototype.hasFabric=function(){return window.OfficeBrowserFeedback.html2canvas.svg&&window.OfficeBrowserFeedback.html2canvas.svg.fabric?n.resolve():n.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg"))},o.prototype.inlineFormatting=function(e){return/^data:image\/svg\+xml;base64,/.test(e)?this.decode64(this.removeContentType(e)):this.removeContentType(e)},o.prototype.removeContentType=function(e){return e.replace(/^data:image\/svg\+xml(;base64)?,/,"")},o.prototype.isInline=function(e){return/^data:image\/svg\+xml/i.test(e)},o.prototype.createCanvas=function(e){var t=this;return function(n,i){var o=new window.OfficeBrowserFeedback.html2canvas.svg.fabric.StaticCanvas("c");t.image=o.lowerCanvasEl,o.setWidth(i.width).setHeight(i.height).add(window.OfficeBrowserFeedback.html2canvas.svg.fabric.util.groupSVGElements(n,i)).renderAll(),e(o.lowerCanvasEl)}},o.prototype.decode64=function(e){return"function"==typeof window.atob?window.atob(e):a(e)},t.exports=o},{"./utils":26,"./xhr":28}],24:[function(e,t,i){function o(e,t){this.src=e,this.image=null;var i=this;this.promise=t?new n(function(t,n){i.image=new Image,i.image.onload=t,i.image.onerror=n,i.image.src="data:image/svg+xml,"+(new XMLSerializer).serializeToString(e),i.image.complete===!0&&t(i.image)}):this.hasFabric().then(function(){return new n(function(t){window.OfficeBrowserFeedback.html2canvas.svg.fabric.parseSVGDocument(e,i.createCanvas.call(i,t))})})}var r=e("./svgcontainer");o.prototype=Object.create(r.prototype),t.exports=o},{"./svgcontainer":23}],25:[function(e,t,n){function i(e,t){r.call(this,e,t)}function o(e,t,n){if(e.length>0)return t+n.toUpperCase()}var r=e("./nodecontainer");i.prototype=Object.create(r.prototype),i.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},i.prototype.transform=function(e){var t=this.node.data;switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,o);case"uppercase":return t.toUpperCase();default:return t}},t.exports=i},{"./nodecontainer":14}],26:[function(e,t,n){n.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},n.bind=function(e,t){return function(){return e.apply(t,arguments)}},n.decode64=function(e){var t,n,i,o,r,a,s,u,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=e.length,d="";for(t=0;t<c;t+=4)n=l.indexOf(e[t]),i=l.indexOf(e[t+1]),o=l.indexOf(e[t+2]),r=l.indexOf(e[t+3]),a=n<<2|i>>4,s=(15&i)<<4|o>>2,u=(3&o)<<6|r,d+=64===o?String.fromCharCode(a):64===r||r===-1?String.fromCharCode(a,s):String.fromCharCode(a,s,u);return d},n.getBounds=function(e){if(e.getBoundingClientRect){var t=e.getBoundingClientRect(),n=null==e.offsetWidth?t.width:e.offsetWidth;return{top:t.top,bottom:t.bottom||t.top+t.height,right:t.left+n,left:t.left,width:n,height:null==e.offsetHeight?t.height:e.offsetHeight}}return{}},n.offsetBounds=function(e){var t=e.offsetParent?n.offsetBounds(e.offsetParent):{top:0,left:0};return{top:e.offsetTop+t.top,bottom:e.offsetTop+e.offsetHeight+t.top,right:e.offsetLeft+t.left+e.offsetWidth,left:e.offsetLeft+t.left,width:e.offsetWidth,height:e.offsetHeight}},n.parseBackgrounds=function(e){var t,n,i,o,r,a,s,u=" \r\n\t",l=[],c=0,d=0,p=function(){t&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&s.push(n),"-"===t.substr(0,1)&&(o=t.indexOf("-",1)+1)>0&&(i=t.substr(0,o),t=t.substr(o)),l.push({prefix:i,method:t.toLowerCase(),value:r,args:s,image:null})),s=[],t=i=n=r=""};return s=[],t=i=n=r="",e.split("").forEach(function(e){if(!(0===c&&u.indexOf(e)>-1)){switch(e){case'"':a?a===e&&(a=null):a=e;break;case"(":if(a)break;if(0===c)return c=1,void(r+=e);d++;break;case")":if(a)break;if(1===c){if(0===d)return c=0,r+=e,void p();d--}break;case",":if(a)break;if(0===c)return void p();if(1===c&&0===d&&!t.match(/^url$/i))return s.push(n),n="",void(r+=e)}r+=e,0===c?t+=e:n+=e}}),p(),l}},{}],27:[function(e,t,n){function i(e){o.apply(this,arguments),this.type="linear"===e.args[0]?o.TYPES.LINEAR:o.TYPES.RADIAL}var o=e("./gradientcontainer");i.prototype=Object.create(o.prototype),t.exports=i},{"./gradientcontainer":9}],28:[function(e,t,i){function o(e){return new n(function(t,n){var i=new XMLHttpRequest;i.open("GET",e),i.onload=function(){200===i.status?t(i.responseText):n(new Error(i.statusText))},i.onerror=function(){n(new Error("Network Error"))},i.send()})}t.exports=o},{}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"es6-promise":9}]},{},[12,52]);
//# sourceMappingURL=officebrowserfeedback.min.js.map
